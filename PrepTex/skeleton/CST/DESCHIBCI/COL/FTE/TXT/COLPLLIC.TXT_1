*%! Codigo adicional para archivo
*% IF RW
      *<<<< RW
      *DAD ini  18-JUL-1991
       COPY COLRWLI2.
      *DAD fin  18-JUL-1991
       COPY COLRWC1V.
       COPY COLRWCDP.
       COPY COLRWDDD.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01  WSS-VARI.
      *RVM-CST-INI 15-JAN-1996
           03  WSS-NUM-PAGI       VALUE ZEROES       PIC 9(05).
      *RVM-CST-FIN 15-JAN-1996
      *SMC-INI  27.09.1993
           03  WSS-COD-TCVE                          PIC X(02).
      *SMC-FIN  27.09.1993
      *DAD ini  13-MAY-1991
           03  WSS-NUM-RENO                          PIC 9(03).
      *DAD fin  13-MAY-1991
           03  WSS-INT-TIPE               COMP-3     PIC 9(03)V9(08).
           03  WSS-SGV-TNUM                          PIC S9(04)V9(04).
           03  WSS-RED-TNUM REDEFINES WSS-SGV-TNUM.
               05 WSS-ENT-TNUM                       PIC S9(04).
               05 WSS-DEC-TNUM                       PIC V9(04).
           03  WSS-SGV-TEDT.
               05 WSS-EED-TEDT                       PIC ---9.
               05 WSS-GLS-TEDT                       PIC X(01).
               05 WSS-DED-TEDT                       PIC V9(04).
           03  WSS-SGV-LIQU               COMP-3     PIC 9(11)V9(4).
           03  WSS-GLS-BLKS             VALUE SPACES PIC X(01).
           03  WSS-SGV-VCAM               COMP-3     PIC S9(11)V9(4).
      *DAD ini  23-SEP-1994    (Memo.22-09-94)  (+ 4) los limites
      *DAD ini  18-JUL-1991    se aumento en 10 c/u de los limites
           03  WSS-NUM-LIDD             VALUE 64     PIC 9(02).
           03  WSS-NUM-LICD             VALUE 69     PIC 9(02).
      *DAD fin  23-SEP-1994 / fin  18-JUL-1991
           03  WSS-COD-OPEC                          PIC X(01).
           03  WSS-GLS-SPAC             VALUE SPACES PIC X(01).
           03  WSS-IND-SEL1                          PIC X(01).
           03  WSS-FEC-FCMP.
               05  WSS-NUM-SCMP                      PIC 9(02).
               05  WSS-NUM-ACMP                      PIC 9(02).
               05  WSS-NUM-MCMP                      PIC 9(02).
               05  WSS-NUM-DCMP                      PIC 9(02).
           03  WSS-FEC-FINI.
               05  WSS-NUM-DINI                      PIC 9(02).
               05  WSS-NUM-MINI                      PIC 9(02).
               05  WSS-NUM-SINI                      PIC 9(02).
               05  WSS-NUM-AINI                      PIC 9(02).
           03  WSS-FEC-FTER.
               05  WSS-NUM-DTER                      PIC 9(02).
               05  WSS-NUM-MTER                      PIC 9(02).
               05  WSS-NUM-STER                      PIC 9(02).
               05  WSS-NUM-ATER                      PIC 9(02).
           03  WSS-NUM-PAGE             VALUE 1      PIC 9(03).
           03  WSS-COD-OFIC             VALUE SPACES PIC X(03).
           03  WSS-CIC-IOPC.
               05  WSS-CAI-IOPC         VALUE SPACES PIC X(04).
               05  WSS-IIC-IOPC         VALUE SPACES PIC X(08).
           03  WSS-ABR-CVTI                          PIC X(05).
           03  WSS-COD-TDOC                          PIC X(03).
           03  WSS-ABR-TVLI                          PIC X(05).
           03  WSS-DCO-TVLI                          PIC X(12).
           03  WSS-DES-TVLI                          PIC X(40).
           03  WSS-CIC-TVLI                          PIC X(05).
           03  WSS-DAT-TVLI                          PIC X(12).
           03  WSS-CIC-MRXL                          PIC X(12).
           03  WSS-DCO-MRXL                          PIC X(12).
           03  WSS-DES-MRXL                          PIC X(40).
           03  WSS-ABR-MRXL                          PIC X(05).
           03  WSS-DES-M4AL                          PIC X(40).
           03  WSS-CIC-VCOC                          PIC X(06).
           03  WSS-DCO-VCOC                          PIC X(12).
           03  WSS-ABR-VCOC                          PIC X(40).
           03  WSS-COD-TVOC.
               05  WSS-MSC-TVAL                      PIC X(01).
               05  WSS-MSC-REST                      PIC X(04).
           03  WSS-COD-DLTR                          PIC X(12).
           03  WSS-TOT-INTE                          PIC 9(11)V9(04).
           03  WSS-COD-BCTI                          PIC X(12).
           03  WSS-NUM-ICYA                          PIC 9(03).
           03  WSS-IMAX                 VALUE 4      PIC 9(02).
           03  WSS-ABR-MOV                           PIC X(05).
           03  WSS-DCO-TCYA                          PIC X(12).
           03  WSS-ABR-TCYA                          PIC X(05).
           03  WSS-COD-VCOC.
               05  WSS-MSC-TVOC                      PIC X(01).
               05  WSS-COD-CVOC                      PIC X(03).
               05  WSS-COD-TCOC                      PIC X(02).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                      PIC X(03).
               05  WSS-COD-AOOC                      PIC X(03).
           03 WSS-COD-LUGA.
               05 WSS-COD-COMU                       PIC X(04).
               05 WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
                  07 WSS-IND-PAIS                    PIC X(01).
                  07 WSS-COD-PAIS                    PIC X(03).
           03  WSS-GLS-TIAU.
               05 WSS-GLS-TIO                        PIC X(40).
               05 WSS-GLS-AUX                        PIC X(40).
           03  WSS-IND-DULT                          PIC X(01).
      *DAD ini  23-SEP-1994    (Memo.22-09-94)
           03 WSS-IND                                PIC 9(02).
           03 WSS-GLS-MAIL.
              05 WSS-GLS-MAI1.
                 07 WSS-IND-MAI1     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI2.
                 07 WSS-IND-MAI2     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI3.
                 07 WSS-IND-MAI3     OCCURS 40       PIC X(01).
      *DAD fin  23-SEP-1994
      *RVM-CST-INI 10-JUN-1997
              05 WSS-GLS-MAI4.
                 07 WSS-IND-MAI4     OCCURS 40       PIC X(01).
              05 WSS-GLS-MAI5.
                 07 WSS-IND-MAI5     OCCURS 40       PIC X(01).
      *RVM-CST-FIN 10-JUN-1997

       COPY GNSBRMSC.
       COPY GNSBRRCE.
       COPY GNSBRCMT.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGPES.
      *SMC-INI 09.09.1993
       COPY COLWGINT.
      *SMC-FIN 09.09.1993
       COPY GNSWGCVI.
       COPY SGCBRDBC.
       COPY SGCBRRCD.
      *DAD ini  13-MAY-1991
       COPY COLBRROV.
      *DAD fin  13-MAY-1991
      * RBG/INI/12-NOV-1996 
       COPY SGCBRDCE.
       COPY SGCBRDCP.
      * RBG/FIN/12-NOV-1996 
      *RVM-CST-INI 11-JUN-1997
       COPY GNSWGBAR.
      *RVM-CST-FIN 11-JUN-1997
       COPY COLBRRDC.
       COPY COLBRICG.
       COPY COLBRCYA.
       COPY COLBRVEN.
       COPY COLBREVC.
       COPY COLBRDLC.
       COPY COLBRTOC.
       COPY COLBRPOC.
       COPY COLBRRCV.
       COPY COLWGVEN.
       COPY TABBROFI.
       COPY TABBRUSR.
       COPY TABBRVLR.
       COPY TABBRCAM.
      *DAD ini  19-NOV-1991 / 23-ABR-1991
       COPY COLWGCTO.
       COPY TABBRTIO.
      *DAD fin  19-NOV-1991 / 23-ABR-1991
       COPY GNSWGCPT.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CMT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
      *DAD ini  13-MAY-1991
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
      *DAD fin  13-MAY-1991
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VLR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
      * RBG/INI/12-NOV-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
      * RBG/FIN/12-NOV-1996  
      *>>>>
*% END
*% IF RT
      *<<<< RT
      *DAD ini  18-JUL-1991
       COPY COLRTLI2.
      *DAD fin  18-JUL-1991
       COPY COLRTC1V.
       COPY COLRTCDP.
       COPY COLRTDDD.
      * RBG/INI/12-NOV-1996
       COPY COLRTLIT.
      * RBG/FIN/12-NOV-1996 
      *>>>>
*% END
*% IF FIN
      *<<<< FIN
           MOVE PAGE-COUNTER IN RPT-LI1 TO WSS-NUM-PAGI IN WSS-VARI.
           DISPLAY ' '.
           DISPLAY 'ESTADISTICAS COLPLLIC'.
           DISPLAY '---------------------'.
           DISPLAY 'NUMERO DE PAGINAS A IMPRIMIR : ' 
                WSS-NUM-PAGI IN WSS-VARI.
      *>>>>
*% END
*% IF INI_INP
      *<<<< INI_INP
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.
      *Captura Codigo de Operacion
           DISPLAY 'ASIGNACION OPERACION : '.
           ACCEPT  WSS-CAI-IOPC IN WSS-VARI.
           DISPLAY WSS-CAI-IOPC IN WSS-VARI.
           DISPLAY 'IDENTIFICACION OPERACION : '.
           ACCEPT  WSS-IIC-IOPC IN WSS-VARI.
           DISPLAY WSS-IIC-IOPC IN WSS-VARI.
      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMAAAA ) : '
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA : '.
           ACCEPT  WSS-COD-OFIC IN WSS-VARI.
           DISPLAY WSS-COD-OFIC IN WSS-VARI.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.
           IF WSS-CIC-IOPC IN WSS-VARI > SPACES
               IF WSS-CIC-IOPC IN WSS-VARI = '*'
                   MOVE '*' TO WSS-IND-SEL1 IN WSS-VARI
                   GO TO NXT-INP
               ELSE
                   MOVE 'O' TO WSS-IND-SEL1 IN WSS-VARI
                   GO TO NXT-INP.
      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *DAD ini  13-MAY-1991
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DCMP IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MCMP IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-SCMP IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ACMP IN WSS-VARI.
      *DAD fin  13-MAY-1991
           IF WSS-COD-OFIC IN WSS-VARI > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               DISPLAY WSS-COD-OFIC IN WSS-VARI
               MOVE WSS-COD-OFIC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS = 'COD    NEX'
                   DISPLAY MSG-GLS-MENS
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT.
           DISPLAY 'FIN VALIDACION DE PARAMETROS'.
       NXT-INP.
           MOVE 'COL' TO TAB-COD-SIST
           MOVE 'LIC' TO TAB-COD-TTAB IN TAB
           MOVE 'MRX' TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           IF MSG-COD-MENS = 'COD    NEX'
               DISPLAY MSG-GLS-DESC ' : ' TAB-COD-TABL
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-MRXL IN WSS-VARI.
           MOVE TAB-GLS-DESC IN TAB TO WSS-DES-MRXL IN WSS-VARI.
           MOVE TAB-GLS-DCOR IN TAB TO WSS-DCO-MRXL IN WSS-VARI.
           MOVE TAB-GLS-ABRV IN TAB TO WSS-ABR-MRXL IN WSS-VARI
                                       WSS-GLS-DLEY IN WSS-LI2.
           MOVE 'COL' TO TAB-COD-SIST
           MOVE 'LIC' TO TAB-COD-TTAB IN TAB
           MOVE 'TV'  TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           IF MSG-COD-MENS = 'COD    NEX'
               DISPLAY MSG-GLS-DESC ' : ' TAB-COD-TABL
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TVLI IN WSS-VARI.
           MOVE TAB-GLS-DATA IN TAB TO WSS-DAT-TVLI IN WSS-VARI.
           MOVE TAB-GLS-DESC IN TAB TO WSS-DES-TVLI IN WSS-VARI.
           MOVE TAB-GLS-DCOR IN TAB TO WSS-DCO-TVLI IN WSS-VARI.
           MOVE TAB-GLS-ABRV IN TAB TO WSS-ABR-TVLI IN WSS-VARI.
           MOVE 'COL' TO TAB-COD-SIST
           MOVE 'LIC' TO TAB-COD-TTAB IN TAB
           MOVE 'M4A' TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           IF MSG-COD-MENS = 'COD    NEX'
               DISPLAY MSG-GLS-DESC ' : ' TAB-COD-TABL
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE TAB-GLS-DESC IN TAB TO WSS-DES-M4AL IN WSS-VARI.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'DOC' TO TAB-CIC-TTAB.
           MOVE 'LTR' TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-COD-CTAB TO WSS-COD-DLTR IN WSS-VARI
           ELSE
               DISPLAY 'NO EXISTE CODIGO LTR EN TABLA DOC DE TAB'
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE 'COL'  TO FIO-SIST.
           MOVE 'OPEC' TO MSC-CIC-TMSC IN MSC.
           MOVE 'D'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               MOVE MSC-COD-CMSC IN MSC TO WSS-COD-OPEC IN WSS-VARI
           ELSE
               DISPLAY 'NO EXISTE CODIGO D EN TABLA OPEC DE COL'
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE 'TAB'  TO FIO-SIST.
           MOVE 'TVAL' TO MSC-CIC-TMSC IN MSC.
           MOVE '0'    TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               MOVE MSC-COD-CMSC IN MSC TO WSS-COD-TVOC IN WSS-VARI
           ELSE
               DISPLAY 'NO EXISTE CODIGO 0 EN TABLA TVAL DE TAB'
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *DAD ini  19-NOV-1991
      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *DAD fin  19-NOV-1991
           DISPLAY 'Fin Validacion de Parametros'.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      *DAD ini  13-MAY-1991
           IF WSS-IND-SEL1 IN WSS-VARI = '*'
               GO TO CON-INP-SRT
           ELSE
      *DAD fin  13-MAY-1991
           IF WSS-IND-SEL1 IN WSS-VARI = 'O'
               MOVE WSS-CIC-IOPC IN WSS-VARI TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF NOT FIO-STAT-OKS
                   DISPLAY 'OPERACION INEXISTENTE : '
                            OPC-CIC-IOPC IN OPC
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-INP-SRT
               ELSE
                   IF OPC-MSC-STAT IN OPC NOT = 'A'
                       DISPLAY 'OPERACION NO ACTIVADA : '
                                OPC-CIC-IOPC IN OPC
                       MOVE PGM-SMAL TO PGM-STAT-SRT
                       GO TO FIN-INP-SRT
                   ELSE
                       GO TO LUP-INP-SRT.
      *DAD ini  23-MAY-1991 / 13-MAY-1991
           MOVE WSS-NUM-DINI IN WSS-VARI TO OPC-NUM-DINP IN OPC.
           MOVE WSS-NUM-MINI IN WSS-VARI TO OPC-NUM-MINP IN OPC.
           MOVE WSS-NUM-SINI IN WSS-VARI TO OPC-NUM-SINP IN OPC.
           MOVE WSS-NUM-AINI IN WSS-VARI TO OPC-NUM-AINP IN OPC.
           MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FINP IN OPC > WSS-FEC-FCMP IN WSS-VARI
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT
           ELSE
               GO TO LUP-INP-SRT.
       CON-INP-SRT.
      *DAD fin  23-MAY-1991 / 13-MAY-1991
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * Verifica Estado del Credito este Activado
           IF OPC-MSC-STAT IN OPC NOT = 'A'
               GO TO NXT-INP-SRT.
      *DAD ini  13-MAY-1991
      * Verifica Credito tenga Saldo
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO NXT-INP-SRT.
      *DAD fin  13-MAY-1991
      * Compara Oficina del Parametro con la Oficina del Credito
           IF WSS-CIC-IOPC IN WSS-VARI NOT > SPACES AND
              WSS-COD-OFIC IN WSS-VARI     > SPACES AND
              WSS-COD-OFIC IN WSS-VARI NOT = '*'
               IF WSS-COD-OFIC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO NXT-INP-SRT.

      *DAD ini  19-NOV-1991 / 23-ABR-1991 
      * Busca con el Codigo Tipo Operacion en la Tabla cargada en Memoria el
      * 'Sistema que lo Maneja'
           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
                       'CON CODIGO : '     CTO-TOOC IN CTO-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               GO TO NXT-INP-SRT.

      * Valida el 'Sistema que lo Maneja' de la Operacion de Credito
           IF CTO-SIST IN CTO-VARI NOT = 'COL'
               GO TO NXT-INP-SRT.
      *DAD fin  19-NOV-1991 / 23-ABR-1991 

           MOVE OPC-COD-VCOC IN OPC TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC TO POC-COD-AOOC IN POC.
           MOVE ZEROES              TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF FIO-STAT-OKS AND
              POC-IND-LIQI IN POC NOT = 'S'
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'OPCNOLICPLT' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' : ' OPC-CIC-IOPC IN OPC
               GO TO NXT-INP-SRT.
           PERFORM ANL-FIL-ANX.
           IF NOT FIO-STAT-OKS
               GO TO NXT-INP-SRT.

           IF OPC-COD-COOC IN OPC > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'AUX'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN OPC TO WSS-COD-TOOC IN WSS-VARI
               MOVE OPC-COD-AOOC IN OPC TO WSS-COD-AOOC IN WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AUX IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-AUX IN WSS-VARI.
           IF OPC-COD-TOOC IN OPC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN OPC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TIO IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-GLS-TIO IN WSS-VARI.
           MOVE WSS-GLS-TIAU IN WSS-VARI TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO WSS-GLS-COOC IN WSS-LI1.

           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC ' : ' TOC-COD-TABL
               GO TO NXT-INP-SRT.

           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.

       RECORRE-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
           PERFORM BUS-DIRE.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               GO TO RST-RCD.
           IF RCD-COD-LUGA IN RCD > SPACES
               MOVE RCD-COD-LUGA IN RCD TO WSS-COD-LUGA
               IF WSS-IND-PAIS = 'P'
                   MOVE 'TAB'        TO TAB-COD-SIST
                   MOVE 'PAI'        TO TAB-COD-TTAB IN TAB
                   MOVE WSS-COD-PAIS TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-LI1
               ELSE
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'COM'               TO TAB-COD-TTAB IN TAB
                   MOVE RCD-COD-LUGA IN RCD TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-COMU IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-COMU IN WSS-LI1.

      *RMV ini  12-APR-1994   (Memo 06-01-1994  Pto.1)
      *     GO TO MOV-INP-SRT.
       COPY COLRMLI1.
           RELEASE SRT.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC AND
      *DAD ini  02-MAY-1994   (Memo 06-01-1994  Pto.1)
              RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC AND
              RDC-NUM-IDLC IN RDC = ZEROES
      *DAD fin  02-MAY-1994
              GO TO RECORRE-RDC
           ELSE
              GO TO NXT-INP-SRT.
      *RMV fin  12-APR-1994
       RST-RCD.
           MOVE SPACES TO RCD-GLS-DIRE IN RCD.
           MOVE SPACES TO RCD-NUM-FONO IN RCD.
           MOVE SPACES TO WSS-GLS-COMU IN WSS-LI1.
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           IF WSS-IND-SEL1 IN WSS-VARI = 'O'
               GO TO FIN-INP-SRT.
      *DAD ini  23-MAY-1991 / 13-MAY-1991
           IF WSS-CIC-IOPC IN WSS-VARI NOT > SPACES
               MOVE 'OPC-FEC-FINP' TO FIO-AKEY.
      *DAD fin  23-MAY-1991 / 13-MAY-1991
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
      *DAD ini  23-MAY-1991 / 13-MAY-1991
           IF WSS-IND-SEL1 IN WSS-VARI = '*'
               GO TO LUP-INP-SRT.
           IF OPC-FEC-FINP IN OPC > WSS-FEC-FCMP IN WSS-VARI
               GO TO FIN-INP-SRT.
      *DAD fin  23-MAY-1991 / 13-MAY-1991
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      *DAD ini  19-NOV-1991
      * Obtiene Glosas para Titulos del Reporte que forman parte de LI1
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-OFOC IN WSS-LI1.
      *DAD fin  19-NOV-1991
           IF OPC-COD-RMOC IN SRT > SPACES
               MOVE OPC-COD-RMOC IN SRT TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-RMOC IN WSS-LI1.
           IF OPC-COD-VCOC IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCOC IN WSS-VARI
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCO1 IN WSS-LI1
               MOVE TAB-GLS-DCOR IN TAB TO WSS-DCO-VCOC IN WSS-VARI
               MOVE TAB-GLS-ABRV IN TAB TO WSS-ABR-VCOC IN WSS-VARI
           ELSE
              MOVE SPACES TO WSS-GLS-VCO1 IN WSS-LI1.
           PERFORM BUS-WSS-GLS-SCLI.
           PERFORM BUS-WSS-GLS-VEXP.
           IF NOT FIO-STAT-OKS
               GO TO NXT-OUT-SRT.
           PERFORM BUS-EQUI-VCAM.
           PERFORM GET-ICG.
           IF NOT FIO-STAT-OKS
               GO TO NXT-OUT-SRT.
           PERFORM GET-DLC.
           IF NOT FIO-STAT-OKS
               GO TO NXT-OUT-SRT.
           PERFORM GET-VEN.
           IF NOT FIO-STAT-OKS
               GO TO NXT-OUT-SRT.
           PERFORM GET-CYA.
           PERFORM BUS-WSS-GLS-MSG.
      *DAD ini  23-SEP-1994    (Memo.22-09-94)
      * Proceso que Llena e Imprime Verticalmente lineas de Detalle(MAIL)
           PERFORM FIL-IMP-DET-MAIL.
      *DAD fin  23-SEP-1994
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
      *DAD ini  18-JUL-1991
           GENERATE DL-LI2.
      *DAD fin  18-JUL-1991
           MOVE 'S' TO WSS-IND-DULT.
           MOVE OPC-CIC-IOPC IN SRT TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           MOVE TOC-MSC-OPEC IN SRT TO CIC-OPEC.
           IF CIC-OPEC = WSS-COD-OPEC IN WSS-VARI
               PERFORM GEN-DDD
           ELSE
      *JSS     IF OPC-NUM-VCVG IN SRT = 1
               IF OPC-NUM-VCOR IN OPC = 1
                   PERFORM GEN-C1V
               ELSE
                   PERFORM GEN-CDP.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      ******************************************************************
       ANL-FIL-ANX SECTION.
       INI-ANL-FIL-ANX.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
      *ALD
      * Que se debe mover al VEN-NUM-IVEN ?
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
      *
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOVEN' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG ':' OPC-CIC-IOPC IN OPC
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-ANL-FIL-ANX.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC )
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NODLC' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG ':' OPC-CIC-IOPC IN OPC
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-ANL-FIL-ANX.
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOICG' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE FIO-STAT-NEX TO FIO-STAT
               DISPLAY MSG-GLS-DESC IN MSG ':' OPC-CIC-IOPC IN OPC.
       FIN-ANL-FIL-ANX.
           EXIT.
      ******************************************************************
       BUS-DIRE SECTION.
       INI-BUS-DIRE.
           MOVE DBC-CAI-ICLI IN DBC TO RCD-CAI-ICLI IN RCD.
           MOVE DBC-IIC-ICLI IN DBC TO RCD-IIC-ICLI IN RCD.
           MOVE RDC-NUM-DIRE IN RDC TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO RCD-GLS-DIRE IN RCD.
       FIN-BUS-DIRE.
           EXIT.
      ******************************************************************
       BUS-WSS-GLS-SCLI SECTION.
       INI-BUS-WSS-GLS-SCLI.
           IF DBC-GLS-ICLI IN SRT > SPACES
               MOVE '-'    TO WSS-GLS-SCLI IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-SCLI IN WSS-LI1.
       FIN-BUS-WSS-GLS-SCLI.
           EXIT.
      ******************************************************************
       BUS-WSS-GLS-VEXP SECTION.
       INI-BUS-WSS-GLS-VEXP.
           MOVE OPC-COD-VCOC IN SRT TO WSS-COD-VCOC IN WSS-VARI.
           IF WSS-MSC-TVAL IN WSS-VARI = WSS-MSC-TVOC IN WSS-VARI AND
              WSS-CIC-MRXL IN WSS-VARI > SPACES
               GO TO NXT-BUS-WSS-GLS-VEXP.
           MOVE ZEROES                   TO WSS-SGV-VCAM IN WSS-LI2.
           MOVE WSS-DCO-VCOC IN WSS-VARI TO WSS-GLS-VEXP IN WSS-LI2.
           MOVE OPC-VAL-CRED IN SRT      TO WSS-VAL-CRED IN WSS-LI2.
           GO TO FIN-BUS-WSS-GLS-VEXP.
       NXT-BUS-WSS-GLS-VEXP.
           MOVE 'TAB'        TO FIO-SIST.
           MOVE 'VLR'        TO TAB-CIC-TTAB.
           MOVE WSS-CIC-MRXL TO TAB-CIC-CTAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-VEXP IN WSS-LI2
           ELSE
               MOVE SPACES TO WSS-GLS-VEXP IN WSS-LI2.
           IF TAB-COD-CTAB NOT = OPC-COD-VCOC IN SRT
               MOVE OPC-NUM-DCOL IN SRT TO CAM-NUM-DCAM IN CAM(1)
               MOVE OPC-NUM-MCOL IN SRT TO CAM-NUM-MCAM IN CAM(1)
               MOVE OPC-NUM-SCOL IN SRT TO CAM-NUM-SCAM IN CAM(1)
               MOVE OPC-NUM-ACOL IN SRT TO CAM-NUM-ACAM IN CAM(1)
               MOVE OPC-NUM-DCOL IN SRT TO CAM-NUM-DCAM IN CAM(2)
               MOVE OPC-NUM-MCOL IN SRT TO CAM-NUM-MCAM IN CAM(2)
               MOVE OPC-NUM-SCOL IN SRT TO CAM-NUM-SCAM IN CAM(2)
               MOVE OPC-NUM-ACOL IN SRT TO CAM-NUM-ACAM IN CAM(2)
               MOVE OPC-COD-VCOC IN SRT TO CAM-COD-VCAM IN CAM(1)
               MOVE TAB-COD-CTAB IN TAB TO CAM-COD-VCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS
                   MOVE ZEROES TO WSS-VAL-CRED IN WSS-LI2
                   DISPLAY 'NO EXISTE VALOR CAMBIO OPER : '
                           OPC-CIC-IOPC IN SRT '/'
                           CAM-FEC-FCAM IN CAM(1) '/'
                           OPC-COD-VCOC IN SRT '/'
                           TAB-COD-CTAB IN TAB
               ELSE
                   IF CAM-IND-VIGE NOT = 'S'
                   MOVE ZEROES TO WSS-VAL-CRED IN WSS-LI2
                   DISPLAY 'IND. DE VIGENCIA NO VALIDO OPER : '
                           OPC-CIC-IOPC IN SRT '/'
                           CAM-FEC-FCAM IN CAM(1) '/'
                           OPC-COD-VCOC IN SRT '/'
                           TAB-COD-CTAB IN TAB
                   ELSE
                       MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM
                                                           IN WSS-LI2
                       MULTIPLY CAM-SGV-VCAM IN CAM BY OPC-VAL-CRED
                                IN SRT GIVING WSS-VAL-CRED IN WSS-LI2
                       MOVE WSS-VAL-CRED IN WSS-LI2 TO PES-SGV-DECI
                                                           IN PES-VARI
                       PERFORM PES-SCTV
                       MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-CRED
                                                           IN WSS-LI2
           ELSE
               MOVE ZEROES TO WSS-SGV-VCAM IN WSS-LI2
               MOVE OPC-VAL-CRED IN SRT TO WSS-VAL-CRED IN WSS-LI2.
       FIN-BUS-WSS-GLS-VEXP.
           EXIT.
      ******************************************************************
       BUS-EQUI-VCAM SECTION.
       INI-BUS-EQUI-VCAM.
           IF WSS-CIC-MRXL IN WSS-VARI = WSS-CIC-VCOC IN WSS-VARI
               MOVE SPACES TO WSS-GLS-VCO2 IN WSS-LI2
               MOVE ZEROES TO OPC-VAL-CRED IN SRT
               MOVE ZEROES TO WSS-SGV-VCAM IN WSS-LI2
               MOVE SPACES TO WSS-GLS-VCAM IN WSS-LI2
               MOVE SPACES TO WSS-GLS-EQUI IN WSS-LI2
               GO TO FIN-BUS-EQUI-VCAM.
           IF WSS-MSC-TVAL IN WSS-VARI = WSS-MSC-TVOC IN WSS-VARI
               MOVE WSS-DCO-MRXL IN WSS-VARI TO WSS-GLS-EQUI IN WSS-LI2
               MOVE WSS-DES-MRXL IN WSS-VARI TO WSS-GLS-VCAM IN WSS-LI2
               MOVE WSS-ABR-VCOC IN WSS-VARI TO WSS-GLS-VCO2 IN WSS-LI2
           ELSE
               MOVE SPACES TO WSS-GLS-VCO2 IN WSS-LI2
               MOVE ZEROES TO OPC-VAL-CRED IN SRT
               MOVE ZEROES TO WSS-SGV-VCAM IN WSS-LI2
               MOVE SPACES TO WSS-GLS-VCAM IN WSS-LI2
               MOVE SPACES TO WSS-GLS-EQUI IN WSS-LI2.
       FIN-BUS-EQUI-VCAM.
           EXIT.
      ******************************************************************
       GET-ICG SECTION.
       INI-GET-ICG.
           PERFORM GET-ICG-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE REGISTRO ICG PARA OPERACION '
                        OPC-CIC-IOPC IN SRT
               GO TO FIN-GET-ICG.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE 'I'                 TO VLR-MSC-TVAL IN VLR
               MOVE ICG-COD-CVTI IN ICG TO VLR-COD-CVAL IN VLR
               MOVE ICG-MSC-PBTI IN ICG TO VLR-COD-TCAM IN VLR
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE VLR-COD-VCAM IN VLR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
           ELSE
               MOVE SPACES TO TAB-GLS-ABRV IN TAB.
           MOVE TAB-GLS-ABRV IN TAB TO WSS-ABR-CVTI IN WSS-VARI.
           IF TOC-MSC-OPEC IN SRT = WSS-COD-OPEC IN WSS-VARI
               MOVE SPACES TO WSS-GLS-TASA IN WSS-LI1
               MOVE SPACES TO WSS-SGV-TINT IN WSS-LI1
               PERFORM ICG-BLKS
               GO TO NXT-GET-ICG.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG      TO WSS-SGV-TNUM IN WSS-VARI
               MOVE WSS-ENT-TNUM IN WSS-VARI TO WSS-EED-TEDT IN WSS-VARI
               MOVE ','                      TO WSS-GLS-TEDT IN WSS-VARI
               MOVE WSS-DEC-TNUM IN WSS-VARI TO WSS-DED-TEDT IN WSS-VARI
               MOVE WSS-SGV-TEDT IN WSS-VARI TO WSS-SGV-TINT IN WSS-LI1
           ELSE
               MOVE ICG-SGV-TINT IN ICG      TO WSS-SGV-TNUM IN WSS-VARI
               MOVE WSS-ENT-TNUM IN WSS-VARI TO WSS-EED-TEDT IN WSS-VARI
               MOVE ','                      TO WSS-GLS-TEDT IN WSS-VARI
               MOVE WSS-DEC-TNUM IN WSS-VARI TO WSS-DED-TEDT IN WSS-VARI
               MOVE WSS-SGV-TEDT IN WSS-VARI TO WSS-SGV-TINT IN WSS-LI1.
           IF ICG-MSC-BCTI IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'BCTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-BCTI IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
           ELSE
               MOVE SPACES TO MSC-GLS-DCOR IN MSC.
           IF ICG-COD-CVTI IN ICG NOT > SPACES
               MOVE WSS-DAT-TVLI IN WSS-VARI TO WSS-GLS-TASA IN WSS-LI1
           ELSE
               STRING WSS-DES-TVLI IN WSS-VARI
                      WSS-GLS-SPAC IN WSS-VARI
                      WSS-ABR-CVTI IN WSS-VARI DELIMITED BY SIZE INTO
                      WSS-GLS-TASA IN WSS-LI1.
           PERFORM LLE-ICG.
       NXT-GET-ICG.
           IF ICG-COD-CVTI IN ICG NOT > SPACES
               MOVE SPACES TO WSS-GLS-TBAS IN WSS-LI2
               MOVE ZEROES TO WSS-SGV-TBAS IN WSS-LI2
               GO TO FIN-GET-ICG.
           MOVE OPC-NUM-DCOL IN SRT TO CAM-NUM-DCAM IN CAM(1).
           MOVE OPC-NUM-MCOL IN SRT TO CAM-NUM-MCAM IN CAM(1).
           MOVE OPC-NUM-SCOL IN SRT TO CAM-NUM-SCAM IN CAM(1).
           MOVE OPC-NUM-ACOL IN SRT TO CAM-NUM-ACAM IN CAM(1).
           MOVE OPC-NUM-DCOL IN SRT TO CAM-NUM-DCAM IN CAM(2).
           MOVE OPC-NUM-MCOL IN SRT TO CAM-NUM-MCAM IN CAM(2).
           MOVE OPC-NUM-SCOL IN SRT TO CAM-NUM-SCAM IN CAM(2).
           MOVE OPC-NUM-ACOL IN SRT TO CAM-NUM-ACAM IN CAM(2).
           MOVE VLR-COD-VCAM IN VLR TO CAM-COD-VCAM IN CAM(1).
           MOVE OPC-COD-VCOC IN SRT TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO WSS-SGV-TBAS IN WSS-LI2
      *ALD
      *         DISPLAY 'NO EXISTE VALOR CAMBIO  OPER : '
      *                     OPC-CIC-IOPC IN SRT '/'
      *                     CAM-FEC-FCAM IN CAM(1) '/'
      *                     CAM-COD-VCAM IN CAM(1) '/'
      *                     OPC-COD-VCOC IN SRT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   MOVE ZEROES TO WSS-SGV-TBAS IN WSS-LI2
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-TBAS IN WSS-LI2.
           STRING WSS-ABR-TVLI IN WSS-VARI
                  WSS-GLS-SPAC IN WSS-VARI
                  WSS-ABR-CVTI IN WSS-VARI
                  WSS-GLS-SPAC IN WSS-VARI
                  WSS-DCO-TVLI IN WSS-VARI DELIMITED BY SIZE INTO
                  WSS-GLS-TBAS IN WSS-LI2.
           MOVE '00' TO FIO-STAT.
       FIN-GET-ICG.
           EXIT.
      *-----------------------------------------------------------------
       ICG-BLKS SECTION.
       INI-ICG-BLKS.
           MOVE SPACES TO WSS-GLS-BCTI IN WSS-LI1.
           MOVE SPACES TO WSS-GLS-PBTI IN WSS-LI1.
           MOVE SPACES TO WSS-GLS-MCTI IN WSS-LI1.
           MOVE SPACES TO WSS-GLS-CVTI IN WSS-LI1.
           MOVE SPACES TO WSS-GLS-PREP IN WSS-LI1.
           MOVE ZEROES TO ICG-NUM-PREP IN ICG.
           MOVE SPACES TO WSS-GLS-UTPR IN WSS-LI1.
           MOVE SPACES TO WSS-GLS-TFPR IN WSS-LI1.
       FIN-ICG-BLKS.
           EXIT.
      *-----------------------------------------------------------------
       LLE-ICG SECTION.
       INI-LLE-ICG.
           IF ICG-MSC-BCTI IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'BCTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-BCTI IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO WSS-GLS-BCTI IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-BCTI IN WSS-LI1.
           IF ICG-MSC-PBTI IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'PBTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-PBTI IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-PBTI IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-PBTI IN WSS-LI1.
           IF ICG-MSC-SPBT IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'MCTI'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-SPBT IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO WSS-GLS-MCTI IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-MCTI IN WSS-LI1.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE 'I'                 TO VLR-MSC-TVAL IN VLR
               MOVE ICG-COD-CVTI IN ICG TO VLR-COD-CVAL IN VLR
               MOVE ICG-MSC-PBTI IN ICG TO VLR-COD-TCAM IN VLR
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
               MOVE VLR-COD-VCAM IN VLR TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-CVTI IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-CVTI IN WSS-LI1.
           MOVE SPACES TO WSS-GLS-PREP IN WSS-LI1.
           IF ICG-MSC-UTPR IN ICG > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'IPER'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-UTPR IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO WSS-GLS-UTPR IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-UTPR IN WSS-LI1.
           IF ICG-MSC-TFPR IN ICG > SPACES
               MOVE 'COL'               TO MSC-COD-SIST
               MOVE 'TFPR'              TO MSC-COD-TMSC IN MSC
               MOVE ICG-MSC-TFPR IN ICG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO WSS-GLS-TFPR IN WSS-LI1
           ELSE
               MOVE SPACES TO WSS-GLS-TFPR IN WSS-LI1.
       FIN-LLE-ICG.
           EXIT.
      ******************************************************************
       GET-DLC SECTION.
       INI-GET-DLC.
           MOVE ZEROES TO WSS-VAL-GNOT IN WSS-LI2.
           MOVE ZEROES TO WSS-VAL-IMPU IN WSS-LI2.
           MOVE OPC-CIC-IOPC IN SRT TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN SRT = DLC-CIC-IOPC IN DLC )
               DISPLAY 'NO EXISTE REGISTRO DLC PARA OPERACION : '
                        OPC-CIC-IOPC IN SRT
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-GET-DLC.
       LUP-GET-DLC.
           MOVE DLC-COD-TDOC IN DLC TO WSS-COD-TDOC IN WSS-VARI.
           ADD DLC-VAL-GNOT TO WSS-VAL-GNOT IN WSS-LI2.
           ADD DLC-VAL-IMPU TO WSS-VAL-IMPU IN WSS-LI2.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN SRT = DLC-CIC-IOPC IN DLC
               GO TO LUP-GET-DLC.
           MOVE '00' TO FIO-STAT.
       FIN-GET-DLC.
           EXIT.
      ******************************************************************
       GET-VEN SECTION.
       INI-GET-VEN.
           MOVE ZEROES TO WSS-TOT-INTE IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-INTE IN WSS-LI2.
           MOVE OPC-CIC-IOPC IN SRT TO VEN-CIC-IOPC IN VEN.
           MOVE OPC-CIC-IOPC IN SRT TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE ZEROES TO VEN-NUM-IVEN IN VEN
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF NOT ( FIO-STAT-OKS AND
                        OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN )
                   MOVE ZEROES TO VEN-NUM-IVEN IN VEN
               ELSE
                   MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN IN VEN.
      *
           MOVE FIO-GET-NLS TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM COL-FIO-VEN
               IF NOT ( FIO-STAT-OKS AND
                        OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN )
                   DISPLAY 'NO EXISTE REGISTRO VEN PARA OPERACION : '
                            OPC-CIC-IOPC IN SRT
                   MOVE ZEROES TO WSS-VAL-INTE IN WSS-LI2
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-GET-VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-OBT-VEN
               IF NOT ( VEN-STAT-OKS OR VEN-STAT-TVX )
                   DISPLAY 'NO EXISTE REGISTRO VEN PARA OPERACION : '
                            OPC-CIC-IOPC IN SRT
                   MOVE ZEROES TO WSS-VAL-INTE IN WSS-LI2
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-GET-VEN
               ELSE
                   PERFORM GET-EVC.
           IF NOT (WSS-COD-TDOC IN WSS-VARI = WSS-COD-DLTR IN WSS-VARI
                   OR AYF-ITCV = 'FI')
               MOVE ZEROES TO WSS-VAL-INTE IN WSS-LI2
               GO TO FIN-GET-VEN.
       LUP-GET-VEN.
      *    IF VEN-VAL-FINA IN VEN > ZEROES
      *La segunda parte de la pregunta es para considerar aquellos
      *creditos ya poblados ( con VEN ) con anterioridad a la aparicion
      *de VEN-IND-CALC
           IF ( VEN-IND-CALC IN VEN NOT = 'N' ) AND
              ( VEN-VAL-FINA IN VEN NOT < VEN-VAL-CAPI IN VEN )
               SUBTRACT VEN-VAL-CAPI IN VEN FROM VEN-VAL-FINA IN VEN
                                     GIVING WSS-TOT-INTE IN WSS-VARI
               ADD WSS-TOT-INTE IN WSS-VARI TO WSS-VAL-INTE IN WSS-LI2.
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS AND
                  OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN
                   GO TO LUP-GET-VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS OR VEN-STAT-TVX
                   GO TO LUP-GET-VEN
               ELSE
                   IF NOT ( VEN-STAT = VEN-SEOF )
                       MOVE 'COL'    TO MSG-COD-SIST
                       MOVE VEN-STAT TO MSG-COD-MENS IN MSG
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC IN MSG '/'
                               VEN-CIC-IOPC IN VEN
                       MOVE '23' TO FIO-STAT
                       GO TO FIN-GET-VEN.
           MOVE '00' TO FIO-STAT.
       FIN-GET-VEN.
           EXIT.
      *-----------------------------------------------------------------
       GET-EVC SECTION.
       INI-GET-EVC.
           MOVE 'FI' TO AYF-ITCV.
           MOVE OPC-CIC-IOPC IN SRT TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT (FIO-STAT-OKS AND
                   OPC-CIC-IOPC IN SRT = EVC-CIC-IOPC IN EVC)
               MOVE SPACES TO AYF-ITCV
               GO TO FIN-GET-EVC.

      *SMC-INI 27.09.1993
      *Busca el CIC de EVC-MSC-TCVE en TAB CVC ( en sist COL )
           MOVE 'COL' TO TAB-COD-SIST FIO-SIST.
           MOVE 'CVC' TO TAB-COD-TTAB IN TAB.
           MOVE EVC-MSC-TCVE IN EVC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY ' NO EXISTE EN CVC/COL COD : '
                                             EVC-MSC-TCVE IN EVC
               GO TO FIN-GET-EVC.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-TCVE IN WSS-VARI.

      *SMC-FIN 27.09.1993

       LUP-GET-EVC.
           IF EVC-MSC-TCVE IN EVC NOT = 'FI'
               MOVE SPACES TO AYF-ITCV
               GO TO FIN-GET-EVC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT (FIO-STAT-OKS AND
                   OPC-CIC-IOPC IN SRT = EVC-CIC-IOPC IN EVC)
               GO TO FIN-GET-EVC.
           GO TO LUP-GET-EVC.
       FIN-GET-EVC.
           EXIT.
      ******************************************************************
       GET-CYA SECTION.
       INI-GET-CYA.
           MOVE ZEROES TO WSS-NUM-ICYA IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-ICA1 IN WSS-LI2.
           MOVE ZEROES TO WSS-SGV-VCA1 IN WSS-LI2.
           MOVE SPACES TO WSS-GLS-ICA2 IN WSS-LI2.
           MOVE ZEROES TO WSS-SGV-VCA2 IN WSS-LI2.
           MOVE SPACES TO WSS-GLS-ICA3 IN WSS-LI2.
           MOVE ZEROES TO WSS-SGV-VCA3 IN WSS-LI2.
           MOVE SPACES TO WSS-GLS-ICA4 IN WSS-LI2.
           MOVE ZEROES TO WSS-SGV-VCA4 IN WSS-LI2.
           MOVE OPC-CIC-IOPC IN SRT TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN SRT = CYA-CIC-IOPC IN CYA )
               GO TO FIN-GET-CYA.
      *DAD ini  13-MAY-1991
           PERFORM GET-CUR-ROV.
           IF WSS-NUM-RENO IN WSS-VARI > ZEROES
               MOVE 1 TO WSS-IMAX IN WSS-VARI
           ELSE
               MOVE 4 TO WSS-IMAX IN WSS-VARI.
      *DAD fin  13-MAY-1991
       LUP-GET-CYA.
           IF CYA-NUM-ICAN IN CYA > ZEROES
               GO TO NXT-GET-CYA.
           IF CYA-IIC-ICYA IN CYA = '00000000'
               MOVE SPACES TO CYA-IIC-ICYA IN CYA.
           ADD 1 TO WSS-NUM-ICYA IN WSS-VARI.
           IF WSS-NUM-ICYA IN WSS-VARI > WSS-IMAX IN WSS-VARI
      *DAD ini  13-MAY-1991
               IF WSS-NUM-RENO IN WSS-VARI NOT > ZEROES
                   ADD  CYA-SGV-LIQU IN CYA TO WSS-SGV-VCA4 IN WSS-LI2
                   MOVE WSS-DES-M4AL IN WSS-VARI TO WSS-GLS-ICA4
                                                            IN WSS-LI2
                   GO TO NXT-GET-CYA
               ELSE
                   ADD  CYA-SGV-LIQU IN CYA TO WSS-SGV-VCA1 IN WSS-LI2
                   MOVE WSS-DES-M4AL IN WSS-VARI TO WSS-GLS-ICA1
                                                            IN WSS-LI2
                   GO TO NXT-GET-CYA.
      *DAD fin  13-MAY-1991
           PERFORM BUS-MOV.
           PERFORM BUS-TCYA.
           IF WSS-NUM-ICYA IN WSS-VARI = 1
               STRING WSS-ABR-MOV  IN WSS-VARI
                      WSS-GLS-SPAC IN WSS-VARI
                      WSS-ABR-TCYA IN WSS-VARI
                      WSS-GLS-SPAC IN WSS-VARI
                      CYA-IIC-ICYA IN CYA DELIMITED BY SIZE INTO
                                           WSS-GLS-ICA1 IN WSS-LI2
               MOVE CYA-SGV-LIQU IN CYA TO WSS-SGV-VCA1 IN WSS-LI2
           ELSE
           IF WSS-NUM-ICYA IN WSS-VARI = 2
               STRING WSS-ABR-MOV  IN WSS-VARI
                      WSS-GLS-SPAC IN WSS-VARI
                      WSS-ABR-TCYA IN WSS-VARI
                      WSS-GLS-SPAC IN WSS-VARI
                      CYA-IIC-ICYA IN CYA DELIMITED BY SIZE INTO
                                           WSS-GLS-ICA2 IN WSS-LI2
               MOVE CYA-SGV-LIQU IN CYA TO WSS-SGV-VCA2 IN WSS-LI2
           ELSE
           IF WSS-NUM-ICYA IN WSS-VARI = 3
               STRING WSS-ABR-MOV  IN WSS-VARI
                      WSS-GLS-SPAC IN WSS-VARI
                      WSS-ABR-TCYA IN WSS-VARI
                      WSS-GLS-SPAC IN WSS-VARI
                      CYA-IIC-ICYA IN CYA DELIMITED BY SIZE INTO
                                           WSS-GLS-ICA3 IN WSS-LI2
      *DAD ini  13-MAY-1991
               MOVE CYA-SGV-LIQU IN CYA TO WSS-SGV-VCA3 IN WSS-LI2
           ELSE
           IF WSS-NUM-ICYA IN WSS-VARI = 4
               STRING WSS-ABR-MOV  IN WSS-VARI
                      WSS-GLS-SPAC IN WSS-VARI
                      WSS-ABR-TCYA IN WSS-VARI
                      WSS-GLS-SPAC IN WSS-VARI
                      CYA-IIC-ICYA IN CYA DELIMITED BY SIZE INTO
                                           WSS-GLS-ICA4 IN WSS-LI2
               MOVE CYA-SGV-LIQU IN CYA TO WSS-SGV-VCA4 IN WSS-LI2.
      *DAD fin  13-MAY-1991
       NXT-GET-CYA.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN SRT = CYA-CIC-IOPC IN CYA
              GO TO LUP-GET-CYA.
           MOVE '00' TO FIO-STAT.
       FIN-GET-CYA.
           EXIT.
      *-----------------------------------------------------------------
      *DAD ini  13-MAY-1991
       GET-CUR-ROV SECTION.
       INI-GET-CUR-ROV.
           MOVE ZEROES TO WSS-NUM-RENO IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN SRT TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN SRT = ROV-CIC-IOPC IN ROV )
               GO TO FIN-GET-CUR-ROV.
           MOVE  1  TO WSS-NUM-RENO IN WSS-VARI.
           STRING 'PAGA '
                  ROV-CIC-IOPV IN ROV
                  WSS-GLS-SPAC IN WSS-VARI
                  ROV-NUM-IVCT IN ROV DELIMITED BY SIZE INTO
                                       WSS-GLS-ICA2 IN WSS-LI2.
           MOVE ROV-SGV-RENO IN ROV TO WSS-SGV-VCA2 IN WSS-LI2.
       NXT-GET-CUR-ROV.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN SRT = ROV-CIC-IOPC IN ROV )
               GO TO FIN-GET-CUR-ROV.
           ADD  1  TO WSS-NUM-RENO IN WSS-VARI.
           IF WSS-NUM-RENO IN WSS-VARI = 2
               STRING 'PAGA '
                      ROV-CIC-IOPV IN ROV
                      WSS-GLS-SPAC IN WSS-VARI
                      ROV-NUM-IVCT IN ROV DELIMITED BY SIZE INTO
                                           WSS-GLS-ICA3 IN WSS-LI2
               MOVE ROV-SGV-RENO IN ROV TO WSS-SGV-VCA3 IN WSS-LI2
           ELSE
           IF WSS-NUM-RENO IN WSS-VARI = 3
               STRING 'PAGA '
                      ROV-CIC-IOPV IN ROV
                      WSS-GLS-SPAC IN WSS-VARI
                      ROV-NUM-IVCT IN ROV DELIMITED BY SIZE INTO
                                           WSS-GLS-ICA4 IN WSS-LI2
               MOVE ROV-SGV-RENO IN ROV TO WSS-SGV-VCA4 IN WSS-LI2
           ELSE
           IF WSS-NUM-RENO IN WSS-VARI > 3
               MOVE 'MULTIPLES'        TO WSS-GLS-ICA4 IN WSS-LI2
               ADD ROV-SGV-RENO IN ROV TO WSS-SGV-VCA4 IN WSS-LI2.
           GO TO NXT-GET-CUR-ROV.
       FIN-GET-CUR-ROV.
           EXIT.
      *DAD fin  13-MAY-1991
      *-----------------------------------------------------------------
       BUS-MOV SECTION.
       INI-BUS-MOV.
           IF CYA-NUM-ICAN IN CYA > ZEROES
               MOVE 'C' TO TAB-CIC-CTAB IN TAB
           ELSE
               MOVE 'A' TO TAB-CIC-CTAB IN TAB.
           IF CYA-SGV-LIQU IN CYA < ZEROES
               MOVE CYA-SGV-LIQU IN CYA TO WSS-SGV-LIQU IN WSS-VARI
               MOVE WSS-SGV-LIQU IN WSS-VARI TO CYA-SGV-LIQU IN CYA
               MOVE 'C' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'MOV' TO TAB-CIC-TTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-ABRV IN TAB TO WSS-ABR-MOV IN WSS-VARI.
       FIN-BUS-MOV.
           EXIT.
      *-----------------------------------------------------------------
       BUS-TCYA SECTION.
       INI-BUS-TCYA.
           IF CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-ABRV IN MSC TO WSS-ABR-TCYA IN WSS-VARI
           ELSE
               MOVE SPACES TO WSS-ABR-TCYA IN WSS-VARI.
       FIN-BUS-TCYA.
           EXIT.
      ******************************************************************
       BUS-WSS-GLS-MSG SECTION.
       INI-BUS-WSS-GLS-MSG.
           MOVE SPACES TO WSS-GLS-MSG1 IN WSS-LI2.
           MOVE SPACES TO WSS-GLS-MSG2 IN WSS-LI2.
           MOVE 'COL'  TO RCE-COD-SIST IN RCE.
           MOVE 'LIC'  TO RCE-COD-ENTI IN RCE.
           MOVE SPACES TO RCE-GLS-IENT IN RCE.
           MOVE SPACES TO RCE-COD-SENT IN RCE.
           MOVE 'RCE-KEY-IENT' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-RCE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE RCE-CIC-IENT IN RCE TO CMT-CIC-IENT IN CMT.
           MOVE SPACES              TO CMT-FEC-FCMT IN CMT.
           MOVE ZEROES              TO CMT-NUM-ICMT IN CMT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT )
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE CMT-GLS-REFE IN CMT TO WSS-GLS-MSG1 IN WSS-LI2.
           MOVE CMT-GLS-FILL IN CMT TO WSS-GLS-MSG2 IN WSS-LI2.
       FIN-BUS-WSS-GLS-MSG.
           EXIT.
      **************************************************************************
      *DAD ini  23-SEP-1994    (Memo.22-09-94)
       FIL-IMP-DET-MAIL SECTION.
       INI-FIL-IMP-DET-MAIL.
      * Proceso que Llena e Imprime Verticalmente lineas de Detalle(MAIL)
           MOVE DBC-GLS-NOMC IN SRT TO WSS-GLS-MAI1 IN WSS-VARI.
           MOVE RCD-GLS-DIRE IN SRT TO WSS-GLS-MAI2 IN WSS-VARI.
           MOVE WSS-GLS-COMU IN SRT TO WSS-GLS-MAI3 IN WSS-VARI.
      *RVM-CST-INI 10-JUN-1997
           MOVE OPC-CIC-IOPC IN SRT TO BAR-CIC-OPER IN BAR-VARI.
           MOVE 'COL'               TO BAR-COD-SIST IN BAR-VARI.
           MOVE 15                  TO BAR-NUM-LRGO IN BAR-VARI.
           PERFORM CAL-BAR.
           MOVE BAR-GLS-BARRA IN BAR-VARI TO WSS-GLS-MAI4 IN WSS-VARI.
           MOVE BAR-COD-BARRA IN BAR-VARI TO WSS-GLS-MAI5 IN WSS-VARI.
      *RVM-CST-FIN 10-JUN-1997
           PERFORM IMP-DET-MAIL VARYING WSS-IND FROM 40 BY -1 UNTIL
                                        WSS-IND < 1.
      *RVM-CST-INI 10-JUN-1997
           MOVE 77 TO LINE-COUNTER.
           PERFORM IMP-COD-BAR VARYING WSS-IND FROM 40 BY -1 UNTIL
                                        WSS-IND < 1.
      *RVM-CST-FIN 10-JUN-1997
           MOVE 77 TO LINE-COUNTER.
       FIN-FIL-IMP-DET-MAIL.
           EXIT.
      *DAD fin  23-SEP-1994
      *-----------------------------------------------------------------
      *DAD ini  23-SEP-1994    (Memo.22-09-94)
      * Proceso que Imprime Verticalmente lineas de Detalle(MAIL)
       IMP-DET-MAIL SECTION.
       INI-IMP-DET-MAIL.
           MOVE WSS-IND-MAI1 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI1 IN WSS-LI1.
           MOVE WSS-IND-MAI2 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI2 IN WSS-LI1.
           MOVE WSS-IND-MAI3 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI3 IN WSS-LI1.
      *RVM-CST-INI 10-JUN-1997
      *    GENERATE DL-HDR.
           MOVE WSS-IND-MAI4 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI4 IN WSS-LI1.
           GENERATE DL-HDR1.
      *RVM-CST-FIN 10-JUN-1997

       FIN-IMP-DET-MAIL.
      *DAD fin  23-SEP-1994
      *RVM-CST-INI 10-JUN-1997
           EXIT.

       IMP-COD-BAR SECTION.
       INI-IMP-COD-BAR.
           MOVE WSS-IND-MAI5 IN WSS-VARI(WSS-IND) TO
                WSS-GLS-MAI5 IN WSS-LI1.
           GENERATE DL-HDR2.
       FIN-IMP-COD-BAR.
           EXIT.
      *RVM-CST-FIN 10-JUN-1997

      ******************************************************************
       GEN-DDD SECTION.
       INI-GEN-DDD.
           MOVE ZEROES                   TO WSS-NUM-TVCT IN WSS-DDD.
           MOVE ZEROES                   TO WSS-VAL-TDLC IN WSS-DDD.
           MOVE ZEROES                   TO WSS-VAL-TINT IN WSS-DDD.
           MOVE ZEROES                   TO WSS-VAL-TIMP IN WSS-DDD.
           MOVE WSS-ABR-MRXL IN WSS-VARI TO WSS-GLS-DLEY IN WSS-DDD.
           MOVE WSS-DCO-VCOC IN WSS-VARI TO WSS-GLS-VCOC IN WSS-DDD.
           MOVE 1 TO WSS-NUM-PAGE IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN SRT TO VEN-CIC-IOPC IN VEN.
           MOVE OPC-CIC-IOPC IN SRT TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
      *ALD
      * Que se debe mover al VEN-NUM-IVEN ?
      *    MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE ZEROES TO VEN-NUM-IVEN IN VEN
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF NOT ( FIO-STAT-OKS AND
                  OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN )
                   MOVE ZEROES TO VEN-NUM-IVEN IN VEN
               ELSE
                   MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN IN VEN.
      *
           MOVE FIO-GET-NLS TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM COL-FIO-VEN
               IF NOT ( FIO-STAT-OKS AND
                  OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN )
                   MOVE ZEROES TO VEN-VAL-CAPI IN VEN
                   MOVE ZEROES TO VEN-VAL-FINA IN VEN
                   MOVE ZEROES TO VEN-FEC-FVEN IN VEN
                   MOVE ZEROES TO VEN-NUM-IVCT IN VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-OBT-VEN
      *AAA Ahora se pregunta por VEN-IND-CALC
      *        IF NOT ( VEN-STAT-OKS OR VEN-STAT-TVX )
      *Fin
               IF NOT VEN-STAT-OKS
                       MOVE ZEROES TO VEN-VAL-CAPI IN VEN
                       MOVE ZEROES TO VEN-VAL-FINA IN VEN
                       MOVE ZEROES TO VEN-FEC-FVEN IN VEN
                       MOVE ZEROES TO VEN-NUM-IVCT IN VEN.
           GENERATE DL-HDDD.
       LUP-GEN-DDD.
           IF VEN-FEC-FVEN IN VEN NOT > ZEROES
               GO TO NUM-DIAS.
           MOVE OPC-NUM-DCOL IN SRT TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN SRT TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN SRT TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN SRT TO FEC-AEC1.
      * RBG/INI/21-NOV-1996 
      *     MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC2.
      *     MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC2.
      *     MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC2.
      *     MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC2.
           MOVE VEN-NUM-DIMV IN VEN TO FEC-DEC2.
           MOVE VEN-NUM-MIMV IN VEN TO FEC-MEC2.
           MOVE VEN-NUM-SIMV IN VEN TO FEC-SEC2.
           MOVE VEN-NUM-AIMV IN VEN TO FEC-AEC2.
      * RBG/FIN/21-NOV-1996 
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-NDIA TO WSS-NUM-DIAS IN WSS-DDD.
       NUM-DIAS.
      *AAA Ahora se pregunta por VEN-IND-CALC
      *     IF VEN-VAL-FINA IN VEN NOT > ZEROES
      *Fin
      *Si esta incompleto en terminos de capital, marca indicador
      *para no desplegar valores en el ultimo VEN
           IF VEN-IND-CALC IN VEN = 'N' AND VEN-VAL-FINA > ZEROES
               MOVE 'N' TO WSS-IND-DULT.
      *
           IF VEN-IND-CALC IN VEN = 'N'
               MOVE ZEROES TO WSS-VAL-INTE IN WSS-DDD
               IF OPC-IND-VSTR IN OPC = 'S' AND AYF-IULT-YES
                   IF WSS-IND-DULT = 'N' AND ( CIC-OPEC NOT = 'B' )
                       MOVE ZEROES TO VEN-VAL-CAPI IN VEN
                       MOVE ZEROES TO VEN-VAL-FINA IN VEN
                   ELSE
                       MOVE ZEROES TO VEN-VAL-FINA IN VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               SUBTRACT VEN-VAL-CAPI IN VEN FROM VEN-VAL-FINA IN VEN
                                      GIVING WSS-VAL-INTE IN WSS-DDD.
           MOVE OPC-CIC-IOPC IN SRT TO DLC-CIC-IOPC IN DLC.
           IF VEN-NUM-IDLC IN VEN > ZEROES
               MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC
           ELSE
               MOVE VEN-NUM-IVCT IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE DLC ASOCIADO A VENCIMIENTO PARA : '
                        OPC-CIC-IOPC IN SRT.
           MOVE ZEROES TO WSS-SGV-TASA IN WSS-DDD.
           PERFORM GET-ICG-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM GET-ICG-OPC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO WSS-GLS-TASA IN WSS-DDD
                   MOVE ZEROES TO WSS-SGV-TASA IN WSS-DDD
                   GO TO CON-GEN-DDD.
      *ALD/ RUTINA INTERESES
           MOVE ICG-COD-TINT IN ICG TO INT-TIPT.
           IF ICG-COD-CVTI IN ICG NOT > SPACES
               MOVE ICG-SGV-TINT IN ICG TO INT-TINT
           ELSE
               MOVE ICG-SGV-SPRD IN ICG TO INT-TINT.
           MOVE OPC-NUM-DCOL IN SRT     TO INT-DDMA.
           MOVE OPC-NUM-MCOL IN SRT     TO INT-MDMA.
           MOVE OPC-NUM-SCOL IN SRT     TO INT-SDMA.
           MOVE OPC-NUM-ACOL IN SRT     TO INT-ADMA.
           MOVE WSS-NUM-DIAS IN WSS-DDD TO INT-SEPA INT-SEPD.
           MOVE OPC-COD-VCOC IN SRT     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE 'COL'    TO MSG-COD-SIST
               MOVE INT-CMSG TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC INT-MENS
      *DAD ini  13-APR-1992
               MOVE 0 TO INT-TIPE
           ELSE
      * Si Tasa Intereses es Vencida la transforma a Anticipada para D.D.
               IF INT-BCTI = 'V'
                   MOVE INT-TIPE TO WSS-INT-TIPE IN WSS-VARI
                   ADD 1 TO INT-TIPE
                   DIVIDE WSS-INT-TIPE IN WSS-VARI BY INT-TIPE GIVING
                                                      INT-TIPE ROUNDED.
           MULTIPLY INT-TIPE BY 100 GIVING WSS-SGV-TPER IN WSS-DDD.
      *DAD fin  13-APR-1992
      *ALD/ RUTINA INTERESES
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO WSS-SGV-TASA IN WSS-DDD
           ELSE
               MOVE ICG-SGV-TINT IN ICG TO WSS-SGV-TASA IN WSS-DDD.
           IF ICG-COD-TINT IN ICG > SPACES
               MOVE 'COL'               TO TAB-COD-SIST
               MOVE 'INT'               TO TAB-COD-TTAB IN TAB
               MOVE ICG-COD-TINT IN ICG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-TASA IN WSS-DDD
           ELSE
               MOVE SPACES TO WSS-GLS-TASA IN WSS-DDD.
       CON-GEN-DDD.
           ADD 1 TO WSS-NUM-TVCT IN WSS-DDD.
      *    ADD DLC-VAL-NDLC IN DLC TO WSS-VAL-TDLC IN WSS-DDD.
           ADD VEN-VAL-FINA IN VEN TO WSS-VAL-TDLC IN WSS-DDD.
           ADD DLC-VAL-IMPU IN DLC TO WSS-VAL-TIMP IN WSS-DDD
           MOVE DLC-CIC-IOPC IN DLC TO RDC-CIC-IOPC IN RDC.
           MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC
               GO TO CON-DDD.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               PERFORM RST-DBC.
       CON-DDD.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO WSS-GLS-NACP IN WSS-DDD.
           MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-IACP IN WSS-DDD.
           MOVE DBC-VRF-ICLI IN DBC TO WSS-VRF-IACP IN WSS-DDD.
           MOVE DBC-GLS-ICLI IN DBC TO WSS-GLS-IACP IN WSS-DDD.
           MOVE DBC-IND-ICLI IN DBC TO WSS-IND-IACP IN WSS-DDD.
           IF DBC-GLS-ICLI IN DBC > SPACES
               MOVE '-' TO WSS-GUI-IACP IN WSS-DDD
           ELSE
               MOVE SPACES TO WSS-GUI-IACP IN WSS-DDD.
           IF LINE-COUNTER > WSS-NUM-LIDD IN WSS-VARI
               MOVE 'CONTINUA EN OTRA HOJA' TO WSS-GLS-NXPG IN WSS-DDD
               GENERATE DL-DDD
               MOVE SPACES     TO WSS-GLS-NXPG IN WSS-DDD
               MOVE 'PAGINA :' TO WSS-GLS-PAGE IN WSS-DDD
               ADD 1 TO WSS-NUM-PAGE IN WSS-VARI
               MOVE WSS-NUM-PAGE IN WSS-VARI TO WSS-NUM-PAGE IN WSS-DDD
      *DAD ini  18-JUL-1991
      **ALD Solo IBM
      *         MOVE 67 TO LINE-COUNTER
      **
      *DAD ini  23-SEP-1994    (Memo.22-09-94)
      *         MOVE 73 TO LINE-COUNTER
               MOVE 77 TO LINE-COUNTER
      * Proceso que Llena e Imprime Verticalmente lineas de Detalle(MAIL)
               PERFORM FIL-IMP-DET-MAIL
      *DAD fin  23-SEP-1994
               GENERATE DL-LI1
               GENERATE DL-LI2
      *DAD fin  18-JUL-1991
               GENERATE DL-HDDD
           ELSE
               MOVE '---------------------' TO WSS-GLS-NXPG IN WSS-DDD
               GENERATE DL-DDD.
           ADD WSS-VAL-INTE IN WSS-DDD TO WSS-VAL-TINT IN WSS-DDD.
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS AND
                  OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN
                   GO TO LUP-GEN-DDD
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS OR VEN-STAT-TVX
                   GO TO LUP-GEN-DDD
               ELSE
                   IF ( VEN-STAT NOT = VEN-SEOF )
                       MOVE 'COL'    TO MSG-COD-SIST
                       MOVE VEN-STAT TO MSG-COD-MENS IN MSG
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC IN MSG '/'
                               VEN-CIC-IOPC IN VEN
                       GO TO FIN-GEN-DDD.
           GENERATE DL-FIN.

      * RBG/INI/12-NOV-1996 
      *     MOVE DBC-NUM-ICLI IN SRT TO DBC-NUM-ICLI IN DBC.
      *     MOVE DBC-VRF-ICLI IN SRT TO DBC-VRF-ICLI IN DBC.
      *     MOVE DBC-IND-ICLI IN SRT TO DBC-IND-ICLI IN DBC.
      *     MOVE DBC-GLS-ICLI IN SRT TO DBC-GLS-ICLI IN DBC.
      *     MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM SGC-FIO-DBC.
      *     IF NOT FIO-STAT-OKS
      *         DISPLAY 'NO SE ENCONTRO REGISTRO DBC PARA OPC: '
      *         GO TO FIN-GEN-DDD.
      *
      *     IF DBC-IND-TICL IN DBC = 'P'
      *         MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
      *         MOVE FIO-GET-KEY TO FIO-CMND
      *         PERFORM SGC-FIO-DCP
      *         IF NOT FIO-STAT-OKS
      *             DISPLAY 'NO SE ENCONTRO REGISTRO DCP.. '
      *             GO TO FIN-GEN-DDD
      *         ELSE
      *             IF DCP-COD-TBAN IN DCP = 'EM ' OR
      *                DCP-COD-TBAN IN DCP = 'EG ' OR
      *                DCP-COD-TBAN IN DCP = 'EQ '
      *                 ADD 17 TO LINE-COUNTER
      *                 IF LINE-COUNTER > WSS-NUM-LIDD IN WSS-VARI
      *                     MOVE 'CONTINUA EN OTRA HOJA' TO WSS-GLS-NXPG
      *                                                        IN WSS-DDD
      *                     SUBTRACT 17 FROM LINE-COUNTER
      *                     GENERATE DL-FCDP
      *                     MOVE 77 TO LINE-COUNTER
      *                     PERFORM FIL-IMP-DET-MAIL
      *                     GENERATE DL-LI1
      *                     GENERATE DL-LI2
      *                     ADD 1 TO WSS-NUM-PAGE IN WSS-VARI
      *                     MOVE 'PAGINA :'    TO WSS-GLS-PAGE IN WSS-DDD
      *                     MOVE WSS-NUM-PAGE IN WSS-VARI TO WSS-NUM-PAGE
      *                                                        IN WSS-DDD
      *                     GENERATE DL-LIT
      *                 ELSE
      *                     SUBTRACT 17 FROM LINE-COUNTER
      *                     GENERATE DL-LIT
      *             ELSE
      *                GO TO FIN-GEN-DDD
      *     ELSE
      *        IF DBC-IND-TICL IN DBC = 'E'
      *            MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
      *            MOVE FIO-GET-KEY TO FIO-CMND
      *            PERFORM SGC-FIO-DCE
      *            IF NOT FIO-STAT-OKS
      *                DISPLAY ' NO SE ENCONTRO REGISTRO DCE.. '
      *                GO TO FIN-GEN-DDD
      *            ELSE
      *               IF DCE-COD-TBAN IN DCE = 'EM ' OR
      *                  DCE-COD-TBAN IN DCE = 'EG ' OR
      *                  DCE-COD-TBAN IN DCE = 'EQ '
      *                   ADD 17 TO LINE-COUNTER
      *                   IF LINE-COUNTER > WSS-NUM-LIDD IN WSS-VARI
      *                       MOVE 'CONTINUA EN OTRA HOJA' TO
      *                                           WSS-GLS-NXPG IN WSS-DDD
      *                       SUBTRACT 17 FROM LINE-COUNTER
      *                       GENERATE DL-FCDP
      *                       MOVE 77 TO LINE-COUNTER
      *                       PERFORM FIL-IMP-DET-MAIL
      *                       GENERATE DL-LI1
      *                       GENERATE DL-LI2
      *                       ADD 1 TO WSS-NUM-PAGE IN WSS-VARI
      *                       MOVE 'PAGINA :'  TO WSS-GLS-PAGE IN WSS-DDD
      *                       MOVE WSS-NUM-PAGE IN WSS-VARI TO
      *                                           WSS-NUM-PAGE IN WSS-DDD
      *                       GENERATE DL-LIT
      *                   ELSE
      *                       SUBTRACT 17 FROM LINE-COUNTER
      *                       GENERATE DL-LIT.
      * RBG/FIN/12-NOV-1996 
       FIN-GEN-DDD.
           EXIT.
      *-----------------------------------------------------------------
       GET-ICG-DLC SECTION.
       INI-GET-ICG-DLC.
           MOVE DLC-CAI-IOPC IN DLC TO ICG-CAI-IOPC IN ICG.
           MOVE DLC-IIC-IOPC IN DLC TO ICG-IIC-IOPC IN ICG.
           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CAI-IOPC IN ICG = DLC-CAI-IOPC IN DLC AND
                    ICG-IIC-IOPC IN ICG = DLC-IIC-IOPC IN DLC AND
                    ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
                     PERFORM GET-ICG-OPC.
       FIN-GET-ICG-DLC.
           EXIT.
      *-----------------------------------------------------------------
       GET-ICG-OPC SECTION.
       INI-GET-ICG-OPC.
           MOVE OPC-CIC-IOPC IN SRT TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN SRT AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
                     MOVE '23' TO FIO-STAT.
       FIN-GET-ICG-OPC.
           EXIT.
      *-----------------------------------------------------------------
       RST-DBC SECTION.
       INI-RST-DBC.
           MOVE 'CLIENTE INEXISTENTE' TO DBC-GLS-NOMC IN DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-IND-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
       FIN-RST-DBC.
           EXIT.
      ******************************************************************
       GEN-C1V SECTION.
       INI-GEN-C1V.
           MOVE WSS-DCO-VCOC IN WSS-VARI TO WSS-GLS-VCOC IN WSS-C1V.
           MOVE OPC-CIC-IOPC IN SRT TO VEN-CIC-IOPC IN VEN.
      *ALD
      * Que se debe mover al VEN-NUM-IVEN ?
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
      *
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN )
               MOVE ZEROES TO VEN-VAL-CAPI IN VEN
               MOVE ZEROES TO VEN-VAL-FINA IN VEN
               MOVE ZEROES TO VEN-FEC-FVEN IN VEN.
           IF VEN-FEC-FVEN IN VEN NOT > ZEROES
               GO TO NUM-DIAS.
           MOVE OPC-NUM-DCOL IN SRT TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN SRT TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN SRT TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN SRT TO FEC-AEC1.
      * RBG/INI/21-NOV-1996 
      *     MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC2.
      *     MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC2.
      *     MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC2.
      *     MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC2.
           MOVE VEN-NUM-DIMV IN VEN TO FEC-DEC2.
           MOVE VEN-NUM-MIMV IN VEN TO FEC-MEC2.
           MOVE VEN-NUM-SIMV IN VEN TO FEC-SEC2.
           MOVE VEN-NUM-AIMV IN VEN TO FEC-AEC2.
      * RBG/FIN/ 21-NOV-1996 
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
      *    PERFORM PRO-FEC.
           PERFORM CAL-FEC.
           MOVE FEC-NDIA TO WSS-NUM-DIAS IN WSS-C1V.
       NUM-DIAS.
      *AAA Ahora se pregunta por VEN-IND-CALC
      *    IF VEN-VAL-FINA IN VEN NOT > ZEROES
      *Fin
      *Si esta incompleto en terminos de capital, marca indicador
      *para no desplegar valores en el ultimo VEN
           IF VEN-IND-CALC IN VEN = 'N' AND VEN-VAL-FINA > ZEROES
               MOVE 'N' TO WSS-IND-DULT.
      *
           IF VEN-IND-CALC IN VEN = 'N'
               MOVE ZEROES TO WSS-VAL-INTE IN WSS-C1V
               IF OPC-IND-VSTR IN OPC = 'S' AND AYF-IULT-YES
                   IF WSS-IND-DULT = 'N' AND ( CIC-OPEC NOT = 'B' )
                       MOVE ZEROES TO VEN-VAL-CAPI IN VEN
                       MOVE ZEROES TO VEN-VAL-FINA IN VEN
                   ELSE
                       MOVE ZEROES TO VEN-VAL-FINA IN VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               SUBTRACT VEN-VAL-CAPI IN VEN FROM VEN-VAL-FINA IN VEN
                                      GIVING WSS-VAL-INTE IN WSS-C1V.
      *Control para boleta de garantia
           IF CIC-OPEC = 'B' AND VEN-VAL-CAPI IN VEN > ZEROES
      *En el caso de 1 vencimiento : en general el VEN ya esta calculado
      *con final = capital + intereses, por lo tanto :
               IF VEN-VAL-FINA IN VEN > VEN-VAL-CAPI IN VEN
                   SUBTRACT VEN-VAL-CAPI IN VEN FROM VEN-VAL-FINA IN VEN
                                      GIVING WSS-VAL-INTE IN WSS-C1V
                   MOVE WSS-VAL-INTE IN WSS-C1V TO VEN-VAL-FINA IN VEN
               ELSE
                   MOVE VEN-VAL-FINA IN VEN TO WSS-VAL-INTE IN WSS-C1V.
      *
      *ALD/ RUTINA INTERESES
           MOVE ICG-COD-TINT IN ICG TO INT-TIPT.
           IF ICG-COD-CVTI IN ICG NOT > SPACES
               MOVE ICG-SGV-TINT IN ICG TO INT-TINT
           ELSE
               MOVE ICG-SGV-SPRD IN ICG TO INT-TINT.
           MOVE OPC-NUM-DCOL IN SRT TO INT-DDMA.
           MOVE OPC-NUM-MCOL IN SRT TO INT-MDMA.
           MOVE OPC-NUM-SCOL IN SRT TO INT-SDMA.
           MOVE OPC-NUM-ACOL IN SRT TO INT-ADMA.
           MOVE WSS-NUM-DIAS IN WSS-C1V TO INT-SEPA INT-SEPD.
           MOVE OPC-COD-VCOC IN SRT TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
               MOVE 'COL'    TO MSG-COD-SIST
               MOVE INT-CMSG TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC INT-MENS
               MOVE 0 TO WSS-SGV-TIPE IN WSS-C1V
           ELSE
               MULTIPLY INT-TIPE BY 100 GIVING WSS-SGV-TIPE IN WSS-C1V.
      *ALD/ RUTINA INTERESES
      *RVM-CST-INI 21-AUG-1996
      *SI ES TASA VARIABLE, NO DEBE DESPLEGAR TASA INTERES DEL PERIODO
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ZEROES TO WSS-SGV-TIPE IN WSS-C1V.
      *RVM-CST-FIN 21-AUG-1996
           GENERATE DL-C1V.

      * RBG/INI/12-NOV-1996 
           IF CIC-OPEC = 'B'
               GO TO FIN-GEN-C1V.

           MOVE DBC-NUM-ICLI IN SRT TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN SRT TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN SRT TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN SRT TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO SE ENCONTRO REGISTRO DBC PARA OPC: '
              GO TO FIN-GEN-C1V.
           
           IF DBC-IND-TICL IN DBC = 'P'
               MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCP
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO SE ENCONTRO REGISTRO DCP.. '
                   GO TO FIN-GEN-C1V
               ELSE
                   IF DCP-COD-TBAN IN DCP = 'EM ' OR
                      DCP-COD-TBAN IN DCP = 'EG ' OR
                      DCP-COD-TBAN IN DCP = 'EQ '
                       GENERATE DL-LIT
                   ELSE
                      GO TO FIN-GEN-C1V
           ELSE
              IF DBC-IND-TICL IN DBC = 'E'
                  MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
                  MOVE FIO-GET-KEY TO FIO-CMND
                  PERFORM SGC-FIO-DCE
                  IF NOT FIO-STAT-OKS
                      DISPLAY ' NO SE ENCONTRO REGISTRO DCE.. '
                      GO TO FIN-GEN-C1V
                  ELSE
                      IF DCE-COD-TBAN IN DCE = 'EM ' OR
                         DCE-COD-TBAN IN DCE = 'EG ' OR
                         DCE-COD-TBAN IN DCE = 'EQ '
                          GENERATE DL-LIT.
      * RBG/FIN/12-NOV-1996 
       FIN-GEN-C1V.
           EXIT.
      ******************************************************************
       GEN-CDP SECTION.
       INI-GEN-CDP.
           MOVE WSS-DCO-VCOC IN WSS-VARI TO WSS-GLS-VCOC IN WSS-CDP.
           MOVE 1 TO WSS-NUM-PAGE IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN SRT TO VEN-CIC-IOPC IN VEN.
           MOVE OPC-CIC-IOPC IN SRT TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
      *ALD
      * Que se debe mover al VEN-NUM-IVEN ?
      *    MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE ZEROES TO VEN-NUM-IVEN IN VEN
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-VEN
               IF NOT ( FIO-STAT-OKS AND
                  OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN )
                   MOVE ZEROES TO VEN-NUM-IVEN IN VEN
               ELSE
                   MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN IN VEN.
      *
           MOVE FIO-GET-NLS TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM COL-FIO-VEN
               IF NOT ( FIO-STAT-OKS AND
                  OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN )
                   MOVE ZEROES TO VEN-VAL-CAPI IN VEN
                   MOVE ZEROES TO VEN-VAL-FINA IN VEN
                   MOVE ZEROES TO VEN-FEC-FVEN IN VEN
                   MOVE ZEROES TO VEN-NUM-IVCT IN VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-OBT-VEN
      *AAA Ahora se pregunta por VEN-IND-CALC
      *        IF NOT ( VEN-STAT-OKS OR VEN-STAT-TVX )
      *Fin
               IF NOT VEN-STAT-OKS
                   MOVE ZEROES TO VEN-VAL-CAPI IN VEN
                   MOVE ZEROES TO VEN-VAL-FINA IN VEN
                   MOVE ZEROES TO VEN-FEC-FVEN IN VEN
                   MOVE ZEROES TO VEN-NUM-IVCT IN VEN.
           GENERATE DL-HCDP.
       LUP-GEN-CDP.
           IF LINE-COUNTER = WSS-NUM-LICD IN WSS-VARI
               MOVE 'CONTINUA EN OTRA HOJA' TO WSS-GLS-NXPG IN WSS-CDP
               GENERATE DL-FCDP
               ADD 1 TO WSS-NUM-PAGE IN WSS-VARI
               MOVE 'PAGINA :'               TO WSS-GLS-PAGE IN WSS-CDP
               MOVE WSS-NUM-PAGE IN WSS-VARI TO WSS-NUM-PAGE IN WSS-CDP
      *DAD ini  18-JUL-1991
      **ALD Solo IBM
      *         MOVE 67 TO LINE-COUNTER
      **
      *DAD ini  23-SEP-1994    (Memo.22-09-94)
      *         MOVE 73 TO LINE-COUNTER
               MOVE 77 TO LINE-COUNTER
      * Proceso que Llena e Imprime Verticalmente lineas de Detalle(MAIL)
               PERFORM FIL-IMP-DET-MAIL
      *DAD fin  23-SEP-1994
               GENERATE DL-LI1
               GENERATE DL-LI2
      *DAD fin  18-JUL-1991
               GENERATE DL-HCDP
           ELSE
               MOVE SPACES TO WSS-GLS-NXPG IN WSS-CDP.
      *AAA Ahora se pregunta por VEN-IND-CALC
      *    IF VEN-VAL-FINA IN VEN NOT > ZEROES
      *Fin
      *Si esta incompleto en terminos de capital, marca indicador
      *para no desplegar valores en el ultimo VEN
           IF VEN-IND-CALC IN VEN = 'N' AND VEN-VAL-FINA > ZEROES
               MOVE 'N' TO WSS-IND-DULT.
      *
           IF VEN-IND-CALC IN VEN = 'N'
               MOVE ZEROES TO WSS-VAL-INTE IN WSS-CDP
               IF OPC-IND-VSTR IN OPC = 'S' AND AYF-IULT-YES
                   IF WSS-IND-DULT = 'N' AND ( CIC-OPEC NOT = 'B' )
                       MOVE ZEROES TO VEN-VAL-CAPI IN VEN
                       MOVE ZEROES TO VEN-VAL-FINA IN VEN
                   ELSE
                       MOVE ZEROES TO VEN-VAL-FINA IN VEN
               ELSE
                   NEXT SENTENCE
           ELSE
               IF OPC-IND-VSTR IN OPC = 'S' AND
                  CIC-OPEC = 'B' AND AYF-IULT-YES
                   MOVE VEN-VAL-FINA IN VEN TO WSS-VAL-INTE IN WSS-CDP
               ELSE
               SUBTRACT VEN-VAL-CAPI IN VEN FROM VEN-VAL-FINA IN VEN
                                      GIVING WSS-VAL-INTE IN WSS-CDP.
      *SMC-INI 27.09.1993

           IF WSS-COD-TCVE IN WSS-VARI = 'FP' AND
                                    VEN-IND-CALC IN VEN = 'N'
              MOVE ZEROS   TO VEN-VAL-FINA.

      *SMC-FIN 27.09.1993

      *Control para boleta de garantia
           IF CIC-OPEC = 'B' AND VEN-VAL-CAPI IN VEN > ZEROES
      *En el caso de 1 vencimiento ( EL CAMPO OPC-NUM-VCOR NO ESTA EN 1 
      *CUANDO HAY MULTIPLES EVC, POR LO TANTO PUEDE EJECUTARSE ESTE
      *PARRAFO ) : en general el VEN ya esta calculado con final =
      *capital + intereses, por lo tanto :
               IF VEN-VAL-FINA IN VEN > VEN-VAL-CAPI IN VEN
                   SUBTRACT VEN-VAL-CAPI IN VEN FROM VEN-VAL-FINA IN VEN
                                      GIVING WSS-VAL-INTE IN WSS-CDP
                   MOVE WSS-VAL-INTE IN WSS-CDP TO VEN-VAL-FINA IN VEN
               ELSE
                   MOVE VEN-VAL-FINA IN VEN TO WSS-VAL-INTE IN WSS-CDP.
      *
           GENERATE DL-CDP.
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               PERFORM COL-FIO-VEN
               IF FIO-STAT-OKS AND
                  OPC-CIC-IOPC IN SRT = VEN-CIC-IOPC IN VEN
                   GO TO LUP-GEN-CDP
               ELSE
                   NEXT SENTENCE
           ELSE
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS OR VEN-STAT-TVX
                   GO TO LUP-GEN-CDP
               ELSE
                   IF NOT ( VEN-STAT = VEN-SEOF )
                       MOVE 'COL'    TO MSG-COD-SIST
                       MOVE VEN-STAT TO MSG-COD-MENS IN MSG
                       PERFORM GET-MSG
                       DISPLAY MSG-GLS-DESC IN MSG '/'
                               VEN-CIC-IOPC IN VEN
                       GO TO FIN-GEN-CDP.

      * RBG/INI/12-NOV-1996 
           IF CIC-OPEC = 'B'
               GO TO FIN-GEN-CDP.

           MOVE DBC-NUM-ICLI IN SRT TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN SRT TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN SRT TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN SRT TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO SE ENCONTRO REGISTRO DBC PARA OPC: '
              GO TO FIN-GEN-CDP.
           
           IF DBC-IND-TICL IN DBC = 'P'
               MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCP
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO SE ENCONTRO REGISTRO DCP.. '
                   GO TO FIN-GEN-CDP
               ELSE
                   IF DCP-COD-TBAN IN DCP = 'EM ' OR
                      DCP-COD-TBAN IN DCP = 'EG ' OR
                      DCP-COD-TBAN IN DCP = 'EQ '
                       ADD 17 TO LINE-COUNTER
                       IF LINE-COUNTER > WSS-NUM-LICD IN WSS-VARI
                           MOVE 'CONTINUA EN OTRA HOJA' TO WSS-GLS-NXPG
                                                              IN WSS-CDP
                           SUBTRACT 17 FROM LINE-COUNTER
                           GENERATE DL-FCDP
                           MOVE 77 TO LINE-COUNTER
                           PERFORM FIL-IMP-DET-MAIL
                           GENERATE DL-LI1
                           GENERATE DL-LI2
                           ADD 1 TO WSS-NUM-PAGE IN WSS-VARI
                           MOVE 'PAGINA :'    TO WSS-GLS-PAGE IN WSS-CDP
                           MOVE WSS-NUM-PAGE IN WSS-VARI TO WSS-NUM-PAGE
                                                              IN WSS-CDP
                           GENERATE DL-LIT
                       ELSE
                           SUBTRACT 17 FROM LINE-COUNTER
                           GENERATE DL-LIT
                   ELSE
                      GO TO FIN-GEN-CDP
           ELSE
              IF DBC-IND-TICL IN DBC = 'E'
                  MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
                  MOVE FIO-GET-KEY TO FIO-CMND
                  PERFORM SGC-FIO-DCE
                  IF NOT FIO-STAT-OKS
                      DISPLAY ' NO SE ENCONTRO REGISTRO DCE.. '
                      GO TO FIN-GEN-CDP
                  ELSE
                     IF DCE-COD-TBAN IN DCE = 'EM ' OR
                        DCE-COD-TBAN IN DCE = 'EG ' OR
                        DCE-COD-TBAN IN DCE = 'EQ '
                         ADD 17 TO LINE-COUNTER
                         IF LINE-COUNTER > WSS-NUM-LICD IN WSS-VARI
                             MOVE 'CONTINUA EN OTRA HOJA' TO
                                                 WSS-GLS-NXPG IN WSS-CDP
                             SUBTRACT 17 FROM LINE-COUNTER
                             GENERATE DL-FCDP
                             MOVE 77 TO LINE-COUNTER
                             PERFORM FIL-IMP-DET-MAIL
                             GENERATE DL-LI1
                             GENERATE DL-LI2
                             ADD 1 TO WSS-NUM-PAGE IN WSS-VARI
                             MOVE 'PAGINA :'  TO WSS-GLS-PAGE IN WSS-CDP
                             MOVE WSS-NUM-PAGE IN WSS-VARI TO
                                                 WSS-NUM-PAGE IN WSS-CDP
                             GENERATE DL-LIT
                         ELSE
                             SUBTRACT 17 FROM LINE-COUNTER
                             GENERATE DL-LIT.
      * RBG/FIN/12-NOV-1996 
       FIN-GEN-CDP.
           EXIT.
      ******************************************************************
       COPY GNSBPFEC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBFRCE.
       COPY GNSBFCMT.
       COPY SGCBFDBC.
      * RBG/INI/12-NOV-1996
       COPY SGCBFDCE.
       COPY SGCBFDCP.
      * RBG/FIN/12-NOV-1996  
       COPY SGCBFRCD.
      *DAD ini  13-MAY-1991
       COPY COLBFROV.
      *DAD fin  13-MAY-1991
       COPY COLBFRDC.
       COPY COLBFICG.
       COPY COLBFVEN.
       COPY COLBFEVC.
       COPY COLBFDLC.
       COPY COLBFCYA.
       COPY COLBFTOC.
       COPY COLBFPOC.
       COPY COLBFRCV.
       COPY COLBGVEN.
      *DAD ini  19-NOV-1991
       COPY COLBGCTO.
      *DAD fin  19-NOV-1991
      *RVM-CST-INI 11-JUN-1997
       COPY GNSBGBAR.
      *RVM-CST-FIN 11-JUN-1997
       COPY TABBFOFI.
       COPY TABBFUSR.
       COPY TABBFVLR.
       COPY TABBFCAM.
       COPY SGCBGCLI.
       COPY GNSBGCPT.
       COPY GNSBBTAB.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY TABBVOFI.
       COPY TABBVUSR.
       COPY GNSBVTAB.
       COPY SGCBGDOM.
       COPY GNSBGPES.
      *SMC-INI 09.09.1993
       COPY COLBGINT.
      *SMC-FIN 09.09.1993
       COPY GNSBGCVI.
       COPY GNSBBMSG.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBBMSC.
      *>>>>
*% END
