      ******************************************************************
      *DAD ini  14-APR-1992
      *
      *    Proceso para Eliminar Entidades Anexas
      *                 ( DLC - VEN - EVC - RDC - ICG - CYA - RCE ) y la
      *
      *    INPUT   :  Los registros  COLBRDLC, COLBRVEN, COLBREVC, COLBR
      *                              COLBRICG, COLBRCYA, COLBRRCE y COLB
      *               Las  fios      COLBFDLC, COLBFVEN, COLBFEVC, COLBF
      *                              COLBFICG, COLBFCYA, COLBFRCE y COLB
      *               La  variable  en COLWGEOP : EOP-EOPE IN EOP-VARI.
      *
      *    OUTPUT  :  Las variables en COLWGEOP : EOP-CMSG IN EOP-VARI
      *                                           EOP-MEN2 IN EOP-VARI.
      *
      *    PERFORM :  COL-ELI-OPC.
      *
      *DAD fin  14-APR-1992
      ******************************************************************
      *DAD ini  14-APR-1992
      * Proceso para Eliminar Entidades Anexas
      *              ( DLC - VEN - EVC - RDC - ICG - CYA - RCE ) y la OP
       COL-ELI-OPC SECTION.
       INI-COL-ELI-OPC.
           MOVE SPACES TO EOP-CMSG IN EOP-VARI
                          EOP-MEN2 IN EOP-VARI.
      *-----------------------------------------------------------------
      * Proceso para Eliminar Entidad Anexa DLC
       INI-DEL-ENT-DLC-OPC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ENT-DLC-OPC.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CIC-IOPC IN DLC = OPC-CIC-IOPC IN OPC )
               GO TO INI-DEL-ENT-VEN-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NOGKU'      TO EOP-CMSG IN EOP-VARI
               MOVE DLC-KEY-IDLC IN DLC TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    NODEL'      TO EOP-CMSG IN EOP-VARI
               MOVE DLC-KEY-IDLC IN DLC TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-DEL-ENT-DLC-OPC.
      *-----------------------------------------------------------------
      * Proceso para Eliminar Entidad Anexa VEN
       INI-DEL-ENT-VEN-OPC.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ENT-VEN-OPC.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    VEN-CIC-IOPC IN VEN = OPC-CIC-IOPC IN OPC )
               GO TO INI-DEL-ENT-EVC-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    NOGKU'      TO EOP-CMSG IN EOP-VARI
               MOVE VEN-KEY-IVEN IN VEN TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    NODEL'      TO EOP-CMSG IN EOP-VARI
               MOVE VEN-KEY-IVEN IN VEN TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-DEL-ENT-VEN-OPC.
      *-----------------------------------------------------------------
      * Proceso para Eliminar Entidad Anexa EVC
       INI-DEL-ENT-EVC-OPC.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ENT-EVC-OPC.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CIC-IOPC IN EVC = OPC-CIC-IOPC IN OPC )
               GO TO INI-DEL-ENT-RDC-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               MOVE 'EVC    NOGKU'      TO EOP-CMSG IN EOP-VARI
               MOVE EVC-KEY-IEVC IN EVC TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               MOVE 'EVC    NODEL'      TO EOP-CMSG IN EOP-VARI
               MOVE EVC-KEY-IEVC IN EVC TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-DEL-ENT-EVC-OPC.
      *-----------------------------------------------------------------
      * Proceso para Eliminar Entidad Anexa RDC
       INI-DEL-ENT-RDC-OPC.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
       LUP-DEL-ENT-RDC-OPC.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC )
               GO TO INI-DEL-ENT-ICG-OPC.
           MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'RDC    NOGKU'      TO EOP-CMSG IN EOP-VARI
               MOVE RDC-KEY-IDLC IN RDC TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-DEL        TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'RDC    NODEL'      TO EOP-CMSG IN EOP-VARI
               MOVE RDC-KEY-IDLC IN RDC TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           GO TO LUP-DEL-ENT-RDC-OPC.
      *-----------------------------------------------------------------
      * Proceso para Eliminar Entidad Anexa ICG
       INI-DEL-ENT-ICG-OPC.
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES              TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE SPACES              TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ENT-ICG-OPC.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC )
               GO TO INI-DEL-ENT-CYA-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               MOVE 'ICG    NOGKU'      TO EOP-CMSG IN EOP-VARI
               MOVE ICG-KEY-IICG IN ICG TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT FIO-STAT-OKS
               MOVE 'ICG    NODEL'      TO EOP-CMSG IN EOP-VARI
               MOVE ICG-KEY-IICG IN ICG TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-DEL-ENT-ICG-OPC.
      *-----------------------------------------------------------------
      * Proceso para Eliminar Entidad Anexa CYA
       INI-DEL-ENT-CYA-OPC.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE SPACES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ENT-CYA-OPC.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CYA-CIC-IOPC IN CYA = OPC-CIC-IOPC IN OPC )
               GO TO INI-DEL-ENT-RCE-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 'CYA    NOGKU'      TO EOP-CMSG IN EOP-VARI
               MOVE CYA-KEY-ICYA IN CYA TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE 'CYA    NODEL'      TO EOP-CMSG IN EOP-VARI
               MOVE CYA-KEY-ICYA IN CYA TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-DEL-ENT-CYA-OPC.
      *-----------------------------------------------------------------
      * Proceso para Eliminar Entidad Anexa RCE
       INI-DEL-ENT-RCE-OPC.
           MOVE OPC-CIC-IOPC IN OPC TO RCE-CIC-IOPC IN RCE.
           MOVE ZEROES              TO RCE-NUM-IDLC IN RCE.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-DEL-ENT-RCE-OPC.
           PERFORM COL-FIO-RCE.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IOPC IN RCE = OPC-CIC-IOPC IN OPC )
               GO TO INI-DEL-ENT-OPC-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           IF NOT FIO-STAT-OKS
               MOVE 'RCE    NOGKU'      TO EOP-CMSG IN EOP-VARI
               MOVE RCE-KEY-IRCE IN RCE TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           IF NOT FIO-STAT-OKS
               MOVE 'RCE    NODEL'      TO EOP-CMSG IN EOP-VARI
               MOVE RCE-KEY-IRCE IN RCE TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-DEL-ENT-RCE-OPC.
      *-----------------------------------------------------------------
      * Proceso para Eliminar OPC (Se realiza cuando indicador = 0)
       INI-DEL-ENT-OPC-OPC.
           IF EOP-EOPE IN EOP-VARI = 1
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NOGKU'      TO EOP-CMSG IN EOP-VARI
               MOVE OPC-KEY-IOPC IN OPC TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NODEL'      TO EOP-CMSG IN EOP-VARI
               MOVE OPC-KEY-IOPC IN OPC TO EOP-MEN2 IN EOP-VARI
               GO TO FIN-COL-ELI-OPC.
      *-----------------------------------------------------------------
       FIN-COL-ELI-OPC.
           EXIT.
      *DAD fin  14-APR-1992
      ******************************************************************
