*%! Codigo adicional para archivo
*% HDR_CST = FALSE
*% PGM_PTC = TRUE
*% NO_TIENE_TIMESTAMP = TRUE
*% IF CMT_ID
      *<<<<
      *-------------------------------------------------------------------
      *JCT-INI 11-01-2012 Validacion y Generacion Automatizada de Productos
      * Proyecto     : Validacion y Generacion Automatizada de Productos
      * Modificacion : Jtorres
      * Objetivos    : Incorporacion nuevos campos en pantalla PO2
      *                y validaciones adicionales, Pantalla PO1
      *                asociada se debe recompilar
      * Etiqueta     :JCT-INI 11-01-2012
      *               Validacion y Generacion Automatizada de Productos 
      *JCT-FIN 11-01-2012
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY

           IF SCR-CMND = 'COM'
               PERFORM PROC-COM
               GO TO FIN-FND-KEY.

      *>>>> FND_KEY
*% END
*% IF ABT_CMN_ACC
      *<<<< ABT_CMN_ACC
               IF SCR-CMND = 'COP'
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    NOCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           IF SCR-CMND = 'COP'
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    SICOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'REG    ERCOP' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'COP'
               PERFORM UNP-IKY-DCC
               PERFORM FST-KEY-DCC.
      *>>>>
*% END
*% IF WSS
      *<<<<
      *JCT-INI 11-01-2012 VALIDACION Y GENERACION AUTOMATIZADA DE PRODUC
       COPY COLBRPOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
      *JCT-FIN 11-01-2012

       COPY COLWXDCC.

      *DAD ini
       COPY GNSWGCPT.
      *DAD fin
       COPY GNSWGHOY.
       01  WSS-VARI.
           03  WSS-CIC-VARI.
               05  WSS-CIC-TCCT                        PIC X(03).
               05  WSS-CIC-VCAM                        PIC X(06).
               05  WSS-CIC-COCR                        PIC X(06).
               05  WSS-CIC-PLZO                        PIC X(02).
               05  WSS-CIC-SCRT                        PIC X(03).
               05  WSS-CIC-SCTB                        PIC X(03).
               05  WSS-CIC-SCBZ                        PIC X(05).
      *DAD ini
           03  WSS-GLS-DATA.
               05  WSS-GLS-TIO                         PIC X(40).
               05  WSS-GLS-AUX                         PIC X(40).
           03  WSS-COD-COCR.
               05  WSS-COD-TOCR                        PIC X(03).
               05  WSS-COD-AOCR                        PIC X(03).
      *DAD fin
      *DAD ini  31-MAR-1993   (Memo.29-03-93 Pto.5.1)
           03  WSS-GLS-EXCL      VALUE 'X'             PIC X(01).
      *DAD fin  31-MAR-1993
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-INST = SCR-INST-HKY
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'COL' TO FIO-SIST
               MOVE 'DCC' TO TAB-COD-TTAB IN TAB
               PERFORM ERR-TAB.

           MOVE TSK-TERM-ALF TO DCC-COD-TERM.


           MOVE ZEROES TO TCCT-TOT.
           MOVE 'COL'  TO MSC-COD-SIST.
           MOVE 'COL' TO FIO-SIST
           MOVE 'TCCT' TO MSC-COD-TMSC IN MSC.
           MOVE SPACES TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-NLS TO FIO-CMND.


           MOVE 'STSTCCT' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 'MSCTCCT' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 'TBLTCCT' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


           MOVE 'TOTTCCT' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.



       CIC-GET-TCCT.
           PERFORM GNS-FIO-MSC.

      *     MOVE 'STSTCCT' TO QUE-COLA.
      *     MOVE +10 TO QUE-LITM.
      *     MOVE FIO-STAT TO QUE-ITEM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     PERFORM GNX-PRO-QUE.

      *     MOVE 'MSCTCCT' TO QUE-COLA.
      *     MOVE +200 TO QUE-LITM.
      *     MOVE MSC TO QUE-ITEM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     PERFORM GNX-PRO-QUE.

           IF NOT FIO-STAT-OKS
               GO TO FIN-GET-TCCT.

           IF MSC-COD-TMSC IN MSC NOT = 'TCCT'
               GO TO FIN-GET-TCCT.

           IF MSC-COD-CMSC IN MSC NOT > SPACES
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-GET-TCCT.

           ADD 1 TO TCCT-TOT.
           MOVE MSC-COD-CMSC IN MSC TO TCCT-ELM IN TCCT-VARI(TCCT-TOT).

      *     MOVE 'TBLTCCT' TO QUE-COLA.
      *     MOVE +3000 TO QUE-LITM.
      *     MOVE TCCT-VARI TO QUE-ITEM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     PERFORM GNX-PRO-QUE.

      *     MOVE 'TOTTCCT' TO QUE-COLA.
      *     MOVE +5 TO QUE-LITM.
      *     MOVE TCCT-TOT TO QUE-ITEM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     PERFORM GNX-PRO-QUE.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-GET-TCCT.

       FIN-GET-TCCT.

           MOVE 'FTBLTCCT' TO QUE-COLA.
           MOVE +3000 TO QUE-LITM.
           MOVE TCCT-VARI TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'FTOTTCCT' TO QUE-COLA.
           MOVE +5 TO QUE-LITM.
           MOVE TCCT-TOT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.





      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
*% IF PGM_PU
           MOVE ZEROES TO DCC-FEC-FTRN IN DCC.
           MOVE ZEROES TO DCC-HRA-HRTR IN DCC.
*% END
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<<
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO DCC-NUM-DTRN IN DCC.
           MOVE HOY-MHOY TO DCC-NUM-MTRN IN DCC.
           MOVE HOY-SHOY TO DCC-NUM-STRN IN DCC.
           MOVE HOY-AHOY TO DCC-NUM-ATRN IN DCC.
      *>>>> 
*% END 
*% IF EOF
      *<<<<
      *JCT-INI 11-01-2012 VALIDACION Y GENERACION AUTOMATIZADA DE PRODUC
       COPY COLBFPOC.
      *JCT-FIN 11-01-2012

      *DAD ini
       COPY GNSBGCPT.
      *DAD fin
       COPY GNSBETAB.
       COPY GNSBGHOY.

      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
      *JCT-INI 11-01-2012 VALIDACION Y GENERACION AUTOMATIZADA DE PRODUC
       VAL-REG-POC SECTION.
       INI-VAL-REG-POC.
           IF DCC-COD-VCAM IN DCC-FLD = '*     '
              GO TO FIN-VAL-REG-POC.
           IF DCC-COD-COCR IN DCC-FLD = '*     '
              GO TO FIN-VAL-REG-POC.
           MOVE DCC-COD-VCAM IN DCC-FLD TO POC-COD-VCOC IN POC.
           MOVE DCC-COD-COCR IN DCC-FLD TO POC-COD-COOC IN POC.
           MOVE 0                       TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL' TO MSG-COD-SIST                               
               MOVE 'POC    NOEXI' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-REG-POC.
           IF DCC-IND-SCRT IN DCC-FLD > SPACES              
              IF POC-SIT-CRT1 IN POC NOT = DCC-IND-SCRT IN DCC-FLD AND
                 POC-SIT-CRT2 IN POC NOT = DCC-IND-SCRT IN DCC-FLD AND
                 POC-SIT-CRT3 IN POC NOT = DCC-IND-SCRT IN DCC-FLD
                 MOVE 'COL' TO MSG-COD-SIST                               
                 MOVE 'CRTNOEXIPOC ' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                          
                 MOVE MSG-GLS-DESC TO FRM-MENS                            
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                            
                 GO TO FIN-VAL-REG-POC.
           IF DCC-IND-SCTB IN DCC-FLD > SPACES              
              IF POC-SIT-CTB1 IN POC NOT = DCC-IND-SCTB IN DCC-FLD AND
                 POC-SIT-CTB2 IN POC NOT = DCC-IND-SCTB IN DCC-FLD AND
                 POC-SIT-CTB3 IN POC NOT = DCC-IND-SCTB IN DCC-FLD
                 MOVE 'COL' TO MSG-COD-SIST                               
                 MOVE 'CTBNOEXIPOC ' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                          
                 MOVE MSG-GLS-DESC TO FRM-MENS                            
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                            
                 GO TO FIN-VAL-REG-POC.
           IF DCC-IND-SCBZ IN DCC-FLD > SPACES              
              IF POC-SIT-CBR1 IN POC NOT = DCC-IND-SCBZ IN DCC-FLD AND
                 POC-SIT-CBR2 IN POC NOT = DCC-IND-SCBZ IN DCC-FLD AND
                 POC-SIT-CBR3 IN POC NOT = DCC-IND-SCBZ IN DCC-FLD
                 MOVE 'COL' TO MSG-COD-SIST                               
                 MOVE 'CBZNOEXIPOC ' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                          
                 MOVE MSG-GLS-DESC TO FRM-MENS                            
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                            
                 GO TO FIN-VAL-REG-POC.
       FIN-VAL-REG-POC.
           EXIT.
      *JCT-FIN 11-01-2012

       PROC-COM SECTION.
       INI-PROC-COM.


           MOVE 'TCCT01' TO QUE-COLA.
           MOVE +3000 TO QUE-LITM.
           MOVE TCCT-VARI TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE 'TCCT02' TO QUE-COLA.
           MOVE +10 TO QUE-LITM.
           MOVE TCCT-TOT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'N' TO WSS-ENC-TCC.

           IF DCC-MSC-TCCT IN DCC-FLD NOT > SPACES


      *=>      BUSQUEDA DESDE EL INICIO
               MOVE 1 TO TCCT-IDX
               MOVE TCCT-ELM IN TCCT-VARI(TCCT-IDX) TO
                          DCC-MSC-TCCT IN DCC-FLD
                          DCC-MSC-TCCT IN DCC
                          
               MOVE SPACES TO DCC-COD-PLZO IN DCC
                              DCC-IND-SCRT IN DCC
                              DCC-IND-SCTB IN DCC
                              DCC-IND-SCBZ IN DCC
                     

               MOVE 'DCCNLS1' TO QUE-COLA
               MOVE +300 TO QUE-LITM
               MOVE DCC TO QUE-ITEM
               MOVE QUE-PUT TO QUE-CMND
               PERFORM GNX-PRO-QUE

                          
               MOVE FIO-GET-NLS TO FIO-CMND
           ELSE



      *=>      BUSQUEDA HAY MAS
               PERFORM BUS-TCCT VARYING TCCT-IDX FROM 1 BY 1
                  UNTIL TCCT-IDX > TCCT-TOT OR
                  WSS-ENC-TCC = 'S'

               MOVE 'TCCT05' TO QUE-COLA
               MOVE +10 TO QUE-LITM
               MOVE WSS-ENC-TCC TO QUE-ITEM
               MOVE QUE-PUT TO QUE-CMND
               PERFORM GNX-PRO-QUE

               IF WSS-ENC-TCC = 'N'
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'TCCTNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE 'S' TO SCR-IERR
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-PROC-COM
               END-IF

               MOVE 'DCCNLSS' TO QUE-COLA
               MOVE +300 TO QUE-LITM
               MOVE DCC TO QUE-ITEM
               MOVE QUE-PUT TO QUE-CMND
               PERFORM GNX-PRO-QUE


               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-DCC
               MOVE FIO-STAT TO PGM-STAT-DCC
               PERFORM PUT-ALL-DCC

               MOVE FIO-GET-NXT TO FIO-CMND.

       CIC-PROC-COM.

           MOVE 'DCCPREV' TO QUE-COLA.
           MOVE +300 TO QUE-LITM.
           MOVE DCC TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           PERFORM COL-FIO-DCC.

           MOVE FIO-STAT TO DCC-STP-ITRN IN DCC.

           MOVE 'DCCPOST' TO QUE-COLA.
           MOVE +300 TO QUE-LITM.
           MOVE DCC TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           IF NOT FIO-STAT-OKS
               IF WSS-ENC-TCC = 'S'
                  MOVE '00' TO FIO-STAT
               END-IF
               GO TO FIN-PROC-COM.

           IF DCC-MSC-TCCT IN DCC NOT =
              TCCT-ELM IN TCCT-VARI(TCCT-IDX)
                       OR
              DCC-COD-VCAM IN DCC NOT =
              DCC-COD-VCAM IN DCC-FLD
                       OR
              DCC-COD-COCR IN DCC NOT =
              DCC-COD-COCR IN DCC-FLD

                ADD 1 TO TCCT-IDX
                IF TCCT-IDX > TCCT-TOT
                    GO TO FIN-PROC-COM
                ELSE
                    PERFORM KEY-ALL-DCC
                    
                    MOVE TCCT-ELM IN TCCT-VARI(TCCT-IDX) TO
                                   DCC-MSC-TCCT IN DCC

                    MOVE SPACES TO DCC-COD-PLZO IN DCC
                                   DCC-IND-SCRT IN DCC
                                   DCC-IND-SCTB IN DCC
                                   DCC-IND-SCBZ IN DCC
                    MOVE FIO-GET-NLS TO FIO-CMND
                    GO TO CIC-PROC-COM.

           MOVE FIO-STAT TO PGM-STAT-DCC.
           PERFORM PUT-ALL-DCC.

           MOVE 'P' TO
               TQ-018-01-DCC-MSC-TCCT-ATR
               TQ-018-01-DCC-COD-VCAM-ATR
               TQ-018-01-DCC-COD-COCR-ATR
               TQ-018-01-DCC-COD-PLZO-ATR
               TQ-018-01-DCC-IND-SCRT-ATR
               TQ-018-01-DCC-IND-SCTB-ATR
               TQ-018-01-DCC-IND-SCBZ-ATR
               TQ-018-01-DCC-CIC-CCTB-ATR
               TQ-018-01-DCC-EXT-CTAB-ATR
               TQ-018-01-DCC-GLS-CCSB-ATR
               TQ-018-01-TAB-CIC-CTAB-ATR
               TQ-018-01-TAB-GLS-DESC-ATR
               TQ-018-01-TAB-GLS-DATA-ATR
               TQ-018-01-TAB-GLS-ABRV-ATR
               TQ-018-01-TAB-GLS-DCOR-ATR
               TQ-018-01-DCC-IND-VIGE-ATR
               TQ-018-01-DCC-FEC-FTRN-ATR
               TQ-018-01-DCC-GLS-DISP-ATR.

           
           MOVE          DCC-MSC-TCCT IN DCC-FLD TO
               TQ-018-01-DCC-MSC-TCCT.

           MOVE          DCC-COD-VCAM IN DCC-FLD TO
               TQ-018-01-DCC-COD-VCAM.

           MOVE          DCC-COD-COCR IN DCC-FLD TO
               TQ-018-01-DCC-COD-COCR.

           MOVE          DCC-COD-PLZO IN DCC-FLD TO
               TQ-018-01-DCC-COD-PLZO.

           MOVE          DCC-IND-SCRT IN DCC-FLD TO
               TQ-018-01-DCC-IND-SCRT.

           MOVE          DCC-IND-SCTB IN DCC-FLD TO
               TQ-018-01-DCC-IND-SCTB.

           MOVE          DCC-IND-SCBZ IN DCC-FLD TO
               TQ-018-01-DCC-IND-SCBZ.

           MOVE          DCC-CIC-CCTB IN DCC-FLD TO
               TQ-018-01-DCC-CIC-CCTB.

           MOVE          DCC-EXT-CTAB IN DCC-FLD TO
               TQ-018-01-DCC-EXT-CTAB.

           MOVE          DCC-GLS-CCSB IN DCC-FLD TO
               TQ-018-01-DCC-GLS-CCSB.

           MOVE          TAB-CIC-CTAB IN DCC-FLD TO
               TQ-018-01-TAB-CIC-CTAB.

           MOVE          TAB-GLS-DESC IN DCC-FLD TO
               TQ-018-01-TAB-GLS-DESC.

           MOVE          TAB-GLS-DATA IN DCC-FLD TO
               TQ-018-01-TAB-GLS-DATA.

           MOVE          TAB-GLS-ABRV IN DCC-FLD TO
               TQ-018-01-TAB-GLS-ABRV.

           MOVE          TAB-GLS-DCOR IN DCC-FLD TO
               TQ-018-01-TAB-GLS-DCOR.

           MOVE          DCC-IND-VIGE IN DCC-FLD TO
               TQ-018-01-DCC-IND-VIGE.

           MOVE          DCC-FEC-FTRN IN DCC-FLD TO
               TQ-018-01-DCC-FEC-FTRN.

           MOVE          DCC-GLS-DISP IN DCC-FLD TO
               TQ-018-01-DCC-GLS-DISP.


           MOVE DCC-NOM-TSDCC TO QUE-COLA.
           
      *     MOVE 'COLAQDCC' TO QUE-COLA.
           
           MOVE DCC-LEN-TSDCC TO QUE-LITM.
           MOVE DCC-TS-ITEM   TO QUE-ITEM.
           MOVE QUE-PUT       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE 'S' TO WSS-ENC-TCC.
           
           
           


           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-PROC-COM.

       FIN-PROC-COM.
           EXIT.

       BUS-TCCT SECTION.
       INI-BUS-TCCT.
           IF DCC-MSC-TCCT IN DCC-FLD =
              TCCT-ELM IN TCCT-VARI(TCCT-IDX)
                MOVE 'S' TO WSS-ENC-TCC.

       FIN-BUS-TCCT.
           EXIT.

       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.
           PERFORM GNS-PRO-QUE.
       FIN-GNX-PRO-QUE.
           EXIT.

      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU

       PUT-TAB-DCC SECTION.
       INI-PUT-TAB-DCC.
           IF PGM-STAT-TAB-NUL
               GO TO FIN-PUT-TAB-DCC.
           IF NOT PGM-STAT-TAB-OKS
               PERFORM CLR-TAB-DCC
               GO TO FIN-PUT-TAB-DCC.
           MOVE TAB-CIC-CTAB IN TAB TO TAB-CIC-CTAB IN DCC-FLD.
           MOVE TAB-GLS-DESC IN TAB TO TAB-GLS-DESC IN DCC-FLD.
           MOVE TAB-GLS-DATA IN TAB TO TAB-GLS-DATA IN DCC-FLD.
           MOVE TAB-GLS-ABRV IN TAB TO TAB-GLS-ABRV IN DCC-FLD.
           MOVE TAB-GLS-DCOR IN TAB TO TAB-GLS-DCOR IN DCC-FLD.
       FIN-PUT-TAB-DCC.
           EXIT.

       VAL-KEY-DCC SECTION.
       INI-VAL-KEY-DCC.
           PERFORM VAL-IKY-DCC.
           PERFORM VAL-MKY-DCC.
           PERFORM VAL-AKY-DCC.
       FIN-VAL-KEY-DCC.
           EXIT.
       
       VAL-IKY-DCC SECTION.
       INI-VAL-IKY-DCC.
           PERFORM VAL-DCC-MSC-TCCT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DCC-MSC-TCCT-LEN IN DCC-FLD
                GO TO FIN-VAL-IKY-DCC.
           PERFORM VAL-DCC-COD-VCAM.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DCC-COD-VCAM-LEN IN DCC-FLD
                GO TO FIN-VAL-IKY-DCC.
           PERFORM VAL-DCC-COD-COCR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DCC-COD-COCR-LEN IN DCC-FLD
                GO TO FIN-VAL-IKY-DCC.
           PERFORM VAL-DCC-COD-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DCC-COD-PLZO-LEN IN DCC-FLD
                GO TO FIN-VAL-IKY-DCC.
           PERFORM VAL-DCC-IND-SCRT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DCC-IND-SCRT-LEN IN DCC-FLD
                GO TO FIN-VAL-IKY-DCC.
           PERFORM VAL-DCC-IND-SCTB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DCC-IND-SCTB-LEN IN DCC-FLD
                GO TO FIN-VAL-IKY-DCC.
           PERFORM VAL-DCC-IND-SCBZ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DCC-IND-SCBZ-LEN IN DCC-FLD
                GO TO FIN-VAL-IKY-DCC.
       FIN-VAL-IKY-DCC.
           EXIT.
       
       VAL-AKY-DCC SECTION.
       INI-VAL-AKY-DCC.
       FIN-VAL-AKY-DCC.
           EXIT.

       VAL-DCC-MSC-TCCT SECTION.
       INI-VAL-DCC-MSC-TCCT.
           IF DCC-MSC-TCCT IN DCC-FLD NOT > SPACES
              MOVE SPACES TO DCC-MSC-TCCT IN DCC-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'TCCT' TO MSC-COD-TMSC IN MSC.
           MOVE DCC-MSC-TCCT IN DCC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCC-MSC-TCCT IN DCC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-TCCT IN DCC-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-TCCT IN DCC-FLD.
       FIN-VAL-DCC-MSC-TCCT.
           EXIT.
       
       VAL-DCC-COD-VCAM SECTION.
       INI-VAL-DCC-COD-VCAM.
           IF DCC-COD-VCAM IN DCC-FLD NOT > SPACES
              MOVE SPACES TO DCC-COD-VCAM IN DCC-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE DCC-COD-VCAM IN DCC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCC-COD-VCAM IN DCC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCAM IN DCC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN DCC-FLD.
       FIN-VAL-DCC-COD-VCAM.
           EXIT.
       
       VAL-DCC-COD-COCR SECTION.
       INI-VAL-DCC-COD-COCR.
           IF DCC-COD-COCR IN DCC-FLD NOT > SPACES
              MOVE SPACES TO DCC-COD-COCR IN DCC-FLD.
      *<<<< DCC_COD_COCR
      *DAD ini
      * Mediante VAL-COD Valida el codigo y obtiene la glosa de la Clase de
      * Operacion Credito en la tabla AUX
           MOVE 'COL'                   TO TAB-COD-SIST.
           MOVE 'AUX'                   TO TAB-COD-TTAB IN TAB.
           MOVE DCC-COD-COCR IN DCC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCC-COD-COCR IN DCC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COCR IN DCC-FLD
               GO TO FIN-VAL-DCC-COD-COCR
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-COCR IN DCC-FLD.

      * Se redefine campo COCR e inicializa glosa de trabajo
           MOVE DCC-COD-COCR IN DCC-FLD TO WSS-COD-COCR IN WSS-VARI.
           MOVE SPACES                  TO WSS-GLS-DATA IN WSS-VARI.

      * Se aprovecha la glosa de la Clase de Operacion Credito de la tabla AUX
      * obtenida anteriormente en forma automatica
           MOVE FRM-GLS-COCR IN DCC-FLD TO WSS-GLS-AUX IN WSS-VARI.

      * Mediante BUS-TAB busca la glosa del Tipo de Operacion Credito en la
      * tabla TIO
           IF WSS-COD-TOCR IN WSS-VARI > SPACES
               MOVE 'TAB'                    TO TAB-COD-SIST
               MOVE 'TIO'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-TOCR IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TIO IN WSS-VARI.

      * Se concatenan las glosas de tablas TIO y AUX para desplegarlas juntas
           MOVE WSS-GLS-DATA IN WSS-VARI TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-COCR IN DCC-FLD.
           GO TO FIN-VAL-DCC-COD-COCR.
      *DAD fin
      *>>>>
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'AUX' TO TAB-COD-TTAB IN TAB.
           MOVE DCC-COD-COCR IN DCC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCC-COD-COCR IN DCC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-COCR IN DCC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-COCR IN DCC-FLD.
       FIN-VAL-DCC-COD-COCR.
           EXIT.
       
       VAL-DCC-COD-PLZO SECTION.
       INI-VAL-DCC-COD-PLZO.
           IF DCC-COD-PLZO IN DCC-FLD NOT > SPACES
              MOVE SPACES TO DCC-COD-PLZO IN DCC-FLD.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'PZO' TO TAB-COD-TTAB IN TAB.
           MOVE DCC-COD-PLZO IN DCC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCC-COD-PLZO IN DCC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-PLZO IN DCC-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-PLZO IN DCC-FLD.
       FIN-VAL-DCC-COD-PLZO.
           EXIT.
       
       VAL-DCC-IND-SCRT SECTION.
       INI-VAL-DCC-IND-SCRT.
           IF DCC-IND-SCRT IN DCC-FLD NOT > SPACES
              MOVE SPACES TO DCC-IND-SCRT IN DCC-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'SCRT' TO MSC-COD-TMSC IN MSC.
           MOVE DCC-IND-SCRT IN DCC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCC-IND-SCRT IN DCC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SCRT IN DCC-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-SCRT IN DCC-FLD.
       FIN-VAL-DCC-IND-SCRT.
           EXIT.
       
       VAL-DCC-IND-SCTB SECTION.
       INI-VAL-DCC-IND-SCTB.
           IF DCC-IND-SCTB IN DCC-FLD NOT > SPACES
              MOVE SPACES TO DCC-IND-SCTB IN DCC-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'SCTB' TO MSC-COD-TMSC IN MSC.
           MOVE DCC-IND-SCTB IN DCC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCC-IND-SCTB IN DCC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SCTB IN DCC-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-SCTB IN DCC-FLD.
       FIN-VAL-DCC-IND-SCTB.
           EXIT.
       
       VAL-DCC-IND-SCBZ SECTION.
       INI-VAL-DCC-IND-SCBZ.
           IF DCC-IND-SCBZ IN DCC-FLD NOT > SPACES
              MOVE SPACES TO DCC-IND-SCBZ IN DCC-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL' TO MSC-COD-SIST.
           MOVE 'SCBZ' TO MSC-COD-TMSC IN MSC.
           MOVE DCC-IND-SCBZ IN DCC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCC-IND-SCBZ IN DCC-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-SCBZ IN DCC-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO
                    FRM-GLS-SCBZ IN DCC-FLD.
       FIN-VAL-DCC-IND-SCBZ.
           EXIT.
      *>>>>
*% END
