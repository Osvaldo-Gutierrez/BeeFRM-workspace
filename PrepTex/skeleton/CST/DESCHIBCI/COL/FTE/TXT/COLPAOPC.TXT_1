*% PGM_PTC = TRUE
*% HDR_CST = FALSE
*% NO_TIENE_TIMESTAMP = TRUE
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
*% IF PGM_PQ
      *LRH ini 12-ABR-1994
       COPY GNSWGQUE.
       COPY GNSWGTSK.
      *LRH fin 12-ABR-1994
*% END
*% IF PGM_PU
       01  WSS-SYS-CMA-1        PIC X(05) VALUE '^&*()'.
*% END
       COPY COLWGENG.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA1==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RQA2==.
           02 SCR-KEY-IRDC                         PIC X(04).
           02 SCR-IND-MRDC                         PIC X(01).
           02 SCR-IND-MITR                         PIC X(01).
           02 SCR-IND-MCOM                         PIC X(01).
           02 SCR-IND-MCYA                         PIC X(01).
*% IF PGM_PQ
           02 SCR-MSC-TCAN                         PIC X(01).
*% END
*% IF PGM_PU
       01  WSS-SYS-CMA-2        PIC X(05) VALUE '^&*()'.
*% END
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
*% IF PGM_PQ
       COPY COLWGRNO.
       01  WSS-VARI.
           03  WSS-GLS-DAT1          VALUE SPACES PIC X(01).
           03  BUS-POR-KEYS          VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'    PIC X(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-MRDC              VALUE 0      PIC 9(01).
               88  WSS-MISMO-RDC     VALUE 0.
               88  WSS-OTRO-RDC      VALUE 1.
           03  WSS-MISMO             VALUE 0      PIC 9(01).
           03  WSS-OTRO              VALUE 1      PIC 9(01).
      *ALD-BCI-INI/14.06.1996
           03  WSS-ROV-RENO   COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  WSS-VAL-DIFE   COMP-3 VALUE ZEROES PIC  9(11)V9(04).
           03  WSS-VAL-PASO          VALUE ZEROES PIC  9(01)V9(04).
      *ALD-BCI-FIN/14.06.1996
           03  WSS-SGV-RENO   COMP-3 VALUE ZEROES PIC S9(11)V9(04).
           03  RCAN-CAN-KEY-ICAN                  PIC X(15).
           03  WSS-TOT-RCAN   VALUE ZEROES        PIC 9(04).
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
           03  WSS-TOT-PTTS   VALUE ZEROES        PIC 9(04).
           03  WSS-CIC-IOPC                       PIC X(12).
           03  WSS-KEY-IVCT                       PIC X(15).
      *DAD fin  09-DIC-1991
      *DAD ini  31-AUG-1994 Compatibilidad PI-PQ en modulo manejo BQ
           03  WSS-MSC-TCAN                       PIC X(01).
           03  WSS-CIC-IOPV                       PIC X(12).
           03  WSS-CAI-ICIC.
               05 WSS-COD-TCIC                    PIC X(01).
               05 WSS-COD-CCIC                    PIC X(03).
           03  WSS-CPT-NOMB.
               05  WSS-CPT-DESC                   PIC X(40).
               05  WSS-CPT-IOPV                   PIC X(12).
               05  WSS-CPT-DATA                   PIC X(40).
           03  WSS-CPT-NOMB-R REDEFINES WSS-CPT-NOMB PIC X(92).
*% END
*% IF PGM_PU
      *PTC-INI:
       COPY GNSWGQUE.
       COPY COLMXW05.
       COPY GNSWGTSK.
      *PTC-FIN:
       COPY COLWGRNO.
       COPY COLWGLAV.
      *DAD ini  01-MAR-1995   (Manejo LINEA de AVANCE para LDC )
       COPY COLWGLDC.
      *DAD fin  01-MAR-1995
       01  WSS-VARI.
      *
           03  WSS-COD-SEGU                           PIC X(03).
           03  WSS-SEG-CAUX.
               05  WSS-SEG-TOOC                       PIC X(03).
               05  WSS-SEG-AOOC                       PIC X(03).
      *RVM-CST-INI 29-JAN-1997
           03  WSS-DAT-POS45.
               05  FILLER                             PIC X(02).
               05  WSS-COD-POS45                      PIC X(01).
      *RVM-CST-FIN 29-JAN-1997
      *DAD ini  01-OCT-1993   (Memo.22-09-93)
           03  WSS-CIC-COOC        VALUE SPACES       PIC X(03).
               88 VAL-PTM-CON      VALUE 'CON'.
           03  WSS-CON-ICLI        VALUE 50000000     PIC 9(08).
      *DAD fin  01-OCT-1993
      *DAD ini  15-MAR-1993   (Memo.14-10-92 Pto.1)
           03  WSS-FEC-FCTB.
               05  WSS-NUM-SCTB                       PIC 9(02).
               05  WSS-NUM-ACTB                       PIC 9(02).
               05  WSS-NUM-MCTB                       PIC 9(02).
               05  WSS-NUM-DCTB                       PIC 9(02).
           03  WSS-FEC-FAUX.
               05  WSS-NUM-SAUX                       PIC 9(02).
               05  WSS-NUM-AAUX                       PIC 9(02).
               05  WSS-NUM-MAUX                       PIC 9(02).
               05  WSS-NUM-DAUX                       PIC 9(02).
      *DAD fin  15-MAR-1993
      *DAD ini  21-JUL-1992
           03 WSS-IND-ILDC                             PIC X(01).
           03 WSS-CIC-ILDC.
              05 WSS-CAI-ILDC                          PIC X(04).
              05 WSS-IIC-ILDC                          PIC 9(08).
      *DAD fin  21-JUL-1992
      *DAD ini  22-MAR-1991
           03  WSS-VAL-PESO                            PIC 9(11).
      *DAD fin  22-MAR-1991
           03  WSS-VLR.
               05  WSS-CIC-VCAM.
                   07  WSS-CIC-TVAL               PIC X(01).
                   07  WSS-CIC-CVAL               PIC X(03).
                   07  WSS-CIC-TCAM               PIC X(08).
           03  WSS-NUM-DIGT                       PIC 9(02).
           03  WSS-COD-DIGT                       PIC X(02).
           03  WSS-I                              PIC 9(02).
           03  WSS-COD-TINT                       PIC X(12).
           03  PGM-STAT-POC          VALUE '23'   PIC X(02).
               88 PGM-STAT-POC-OKS   VALUE '00'.
               88 PGM-STAT-POC-NUL   VALUE '  '.
           03  WSS-GLS-DAT1          VALUE SPACES PIC X(01).
           03  BUS-POR-KEYS          VALUE SPACES PIC X(01).
           03  BUS-POR-CLTE          VALUE 'C'    PIC X(01).
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
           03  WSS-CIC-ICLI                       PIC X(12).
           03  WSS-MRDC              VALUE 0      PIC 9(01).
               88  WSS-MISMO-RDC     VALUE 0.
               88  WSS-OTRO-RDC      VALUE 1.
           03  WSS-MISMO             VALUE 0      PIC 9(01).
           03  WSS-OTRO              VALUE 1      PIC 9(01).
      *ALD
           03  WSS-MEN2.
               05  FILLER            VALUE SPACES PIC X(01).
               05  WSS-SGV-VAL1-EDT  PIC --------------,---.
               05  WSS-GLS-GUI1                    PIC X(01).
               05  WSS-SGV-VAL2-EDT  PIC --------------,---.
           03  NOV-SGV-DIFE          COMP-3        PIC S9(11)V9(4).
           03  NOV-SGV-SNOV          COMP-3        PIC S9(11)V9(4).
           03  WSS-VAL-SVEN          COMP-3        PIC S9(11)V9(4).
      * RBG INI 14-MAR-1996 **Esto corresponde al peso**
           03  WSS-VAL-DIFE          COMP-3        PIC S9(11)V9(4).
      * RBG FIN 14-MAR-1996 **Esto corresponde al peso**
      * RBG INI 12-APR-1996 **Esto corresponde a la suma de Gast+Segp**
           03  WSS-VAL-GAST          COMP-3        PIC S9(11)V9(4).
      * RBG FIN 12-APR-1996 **Esto corresponde a la suma de Gast+Segp**
           03  WSS-CPT-NOMB.
               05  WSS-CPT-DESC                    PIC X(40).
               05  WSS-CPT-CAI                     PIC X(04).
               05  WSS-CPT-IIC                     PIC X(08).
               05  WSS-GLS-DATA                    PIC X(40).
           03  WSS-CPT-NOMB-R  REDEFINES  WSS-CPT-NOMB PIC X(92).
           03  WSS-NUM-ICLI     VALUE 50000000     PIC 9(08).
       COPY GNSBRCIC.
*% END
      *DAD fin  31-AUG-1994
      *Registros de GENESIS
       COPY GNSBRTAB.
      *Registros de TABLAS
       COPY TABBRCAM.
      *Registros de CLIENTES
       COPY SGCBRDBC.
      *Registros de Colocaciones
      *DAD ini  21-JUL-1992
       COPY COLBRPOC.
      *DAD fin  21-JUL-1992
       COPY COLBRRDC.
       COPY COLBRITR.
       COPY COLBRCOM.
       COPY COLBRCYA.
       COPY COLBRAUT.
       COPY COLBRCAN.
       COPY COLBRROV.
       COPY COLBREVC.
*% IF PGM_PQ
      *DAD ini  31-AUG-1994 Compatibilidad PI-PQ en modulo manejo BQ
       COPY COLBRTOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
      *DAD fin  31-AUG-1994
      *RVM-CST-INI 6-AUG-1996
       COPY SGCBRDCC REPLACING ==  DCC== BY ==  SDC==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SDC-REQA==.
      *RVM-CST-FIN 6-AUG-1996
*% END
*% IF PGM_PU
       COPY SGCBRDCP.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY SGCBRRCD.
       COPY SGCWGRCD.
       COPY COLBRDLC.
       COPY COLBRVEN.
       COPY COLBRRCE.
       COPY GNSWGCIC.
*% END
      *
       COPY GNSWGPES.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
      *
       COPY COLWGPMP.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *DAD ini  21-JUL-1992
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
      *DAD fin  21-JUL-1992
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
*% IF PGM_PU
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
      *DAD ini  08-ABR-1992   (Memo.02-03-92 Pto.2)
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
      *DAD fin  08-ABR-1992
      *RVM-CST-INI 6-AUG-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SDC-REQA==.
       COPY SGCBRDCC REPLACING ==DCC== BY ==SDC==.
      *RVM-CST-FIN 6-AUG-1996
*% END
      *>>>>
*% END
*% IF CMA
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           PERFORM GNS-ERR-QUE.
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-RQA1
                              SCR-RQA2
               MOVE 'O'    TO SCR-IND-OOD
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FTER-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FTER-CIC.
       FIN-INI-FIO.
      *>>>>
*% END
*% IF CMN_MOD_RET 
      *<<<< CMN_MOD_RET 
           MOVE SYS-GET-DATE TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-TSTP TO OPC-STP-ITRN IN OPC.
           IF SCR-CMND = 'MCA'
               GO TO AUT-FND-KEY.
      *BUS-MSC busca glosa de miscelaneo en tabla
      *    MOVE 'COL' TO MSC-COD-SIST.
      *    MOVE 'IEVC' TO MSC-COD-TMSC IN MSC.
      *    MOVE OPC-IND-VSTR IN OPC-FLD TO MSC-COD-CMSC IN MSC.
      *    PERFORM BUS-MSC.
      *    IF MSC-CIC-CMSC IN MSC = 'N'
      *        MOVE 1 TO OPC-NUM-IVEN IN OPC
      *    ELSE
      *        MOVE ZEROES TO OPC-NUM-IVEN IN OPC.
           MOVE 1 TO OPC-NUM-IVEN IN OPC.

           MOVE 'M' TO OPC-MSC-STAT IN OPC.
           PERFORM GET-UPD-ITR.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           IF ITR-COD-TINT IN OPC-FLD NOT = 'MULTIPLES'
               MOVE ITR-COD-TINT IN ITR TO WSS-COD-TINT IN WSS-VARI.
           PERFORM GET-UPD-COM.

           PERFORM GET-UPD-CYA.

           PERFORM GET-UPD-ROV.
      *DAD ini  26-ABR-1994
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *DAD fin  26-ABR-1994
       AUT-FND-KEY.
           PERFORM GET-UPD-AUT.

           PERFORM GET-UPD-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           IF SCR-CMND = 'MCA'
               GO TO MOD-AUT-FND-KEY.
           PERFORM MOD-ITR.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM MOD-COM.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           IF PGM-STAT-CYA-OKS
               PERFORM MOD-CYA
               IF NOT FIO-STAT-OKS
                   GO TO FIN-CMN-MOD.
           PERFORM MOD-ROV.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
       MOD-AUT-FND-KEY.
           PERFORM MOD-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM MOD-AUT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE SPACES TO OPC-GLS-FLAG IN OPC.
           MOVE 'I'    TO OPC-MSC-STAT IN OPC.
           MOVE SPACES TO OPC-MSC-TACC IN OPC.
      *     MOVE SPACES TO OPC-MSC-STAT IN OPC.
           MOVE SPACES TO OPC-COD-OTRN IN OPC.
           MOVE SPACES TO OPC-COD-ATRN IN OPC.
           MOVE ZEROES TO OPC-NUM-VCOR IN OPC.
           MOVE ZEROES TO OPC-NUM-VCVG IN OPC.
           MOVE ZEROES TO OPC-NUM-VCCO IN OPC.
           MOVE ZEROES TO OPC-NUM-VCCM IN OPC.
           MOVE ZEROES TO OPC-NUM-VCCV IN OPC.
           MOVE ZEROES TO OPC-NUM-TVCC IN OPC.
           MOVE SPACES TO OPC-MSC-TCVE IN OPC.
           MOVE SPACES TO OPC-MSC-BCCR IN OPC.
           MOVE SPACES TO OPC-MSC-VICR IN OPC.
           MOVE SPACES TO OPC-COD-AGES IN OPC.
           MOVE SPACES TO OPC-GLS-DISP IN OPC.
      *>>>>
*% END
*% IF INI_CMN_ING 
      *<<<< INI_CMN_ING 
           MOVE SYS-GET-DATE TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-TSTP TO OPC-STP-ITRN IN OPC.
      *BUS-MSC busca glosa de miscelaneo en tabla
      *    MOVE 'COL' TO MSC-COD-SIST.
      *    MOVE 'IEVC' TO MSC-COD-TMSC IN MSC.
      *    MOVE OPC-IND-VSTR IN OPC-FLD TO MSC-COD-CMSC IN MSC.
      *    PERFORM BUS-MSC.
      *    IF MSC-CIC-CMSC IN MSC = 'N'
      *        MOVE 1 TO OPC-NUM-IVEN IN OPC
      *    ELSE
      *        MOVE ZEROES TO OPC-NUM-IVEN IN OPC.
           MOVE 1 TO OPC-NUM-IVEN IN OPC.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
      *GET-CIC Obtener CIC
           IF OPC-IIC-IOPC IN OPC-FLD NOT > ZEROES
               PERFORM SET-TCIC
               PERFORM SET-CCIC
               MOVE 'D'  TO CIC-COD-TCIC IN CIC
               MOVE OPC-COD-OFOC IN OPC-FLD TO CIC-COD-CCIC IN CIC
      *        MOVE SPACES TO CIC-CAI-ICIC IN CIC
               MOVE CIC-GET TO CIC-CMND
               PERFORM PRO-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE CIC-MENS TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-CMN-ING
               ELSE
                   MOVE CIC-CIC-ICIC TO OPC-CIC-IOPC IN OPC
                   MOVE 'GNS' TO MSG-COD-SIST
                   MOVE 'MSGKEY' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE CIC-CAI-ICIC TO OPC-CAI-IOPC     IN OPC-FLD
                   MOVE CIC-IIC-ICIC TO OPC-IIC-IOPC-EDT IN OPC-EDT
                   MOVE OPC-IIC-IOPC-EDT IN OPC-EDT TO
                        OPC-IIC-IOPC-ALF IN OPC-FLD

                   MOVE MSG-GLS-DESC            TO WSS-CPT-DESC
                   MOVE OPC-CAI-IOPC IN OPC-FLD TO WSS-CPT-CAI
                   MOVE OPC-IIC-IOPC IN OPC-FLD TO WSS-CPT-IIC
                   MOVE MSG-GLS-DATA            TO WSS-GLS-DATA
                   MOVE WSS-CPT-NOMB-R          TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN                TO FRM-MENS

      *            STRING MSG-GLS-DESC
      *                   OPC-CAI-IOPC     IN OPC-FLD
      *                   OPC-IIC-IOPC-ALF IN OPC-FLD
      *                   MSG-GLS-DATA DELIMITED BY SIZE
      *              INTO FRM-MENS
                   MOVE FRM-MENS TO SCR-MENS-EXT
           ELSE
      *ISP ENGANCHE CON LLAVES DIGITADAS POR EL USUARIO
               MOVE OPC-CAI-IOPC IN OPC-FLD TO CIC-CAI-ICIC
               MOVE OPC-IIC-IOPC IN OPC-FLD TO CIC-IIC-ICIC.
      *PTC-INI:
           IF SCR-OFRM-SRV
               MOVE PTC-OPC-TYPE TO QUE-TYPE
               MOVE TSK-TERM-ALF TO QUE-TERM
               MOVE QUE-DEL      TO QUE-CMND
               PERFORM GNS-PRO-QUE
               MOVE PTC-OPC-TYPE TO QUE-TYPE
               MOVE TSK-TERM-ALF TO QUE-TERM
               MOVE PTC-OPC-LENG TO QUE-LITM
               MOVE CIC-CAI-ICIC TO PTC-OPC-OPC-CAI-IOPC
               MOVE CIC-IIC-ICIC TO PTC-OPC-OPC-IIC-IOPC
               MOVE PTC-OPC-ITEM TO QUE-ITEM
               MOVE QUE-PUT      TO QUE-CMND
               PERFORM GNS-PRO-QUE.
      *PTC-FIN:
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
           PERFORM PUT-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-ITR.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-COM.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-CYA.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-AUT.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           PERFORM PUT-ROV.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
           MOVE CIC-CAI-ICIC TO SCR-CAI-IOPC.
           MOVE CIC-IIC-ICIC TO SCR-IIC-IOPC.
           MOVE  ZEROES      TO SCR-NUM-IDOC.
           IF DBC-IND-ICLI IN OPC-FLD = 'M'
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IDIR)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IDIR)
           ELSE
               MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IDIR)
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IDIR).
           IF ITR-COD-TINT IN OPC-FLD = 'MULTIPLES'
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IICG)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IICG)
           ELSE
               MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IICG)
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IICG).
           IF CYA-IND-TCYA IN OPC-FLD = 'M'
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-ICYA)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-ICYA)
           ELSE
               MOVE SPACES TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-ICYA)
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-ICYA).
           MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IDLC).
           MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IDLC).
           PERFORM EGR-FPEN-CIC.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           PERFORM DEL-DLC.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
           PERFORM DEL-CYA.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
           PERFORM DEL-ITR.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
           PERFORM DEL-RDC.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
           PERFORM DEL-VEN.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
           PERFORM DEL-EVC.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
      *DAD ini  08-ABR-1992   (Memo.02-03-92 Pto.2)
           PERFORM DEL-RCE.
           IF NOT FIO-STAT-OKS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
      *DAD fin  08-ABR-1992
      *>>>>
*% END
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
           PERFORM PFS-SCR-MOD.
      *>>>>
*% END
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC.
      
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           PERFORM PFS-SCR-ACC.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
           PERFORM PFS-SCR-ELI.
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF PFS_SCR_ACT
      *<<<< PFS_SCR_ACT
           PERFORM PFS-SCR-ACT.
      *>>>>
*% END
*% IF PFS_SCR_ACT
      *<<<< PFS_SCR_ACT
           IF ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-OPC
               PERFORM VAL-NUM-FLD-OPC.
           IF FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD-PF5
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL.
           MOVE SPACES TO SCR-RQA1.
           MOVE SPACES TO SCR-RQA2.
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
*% IF PGM_PU
           MOVE FRM-CPIM-UBY TO OPC-COD-TOOC-ATR IN OPC-FLD.
           MOVE FRM-CPIM-UBY TO OPC-COD-VCOC-ATR IN OPC-FLD.
           MOVE FRM-CPIM-UBY TO OPC-COD-AOOC-ATR IN OPC-FLD.
           MOVE FRM-CPIM-UBY TO CAN-CAI-IOPC-ATR IN OPC-FLD.
           MOVE FRM-CPIM-UBY TO CAN-IIC-IOPC-ATR IN OPC-FLD.
           MOVE FRM-CPIM-UBY TO CAN-NUM-ICAN-ATR IN OPC-FLD.
*% END
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
               GO TO CON-FND-KEY.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   IF MSG-COD-MENS = 'RDCSI'
                       PERFORM SCR-CLRA-OPC
                       PERFORM PUT-DBC
                       MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
                       MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                       GO TO CON-FND-KEY
                   ELSE
                       IF SCR-KEY-IRDC = 'IDLC'
                           PERFORM CLR-FLD-OPC
                           IF FRM-FFLD = FRM-FFLD-PF5
                               MOVE 'SGC' TO MSG-COD-SIST
                               MOVE 'RDC    NOPRV' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE 'SGC' TO MSG-COD-SIST
                               MOVE 'RDC    NONXT' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MENS
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                       ELSE
                           PERFORM SCR-CLRA-OPC
                           PERFORM PUT-DBC
                           PERFORM BUS-DEU-DIR
                           IF NOT FIO-STAT-OKS
                               MOVE 'COL' TO MSG-COD-SIST
                               MOVE 'CLI    NODIR' TO MSG-COD-MENS
                               PERFORM GET-MSG
                               MOVE MSG-GLS-DESC TO FRM-MEN2
                               MOVE '00' TO FIO-STAT
                               MOVE SCR-STAT-CON TO SCR-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                               MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC
                                                                 IN OPC
                               GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO SCR-RQA2
                   PERFORM CLR-FLD-OPC
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
           ELSE
           IF OPC-IIC-IOPC IN OPC-FLD > ZEROES
               GO TO CON-FND-KEY
           ELSE
           IF DBC-NUM-ICLI IN OPC-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN OPC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN OPC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN OPC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM ANL-KEY-OPC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   NEXT SENTENCE
           ELSE
           IF DBC-GLS-NOMC IN OPC-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre
      
               MOVE DBC-GLS-NOMC IN OPC-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC
      
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM ANL-KEY-OPC
               IF NOT FIO-STAT-OKS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
           MOVE '00' TO PGM-STAT-OPC.
      *INI-JGM
           MOVE OPC-STP-ITRN IN OPC TO SCR-UMOD.
      *FIN-JGM.
      
           PERFORM BUS-CIC-RENO
           IF OPC-IND-RENO IN OPC = RNO-CIC-NOV IN RNO-VARI
               PERFORM GET-ROV-CAN
               PERFORM BUS-CNC.
      
           IF (OPC-IND-RENO IN OPC = RNO-CIC-REN IN RNO-VARI) OR
              (OPC-IND-RENO IN OPC = RNO-CIC-PRO IN RNO-VARI)
               PERFORM GET-ROV-REN
               MOVE WSS-SGV-RENO TO ROV-SGV-RENO IN ROV.

           IF NOT BUS-POR-KEYS = BUS-POR-CLTE
               GO TO OPC-FND-KEY.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE MSG-GLS-DESC TO FRM-MENS.
           GO TO ANL-CLI.
       OPC-FND-KEY.
           PERFORM GET-CUR-RDC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NORDC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE '00'         TO FIO-STAT
               GO TO FIN-FND-KEY.
           MOVE '00'   TO PGM-STAT-RDC.
           MOVE 'IDLC' TO SCR-KEY-IRDC.
           MOVE ADR-RDC-REQA TO SCR-RQA2.
           PERFORM GET-NXT-RDC.
           IF SCR-IND-MRDC = 'M'
               MOVE 'M'          TO DBC-IND-ICLI IN OPC-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               GO TO ANL-CLI.
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'RDC    NOCLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
            MOVE '00' TO PGM-STAT-DBC.
            MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
            PERFORM CPT-BLKS.
            MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPC-FLD.
            MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD.
            MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD.
            MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD.
            MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD.
       ANL-CLI.
            PERFORM ANL-KEY-ALL.
            IF MSG-COD-MENS NOT = SPACES
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE '00' TO FIO-STAT
                MOVE SCR-STAT-CON TO SCR-STAT
                GO TO FIN-FND-KEY.
       REC-OPC-STAT.
      *ALD/4-AUG-1988
           MOVE PGM-STAT-OPC TO FIO-STAT.
      *JSS 16-MAY-1991 15:32:57 ( para manejo de cuenta corriente )
           IF OPC-MSC-STAT IN OPC = 'X' OR 'B' OR 'G'
               MOVE 'COL'               TO MSG-COD-SIST
               MOVE 'OPCSTT'            TO MSG-COD-TMSG
               MOVE OPC-MSC-STAT IN OPC TO MSG-COD-CMSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE '00' TO FIO-STAT
           ELSE
      *
           IF OPC-MSC-STAT IN OPC = 'S'
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    SUSYA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO CPT-STR1
               MOVE MSG-GLS-DATA TO CPT-STR2
               PERFORM CPT-BLKS
               MOVE CPT-STRN     TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
      * RBG INI 6-DEC-1995
           IF FIO-STAT-OKS
               MOVE 'COL'        TO TAB-COD-SIST FIO-SIST
               MOVE 'VSC'        TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-TOOC IN OPC TO WSS-COD-TOOC IN
                                                  WSS-VARI
               MOVE OPC-COD-AOOC IN OPC TO WSS-COD-AOOC IN
                                                  WSS-VARI
               MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB
                                                      IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE = 'S'
                   MOVE 'V SCesa' TO FRM-GLS-SEGT IN OPC-FLD
               ELSE
                   MOVE 'V SAuto' TO FRM-GLS-SEGT IN OPC-FLD
                   MOVE '00'      TO FIO-STAT.
      * RBG FIN 6-DEC-1995
           IF FIO-STAT-OKS
               IF OPC-MSC-STAT IN OPC = 'A'
                   IF SCR-CMND = 'MCA'
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'OPC    ACAYA' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
               ELSE
                   IF OPC-MSC-STAT IN OPC = 'D'
                       MOVE 'COL' TO MSG-COD-SIST
                       MOVE 'OPC    DESYA' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
      * RBG INI 10-APR-1996
      * RBG INI 24-APR-1996
                       IF OPC-MSC-STAT IN OPC = 'J'
                           IF SCR-CMND = 'ELI'
                               GO TO FIN-FND-KEY
                           ELSE
      * RBG FIN 24-APR-1996
      * RBG INI 11-JUN-1996
                           IF SCR-CMND = 'MCA'
                              MOVE 'COL' TO MSG-COD-SIST
                              MOVE 'OPC    NOACA' TO MSG-COD-MENS
                              PERFORM GET-MSG
                              MOVE MSG-GLS-DESC TO FRM-MENS
                              MOVE '00' TO FIO-STAT
                              MOVE SCR-STAT-CON TO SCR-STAT
                              GO TO FIN-FND-KEY
                           ELSE
      * RBG FIN 11-JUN-1996
                              MOVE 'COL' TO MSG-COD-SIST
                              MOVE 'OPC    APRYA' TO MSG-COD-MENS
                              PERFORM GET-MSG
                              MOVE MSG-GLS-DESC TO FRM-MENS
                              MOVE '00' TO FIO-STAT
                              MOVE SCR-STAT-CON TO SCR-STAT
                              GO TO FIN-FND-KEY
      * RBG FIN 10-APR-1996
                       ELSE
                         IF SCR-CMND = 'MCA'
                             MOVE 'COL' TO MSG-COD-SIST
                             MOVE 'OPC    NOACA' TO MSG-COD-MENS
                             PERFORM GET-MSG
                             MOVE MSG-GLS-DESC TO FRM-MENS
                             MOVE '00' TO FIO-STAT
                             MOVE SCR-STAT-CON TO SCR-STAT
                             GO TO FIN-FND-KEY.
      *
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 OR FRM-FFLD = FRM-FFLD-PF5 )
      *>>>>
*% END
*% IF PFS_SCR_GFLD
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF6 OR
                            FRM-FFLD = FRM-FFLD-PF5 ) )
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           IF SCR-CMND = 'MCA'
      *DAD ini  31-AUG-1994 Compatibilidad PI-PQ en modulo manejo BQ
               MOVE FRM-CPIM-AEY TO CAN-CAI-IOPC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CAN-IIC-IOPC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CAN-NUM-ICAN-ATR IN OPC-FLD.
      *DAD fin  31-AUG-1994
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           PERFORM PRO-FLD-BCI.
      
           MOVE FRM-CPIM-AEY TO OPC-COD-TOOC-ATR IN OPC-FLD.
           MOVE FRM-CPIM-AEY TO OPC-COD-VCOC-ATR IN OPC-FLD.
           MOVE FRM-CPIM-AEY TO OPC-COD-AOOC-ATR IN OPC-FLD.
           MOVE 0            TO OPC-COD-TOOC-LEN IN OPC-FLD.
           MOVE -1           TO OPC-COD-OFOC-LEN IN OPC-FLD.
      
      *DAD ini  21-JUL-1992
           MOVE OPC-COD-VCOC IN OPC-FLD TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC-FLD TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
*% IF PGM_PQ
           IF NOT FIO-STAT-OKS
               GO TO FIN-HBL-FLD.
      
      *JPA ini  31-01-95
           PERFORM PRO-FLD-BCI2.
      *JPA fin  31-01-95
      
           IF POC-COD-COTO IN POC = 'LAC'
               MOVE FRM-CPIM-UBY TO OPC-CAI-ILDC-ATR IN OPC-FLD
               MOVE FRM-CPIM-UBY TO OPC-IIC-ILDC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-CAI-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-IIC-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO AUT-CAI-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO AUT-IIC-ICYA-ATR IN OPC-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO OPC-CAI-ILDC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-IIC-ILDC-ATR IN OPC-FLD.
      *DAD fin  21-JUL-1992
      
           IF SCR-CMND = 'MCA'
               PERFORM PRO-FLD-OPC
               PERFORM PRO-MKY-OPC
      *ALD-BCI-INI/ 5-JUN-1996
               PERFORM PRO-SEGP-OPC
      *ALD-BCI-FIN/ 5-JUN-1996
               MOVE FRM-CPIM-UBY TO RDC-NUM-DIRE-ATR IN OPC-FLD
      *DAD ini  12-AUG-1992   (Memo.24-07-92 Pto.1)
               MOVE FRM-CPIM-UBY TO OPC-VAL-SEGD-ATR IN OPC-FLD
      *DAD fin  12-AUG-1992
               MOVE FRM-CPIM-UBY TO OPC-VAL-SEGC-ATR IN OPC-FLD
               MOVE FRM-CPIM-UBY TO OPC-COD-CDOC-ATR IN OPC-FLD
               MOVE FRM-CPIM-UBY TO OPC-COD-RMOC-ATR IN OPC-FLD
      *DAD ini  13-ENE-1995   (Memo.22-08-94)
      * RBG INI 6-DEC-1995
      *        MOVE FRM-CPIM-UBY TO OPC-VAL-SEGP-ATR IN OPC-FLD
      * RBG FIN 6-DEC-1995
               MOVE FRM-CPIM-UBY TO OPC-COD-INSI-ATR IN OPC-FLD
      *DAD fin  13-ENE-1995
      *JPA ini  01-FEB-1995
               MOVE FRM-CPIM-UBY TO OPC-COD-CVTA-ATR IN OPC-FLD
      *JPA fin  01-FEB-1995
      *DAD ini  21-AUG-1992   (Memo.07-08-92 Pto.3)
               IF POC-COD-COTO IN POC NOT = 'LAC'
                   MOVE FRM-CPIM-UBY TO AUT-CAI-ICYA-ATR IN OPC-FLD
                   MOVE FRM-CPIM-UBY TO AUT-IIC-ICYA-ATR IN OPC-FLD.
           IF SCR-CMND = 'MCA'
      *DAD fin  21-AUG-1992
               IF DBC-IND-ICLI IN OPC-FLD = 'M' AND
                  SCR-IND-MRDC = 'M'
                   MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD
                   MOVE 0            TO OPC-COD-OFOC-LEN IN OPC-FLD
      *DAD ini  12-AUG-1992   (Memo.24-07-92 Pto.1)
      *             MOVE -1           TO OPC-COD-RMOC-LEN IN OPC-FLD
                   MOVE -1           TO OPC-VAL-SEGD-LEN IN OPC-FLD
      *DAD fin  12-AUG-1992
                   GO TO FIN-HBL-FLD
               ELSE
                   MOVE 0            TO OPC-COD-OFOC-LEN IN OPC-FLD
                   MOVE -1           TO RDC-NUM-DIRE-LEN IN OPC-FLD
                   GO TO FIN-HBL-FLD.
      *
           IF DBC-IND-ICLI IN OPC-FLD = 'M' AND
              SCR-IND-MRDC = 'M'
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD.
           MOVE FRM-CPIM-AEY TO ITR-COD-TINT-ATR IN OPC-FLD.
           IF ITR-COD-TINT IN OPC-FLD = 'MULTIPLES' AND
              SCR-IND-MITR = 'M'
               MOVE FRM-CPIM-AEY TO ITR-SGV-TINT-ATR IN OPC-FLD.
           IF COM-COD-TINT IN OPC-FLD = 'MULTIPLES' AND
              SCR-IND-MCOM = 'M'
               MOVE FRM-CPIM-AEY TO COM-COD-TINT-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO COM-SGV-TINT-ATR IN OPC-FLD.
           IF CYA-IND-TCYA IN OPC-FLD = 'M' AND
              SCR-IND-MCYA = 'M'
               MOVE FRM-CPIM-AEY TO CYA-IND-TCYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-CAI-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-IIC-ICYA-ATR IN OPC-FLD.
      
           PERFORM BUS-CIC-RENO
           IF OPC-IND-RENO IN OPC-FLD > SPACES
               MOVE           +3 TO OPC-COD-OFOC-LEN IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-COD-OFOC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-FEC-FCOL-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-IND-RENO-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO ROV-SGV-RENO-ATR IN OPC-FLD.
      
           IF (OPC-IND-RENO IN OPC = RNO-CIC-REN IN RNO-VARI) OR
              (OPC-IND-RENO IN OPC = RNO-CIC-PRO IN RNO-VARI) OR
              (DBC-IND-ICLI IN OPC-FLD = 'M')
                 MOVE -1 TO OPC-VAL-CRED-LEN IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPC-FLD
                 MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD
           ELSE
               MOVE -1 TO DBC-NUM-ICLI-LEN IN OPC-FLD.
      
      *DAD ini  27-JUL-1994   (Mimu.05-01-93 pto.1)
           IF OPC-IND-RENO IN OPC = RNO-CIC-PRO IN RNO-VARI
               MOVE FRM-CPIM-AEY TO OPC-VAL-CRED-ATR IN OPC-FLD
               MOVE +0           TO OPC-VAL-CRED-LEN IN OPC-FLD
               MOVE -1           TO ITR-SGV-TINT-LEN IN OPC-FLD.
      *
      *Lo arteriscado se hace mas arriba  - ELIMINAR EN PROX. MANT. -
      *     IF OPC-IND-RENO IN OPC-FLD > SPACES
      *         MOVE           +3 TO OPC-COD-OFOC-LEN IN OPC-FLD
      *         MOVE FRM-CPIM-AEY TO OPC-COD-OFOC-ATR IN OPC-FLD
      *         MOVE FRM-CPIM-AEY TO OPC-FEC-FCOL-ATR IN OPC-FLD
      *         MOVE FRM-CPIM-AEY TO OPC-IND-RENO-ATR IN OPC-FLD
      *         MOVE FRM-CPIM-AEY TO ROV-SGV-RENO-ATR IN OPC-FLD.
      *     IF (OPC-IND-RENO IN OPC = RNO-CIC-REN IN RNO-VARI) OR
      *        (OPC-IND-RENO IN OPC = RNO-CIC-PRO IN RNO-VARI)
      *           MOVE -1 TO OPC-VAL-CRED-LEN IN OPC-FLD
      *           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPC-FLD
      *           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPC-FLD
      *           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPC-FLD
      *           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPC-FLD
      *           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPC-FLD
      *           MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD
      *     ELSE
      *         MOVE -1 TO DBC-NUM-ICLI-LEN IN OPC-FLD.
      *DAD fin  27-JUL-1994
*% END
*% IF PGM_PU
           IF NOT FIO-STAT-OKS
               GO TO CON-HBL-FLD.

      *JPA ini  31-01-95
           PERFORM PRO-FLD-BCI2.
      *JPA fin  31-01-95

           IF POC-COD-COTO IN POC = 'LAC'
               MOVE FRM-CPIM-UBY TO OPC-CAI-ILDC-ATR IN OPC-FLD
               MOVE FRM-CPIM-UBY TO OPC-IIC-ILDC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-CAI-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-IIC-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO AUT-CAI-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO AUT-IIC-ICYA-ATR IN OPC-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO OPC-CAI-ILDC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO OPC-IIC-ILDC-ATR IN OPC-FLD.
      *DAD fin  21-JUL-1992

           IF SCR-CMND = 'MCA'
               PERFORM PRO-FLD-OPC
               PERFORM PRO-MKY-OPC
      *ALD-BCI-INI/ 5-JUN-1996
               PERFORM PRO-SEGP-OPC
      *ALD-BCI-FIN/ 5-JUN-1996
               MOVE FRM-CPIM-UBY TO RDC-NUM-DIRE-ATR IN OPC-FLD
      *DAD ini  12-AUG-1992   (Memo.24-07-92 Pto.1)
               MOVE FRM-CPIM-UBY TO OPC-VAL-SEGD-ATR IN OPC-FLD
      *DAD fin  12-AUG-1992
               MOVE FRM-CPIM-UBY TO OPC-COD-CDOC-ATR IN OPC-FLD
               MOVE FRM-CPIM-UBY TO OPC-COD-RMOC-ATR IN OPC-FLD
      *JPA ini  01-FEB-1995
               MOVE FRM-CPIM-UBY TO OPC-COD-CVTA-ATR IN OPC-FLD
      *JPA fin  01-FEB-1995
      *DAD ini  13-ENE-1995   (Memo.22-08-94)
               MOVE FRM-CPIM-UBY TO OPC-COD-INSI-ATR IN OPC-FLD
      *DAD fin  13-ENE-1995
      *DAD ini  21-AUG-1992   (Memo.07-08-92 Pto.3)
               IF POC-COD-COTO IN POC NOT = 'LAC'
                   MOVE FRM-CPIM-UBY TO AUT-CAI-ICYA-ATR IN OPC-FLD
                   MOVE FRM-CPIM-UBY TO AUT-IIC-ICYA-ATR IN OPC-FLD.
           IF SCR-CMND = 'MCA'
      *DAD fin  21-AUG-1992
               IF DBC-IND-ICLI IN OPC-FLD = 'M' AND
                  SCR-IND-MRDC = 'M'
                   MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD
                   MOVE 0            TO OPC-COD-OFOC-LEN IN OPC-FLD
      *DAD ini  12-AUG-1992   (Memo.24-07-92 Pto.1)
      *             MOVE -1           TO OPC-COD-RMOC-LEN IN OPC-FLD
                   MOVE -1           TO OPC-VAL-SEGD-LEN IN OPC-FLD
      *DAD fin  12-AUG-1992
               ELSE
                   MOVE 0            TO OPC-COD-OFOC-LEN IN OPC-FLD
                   MOVE -1           TO RDC-NUM-DIRE-LEN IN OPC-FLD.

      *DAD ini  27-JUL-1994   (Mimu.05-01-93 pto.1)
           IF OPC-IND-RENO IN OPC-FLD > SPACES
               MOVE FRM-CPIM-AEY TO OPC-FEC-FCOL-ATR IN OPC-FLD.

           PERFORM BUS-CIC-RENO.
           IF OPC-IND-RENO IN OPC-FLD = RNO-CIC-PRO IN RNO-VARI
               MOVE FRM-CPIM-AEY TO OPC-VAL-CRED-ATR IN OPC-FLD.

           IF OPC-IND-RENO IN OPC-FLD = RNO-CIC-PRO IN RNO-VARI OR
              OPC-IND-RENO IN OPC-FLD = RNO-CIC-REN IN RNO-VARI
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO ROV-SGV-RENO-ATR IN OPC-FLD.
      *DAD fin  27-JUL-1994

           IF SCR-CCPP NOT = 'ING'
               GO TO CON-HBL-FLD.
      *DAD ini  21-AUG-1992 / 21-JUL-1992
      *   Cambie la ubicacion para leer la POC
      *DAD fin  21-AUG-1992 / 21-JUL-1992
           IF POC-IND-GARA IN POC > SPACES
               MOVE POC-IND-GARA IN POC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 3          TO NUM-NENT
               MOVE 0          TO NUM-NDCM
               PERFORM VAL-NUM
               IF NOT NUM-STAT-OKS
                   MOVE FRM-CPIM-AEY TO OPC-IND-GARA-ATR IN OPC-FLD.
           IF POC-IND-AFER IN POC > SPACES
               MOVE FRM-CPIM-AEY TO OPC-IND-AFER-ATR IN OPC-FLD.
           IF POC-IND-RENO IN POC > SPACES
               MOVE POC-IND-RENO IN POC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 3          TO NUM-NENT
               MOVE 0          TO NUM-NDCM
               PERFORM VAL-NUM
               IF NOT NUM-STAT-OKS
                  MOVE FRM-CPIM-AEY TO OPC-IND-RENO-ATR IN OPC-FLD.
      *     IF POC-COD-TIPT IN POC > SPACES OR
      *        POC-COD-CVTI IN POC > SPACES OR
      *        POC-MSC-TFPR IN POC > SPACES OR
      *        POC-NUM-PREP IN POC > ZEROES OR
      *        POC-MSC-UTPR IN POC > SPACES
      *         MOVE FRM-CPIM-AEY TO ITR-COD-TINT-ATR IN OPC-FLD.
           IF POC-COD-TCOM IN POC > SPACES
               MOVE FRM-CPIM-AEY TO COM-COD-TINT-ATR IN OPC-FLD.
           IF POC-MSC-MCVF IN POC > SPACES
               MOVE FRM-CPIM-AEY TO OPC-MSC-MCVF-ATR IN OPC-FLD.
           IF POC-COD-SEGD IN POC > SPACES
               MOVE POC-COD-SEGD IN POC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 6          TO NUM-NENT
               MOVE 0          TO NUM-NDCM
               PERFORM VAL-NUM
               IF NOT NUM-STAT-OKS
                   MOVE FRM-CPIM-AEY TO OPC-COD-SEGD-ATR IN OPC-FLD.
           IF POC-COD-CDOC IN POC > SPACES
               MOVE POC-COD-CDOC IN POC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 3          TO NUM-NENT
               MOVE 0          TO NUM-NDCM
               PERFORM VAL-NUM
               IF NOT NUM-STAT-OKS
                   MOVE FRM-CPIM-AEY TO OPC-COD-CDOC-ATR IN OPC-FLD.
           IF POC-IND-TABO IN POC > SPACES
               MOVE POC-IND-TABO IN POC TO NUM-NUME
               MOVE NUM-ZERO-S TO NUM-ZERO
               MOVE NUM-SGNO-N TO NUM-SGNO
               MOVE 5          TO NUM-NENT
               MOVE 0          TO NUM-NDCM
               PERFORM VAL-NUM
               IF NOT NUM-STAT-OKS
                   MOVE FRM-CPIM-AEY TO CYA-IND-TCYA-ATR IN OPC-FLD.
       CON-HBL-FLD.
           IF DBC-IND-ICLI IN OPC-FLD = 'M' AND
              SCR-IND-MRDC = 'M'
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO RDC-NUM-DIRE-ATR IN OPC-FLD.
           MOVE FRM-CPIM-AEY TO ITR-COD-TINT-ATR IN OPC-FLD.
           IF ITR-COD-TINT IN OPC-FLD = 'MULTIPLES' AND
              SCR-IND-MITR = 'M'
               MOVE FRM-CPIM-AEY TO ITR-SGV-TINT-ATR IN OPC-FLD.
           IF COM-COD-TINT IN OPC-FLD = 'MULTIPLES' AND
              SCR-IND-MCOM = 'M'
               MOVE FRM-CPIM-AEY TO COM-COD-TINT-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO COM-SGV-TINT-ATR IN OPC-FLD.
           IF CYA-IND-TCYA IN OPC-FLD = 'M' AND
              SCR-IND-MCYA = 'M'
               MOVE FRM-CPIM-AEY TO CYA-IND-TCYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-CAI-ICYA-ATR IN OPC-FLD
               MOVE FRM-CPIM-AEY TO CYA-IIC-ICYA-ATR IN OPC-FLD.
*% END
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
*% IF PGM_PQ
      *(((( INICIO EOF COLPQOPC
       COPY TABBFCAM.
       COPY COLBFTOC.
       COPY GNSBGQUE.
       COPY GNSBGTSK.
*% END

       PRO-TCLA SECTION.
       INI-PRO-TCLA.
           IF ( FRM-FFLD NOT < FRM-FFLD-PF1 ) AND
              ( FRM-FFLD NOT > FRM-FFLD-PF9 )
               MOVE FRM-FFLD TO PGM-QPRO
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF10
               MOVE 'A' TO PGM-QPRO
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF11
               MOVE 'B' TO PGM-QPRO
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE 'C' TO PGM-QPRO
           ELSE
           IF FRM-FFLD = FRM-FFLD-PA1
               MOVE 'D' TO PGM-QPRO
           ELSE
           IF FRM-FFLD = FRM-FFLD-PA2
               MOVE 'E' TO PGM-QPRO
           ELSE
           IF FRM-FFLD = FRM-FFLD-PA3
               MOVE 'F' TO PGM-QPRO
           ELSE
               GO TO FIN-PRO-TCLA.
           MOVE PGM-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
*% IF PGM_PQ
      * PTC-INI 
           IF NOT SCR-OFRM-SRV
      * PTC-FIN 
*% END
           PERFORM GNS-PRO-SYS.
       FIN-PRO-TCLA.
           EXIT.

*% IF PGM_PQ
       GET-ROV-CAN SECTION.
       INI-GET-ROV-CAN.
      * RECUPERA CANCELACION(NOV)  ASOCIADA A OPERACION
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE '23' TO PGM-STAT-CAN.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-GET-ROV.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS
               MOVE FIO-STAT TO PGM-STAT-ROV
               GO TO FIN-GET-ROV-CAN.
      
           IF OPC-CIC-IOPC IN OPC NOT = ROV-CIC-IOPC IN ROV
               GO TO FIN-GET-ROV-CAN.
      
           IF ROV-IIC-IOPV IN ROV > ZEROES AND
              ROV-NUM-IVCT IN ROV > ZEROES
                MOVE FIO-STAT TO PGM-STAT-ROV
                MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN
                MOVE FIO-GET-KEY TO FIO-CMND
                PERFORM COL-FIO-CAN
                MOVE FIO-STAT TO PGM-STAT-CAN
           ELSE
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO CIC-GET-ROV.
       FIN-GET-ROV-CAN.
           EXIT.
      
      *DAD ini  31-AUG-1994 Compatibilidad PI-PQ en modulo manejo BQ
      * BUS-CNC SECTION.
      * INI-BUS-CNC.
      *     MOVE SPACES TO TAB SCR-MSC-TCAN.
      *     MOVE 'COL' TO TAB-COD-SIST.
      *     MOVE 'CNC' TO TAB-COD-TTAB IN TAB.
      *     MOVE CAN-MSC-CANC IN CAN TO TAB-COD-CTAB IN TAB.
      *     PERFORM BUS-TAB.
      *     MOVE TAB-GLS-ABRV IN TAB TO OPC-IND-RENO IN OPC-FLD.
      *     MOVE TAB-CIC-CTAB IN TAB TO SCR-MSC-TCAN.
      * FIN-BUS-CNC.
      *     EXIT.
      *DAD fin  31-AUG-1994
      
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.
      
       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-RQA2 > SPACES
               PERFORM LEE-NXT-PRV-RDC
           ELSE
           IF SCR-RQA1 > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               MOVE SPACES TO SCR-KEY-IRDC
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.
      
       LEE-NXT-PRV-RDC SECTION.
       INI-LEE-NXT-PRV-RDC.
           MOVE SCR-RQA2 TO ADR-RDC-REQA.
           IF SCR-KEY-IRDC = 'IRDC'
               MOVE ADR-VKEY IN ADR-RDC-REQA TO WSS-CIC-ICLI IN
                                                       WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-RDC
               IF SCR-KEY-IRDC = 'IDLC'
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                       GO TO INI-LEE-NXT-PRV-RDC
                   ELSE
                       MOVE 'RDCSI' TO MSG-COD-MENS
                       MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
                       MOVE FIO-GET-KEY TO FIO-CMND
                       PERFORM SGC-FIO-DBC
                       MOVE '00' TO PGM-STAT-DBC
               ELSE
                   IF RDC-CIC-ICLI IN RDC = WSS-CIC-ICLI IN WSS-VARI
                       MOVE ADR-RDC-REQA TO SCR-RQA2
                       IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                           GO TO INI-LEE-NXT-PRV-RDC
                       ELSE
                           MOVE 'RDCSI' TO MSG-COD-MENS
                   ELSE
                       MOVE 'RDCNO' TO MSG-COD-MENS
                       MOVE SPACES TO SCR-RQA2
                       IF SCR-RQA1 > SPACES
                           PERFORM LEE-NXT-PRV-DBC
                       ELSE
                           PERFORM LEE-NXT-PRV-NOM
           ELSE
               MOVE 'RDCNO' TO MSG-COD-MENS
               IF SCR-KEY-IRDC = 'IDLC'
                   MOVE '00' TO FIO-STAT
               ELSE
                   MOVE SPACES TO SCR-RQA2
                   IF SCR-RQA1 > SPACES
                       PERFORM LEE-NXT-PRV-DBC
                   ELSE
                       PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV-RDC.
           EXIT.
      
       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-RQA1 TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE 'DBCSI' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.
      
       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES
      
               MOVE DBC-GLS-NOMC IN OPC-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC.
      
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-LEQ TO FIO-CMND
           ELSE
               MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-RQA1
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF5
                   MOVE 'DBC    NOPRV' TO MSG-COD-MENS
               ELSE
                   MOVE 'DBC    NONXT' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.
      
       ANL-KEY-OPC SECTION.
       INI-ANL-KEY-OPC.
           PERFORM GET-CLI.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROES TO DBC-NUM-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-VRF-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-IND-ICLI IN OPC-FLD
               MOVE SPACES TO DBC-GLS-ICLI IN OPC-FLD
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-ANL-KEY-OPC
           ELSE
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-DBC-REQA TO SCR-RQA1
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPC-FLD
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD
               PERFORM BUS-DEU-DIR
               IF FIO-STAT-OKS
                   MOVE BUS-POR-CLTE TO BUS-POR-KEYS
                   MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC
               ELSE
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'CLI    NODIR' TO MSG-COD-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-ANL-KEY-OPC.
           EXIT.
      
       ANL-KEY-ALL SECTION.
       INI-ANL-KEY-ALL.
           PERFORM GET-CUR-ITR.
           IF NOT FIO-STAT-OKS
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'OPC    NOINT' TO MSG-COD-MENS
               GO TO FIN-ANL-KEY-ALL.
      *DAD/LRH ini  26-APR-1994 / 12-ABR-1994    (Memo.26-ENE-1994 Pto.3
           MOVE OPC-CAI-IOPC IN OPC-FLD TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO EVC-IIC-IOPC IN EVC.
           MOVE 1                       TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF FIO-STAT-OKS
               MOVE 'COL'          TO TAB-COD-SIST FIO-SIST
               MOVE 'CVC'          TO TAB-CIC-TTAB IN TAB
               MOVE 'FP'           TO TAB-CIC-CTAB IN TAB
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND
                  EVC-MSC-TCVE IN EVC = TAB-COD-CTAB IN TAB
                   NEXT SENTENCE
               ELSE
                   PERFORM GET-NXT-ITR
           ELSE
      *DAD/LRH fin  12-ABR-1994
           PERFORM GET-NXT-ITR.
           IF SCR-IND-MITR = 'M'
               MOVE 'MULTIPLES'  TO ITR-COD-TINT IN OPC-FLD
           ELSE
               MOVE '00' TO PGM-STAT-ITR
               PERFORM PUT-ITR-OPC.
           PERFORM GET-CUR-COM.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-COM
                PERFORM GET-NXT-COM
                IF SCR-IND-MCOM = 'M'
                    MOVE 'MULTIPLES' TO COM-COD-TINT IN OPC-FLD
                ELSE
                    PERFORM PUT-COM-OPC
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE ZEROES TO COM-SGV-TINT IN OPC-FLD
                MOVE SPACES TO COM-COD-TINT IN OPC-FLD.
           PERFORM GET-CUR-CYA.
           IF FIO-STAT-OKS
                MOVE '00' TO PGM-STAT-CYA
                PERFORM GET-NXT-CYA
                IF SCR-IND-MCYA = 'M'
                    MOVE 'M'          TO CYA-IND-TCYA IN OPC-FLD
                    MOVE MSG-GLS-DESC TO FRM-MEN2
                    MOVE SPACES TO MSG-COD-SIST
                    MOVE SPACES TO MSG-COD-MENS
                ELSE
                    PERFORM PUT-CYA-OPC
           ELSE
                MOVE SPACES TO MSG-COD-SIST
                MOVE SPACES TO MSG-COD-MENS
                MOVE SPACES TO CYA-IND-TCYA IN OPC-FLD
                MOVE SPACES TO CYA-CAI-ICYA IN OPC-FLD
                MOVE ZEROES TO CYA-IIC-ICYA IN OPC-FLD.
           MOVE OPC-CIC-IOPC IN OPC TO AUT-CIC-IOPC IN AUT.
           MOVE 'AUT'               TO AUT-NUM-ICAN IN AUT.
           MOVE 1                   TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-AUT
               PERFORM PUT-AUT-OPC
           ELSE
               MOVE SPACES TO MSG-COD-SIST
               MOVE SPACES TO MSG-COD-MENS
               MOVE ZEROES TO AUT-IIC-ICYA IN OPC-FLD
               MOVE SPACES TO AUT-CAI-ICYA IN OPC-FLD.
      *ALD-BCI-INI/12.08.1996
      *    PERFORM GET-CUR-ROV.
      *    IF FIO-STAT-OKS
      *         MOVE '00' TO PGM-STAT-ROV.
      *ALD-BCI-FIN/12.08.1996
       FIN-ANL-KEY-ALL.
           EXIT.
      
       BUS-DEU-DIR SECTION.
       INI-BUS-DEU-DIR.
           MOVE SPACES              TO RDC-KEY-IRDC IN RDC.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN RDC.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN RDC. 
           MOVE FIO-GET-NLS    TO FIO-CMND.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE '999999999999' TO RDC-KEY-IDLC IN RDC
               MOVE 999 TO RDC-NUM-IDLC IN RDC
               MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-DEU-DIR.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC
               IF RDC-NUM-IDLC IN RDC = ZEROES
                   MOVE '00' TO PGM-STAT-RDC
                   MOVE ADR-RDC-REQA TO SCR-RQA2
                   MOVE 'IRDC' TO SCR-KEY-IRDC
                   GO TO FIN-BUS-DEU-DIR
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE FIO-GET-PRV TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
                       GO TO LUP-BUS-DEU-DIR
            ELSE
               MOVE SPACES TO SCR-RQA2
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-DEU-DIR.
           EXIT.
      
       PUT-DBC SECTION.
       INI-PUT-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN OPC-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPC-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPC-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPC-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPC-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO RDC-CAI-ICLI IN OPC-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO RDC-IIC-ICLI IN OPC-FLD.
       FIN-PUT-DBC.
           EXIT.
      
       GET-CUR-RDC SECTION.
       INI-GET-CUR-RDC.
           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      *JSS COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-RDC.
      *JSS COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC AND
              RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC AND
              RDC-NUM-IDLC IN RDC = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *
       FIN-GET-CUR-RDC.
           EXIT.
      
       GET-NXT-RDC SECTION.
       INI-GET-NXT-RDC.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
      *PVG INI 04-09-2001
           IF SCR-KEY-IRDC = 'IRDC'
              MOVE SPACES TO FIO-AKEY
           ELSE
      *PVG FIN 04-09-2001
              MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              OPC-CAI-IOPC IN OPC = RDC-CAI-IOPC IN RDC AND
              OPC-IIC-IOPC IN OPC = RDC-IIC-IOPC IN RDC AND
              RDC-NUM-IDLC IN RDC = ZEROES
                MOVE 'M' TO SCR-IND-MRDC
                MOVE 'COL'          TO MSG-COD-SIST
                MOVE 'OPC    MDDIR' TO MSG-COD-MENS
                PERFORM GET-MSG
           ELSE
                MOVE SPACES TO SCR-IND-MRDC
                PERFORM GET-CUR-RDC.
       FIN-GET-NXT-RDC.
           EXIT.
      
       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-ITR.
           EXIT.
      
       GET-NXT-ITR SECTION.
       INI-GET-NXT-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS                              AND
              ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
                MOVE 'M' TO SCR-IND-MITR
           ELSE
                MOVE SPACES TO SCR-IND-MITR
                PERFORM GET-CUR-ITR.
       FIN-GET-NXT-ITR.
           EXIT.
      
       GET-CUR-COM SECTION.
       INI-GET-CUR-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO COM-CIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE 'COM'               TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = 'COM' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COM.
           EXIT.
      
       GET-NXT-COM SECTION.
       INI-GET-NXT-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF FIO-STAT-OKS                              AND
              COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
              COM-NUM-ICAN IN COM = ZEROES              AND
              COM-CIC-IOPV IN COM = SPACES              AND
              COM-NUM-IVCT IN COM = ZEROES              AND
              COM-IND-TTAS IN COM = 'COM'
                MOVE 'M' TO SCR-IND-MCOM
           ELSE
                MOVE SPACES TO SCR-IND-MCOM
                PERFORM GET-CUR-COM.
       FIN-GET-NXT-COM.
           EXIT.
      
       GET-CUR-CYA SECTION.
       INI-GET-CUR-CYA.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
      *JSS COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-CYA.
      *JSS COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              CYA-CIC-IOPC IN CYA = OPC-CIC-IOPC IN OPC AND
              CYA-NUM-ICAN IN CYA = ZEROES AND
              CYA-NUM-ICYA IN CYA = 1
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *
       FIN-GET-CUR-CYA.
           EXIT.
      
       GET-NXT-CYA SECTION.
       INI-GET-NXT-CYA.
           MOVE SPACES TO MSG-COD-SIST.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE 'CYA-KEY-ICYA' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS                              AND
              OPC-CIC-IOPC IN OPC = CYA-CIC-IOPC IN CYA AND
              CYA-NUM-ICAN IN CYA = ZEROES
               MOVE 'M' TO SCR-IND-MCYA
               MOVE 'COL'         TO MSG-COD-SIST
               MOVE 'OPC    MCYA' TO MSG-COD-MENS
               PERFORM GET-MSG
           ELSE
               MOVE SPACES TO SCR-IND-MCYA
               PERFORM GET-CUR-CYA.
       FIN-GET-NXT-CYA.
           EXIT.
      
       GET-CUR-ROV SECTION.
       INI-GET-CUR-ROV.
           MOVE 'ROV-KEY-IROV' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
      *JSS COMPATIBILIDAD VSAM-DTC MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      *
           PERFORM COL-FIO-ROV.
      *JSS COMPATIBILIDAD VSAM-DTC
           IF FIO-STAT-OKS AND
              ROV-CIC-IOPC IN ROV = OPC-CIC-IOPC IN OPC AND
              ROV-CIC-IOPV IN ROV = SPACES AND
              ROV-NUM-IVCT IN ROV = ZEROES
               NEXT SENTENCE
           ELSE
               MOVE '23' TO FIO-STAT.
      *
       FIN-GET-CUR-ROV.
           EXIT.
      ******************************************************************
       GET-ROV-REN SECTION.
       INI-GET-ROV-REN.
      * RECUPERA CANCELACIONES (REN)  ASOCIADAS A OPERACION
      * DEJA EN ZERO EN TOTAL DE CANCELACIONES QUE RENUEVAN LA OPERACION
           MOVE ZEROES TO WSS-TOT-RCAN.
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
           MOVE ZEROES TO WSS-TOT-PTTS IN WSS-VARI.
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               PERFORM CHK-ROV-PTTS
               IF WSS-TOT-PTTS IN WSS-VARI > ZEROES
                   GO TO VRF-RCAN.
      *DAD fin  09-DIC-1991
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE LOW-VALUES          TO ROV-KEY-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * ASUME QUE NO ENCONTRARA ROV'S
           MOVE '23' TO PGM-STAT-ROV.
       CIC-GET-ROV-REN.
           PERFORM COL-FIO-ROV.
           IF NOT FIO-STAT-OKS OR
              OPC-CIC-IOPC IN OPC NOT = ROV-CIC-IOPC IN ROV
               GO TO VRF-RCAN.
      
           IF NOT ( ROV-IIC-IOPV IN ROV > ZEROES AND
                    ROV-NUM-IVCT IN ROV > ZEROES )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-GET-ROV-REN
           ELSE
               MOVE FIO-STAT TO PGM-STAT-ROV
               MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF FIO-STAT-OKS AND
      *JSS 15-MAY-1991 20:41:00 ( agregado OR 'P' para manejo de cc )
                   ( CAN-MSC-STAT IN CAN = 'C' OR
                     CAN-MSC-STAT IN CAN = 'W' OR 'P' ) OR
                   ( OPC-MSC-STAT IN OPC = 'A' AND
                     CAN-MSC-STAT IN CAN = 'A' )
                       MOVE CAN-KEY-ICAN TO RCAN-CAN-KEY-ICAN
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
                       IF OPC-MSC-STAT IN OPC = 'A' AND
                          CAN-MSC-STAT IN CAN = 'A' AND
                          CAN-MSC-CANC IN CAN = 'PTT'
      *DAD ini  14-AUG-1992   (Memo.25-06-92 Pto.2)
                           MOVE  1  TO WSS-TOT-PTTS IN WSS-VARI
                           MOVE CAN-SGV-TREN IN CAN TO WSS-SGV-RENO
      *DAD fin  14-AUG-1992
                           MOVE FIO-GET-NXT TO FIO-CMND
                           GO TO CIC-GET-ROV-REN
                       ELSE
      *DAD fin  09-DIC-1991
                           ADD 1                   TO WSS-TOT-RCAN
      *                    ADD ROV-SGV-RENO IN ROV TO WSS-SGV-RENO
                           ADD CAN-SGV-TREN IN CAN TO WSS-SGV-RENO
                           MOVE FIO-GET-NXT TO FIO-CMND
                           GO TO CIC-GET-ROV-REN.
       VRF-RCAN.
      * EN INGRESO VERIFICO QUE EXISTIERA AL MENOS UNA CANCELACION
      * CON STATUS 'C' OR 'W'
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
           IF WSS-TOT-RCAN = ZEROES             AND
              WSS-TOT-PTTS IN WSS-VARI = ZEROES
      *DAD fin  09-DIC-1991
               GO TO FIN-GET-ROV-REN.
      
      *    RECUPERA ULTIMA CANCELACION CON STATUS 'C' O 'W'
           MOVE RCAN-CAN-KEY-ICAN TO CAN-KEY-ICAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE FIO-STAT TO PGM-STAT-CAN.
       FIN-GET-ROV-REN.
           EXIT.
      *-----------------------------------------------------------------
      *DAD ini  09-DIC-1991   (Memo.05-11-91 Pto.3)
      * En el caso de PTT's obtiene la operacion anterior que fue Prorro
       CHK-ROV-PTTS SECTION.
       INI-CHK-ROV-PTTS.
           MOVE '23' TO PGM-STAT-ROV.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE 'ROV-KEY-IVCT' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-ROV.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = ROV-CIC-IOPV IN ROV )
               GO TO FIN-CHK-ROV-PTTS.
           MOVE ROV-CIC-IOPC IN ROV TO WSS-CIC-IOPC IN WSS-VARI.
       CAN-CHK-ROV-PTTS.
           MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-MSC-STAT IN OPC = 'A' AND
                    CAN-MSC-STAT IN CAN = 'A' AND
                    CAN-MSC-CANC IN CAN = 'PTT' )
               GO TO FIN-CHK-ROV-PTTS.
           MOVE LOW-VALUES TO ROV-KEY-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CHK-ROV-PTTS.
           PERFORM COL-FIO-ROV.
           IF FIO-STAT-OKS AND
              ROV-CIC-IOPC IN ROV = WSS-CIC-IOPC IN WSS-VARI
               MOVE FIO-STAT TO PGM-STAT-ROV
               IF ROV-CIC-IOPV IN ROV NOT = OPC-CIC-IOPC IN OPC
                   MOVE ROV-KEY-IVCT IN ROV TO WSS-KEY-IVCT IN WSS-VARI
                   ADD 1 TO WSS-TOT-PTTS IN WSS-VARI
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-CHK-ROV-PTTS
               ELSE
                   MOVE WSS-KEY-IVCT IN WSS-VARI TO RCAN-CAN-KEY-ICAN
                                                          IN WSS-VARI.
       FIN-CHK-ROV-PTTS.
           EXIT.
      *DAD fin  09-DIC-1991
      ******************************************************************
      *
       COPY SGCBGCLI.
       COPY SGCBFDBC.
      *
      *DAD ini  21-JUL-1992
       COPY COLBFPOC.
      *DAD fin  21-JUL-1992
       COPY COLBFRDC.
       COPY COLBFROV.
       COPY COLBFCYA.
       COPY COLBFAUT.
       COPY COLBFCAN.
       COPY COLBFITR.
       COPY COLBFCOM.
      *
       COPY GNSBGPES.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY COLB3OPC.
      *LRH ini 12-ABR-1994
       COPY COLBFEVC.
      *LRH fin 12-ABR-1994
      *RVM-CST-INI 6-AUG-1996
       COPY SGCBFDCC REPLACING ==DCC== BY ==SDC==
                      ==ADR-DCC-REQA== BY ==ADR-SDC-REQA==.
      *RVM-CST-FIN 6-AUG-1996
      
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
      
       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-INST-GKY TO SCR-INST.
           PERFORM HBL-KEY.
           PERFORM SCR-CLRA-OPC.
           PERFORM EDT-KEY-OPC.
           PERFORM EDT-FLD-OPC.
           MOVE SCR-MENS-EXT TO OPC-GLS-MENS.
           MOVE SPACES TO SCR-CIC-IOPC
                          SCR-VEC-ENG
                          SCR-VEC-FST
                          SCR-IND-EOV
                          SCR-INST-EXT
                          SCR-MENS-EXT.
           PERFORM SCR-INIT.
           PERFORM SCR-EXIT.
       FIN-ING-FTER-CIC.
           EXIT.
      
       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.
       FIN-ING-SETE.
           EXIT.
      
       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE OPC-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
      
      * COPY COLBGMPT.
       CRG-TBL-ENG SECTION.
       INI-CRG-TBL-ENG.
           IF SCR-IND-OOD = 'C'
               MOVE 'CO07COLPACANCOLFCANCOLACAN' TO
                       WSS-VEC-PPRO IN WSS-PPRO(1)
               MOVE 'CO16COLPACYACOLFCYACOLACYA' TO
                       WSS-VEC-PPRO IN WSS-PPRO(2)
               MOVE 2 TO WSS-TOT-IIDX
           ELSE
               MOVE 'KO40COLPQOPCCOLFOPCCOLAOPC' TO
                       WSS-VEC-PPRO IN WSS-PPRO(1)
               MOVE 'CO29COLPARDCCOLFRDCCOLARDC' TO
                       WSS-VEC-PPRO IN WSS-PPRO(2)
               MOVE 'CO26COLPAICGCOLFICGCOLAICG' TO
                       WSS-VEC-PPRO IN WSS-PPRO(3)
               MOVE 'CO16COLPACYACOLFCYACOLACYA' TO
                       WSS-VEC-PPRO IN WSS-PPRO(4)
               MOVE 'CO12COLPADLCCOLFDLCCOLADLC' TO
                       WSS-VEC-PPRO IN WSS-PPRO(5)
               MOVE 'CO29COLPARDCCOLFRDCCOLARDC' TO
                       WSS-VEC-PPRO IN WSS-PPRO(6)
               MOVE 7 TO WSS-TOT-IIDX.
       FIN-CRG-TBL-ENG.
           EXIT.
       COPY COLBGRNO.
      *ALD-BCI-INI/ 5-JUN-1996
       PRO-SEGP-OPC SECTION.
       INI-PRO-SEGP-OPC.
           MOVE 'COL'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSC'                    TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN OPC-FLD  TO WSS-COD-TOOC IN WSS-VARI.
           MOVE OPC-COD-AOOC IN OPC-FLD  TO WSS-COD-AOOC IN WSS-VARI.
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
      * RBG INI 11-JUN-1996
               MOVE FRM-CPIM-UBY TO OPC-VAL-GAST-ATR IN OPC-FLD
      * RBG FIN 11-JUN-1996
               MOVE FRM-CPIM-UBY TO OPC-VAL-SEGP-ATR IN OPC-FLD
           ELSE
               MOVE FRM-CPIM-UBY TO OPC-VAL-GAST-ATR IN OPC-FLD
               MOVE FRM-CPIM-UBY TO OPC-VAL-SEGP-ATR IN OPC-FLD.
       FIN-PRO-SEGP-OPC.
           EXIT.
      *ALD-BCI-FIN/ 5-JUN-1996
      * FIN EOF COLPQOPC ))))
*% END
*% IF PGM_PU
      * (((( INICIO  EOF COLPQOPC 
       COPY GNSBGQUE.
       COPY GNSBPFEC.
      * PTC INI
       SET-TCIC SECTION.
       INI-SET-TCIC.
      * SI EXISTE TS ==> GENERA OPC CON CAI DE SIMULACION 'S'
           MOVE 'D'  TO CIC-COD-TCIC IN CIC.
           MOVE PTC-OPC-TYPE-SIMU TO QUE-TYPE.
           MOVE TSK-TERM-ALF TO QUE-TERM.
           MOVE PTC-OPC-LENG TO QUE-LITM.
           MOVE 1            TO  QUE-NITM.
           MOVE QUE-GET        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE 'S'  TO CIC-COD-TCIC IN CIC
                MOVE QUE-DEL        TO QUE-CMND
                PERFORM GNS-PRO-QUE.
       FIN-SET-TCIC.
           EXIT.

       SET-CCIC SECTION.
       INI-SET-CCIC.
      *COMPLEMENTA CAI DE SIMULACION COMO 'S' 'OPC'
           IF CIC-COD-TCIC IN CIC = 'D'
               MOVE OPC-COD-OFOC IN OPC-FLD TO CIC-COD-CCIC IN CIC
           ELSE
               MOVE 'OPC' TO CIC-COD-CCIC IN CIC.
       FIN-SET-CCIC.
           EXIT.

      * PTC FIN


       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

      * INIT
      * ====

       INI-REG-RDC SECTION.
       INI-INI-REG-RDC.
           MOVE SPACES   TO RDC-GLS-FLAG IN RDC.
      *     MOVE SPACES   TO RDC-COD-OINV IN RDC.
           MOVE SPACES   TO RDC-GLS-DISP IN RDC.
       FIN-INI-REG-RDC.
           EXIT.

       INI-REG-ITR SECTION.
       INI-INI-REG-ITR.
           MOVE SPACES   TO ITR-GLS-FLAG IN ITR.
      *     MOVE SPACES   TO ITR-COD-OINV IN ITR.
           MOVE ZEROES   TO ITR-FEC-FTER IN ITR.
           MOVE ZEROES   TO ITR-SGV-SPRD IN ITR.
           MOVE ZEROES   TO ITR-SGV-MNTO IN ITR.
           MOVE SPACES   TO ITR-GLS-DISP IN ITR.
       FIN-INI-REG-ITR.
           EXIT.

       INI-REG-COM SECTION.
       INI-INI-REG-COM.
           MOVE SPACES   TO COM-GLS-FLAG IN COM.
      *     MOVE SPACES   TO COM-COD-OINV IN COM.
           MOVE ZEROES   TO COM-FEC-FTER IN COM.
           MOVE ZEROES   TO COM-SGV-SPRD IN COM.
           MOVE ZEROES   TO COM-SGV-MNTO IN COM.
           MOVE SPACES   TO COM-GLS-DISP IN COM.
       FIN-INI-REG-COM.
           EXIT.

       INI-REG-CYA SECTION.
       INI-INI-REG-CYA.
           MOVE SPACES TO CYA-GLS-FLAG IN CYA.
      *     MOVE SPACES TO CYA-COD-OINV IN CYA.
           MOVE SPACES TO CYA-VRF-ICYA IN CYA.
           MOVE ZEROES TO CYA-SGV-LIQU IN CYA.
           MOVE SPACES TO CYA-GLS-DISP IN CYA.
       FIN-INI-REG-CYA.
           EXIT.

       INI-REG-AUT SECTION.
       INI-INI-REG-AUT.
           MOVE SPACES TO AUT-GLS-FLAG IN AUT.
      *     MOVE SPACES TO AUT-COD-OINV IN AUT.
           MOVE SPACES TO AUT-VRF-ICYA IN AUT.
           MOVE ZEROES TO AUT-SGV-LIQU IN AUT.
           MOVE SPACES TO AUT-GLS-DISP IN AUT.
           MOVE SPACES TO AUT-IND-TCYA IN AUT.
           MOVE SPACES TO AUT-COD-OFIC IN AUT.
           MOVE 'TCYA' TO MSC-CIC-TMSC IN MSC.
           MOVE 'CCTE' TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               MOVE MSC-COD-CMSC IN MSC TO AUT-IND-TCYA IN AUT.
           MOVE SPACES TO AUT-COD-OFIC IN AUT.
           MOVE AUT-CAI-ICYA IN OPC-FLD TO OPE-CAI-IOPE IN OPE.
           MOVE AUT-IIC-ICYA IN OPC-FLD TO OPE-IIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS
               MOVE OPE-COD-OFOP IN OPE TO AUT-COD-OFIC IN AUT.
       FIN-INI-REG-AUT.
           EXIT.

       INI-REG-ROV SECTION.
       INI-INI-REG-ROV.
           MOVE SPACES   TO ROV-GLS-FLAG IN ROV.
      *     MOVE SPACES   TO ROV-COD-OINV IN ROV.
           MOVE SPACES   TO ROV-COD-VCVR IN ROV.
           MOVE SPACES   TO ROV-GLS-DISP IN ROV.
       FIN-INI-REG-ROV.
           EXIT.

      * GET-UPD
      * =======

       GET-UPD-RDC SECTION.
       INI-GET-UPD-RDC.
           IF DBC-IND-ICLI IN OPC-FLD = 'M'
               MOVE '00' TO FIO-STAT
               GO TO FIN-GET-UPD-RDC.
           MOVE OPC-CAI-IOPC IN OPC-FLD TO RDC-CIC-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY.
      *RRM-INI 11-OCT-2001 (Compativilidad VSAM)
      *    MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           MOVE FIO-GET-KEY TO FIO-CMND.
      *RRM-FIN 11-OCT-2001
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        COMo la transaccion Termina no es necesario hacer UNLOCK
      *        RDC
      *        comunicar que no se pudo actualizar con mensaje pertinent
                MOVE FIO-MENS TO FRM-MENS
                GO TO FIN-GET-UPD-RDC.
           IF RDC-CAI-ICLI IN OPC-FLD = RDC-CAI-ICLI IN RDC AND
              RDC-IIC-ICLI IN OPC-FLD = RDC-IIC-ICLI IN RDC
               MOVE WSS-MISMO TO WSS-MRDC
      *RRM-INI 11-OCT-2001
               MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-RDC
      *RRM-FIN 11-OCT-2001
           ELSE
               MOVE WSS-OTRO  TO WSS-MRDC
      *RRM-INI 11-OCT-2001
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
      *        COMo la transaccion Termina no es necesario hacer UNLOCK
      *        RDC
      *        comunicar que no se pudo actualizar con mensaje pertinent
                MOVE FIO-MENS TO FRM-MENS
                GO TO FIN-GET-UPD-RDC.
      *RRM-FIN 11-OCT-2001
       FIN-GET-UPD-RDC.
           EXIT.

       GET-UPD-ITR SECTION.
       INI-GET-UPD-ITR.
           IF ITR-COD-TINT IN OPC-FLD = 'MULTIPLES'
               MOVE '00' TO FIO-STAT
               GO TO FIN-GET-UPD-ITR.
           PERFORM GET-CUR-ITR.
           IF NOT FIO-STAT-OKS
                 MOVE '23' TO PGM-STAT-ITR
           ELSE
                 MOVE FIO-GET-KEY-UPD TO FIO-CMND
                 PERFORM COL-FIO-ITR
                 IF NOT FIO-STAT-OKS
      *        COMo la transaccion Termina no es necesario hacer UNLOCK
      *        ITR
      *        comunicar que no se pudo actualizar con mensaje pertinent
                       MOVE '23' TO PGM-STAT-ITR
                       MOVE FIO-MENS TO FRM-MENS
                  ELSE
                       MOVE '00' TO PGM-STAT-ITR.
       FIN-GET-UPD-ITR.
           EXIT.

       GET-UPD-COM SECTION.
       INI-GET-UPD-COM.
           IF COM-COD-TINT IN OPC-FLD = 'MULTIPLES'
               MOVE '00' TO FIO-STAT
               GO TO FIN-GET-UPD-COM.

           PERFORM GET-CUR-COM.
           IF NOT FIO-STAT-OKS
               MOVE '23' TO PGM-STAT-COM
           ELSE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-COM
               IF NOT FIO-STAT-OKS
                   MOVE '23' TO PGM-STAT-COM
      *        COMo la transaccion Termina no es necesario hacer UNLOCK
      *        COM
      *        comunicar que no se pudo actualizar con mensaje pertinent
               ELSE
                    MOVE '00' TO PGM-STAT-COM.
       FIN-GET-UPD-COM.
           EXIT.

       GET-UPD-CYA SECTION.
       INI-GET-UPD-CYA.
           IF CYA-IND-TCYA IN OPC-FLD = 'M'
               MOVE '00' TO FIO-STAT
               GO TO FIN-GET-UPD-CYA.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
                 MOVE '23' TO PGM-STAT-CYA
      *        COMo la transaccion Termina no es necesario hacer UNLOCK
      *        CYA
      *        comunicar que no se pudo actualizar con mensaje pertinent
           ELSE
                MOVE '00' TO PGM-STAT-CYA.
       FIN-GET-UPD-CYA.
           EXIT.

       GET-UPD-AUT SECTION.
       INI-GET-UPD-AUT.
           MOVE OPC-CAI-IOPC IN OPC-FLD TO AUT-CAI-IOPC IN AUT.
           MOVE OPC-IIC-IOPC IN OPC-FLD TO AUT-IIC-IOPC IN AUT.
           MOVE 'AUT'                   TO AUT-NUM-ICAN IN AUT.
           MOVE 1                       TO AUT-NUM-ICYA IN AUT.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF NOT FIO-STAT-OKS
               MOVE '23' TO PGM-STAT-AUT
      *        COMo la transaccion Termina no es necesario hacer UNLOCK
      *        AUT
      *        comunicar que no se pudo actualizar con mensaje pertinent
           ELSE
               MOVE '00' TO PGM-STAT-AUT.
           MOVE '00' TO FIO-STAT.
       FIN-GET-UPD-AUT.
           EXIT.

       GET-UPD-ROV SECTION.
       INI-GET-UPD-ROV.
           MOVE '23' TO PGM-STAT-ROV.
      * MODIFICA ROV
           IF CAN-IIC-IOPC IN OPC-FLD > ZEROES
               MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV
               MOVE CAN-CAI-IOPC IN OPC-FLD TO ROV-CAI-IOPV IN ROV
               MOVE CAN-IIC-IOPC IN OPC-FLD TO ROV-IIC-IOPV IN ROV
               MOVE CAN-NUM-ICAN IN OPC-FLD TO ROV-NUM-IVCT IN ROV
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-ROV
               IF FIO-STAT-OKS
                   MOVE FIO-STAT TO PGM-STAT-ROV
               ELSE
      *    Error inconsistencia en la modificacion : hacer LOGTB e infor
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-GET-UPD-ROV.
           EXIT.

      * PUT
      * ===

       PUT-RDC SECTION.
       INI-PUT-RDC.
           IF DBC-IND-ICLI IN OPC-FLD NOT = 'M'
      *         MOVE SYS-TSTP TO RDC-STP-IINV IN RDC
               PERFORM INI-REG-RDC
               MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC
               MOVE ZEROES              TO RDC-NUM-IDLC IN RDC
               MOVE 100 TO RDC-VAL-LIMD IN RDC
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-RDC
               IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-RDC.
           EXIT.

       PUT-ITR SECTION.
       INI-PUT-ITR.
           IF ITR-COD-TINT IN OPC-FLD = 'MULTIPLES'
               GO TO FIN-PUT-ITR.
      *    MOVE SYS-TSTP TO ITR-STP-IINV IN ITR.
           PERFORM INI-REG-ITR.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR.
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR.
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE OPC-COD-VCOC IN OPC-FLD TO POC-COD-VCOC IN POC.
           MOVE OPC-COD-TOOC IN OPC-FLD TO POC-COD-TOOC IN POC.
           MOVE OPC-COD-AOOC IN OPC-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF POC-COD-CVTI IN POC > SPACES
               MOVE ITR-SGV-TINT IN OPC-FLD TO ITR-SGV-SPRD IN ITR
               MOVE ZEROES TO ITR-SGV-TINT IN ITR.
           MOVE POC-COD-TINT IN POC TO ITR-COD-TINT IN ITR.
      *    MOVE ITR-COD-TINT IN OPC-FLD TO ITR-COD-TINT IN ITR.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-PUT-ITR.
           EXIT.

       PUT-COM SECTION.
       INI-PUT-COM.
           IF COM-COD-TINT IN OPC-FLD NOT = 'MULTIPLES'
               IF COM-COD-TINT IN OPC-FLD > SPACES
      *             MOVE SYS-TSTP TO COM-STP-IINV IN COM
                   PERFORM INI-REG-COM
                   MOVE OPC-CIC-IOPC IN OPC TO COM-CIC-IOPC IN COM
                   MOVE ZEROES              TO COM-NUM-ICAN IN COM
                   MOVE SPACES              TO COM-CIC-IOPV IN COM
                   MOVE ZEROES              TO COM-NUM-IVCT IN COM
                   MOVE 'COM'               TO COM-IND-TTAS IN COM
                   MOVE ZEROES              TO COM-FEC-FINI IN COM
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM COL-FIO-COM
                   IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
                       MOVE FIO-MENS TO FRM-MENS
                       PERFORM BCK-OUT.
       FIN-PUT-COM.
           EXIT.

       PUT-CYA SECTION.
       INI-PUT-CYA.
           IF CYA-IND-TCYA IN OPC-FLD NOT = 'M'
      *         MOVE SYS-TSTP TO CYA-STP-IINV IN CYA
               PERFORM INI-REG-CYA
               MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA
               MOVE ZEROES              TO CYA-NUM-ICAN IN CYA
               MOVE 1                   TO CYA-NUM-ICYA IN CYA
               MOVE OPC-SGV-LIQU IN OPC-FLD TO CYA-SGV-LIQU IN CYA
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-CYA
               IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-CYA.
           EXIT.

       PUT-AUT SECTION.
       INI-PUT-AUT.
           IF AUT-IIC-ICYA IN OPC-FLD > ZEROES
               IF AUT-CAI-ICYA IN OPC-FLD > SPACES OR
                  AUT-IIC-ICYA IN OPC-FLD > ZEROES
      *         MOVE SYS-TSTP TO AUT-STP-IINV IN AUT
               PERFORM INI-REG-AUT
               MOVE OPC-CIC-IOPC IN OPC TO AUT-CIC-IOPC IN AUT
               MOVE 'AUT'               TO AUT-NUM-ICAN IN AUT
               MOVE 1                   TO AUT-NUM-ICYA IN AUT
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-AUT
               IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-AUT.
           EXIT.

       PUT-ROV SECTION.
       INI-PUT-ROV.
      * INGRESA ROV SOLO PARA NOVACIONES
           PERFORM BUS-CIC-RENO
           IF OPC-IND-RENO IN OPC = RNO-CIC-NOV IN RNO-VARI
               PERFORM INI-REG-ROV
               MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV
               MOVE CAN-CAI-IOPC IN OPC-FLD TO ROV-CAI-IOPV IN ROV
               MOVE CAN-IIC-IOPC IN OPC-FLD TO ROV-IIC-IOPV IN ROV
               MOVE CAN-NUM-ICAN IN OPC-FLD TO ROV-NUM-IVCT IN ROV
               PERFORM RET-ROV-OPC
               MOVE FIO-PUT TO FIO-CMND
               PERFORM COL-FIO-ROV
               IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e inform
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-PUT-ROV.
           EXIT.

      * MOD
      * ===

       MOD-RDC SECTION.
       INI-MOD-RDC.
           IF DBC-IND-ICLI IN OPC-FLD = 'M'
               GO TO FIN-MOD-RDC.
           IF WSS-MISMO-RDC
      *         MOVE SYS-TSTP TO RDC-STP-IINV IN RDC
      *PVG INI 04-09-2001
               MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY
      *PVG FIN 04-09-2001
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-RDC
           ELSE
               MOVE FIO-DEL TO FIO-CMND
               PERFORM COL-FIO-RDC
               IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e in
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-MOD-RDC
               ELSE
                   PERFORM PUT-RDC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e in
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-MOD-RDC.
       FIN-MOD-RDC.
           EXIT.

       MOD-ITR SECTION.
       INI-MOD-ITR.
           IF ITR-COD-TINT IN OPC-FLD = 'MULTIPLES'
               GO TO FIN-MOD-ITR.
      *    MOVE SYS-TSTP TO ITR-STP-IINV IN ITR.
           MOVE WSS-COD-TINT IN WSS-VARI TO ITR-COD-TINT IN ITR.
           IF ITR-COD-CVTI IN ITR > SPACES
               MOVE ITR-SGV-TINT IN OPC-FLD TO ITR-SGV-SPRD IN ITR
               MOVE ZEROES TO ITR-SGV-TINT IN ITR.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT FIO-STAT-OKS
      *    Error inconsistencia en la modificacion : hacer LOGTB e infor
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-MOD-ITR.
           EXIT.

       MOD-COM SECTION.
       INI-MOD-COM.
           IF COM-COD-TINT IN OPC-FLD = 'MULTIPLES'
               GO TO FIN-MOD-COM.
           IF PGM-STAT-COM-OKS
               IF COM-COD-TINT IN OPC-FLD > SPACES
      *             MOVE SYS-TSTP TO COM-STP-IINV IN COM
                   MOVE FIO-MOD TO FIO-CMND
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
           ELSE
               IF COM-COD-TINT IN OPC-FLD > SPACES
                   PERFORM PUT-COM
                   GO TO FIN-MOD-COM
               ELSE
                   GO TO FIN-MOD-COM.
           PERFORM COL-FIO-COM.
           IF NOT FIO-STAT-OKS
      *    Error inconsistencia en la modificacion : hacer LOGTB e infor
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-MOD-COM.
           EXIT.

       MOD-CYA SECTION.
       INI-MOD-CYA.
           IF CYA-IND-TCYA IN OPC-FLD NOT = 'M'
      *         MOVE SYS-TSTP TO CYA-STP-IINV IN CYA
               MOVE FIO-MOD TO FIO-CMND
               PERFORM COL-FIO-CYA
               IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e i
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-MOD-CYA.
           EXIT.

       MOD-AUT SECTION.
       INI-MOD-AUT.
           IF PGM-STAT-AUT-OKS
               IF AUT-CAI-ICYA IN OPC-FLD > SPACES OR
                  AUT-IIC-ICYA IN OPC-FLD > ZEROES
                   MOVE FIO-MOD TO FIO-CMND
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
           ELSE
               IF AUT-CAI-ICYA IN OPC-FLD > SPACES OR
                  AUT-IIC-ICYA IN OPC-FLD > ZEROES
                   PERFORM PUT-AUT
                   GO TO FIN-MOD-AUT
               ELSE
                   GO TO FIN-MOD-AUT.
           PERFORM COL-FIO-AUT.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e i
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-MOD-AUT.
           EXIT.

       MOD-ROV SECTION.
       INI-MOD-ROV.
           IF PGM-STAT-ROV-OKS
                PERFORM RET-ROV-OPC
                MOVE FIO-MOD TO FIO-CMND
                PERFORM COL-FIO-ROV
                IF NOT FIO-STAT-OKS
      *    Error inconsistencia en la modificacion : hacer LOGTB e infor
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT.
       FIN-MOD-ROV.
           EXIT.

      *DELETE
      *======

       DEL-DLC SECTION.
       INI-DEL-DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-DLC.
       LUP-DEL-DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-DLC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-DLC.
      * RB/INI/26-SEP-1996 /Para Eliminar en Realia
      *    MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * RBG/FIN/ 26-SEP-1996 /Para Eliminar en Realia
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = DLC-CIC-IOPC IN DLC
               GO TO LUP-DEL-DLC.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-DLC.
           EXIT.

       DEL-VEN SECTION.
       INI-DEL-VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-VEN.
       LUP-DEL-VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-VEN.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-VEN.
      * RB/INI/26-SEP-1996 /Para Eliminar en Realia
      *    MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * RBG/FIN/ 26-SEP-1996 /Para Eliminar en Realia
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN
               GO TO LUP-DEL-VEN.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-VEN.
           EXIT.

       DEL-EVC SECTION.
       INI-DEL-EVC.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = EVC-CIC-IOPC IN EVC )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-EVC.
       LUP-DEL-EVC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-EVC.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-EVC.
      * RB/INI/26-SEP-1996 /Para Eliminar en Realia
      *    MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * RBG/FIN/ 26-SEP-1996 /Para Eliminar en Realia
           PERFORM COL-FIO-EVC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = EVC-CIC-IOPC IN EVC
               GO TO LUP-DEL-EVC.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-EVC.
           EXIT.

       DEL-RDC SECTION.
       INI-DEL-RDC.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-IOPC IN RDC = OPC-CIC-IOPC IN OPC )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-RDC.
       LUP-DEL-RDC.
           MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-DEL        TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
      * RB/INI/26-SEP-1996 /Para Eliminar en Realia
      *    MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * RBG/FIN/ 26-SEP-1996 /Para Eliminar en Realia
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = RDC-CIC-IOPC IN RDC
               GO TO LUP-DEL-RDC.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-RDC.
           EXIT.

       DEL-ITR SECTION.
       INI-DEL-ITR.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE SPACES              TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-ITR.
       LUP-DEL-ITR.
           MOVE 'ITR-KEY-IICG'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-DEL        TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
      * RB/INI/26-SEP-1996 /Para Eliminar en Realia
      *    MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * RBG/FIN/ 26-SEP-1996 /Para Eliminar en Realia
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = ITR-CIC-IOPC IN ITR
               GO TO LUP-DEL-ITR.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-ITR.
           EXIT.

       DEL-CYA SECTION.
       INI-DEL-CYA.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE SPACES              TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT ( FIO-STAT-OKS AND
                    CYA-CIC-IOPC IN CYA = OPC-CIC-IOPC IN OPC )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-CYA.
       LUP-DEL-CYA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-CYA.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-CYA.
      * RB/INI/26-SEP-1996 /Para Eliminar en Realia
      *    MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * RBG/FIN/ 26-SEP-1996 /Para Eliminar en Realia
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = CYA-CIC-IOPC IN CYA
               GO TO LUP-DEL-CYA.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-CYA.
           EXIT.

      *DAD ini  08-ABR-1992   (Memo.02-03-92 Pto.2)
       DEL-RCE SECTION.
       INI-DEL-RCE.
           MOVE OPC-CIC-IOPC IN OPC TO RCE-CIC-IOPC IN RCE.
           MOVE ZEROES              TO RCE-NUM-IDLC IN RCE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = RCE-CIC-IOPC IN RCE )
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-RCE.
       LUP-DEL-RCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-RCE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-DEL-RCE.
      * RB/INI/26-SEP-1996 /Para Eliminar en Realia
      *    MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-GET-NLS TO FIO-CMND.
      * RBG/FIN/ 26-SEP-1996 /Para Eliminar en Realia
           PERFORM COL-FIO-RCE.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = RCE-CIC-IOPC IN RCE
               GO TO LUP-DEL-RCE.
           MOVE '00' TO FIO-STAT.
       FIN-DEL-RCE.
           EXIT.
      *DAD fin  08-ABR-1992

       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-ITR.
           EXIT.

       GET-CUR-COM SECTION.
       INI-GET-CUR-COM.
           MOVE 'COM-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO COM-CIC-IOPC IN COM.
           MOVE ZEROES              TO COM-NUM-ICAN IN COM.
           MOVE SPACES              TO COM-CIC-IOPV IN COM.
           MOVE ZEROES              TO COM-NUM-IVCT IN COM.
           MOVE 'COM'               TO COM-IND-TTAS IN COM.
           MOVE ZEROES              TO COM-FEC-FINI IN COM.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-COM.
           IF NOT ( FIO-STAT-OKS AND
                    COM-CIC-IOPC IN COM = OPC-CIC-IOPC IN OPC AND
                    COM-NUM-ICAN IN COM = ZEROES              AND
                    COM-CIC-IOPV IN COM = SPACES              AND
                    COM-NUM-IVCT IN COM = ZEROES              AND
                    COM-IND-TTAS IN COM = 'COM' )
               MOVE '23' TO FIO-STAT.
       FIN-GET-CUR-COM.
           EXIT.

      *PTC-INI:
       COPY GNSBGTSK.
      *PTC-FIN:

       COPY COLBFRDC.
       COPY COLBFROV.
       COPY COLBFCYA.
       COPY COLBFAUT.
       COPY COLBFCAN.
       COPY COLBFITR.
       COPY COLBFCOM.
       COPY COLBFDLC.
       COPY COLBFVEN.
       COPY COLBFEVC.
       COPY COLBFPOC.
      *DAD ini  08-ABR-1992   (Memo.02-03-92 Pto.2)
       COPY COLBFRCE.
      *DAD fin  08-ABR-1992
       COPY GNSBGCPT.
       COPY GNSBGSTR.

       BUS-FAM SECTION.
       INI-BUS-FAM.
       FIN-BUS-FAM.
           EXIT.

       COPY GNSBGPES.

       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY GNSBGCAM.
      *
       COPY TABBVUSR.
       COPY TABBFCAM.
      *
       COPY SGCBGDOM.
       COPY SGCBFDBC.
       COPY SGCBFDCP.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY SGCBFRCD.
       COPY COLB3OPC.
      *DAD ini  01-MAR-1995   (Manejo LINEA de AVANCE para LDC )
       COPY COLBGLDC.
      *DAD fin  01-MAR-1995
      *RVM-CST-INI 6-AUG-1996
       COPY SGCBFDCC REPLACING ==DCC== BY ==SDC==
                      ==ADR-DCC-REQA== BY ==ADR-SDC-REQA==.
      *RVM-CST-FIN 6-AUG-1996

      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS

       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      * PTC ini
           IF NOT SCR-OFRM-SRV
      * PTC fin
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.

       COPY COLBGMPT.
       COPY COLBGRNO.
      *ALD-BCI-INI/ 5-JUN-1996
       PRO-SEGP-OPC SECTION.
       INI-PRO-SEGP-OPC.
           MOVE 'COL'                    TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSC'                    TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-TOOC IN OPC-FLD  TO WSS-COD-TOOC IN WSS-VARI.
           MOVE OPC-COD-AOOC IN OPC-FLD  TO WSS-COD-AOOC IN WSS-VARI.
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
      * RBG INI 11-JUN-1996
               MOVE FRM-CPIM-UBY TO OPC-VAL-GAST-ATR IN OPC-FLD
      * RBG FIN 11-JUN-1996
               MOVE FRM-CPIM-UBY TO OPC-VAL-SEGP-ATR IN OPC-FLD
           ELSE
               MOVE FRM-CPIM-UBY TO OPC-VAL-GAST-ATR IN OPC-FLD
               MOVE FRM-CPIM-UBY TO OPC-VAL-SEGP-ATR IN OPC-FLD.
       FIN-PRO-SEGP-OPC.
           EXIT.
      *ALD-BCI-FIN/ 5-JUN-1996
      * FIN EOF COLPQOPC ))))
*% END

      *>>>>
*% END
