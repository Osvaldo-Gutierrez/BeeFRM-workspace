*%! Codigo adicional para archivo
*% IF IOS
      *<<<< IOS
      *DOS SELECT RPTMOT         ASSIGN TO SYS012-UR-1403-S.
      *MVS SELECT RPTMOT         ASSIGN TO        UT-S-RPTMOT.
           SELECT RPTMOT         ASSIGN TO        UT-S-RPTMOT.
      *>>>>
*% END
*% IF RR
      *<<<< RR
      *RVM-CST-INI 29-JAN-1997
           03 SRT-VAL-MNAC                        PIC 9(11)V9(04).
      *RVM-CST-FIN 29-JAN-1997
      *>>>>
*% END
*% IF FLS
      *<<<< FLS
       FD  RPTMOT LABEL RECORDS OMITTED
           REPORT IS RPT-MOT.
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>
*% END
*% IF RW
      *<<<< RW
       COPY COLRWMOT.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSBRMSC.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABBRCAM.
       COPY TABBRTIO.
       COPY COLBRDLC.
       COPY COLBRTOC.
       COPY GNSWCNUM.
       COPY GNSWVNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY COLWGCAU.
       COPY COLWGCTO.

       01  WSS-VARI.
           03 WSS-FEC-FINI.
              05 WSS-NUM-DINI                     PIC 9(02).
              05 WSS-NUM-MINI                     PIC 9(02).
              05 WSS-NUM-SINI                     PIC 9(02).
              05 WSS-NUM-AINI                     PIC 9(02).
           03 WSS-FEC-FTER.
              05 WSS-NUM-DTER                     PIC 9(02).
              05 WSS-NUM-MTER                     PIC 9(02).
              05 WSS-NUM-STER                     PIC 9(02).
              05 WSS-NUM-ATER                     PIC 9(02).
           03 WSS-FEC-FHIP.
              05 WSS-NUM-SHIP                     PIC 9(02).
              05 WSS-NUM-AHIP                     PIC 9(02).
              05 WSS-NUM-MHIP                     PIC 9(02).
              05 WSS-NUM-DHIP                     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-FEC-FFET.
              05 WSS-NUM-SFET                     PIC 9(02).
              05 WSS-NUM-AFET                     PIC 9(02).
              05 WSS-NUM-MFET                     PIC 9(02).
              05 WSS-NUM-DFET                     PIC 9(02).
           03 WSS-COD-OFOC                        PIC X(03).
           03 WSS-ALF-SELE      VALUE SPACES      PIC X(11).
           03 WSS-VAL-SELE      VALUE ZEROES      PIC 9(11).
           03 WSS-COD-PESO                        PIC X(06).
      *RVM-CST-INI 28-JAN-1997
           03 WSS-COD-UF                          PIC X(06).
           03 WSS-VAL-UF                          PIC 9(11)V9(04).
           03 WSS-COD-DOLA                        PIC X(06).
           03 WSS-VAL-DOLA                        PIC 9(11)V9(04).
           03 WSS-COD-DOLO                        PIC X(06).
           03 WSS-VAL-DOLO                        PIC 9(11)V9(04).
           03 WSS-VAL-PES-TOPE  VALUE ZEROES      PIC 9(13)V9(04).
           03 WSS-VAL-REA-TOPE  VALUE ZEROES      PIC 9(13)V9(04).
           03 WSS-VAL-DOL-TOPE  VALUE ZEROES      PIC 9(13)V9(04).
           03 WSS-VAL-OTR-TOPE  VALUE ZEROES      PIC 9(13)V9(04).
           03 WSS-VAL-TOT-TOPE  VALUE ZEROES      PIC 9(14)V9(04).
      *RVM-CST-FIN 28-JAN-1997
           03 WSS-IND-NEXT                        PIC 9(01).
           03 WSS-IND-MNAC      VALUE ZEROES      PIC 9(01).
           03 WSS-VAL-MNAC      VALUE ZEROES      PIC 9(11).
           03 WSS-COD-VCOC                        PIC X(06).
           03 WSS-COD-TOOC                        PIC X(03).
           03 WSS-SW            VALUE ZEROES      PIC 9(01).
           03 WSS-TAB-VLR-TIO.
              05 WSS-TAB-OPNU.
                 07 WSS-NUM-OPNU                  PIC 9(06).
                 07 WSS-VAL-OPNU                  PIC 9(13)V9999.
              05 WSS-TAB-RENO.
                 07 WSS-NUM-RENO                  PIC 9(06).
                 07 WSS-VAL-RENO                  PIC 9(13)V9999.
              05 WSS-TAB-TOPE.
                 07 WSS-NUM-TOPE                  PIC 9(06).
                 07 WSS-VAL-TOPE                  PIC 9(13)V9999.
           03  WSS-GLS-DAT3.
               05 FILLER                          PIC X(14).
               05 WSS-IND-OMIT                    PIC X(01).
               05 FILLER                          PIC X(15).
           03 WSS-IND-SCTB                        PIC X(03).
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY COLRFMOT.
           .
       COPY COLRTMOT.
      *>>>>
*% END
*% IF CF_MOC_OPC_COD_OFOC
      *<<<< CF_MOC_OPC_COD_OFOC
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.
      *>>>>
*% END
*% IF CF_MOC_OPC_COD_VCOC
      *<<<< CF_MOC_OPC_COD_VCOC
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.
           MOVE  1  TO WSS-SW IN WSS-VARI.
      *>>>>
*% END
*% IF CF_MOC_OPC_COD_TOOC
      *<<<< CF_MOC_OPC_COD_TOOC
      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF WSS-COD-VCOC IN WSS-VARI > SPACES
               MOVE 'TAB'                    TO TAB-COD-SIST
               MOVE 'VLR'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-VCOC IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCOC IN WSS-MOC
                                           WSS-GLS-VCOC IN WSS-MOT
           ELSE
               MOVE SPACES TO WSS-GLS-VCOC IN WSS-MOC
                              WSS-GLS-VCOC IN WSS-MOT.

      * Mediante BUS-TAB Busca Tipo de Operacion de Tabla TIO
           IF WSS-COD-TOOC IN WSS-VARI > SPACES
               MOVE 'TAB'                    TO TAB-COD-SIST
               MOVE 'TIO'                    TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-TOOC IN WSS-VARI TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOOC IN WSS-MOC
           ELSE
               MOVE SPACES TO WSS-GLS-TOOC IN WSS-MOC.

           MOVE  2  TO WSS-IND-NEXT IN WSS-VARI.
      *>>>>
*% END
*% IF PH_MOC
      *<<<< PH_MOC
           IF WSS-COD-OFOC IN WSS-VARI = 'B'
               GO TO FIN-PH-MOC.
      * Mediante BUS-OFI Busca Nombre de Oficina de Tabla OFI
           IF OPC-COD-OFOC IN SRT > SPACES
               MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI.
      *>>>>
*% END
*% IF FF_MOC
      *<<<< FF_MOC
      *>>>>
*% END
*% IF FIN_DEC
      *<<<< FIN_DEC
       DEC-FF-MOT SECTION.
           USE BEFORE REPORTING FF-MOT.
       INI-FF-MOT.
      *REPRESENTA LOS VALORES EN MILES(1000) DE PESOS
           DIVIDE WSS-VAL-PES-TOPE IN WSS-VARI BY 1000
                  GIVING WSS-VAL-PES-TOPE IN WSS-MOT ROUNDED.
           DIVIDE WSS-VAL-REA-TOPE IN WSS-VARI BY 1000
                  GIVING WSS-VAL-REA-TOPE IN WSS-MOT ROUNDED.
           DIVIDE WSS-VAL-DOL-TOPE IN WSS-VARI BY 1000
                  GIVING WSS-VAL-DOL-TOPE IN WSS-MOT ROUNDED.
           DIVIDE WSS-VAL-OTR-TOPE IN WSS-VARI BY 1000
                  GIVING WSS-VAL-OTR-TOPE IN WSS-MOT ROUNDED.
           COMPUTE WSS-VAL-TOT-TOPE IN WSS-MOT =
                   WSS-VAL-PES-TOPE IN WSS-MOT +
                   WSS-VAL-REA-TOPE IN WSS-MOT +
                   WSS-VAL-DOL-TOPE IN WSS-MOT +
                   WSS-VAL-OTR-TOPE IN WSS-MOT.
       FIN-FF-MOT.
           EXIT.
      *>>>>
*% END
*% IF INI
      *<<<< INI
           DISPLAY 'INICIO CAPTURA DE PARAMETROS'.

      *Captura Fecha de Inicio
           DISPLAY 'FECHA DE INICIO ( DDMMAAAA ) : '.
           ACCEPT  WSS-FEC-FINI IN WSS-VARI.
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
      *Captura Fecha de Termino
           DISPLAY 'FECHA DE TERMINO ( DDMMAAAA ) : '
           ACCEPT  WSS-FEC-FTER IN WSS-VARI.
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
      *Captura Codigo de Oficina
           DISPLAY 'OFICINA (B=BANCO,*=TODAS,NRO.OFICINA): '.
           ACCEPT  WSS-COD-OFOC IN WSS-VARI.
           DISPLAY WSS-COD-OFOC IN WSS-VARI.
      *Captura Monto Minimo
           DISPLAY 'MONTO MINIMO SELECCION EN PESOS ( 99999999999 ) : '
           ACCEPT  WSS-ALF-SELE IN WSS-VARI.
           DISPLAY WSS-ALF-SELE IN WSS-VARI.

           DISPLAY 'FIN    CAPTURA    DE PARAMETROS'.
           DISPLAY 'INICIO VALIDACION DE PARAMETROS'.

      *VAL-FEC Valida Fecha de Inicio
           DISPLAY WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-FEC-FINI    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-ABT.

      *VAL-FEC Valida Fecha de Termino
           DISPLAY WSS-FEC-FTER IN WSS-VARI.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               PERFORM GNS-PRO-ABT.

      *CMP-FEC Compara Fecha de Inicio con Fecha de Termino
           MOVE WSS-FEC-FINI IN WSS-VARI TO FEC-FEC1.
           MOVE WSS-FEC-FTER IN WSS-VARI TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'FECFINIFTER' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG
               PERFORM GNS-PRO-ABT.

           MOVE 01 TO WSS-NUM-DHIP IN WSS-VARI.

           MOVE WSS-NUM-DINI IN WSS-VARI TO WSS-NUM-DINI IN WSS-MOC
                                            WSS-NUM-DINI IN WSS-MOT
                                            WSS-NUM-DFEC IN WSS-VARI.
           MOVE WSS-NUM-MINI IN WSS-VARI TO WSS-NUM-MINI IN WSS-MOC
                                            WSS-NUM-MINI IN WSS-MOT
                                            WSS-NUM-MFEC IN WSS-VARI
                                            WSS-NUM-MHIP IN WSS-VARI.
           MOVE WSS-NUM-SINI IN WSS-VARI TO WSS-NUM-SINI IN WSS-MOC
                                            WSS-NUM-SINI IN WSS-MOT
                                            WSS-NUM-SFEC IN WSS-VARI
                                            WSS-NUM-SHIP IN WSS-VARI.
           MOVE WSS-NUM-AINI IN WSS-VARI TO WSS-NUM-AINI IN WSS-MOC
                                            WSS-NUM-AINI IN WSS-MOT
                                            WSS-NUM-AFEC IN WSS-VARI
                                            WSS-NUM-AHIP IN WSS-VARI.
           MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DTER IN WSS-MOC
                                            WSS-NUM-DTER IN WSS-MOT
                                            WSS-NUM-DFET IN WSS-VARI.
           MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MTER IN WSS-MOC
                                            WSS-NUM-MTER IN WSS-MOT
                                            WSS-NUM-MFET IN WSS-VARI.
           MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-STER IN WSS-MOC
                                            WSS-NUM-STER IN WSS-MOT
                                            WSS-NUM-SFET IN WSS-VARI.
           MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ATER IN WSS-MOC
                                            WSS-NUM-ATER IN WSS-MOT
                                            WSS-NUM-AFET IN WSS-VARI.

      *VAL-OFI Valida codigo de Oficina en TABLAS
           IF WSS-COD-OFOC IN WSS-VARI NOT > SPACES
               MOVE '*' TO WSS-COD-OFOC IN WSS-VARI.
           IF WSS-COD-OFOC IN WSS-VARI NOT = '*' AND
              WSS-COD-OFOC IN WSS-VARI NOT = 'B'
               DISPLAY WSS-COD-OFOC IN WSS-VARI
               MOVE WSS-COD-OFOC IN WSS-VARI TO OFI-COD-OFIC IN OFI
               PERFORM VAL-OFI
               IF MSG-COD-MENS > SPACES
                   DISPLAY MSG-GLS-DESC IN MSG
                   PERFORM GNS-PRO-ABT.

      *VAL-NUM Validacion numerica Monto Minimo Seleccion
           MOVE WSS-ALF-SELE IN WSS-VARI TO NUM-NUME.
           MOVE NUM-ZERO-S               TO NUM-ZERO.
           MOVE NUM-SGNO-N               TO NUM-SGNO.
           MOVE 11                       TO NUM-NENT.
           MOVE 0                        TO NUM-NDCM.
           CALL 'GNSPVNUM' USING NUM-VARI.
           IF NUM-STAT-OKS
               MOVE NUM-NN9N TO WSS-VAL-SELE IN WSS-VARI
           ELSE
               MOVE ZEROES TO WSS-VAL-SELE IN WSS-VARI.
           DISPLAY WSS-VAL-SELE IN WSS-VARI.
           IF WSS-VAL-SELE IN WSS-VARI NOT > ZEROES
               PERFORM GNS-PRO-ABT.

           DISPLAY 'FIN VALIDACION DE PARAMETROS'.

      * Obtiene Codigo Valor de Cambio Mediante CIC de Moneda
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.

      *RVM-CST-INI 28-JAN-1997
      * Obtiene Codigo de Moneda Dolar Mediante CIC '1013'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '101301'       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC101301NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLA IN WSS-VARI.

      * Obtiene Codigo de Moneda Dolar OBSERVADO Mediante CIC '101307'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '101307'       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC101307NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLO IN WSS-VARI.

      * Obtiene Codigo de Moneda U.F.Mediante CIC '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               PERFORM GNS-PRO-ABT.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI.

      *BUSCA VALOR DE CAMBIO DE DOLARES USA A PESOS
           MOVE WSS-FEC-FFET IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FFET IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-DOLA IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO : '
                  CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   DISPLAY 'IND. VIGENCIA NO VALIDO EN CAM : '
                           CAM-KEY-CAMB IN CAM
                   PERFORM GNS-PRO-ABT
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-DOLA IN WSS-VARI
                   DISPLAY 'VALOR DE CAMBIO  : '
                           CAM-KEY-CAMB IN CAM  '   ES DE    : ' 
                           WSS-VAL-DOLA IN WSS-VARI.

      *BUSCA VALOR DE CAMBIO DE DOLAR OBSERVADO A PESOS
           MOVE WSS-FEC-FFET IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FFET IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-DOLO IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO : '
                  CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   DISPLAY 'IND. VIGENCIA NO VALIDO EN CAM : '
                           CAM-KEY-CAMB IN CAM
                   PERFORM GNS-PRO-ABT
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-DOLO IN WSS-VARI
                   DISPLAY 'VALOR DE CAMBIO  : '
                           CAM-KEY-CAMB IN CAM  '   ES DE    : ' 
                           WSS-VAL-DOLO IN WSS-VARI.

      *BUSCA VALOR DE CAMBIO DE UF A PESOS
           MOVE WSS-FEC-FFET IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FFET IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE WSS-COD-UF   IN WSS-VARI TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO : '
                  CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   DISPLAY 'IND. VIGENCIA NO VALIDO EN CAM : '
                           CAM-KEY-CAMB IN CAM
                   PERFORM GNS-PRO-ABT
               ELSE
                   MOVE CAM-SGV-VCAM IN CAM TO WSS-VAL-UF IN WSS-VARI
                   DISPLAY 'VALOR DE CAMBIO  : '
                           CAM-KEY-CAMB IN CAM  '   ES DE    : ' 
                           WSS-VAL-UF IN WSS-VARI.
      *RVM-CST-FIN 28-JAN-1997

      * Obtiene Indicador con CIC Situacion Contable Vencida en Tabla MSC
           MOVE 'COL'          TO MSC-COD-SIST.
           MOVE 'SCTB'         TO MSC-CIC-TMSC IN MSC.
           MOVE 'VCD'          TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           PERFORM BUS-MSC.
           IF MSG-COD-MENS > SPACES
               DISPLAY MSG-GLS-DESC  MSC-CIC-TABL IN MSC
               PERFORM GNS-PRO-ABT.
           MOVE MSC-COD-CMSC IN MSC TO WSS-IND-SCTB IN WSS-VARI.

      * Proceso para Cargar la tabla  COL/AUX  en Memoria
           PERFORM COL-CRG-CAU.
           IF CAU-CMSG IN CAU-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CAU-CMSG IN CAU-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CAU-MEN2 IN CAU-VARI
               PERFORM GNS-PRO-ABT.

      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
               PERFORM GNS-PRO-ABT.

      * Inicializa Variables
           MOVE ZEROES TO WSS-TAB-VLR-TIO IN WSS-VARI.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
      *ALD  MOVE WSS-FEC-FFEC IN WSS-VARI TO OPC-FEC-FCOL IN OPC.
           MOVE WSS-FEC-FHIP IN WSS-VARI TO OPC-FEC-FCOL IN OPC.
           MOVE 'OPC-FEC-FCOL'           TO FIO-AKEY.
           MOVE FIO-GET-NLS              TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS OR
              OPC-FEC-FCOL IN OPC > WSS-FEC-FFET IN WSS-VARI
               DISPLAY 'NO HAY REGISTROS PARA RANGO DE FECHAS : DESDE '
                       WSS-FEC-FINI IN WSS-VARI ' A '
                       WSS-FEC-FTER IN WSS-VARI
               GO TO FIN-INP-SRT.
           GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * Proceso de Seleccion y Clasificacion a Partir del Registro OPC
           PERFORM SEL-REG-PRO.
           IF WSS-IND-NEXT IN WSS-VARI = 1
               GO TO NXT-INP-SRT.

           IF WSS-COD-OFOC IN WSS-VARI = 'B'
               MOVE SPACES TO OPC-COD-OFOC IN OPC.

      *RVM-CST-INI 29-JAN-1997
           MOVE WSS-VAL-MNAC IN WSS-VARI TO SRT-VAL-MNAC IN SRT.
      *RVM-CST-FIN 29-JAN-1997
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           MOVE 'OPC-FEC-FCOL' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF OPC-FEC-FCOL IN OPC > WSS-FEC-FFET IN WSS-VARI
               GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
           IF WSS-COD-OFOC IN WSS-VARI = 'B'
               MOVE SPACES                   TO WSS-GLS-OFIC IN WSS-MOC
               MOVE 'T O T A L    B A N C O' TO OFI-GLS-DESC
      *         MOVE 'L   B A N C O  ' TO WSS-GLS-TOTA IN WSS-MOC
           ELSE
               MOVE 'OFICINA :'       TO WSS-GLS-OFIC IN WSS-MOC.
      *         MOVE '  O F I C I N A' TO WSS-GLS-TOTA IN WSS-MOC.
           MOVE '  M O N E D A  ' TO WSS-GLS-TOTA IN WSS-MOC.
           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
      *>>>>
*% END
*% IF FST_OUT
      *<<<< FST_OUT
           OPEN OUTPUT RPTMOT.
           INITIATE RPT-MOT.
           MOVE  0  TO WSS-SW IN WSS-VARI.
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
           IF WSS-IND-NEXT IN WSS-VARI = 2
               MOVE ZEROES TO WSS-NUM-OPNU IN WSS-MOC
                              WSS-VAL-OPNU IN WSS-MOC
                              WSS-NUM-RENO IN WSS-MOC
                              WSS-VAL-RENO IN WSS-MOC
                              WSS-NUM-TOPE IN WSS-MOC
                              WSS-VAL-TOPE IN WSS-MOC
                              WSS-IND-NEXT IN WSS-VARI.

           IF WSS-IND-NEXT IN WSS-VARI = 1
               MOVE ZEROES TO WSS-NUM-OPNU IN WSS-MOC
                              WSS-NUM-OPNT IN WSS-MOC
                              WSS-VAL-OPNU IN WSS-MOC
                              WSS-VAL-OPNT IN WSS-MOC
                              WSS-NUM-RENO IN WSS-MOC
                              WSS-NUM-RENT IN WSS-MOC
                              WSS-VAL-RENO IN WSS-MOC
                              WSS-VAL-RENT IN WSS-MOC
                              WSS-NUM-TOPE IN WSS-MOC
                              WSS-NUM-TOPT IN WSS-MOC
                              WSS-VAL-TOPE IN WSS-MOC
                              WSS-VAL-TOPT IN WSS-MOC
                              WSS-IND-NEXT IN WSS-VARI.

           IF WSS-SW IN WSS-VARI = 1 AND
              WSS-COD-OFOC IN WSS-VARI = 'B'
               GENERATE DL-MOT
               MOVE ZEROES TO WSS-NUM-OPNU IN WSS-MOT
                              WSS-VAL-OPNU IN WSS-MOT
                              WSS-NUM-RENO IN WSS-MOT
                              WSS-VAL-RENO IN WSS-MOT
                              WSS-NUM-TOPE IN WSS-MOT
                              WSS-VAL-TOPE IN WSS-MOT
                              WSS-SW       IN WSS-VARI.

           PERFORM GEN-TAB-TOT.
      *>>>>
*% END
*% IF FIN_TMT
      *<<<< FIN_TMT
           IF WSS-COD-OFOC IN WSS-VARI = 'B'
               GENERATE DL-MOT.
           TERMINATE RPT-MOT.
           CLOSE RPTMOT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      **************************************************************************
      * Seleccion del Registro para Proceso Mediante Oficina del Listado
       SEL-REG-PRO SECTION.
       INI-SEL-REG-PRO.
           MOVE  1  TO WSS-IND-NEXT IN WSS-VARI.

      * Excluye Creditos sin Activar
           IF OPC-MSC-STAT IN OPC NOT = 'A'
               GO TO FIN-SEL-REG-PRO.

      *DAD ini  05-DIC-1991   (Memo.23-07-91 pto.2)
      * Excluye Prorrogas de creditos
           IF OPC-IND-RENO IN OPC = 'PRO'
               GO TO FIN-SEL-REG-PRO.
      *DAD fin  05-DIC-1991

           IF WSS-COD-OFOC IN WSS-VARI NOT = '*' AND
              WSS-COD-OFOC IN WSS-VARI NOT = 'B'
               IF WSS-COD-OFOC IN WSS-VARI NOT = OPC-COD-OFOC IN OPC
                   GO TO FIN-SEL-REG-PRO.

           IF OPC-COD-COOC IN OPC NOT > SPACES
               DISPLAY 'OPERACION SIN COD-COOC : ' OPC-KEY-IOPC IN OPC
               GO TO FIN-SEL-REG-PRO.

      * Busca con el Codigo Clase Operacion en la Tabla cargada en Memoria
      * el Indicador de Exclusion
           MOVE OPC-COD-COOC IN OPC TO CAU-COOC IN CAU-VARI.
           PERFORM COL-BUS-CAU.
           IF CAU-CMSG IN CAU-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CAU-CMSG IN CAU-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CAU-MEN2 IN CAU-VARI
                       'CON CODIGO : '     CAU-COOC IN CAU-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               GO TO FIN-SEL-REG-PRO.

      * Excluye Tipos de Operaciones segun Indicador en Pos. 45 Datos Anexos
           MOVE CAU-DAT3 IN CAU-VARI TO WSS-GLS-DAT3 IN WSS-VARI.
           IF WSS-IND-OMIT IN WSS-VARI = 'X'
               GO TO FIN-SEL-REG-PRO.

      *ALD
      *DAD ini  05-DIC-1991
      * Busca con el Codigo Tipo Operacion en la Tabla cargada en Memoria el
      * 'Opera Como'
           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
                       'CON CODIGO : '     CTO-TOOC IN CTO-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               GO TO FIN-SEL-REG-PRO.

      * Obtiene 'Opera Como'
           MOVE SPACES               TO TOC.
           MOVE CTO-OPEC IN CTO-VARI TO TOC-MSC-OPEC IN TOC.
      *DAD fin  05-DIC-1991

           MOVE 'COL'               TO MSC-COD-SIST FIO-SIST.
           MOVE 'OPEC'              TO MSC-COD-TMSC IN MSC.
           MOVE TOC-MSC-OPEC IN TOC TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF WSS-IND-OMIT IN WSS-VARI NOT = 'H' AND
              MSC-CIC-CMSC IN MSC = 'H'           
               GO TO FIN-SEL-REG-PRO.
           IF MSC-CIC-CMSC IN MSC NOT = 'H' AND
              OPC-FEC-FCOL IN OPC < WSS-FEC-FFEC IN WSS-VARI
               GO TO FIN-SEL-REG-PRO.
      *
      * Busca los Documentos de Credito para Operacion Determinada
           MOVE SPACES              TO DLC-KEY-IDLC IN DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS OR
              DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   OPC-KEY-IOPC IN OPC
               GO TO FIN-SEL-REG-PRO.
       LUP-BUS-OPC-DLC.
      * Excluye ( Cartera Vencida )
           IF DLC-IND-SCTB IN DLC = WSS-IND-SCTB IN WSS-VARI
               GO TO FIN-SEL-REG-PRO.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS OR
              DLC-CIC-IOPC IN DLC NOT = OPC-CIC-IOPC IN OPC
               GO TO CON-SEL-REG-PRO.
           GO TO LUP-BUS-OPC-DLC.
       CON-SEL-REG-PRO.

           MOVE  0  TO WSS-IND-MNAC IN WSS-VARI.

      *OPC ES U.F., TOMA VALOR DE CAMBIO YA BUSCADO
           IF WSS-COD-UF IN WSS-VARI = OPC-COD-VCOC IN OPC
               MULTIPLY OPC-VAL-CRED IN OPC BY WSS-VAL-UF IN WSS-VARI
                        GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
               GO TO VAL-SEL-REG-PRO.

      *OPC ES DOLAR U.S.A, TOMA VALOR DE CAMBIO YA BUSCADO
           IF WSS-COD-DOLA IN WSS-VARI = OPC-COD-VCOC IN OPC
               MULTIPLY OPC-VAL-CRED IN OPC BY WSS-VAL-DOLA IN WSS-VARI
                        GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
               GO TO VAL-SEL-REG-PRO.

      *OPC ES DOLAR OBSERVADO, TOMA VALOR DE CAMBIO YA BUSCADO
           IF WSS-COD-DOLO IN WSS-VARI = OPC-COD-VCOC IN OPC
               MULTIPLY OPC-VAL-CRED IN OPC BY WSS-VAL-DOLO IN WSS-VARI
                        GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
               GO TO VAL-SEL-REG-PRO.

           IF WSS-COD-PESO IN WSS-VARI NOT = OPC-COD-VCOC IN OPC
               PERFORM BUS-VAL-CAM.

           IF WSS-IND-MNAC IN WSS-VARI = 1
               MULTIPLY OPC-VAL-CRED IN OPC BY CAM-SGV-VCAM IN CAM
                              GIVING WSS-VAL-MNAC IN WSS-VARI ROUNDED
           ELSE
               MOVE OPC-VAL-CRED IN OPC TO WSS-VAL-MNAC IN WSS-VARI.

       VAL-SEL-REG-PRO.
           IF WSS-VAL-MNAC IN WSS-VARI < WSS-VAL-SELE IN WSS-VARI
               GO TO FIN-SEL-REG-PRO.

           MOVE  0  TO WSS-IND-NEXT IN WSS-VARI.
       FIN-SEL-REG-PRO.
           EXIT.
      **************************************************************************
      * Genera Totales en Tabla Acumulando segun Moneda y Tipo Operacion
       GEN-TAB-TOT SECTION.
       INI-GEN-TAB-TOT.
           MOVE OPC-COD-VCOC IN SRT TO WSS-COD-VCOC IN WSS-VARI.
           MOVE OPC-COD-TOOC IN SRT TO WSS-COD-TOOC IN WSS-VARI.
           ADD         1            TO WSS-NUM-TOPE IN WSS-MOC.
           ADD         1            TO WSS-NUM-TOPE IN WSS-MOT.
           ADD         1            TO WSS-NUM-TOPT IN WSS-MOC.
           ADD         1            TO WSS-NUM-TOPE IN WSS-VARI.
           ADD  OPC-VAL-CRED IN SRT TO WSS-VAL-TOPE IN WSS-MOC.
           ADD  OPC-VAL-CRED IN SRT TO WSS-VAL-TOPE IN WSS-MOT.
           ADD  OPC-VAL-CRED IN SRT TO WSS-VAL-TOPT IN WSS-MOC.
           ADD  OPC-VAL-CRED IN SRT TO WSS-VAL-TOPE IN WSS-VARI.
      *RVM-CST-INI 27-JAN-1997
           PERFORM DET-TRAMO-RESU
      *RVM-CST-FIN 27-JAN-1997
           IF OPC-IND-RENO IN SRT NOT = SPACES
               ADD        1            TO WSS-NUM-RENO IN WSS-MOC
               ADD        1            TO WSS-NUM-RENO IN WSS-MOT
               ADD        1            TO WSS-NUM-RENT IN WSS-MOC
               ADD        1            TO WSS-NUM-RENO IN WSS-VARI
               ADD OPC-VAL-CRED IN SRT TO WSS-VAL-RENO IN WSS-MOC
               ADD OPC-VAL-CRED IN SRT TO WSS-VAL-RENO IN WSS-MOT
               ADD OPC-VAL-CRED IN SRT TO WSS-VAL-RENT IN WSS-MOC
               ADD OPC-VAL-CRED IN SRT TO WSS-VAL-RENO IN WSS-VARI
           ELSE
               ADD        1            TO WSS-NUM-OPNU IN WSS-MOC
               ADD        1            TO WSS-NUM-OPNU IN WSS-MOT
               ADD        1            TO WSS-NUM-OPNT IN WSS-MOC
               ADD        1            TO WSS-NUM-OPNU IN WSS-VARI
               ADD OPC-VAL-CRED IN SRT TO WSS-VAL-OPNU IN WSS-MOC
               ADD OPC-VAL-CRED IN SRT TO WSS-VAL-OPNU IN WSS-MOT
               ADD OPC-VAL-CRED IN SRT TO WSS-VAL-OPNT IN WSS-MOC
               ADD OPC-VAL-CRED IN SRT TO WSS-VAL-OPNU IN WSS-VARI.
       FIN-GEN-TAB-TOT.
           EXIT.
      *RVM-CST-INI 27-JAN-1997
       DET-TRAMO-RESU SECTION.
       INI-DET-TRAMO-RESU.

           ADD 1 TO WSS-NUM-TOT-TOPE IN WSS-MOT.

      *    IF OPC-COD-VCOC IN SRT = '0999'
           IF OPC-COD-VCOC IN SRT = WSS-COD-PESO IN WSS-VARI
               ADD 1                   TO WSS-NUM-PES-TOPE IN WSS-MOT
               ADD SRT-VAL-MNAC IN SRT TO WSS-VAL-PES-TOPE IN WSS-VARI
           ELSE
      *    IF OPC-COD-VCOC IN SRT = '0998' OR '101307'
           IF ( OPC-COD-VCOC IN SRT = WSS-COD-UF   IN WSS-VARI OR
                OPC-COD-VCOC IN SRT = WSS-COD-DOLO IN WSS-VARI )
               ADD 1                   TO WSS-NUM-REA-TOPE IN WSS-MOT
               ADD SRT-VAL-MNAC IN SRT TO WSS-VAL-REA-TOPE IN WSS-VARI
           ELSE
      *    IF OPC-COD-VCOC IN SRT = '1013  '
           IF OPC-COD-VCOC IN SRT = WSS-COD-DOLA IN WSS-VARI
               ADD 1                   TO WSS-NUM-DOL-TOPE IN WSS-MOT
               ADD SRT-VAL-MNAC IN SRT TO WSS-VAL-DOL-TOPE IN WSS-VARI
           ELSE
               ADD 1                   TO WSS-NUM-OTR-TOPE IN WSS-MOT
               ADD SRT-VAL-MNAC IN SRT TO WSS-VAL-OTR-TOPE IN WSS-VARI.
       FIN-DET-TRAMO-RESU.
           EXIT.
      *RVM-CST-FIN 27-JAN-1997
      **************************************************************************
      * Obtiene Valor de Cambio de Operacion de Credito en Moneda Nacional
       BUS-VAL-CAM SECTION.
       INI-BUS-VAL-CAM.
           MOVE WSS-FEC-FFET IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FFET IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE OPC-COD-VCOC IN OPC      TO CAM-COD-VCAM IN CAM(1).
           MOVE WSS-COD-PESO IN WSS-VARI TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO EXISTE VALOR DE CAMBIO : '
                  CAM-KEY-CAMB IN CAM
               PERFORM GNS-PRO-ABT
           ELSE
               IF CAM-IND-VIGE NOT = 'S'
                   DISPLAY 'IND. VIGENCIA NO VALIDO EN CAM : '
                           CAM-KEY-CAMB IN CAM
                   PERFORM GNS-PRO-ABT
               ELSE
                   MOVE  1  TO WSS-IND-MNAC IN WSS-VARI.
           DISPLAY 'CAM : ' CAM-KEY-CAMB IN CAM.
       FIN-BUS-VAL-CAM.
           EXIT.
      **************************************************************************

       COPY GNSBFMSC.
       COPY TABBFUSR.
       COPY TABBFOFI.
       COPY TABBFCAM.
       COPY COLBFDLC.
       COPY COLBFTOC.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY TABBBUSR.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY COLBGCAU.
       COPY COLBGCTO.
      *>>>>
*% END
