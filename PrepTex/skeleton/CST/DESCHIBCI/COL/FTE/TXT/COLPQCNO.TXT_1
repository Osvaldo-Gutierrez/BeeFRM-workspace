*% IF WSS_IBM
      *<<<< WSS_IBM
       COPY COLWGCUN.
       COPY SGCBRDBC.
       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
      *>>>> 
*% END
*% IF FIN_PGM_STAT
      *<<<< FIN_PGM_STAT
      * VARIABLE DE FECHA
           03 PGM-FEC-FHOY.
              05 PGM-NUM-SHOY                           PIC X(02).
              05 PGM-NUM-AHOY                           PIC X(02).
              05 PGM-NUM-MHOY                           PIC X(02).
              05 PGM-NUM-DHOY                           PIC X(02).
           03 PGM-MSG-CON.
              05 PGM-MSG-1           VALUE 'EVC1: '     PIC X(06).
              05 PGM-MSG-EVCI1                          PIC 9(03).
              05 PGM-MSG-2           VALUE ' A '        PIC X(03).
              05 PGM-MSG-EVCF1                          PIC 9(03).
              05 PGM-MSG-3           VALUE ' EVC2: '    PIC X(07).
              05 PGM-MSG-EVCI2                          PIC 9(03).
              05 PGM-MSG-4           VALUE ' A '        PIC X(03).
              05 PGM-MSG-EVCF2                          PIC 9(03).
              05 PGM-MSG-5           VALUE ' EVC3: '    PIC X(07).
              05 PGM-MSG-EVCI3                          PIC 9(03).
              05 PGM-MSG-6T          VALUE ' A '        PIC X(03).
              05 PGM-MSG-EVCF3                          PIC 9(03).
           03 PGM-NUM-KEY1                              PIC 9(04).
           03 PGM-INV-TIPO.
              05 PGM-GLS-CPTO                           PIC X(03).
              05 PGM-TIPO-13                            PIC X(03).

           03 PGM-AUXILIAR.
              05 PGM-FEC-AUX.
                 07 PGM-FEC-DAXC                        PIC 9(02).
                 07 PGM-FEC-MAXC                        PIC 9(02).
                 07 PGM-FEC-SAXC                        PIC 9(02).
                 07 PGM-FEC-AAXC                        PIC 9(02).


           03 PGM-CONSTANTES.
              05 PGM-CT-1            VALUE 1            PIC 9(01).
              05 PGM-CT-5            VALUE 5            PIC 9(02).
              05 PGM-CT-CNO          VALUE 'CNO'        PIC X(03).
              05 PGM-CT-CTO          VALUE 'CTO'        PIC X(03).
              05 PGM-CT-COL          VALUE 'COL'        PIC X(03).
              05 PGM-CT-ERROGRBLOG   VALUE 'ERROGRBLOG' PIC X(10).
              05 PGM-CT-999          VALUE '999'        PIC X(03).
              05 PGM-CT-COLPQCNO     VALUE 'COLPQCNO'   PIC X(08).
              05 PGM-CT-CON          VALUE 'CON'        PIC X(03).
              05 PGM-CT-9999         VALUE 9999         PIC 9(04).
              05 PGM-CT-00           VALUE '00'         PIC X(02).
              05 PGM-CT-80           VALUE '80'         PIC X(02).
              05 PGM-CT-KEY                             PIC X(12)
                                     VALUE 'DBC-IDC-ICLI'.
              05 PGM-CT-CLINTNOEXIST                    PIC X(12)
                                     VALUE 'CLINTNOEXIST'.
              05 PGM-CT-180          VALUE 180          PIC 9(03).
              05 PGM-CT-240          VALUE 240          PIC 9(03).
              05 PGM-CT-FVEN-180     VALUE 'FVEN<180'   PIC X(08).
              05 PGM-CT-FVEN-240     VALUE 'FVEN>240'   PIC X(08).
              05 PGM-CT-4            VALUE 4            PIC 9(01).
              05 PGM-CT-3            VALUE 3            PIC 9(01).
              05 PGM-CT-CICIOPCNOOPC                    PIC X(12)
                                     VALUE 'CICIOPCNOOPC'.
              05 PGM-CT-CFL          VALUE 'CFL'        PIC X(03).
              05 PGM-CT-CAECFLINVALI                    PIC X(12)
                                     VALUE 'CAECFLINVALI'.
              05 PGM-CT-CAEINGNOACT                     PIC X(11)
                                     VALUE 'CAEINGNOACT'.
              05 PGM-CT-CAE5NODIA                       PIC X(09)
                                     VALUE 'CAE5NODIA'.
      *>>>> 
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE DBC-NUM-ICLI-ALF IN CNO-FLD
                           TO CUN-VARI-RUT  IN CUN-VARI.

           MOVE NGA-KEY-CPTO IN CNO-FLD
                           TO CUN-VARI-TIP0 IN CUN-VARI.


           MOVE NGA-NUM-SUX2 IN CNO-FLD TO CUN-FEC-SFCO IN CUN-VARI.
           MOVE NGA-NUM-AUX2 IN CNO-FLD TO CUN-FEC-AFCO IN CUN-VARI.
           MOVE NGA-NUM-MUX2 IN CNO-FLD TO CUN-FEC-MFCO IN CUN-VARI.
           MOVE NGA-NUM-DUX2 IN CNO-FLD TO CUN-FEC-DFCO IN CUN-VARI.

           IF NGA-CAI-IOPV IN CNO-FLD > SPACES AND
              NGA-IIC-IOPV IN CNO-FLD > SPACES
              MOVE NGA-CAI-IOPV IN CNO-FLD TO CUN-CAI-IOPC IN CUN-VARI
              MOVE NGA-IIC-IOPV IN CNO-FLD TO CUN-IIC-IOPC IN CUN-VARI.

           MOVE FRM-NUM-NVEN-ALF IN CNO-FLD
                           TO CUN-VARI-NVEN IN CUN-VARI.

           PERFORM COL-LNK-CUN.

      * FALTA LA CONSULTA PARA CUANDO SE PREGUNTA CON EL OPC

           IF CUN-COD-TMSG1 IN CUN-VARI = SPACES
              PERFORM GRABA-LOG

              IF CUN-COD-TMSG1 IN CUN-VARI = SPACES
                 MOVE PGM-CT-00 TO PGM-STAT-NGA
                 MOVE PGM-CT-00 TO FIO-STAT.

           IF CUN-COD-TMSG1 IN CUN-VARI > SPACES
              MOVE PGM-CT-80     TO PGM-STAT-NGA
              MOVE PGM-CT-80     TO FIO-STAT
              MOVE CUN-COD-TMSG1 TO MSG-COD-SIST
              MOVE CUN-COD-CMSG1 TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE FRM-SUAR-MAL  TO FRM-SUAR.

           GO TO FIN-FND-KEY.
      *>>>> 
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       COPY SGCBFDBC.
       COPY COLBKCUN.
       COPY COLBFOPC.
       COPY GNSBVCOD.
       COPY GNSBVTAB.



      *-----------------------------------------------------------
      *  GRABA LOG COLNGA CONCEPTO SPM
      *-----------------------------------------------------------
       GRABA-LOG SECTION.
       INI-GRABA-LOG.
           MOVE SPACES TO NGA.

           MOVE DBC-CIC-ICLI IN DBC       TO  NGA-CIC-KEY1 IN NGA.
           MOVE PGM-CT-CNO                TO  NGA-GLS-CPTO IN NGA.
           MOVE PGM-CT-CON                TO  NGA-KEY-EVEN IN NGA.
           MOVE NGA-KEY-CPTO IN CNO-FLD   TO  NGA-KEY-CPTO IN NGA.

           MOVE PGM-CT-9999               TO  NGA-NUM-KEY1 IN NGA.
           MOVE FIO-GET-LEQ               TO  FIO-CMND.

           PERFORM COL-FIO-NGA.

           IF NOT FIO-STAT-OKS
              PERFORM GRABA-NEW-LOG-CLIE
              GO TO FIN-GRABA-LOG.

           IF DBC-CIC-ICLI IN DBC NOT = NGA-CIC-KEY1 IN NGA OR
                       PGM-CT-CNO NOT = NGA-GLS-CPTO IN NGA OR
                       PGM-CT-CON NOT = NGA-KEY-EVEN IN NGA OR
              NGA-KEY-CPTO IN CNO-FLD NOT = NGA-KEY-CPTO IN NGA
              PERFORM GRABA-NEW-LOG-CLIE
           ELSE
              MOVE NGA-NUM-KEY1 IN NGA TO PGM-NUM-KEY1
              PERFORM GRABA-NXT-LOG-CLIE.

       FIN-GRABA-LOG.
           EXIT.


      *-----------------------------------------------------------
      *  LLENA PRIMERA SIMULACION DEL TIPO CAE001 O CAE002
      *-----------------------------------------------------------

       GRABA-NEW-LOG-CLIE SECTION.
       INI-GRABA-NEW-LOG-CLIE.
           PERFORM GET-FHOY.
           MOVE  HOY-SHOY                 TO  PGM-NUM-SHOY.
           MOVE  HOY-AHOY                 TO  PGM-NUM-AHOY.
           MOVE  HOY-MHOY                 TO  PGM-NUM-MHOY.
           MOVE  HOY-DHOY                 TO  PGM-NUM-DHOY.

           PERFORM LIMPIAR-NGA.
           MOVE PGM-CT-CNO                TO  NGA-GLS-CPTO IN NGA.
           MOVE DBC-CIC-ICLI IN DBC       TO  NGA-CIC-KEY1 IN NGA.
           MOVE PGM-CT-CON                TO  NGA-KEY-EVEN IN NGA.
           MOVE NGA-KEY-CPTO IN CNO-FLD   TO  NGA-KEY-CPTO IN NGA.
           MOVE PGM-CT-1                  TO  NGA-NUM-KEY1 IN NGA.
           MOVE PGM-FEC-FHOY              TO  NGA-FEC-FTRN IN NGA.
           MOVE HOY-HHOY IN HOY-VARI      TO  NGA-HRA-HRTR IN NGA.
           MOVE SPACES                    TO  NGA-MSC-STAT IN NGA.
           MOVE PGM-CT-COLPQCNO           TO  NGA-COD-ATRN IN NGA.
           MOVE DBC-CIC-ICLI  IN DBC      TO  NGA-CIC-ICLI IN NGA.
           MOVE OPC-CIC-IOPC  IN OPC      TO  NGA-CIC-IOPV IN NGA.
      * FECHA DE CURSE
           MOVE CUN-VARI-FECH IN CUN-VARI TO  NGA-FEC-AUX2 IN NGA.
      * SALDO A CURSAR
           MOVE CUN-CAP-OPC   IN CUN-VARI TO  NGA-SGV-MON9 IN NGA.
      * FECHA PRIMER VENCIMIENTO DE EVC1
           MOVE CUN-FEC-INIV1 IN CUN-VARI TO  NGA-FEC-AUX1 IN NGA.
      * MONTO DE LA PRIMERA ESTRUCTURA
           MOVE CUN-MNT-CUOT1 IN CUN-VARI TO  NGA-SGV-MON2 IN NGA.
      * FECHA PRIMER VENCIMIENTO DE EVC2
           MOVE CUN-FEC-INIV2 IN CUN-VARI TO  NGA-FEC-AUX3 IN NGA.
      * MONTO DE SEGUNDA ESTRUCTURA
           MOVE CUN-MNT-CUOT2 IN CUN-VARI TO  NGA-SGV-MON1 IN NGA.
      * FECHA PRIMER VENCIMIENTO DE EVC3
           MOVE CUN-FEC-INIV3 IN CUN-VARI TO  NGA-FEC-AUX4 IN NGA.
      * MONTO DE TERCER ESTRUCTUA
           MOVE CUN-MNT-CUOT3 IN CUN-VARI TO  NGA-SGV-MON5 IN NGA.
      *TASA DE INTERES
           MOVE CUN-SGV-TINTA IN CUN-VARI TO  NGA-SGV-MON8 IN NGA.
      * SE GENERA LA GLOSA SUPERIOR
           MOVE CUN-NUM-CUOI1 IN CUN-VARI TO PGM-MSG-EVCI1 IN PGM-VARI.
           MOVE CUN-NUM-CUOF1 IN CUN-VARI TO PGM-MSG-EVCF1 IN PGM-VARI.
           MOVE CUN-NUM-CUOI2 IN CUN-VARI TO PGM-MSG-EVCI2 IN PGM-VARI.
           MOVE CUN-NUM-CUOF2 IN CUN-VARI TO PGM-MSG-EVCF2 IN PGM-VARI.
           MOVE CUN-NUM-CUOI3 IN CUN-VARI TO PGM-MSG-EVCI3 IN PGM-VARI.
           MOVE CUN-NUM-CUOF3 IN CUN-VARI TO PGM-MSG-EVCF3 IN PGM-VARI.
      * SE SETEA LA GLOSA
           MOVE PGM-MSG-CON IN PGM-VARI    TO NGA-GLS-AUX1 IN NGA.
      * SE SETEA EL TIPO DE MONEDA DEL CREDITO.
           IF NGA-CAI-IOPV IN CNO-FLD > SPACES AND
              NGA-IIC-IOPV IN CNO-FLD > SPACES
              MOVE OPC-COD-VCOC IN OPC TO NGA-COD-GLS3 IN NGA.
      * SE SETEA EL TIPO DE PESO
           MOVE PGM-CT-999 TO NGA-COD-GLS1 IN NGA.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-NGA.
           IF NOT FIO-STAT-OKS
              MOVE PGM-CT-COL        TO CUN-COD-TMSG1 IN CUN-VARI
              MOVE PGM-CT-ERROGRBLOG TO CUN-COD-CMSG1 IN CUN-VARI.

       FIN-GRABA-NEW-LOG-CLIE.
           EXIT.

      *-----------------------------------------------------------
      *  LLENA SIGUIENTES SIMULACISN DEL TIPO CAE001 O CAE002
      *-----------------------------------------------------------

       GRABA-NXT-LOG-CLIE SECTION.
       INI-GRABA-NXT-LOG-CLIE.
           PERFORM GET-FHOY.
           MOVE  HOY-SHOY                 TO  PGM-NUM-SHOY.
           MOVE  HOY-AHOY                 TO  PGM-NUM-AHOY.
           MOVE  HOY-MHOY                 TO  PGM-NUM-MHOY.
           MOVE  HOY-DHOY                 TO  PGM-NUM-DHOY.
           PERFORM LIMPIAR-NGA.
           MOVE PGM-CT-CNO                TO  NGA-GLS-CPTO IN NGA.
           MOVE DBC-CIC-ICLI IN DBC       TO  NGA-CIC-KEY1 IN NGA.
           MOVE PGM-CT-CON                TO  NGA-KEY-EVEN IN NGA.
           MOVE NGA-KEY-CPTO IN CNO-FLD   TO  NGA-KEY-CPTO IN NGA.
           MOVE PGM-NUM-KEY1              TO  NGA-NUM-KEY1 IN NGA.
           ADD  PGM-CT-1                  TO  NGA-NUM-KEY1 IN NGA.
           MOVE PGM-FEC-FHOY              TO  NGA-FEC-FTRN IN NGA.
           MOVE HOY-HHOY IN HOY-VARI      TO  NGA-HRA-HRTR IN NGA.
           MOVE SPACES                    TO  NGA-MSC-STAT IN NGA.
           MOVE PGM-CT-COLPQCNO           TO  NGA-COD-ATRN IN NGA.
           MOVE DBC-CIC-ICLI  IN DBC      TO  NGA-CIC-ICLI IN NGA.
           MOVE OPC-CIC-IOPC  IN OPC      TO  NGA-CIC-IOPV IN NGA.
      * FECHA DE CURSE
           MOVE CUN-VARI-FECH IN CUN-VARI TO  NGA-FEC-AUX2 IN NGA.
      * SALDO A CURSAR
           MOVE CUN-CAP-OPC   IN CUN-VARI TO  NGA-SGV-MON9 IN NGA.
      * FECHA PRIMER VENCIMIENTO DE EVC1
           MOVE CUN-FEC-INIV1 IN CUN-VARI TO  NGA-FEC-AUX1 IN NGA.
      * MONTO DE LA PRIMERA ESTRUCTURA
           MOVE CUN-MNT-CUOT1 IN CUN-VARI TO  NGA-SGV-MON2 IN NGA.
      * FECHA PRIMER VENCIMIENTO DE EVC2
           MOVE CUN-FEC-INIV2 IN CUN-VARI TO  NGA-FEC-AUX3 IN NGA.
      * MONTO DE SEGUNDA ESTRUCTURA
           MOVE CUN-MNT-CUOT2 IN CUN-VARI TO  NGA-SGV-MON1 IN NGA.
      * FECHA PRIMER VENCIMIENTO DE EVC3
           MOVE CUN-FEC-INIV3 IN CUN-VARI TO  NGA-FEC-AUX4 IN NGA.
      * MONTO DE TERCER ESTRUCTUA
           MOVE CUN-MNT-CUOT3 IN CUN-VARI TO  NGA-SGV-MON5 IN NGA.
      *TASA DE INTERES
           MOVE CUN-SGV-TINTA IN CUN-VARI TO  NGA-SGV-MON8 IN NGA.
      * SE GENERA LA GLOSA SUPERIOR
           MOVE CUN-NUM-CUOI1 IN CUN-VARI TO PGM-MSG-EVCI1 IN PGM-VARI.
           MOVE CUN-NUM-CUOF1 IN CUN-VARI TO PGM-MSG-EVCF1 IN PGM-VARI.
           MOVE CUN-NUM-CUOI2 IN CUN-VARI TO PGM-MSG-EVCI2 IN PGM-VARI.
           MOVE CUN-NUM-CUOF2 IN CUN-VARI TO PGM-MSG-EVCF2 IN PGM-VARI.
           MOVE CUN-NUM-CUOI3 IN CUN-VARI TO PGM-MSG-EVCI3 IN PGM-VARI.
           MOVE CUN-NUM-CUOF3 IN CUN-VARI TO PGM-MSG-EVCF3 IN PGM-VARI.
      * SE SETEA LA GLOSA
           MOVE SPACES                     TO NGA-GLS-AUX1 IN NGA.
           MOVE PGM-MSG-CON IN PGM-VARI    TO NGA-GLS-AUX1 IN NGA.
      * SE SETEA EL TIPO DE MONEDA DEL CREDITO.

           IF NGA-CAI-IOPV IN CNO-FLD > SPACES AND
              NGA-IIC-IOPV IN CNO-FLD > SPACES
              MOVE OPC-COD-VCOC IN OPC TO NGA-COD-GLS3 IN NGA
           ELSE
              MOVE SPACES TO NGA-COD-GLS3 IN NGA.
      * SE SETEA EL TIPO DE PESO
           MOVE PGM-CT-999 TO NGA-COD-GLS1 IN NGA.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-NGA.
           IF NOT FIO-STAT-OKS
              MOVE PGM-CT-COL        TO CUN-COD-TMSG1 IN CUN-VARI
              MOVE PGM-CT-ERROGRBLOG TO CUN-COD-CMSG1 IN CUN-VARI.
              .

       FIN-GRABA-NXT-LOG-CLIE.
           EXIT.


       LIMPIAR-NGA SECTION.
       INI-LIMPIAR-NGA.
           MOVE SPACES TO NGA-GLS-FLAG IN NGA.
           MOVE SPACES TO NGA-GLS-CPTO IN NGA.
           MOVE SPACES TO NGA-CAI-IEY1 IN NGA.
           MOVE SPACES TO NGA-IIC-IEY1 IN NGA.
           MOVE SPACES TO NGA-KEY-EVEN IN NGA.
           MOVE SPACES TO NGA-KEY-CPTO IN NGA.
           MOVE ZEROES TO NGA-NUM-KEY1 IN NGA.
           MOVE ZEROES TO NGA-STP-ITRN IN NGA.
           MOVE SPACES TO NGA-MSC-TACC IN NGA.
           MOVE SPACES TO NGA-COD-OTRN IN NGA.
           MOVE SPACES TO NGA-MSC-STAT IN NGA.
           MOVE SPACES TO NGA-COD-ATRN IN NGA.
           MOVE SPACES TO NGA-CIC-ICLI IN NGA.
           MOVE SPACES TO NGA-GLS-KEY3 IN NGA.
           MOVE ZEROES TO NGA-FEC-KEY4 IN NGA.
           MOVE SPACES TO NGA-GLS-KEY5 IN NGA.
           MOVE SPACES TO NGA-GLS-KEY6 IN NGA.
           MOVE SPACES TO NGA-CIC-IOPV IN NGA.
           MOVE ZEROES TO NGA-NUM-ICAN IN NGA.
           MOVE SPACES TO NGA-GLS-KEY8 IN NGA.
           MOVE ZEROES TO NGA-SGV-MON1 IN NGA.
           MOVE ZEROES TO NGA-SGV-MON2 IN NGA.
           MOVE ZEROES TO NGA-SGV-MON3 IN NGA.
           MOVE ZEROES TO NGA-SGV-MON4 IN NGA.
           MOVE ZEROES TO NGA-SGV-MON5 IN NGA.
           MOVE ZEROES TO NGA-SGV-MON6 IN NGA.
           MOVE ZEROES TO NGA-SGV-MON7 IN NGA.
           MOVE ZEROES TO NGA-SGV-MON8 IN NGA.
           MOVE ZEROES TO NGA-SGV-MON9 IN NGA.
           MOVE ZEROES TO NGA-FEC-AUX1 IN NGA.
           MOVE ZEROES TO NGA-FEC-AUX2 IN NGA.
           MOVE ZEROES TO NGA-FEC-AUX3 IN NGA.
           MOVE ZEROES TO NGA-FEC-AUX4 IN NGA.
           MOVE ZEROES TO NGA-FEC-AUX5 IN NGA.
           MOVE SPACES TO NGA-COD-GLS1 IN NGA.
           MOVE SPACES TO NGA-COD-GLS2 IN NGA.
           MOVE SPACES TO NGA-COD-GLS3 IN NGA.
           MOVE SPACES TO NGA-COD-GLS4 IN NGA.
           MOVE SPACES TO NGA-COD-GLS5 IN NGA.
           MOVE SPACES TO NGA-IND-AUX1 IN NGA.
           MOVE SPACES TO NGA-IND-AUX2 IN NGA.
           MOVE SPACES TO NGA-IND-AUX3 IN NGA.
           MOVE SPACES TO NGA-IND-AUX4 IN NGA.
           MOVE SPACES TO NGA-IND-AUX5 IN NGA.
           MOVE SPACES TO NGA-GLS-AUX1 IN NGA.
           MOVE SPACES TO NGA-GLS-AUX2 IN NGA.
           MOVE SPACES TO NGA-GLS-AUX3 IN NGA.
           MOVE SPACES TO NGA-GLS-AUX4 IN NGA.
           MOVE SPACES TO NGA-GLS-AUX5 IN NGA.
           MOVE ZEROES TO NGA-NUM-COR1 IN NGA.
           MOVE ZEROES TO NGA-NUM-COR2 IN NGA.
           MOVE ZEROES TO NGA-NUM-COR3 IN NGA.
           MOVE ZEROES TO NGA-NUM-COR4 IN NGA.
           MOVE ZEROES TO NGA-NUM-COR5 IN NGA.
           MOVE ZEROES TO NGA-NUM-IVEN IN NGA.
           MOVE ZEROES TO NGA-NUM-IDLC IN NGA.
           MOVE SPACES TO NGA-IND-EOPC IN NGA.
           MOVE SPACES TO NGA-IND-SCTB IN NGA.
           MOVE SPACES TO NGA-CIC-IOPC IN NGA.
           MOVE ZEROES TO NGA-NUM-IVCT IN NGA.
           MOVE SPACES TO NGA-GLS-DISP IN NGA.
       FIN-LIMPIAR-NGA.
           EXIT.

       COPY GNSBPFEC.
      *>>>> 
*% END
