*%! Codigo adicional para archivo
*%! HDR_CST = FALSE
*% PGM_PTC = TRUE
*%! NO_TIENE_TIMESTAMP = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% IF CMT_ID
      *<<<<
      *************************************************************
      * PROYECTO : CAE, CUADRO DE PAGO Y ORIGEN DE FINANCIAMIENTO
      * OBJETIVO GENERAL: DESPLEGAR EL TOTAL A PAGAR Y DETALLE DE LAS
      *                   CUOTAS A LA FECHA DE CONSULTA
      * ENTIDADES CONSULTADAS : OPC-CAN-ROV-RCV-CYA-ITR-CXE-VEN.
      * FECHA : NOVIEMBRE-2011
      * RESPONSABLE: AFRI-CGC
      *************************************************************
      *MANTENCION:
      *OBJETIVO: ELIMINAR OPERACION CON SALDO CERO
      *FECHA: MARZO 2012
      *RESPONSABLE: AFRI-CGC
      *ETIQUETA: *AFRI-FIN 06-MAR-2012 MEJORAS CAE
      *************************************************************
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01 WSS-DEBUG.
          03 WSS-DEBUG-2   VALUE SPACES  PIC X(40).
          03 SCR-NUM-PANT               PIC 9(0005).
          03 SCR-DCP-FLD                PIC X(1100).
          03  WSS-I           VALUE ZEROES            PIC  9(03).

       COPY COLWXDCP.
       COPY COLBRRDC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY SGCBRDCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY SGCBRDCE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY COLBROPC.
       COPY COLBRDLC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY COLBRCAN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY COLBRICG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY COLBRVEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY COLBRRCV.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY COLBRTOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY COLBRCXE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CXE-REQA==.
       COPY COLBRROV.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY COLBRCYA.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY COLBREVC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY COLBRDIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DIC-REQA==.
       COPY COLBRPCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PCP-REQA==.
       COPY COLBRIXT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IXT-REQA==.
       COPY TABBRCAM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBRTIO.
       COPY COLWGPCP.
       COPY GNSWGPES.
      * COPY GNSWGFRM.
       COPY COLWGVEN.
       COPY COLWICAN.
       COPY COLW2CAN.
       COPY COLW1CAN.
       COPY COLWGCPC.
       COPY COLBRITR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY COLWGINT.
       COPY TABWGTXC.
      *<<<< WSS
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGCPT.
      *>>>>
       01 WSS-NUM-CCUR.
           03 WSS-NUM-ICUR-EDT  PIC  ZZ9.
           03 WSS-NUM-ICUR-ALF       PIC X(03).
           03 WSS-NUM-ICUR      REDEFINES
              WSS-NUM-ICUR-ALF       PIC 9(03).
      ***************************************************************
       01  SCR-KEY-ICAN                     PIC X(03).
       01  SCR-CNAL          VALUE SPACES   PIC X(03).
       01  EIBTRNID          VALUE SPACES   PIC X(04).
      ***************************************************************
      *>>>>
*% END
*% IF FIN_PGM_STAT
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
      *<<<<
      ***************************************************************
              05 PGM-STAT-CYA           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CYA-OKS    VALUE '00'.
                 88 PGM-STAT-CYA-NUL    VALUE '  '.
              05 PGM-STAT-COM           VALUE '23'      PIC X(02).
                 88 PGM-STAT-COM-OKS    VALUE '00'.
                 88 PGM-STAT-COM-NUL    VALUE '  '.
              05 PGM-STAT-AUT           VALUE '23'      PIC X(02).
                 88 PGM-STAT-AUT-OKS    VALUE '00'.
                 88 PGM-STAT-AUT-NUL    VALUE '  '.
              05 PGM-STAT-VEN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-VEN-OKS    VALUE '00'.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
              05 PGM-STAT-RDC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RDC-OKS    VALUE '00'.
                 88 PGM-STAT-RDC-NUL    VALUE '  '.
              05 PGM-STAT-RCV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RCV-OKS    VALUE '00'.
                 88 PGM-STAT-RCV-NUL    VALUE '  '.
              05 PGM-STAT-ITR           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ITR-OKS    VALUE '00'.
                 88 PGM-STAT-ITR-NUL    VALUE '  '.
              05 PGM-STAT-ICG           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ICG-OKS    VALUE '00'.
                 88 PGM-STAT-ICG-NUL    VALUE '  '.
              05 PGM-STAT-CAN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CAN-OKS    VALUE '00'.
                 88 PGM-STAT-CAN-NUL    VALUE '  '.
              05 PGM-STAT-ROV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ROV-OKS    VALUE '00'.
                 88 PGM-STAT-ROV-NUL    VALUE '  '.
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      ****************************************************************
*% END
*% IF INI_FND_KEY 
      *AFRI-INI 06-MAR-2012 MEJORAS CAE
           MOVE DCP-NOM-TSDCP     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE DCP-NOM-TSDCP-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *AFRI-FIN 06-MAR-2012 MEJORAS CAE
*% END
*% IF FND_KEY 
           MOVE OPC-CAI-IOPC IN DCP-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN DCP-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE OPC-STP-ITRN IN OPC TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-OPC.
      *FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
      *
           IF NOT FIO-STAT-OKS
               MOVE 'OPCNOEXISTE' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.


           IF OPC-MSC-STAT IN OPC NOT = 'A'
               MOVE 'OPCNOACTIVA' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.

           PERFORM CARGA-VOCI.
           PERFORM OBT-CIC-MONE.
           MOVE ZEROES TO HOY-SHOY.
           MOVE ZEROES TO HOY-AHOY.
           MOVE ZEROES TO HOY-MHOY.
           MOVE ZEROES TO HOY-DHOY.

           PERFORM VAL-OPC-OCI.
           IF WSS-IND-OKAY IN CPC-VARI NOT = 'S'
               MOVE 'OPCNOTABOCI' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.

           PERFORM VAL-OPC-ORI.
           IF WSS-IND-OKAY IN CPC-VARI NOT = 'S'
               MOVE 'OPCNOOPCORI' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.

      *AFRI-INI 06-MAR-2012 MEJORAS CAE
           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               PERFORM BUS-ULT-CAN-ORIG
               IF WSS-IND-OKAY IN CPC-VARI = 'S'
                   MOVE 'OPCSINSALDO' TO MSG-COD-MENS
                   GO TO MSG-FND-KEY.

           MOVE SPACES TO OPC.
           MOVE OPC-CAI-IOPC IN DCP-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN DCP-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
      *AFRI-FIN 06-MAR-2012 MEJORAS CAE

           PERFORM GET-FHOY.
           MOVE HOY-SHOY       TO WSS-NUM-SPRO IN CPC-VARI.
           MOVE HOY-AHOY       TO WSS-NUM-APRO IN CPC-VARI.
           MOVE HOY-MHOY       TO WSS-NUM-MPRO IN CPC-VARI.
           MOVE HOY-DHOY       TO WSS-NUM-DPRO IN CPC-VARI.

           PERFORM BUS-SIT-DEU.
           IF WSS-IND-SITU IN CPC-VARI = 'NO'
               MOVE 'OPCSINOBLPA' TO MSG-COD-MENS
               GO TO MSG-FND-KEY.

           MOVE SPACES TO DLC.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO DLC.

           MOVE DLC-IND-SCBZ IN DLC TO WSS-IND-SCBZ IN CPC-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO WSS-OPC-ORI IN CPC-VARI.
           MOVE OPC-VAL-CRED IN OPC TO WSS-ENC-SADP(WSS-COR-ENCA).

           MOVE OPC-COD-VCOC IN OPC TO WSS-COD-VCAM IN CPC-VARI.

           IF OPC-IND-RENO IN OPC = 'PRO'
               PERFORM BUS-OPC-INI.

           MOVE SPACES TO ICG.
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE ZEROES TO ICG-NUM-ICAN IN ICG.
           MOVE SPACES TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'  TO ICG-IND-TTAS IN ICG.
           MOVE 'COL'  TO FIO-SIST.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF NOT ( FIO-STAT-OKS AND
              ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
              ICG-IND-TTAS IN ICG = 'INT' )
               MOVE SPACES TO ICG
               MOVE ZEROES TO ICG-SGV-TINT IN ICG.

           MOVE OPC-CIC-IOPC IN OPC TO WSS-DCP-OPCO IN CPC-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO FRM-CAI-IOP2 IN DCP-FLD.
           MOVE OPC-IIC-IOPC IN OPC TO FRM-IIC-IOP2 IN DCP-FLD.
           MOVE WSS-OPC-ORI IN CPC-VARI TO WSS-DCP-OPCA IN CPC-VARI.
           MOVE OPC-COD-COOC IN OPC TO WSS-DCP-TIOP IN CPC-VARI.
           MOVE OPC-COD-COOC IN OPC TO FRM-COD-COOC IN DCP-FLD.
           MOVE OPC-FEC-FCOL IN OPC TO WSS-DCP-FECC IN CPC-VARI.
           MOVE OPC-NUM-DCOL IN OPC TO FRM-NUM-DCOL IN DCP-FLD.
           MOVE OPC-NUM-MCOL IN OPC TO FRM-NUM-MCOL IN DCP-FLD.
           MOVE OPC-NUM-SCOL IN OPC TO FRM-NUM-SCOL IN DCP-FLD.
           MOVE OPC-NUM-ACOL IN OPC TO FRM-NUM-ACOL IN DCP-FLD.
           MOVE ICG-SGV-TINT IN ICG TO WSS-DCP-TAIN IN CPC-VARI.
           MOVE ICG-SGV-TINT IN ICG TO FRM-SGV-INTR IN DCP-FLD.
           MOVE OPC-VAL-CRED IN OPC TO WSS-DCP-MOOR IN CPC-VARI.
           MOVE OPC-VAL-CRED IN OPC TO FRM-VAL-CRED IN DCP-FLD.

      *EXISTE OBLIGACION DE PAGO SE REVISAN CANCELACIONES Y
      *VENCIMIENTOS PARA COMPLETAR ARREGLOS DCP Y DCP

           MOVE SPACES TO VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES TO VEN-NUM-IVEN IN VEN.

           IF OPC-VAL-CRED IN OPC > OPC-VAL-SCRE IN OPC
               MOVE OPC-VAL-CRED IN OPC TO WSS-OPC-MONT IN CPC-VARI
           ELSE
               MOVE OPC-VAL-SCRE IN OPC TO WSS-OPC-MONT IN CPC-VARI.

           MOVE 'NO' TO WSS-IND-ACCE IN CPC-VARI.

           MOVE SPACES TO WSS-PAG-TOTA IN CPC-VARI.
           PERFORM BUS-CAN-OPC.

           MOVE SPACES TO CAN.
           PERFORM GET-FHOY.
           MOVE HOY-SHOY       TO WSS-NUM-SPRO IN CPC-VARI.
           MOVE HOY-AHOY       TO WSS-NUM-APRO IN CPC-VARI.
           MOVE HOY-MHOY       TO WSS-NUM-MPRO IN CPC-VARI.
           MOVE HOY-DHOY       TO WSS-NUM-DPRO IN CPC-VARI.
           MOVE WSS-FEC-PROC IN CPC-VARI TO WSS-FEC-CAMB IN CPC-VARI.
           MOVE OPC-COD-VCOC IN OPC TO WSS-COD-VCAM IN CPC-VARI.
           PERFORM OBT-VAL-CONV.

           IF WSS-TIPO-ANT IN CPC-VARI NOT = 'CIE'
               MOVE FIO-GET-NXT TO FIO-CMND
               PERFORM COL-OBT-VEN
               IF VEN-CIC-IOPC IN VEN = OPC-CIC-IOPC IN OPC AND
                  VEN-NUM-IVEN IN VEN NOT > OPC-NUM-VCOR IN OPC
                   ADD 1 TO WSS-VEN-TOTA IN CPC-VARI
                   SET WSS-COR-VENC TO WSS-VEN-TOTA IN CPC-VARI
                   PERFORM INI-REG-DCP
               ELSE
                   GO TO FIN-VENC.

       LOOP-VEN.
           MOVE WSS-OPC-MONT IN CPC-VARI TO OPC-VAL-SCRE IN OPC.
           MOVE HOY-SHOY       TO CAN-NUM-SCAN IN CAN.
           MOVE HOY-AHOY       TO CAN-NUM-ACAN IN CAN.
           MOVE HOY-MHOY       TO CAN-NUM-MCAN IN CAN.
           MOVE HOY-DHOY       TO CAN-NUM-DCAN IN CAN.
           MOVE VEN-FEC-FVEN IN VEN TO WSS-VEN-FECV(WSS-COR-VENC).
           MOVE CAN-FEC-FCAN IN CAN TO WSS-VEN-FECP(WSS-COR-VENC).


           IF WSS-ENC-ACEL(WSS-COR-ENCA) = 'SI'
               COMPUTE VEN-VAL-SCAP IN VEN = VEN-VAL-CAPI IN VEN -
                            WSS-VEN-CAUF(WSS-COR-VENC)
               COMPUTE VEN-VAL-SFIN IN VEN = VEN-VAL-FINA IN VEN -
                            WSS-VEN-CAUF(WSS-COR-VENC) -
                            WSS-VEN-INUF(WSS-COR-VENC).


           IF WSS-FEC-PROC IN CPC-VARI > VEN-FEC-FIMV IN VEN
               MOVE 'MOR' TO WSS-VEN-SITU(WSS-COR-VENC)
           ELSE
               MOVE 'VIG' TO WSS-VEN-SITU(WSS-COR-VENC)
               MOVE WSS-VEN-TOTA IN CPC-VARI TO
                                            WSS-VEN-CORR(WSS-COR-VENC)
               ADD ZEROES TO WSS-VEN-IMUF(WSS-COR-VENC)
               ADD ZEROES TO WSS-VEN-COUF(WSS-COR-VENC)
               ADD ZEROES TO WSS-VEN-MOPE(WSS-COR-VENC)
               ADD ZEROES TO WSS-VEN-MOUF(WSS-COR-VENC)
               COMPUTE WSS-VEN-INUF(WSS-COR-VENC) ROUNDED =
                                WSS-VEN-INUF(WSS-COR-VENC) +
                   (VEN-VAL-SFIN IN VEN - VEN-VAL-SCAP IN VEN)
               MOVE WSS-VEN-INUF(WSS-COR-VENC) TO
                                            PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                                            WSS-VEN-INPE(WSS-COR-ENCA)
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO
                                            WSS-VEN-INPE(WSS-COR-ENCA)
               ADD VEN-VAL-SCAP IN VEN TO WSS-VEN-CAUF(WSS-COR-VENC)
               COMPUTE WSS-VEN-TCUF(WSS-COR-VENC) ROUNDED =
                                     WSS-VEN-TCUF(WSS-COR-VENC) +
                                     WSS-VEN-CAUF(WSS-COR-VENC) +
                                     WSS-VEN-COUF(WSS-COR-VENC) +
                                     WSS-VEN-IMUF(WSS-COR-VENC) +
                                     WSS-VEN-INUF(WSS-COR-VENC)
               COMPUTE WSS-VEN-SPUF(WSS-COR-VENC) ROUNDED =
                    WSS-OPC-MONT IN CPC-VARI - VEN-VAL-SCAP IN VEN
               COMPUTE WSS-OPC-MONT IN CPC-VARI ROUNDED =
                    WSS-OPC-MONT IN CPC-VARI - VEN-VAL-SCAP IN VEN
               ADD ZEROES TO WSS-VEN-GACO(WSS-COR-VENC)
               COMPUTE WSS-VEN-PACP(WSS-COR-VENC) ROUNDED =
                                    WSS-VEN-PACP(WSS-COR-VENC) +
                                    WSS-VEN-TCUF(WSS-COR-VENC) +
                                    WSS-VEN-MOUF(WSS-COR-VENC) +
                                    (WSS-VEN-GACO(WSS-COR-VENC) /
                                    WSS-VAL-CAMB IN CPC-VARI)
               MOVE ZEROES TO WSS-VEN-INMO(WSS-COR-VENC)

               MOVE SPACES TO WSS-VEN-NOPC(WSS-COR-VENC)
               MOVE SPACES TO WSS-VEN-TCYA(WSS-COR-VENC)
               IF WSS-PAG-TOTA IN CPC-VARI = 'SI'
                   MOVE 'S' TO WSS-VEN-PAGO(WSS-COR-VENC)
                   GO TO NEXT-VEN
               ELSE
                   MOVE 'N' TO WSS-VEN-PAGO(WSS-COR-VENC)
                   GO TO NEXT-VEN.

           PERFORM PRO-TCAN-CTE.
           MOVE WSS-VEN-TOTA IN CPC-VARI TO WSS-VEN-CORR(WSS-COR-VENC).

           IF WSS-PAG-TOTA IN CPC-VARI = 'SI'
               MOVE 'S' TO WSS-VEN-PAGO(WSS-COR-VENC)
           ELSE
               MOVE 'N' TO WSS-VEN-PAGO(WSS-COR-VENC).

           ADD ZEROES TO WSS-VEN-IMUF(WSS-COR-VENC).
           ADD ZEROES TO WSS-VEN-IMPE(WSS-COR-VENC).
           ADD CAN-SGV-COMI IN CAN-FLD TO WSS-VEN-COPE(WSS-COR-VENC).
           COMPUTE CAN-SGV-COMI IN CAN-FLD ROUNDED =
                                             CAN-SGV-COMI IN CAN-FLD /
                                             WSS-VAL-CAMB IN CPC-VARI.
           ADD CAN-SGV-COMI IN CAN-FLD TO WSS-VEN-COUF(WSS-COR-VENC).
           ADD SCR-SGV-INTM TO WSS-VEN-MOPE(WSS-COR-VENC).
           COMPUTE SCR-SGV-INTM ROUNDED =
                                  SCR-SGV-INTM /
                                  WSS-VAL-CAMB IN CPC-VARI.
           ADD SCR-SGV-INTM TO WSS-VEN-MOUF(WSS-COR-VENC).
           ADD SCR-SGV-INTN TO WSS-VEN-INPE(WSS-COR-ENCA).
           COMPUTE WSS-VEN-INUF(WSS-COR-VENC) ROUNDED =
                                WSS-VEN-INUF(WSS-COR-VENC) +
               (VEN-VAL-FINA IN VEN - VEN-VAL-CAPI IN VEN).
           ADD VEN-VAL-SCAP IN CAN-FLD TO WSS-VEN-CAUF(WSS-COR-VENC).
           COMPUTE WSS-VEN-CAPE(WSS-COR-VENC) ROUNDED =
                     WSS-VEN-CAPE(WSS-COR-VENC) +
                  (VEN-VAL-SCAP IN CAN-FLD * WSS-VAL-CAMB IN CPC-VARI).
           COMPUTE WSS-VEN-TCUF(WSS-COR-VENC) ROUNDED =
                           WSS-VEN-TCUF(WSS-COR-VENC) +
                           WSS-VEN-CAUF(WSS-COR-VENC) +
                           WSS-VEN-COUF(WSS-COR-VENC) +
                           WSS-VEN-IMUF(WSS-COR-VENC) +
                           WSS-VEN-INUF(WSS-COR-VENC).
           COMPUTE WSS-VEN-TCPE(WSS-COR-VENC) ROUNDED =
                           WSS-VEN-TCPE(WSS-COR-VENC) +
                           WSS-VEN-CAPE(WSS-COR-VENC) +
                           WSS-VEN-COPE(WSS-COR-VENC) +
                           WSS-VEN-IMPE(WSS-COR-VENC) +
                           WSS-VEN-INPE(WSS-COR-VENC).
           COMPUTE WSS-VEN-SPUF(WSS-COR-VENC) ROUNDED =
               WSS-OPC-MONT IN CPC-VARI - VEN-VAL-SCAP IN CAN-FLD.
           COMPUTE WSS-OPC-MONT IN CPC-VARI ROUNDED =
               WSS-OPC-MONT IN CPC-VARI - VEN-VAL-SCAP IN CAN-FLD.
           ADD CAN-SGV-GAST IN CAN-FLD TO WSS-VEN-GACO(WSS-COR-VENC).
           COMPUTE WSS-VEN-GAUF(WSS-COR-VENC) ROUNDED =
                     WSS-VEN-GACO(WSS-COR-VENC) /
                             WSS-VAL-CAMB IN CPC-VARI.
           COMPUTE WSS-VEN-PACP(WSS-COR-VENC) ROUNDED =
                           WSS-VEN-PACP(WSS-COR-VENC) +
                           WSS-VEN-TCUF(WSS-COR-VENC) +
                           WSS-VEN-MOUF(WSS-COR-VENC) +
                           (WSS-VEN-GACO(WSS-COR-VENC) /
                           WSS-VAL-CAMB IN CPC-VARI).

           ADD WSS-VAL-SVEN IN WSS-VARI TO WSS-VEN-PAPE(WSS-COR-VENC).
           ADD CAN-SGV-TPAG IN CAN-FLD TO WSS-VEN-PAPE(WSS-COR-VENC).

           MOVE WSS-VEN-PAPE(WSS-COR-VENC) TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VEN-PAPE(WSS-COR-VENC).
           MOVE ICG-SGV-TINT IN CAN-FLD TO WSS-VEN-INMO(WSS-COR-VENC).

           MOVE SPACES              TO WSS-VEN-NOPC(WSS-COR-VENC).
           MOVE SPACES              TO WSS-VEN-TCYA(WSS-COR-VENC).

       NEXT-VEN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           IF WSS-ENC-ACEL(WSS-COR-ENCA) = 'SI' OR
              WSS-PAG-TOTA IN CPC-VARI = 'SI'
               MOVE HOY-DHOY TO VEN-DTBS
               MOVE HOY-MHOY TO VEN-MTBS
               MOVE HOY-SHOY TO VEN-STBS
               MOVE HOY-AHOY TO VEN-ATBS
               MOVE 'S'      TO VEN-KEST
               PERFORM COL-OBT-VEN
               MOVE VEN-STAT TO WSS-DEBUG-2
               PERFORM GNS-ERR-QUE
               IF VEN-STAT-OKS AND
                  OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN
                   ADD 1 TO WSS-VEN-TOTA IN CPC-VARI
                   SET WSS-COR-VENC TO WSS-VEN-TOTA IN CPC-VARI
                   PERFORM INI-REG-DCP
                   GO TO LOOP-VEN
               ELSE
                   GO TO FIN-VENC.

           PERFORM COL-OBT-VEN.
           IF VEN-CIC-IOPC IN VEN = OPC-CIC-IOPC IN OPC AND
              VEN-NUM-IVEN IN VEN NOT > OPC-NUM-VCOR IN OPC
               ADD 1 TO WSS-VEN-TOTA IN CPC-VARI
               SET WSS-COR-VENC TO WSS-VEN-TOTA IN CPC-VARI
               PERFORM INI-REG-DCP
               GO TO LOOP-VEN.

       FIN-VENC.
           PERFORM BUS-SUM-CAMP.
           MOVE WSS-SAL-DEPG IN CPC-VARI TO WSS-DCP-SAPO IN CPC-VARI.
           MOVE WSS-SAL-DEPG IN CPC-VARI TO FRM-SGV-SPAG IN DCP-FLD.

           PERFORM CRG-VEC-DCP.

           IF (SCR-OFRM-SRV AND WSS-J > WSS-NITMMAX IN DCP-VARI)
               GO TO EXT-FND-KEY1.

           IF ((NOT SCR-OFRM-SRV) AND WSS-J > WSS-JMAX IN DCP-VARI)
               GO TO EXT-FND-KEY1.
*% END
*% IF FIN_FND_KEY 
       EXT-FND-KEY1.
           PERFORM PUT-TAB.

           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *----------------------------------------------------------
       MSG-FND-KEY.
           MOVE 'TAB' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
               PERFORM CLR-FRM VARYING WSS-I FROM 1 BY 1
                                 UNTIL WSS-I > WSS-IMAX
                MOVE TSK-TERM-ALF TO DCP-COD-TERM
                MOVE TSK-TERM-ALF TO DCP-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO DCP-COD-TERM
                MOVE EIBTRMID     TO DCP-COD-TERM-MAS.
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )
               MOVE SCR-DCP-FLD TO DCP-FLD
               GO TO FIN-INI.

           IF ( FRM-FFLD = FRM-FFLD-PF6 )
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
               ADD 1              TO QUE-NITM
               MOVE DCP-NOM-TSDCP TO QUE-COLA
               MOVE DCP-LEN-TSDCP TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                  MOVE SCR-DCP-FLD TO DCP-FLD
                  GO TO FIN-INI.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-DCP
               PERFORM VAL-NUM-FLD-DCP
               PERFORM SCRL-TAB-DCP
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *>>>>
       CRG-VEC-DCP SECTION.
       INI-CRG-VEC-DCP.

           MOVE ZEROES TO WSS-J IN DCP-VARI.

       LOOP-CARGA.
           ADD 1 TO WSS-J IN DCP-VARI.
           IF WSS-J IN DCP-VARI > WSS-JMAX IN DCP-VARI
               GO TO FIN-CRG-VEC-DCP.

           IF (WSS-J IN DCP-VARI NOT > WSS-VEN-TOTA IN CPC-VARI)
                SET WSS-COR-VENC TO WSS-J IN DCP-VARI
           ELSE
               GO TO FIN-CRG-VEC-DCP.

           PERFORM CLR-DCP-VEC.
           MOVE WSS-VEN-CORR(WSS-COR-VENC) TO WSS-NUM-NCRE-V(WSS-J).
           MOVE WSS-VEN-PAGO(WSS-COR-VENC) TO WSS-IND-PAGO-V(WSS-J).
           MOVE WSS-VEN-FECV(WSS-COR-VENC)(1:2) TO
                                              WSS-NUM-SVEN-V(WSS-J).
           MOVE WSS-VEN-FECV(WSS-COR-VENC)(3:2) TO
                                              WSS-NUM-AVEN-V(WSS-J).
           MOVE WSS-VEN-FECV(WSS-COR-VENC)(5:2) TO
                                              WSS-NUM-MVEN-V(WSS-J).
           MOVE WSS-VEN-FECV(WSS-COR-VENC)(7:2) TO
                                              WSS-NUM-DVEN-V(WSS-J).
           MOVE WSS-VEN-IMUF(WSS-COR-VENC) TO WSS-SGV-IPTO-V(WSS-J).
           MOVE WSS-VEN-COUF(WSS-COR-VENC) TO WSS-SGV-COMI-V(WSS-J).
           MOVE WSS-VEN-INUF(WSS-COR-VENC) TO WSS-SGV-INTE-V(WSS-J).
           MOVE WSS-VEN-CAUF(WSS-COR-VENC) TO WSS-SGV-CAPI-V(WSS-J).
           MOVE WSS-VEN-TCUF(WSS-COR-VENC) TO WSS-SGV-TCUO-V(WSS-J).
           MOVE WSS-VEN-SPUF(WSS-COR-VENC) TO WSS-SGV-SINS-V(WSS-J).
           MOVE WSS-VEN-FECP(WSS-COR-VENC)(1:2) TO
                                        WSS-NUM-SCAN-V(WSS-J).
           MOVE WSS-VEN-FECP(WSS-COR-VENC)(3:2) TO
                                        WSS-NUM-ACAN-V(WSS-J).
           MOVE WSS-VEN-FECP(WSS-COR-VENC)(5:2) TO
                                        WSS-NUM-MCAN-V(WSS-J).
           MOVE WSS-VEN-FECP(WSS-COR-VENC)(7:2) TO
                                        WSS-NUM-DCAN-V(WSS-J).
           MOVE WSS-VEN-INMO(WSS-COR-VENC) TO WSS-SGV-TINT-V(WSS-J).
           MOVE WSS-VEN-TCYA(WSS-COR-VENC) TO WSS-IND-TCYA-V(WSS-J).
           MOVE WSS-VEN-MOUF(WSS-COR-VENC) TO WSS-SGV-MORA-V(WSS-J).
           MOVE ZEROES                     TO WSS-SGV-GCOB-V(WSS-J).
           MOVE WSS-VEN-GAUF(WSS-COR-VENC) TO WSS-SGV-GJUD-V(WSS-J).
           MOVE WSS-VEN-PRPE(WSS-COR-VENC) TO WSS-SGV-PREP-V(WSS-J).
           MOVE WSS-VEN-SITU(WSS-COR-VENC) TO WSS-IND-SITU-V(WSS-J).
           MOVE WSS-VEN-PAPE(WSS-COR-VENC) TO WSS-SGV-PCTA-V(WSS-J).
           MOVE WSS-VEN-NOPC(WSS-COR-VENC)(1:4) TO
                                        WSS-CAI-IOPC-V(WSS-J).
           MOVE WSS-VEN-NOPC(WSS-COR-VENC)(5:8) TO
                                        WSS-IIC-IOPC-ALF-V(WSS-J).

           GO TO LOOP-CARGA.

       FIN-CRG-VEC-DCP.
           EXIT.

       CLR-DCP-VEC SECTION.
       INI-CLR-DCP-VEC.
           MOVE ZEROES TO WSS-NUM-NCRE-V(WSS-J).
           MOVE SPACES TO WSS-IND-PAGO-V(WSS-J).
           MOVE ZEROES TO WSS-FEC-FVEN-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-IPTO-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-COMI-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-INTE-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-CAPI-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-TCUO-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-SINS-V(WSS-J).
           MOVE ZEROES TO WSS-FEC-FCAN-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-TINT-V(WSS-J).
           MOVE SPACES TO WSS-IND-TCYA-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-MORA-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-GCOB-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-GJUD-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-PREP-V(WSS-J).
           MOVE SPACES TO WSS-IND-SITU-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-PCTA-V(WSS-J).
           MOVE SPACES TO WSS-CAI-IOPC-V(WSS-J).
           MOVE ZEROES TO WSS-IIC-IOPC-V(WSS-J).
       FIN-CLR-DCP-VEC.
           EXIT.

       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1              TO QUE-NITM.
           MOVE DCP-NOM-TSDCP TO QUE-COLA.
           MOVE DCP-LEN-TSDCP TO QUE-LITM.
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MOVE 'DCPTABNONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
           MOVE QUE-ITEM TO FRM-NUM-NCRE-IDX(FRM-IFLD).
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO SCR-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1              TO QUE-NITM
               MOVE DCP-NOM-TSDCP TO QUE-COLA
               MOVE DCP-LEN-TSDCP TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'DCPTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.

       CLR-FRM SECTION.
       INI-CLR-FRM.
           MOVE ZEROES TO FRM-NUM-NCRE IN DCP-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-PAGO IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FVEN IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-IPTO IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-COMI IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-INTE IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-CAPI IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TCUO IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-SINS IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FCAN IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TINT IN DCP-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-TCYA IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MORA IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-GCOB IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-GJUD IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-PREP IN DCP-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-SITU IN DCP-FLD(WSS-I).
           MOVE SPACES TO FRM-CAI-IOPC IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-IIC-IOPC IN DCP-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-PCTA IN DCP-FLD(WSS-I).

       FIN-CLR-FRM.
           EXIT.

       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-NUM-PANT = 1
               MOVE 'DCPTABNOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.

           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE DCP-NOM-TSDCP TO QUE-COLA
           MOVE DCP-LEN-TSDCP TO QUE-LITM
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'DCPTABNOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           MOVE QUE-ITEM TO FRM-NUM-NCRE-IDX(FRM-IFLD).
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.

           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.

           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM SCR-NUM-PANT
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'DCPTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.

       SCRL-TAB-DCP SECTION.
       INI-SCRL-TAB-DCP.
           MOVE SPACES TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-DCP.
           EXIT.

       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE DCP-NOM-TSDCP     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE DCP-NOM-TSDCP-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 1 TO SCR-NUM-PANT.
           MOVE SPACES TO DCP-VEC-TS.
           MOVE LOW-VALUES TO WSS-NUM-NCRE-IDX.
      *
           MOVE 1 TO FRM-IFLD.
           MOVE ZEROES  TO WSS-NITM IN DCP-VARI.

           MOVE 1 TO WSS-F IN DCP-VARI.

           MOVE FRM-IND-HMAS IN DCP-FLD TO WSS-IND-HMAS IN DCP-VARI.

       LUP-PUT-TAB.
           IF WSS-F IN DCP-VARI > WSS-FMAX IN DCP-VARI
              GO TO FIN-PUT-TAB.

           IF FRM-NUM-IVEN IN DCP-FLD IS NUMERIC AND
              FRM-NUM-IVEN IN DCP-FLD > 1
               IF FRM-IND-HMAS IN DCP-FLD NOT = '+' AND '-'
                   MOVE '+' TO FRM-IND-HMAS IN DCP-FLD
                   MOVE '+' TO WSS-IND-HMAS IN DCP-VARI
                   PERFORM PUT-VEN-SOL
                   GO TO LUP-PUT-TAB
               ELSE
                   PERFORM PUT-VEN-SOL
                   GO TO LUP-PUT-TAB.

           IF WSS-NUM-NCRE-V(WSS-F) > ZEROES
              PERFORM PUT-TAB-DCP
              PERFORM PUT-DCP-QUE
              PERFORM SET-FRM-IFLD
           ELSE
           IF FRM-IFLD = 1 AND WSS-F = 1
              MOVE 'TAB' TO MSG-COD-SIST
              MOVE 'DCP    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE '00' TO FIO-STAT
      *       MOVE 'S' TO SCR-IERR
              GO TO FIN-PUT-TAB
           ELSE
              MOVE '00' TO FIO-STAT
              GO TO FIN-PUT-TAB.

           ADD 1 TO WSS-F IN DCP-VARI.
           GO TO LUP-PUT-TAB.
       FIN-PUT-TAB.
           MOVE 1                  TO QUE-NITM.
           MOVE DCP-LEN-TSDCP-MAS  TO QUE-LITM.
           MOVE DCP-NOM-TSDCP-MAS  TO QUE-COLA.

           IF WSS-NITM > WSS-NITMMAX
              MOVE 'S'           TO DCP-MAS-IND-HMAS
           ELSE
              MOVE 'N'           TO DCP-MAS-IND-HMAS.

           IF WSS-NITM > WSS-NITMMAX
               MOVE WSS-NITMMAX TO WSS-NUM-ICUR
           ELSE
               MOVE WSS-NITM TO WSS-NUM-ICUR.

      *    MOVE WSS-NITM         TO WSS-NUM-ICUR.
           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.
           MOVE WSS-NUM-ICUR-ALF TO DCP-MAS-NUM-TOCC.
           MOVE DCP-MAS-ITEM     TO QUE-ITEM.
           MOVE QUE-PUT          TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF WSS-NITM > WSS-IMAX
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'DCPTABDMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.

       PUT-TAB-DCP SECTION.
       INI-PUT-TAB-DCP.
           PERFORM CLR-WSS.

           MOVE WSS-NUM-NCRE-ALF-V(WSS-F) TO
                                       WSS-NUM-NCRE-ALF-DCP IN DCP-VARI.
           MOVE WSS-IND-PAGO-V(WSS-F) TO WSS-IND-PAGO-DCP IN DCP-VARI.
           MOVE WSS-FEC-FVEN-V(WSS-F) TO WSS-FEC-FVEN-DCP IN DCP-VARI.
           MOVE WSS-SGV-IPTO-ALF-V(WSS-F) TO
                                       WSS-SGV-IPTO-ALF-DCP IN DCP-VARI.
           MOVE WSS-SGV-COMI-ALF-V(WSS-F) TO
                                       WSS-SGV-COMI-ALF-DCP IN DCP-VARI.
           MOVE WSS-SGV-INTE-ALF-V(WSS-F) TO
                                       WSS-SGV-INTE-ALF-DCP IN DCP-VARI.
           MOVE WSS-SGV-CAPI-ALF-V(WSS-F) TO
                                       WSS-SGV-CAPI-ALF-DCP IN DCP-VARI.
           MOVE WSS-SGV-TCUO-ALF-V(WSS-F) TO
                                       WSS-SGV-TCUO-ALF-DCP IN DCP-VARI.
           MOVE WSS-SGV-SINS-ALF-V(WSS-F) TO
                                       WSS-SGV-SINS-ALF-DCP IN DCP-VARI.
           MOVE WSS-FEC-FCAN-V(WSS-F) TO WSS-FEC-FCAN-DCP IN DCP-VARI.
           MOVE WSS-SGV-TINT-ALF-V(WSS-F) TO
                                       WSS-SGV-TINT-ALF-DCP IN DCP-VARI.
           MOVE WSS-IND-TCYA-V(WSS-F) TO WSS-IND-TCYA-DCP IN DCP-VARI.
           MOVE WSS-SGV-MORA-ALF-V(WSS-F) TO
                                       WSS-SGV-MORA-ALF-DCP IN DCP-VARI.
           MOVE WSS-SGV-GCOB-ALF-V(WSS-F) TO
                                       WSS-SGV-GCOB-ALF-DCP IN DCP-VARI.
           MOVE WSS-SGV-GJUD-ALF-V(WSS-F) TO
                                       WSS-SGV-GJUD-ALF-DCP IN DCP-VARI.
           MOVE WSS-SGV-PREP-ALF-V(WSS-F) TO
                                       WSS-SGV-PREP-ALF-DCP IN DCP-VARI.
           MOVE WSS-IND-SITU-V(WSS-F) TO WSS-IND-SITU-DCP IN DCP-VARI.
           MOVE WSS-SGV-PCTA-ALF-V(WSS-F) TO
                                       WSS-SGV-PCTA-ALF-DCP IN DCP-VARI.
           MOVE WSS-CAI-IOPC-V(WSS-F) TO WSS-CAI-IOPC-DCP IN DCP-VARI.
           MOVE WSS-IIC-IOPC-ALF-V(WSS-F) TO
                                       WSS-IIC-IOPC-ALF-DCP IN DCP-VARI.

           MOVE WSS-NUM-NCRE-ALF-DCP IN DCP-VARI TO
                WSS-NUM-NCRE-ALF-FRM.
           MOVE WSS-IND-PAGO-DCP IN DCP-VARI TO WSS-IND-PAGO-FRM.
           MOVE WSS-FEC-FVEN-DCP IN DCP-VARI TO WSS-FEC-FVEN-FRM.
           MOVE WSS-SGV-IPTO-ALF-DCP IN DCP-VARI TO
                WSS-SGV-IPTO-ALF-FRM.
           MOVE WSS-SGV-COMI-ALF-DCP IN DCP-VARI TO
                WSS-SGV-COMI-ALF-FRM.
           MOVE WSS-SGV-INTE-ALF-DCP IN DCP-VARI TO
                WSS-SGV-INTE-ALF-FRM.
           MOVE WSS-SGV-CAPI-ALF-DCP IN DCP-VARI TO
                WSS-SGV-CAPI-ALF-FRM.
           MOVE WSS-SGV-TCUO-ALF-DCP IN DCP-VARI TO
                WSS-SGV-TCUO-ALF-FRM.
           MOVE WSS-SGV-SINS-ALF-DCP IN DCP-VARI TO
                WSS-SGV-SINS-ALF-FRM.
           MOVE WSS-FEC-FCAN-DCP IN DCP-VARI TO WSS-FEC-FCAN-FRM.
           MOVE WSS-SGV-TINT-ALF-DCP IN DCP-VARI TO
                WSS-SGV-TINT-ALF-FRM.
           MOVE WSS-IND-TCYA-DCP IN DCP-VARI TO WSS-IND-TCYA-FRM.
           MOVE WSS-SGV-MORA-ALF-DCP IN DCP-VARI TO
                WSS-SGV-MORA-ALF-FRM.
           MOVE WSS-SGV-GCOB-ALF-DCP IN DCP-VARI TO
                WSS-SGV-GCOB-ALF-FRM.
           MOVE WSS-SGV-GJUD-ALF-DCP IN DCP-VARI TO
                WSS-SGV-GJUD-ALF-FRM.
           MOVE WSS-SGV-PREP-ALF-DCP IN DCP-VARI TO
                WSS-SGV-PREP-ALF-FRM.
           MOVE WSS-IND-SITU-DCP IN DCP-VARI TO WSS-IND-SITU-FRM.
           MOVE WSS-SGV-PCTA-ALF-DCP IN DCP-VARI TO
                WSS-SGV-PCTA-ALF-FRM.
           MOVE WSS-CAI-IOPC-DCP IN DCP-VARI TO WSS-CAI-IOPC-FRM.
           MOVE WSS-IIC-IOPC-ALF-DCP IN DCP-VARI TO
                WSS-IIC-IOPC-ALF-FRM.

           IF FRM-IFLD > WSS-IMAX
              GO TO FIN-PUT-TAB-DCP.

           MOVE WSS-NUM-NCRE-ALF-V(WSS-F) TO
                                  FRM-NUM-NCRE-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-IND-PAGO-V(WSS-F) TO
                                  FRM-IND-PAGO IN DCP-FLD(FRM-IFLD).
           MOVE WSS-FEC-FVEN-V(WSS-F) TO
                                  FRM-FEC-FVEN IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-IPTO-ALF-V(WSS-F) TO
                                  FRM-SGV-IPTO-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-COMI-ALF-V(WSS-F) TO
                                  FRM-SGV-COMI-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-INTE-ALF-V(WSS-F) TO
                                  FRM-SGV-INTE-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-CAPI-ALF-V(WSS-F) TO
                                  FRM-SGV-CAPI-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-TCUO-ALF-V(WSS-F) TO
                                  FRM-SGV-TCUO-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-SINS-ALF-V(WSS-F) TO
                                  FRM-SGV-SINS-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-FEC-FCAN-V(WSS-F) TO
                                  FRM-FEC-FCAN IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-TINT-ALF-V(WSS-F) TO
                                  FRM-SGV-TINT-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-IND-TCYA-V(WSS-F) TO
                                  FRM-IND-TCYA IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-MORA-ALF-V(WSS-F) TO
                                  FRM-SGV-MORA-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-GCOB-ALF-V(WSS-F) TO
                                  FRM-SGV-GCOB-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-GJUD-ALF-V(WSS-F) TO
                                  FRM-SGV-GJUD-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-PREP-ALF-V(WSS-F) TO
                                  FRM-SGV-PREP-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-IND-SITU-V(WSS-F) TO
                                  FRM-IND-SITU IN DCP-FLD(FRM-IFLD).
           MOVE WSS-SGV-PCTA-ALF-V(WSS-F) TO
                                  FRM-SGV-PCTA-ALF IN DCP-FLD(FRM-IFLD).
           MOVE WSS-CAI-IOPC-V(WSS-F) TO
                                  FRM-CAI-IOPC IN DCP-FLD(FRM-IFLD).
           MOVE WSS-IIC-IOPC-ALF-V(WSS-F) TO
                                  FRM-IIC-IOPC-ALF IN DCP-FLD(FRM-IFLD).

       FIN-PUT-TAB-DCP.
           EXIT.

       CLR-WSS SECTION.
       INI-CLR-WSS.

           MOVE ZEROES TO WSS-NUM-NCRE-ALF-DCP IN DCP-VARI.
           MOVE SPACES TO WSS-IND-PAGO-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-FEC-FVEN-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-IPTO-ALF-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-COMI-ALF-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-INTE-ALF-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-CAPI-ALF-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-TCUO-ALF-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-SINS-ALF-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-FEC-FCAN-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-TINT-ALF-DCP IN DCP-VARI.
           MOVE SPACES TO WSS-IND-TCYA-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-MORA-ALF-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-GCOB-ALF-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-GJUD-ALF-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-PREP-ALF-DCP IN DCP-VARI.
           MOVE SPACES TO WSS-IND-SITU-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-SGV-PCTA-ALF-DCP IN DCP-VARI.
           MOVE SPACES TO WSS-CAI-IOPC-DCP IN DCP-VARI.
           MOVE ZEROES TO WSS-IIC-IOPC-ALF-DCP IN DCP-VARI.

           IF SCR-OFRM-SRV
               PERFORM CLR-FRM-MTX.

       FIN-CLR-WSS.
           EXIT.

       CLR-FRM-MTX SECTION.
       INI-CLR-FRM-MTX.

           MOVE ZEROES TO FRM-NUM-NCRE-ALF IN DCP-FLD(1).
           MOVE SPACES TO FRM-IND-PAGO IN DCP-FLD(1).
           MOVE ZEROES TO FRM-FEC-FVEN IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-IPTO-ALF IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-COMI-ALF IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-INTE-ALF IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-CAPI-ALF IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-TCUO-ALF IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-SINS-ALF IN DCP-FLD(1).
           MOVE ZEROES TO FRM-FEC-FCAN IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-TINT-ALF IN DCP-FLD(1).
           MOVE SPACES TO FRM-IND-TCYA IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-MORA-ALF IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-GCOB-ALF IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-GJUD-ALF IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-PREP-ALF IN DCP-FLD(1).
           MOVE SPACES TO FRM-IND-SITU IN DCP-FLD(1).
           MOVE ZEROES TO FRM-SGV-PCTA-ALF IN DCP-FLD(1).
           MOVE SPACES TO FRM-CAI-IOPC IN DCP-FLD(1).
           MOVE ZEROES TO FRM-IIC-IOPC-ALF IN DCP-FLD(1).

       FIN-CLR-FRM-MTX.
           EXIT.

       PUT-DCP-QUE SECTION.
       INI-PUT-DCP-QUE.
           PERFORM PRO-FLD-QUE.
           ADD 1 TO WSS-NITM.
           MOVE DCP-NOM-TSDCP    TO QUE-COLA.
           MOVE DCP-LEN-TSDCP    TO QUE-LITM.
           MOVE WSS-NITM         TO QUE-NITM.
           MOVE SPACES           TO QUE-ITEM.
           IF SCR-OFRM-SRV
           IF NOT (WSS-NITM > WSS-NITMMAX)
               MOVE WSS-SGV-IPTO-V(WSS-F) TO
                                    FRM-SGV-IPTO-EDT IN DCP-EDT
               MOVE FRM-SGV-IPTO-EDT IN DCP-EDT TO
                                    WSS-SGV-IPTO-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-COMI-V(WSS-F) TO
                                    FRM-SGV-COMI-EDT IN DCP-EDT
               MOVE FRM-SGV-COMI-EDT IN DCP-EDT TO
                                    WSS-SGV-COMI-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-INTE-V(WSS-F) TO
                                    FRM-SGV-INTE-EDT IN DCP-EDT
               MOVE FRM-SGV-INTE-EDT IN DCP-EDT TO
                                    WSS-SGV-INTE-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-CAPI-V(WSS-F) TO
                                    FRM-SGV-CAPI-EDT IN DCP-EDT
               MOVE FRM-SGV-CAPI-EDT IN DCP-EDT TO
                                    WSS-SGV-CAPI-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-TCUO-V(WSS-F) TO
                                    FRM-SGV-TCUO-EDT IN DCP-EDT
               MOVE FRM-SGV-TCUO-EDT IN DCP-EDT TO
                                    WSS-SGV-TCUO-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-SINS-V(WSS-F) TO
                                    FRM-SGV-SINS-EDT IN DCP-EDT
               MOVE FRM-SGV-SINS-EDT IN DCP-EDT TO
                                    WSS-SGV-SINS-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-MORA-V(WSS-F) TO
                                    FRM-SGV-MORA-EDT IN DCP-EDT
               MOVE FRM-SGV-MORA-EDT IN DCP-EDT TO
                                    WSS-SGV-MORA-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-GCOB-V(WSS-F) TO
                                    FRM-SGV-GCOB-EDT IN DCP-EDT
               MOVE FRM-SGV-GCOB-EDT IN DCP-EDT TO
                                    WSS-SGV-GCOB-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-GJUD-V(WSS-F) TO
                                    FRM-SGV-GJUD-EDT IN DCP-EDT
               MOVE FRM-SGV-GJUD-EDT IN DCP-EDT TO
                                    WSS-SGV-GJUD-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-PREP-V(WSS-F) TO
                                    FRM-SGV-PREP-EDT IN DCP-EDT
               MOVE FRM-SGV-PREP-EDT IN DCP-EDT TO
                                    WSS-SGV-PREP-ALF-DCP IN DCP-VARI
               MOVE WSS-SGV-PCTA-V(WSS-F) TO
                                    FRM-SGV-PCTA-EDT IN DCP-EDT
               MOVE FRM-SGV-PCTA-EDT IN DCP-EDT TO
                                    WSS-SGV-PCTA-ALF-DCP IN DCP-VARI
              MOVE DCP-VEC-TS    TO QUE-ITEM
           ELSE
               GO TO FIN-PUT-DCP-QUE
           ELSE
              MOVE WSS-NUM-NCRE-IDX TO QUE-ITEM.
           MOVE QUE-PUT  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PUT-DCP-QUE.
           EXIT.

       SET-FRM-IFLD SECTION.
       INI-SET-FRM-IFLD.
           IF SCR-OFRM-SRV
                MOVE 1 TO FRM-IFLD
           ELSE
                ADD 1 TO FRM-IFLD.
       FIN-SET-FRM-IFLD.
           EXIT.

       PRO-FLD-QUE SECTION.
       INI-PRO-FLD-QUE.
           MOVE 'P' TO WSS-NUM-NCRE-ATR-DCP.
           MOVE 'P' TO WSS-IND-PAGO-ATR-DCP.
           MOVE 'P' TO WSS-FEC-FVEN-ATR-DCP.
           MOVE 'P' TO WSS-SGV-IPTO-ATR-DCP.
           MOVE 'P' TO WSS-SGV-COMI-ATR-DCP.
           MOVE 'P' TO WSS-SGV-INTE-ATR-DCP.
           MOVE 'P' TO WSS-SGV-CAPI-ATR-DCP.
           MOVE 'P' TO WSS-SGV-TCUO-ATR-DCP.
           MOVE 'P' TO WSS-SGV-SINS-ATR-DCP.
           MOVE 'P' TO WSS-FEC-FCAN-ATR-DCP.
           MOVE 'P' TO WSS-SGV-TINT-ATR-DCP.
           MOVE 'P' TO WSS-IND-TCYA-ATR-DCP.
           MOVE 'P' TO WSS-SGV-MORA-ATR-DCP.
           MOVE 'P' TO WSS-SGV-GCOB-ATR-DCP.
           MOVE 'P' TO WSS-SGV-GJUD-ATR-DCP.
           MOVE 'P' TO WSS-SGV-PREP-ATR-DCP.
           MOVE 'P' TO WSS-IND-SITU-ATR-DCP.
           MOVE 'P' TO WSS-CAI-IOPC-ATR-DCP.
           MOVE 'P' TO WSS-IIC-IOPC-ATR-DCP.
           MOVE 'P' TO WSS-SGV-PCTA-ATR-DCP.

       FIN-PRO-FLD-QUE.
           EXIT.

       PUT-VEN-SOL SECTION.
       INI-PUT-VEN-SOL.

           IF (WSS-F IN DCP-VARI >= FRM-NUM-IVEN IN DCP-FLD)
               IF WSS-IND-HMAS IN DCP-VARI = '+' AND
                  WSS-NUM-NCRE-V(WSS-F) > ZEROES
                   PERFORM PUT-TAB-DCP
                   PERFORM PUT-DCP-QUE
                   PERFORM SET-FRM-IFLD
               ELSE
                   IF WSS-IND-HMAS IN DCP-VARI = '-' AND
                      FRM-NUM-IVEN IN DCP-FLD > 1
                       SUBTRACT 1 FROM WSS-F IN DCP-VARI
                       MOVE '+' TO WSS-IND-HMAS IN DCP-VARI
                       IF WSS-NUM-NCRE-V(WSS-F) > ZEROES
                           PERFORM PUT-TAB-DCP
                           PERFORM PUT-DCP-QUE
                           PERFORM SET-FRM-IFLD.

           ADD 1 TO WSS-F IN DCP-VARI.

       FIN-PUT-VEN-SOL.
           EXIT.
      *>>>>
       COPY SGCBFDBC.
       COPY GNSBGCPT.
       COPY COLBFRDC.
       COPY COLBFDLC.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBBMSG.
       COPY SGCBFDCP.
       COPY SGCBFDCE.
       COPY GNSBPFEC.
       COPY COLBFPCP.
       COPY GNSBGPES.
       COPY GNSBFMSC.
       COPY COLBFICG.
       COPY COLBFROV.
       COPY COLBFRCV.
       COPY COLBFCAN.
       COPY COLBFITR.
       COPY COLBFTOC.
       COPY COLBFEVC.
       COPY COLBFVEN.
       COPY COLBFCYA.
       COPY COLBFDIC.
       COPY COLBFCXE.
       COPY COLBFIXT.
       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY COLBGVEN.
       COPY COLBGINT.
       COPY COLB6CAN.
       COPY TABBKTXC.
       COPY GNSBGCAM.
       COPY COLBGPCP.
       COPY GNSBBTAB.
       COPY COLBGCPC.

      *AFRI-INI 06-MAR-2012 MEJORAS CAE
       BUS-ULT-CAN-ORIG SECTION.
       INI-BUS-ULT-CAN-ORIG.
           MOVE 'S' TO WSS-IND-OKAY IN CPC-VARI.
           MOVE SPACES TO CAN.
           MOVE OPC-CIC-IOPC IN OPC TO CAN-CIC-IOPC IN CAN.
           MOVE 999 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT FIO-STAT-OKS OR
              OPC-CIC-IOPC IN OPC NOT = CAN-CIC-IOPC IN CAN
      *ES UN PROBLEMA SALDO CERO SIN CANCELACIONES OPERACION FUERA
               GO TO FIN-BUS-ULT-CAN-ORIG.

           IF CAN-MSC-STAT IN CAN NOT = 'A'
      *PROBLEMA OPERACION SALDO CERO Y ULTIMA CANCELACION NO ACTIVADA
      *OPERACION FUERA
               GO TO FIN-BUS-ULT-CAN-ORIG.

           IF (CAN-SGV-TPAG IN CAN < ZEROES OR
               CAN-SGV-DIFE IN CAN < ZEROES OR
               CAN-SGV-TREN IN CAN < ZEROES)
      *PROBLEMA OPERACION SALDO CERO Y ULTIMA CAN UNA REVERSA
      * OPERACION FUERA
               GO TO FIN-BUS-ULT-CAN-ORIG.

           IF CAN-MSC-CANC IN CAN NOT = 'RTT' AND 'RTE'
               GO TO FIN-BUS-ULT-CAN-ORIG.

           PERFORM VEO-CYA.
           IF WSS-IND-TRAS IN CPC-VARI NOT = 'S'
               GO TO FIN-BUS-ULT-CAN-ORIG.

           PERFORM BUSCA-ROV.
      *ES UN PROBLEMA LA OPERACION SE DEJA FUERA
           IF ROV-CIC-IOPC IN ROV = SPACES
               GO TO FIN-BUS-ULT-CAN-ORIG.

           MOVE ROV-CIC-IOPC IN ROV TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
      *OPERACION PRODUCTO DE CANCELACION NO INGRESADA
               MOVE 'N' TO WSS-IND-OKAY IN CPC-VARI
               GO TO FIN-BUS-ULT-CAN-ORIG.

           IF OPC-MSC-STAT IN OPC NOT = 'A'
               MOVE 'N' TO WSS-IND-OKAY IN CPC-VARI
               GO TO FIN-BUS-ULT-CAN-ORIG.

           IF OPC-VAL-SCRE IN OPC > ZEROES
               MOVE 'N' TO WSS-IND-OKAY IN CPC-VARI
               GO TO FIN-BUS-ULT-CAN-ORIG.

           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO INI-BUS-ULT-CAN-ORIG.


       FIN-BUS-ULT-CAN-ORIG.
           EXIT.
      *AFRI-FIN 06-MAR-2012 MEJORAS CAE
      *>>>>
*% END
