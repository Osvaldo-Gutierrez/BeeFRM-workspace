*%! Codigo adicional para archivo
*% IF IOS
      *<<<< IOS
           SELECT RPTRVM       ASSIGN TO UT-S-RPTRVM.
      *>>>>
*% END
*% IF FLS
      *<<<< FLS
       FD  RPTRVM LABEL RECORDS OMITTED
           REPORT IS RPT-RVM.
       01  PASO.
           03 FILLER                              PIC X(01).
      *>>>>
*% END
*% IF RR
      *<<<< RR
      *>>>>
*% END
*% IF RW
      *<<<< RW
       COPY COLRWRVM.
       COPY COLRWRV2.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY TABBROFI.
       COPY TABBRTIO.
       COPY TABBRUSR.
       COPY TABBRCAM.
       COPY TABWGTVC.
       COPY COLBRRDC.
       COPY COLBRICG.
       COPY COLBRCYA.
       COPY COLBRTOC.
       COPY COLBRAUX.
       COPY COLBRDLC.
       COPY COLBROPC.
       COPY SGCBRDBC.
       COPY GNSBRMSC.
       COPY GNSWGPES.
       COPY SGCBRDCE.
       COPY SGCBRDCP.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWGCPT.
       COPY COLWGAUX.
       COPY COLWGCTO.
      *
       01  WSS-VARI.
           03 WSS-COD-PESO      VALUE SPACES       PIC X(06).
           03 WSS-COD-UF        VALUE SPACES       PIC X(06).
           03 WSS-COD-DOLA      VALUE SPACES       PIC X(06).
           03 WSS-SGV-DOLA      VALUE ZEROES       PIC 9(11)V9(04).
           03 WSS-FEC-FPRO.
              05  WSS-NUM-DPRO                     PIC 9(02).
              05  WSS-NUM-MPRO                     PIC 9(02).
              05  WSS-NUM-SPRO                     PIC 9(02).
              05  WSS-NUM-APRO                     PIC 9(02).
           03 WSS-FEC-FTRA.
              05  WSS-NUM-STRA                     PIC 9(02).
              05  WSS-NUM-ATRA                     PIC 9(02).
              05  WSS-NUM-MTRA                     PIC 9(02).
              05  WSS-NUM-DTRA                     PIC 9(02).
           03 WSS-PERSONA                          PIC X(01).
           03 WSS-BANCA.
              05  WSS-IND-TIPO                     PIC X(01).
                  88 BANCA-PERSONAS   VALUE 'P' 'N' ' '.
              05  WSS-IND-BANCA                    PIC X(02).
           03 WSS-TAB-MORA.
              05  WSS-TRAMO-1     VALUE ' 01 A 15 ' PIC X(09).
              05  WSS-TRAMO-2     VALUE ' 16 A 30 ' PIC X(09).
              05  WSS-TRAMO-3     VALUE ' 31 A 60 ' PIC X(09).
              05  WSS-TRAMO-4     VALUE ' 61 A 90 ' PIC X(09).
              05  WSS-TRAMO-5     VALUE 'MAS DE 90' PIC X(09).
           03 WSS-TAB-TRAMOS REDEFINES WSS-TAB-MORA.
              05  WSS-TRAMOS OCCURS 5 TIMES.
                   07 TRAMO                          PIC X(09).
      *DPM ini  11-OCT-1995
            03 VEC-GLS-TBAN.
              05  VEC-COD-TBAN       OCCURS 20      PIC X(03).
           03 WSS-CNTD               VALUE ZEROES   PIC 9(02).
           03 WSS-CMAX               VALUE 20       PIC 9(02).
      *DPM fin  11-OCT-1995
           03 I-TRAMO                               PIC 9(02).
           03 ANT-COD-REGI           VALUE SPACES   PIC X(03).
           03 ANT-COD-VCOC           VALUE SPACES   PIC X(06).
           03 ANT-COD-RMOC           VALUE SPACES   PIC X(12).
           03 ANT-COD-COOC           VALUE SPACES   PIC X(06).
           03 ANT-IND-MORA           VALUE ZEROES   PIC 9(01).
      *RVM-CST-INI 26-JUN-1996
           03 WSS-SW-CF-MORA         VALUE 'N'      PIC X(01).
           03 WSS-SW-CF-RMOC         VALUE 'N'      PIC X(01).
           03 WSS-SW-CF-OFOC         VALUE 'N'      PIC X(01).
           03 WSS-SW-CF-REG          VALUE 'N'      PIC X(01).
      *RVM-CST-FIN 26-JUN-1996
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TIO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% IF RT
      *<<<< RT
       COPY COLRFRVM.
           .
       COPY COLRTRVM.
       COPY COLRTRV2.
      *>>>>
*% END
*% IF CH_VMR_SRT_IND_MORA
      *<<<< CH_VMR_SRT_IND_MORA
           MOVE SRT-IND-MORA IN SRT TO I-TRAMO IN WSS-VARI.
           MOVE TRAMO ( I-TRAMO )   TO WSS-GLS-MORA IN WSS-VMR.
      *>>>>
*% END
*% IF CF_VMR_SRT_IND_MORA
      *<<<< CF_VMR_SRT_IND_MORA
           MOVE 'S' TO WSS-SW-CF-MORA IN WSS-VARI.
      *>>>>
*% END
*% IF CF_VMR_OPC_COD_RMOC
      *<<<< CF_VMR_OPC_COD_RMOC
           MOVE 'S' TO WSS-SW-CF-RMOC IN WSS-VARI.
      *>>>>
*% END
*% IF CF_VMR_OPC_COD_OFOC
      *<<<< CF_VMR_OPC_COD_OFOC
           MOVE 'S' TO WSS-SW-CF-OFOC IN WSS-VARI.
      *>>>>
*% END
*% IF CF_VMR_SRT_COD_REGI
      *<<<< CF_VMR_SRT_COD_REGI
           MOVE 'S' TO WSS-SW-CF-REG IN WSS-VARI.
      *>>>>
*% END
*% IF PH_VMR
      *<<<< PH_VMR
      *>>>>
*% END
*% IF FIN_DEC
      *<<<< FIN_DEC
      *DECLARATIVAS DE REPORTES RVM Y RV2, PARA PRODUCIR CORTES
       DEC-CF-RVM-SRT-COD-REGI SECTION.
           USE BEFORE REPORTING CF-RVM-SRT-COD-REGI.
       INI-CF-RVM-SRT-COD-REGI.
       FIN-CF-RVM-SRT-COD-REGI.
           EXIT.
       DEC-CF-RVM-OPC-COD-OFOC SECTION.
           USE BEFORE REPORTING CF-RVM-OPC-COD-OFOC.
       INI-CF-RVM-OPC-COD-OFOC.
           MOVE OPC-COD-OFOC IN SRT TO WSS-COD-OFOC IN WSS-RVM.
           MOVE OPC-COD-OFOC IN SRT TO OFI-COD-OFIC IN OFI.
           MOVE FIO-GET-KEY         TO FIO-CMND.
      *RVM-CST-INI 29-JUL-1996
      *     DISPLAY 'REGIONAL OPC-COD-OFOC: ' OPC-COD-OFOC IN OPC.
      *RVM-CST-FIN 29-JUL-1996
           PERFORM TAB-FIO-OFI.
           IF NOT FIO-STAT-OKS
              MOVE SPACES TO WSS-GLS-OFOC IN WSS-RVM
           ELSE
              MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFOC IN WSS-RVM.
       FIN-CF-RVM-OPC-COD-OFOC.
           EXIT.
       DEC-PH-RVM SECTION.
           USE BEFORE REPORTING PH-RVM.
       INI-PH-RVM.
       FIN-PH-RVM.
           EXIT.
       DEC-FF-RV2 SECTION.
           USE BEFORE REPORTING FF-RV2.
       INI-FF-RV2.
           MOVE SPACES TO WSS-GLS-TITU IN WSS-RVM
                          SRT-COD-REGI IN SRT
                          WSS-GLS-REGN IN WSS-RVM
                          OPC-COD-OFOC IN SRT.
           MOVE 99 TO LINE-COUNTER IN RPT-RVM.
       FIN-FF-RV2.
           EXIT.
      *>>>>
*% END
*% IF INI
      *<<<< INI
       LEE-PARAM.
      *---------*
           ACCEPT WSS-FEC-FPRO IN WSS-VARI.
           DISPLAY WSS-FEC-FPRO IN WSS-VARI.
      *DPM ini  11-OCT-1995
           ACCEPT VEC-GLS-TBAN IN WSS-VARI.
           DISPLAY VEC-GLS-TBAN IN WSS-VARI.
      *DPM fin  11-OCT-1995

      *    VAL-FEC Validar Fecha Proceso
           MOVE WSS-FEC-FPRO IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-N   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'ERROR AL VALIDAR FECHA PROCESO'
               PERFORM GNS-PRO-ABT.

           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DTRA IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MTRA IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-STRA IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-ATRA IN WSS-VARI.

      *DPM ini  11-OCT-1995
      * VAL-COD Validar Codigo Tipo Banca
           MOVE 1  TO WSS-CNTD IN WSS-VARI.

       LUP-VAL-TBAN.
           IF VEC-COD-TBAN(WSS-CNTD) NOT = '*' AND
             WSS-CNTD IN WSS-VARI NOT > WSS-CMAX IN WSS-VARI AND
             VEC-COD-TBAN(WSS-CNTD) NOT = '999'
               MOVE 'SGC' TO FIO-SIST
               MOVE 'BAN' TO TAB-COD-TTAB IN TAB
               MOVE VEC-COD-TBAN(WSS-CNTD) TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS
                   ADD 1 TO WSS-CNTD IN WSS-VARI
                   GO TO LUP-VAL-TBAN
               ELSE
                   DISPLAY 'CODIGO TIPO BANCA NO ENCONTRADO '
                            VEC-COD-TBAN(WSS-CNTD)
                   GO TO FIN-INP-SRT.
      *DPM fin  11-OCT-1995

      * Proceso para obtener Codigo de Cliente Persona.
           MOVE 'SGC'                TO FIO-SIST.
           MOVE 'MSC'                TO MSC-CIC-TTAB IN MSC.
           MOVE 'TICL'               TO MSC-CIC-TMSC IN MSC.
           MOVE 'P'                  TO MSC-CIC-CMSC IN MSC.
           MOVE 'MSC-CIC-TABL'       TO FIO-AKEY.
           MOVE FIO-GET-KEY          TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
              MOVE 'SGC'        TO MSG-COD-SIST
              MOVE 'CODTICLNEX' TO MSG-COD-MENS IN MSG
              PERFORM GET-MSG
              DISPLAY MSG-GLS-DESC   MSC-COD-CMSC
              PERFORM GNS-PRO-ABT.
           MOVE  MSC-COD-CMSC IN MSC TO WSS-PERSONA IN WSS-VARI.

      * Proceso para Cargar la tabla  COL/AUX  en Memoria
           PERFORM COL-CRG-CAU.
           IF CAU-CMSG IN CAU-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CAU-CMSG IN CAU-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CAU-MEN2 IN CAU-VARI
               PERFORM GNS-PRO-ABT.

      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
               PERFORM GNS-PRO-ABT.

      *RVM-CST-INI 25-JUL-1996
           MOVE 'REGIONAL :' TO WSS-GLS-TITU IN WSS-RVM.
      *RVM-CST-FIN 25-JUL-1996

           PERFORM OBT-COD-MNAC.
           PERFORM OBT-COD-UF.
           PERFORM OBT-COD-DOLA.
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           GO TO FST-INP-SRT2.
      *>>>>
*% END
*% IF FIN_FST_INP
      *<<<< FIN_FST_INP
       FST-INP-SRT2.
           MOVE 'MOR'          TO VEN-IND-SCTB IN VEN.
           MOVE 'VEN-IND-SCTB' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS OR VEN-IND-SCTB IN VEN NOT = 'MOR'
               DISPLAY 'NO HAY VEN CON SITUACION CONTABLE MOR'
               GO TO FIN-INP-SRT.
      *RVM-CST-INI 29-JUL-1996
      *     DISPLAY VEN-KEY-IVEN ' VCTO CON SCTB MOR'.
      *RVM-CST-FIN 29-JUL-1996
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
      * Mueve valor del VEN en moneda origen.
           MOVE VEN-VAL-SFIN IN VEN TO SRT-VAL-VTRA IN SRT.

      * Filtra vctos. cancelados total con marca MOR
           IF VEN-VAL-SFIN IN VEN = ZEROES
               GO TO NXT-INP-SRT.

      * Lectura de la OPC.
           MOVE VEN-CIC-IOPC IN VEN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'NO HAY OPC PARA VEN ' VEN-KEY-IVEN
               GO TO NXT-INP-SRT.
 
      * Filtra vctos. de OPC no activadas
           IF OPC-MSC-STAT IN OPC NOT = 'A'
               GO TO NXT-INP-SRT.

      * Lectura de la DLC.
           IF VEN-NUM-IDLC IN VEN NOT = 0
               MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC
           ELSE
               MOVE VEN-NUM-IVCT IN VEN TO DLC-NUM-IDLC IN DLC.
           MOVE OPC-CIC-IOPC IN OPC     TO DLC-CIC-IOPC IN DLC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    DLCNX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   DLC-KEY-IDLC
               GO TO NXT-INP-SRT.

      * Filtra marcados MOR con situacion Vencida o Castigo
           IF DLC-IND-SCTB IN DLC = 'VCD' OR 'CAS'
               GO TO NXT-INP-SRT.

      * Busca Nombre del Deudor en DBC y Tipo de Banca

      * Lectura de la RDC.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
              MOVE 'ERROR NO EXISTE DEUDOR' TO DBC-GLS-NOMC IN DBC
              MOVE SPACES TO WSS-BANCA IN WSS-VARI
           ELSE
              MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
              MOVE FIO-GET-KEY         TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF NOT FIO-STAT-OKS
                MOVE 'ERROR NO EXISTE DEUDOR' TO DBC-GLS-NOMC IN DBC
                MOVE SPACES TO WSS-BANCA IN WSS-VARI
      *JPA OJO1 MOVE OPC-COD-OFOC IN OPC TO OFI-COD-OFIC IN OFI
              ELSE
                MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN IN CPT-VARI
                PERFORM CPT-BLKS
                MOVE CPT-STRN IN CPT-VARI TO DBC-GLS-NOMC IN DBC
      *JPA OJO1 MOVE DBC-COD-OFIC IN OPC TO OFI-COD-OFIC IN OFI
                PERFORM OBT-TIP-BANCA.
      *DPM ini  11-OCT-1995
                PERFORM VAL-COD-TBAN.
                IF NOT FIO-STAT-OKS
                    GO TO NXT-INP-SRT.
      *DPM fin  11-OCT-1995
           MOVE WSS-BANCA IN WSS-VARI TO WSS-COD-TBAN IN WSS-VMR.
      * JPA fin 4-MAY-1995 cambio acceso a DBC desde OUT-SRT

      * Busca Codigo Regional en OFI
      *JPA OJO1 Debe buscar por oficina del cliente o por la del cdto?
      *         Por ahora usa la del credito
      *         Si se usa la del cliente activar lineas OJO1 y
      *         eliminar la linea siguiente.
           MOVE OPC-COD-OFOC IN OPC TO OFI-COD-OFIC IN OFI.
           MOVE FIO-GET-KEY         TO FIO-CMND.
      *RVM-CST-INI 29-JUL-1996
      *     DISPLAY 'REGIONAL OPC-COD-OFOC: ' OPC-COD-OFOC IN OPC.
      *RVM-CST-FIN 29-JUL-1996
           PERFORM TAB-FIO-OFI.
           IF NOT FIO-STAT-OKS
              MOVE SPACES TO SRT-COD-REGI IN SRT
           ELSE
              IF BANCA-PERSONAS
                 IF OFI-COD-REGP IN OFI = SPACES
                    MOVE OFI-COD-REGE IN OFI TO SRT-COD-REGI IN SRT
                 ELSE
                    MOVE OFI-COD-REGP IN OFI TO SRT-COD-REGI IN SRT
              ELSE
                 IF OFI-COD-REGE IN OFI = SPACES
                    MOVE OFI-COD-REGP IN OFI TO SRT-COD-REGI IN SRT
                 ELSE
                    MOVE OFI-COD-REGE IN OFI TO SRT-COD-REGI IN SRT.

      * Lectura de la CYA para obtener cuenta corriente.
           MOVE OPC-CAI-IOPC IN OPC TO CYA-CAI-IOPC IN CYA.
           MOVE OPC-IIC-IOPC IN OPC TO CYA-IIC-IOPC IN CYA.
           MOVE 'AUT'               TO CYA-NUM-ICAN IN CYA.
           MOVE 1                   TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO CYA-IIC-ICYA IN CYA.

      * Lectura de la ICG para obtener tasa de interes del credito.

           MOVE SPACES TO MSG-COD-MENS.
      * Busca con el Codigo Tipo Operacion en la Tabla cargada en Memori
      * 'Opera Como'
           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
                       'CON CODIGO : ' CTO-TOOC IN CTO-VARI
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               GO TO SIG-CON-TRAMO.
      * Obtiene 'Opera Como'
           MOVE SPACES               TO TOC.
           MOVE CTO-OPEC IN CTO-VARI TO TOC-MSC-OPEC IN TOC.
           IF TOC-MSC-OPEC IN TOC = 'D'
               PERFORM BUS-DLC-ICG
           ELSE
               MOVE ZEROES TO ICG-NUM-ICAN IN ICG
               PERFORM BUS-OPC-ICG.

           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-SPRD IN ICG TO ICG-SGV-TINT IN ICG.

           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO ICG-SGV-TINT IN ICG
               MOVE 'OPC    NOINT' TO MSG-COD-MENS.

       SIG-CON-TRAMO.
      * Obtiene tramo dependiendo del numero de dias de mora
           MOVE VEN-NUM-DVEN IN VEN      TO FEC-DEC1.
           MOVE VEN-NUM-MVEN IN VEN      TO FEC-MEC1.
           MOVE VEN-NUM-SVEN IN VEN      TO FEC-SEC1.
           MOVE VEN-NUM-AVEN IN VEN      TO FEC-AEC1.
           MOVE WSS-NUM-DTRA IN WSS-VARI TO FEC-DEC2.
           MOVE WSS-NUM-MTRA IN WSS-VARI TO FEC-MEC2.
           MOVE WSS-NUM-STRA IN WSS-VARI TO FEC-SEC2.
           MOVE WSS-NUM-ATRA IN WSS-VARI TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF FEC-STAT-OKS
              IF FEC-NDIA NOT > 15
                 MOVE 1 TO SRT-IND-MORA IN SRT
              ELSE
              IF FEC-NDIA NOT > 30
                 MOVE 2 TO SRT-IND-MORA IN SRT
              ELSE
              IF FEC-NDIA NOT > 60
                 MOVE 3 TO SRT-IND-MORA IN SRT
              ELSE
              IF FEC-NDIA NOT > 90
                 MOVE 4 TO SRT-IND-MORA IN SRT
              ELSE
                 MOVE 5 TO SRT-IND-MORA IN SRT
           ELSE
      *RVM-CST-INI 27-JUN-1996
      *        MOVE 1 TO SRT-IND-MORA IN SRT.
               GO TO NXT-INP-SRT.
      *RVM-CST-FIN 27-JUN-1996
      *>>>>
*% END
*% IF RM
      *<<<< RM
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           MOVE 'MOR'          TO VEN-IND-SCTB IN VEN.
           MOVE 'VEN-IND-SCTB' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF NOT FIO-STAT-OKS OR VEN-IND-SCTB IN VEN NOT = 'MOR'
               GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF INI_OUT
      *<<<< INI_OUT
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN WSS-VMR.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN WSS-VMR.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN WSS-VMR.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN WSS-VMR.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPRO IN WSS-RVM.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPRO IN WSS-RVM.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APRO IN WSS-RVM.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPRO IN WSS-RVM.
           MOVE SPACES                   TO ANT-COD-REGI IN WSS-VARI.
           MOVE SPACES                   TO ANT-COD-VCOC IN WSS-VARI.
           MOVE SPACES                   TO ANT-COD-RMOC IN WSS-VARI.
           MOVE SPACES                   TO ANT-COD-COOC IN WSS-VARI.
           MOVE ZEROES                   TO ANT-IND-MORA IN WSS-VARI.

           OPEN OUTPUT RPTRVM.
           INITIATE RPT-RVM.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
      *****************************************************
      * Busca Glosas para el reporte
      * Mediante BUS-TAB Busca Tipo de Moneda de Tabla VLR
           IF OPC-COD-VCOC IN SRT NOT = ANT-COD-VCOC IN WSS-VARI
              MOVE OPC-COD-VCOC IN SRT TO ANT-COD-VCOC IN WSS-VARI
              IF OPC-COD-VCOC IN SRT > SPACES
                 MOVE 'TAB'               TO TAB-COD-SIST
                 MOVE 'VLR'               TO TAB-COD-TTAB IN TAB
                 MOVE OPC-COD-VCOC IN SRT TO TAB-COD-CTAB IN TAB
                 PERFORM BUS-TAB
                 IF NOT FIO-STAT-OKS
                    MOVE 'ERROR' TO WSS-GLS-VCOC IN WSS-VMR
                 ELSE
                    MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-VCOC IN WSS-VMR
              ELSE
                 MOVE SPACES TO WSS-GLS-VCOC IN WSS-VMR.

      * Busca Nombre Regional en Tabla REG
           IF SRT-COD-REGI IN SRT NOT = ANT-COD-REGI IN WSS-VARI
              MOVE SRT-COD-REGI IN SRT TO ANT-COD-REGI IN WSS-VARI
              MOVE 'TAB'               TO TAB-COD-SIST
              MOVE 'RGN'               TO TAB-COD-TTAB IN TAB
              MOVE SRT-COD-REGI IN SRT TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF MSG-COD-MENS NOT = SPACES
                 MOVE MSG-GLS-DESC TO WSS-GLS-REGN IN WSS-VMR
              ELSE
                 IF TAB-IND-VIGE = 'N'
                    MOVE 'COD    VIG' TO MSG-COD-MENS
                    MOVE 'GNS'  TO MSG-COD-SIST
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO WSS-GLS-REGN IN WSS-VMR
                 ELSE
                    MOVE TAB-GLS-DESC TO WSS-GLS-REGN IN WSS-VMR.

      *RVM-CST-INI 24-JUL-1996
           MOVE WSS-GLS-REGN IN WSS-VMR TO WSS-GLS-REGN IN WSS-RVM.
      *RVM-CST-FIN 24-JUL-1996

      * Mediante BUS-USR Busca Usuario de Tabla USR
           IF OPC-COD-RMOC IN SRT NOT = ANT-COD-RMOC IN WSS-VARI
              MOVE OPC-COD-RMOC IN SRT TO ANT-COD-RMOC IN WSS-VARI
              IF OPC-COD-RMOC IN SRT > SPACES
                 MOVE OPC-COD-RMOC IN SRT TO USR-COD-USER IN USR
                 PERFORM BUS-USR
                 MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-VMR
              ELSE
                 MOVE SPACES TO WSS-GLS-RMOC IN WSS-VMR.

      * Busca con el Codigo Clase Operacion en la Tabla cargada en Memor
      * el Nombre de la Clase.
           IF OPC-COD-COOC IN SRT NOT = ANT-COD-COOC IN WSS-VARI
              MOVE OPC-COD-COOC IN SRT TO ANT-COD-COOC IN WSS-VARI
              MOVE OPC-COD-COOC IN SRT TO CAU-COOC IN CAU-VARI
              PERFORM COL-BUS-CAU
              IF CAU-CMSG IN CAU-VARI > SPACES
                 MOVE 'COL'                TO MSG-COD-SIST
                 MOVE CAU-CMSG IN CAU-VARI TO MSG-COD-MENS IN MSG
                 PERFORM GET-MSG
                 DISPLAY MSG-GLS-DESC IN MSG CAU-MEN2 IN CAU-VARI
                       'OPERACION SIN COD-COOC : ' OPC-CAI-IOPC IN SRT
                                                   OPC-IIC-IOPC IN SRT
                 MOVE SPACES  TO WSS-GLS-COOC IN WSS-VMR.
              MOVE CAU-DESC IN CAU-VARI TO WSS-GLS-COOC IN WSS-VMR.

      *RVM-CST-INI 26-JUN-1996
      * Obtiene glosa para el tramo de morosidad.
      *        IF SRT-IND-MORA IN SRT NOT = ANT-IND-MORA IN WSS-VARI
      *           MOVE SRT-IND-MORA IN SRT TO ANT-IND-MORA IN WSS-VARI
      *           MOVE SRT-IND-MORA IN SRT TO I-TRAMO IN WSS-VARI
      *           MOVE TRAMO ( I-TRAMO )   TO WSS-GLS-MORA IN WSS-VMR.
      *RVM-CST-FIN 26-JUN-1996

      *****************************************************
      *>>>>
*% END
*% IF FIN_GEN_OUT
      *<<<< FIN_GEN_OUT
      *RVM-CST-INI 25-JUL-1996
      *     IF WSS-SW-CF-OFOC IN WSS-VARI = 'S' OR
      *        WSS-SW-CF-OFOC IN WSS-VARI = 'S' OR
      *        WSS-SW-CF-OFOC IN WSS-VARI = 'S' OR
      *        WSS-SW-CF-REG  IN WSS-VARI = 'S'
      *HAGO GENERATE POR CADA GENERATE DL-VMR, PARA QUE EL RESUMEN
      *NO DEJE LINEAS EN BLANCO, MODIFIQUE COLRTRVM A MANO
               GENERATE DL-RVM.
      *RVM-CST-FIN 25-JUL-1996

           IF WSS-SW-CF-MORA IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-SW-CF-MORA IN WSS-VARI
               PERFORM LIM-TOT-TRM-VMR.
               
           IF WSS-SW-CF-RMOC IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-SW-CF-RMOC IN WSS-VARI
               PERFORM LIM-TOT-TRM-VMR
               PERFORM LIM-TOT-EJE-VMR.

           IF WSS-SW-CF-OFOC IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-SW-CF-OFOC IN WSS-VARI
               PERFORM LIM-TOT-TRM-VMR
               PERFORM LIM-TOT-EJE-VMR
               PERFORM LIM-TOT-OFI-RVM.

           IF WSS-SW-CF-REG IN WSS-VARI = 'S'
               MOVE 'N' TO WSS-SW-CF-REG IN WSS-VARI
               PERFORM LIM-TOT-TRM-VMR
               PERFORM LIM-TOT-EJE-VMR
               PERFORM LIM-TOT-OFI-RVM
               PERFORM LIM-TOT-REG-RVM.

      *RVM-CST-INI 20-JUN-1996
               PERFORM ACU-TOT-VMR.
               IF PGM-STAT-SRT-MAL
                   GO TO FIN-OUT-SRT.
      *RVM-CST-FIN 20-JUN-1996

      *>>>>
*% END
*% IF FIN_OUT
      *<<<< FIN_OUT
      *>>>>
*% END
*% IF FIN_TMT
      *<<<< FIN_TMT
           TERMINATE RPT-RVM.
           CLOSE RPTRVM.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      ******************************************************************
      *RVM-CST-INI 20-JUN-1996
       ACU-TOT-VMR SECTION.
       INI-ACU-TOT-VMR.

      *ACUMULACION DE TRAMOS TOTALES
           IF OPC-COD-VCOC IN SRT = '0999'
      *PESOS
               IF SRT-IND-MORA IN SRT = '1'
                   ADD 1                   TO 
                       WSS-TM1-OFI-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM1-OFI-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM1-REG-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM1-REG-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM1-BAN-NUM-OPCP IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM1-BAN-VAL-OPCP IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '2'
                   ADD 1                   TO 
                       WSS-TM2-OFI-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM2-OFI-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM2-REG-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM2-REG-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM2-BAN-NUM-OPCP IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM2-BAN-VAL-OPCP IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '3'
                   ADD 1                   TO 
                       WSS-TM3-OFI-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM3-OFI-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM3-REG-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM3-REG-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM3-BAN-NUM-OPCP IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM3-BAN-VAL-OPCP IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '4'
                   ADD 1                   TO 
                       WSS-TM4-OFI-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM4-OFI-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM4-REG-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM4-REG-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM4-BAN-NUM-OPCP IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM4-BAN-VAL-OPCP IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '5'
                   ADD 1                   TO 
                       WSS-TM5-OFI-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM5-OFI-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM5-REG-NUM-OPCP IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM5-REG-VAL-OPCP IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM5-BAN-NUM-OPCP IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM5-BAN-VAL-OPCP IN WSS-RV2
               ELSE
                   NEXT SENTENCE
           ELSE
           IF OPC-COD-VCOC IN SRT = '0998'
      *UF
               IF SRT-IND-MORA IN SRT = '1'
                   ADD 1                   TO 
                       WSS-TM1-OFI-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM1-OFI-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM1-REG-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM1-REG-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM1-BAN-NUM-OPCUF IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM1-BAN-VAL-OPCUF IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '2'
                   ADD 1                   TO 
                       WSS-TM2-OFI-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM2-OFI-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM2-REG-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM2-REG-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM2-BAN-NUM-OPCUF IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM2-BAN-VAL-OPCUF IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '3'
                   ADD 1                   TO 
                       WSS-TM3-OFI-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM3-OFI-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM3-REG-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM3-REG-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM3-BAN-NUM-OPCUF IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM3-BAN-VAL-OPCUF IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '4'
                   ADD 1                   TO 
                       WSS-TM4-OFI-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM4-OFI-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM4-REG-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM4-REG-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM4-BAN-NUM-OPCUF IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM4-BAN-VAL-OPCUF IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '5'
                   ADD 1                   TO 
                       WSS-TM5-OFI-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM5-OFI-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM5-REG-NUM-OPCUF IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM5-REG-VAL-OPCUF IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM5-BAN-NUM-OPCUF IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM5-BAN-VAL-OPCUF IN WSS-RV2
               ELSE
                   NEXT SENTENCE
           ELSE
      *MONEDA EXTRANJERA
      *     IF OPC-COD-VCOC IN SRT = 'MONEDA-EXTRANJERA'
               MOVE '00' TO FIO-STAT
               PERFORM CNV-ME-A-DOLA
               IF NOT FIO-STAT-OKS
                   MOVE PGM-SMAL TO PGM-STAT-SRT
                   GO TO FIN-ACU-TOT-VMR
               ELSE
               MOVE WSS-SGV-DOLA IN WSS-VARI TO SRT-VAL-VTRA IN SRT
               IF SRT-IND-MORA IN SRT = '1'
                   ADD 1                   TO 
                       WSS-TM1-OFI-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM1-OFI-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM1-REG-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM1-REG-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM1-BAN-NUM-OPCME IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM1-BAN-VAL-OPCME IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '2'
                   ADD 1                   TO 
                       WSS-TM2-OFI-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM2-OFI-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM2-REG-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM2-REG-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM2-BAN-NUM-OPCME IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM2-BAN-VAL-OPCME IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '3'
                   ADD 1                   TO 
                       WSS-TM3-OFI-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM3-OFI-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM3-REG-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM3-REG-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM3-BAN-NUM-OPCME IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM3-BAN-VAL-OPCME IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '4'
                   ADD 1                   TO 
                       WSS-TM4-OFI-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM4-OFI-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM4-REG-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM4-REG-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM4-BAN-NUM-OPCME IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM4-BAN-VAL-OPCME IN WSS-RV2
               ELSE
               IF SRT-IND-MORA IN SRT = '5'
                   ADD 1                   TO 
                       WSS-TM5-OFI-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM5-OFI-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM5-REG-NUM-OPCME IN WSS-RVM
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM5-REG-VAL-OPCME IN WSS-RVM
                   ADD 1                   TO 
                       WSS-TM5-BAN-NUM-OPCME IN WSS-RV2
                   ADD SRT-VAL-VTRA IN SRT TO
                       WSS-TM5-BAN-VAL-OPCME IN WSS-RV2.


      *ACUMULACION DE TOTALES GENERALES Y TOTALES DE TRAMO
           IF OPC-COD-VCOC IN SRT = '0999'
      *PESOS
               ADD 1                   TO
                   WSS-TRM-NUM-OPCP IN WSS-VMR
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TRM-VAL-OPCP IN WSS-VMR
               ADD 1                   TO
                   WSS-TOT-EJE-NUM-OPCP IN WSS-VMR
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-EJE-VAL-OPCP IN WSS-VMR
               ADD 1                   TO
                   WSS-TOT-OFI-NUM-OPCP IN WSS-RVM
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-OFI-VAL-OPCP IN WSS-RVM
               ADD 1                   TO
                   WSS-TOT-REG-NUM-OPCP IN WSS-RVM
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-REG-VAL-OPCP IN WSS-RVM
               ADD 1                   TO
                   WSS-TOT-BAN-NUM-OPCP IN WSS-RV2
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-BAN-VAL-OPCP IN WSS-RV2
           ELSE
           IF OPC-COD-VCOC IN SRT = '0998'
      *UF
               ADD 1                   TO
                   WSS-TRM-NUM-OPCUF IN WSS-VMR
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TRM-VAL-OPCUF IN WSS-VMR
               ADD 1                   TO
                   WSS-TOT-EJE-NUM-OPCUF IN WSS-VMR
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-EJE-VAL-OPCUF IN WSS-VMR
               ADD 1                   TO
                   WSS-TOT-OFI-NUM-OPCUF IN WSS-RVM
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-OFI-VAL-OPCUF IN WSS-RVM
               ADD 1                   TO
                   WSS-TOT-REG-NUM-OPCUF IN WSS-RVM
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-REG-VAL-OPCUF IN WSS-RVM
               ADD 1                   TO
                   WSS-TOT-BAN-NUM-OPCUF IN WSS-RV2
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-BAN-VAL-OPCUF IN WSS-RV2
           ELSE
      *MONEDA EXTRANJERA
               ADD 1                   TO
                   WSS-TRM-NUM-OPCME IN WSS-VMR
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TRM-VAL-OPCME IN WSS-VMR
               ADD 1                   TO
                   WSS-TOT-EJE-NUM-OPCME IN WSS-VMR
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-EJE-VAL-OPCME IN WSS-VMR
               ADD 1                   TO
                   WSS-TOT-OFI-NUM-OPCME IN WSS-RVM
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-OFI-VAL-OPCME IN WSS-RVM
               ADD 1                   TO
                   WSS-TOT-REG-NUM-OPCME IN WSS-RVM
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-REG-VAL-OPCME IN WSS-RVM
               ADD 1                   TO
                   WSS-TOT-BAN-NUM-OPCME IN WSS-RV2
               ADD SRT-VAL-VTRA IN SRT TO
                   WSS-TOT-BAN-VAL-OPCME IN WSS-RV2.


      *SUMA NUMERO DE OPERACIONES EN PESOS, MAS LAS EN UF PARA TOTAL
      *OPERACIONES
               ADD WSS-TRM-NUM-OPCP  IN WSS-VMR
                   WSS-TRM-NUM-OPCUF IN WSS-VMR TO
                   WSS-TRM-NUM-OPCME IN WSS-VMR GIVING
                   WSS-TRM-NUM-OPER  IN WSS-VMR.

               ADD WSS-TOT-EJE-NUM-OPCP  IN WSS-VMR
                   WSS-TOT-EJE-NUM-OPCUF IN WSS-VMR TO
                   WSS-TOT-EJE-NUM-OPCME IN WSS-VMR GIVING
                   WSS-TOT-EJE-NUM-OPER  IN WSS-VMR.

               ADD WSS-TM1-OFI-NUM-OPCP  IN WSS-RVM
                   WSS-TM1-OFI-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM1-OFI-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM1-OFI-NUM-OPER  IN WSS-RVM.
               ADD WSS-TM2-OFI-NUM-OPCP  IN WSS-RVM
                   WSS-TM2-OFI-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM2-OFI-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM2-OFI-NUM-OPER  IN WSS-RVM.
               ADD WSS-TM3-OFI-NUM-OPCP  IN WSS-RVM
                   WSS-TM3-OFI-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM3-OFI-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM3-OFI-NUM-OPER  IN WSS-RVM.
               ADD WSS-TM4-OFI-NUM-OPCP  IN WSS-RVM
                   WSS-TM4-OFI-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM4-OFI-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM4-OFI-NUM-OPER  IN WSS-RVM.
               ADD WSS-TM5-OFI-NUM-OPCP  IN WSS-RVM
                   WSS-TM5-OFI-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM5-OFI-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM5-OFI-NUM-OPER  IN WSS-RVM.
               ADD WSS-TOT-OFI-NUM-OPCP  IN WSS-RVM
                   WSS-TOT-OFI-NUM-OPCUF IN WSS-RVM TO
                   WSS-TOT-OFI-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TOT-OFI-NUM-OPER  IN WSS-RVM.

               ADD WSS-TM1-REG-NUM-OPCP  IN WSS-RVM
                   WSS-TM1-REG-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM1-REG-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM1-REG-NUM-OPER  IN WSS-RVM.
               ADD WSS-TM2-REG-NUM-OPCP  IN WSS-RVM
                   WSS-TM2-REG-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM2-REG-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM2-REG-NUM-OPER  IN WSS-RVM.
               ADD WSS-TM3-REG-NUM-OPCP  IN WSS-RVM
                   WSS-TM3-REG-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM3-REG-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM3-REG-NUM-OPER  IN WSS-RVM.
               ADD WSS-TM4-REG-NUM-OPCP  IN WSS-RVM
                   WSS-TM4-REG-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM4-REG-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM4-REG-NUM-OPER  IN WSS-RVM.
               ADD WSS-TM5-REG-NUM-OPCP  IN WSS-RVM
                   WSS-TM5-REG-NUM-OPCUF IN WSS-RVM TO
                   WSS-TM5-REG-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TM5-REG-NUM-OPER  IN WSS-RVM.
               ADD WSS-TOT-REG-NUM-OPCP  IN WSS-RVM
                   WSS-TOT-REG-NUM-OPCUF IN WSS-RVM TO
                   WSS-TOT-REG-NUM-OPCME IN WSS-RVM GIVING
                   WSS-TOT-REG-NUM-OPER  IN WSS-RVM.

               ADD WSS-TM1-BAN-NUM-OPCP  IN WSS-RV2
                   WSS-TM1-BAN-NUM-OPCUF IN WSS-RV2 TO
                   WSS-TM1-BAN-NUM-OPCME IN WSS-RV2 GIVING
                   WSS-TM1-BAN-NUM-OPER  IN WSS-RV2.
               ADD WSS-TM2-BAN-NUM-OPCP  IN WSS-RV2
                   WSS-TM2-BAN-NUM-OPCUF IN WSS-RV2 TO
                   WSS-TM2-BAN-NUM-OPCME IN WSS-RV2 GIVING
                   WSS-TM2-BAN-NUM-OPER  IN WSS-RV2.
               ADD WSS-TM3-BAN-NUM-OPCP  IN WSS-RV2
                   WSS-TM3-BAN-NUM-OPCUF IN WSS-RV2 TO
                   WSS-TM3-BAN-NUM-OPCME IN WSS-RV2 GIVING
                   WSS-TM3-BAN-NUM-OPER  IN WSS-RV2.
               ADD WSS-TM4-BAN-NUM-OPCP  IN WSS-RV2
                   WSS-TM4-BAN-NUM-OPCUF IN WSS-RV2 TO
                   WSS-TM4-BAN-NUM-OPCME IN WSS-RV2 GIVING
                   WSS-TM4-BAN-NUM-OPER  IN WSS-RV2.
               ADD WSS-TM5-BAN-NUM-OPCP  IN WSS-RV2
                   WSS-TM5-BAN-NUM-OPCUF IN WSS-RV2 TO
                   WSS-TM5-BAN-NUM-OPCME IN WSS-RV2 GIVING
                   WSS-TM5-BAN-NUM-OPER  IN WSS-RV2.
               ADD WSS-TOT-BAN-NUM-OPCP  IN WSS-RV2
                   WSS-TOT-BAN-NUM-OPCUF IN WSS-RV2 TO
                   WSS-TOT-BAN-NUM-OPCME IN WSS-RV2 GIVING
                   WSS-TOT-BAN-NUM-OPER  IN WSS-RV2.

       FIN-ACU-TOT-VMR.
           EXIT.

       CNV-ME-A-DOLA SECTION.
       INI-CNV-ME-A-DOLA.
      *CONVIERTE DE MONEDA EXTRANJERA A DOLAR

           IF OPC-COD-VCOC IN SRT = WSS-COD-DOLA IN WSS-VARI
               MOVE SRT-VAL-VTRA IN SRT TO WSS-SGV-DOLA IN WSS-VARI
               GO TO FIN-CNV-ME-A-DOLA.

      *PRIMERO CONVIERTE DE MONEDA EXTRANJERA A PESO
           MOVE SRT-VAL-VTRA IN SRT      TO TVC-VALO IN TVC-VARI.
           MOVE OPC-COD-VCOC IN SRT      TO TVC-MON1 IN TVC-VARI.
           MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON2 IN TVC-VARI.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO TVC-DCAM IN TVC-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO TVC-MCAM IN TVC-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO TVC-SCAM IN TVC-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO TVC-ACAM IN TVC-VARI.
           MOVE 4                        TO PES-NUM-DECI IN PES-VARI.
           PERFORM TAB-PRO-TVC.
           IF TVC-CMSG IN TVC-VARI > SPACES
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                   TVC-MON1 IN TVC-VARI ' A : '
                   TVC-MON2 IN TVC-VARI ' AL : '
                   TVC-FCAM IN TVC-VARI
                   MOVE ZEROES TO WSS-SGV-DOLA IN WSS-VARI
                   MOVE '23' TO FIO-STAT
                   GO TO FIN-CNV-ME-A-DOLA
           ELSE
               MOVE TVC-VALO IN TVC-VARI TO 
                    WSS-SGV-DOLA IN WSS-VARI.

      *LUEGO CONVIERTE DE PESOS A DOLAR
           MOVE WSS-SGV-DOLA IN WSS-VARI TO TVC-VALO IN TVC-VARI.
           MOVE WSS-COD-PESO IN WSS-VARI TO TVC-MON1 IN TVC-VARI.
           MOVE WSS-COD-DOLA IN WSS-VARI TO TVC-MON2 IN TVC-VARI.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO TVC-DCAM IN TVC-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO TVC-MCAM IN TVC-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO TVC-SCAM IN TVC-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO TVC-ACAM IN TVC-VARI.
           MOVE 4                        TO PES-NUM-DECI IN PES-VARI.
           PERFORM TAB-PRO-TVC.
           IF TVC-CMSG IN TVC-VARI > SPACES
               DISPLAY 'ERROR: NO EXISTE VALOR DE CAMBIO DE : '
                   TVC-MON1 IN TVC-VARI ' A : '
                   TVC-MON2 IN TVC-VARI ' AL : '
                   TVC-FCAM IN TVC-VARI
                   MOVE ZEROES TO WSS-SGV-DOLA IN WSS-VARI
                   MOVE '23' TO FIO-STAT
                   GO TO FIN-CNV-ME-A-DOLA
           ELSE
               MOVE TVC-VALO IN TVC-VARI TO 
                    WSS-SGV-DOLA IN WSS-VARI.

       FIN-CNV-ME-A-DOLA.
           EXIT.

       LIM-TOT-TRM-VMR SECTION.
       INI-LIM-TOT-TRM-VMR.
           MOVE ZEROES TO 
                 WSS-TRM-NUM-OPCP  IN WSS-VMR
                 WSS-TRM-NUM-OPCUF IN WSS-VMR
                 WSS-TRM-NUM-OPCME IN WSS-VMR

                 WSS-TRM-VAL-OPCP  IN WSS-VMR
                 WSS-TRM-VAL-OPCUF IN WSS-VMR
                 WSS-TRM-VAL-OPCME IN WSS-VMR

                 WSS-TRM-NUM-OPER  IN WSS-VMR.
       FIN-LIM-TOT-TRM-VMR.
           EXIT.

       LIM-TOT-EJE-VMR SECTION.
       INI-LIM-TOT-EJE-VMR.
           MOVE ZEROES TO
                       WSS-TOT-EJE-NUM-OPCP  IN WSS-VMR
                       WSS-TOT-EJE-NUM-OPCUF IN WSS-VMR
                       WSS-TOT-EJE-NUM-OPCME IN WSS-VMR

                       WSS-TOT-EJE-VAL-OPCP  IN WSS-VMR
                       WSS-TOT-EJE-VAL-OPCUF IN WSS-VMR
                       WSS-TOT-EJE-VAL-OPCME IN WSS-VMR

                       WSS-TOT-EJE-NUM-OPER  IN WSS-VMR.
       FIN-LIM-TOT-EJE-VMR.
           EXIT.

       LIM-TOT-OFI-RVM SECTION.
       INI-LIM-TOT-OFI-RVM.
           MOVE ZEROES TO
                       WSS-TM1-OFI-NUM-OPCP  IN WSS-RVM
                       WSS-TM1-OFI-NUM-OPCUF IN WSS-RVM
                       WSS-TM1-OFI-NUM-OPCME IN WSS-RVM
                       WSS-TM1-OFI-VAL-OPCP  IN WSS-RVM
                       WSS-TM1-OFI-VAL-OPCUF IN WSS-RVM
                       WSS-TM1-OFI-VAL-OPCME IN WSS-RVM

                       WSS-TM2-OFI-NUM-OPCP  IN WSS-RVM
                       WSS-TM2-OFI-NUM-OPCUF IN WSS-RVM
                       WSS-TM2-OFI-NUM-OPCME IN WSS-RVM
                       WSS-TM2-OFI-VAL-OPCP  IN WSS-RVM
                       WSS-TM2-OFI-VAL-OPCUF IN WSS-RVM
                       WSS-TM2-OFI-VAL-OPCME IN WSS-RVM

                       WSS-TM3-OFI-NUM-OPCP  IN WSS-RVM
                       WSS-TM3-OFI-NUM-OPCUF IN WSS-RVM
                       WSS-TM3-OFI-NUM-OPCME IN WSS-RVM
                       WSS-TM3-OFI-VAL-OPCP  IN WSS-RVM
                       WSS-TM3-OFI-VAL-OPCUF IN WSS-RVM
                       WSS-TM3-OFI-VAL-OPCME IN WSS-RVM

                       WSS-TM4-OFI-NUM-OPCP  IN WSS-RVM
                       WSS-TM4-OFI-NUM-OPCUF IN WSS-RVM
                       WSS-TM4-OFI-NUM-OPCME IN WSS-RVM
                       WSS-TM4-OFI-VAL-OPCP  IN WSS-RVM
                       WSS-TM4-OFI-VAL-OPCUF IN WSS-RVM
                       WSS-TM4-OFI-VAL-OPCME IN WSS-RVM

                       WSS-TM5-OFI-NUM-OPCP  IN WSS-RVM
                       WSS-TM5-OFI-NUM-OPCUF IN WSS-RVM
                       WSS-TM5-OFI-NUM-OPCME IN WSS-RVM
                       WSS-TM5-OFI-VAL-OPCP  IN WSS-RVM
                       WSS-TM5-OFI-VAL-OPCUF IN WSS-RVM
                       WSS-TM5-OFI-VAL-OPCME IN WSS-RVM

                       WSS-TOT-OFI-NUM-OPCP  IN WSS-RVM
                       WSS-TOT-OFI-NUM-OPCUF IN WSS-RVM
                       WSS-TOT-OFI-NUM-OPCME IN WSS-RVM
                       WSS-TOT-OFI-VAL-OPCP  IN WSS-RVM
                       WSS-TOT-OFI-VAL-OPCUF IN WSS-RVM
                       WSS-TOT-OFI-VAL-OPCME IN WSS-RVM
                       WSS-TOT-OFI-NUM-OPER  IN WSS-RVM.
       FIN-LIM-TOT-OFI-RVM.
           EXIT.

       LIM-TOT-REG-RVM SECTION.
       INI-LIM-TOT-REG-RVM.
           MOVE ZEROES TO
                       WSS-TM1-REG-NUM-OPCP  IN WSS-RVM
                       WSS-TM1-REG-NUM-OPCUF IN WSS-RVM
                       WSS-TM1-REG-NUM-OPCME IN WSS-RVM
                       WSS-TM1-REG-VAL-OPCP  IN WSS-RVM
                       WSS-TM1-REG-VAL-OPCUF IN WSS-RVM
                       WSS-TM1-REG-VAL-OPCME IN WSS-RVM

                       WSS-TM2-REG-NUM-OPCP  IN WSS-RVM
                       WSS-TM2-REG-NUM-OPCUF IN WSS-RVM
                       WSS-TM2-REG-NUM-OPCME IN WSS-RVM
                       WSS-TM2-REG-VAL-OPCP  IN WSS-RVM
                       WSS-TM2-REG-VAL-OPCUF IN WSS-RVM
                       WSS-TM2-REG-VAL-OPCME IN WSS-RVM

                       WSS-TM3-REG-NUM-OPCP  IN WSS-RVM
                       WSS-TM3-REG-NUM-OPCUF IN WSS-RVM
                       WSS-TM3-REG-NUM-OPCME IN WSS-RVM
                       WSS-TM3-REG-VAL-OPCP  IN WSS-RVM
                       WSS-TM3-REG-VAL-OPCUF IN WSS-RVM
                       WSS-TM3-REG-VAL-OPCME IN WSS-RVM

                       WSS-TM4-REG-NUM-OPCP  IN WSS-RVM
                       WSS-TM4-REG-NUM-OPCME IN WSS-RVM
                       WSS-TM4-REG-NUM-OPCUF IN WSS-RVM
                       WSS-TM4-REG-VAL-OPCP  IN WSS-RVM
                       WSS-TM4-REG-VAL-OPCUF IN WSS-RVM
                       WSS-TM4-REG-VAL-OPCME IN WSS-RVM

                       WSS-TM5-REG-NUM-OPCP  IN WSS-RVM
                       WSS-TM5-REG-NUM-OPCUF IN WSS-RVM
                       WSS-TM5-REG-NUM-OPCME IN WSS-RVM
                       WSS-TM5-REG-VAL-OPCP  IN WSS-RVM
                       WSS-TM5-REG-VAL-OPCUF IN WSS-RVM
                       WSS-TM5-REG-VAL-OPCME IN WSS-RVM

                       WSS-TOT-REG-NUM-OPCP  IN WSS-RVM
                       WSS-TOT-REG-NUM-OPCUF IN WSS-RVM
                       WSS-TOT-REG-NUM-OPCME IN WSS-RVM
                       WSS-TOT-REG-VAL-OPCP  IN WSS-RVM
                       WSS-TOT-REG-VAL-OPCUF IN WSS-RVM
                       WSS-TOT-REG-VAL-OPCME IN WSS-RVM
                       WSS-TOT-REG-NUM-OPER  IN WSS-RVM.
       FIN-LIM-TOT-REG-RVM.
           EXIT.

       OBT-COD-MNAC SECTION.
       INI-OBT-COD-MNAC.
      * Obtiene Cod. PESOS con CIC de la Moneda '0999'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0999  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-PESO IN WSS-VARI.
       FIN-OBT-COD-MNAC.
           EXIT.

       OBT-COD-UF SECTION.
       INI-OBT-COD-UF.
      * Obtiene Cod. UF con CIC de la Moneda '0998'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC0998  NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-UF IN WSS-VARI.
       FIN-OBT-COD-UF.
           EXIT.

       OBT-COD-DOLA SECTION.
       INI-OBT-COD-DOLA.
      * Obtiene Cod. DOLAR con CIC de la Moneda '101301'
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '101301'       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC101301NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC.

           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-DOLA IN WSS-VARI.
       FIN-OBT-COD-DOLA.
           EXIT.

      *RVM-CST-FIN 20-JUN-1996
      * Busca Tipo de Banca en DCE o DCP segun sea el caso.
       OBT-TIP-BANCA SECTION.
       INI-OBT-TIP-BCA.
           MOVE RDC-CIC-ICLI IN RDC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
              MOVE RDC-CIC-ICLI IN RDC TO DCE-CIC-ICLI IN DCE
              MOVE FIO-GET-KEY         TO FIO-CMND
              PERFORM SGC-FIO-DCE
              IF NOT FIO-STAT-OKS
                 DISPLAY '#ERROR> NO EXISTE DCP NI DCE'
                 DISPLAY '#     > ASIGNA BLANCOS A TIPO BANCA '
                 DISPLAY '#     > PROCESO CONTINUA '
                 DISPLAY '#---------------------------------- '
                 MOVE SPACES TO WSS-BANCA IN WSS-VARI
              ELSE
                 MOVE DCE-COD-TBAN IN DCE TO WSS-BANCA IN WSS-VARI
           ELSE
             MOVE DCP-COD-TBAN IN DCP TO WSS-BANCA IN WSS-VARI.
       FIN-OBT-TIP-BCA.
           EXIT.
      ******************************************************************
      * Busca Documento Legal de Operacion de Credito segun Vencimiento
      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada
       BUS-DLC-ICG SECTION.
       INI-BUS-DLC-ICG.
      *     IF VEN-NUM-IDLC IN VEN NOT = 0
      *         MOVE VEN-NUM-IDLC IN VEN TO DLC-NUM-IDLC IN DLC
      *     ELSE
      *         MOVE VEN-NUM-IVCT IN VEN TO DLC-NUM-IDLC IN DLC.
      *     MOVE OPC-CIC-IOPC IN OPC     TO DLC-CIC-IOPC IN DLC.
      *     MOVE FIO-GET-KEY             TO FIO-CMND.
      *     PERFORM COL-FIO-DLC.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'COL'          TO MSG-COD-SIST
      *         MOVE 'OPC    DLCNX' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         DISPLAY MSG-GLS-DESC   DLC-KEY-IDLC
      *         GO TO FIN-BUS-DLC-ICG.
      * GET-ICG-DLC.
           MOVE DLC-NUM-IDLC IN DLC TO ICG-NUM-ICAN IN ICG.
           PERFORM GET-KEY-IICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-NUM-ICAN IN ICG = DLC-NUM-IDLC IN DLC AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
               PERFORM BUS-OPC-ICG.
       FIN-BUS-DLC-ICG.
           EXIT.
      *-----------------------------------------------------------------
      * Obtiene Tasa de Interes al Leer ICG por Llave KEY-IICG Formada
       BUS-OPC-ICG SECTION.
       INI-BUS-OPC-ICG.
           MOVE ZEROES TO ICG-NUM-ICAN IN ICG.
           PERFORM GET-KEY-IICG.
           IF NOT ( FIO-STAT-OKS AND
                    ICG-NUM-ICAN IN ICG = ZEROES              AND
                    ICG-CIC-IOPC IN ICG = OPC-CIC-IOPC IN OPC AND
                    ICG-CIC-IOPV IN ICG = SPACES              AND
                    ICG-NUM-IVCT IN ICG = ZEROES              AND
                    ICG-IND-TTAS IN ICG = 'INT' )
                     MOVE '23' TO FIO-STAT.
       FIN-BUS-OPC-ICG.
           EXIT.
      *-----------------------------------------------------------------
       GET-KEY-IICG SECTION.
       INI-GET-KEY-IICG.
      * Forma Llave KEY-IICG y Lee ICG para Obtener Tasa de Interes
           MOVE OPC-CIC-IOPC IN OPC TO ICG-CIC-IOPC IN ICG.
           MOVE SPACES              TO ICG-CIC-IOPV IN ICG.
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG.
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-NLS         TO FIO-CMND.
           PERFORM COL-FIO-ICG.
       FIN-GET-KEY-IICG.
           EXIT.
      *-----------------------------------------------------------------
       VAL-COD-TBAN SECTION.
       INI-VAL-COD-TBAN.
           MOVE 1 TO WSS-CNTD IN WSS-VARI.
           MOVE '00' TO FIO-STAT.
       LUP-TBAN.
           IF VEC-COD-TBAN(WSS-CNTD) = '*'
               GO TO FIN-VAL-COD-TBAN.
           IF WSS-CNTD IN WSS-VARI > WSS-CMAX IN WSS-VARI OR
             VEC-COD-TBAN(WSS-CNTD) = '999'
               MOVE '23' TO FIO-STAT
               GO TO FIN-VAL-COD-TBAN.
           IF VEC-COD-TBAN(WSS-CNTD) NOT = WSS-BANCA IN WSS-VARI
               ADD 1 TO WSS-CNTD IN WSS-VARI
               GO TO LUP-TBAN.
       FIN-VAL-COD-TBAN.
           EXIT.
      ******************************************************************
       COPY COLBFRDC.
       COPY COLBFICG.
       COPY COLBFCYA.
       COPY COLBFTOC.
       COPY COLBFAUX.
       COPY COLBFDLC.
       COPY COLBFOPC.
       COPY TABBFOFI.
       COPY TABBFTIO.
       COPY TABBFUSR.
       COPY TABBFCAM.
       COPY TABBGTVC.
       COPY SGCBFDBC.
       COPY SGCBFDCE.
       COPY SGCBFDCP.
       COPY GNSBFMSC.
       COPY GNSBBTAB.
       COPY GNSBBMSG.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBGHOY.
       COPY GNSBGCPT.
       COPY GNSBGPES.
       COPY TABBBUSR.
       COPY GNSBBMSC.
       COPY COLBGAUX.
       COPY COLBGCTO.
      *>>>>
*% END
