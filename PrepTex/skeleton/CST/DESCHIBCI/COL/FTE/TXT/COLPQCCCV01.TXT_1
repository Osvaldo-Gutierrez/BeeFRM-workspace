*%! Codigo adicional para archivo
*%! INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*% PGM_PTC = TRUE
*% INCLUDE 'GNSTXT:GNSPPPTC.TXT'
*%
*% FRM = "CCC"
*% PADRE = "RDC"
*% KEY_PADRE = "RDC-KEY-IRDC"
*% LARGO_KEY_PADRE = 27
*% RELACION_PADRE_HIJO = "RDC-CIC-IOPC"
*% LARGO_RELACION_PADRE_HIJO = 12
*% FIO_PADRE = "COL-FIO-RDC"
*% SIST_PADRE = "COL"
*% KEY_BROWSE_PADRE = "RDC-KEY-IRDC"
*% ORG_PADRE_VSI = TRUE
*%
*% HIJO = "DLC"
*% KEY_HIJO = "DLC-KEY-IDLC"
*% LARGO_KEY_HIJO = 15
*% RELACION_HIJO_PADRE = "DLC-CIC-IOPC"
*% FIO_HIJO = "COL-FIO-DLC"
*% SIST_HIJO = "COL"
*% KEY_BROWSE_HIJO = "DLC-KEY-IDLC"
*% ORG_HIJO_VSI = TRUE
*%
*% ACEPTE_PF5 = TRUE
*% ACEPTE_PF6 = TRUE
*% ACEPTE_PF7 = FALSE
*% ACEPTE_PF8 = FALSE
*% INICIALIZAR_VARIABLES = FALSE
*% COLAR_HIJOS = TRUE
*% LEER_TODOS_LOS_HIJOS = FALSE
*% NUMERO_LINEAS_TABLA = 6
*%
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*%! El codigo de PFS esta escrito directamente en
*%! este archivo
*%! INCLUDE 'COLSRC:PFSCONIDX.SRC'
*%!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
*% LARGO_TOTAL_COMMAREA = 358
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03  SCR-VARI-PFS.
               05  SCR-KEY-IDLC-ASCE      PIC X(15).
               05  SCR-KEY-IDLC-DESC      PIC X(15).
               05  SCR-KEY-IRDC-RAIZ-A    PIC X(12).
               05  SCR-KEY-IRDC-RAIZ-D    PIC X(12).
               05  SCR-KEY-IRDC-ACTU-A    PIC X(27).
               05  SCR-KEY-IRDC-ACTU-D    PIC X(27).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
      *PTC-INI :  7-NOV-1996 16:55:17 
       COPY GNSWGTSK.
       01  FRM-IFLD-PTC     VALUE ZEROES PIC 9(04).
       01  WSS-IDX-I        VALUE 1      PIC 9(04).
       01  WSS-IDX-J        VALUE 1      PIC 9(04).

      * LA SGTE AREA DEBE ESTAR SINCRONIZADA CON LO GENERADO
      * PARA TP-002 POR GENMTX

      * 01  TP-002 REDEFINES WSS-SND.
      * 01  TP-002.
       01  TP-002 VALUE SPACES.
           03  TP-002-STAT                                 PIC X(00001).
           03  TP-002-MENS                                 PIC X(00079).
           03  TP-002-DMSG.
               05  TP-002-01-DBC-GLS-NOMC                  PIC X(00067).
               05  TP-002-01-DBC-NUM-ICLI                  PIC X(00008).
               05  TP-002-01-DBC-VRF-ICLI                  PIC X(00001).
               05  TP-002-01-DBC-IND-ICLI                  PIC X(00001).
               05  TP-002-01-DBC-GLS-ICLI                  PIC X(00003).
               05  TP-002-01-FRM-COD-TOOC                  PIC X(00003).
               05  TP-002-01-FRM-COD-AOOC                  PIC X(00003).
               05  TP-002-01-FRM-COD-STAT                  PIC X(00001).
               05  TP-002-01-FRM-FEC-FINI                  PIC X(00008).
               05  TP-002-01-FRM-FEC-FTER                  PIC X(00008).
               05  TP-002-01-FRM-GLS-EJEC                  PIC X(00053).
               05  TP-002-DMSG-IDX-1 OCCURS 4 TIMES.
                   07  TP-002-FLD-HST OCCURS 6 TIMES.
                       09  TP-002-02-FRM-CAI-IOPC          PIC X(00004).
                       09  TP-002-02-FRM-IIC-IOPC          PIC X(00008).
                       09  TP-002-02-FRM-NUM-IDLC          PIC X(00003).
                       09  TP-002-02-FRM-COD-COOC          PIC X(00006).
                       09  TP-002-02-FRM-NUM-ACEP          PIC X(00008).
                       09  TP-002-02-FRM-VRF-ACEP          PIC X(00001).
                       09  TP-002-02-FRM-IND-ACEP          PIC X(00001).
                       09  TP-002-02-FRM-GLS-ACEP          PIC X(00003).
                       09  TP-002-02-FRM-GLS-NOMC          PIC X(00044).
                       09  TP-002-02-FRM-VAL-NDLC          PIC X(00015).
                       09  TP-002-02-FRM-COD-OFOC          PIC X(00003).
                       09  TP-002-02-FRM-GLS-STAT          PIC X(00012).
      *     03  TP-002-FRM-GLS-DISP                         PIC X(07028).
      * 

      *PTC-FIN :  7-NOV-1996 16:55:17 

       01  PFS-VARI.
           03 PFS-IDLC-SEL        VALUE 'S' PIC X(01).
           03 PFS-IVEZ-TOT        VALUE 'S' PIC X(01).
      *>>>>
*% END
*% IF WSS AND PGM_DTC
      *<<<< WSS AND PGM_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGPES.
       COPY COLBRDLC.
       COPY COLBROPC.
       COPY COLBRRCE.
       COPY TABBRCAM.
       COPY TABWGTVC.
       COPY SGCBRDBC.
       01  WSS-VARI.
           03 WSS-FEC-FCM1.
              05 WSS-NUM-SCM1     PIC 9(02).
              05 WSS-NUM-ACM1     PIC 9(02).
              05 WSS-NUM-MCM1     PIC 9(02).
              05 WSS-NUM-DCM1     PIC 9(02).
           03 WSS-FEC-FCM2.
              05 WSS-NUM-SCM2     PIC 9(02).
              05 WSS-NUM-ACM2     PIC 9(02).
              05 WSS-NUM-MCM2     PIC 9(02).
              05 WSS-NUM-DCM2     PIC 9(02).
           03 WSS-COD-COOC.
              05 WSS-COD-TOOC     PIC X(03).
              05 WSS-COD-AOOC     PIC X(03).
           03 WSS-KEY-IRDC        PIC X(27).
      *JSS-INI 24-NOV-1995
           03 WSS-VAL-NDLC.
              05 WSS-VAL-NDLC-EDT PIC ZZZZZZZZZ9,9999.
      *JSS-FIN 24-NOV-1995
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-CCC
               PERFORM VAL-NUM-FLD-CCC
               PERFORM SCRL-TAB-CCC
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF DBC-NUM-ICLI IN CCC-FLD NOT = ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN CCC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN CCC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN CCC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
                   MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN CCC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN CCC-FLD
           ELSE
           IF DBC-GLS-NOMC IN CCC-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre
               MOVE SPACES TO DBC-GLS-NOMC IN DBC

               MOVE DBC-GLS-NOMC IN CCC-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE ZEROES TO DBC-NUM-ICLI IN CCC-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN CCC-FLD
                   MOVE SPACES TO DBC-IND-ICLI IN CCC-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN CCC-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN CCC-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN CCC-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN CCC-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN CCC-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN CCC-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN CCC-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO DBC-CAI-ICLI IN CCC-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO DBC-IIC-ICLI IN CCC-FLD.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN CCC-FLD.

           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.
           MOVE SPACES              TO RDC-KEY-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
       LUP-FND-KEY.
           IF NOT FIO-STAT-OKS OR
              RDC-CIC-ICLI IN RDC NOT = DBC-CIC-ICLI IN DBC
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-FND-KEY.

      * INI-VFP  9-JAN-1997 11:11:21 
      *     IF RDC-NUM-IDLC IN RDC = ZEROS
      *        MOVE FIO-STAT TO PGM-STAT-RDC.
      *        GO TO FIN-LOOP-LECTURA-RDC.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              IF RDC-NUM-IDLC IN RDC = ZEROS
                 MOVE FIO-STAT TO PGM-STAT-RDC
                 GO TO FIN-LOOP-LECTURA-RDC
              ELSE
                 NEXT SENTENCE
           ELSE
              IF RDC-NUM-IDLC IN RDC NOT = ZEROS
                 MOVE FIO-STAT TO PGM-STAT-RDC
                 GO TO FIN-LOOP-LECTURA-RDC.
      * FIN-VFP  9-JAN-1997 11:11:37 

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           GO TO LUP-FND-KEY.
       FIN-LOOP-LECTURA-RDC.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           IF PGM-STAT-RDC-OKS
               PERFORM INIT-VARI
      * INI-VFP  9-JAN-1997 16:38:48 
      *         MOVE SPACES TO DLC-KEY-IDLC IN DLC
               MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC
      * FIN-VFP  9-JAN-1997 16:39:50 
               MOVE RDC-CIC-IOPC IN RDC TO DLC-CIC-IOPC IN DLC
               MOVE 'DLC-KEY-IDLC' TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM COL-FIO-DLC
               IF FIO-STAT-OKS AND
                  DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
                   MOVE SPACES TO SCR-KEY-IDLC-ASCE
                                  SCR-KEY-IDLC-DESC
                   PERFORM LLENAR-TABLA-ASCE
               ELSE
                   PERFORM LIMPIAR-TABLA VARYING FRM-IFLD FROM 1 BY 1
                                         UNTIL   FRM-IFLD > 6
                   MOVE 'COL' TO MSG-COD-SIST
                   MOVE 'DLC    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC        TO FRM-MEN1
                   MOVE RDC-CIC-IOPC IN RDC TO FRM-MEN2.
      *AMP         MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           MOVE DBC-CAI-ICLI IN CCC-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN CCC-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 )
           IF NOT ( FRM-FFLD = FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       SCRL-TAB-CCC SECTION.
       INI-SCRL-TAB-CCC.
           MOVE 'N' TO PFS-IVEZ-TOT.
           IF FRM-FFLD = FRM-FFLD-PF5
               PERFORM SCRL-TAB-CCC-PF5
               GO TO FIN-SCRL-TAB-CCC.
           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM SCRL-TAB-CCC-PF6
               GO TO FIN-SCRL-TAB-CCC.
       FIN-SCRL-TAB-CCC.
           EXIT.

       LLENAR-TABLA-ASCE SECTION.
       INI-LLENAR-TABLA-ASCE.

      *PTC-INI :  7-NOV-1996 16:55:17 
           MOVE 1 TO FRM-IFLD-PTC.
      *PTC-FIN :  7-NOV-1996 16:55:17 

           MOVE 1 TO FRM-IFLD.
       LUP-LLENAR-TABLA-ASCE.
           MOVE 'S' TO PFS-IDLC-SEL.
           IF PFS-IVEZ-TOT = 'S'
               PERFORM PROCESO-CADA-HIJO
               IF PFS-IDLC-SEL NOT = 'S'
                   SUBTRACT 1 FROM FRM-IFLD
                   GO TO NXT-LLENAR-TABLA-ASCE.
           IF FRM-IFLD NOT > 6
               PERFORM CARGAR-TABLA
               IF PFS-IDLC-SEL NOT = 'S'
                   SUBTRACT 1 FROM FRM-IFLD
                   GO TO NXT-LLENAR-TABLA-ASCE.
           IF FRM-IFLD = 1

               MOVE SPACES              TO SCR-KEY-IRDC-ACTU-A
               MOVE SPACES              TO SCR-KEY-IRDC-RAIZ-A
               MOVE RDC-KEY-IRDC IN RDC TO SCR-KEY-IRDC-ACTU-D
               MOVE RDC-CIC-IOPC IN RDC TO SCR-KEY-IRDC-RAIZ-D

               MOVE DLC-CIC-IOPC IN DLC TO SCR-KEY-IRDC-RAIZ-D
               MOVE DLC-KEY-IDLC IN DLC TO SCR-KEY-IDLC-DESC
               MOVE SPACES              TO SCR-KEY-IDLC-ASCE
           ELSE
           IF FRM-IFLD = 6

               MOVE RDC-KEY-IRDC IN RDC TO SCR-KEY-IRDC-ACTU-A
               MOVE RDC-CIC-IOPC IN RDC TO SCR-KEY-IRDC-RAIZ-A

               MOVE DLC-KEY-IDLC IN DLC TO SCR-KEY-IDLC-ASCE.
       NXT-LLENAR-TABLA-ASCE.
           ADD 1 TO FRM-IFLD.
      *PTC-INI :  7-NOV-1996 16:55:17 
           IF SCR-OFRM-SRV
               PERFORM SET-PTC
               IF FRM-IFLD-PTC = 25
                   GO TO FIN-LLENAR-TABLA-ASCE.

      *PTC-FIN :  7-NOV-1996 16:55:17 
           IF PFS-IVEZ-TOT = 'N'
               IF FRM-IFLD > 6
                   GO TO FIN-LLENAR-TABLA-ASCE.
      * INI-VFP  9-JAN-1997 16:41:23 
      *    MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
      *    MOVE FIO-GET-NXT TO FIO-CMND.
      *    PERFORM COL-FIO-DLC.
      *    IF FIO-STAT-OKS AND
      *       DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
      *       GO TO LUP-LLENAR-TABLA-ASCE.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              MOVE 'DLC-KEY-IDLC' TO FIO-AKEY
              MOVE FIO-GET-NXT TO FIO-CMND
              PERFORM COL-FIO-DLC
              IF FIO-STAT-OKS AND
                 DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
                 GO TO LUP-LLENAR-TABLA-ASCE.
      * FIN-VFP  9-JAN-1997 16:41:39 

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO CON-LLENAR-TABLA-ASCE.
       LU1-LLENAR-TABLA-ASCE.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO CON-LLENAR-TABLA-ASCE.
           IF RDC-CIC-ICLI IN RDC NOT = DBC-CIC-ICLI IN DBC
               GO TO CON-LLENAR-TABLA-ASCE.

      * INI-VFP  9-JAN-1997 11:13:45 
      *     IF RDC-NUM-IDLC IN RDC NOT = ZEROES
      *        GO TO LU1-LLENAR-TABLA-ASCE.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                 GO TO LU1-LLENAR-TABLA-ASCE
              ELSE
                 NEXT SENTENCE
           ELSE
              IF RDC-NUM-IDLC IN RDC = ZEROES
                 GO TO LU1-LLENAR-TABLA-ASCE.
      * FIN-VFP  9-JAN-1997 11:14:40 

      * INI-VFP  9-JAN-1997 16:45:22 
      *     MOVE SPACES TO DLC-KEY-IDLC IN DLC.
           MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC.
      * FIN-VFP  9-JAN-1997 16:46:10 
           MOVE RDC-CIC-IOPC IN RDC TO DLC-CIC-IOPC IN DLC.
           MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
              GO TO LUP-LLENAR-TABLA-ASCE.
      *JSS-INI 17-MAY-1994
           GO TO LU1-LLENAR-TABLA-ASCE.
      *JSS-FIN 17-MAY-1994
       CON-LLENAR-TABLA-ASCE.
           IF FRM-IFLD = 1
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'DLC    NONXT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2
           ELSE
           PERFORM LIMPIAR-TABLA VARYING FRM-IFLD FROM FRM-IFLD BY 1
                                 UNTIL   FRM-IFLD > 6.
       FIN-LLENAR-TABLA-ASCE.
           MOVE FIO-END-BRW TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF SCR-OFRM-SRV
                PERFORM GET-TSK-TERM
                MOVE TSK-TERM-ALF TO QUE-TERM
                MOVE 'FCCC'       TO QUE-TYPE
                MOVE TP-002 TO QUE-ITEM
                MOVE +3000 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE.

       EXT-LLENAR-TABLA-ASCE.
           EXIT.

      *PTC-INI :  7-NOV-1996 16:55:17 
       SET-PTC SECTION.
       INI-SET-PTC.
           MOVE 1 TO FRM-IFLD.
      *     IF PFS-IDLC-SEL = 'S' AND
      *        FRM-IFLD-PTC = 1

      *           MOVE       DBC-GLS-NOMC IN CCC-FLD TO
      *            TP-002-01-DBC-GLS-NOMC

      *           MOVE       DBC-NUM-ICLI IN CCC-FLD TO
      *            TP-002-01-DBC-NUM-ICLI

      *           MOVE       DBC-VRF-ICLI IN CCC-FLD TO
      *            TP-002-01-DBC-VRF-ICLI

      *           MOVE       DBC-IND-ICLI IN CCC-FLD TO
      *            TP-002-01-DBC-IND-ICLI

      *           MOVE       DBC-GLS-ICLI IN CCC-FLD TO
      *            TP-002-01-DBC-GLS-ICLI

      *           MOVE       FRM-COD-TOOC IN CCC-FLD TO
      *            TP-002-01-FRM-COD-TOOC

      *           MOVE       FRM-COD-AOOC IN CCC-FLD TO
      *            TP-002-01-FRM-COD-AOOC

      *           MOVE       FRM-COD-STAT IN CCC-FLD TO
      *            TP-002-01-FRM-COD-STAT

      *           MOVE       FRM-FEC-FINI IN CCC-FLD TO
      *            TP-002-01-FRM-FEC-FINI

      *           MOVE       FRM-FEC-FTER IN CCC-FLD TO
      *            TP-002-01-FRM-FEC-FTER

      *           MOVE       FRM-GLS-EJEC IN CCC-FLD TO
      *            TP-002-01-FRM-GLS-EJEC.
               
           IF PFS-IDLC-SEL = 'S'

                 MOVE       FRM-CAI-IOPC IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-CAI-IOPC IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-IIC-IOPC IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-IIC-IOPC IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-NUM-IDLC IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-NUM-IDLC IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-COD-COOC IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-COD-COOC IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-NUM-ACEP IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-NUM-ACEP IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-VRF-ACEP IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-VRF-ACEP IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-IND-ACEP IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-IND-ACEP IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-GLS-ACEP IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-GLS-ACEP IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-VAL-NDLC IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-VAL-NDLC IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-COD-OFOC IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-COD-OFOC IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-GLS-STAT IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-GLS-STAT IN TP-002(WSS-IDX-I, WSS-IDX-J) 

                 MOVE       FRM-GLS-NOMC IN CCC-FLD( 1 )  TO
                  TP-002-02-FRM-GLS-NOMC IN TP-002(WSS-IDX-I, WSS-IDX-J)

                  ADD 1 TO WSS-IDX-J

                  IF WSS-IDX-J = 7
                      ADD 1 TO WSS-IDX-I
                      MOVE 1 TO WSS-IDX-J.

           ADD 1 TO FRM-IFLD-PTC.

       FIN-SET-PTC.
           EXIT.
       COPY GNSBGTSK.
      *PTC-FIN :  7-NOV-1996 16:55:17 

       LLENAR-TABLA-DESC SECTION.
       INI-LLENAR-TABLA-DESC.
           MOVE 6 TO FRM-IFLD.
       LUP-LLENAR-TABLA-DESC.
           MOVE 'S' TO PFS-IDLC-SEL.
           PERFORM CARGAR-TABLA.
           IF PFS-IDLC-SEL NOT = 'S'
               ADD 1 TO FRM-IFLD
               GO TO PRV-LLENAR-TABLA-DESC.
           IF FRM-IFLD = 6

               MOVE RDC-KEY-IRDC IN RDC TO SCR-KEY-IRDC-ACTU-A
               MOVE RDC-CIC-IOPC IN RDC TO SCR-KEY-IRDC-RAIZ-A
               MOVE SPACES              TO SCR-KEY-IRDC-ACTU-D
               MOVE SPACES              TO SCR-KEY-IRDC-RAIZ-D

               MOVE DLC-CIC-IOPC IN DLC TO SCR-KEY-IRDC-RAIZ-A
               MOVE DLC-KEY-IDLC IN DLC TO SCR-KEY-IDLC-ASCE
               MOVE SPACES              TO SCR-KEY-IDLC-DESC
           ELSE
           IF FRM-IFLD = 1

               MOVE RDC-KEY-IRDC IN RDC TO SCR-KEY-IRDC-ACTU-D
               MOVE RDC-CIC-IOPC IN RDC TO SCR-KEY-IRDC-RAIZ-D

               MOVE DLC-KEY-IDLC IN DLC TO SCR-KEY-IDLC-DESC.
       PRV-LLENAR-TABLA-DESC.
           SUBTRACT 1 FROM FRM-IFLD.
           IF FRM-IFLD < 1
               GO TO FIN-LLENAR-TABLA-DESC.
      * INI-VFP  9-JAN-1997 16:47:17 
      *     MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
      *     MOVE FIO-GET-PRV TO FIO-CMND.
      *     PERFORM COL-FIO-DLC.
      *     IF FIO-STAT-OKS AND
      *        DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
      *         GO TO LUP-LLENAR-TABLA-DESC.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              MOVE 'DLC-KEY-IDLC' TO FIO-AKEY
              MOVE FIO-GET-PRV TO FIO-CMND
              PERFORM COL-FIO-DLC
              IF FIO-STAT-OKS AND
                 DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
                 GO TO LUP-LLENAR-TABLA-DESC.
      * FIN-VFP  9-JAN-1997 16:48:32 
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO CON-LLENAR-TABLA-DESC.
       LU1-LLENAR-TABLA-DESC.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO CON-LLENAR-TABLA-DESC.
           IF RDC-CIC-ICLI IN RDC NOT = DBC-CIC-ICLI IN DBC
               GO TO CON-LLENAR-TABLA-DESC.

      * INI-VFP  9-JAN-1997 11:15:08    
      *    IF RDC-NUM-IDLC IN RDC NOT = ZEROES
      *       GO TO LU1-LLENAR-TABLA-DESC.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                 GO TO LU1-LLENAR-TABLA-DESC
              ELSE
                 NEXT SENTENCE
           ELSE
              IF RDC-NUM-IDLC IN RDC = ZEROES
                 GO TO LU1-LLENAR-TABLA-DESC.
      * FIN-VFP  9-JAN-1997 11:15:44 
      * INI-VFP  9-JAN-1997 16:49:03 
      *     MOVE ALL '9' TO DLC-KEY-IDLC IN DLC.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              MOVE ALL '9' TO DLC-KEY-IDLC IN DLC
           ELSE
              MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC.
      * FIN-VFP  9-JAN-1997 16:51:11 
           MOVE RDC-CIC-IOPC IN RDC TO DLC-CIC-IOPC IN DLC.
           MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
              GO TO LUP-LLENAR-TABLA-DESC.
      *JSS-INI 17-MAY-1994
           GO TO LU1-LLENAR-TABLA-DESC.
      *JSS-FIN 17-MAY-1994
       CON-LLENAR-TABLA-DESC.
           IF FRM-IFLD = 6
               MOVE 'COL' TO MSG-COD-SIST
               MOVE 'DLC    NOPRV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2
           ELSE
           PERFORM LIMPIAR-TABLA VARYING FRM-IFLD FROM FRM-IFLD BY -1
                                 UNTIL   FRM-IFLD < 1.
       FIN-LLENAR-TABLA-DESC.
           MOVE FIO-END-BRW TO FIO-CMND.
           PERFORM COL-FIO-DLC.
       EXT-LLENAR-TABLA-DESC.
           EXIT.

       SCRL-TAB-CCC-PF5 SECTION.
       INI-SCRL-TAB-CCC-PF5.
           MOVE SCR-KEY-IRDC-ACTU-D TO RDC-KEY-IRDC IN RDC.
C          MOVE SCR-KEY-IRDC-ACTU-D TO DBC-CIC-ICLI IN DBC.
           IF SCR-KEY-IDLC-DESC NOT > SPACES
               MOVE 'DLC    NOPRV' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-CCC-PF5.
           MOVE SCR-KEY-IDLC-DESC TO DLC-KEY-IDLC IN DLC.
           MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
               DLC-KEY-IDLC IN DLC = SCR-KEY-IDLC-DESC )
               MOVE 'DLCCURRNEX' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-CCC-PF5.
      * INI-VFP  9-JAN-1997 18:06:26 
      *     MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
      *     MOVE FIO-GET-PRV TO FIO-CMND.
      *     PERFORM COL-FIO-DLC.
      *     IF FIO-STAT-OKS AND
      *        DLC-CIC-IOPC IN DLC = SCR-KEY-IRDC-RAIZ-D
      *         PERFORM LLENAR-TABLA-DESC
      *         GO TO FIN-SCRL-TAB-CCC-PF5.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              MOVE 'DLC-KEY-IDLC' TO FIO-AKEY
              MOVE FIO-GET-PRV TO FIO-CMND
              PERFORM COL-FIO-DLC
              IF FIO-STAT-OKS AND
                 DLC-CIC-IOPC IN DLC = SCR-KEY-IRDC-RAIZ-D
                 PERFORM LLENAR-TABLA-DESC
                 GO TO FIN-SCRL-TAB-CCC-PF5.
      * FIN-VFP  9-JAN-1997 18:09:02 
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO CON-MSG-SCRL-TAB-CCC-PF5.
       LU1-LLENAR-PF5-DESC.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO CON-MSG-SCRL-TAB-CCC-PF5.
           IF RDC-CIC-ICLI IN RDC NOT = DBC-CIC-ICLI IN DBC
               GO TO CON-MSG-SCRL-TAB-CCC-PF5.

      * INI-VFP  9-JAN-1997 11:15:59 
      *    IF RDC-NUM-IDLC IN RDC NOT = ZEROES
      *       GO TO LU1-LLENAR-PF5-DESC.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                 GO TO LU1-LLENAR-PF5-DESC
              ELSE
                 NEXT SENTENCE
           ELSE
              IF RDC-NUM-IDLC IN RDC = ZEROES
                 GO TO LU1-LLENAR-PF5-DESC.
      * FIN-VFP  9-JAN-1997 11:16:58 
             
      * INI-VFP   9-JAN-1997 16:52:43 
      *     MOVE ALL '9' TO DLC-KEY-IDLC IN DLC.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              MOVE ALL '9' TO DLC-KEY-IDLC IN DLC
           ELSE
              MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC.
      * FIN-VFP   9-JAN-1997 16:52:54 
           MOVE RDC-CIC-IOPC IN RDC TO DLC-CIC-IOPC IN DLC.
           MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
               PERFORM LLENAR-TABLA-DESC
               GO TO FIN-SCRL-TAB-CCC-PF5.
           GO TO LU1-LLENAR-PF5-DESC.
       CON-MSG-SCRL-TAB-CCC-PF5.
           MOVE 'DLC    NOPRV' TO MSG-COD-MENS.
       MSG-SCRL-TAB-CCC-PF5.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-CCC-PF5.
           EXIT.

       SCRL-TAB-CCC-PF6 SECTION.
       INI-SCRL-TAB-CCC-PF6.
           MOVE SCR-KEY-IRDC-ACTU-A TO RDC-KEY-IRDC IN RDC.
C          MOVE SCR-KEY-IRDC-ACTU-A TO DBC-CIC-ICLI IN DBC.
           IF SCR-KEY-IDLC-ASCE NOT > SPACES
               MOVE 'DLC    NONXT' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-CCC-PF6.
           MOVE SCR-KEY-IDLC-ASCE TO DLC-KEY-IDLC IN DLC.
           MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
               DLC-KEY-IDLC IN DLC = SCR-KEY-IDLC-ASCE )
               MOVE 'DLCCURRNEX' TO MSG-COD-MENS
               GO TO MSG-SCRL-TAB-CCC-PF6.
      * INI-VFP  9-JAN-1997 18:12:31 
      *     MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
      *     MOVE FIO-GET-NXT TO FIO-CMND.
      *     PERFORM COL-FIO-DLC.
      *     IF FIO-STAT-OKS AND
      *        DLC-CIC-IOPC IN DLC = SCR-KEY-IRDC-RAIZ-A
      *         PERFORM LLENAR-TABLA-ASCE
      *         GO TO FIN-SCRL-TAB-CCC-PF6.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              MOVE 'DLC-KEY-IDLC' TO FIO-AKEY
              MOVE FIO-GET-NXT TO FIO-CMND
              PERFORM COL-FIO-DLC
              IF FIO-STAT-OKS AND
                 DLC-CIC-IOPC IN DLC = SCR-KEY-IRDC-RAIZ-A
                 PERFORM LLENAR-TABLA-ASCE
                 GO TO FIN-SCRL-TAB-CCC-PF6.
      * FIN-VFP  9-JAN-1997 18:13:26 
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO CON-MSG-SCRL-TAB-CCC-PF6.
       LU1-LLENAR-PF6-ASCE.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO CON-MSG-SCRL-TAB-CCC-PF6.
           IF RDC-CIC-ICLI IN RDC NOT = DBC-CIC-ICLI IN DBC
               GO TO CON-MSG-SCRL-TAB-CCC-PF6.

      * INI-VFP  9-JAN-1997 11:19:46 
      *    IF RDC-NUM-IDLC IN RDC NOT = ZEROES
      *       GO TO LU1-LLENAR-PF6-ASCE.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              IF RDC-NUM-IDLC IN RDC NOT = ZEROES
                 GO TO LU1-LLENAR-PF6-ASCE
              ELSE
                 NEXT SENTENCE
           ELSE
              IF RDC-NUM-IDLC IN RDC = ZEROES
                 GO TO LU1-LLENAR-PF6-ASCE.
      * FIN-VFP  9-JAN-1997 11:27:22 

      * INI-VFP  9-JAN-1997 16:54:43 
      *     MOVE SPACES TO DLC-KEY-IDLC IN DLC.
           MOVE RDC-NUM-IDLC IN RDC TO DLC-NUM-IDLC IN DLC.
      * FIN-VFP  9-JAN-1997 16:55:28 
           MOVE RDC-CIC-IOPC IN RDC TO DLC-CIC-IOPC IN DLC.
           MOVE 'DLC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
               PERFORM LLENAR-TABLA-ASCE
               GO TO FIN-SCRL-TAB-CCC-PF6.
           GO TO LU1-LLENAR-PF6-ASCE.
       CON-MSG-SCRL-TAB-CCC-PF6.
           MOVE 'DLC    NONXT' TO MSG-COD-MENS.
       MSG-SCRL-TAB-CCC-PF6.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-CCC-PF6.
           EXIT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       PROCESO-CADA-HIJO SECTION.
       INI-PROCESO-CADA-HIJO.
           PERFORM SEL-REG-CAR.
           IF PFS-IDLC-SEL = 'N'
               GO TO FIN-PROCESO-CADA-HIJO.
           ADD 1 TO FRM-NUM-TDLC IN CCC-FLD.
           IF FRM-COD-VCOC IN CCC-FLD > SPACES
               ADD DLC-VAL-SDLC IN DLC TO FRM-VAL-TDLC IN CCC-FLD
               GO TO FIN-PROCESO-CADA-HIJO.
           IF FRM-IFLD = 1
               PERFORM GET-FHOY
               MOVE 'TAB'  TO FIO-SIST
               MOVE 'VLR'  TO TAB-CIC-TTAB IN TAB
               MOVE '0999' TO TAB-CIC-CTAB IN TAB
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO TVC-MNAC
               ELSE
                   MOVE TAB-COD-CTAB IN TAB TO TVC-MNAC.
           MOVE DLC-VAL-SDLC IN DLC TO TVC-VALO IN TVC-VARI.
           MOVE OPC-COD-VCOC IN OPC TO TVC-MON1 IN TVC-VARI.
           MOVE TVC-MNAC            TO TVC-MON2 IN TVC-VARI.
           MOVE HOY-DHOY            TO TVC-DCAM IN TVC-VARI.
           MOVE HOY-MHOY            TO TVC-MCAM IN TVC-VARI.
           MOVE HOY-SHOY            TO TVC-SCAM IN TVC-VARI.
           MOVE HOY-AHOY            TO TVC-ACAM IN TVC-VARI.
           PERFORM TAB-PRO-TVC.
           IF TVC-CMSG NOT > SPACES
               ADD TVC-VALO TO FRM-VAL-TDLC IN CCC-FLD.
       FIN-PROCESO-CADA-HIJO.
           EXIT.

       CARGAR-TABLA SECTION.
       INI-CARGAR-TABLA.
           IF PFS-IVEZ-TOT = 'N'
               PERFORM SEL-REG-CAR
               IF PFS-IDLC-SEL = 'N'
                   GO TO FIN-CARGAR-TABLA.
           MOVE OPC-COD-COOC IN OPC TO
                FRM-COD-COOC IN CCC-FLD(FRM-IFLD).
           MOVE OPC-COD-OFOC IN OPC TO
                FRM-COD-OFOC IN CCC-FLD(FRM-IFLD).
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'STT' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-MSC-STAT IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DCOR IN TAB TO
                FRM-GLS-STAT IN CCC-FLD(FRM-IFLD).

           MOVE DLC-KEY-IDLC IN DLC TO RCE-KEY-IDLC IN RCE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RCE.
           IF FIO-STAT-OKS
               MOVE RCE-KEY-CNJE IN RCE TO
                    FRM-COD-NUNI IN CCC-FLD(FRM-IFLD)
           ELSE
               MOVE SPACES TO FRM-COD-NUNI IN CCC-FLD(FRM-IFLD).

           MOVE DLC-CAI-IOPC IN DLC TO
                FRM-CAI-IOPC IN CCC-FLD(FRM-IFLD).
           MOVE DLC-IIC-IOPC IN DLC TO
                FRM-IIC-IOPC IN CCC-FLD(FRM-IFLD).
           MOVE DLC-NUM-IDLC IN DLC TO
                FRM-NUM-IDLC IN CCC-FLD(FRM-IFLD).
      *JSS-INI 24-NOV-1995
      *    MOVE DLC-VAL-SDLC IN DLC TO
      *         FRM-VAL-NDLC IN CCC-FLD(FRM-IFLD).
           MOVE DLC-VAL-SDLC IN DLC TO WSS-VAL-NDLC-EDT.
           MOVE WSS-VAL-NDLC TO
                FRM-VAL-NDLC IN CCC-FLD(FRM-IFLD).
      *JSS-FIN 24-NOV-1995
           MOVE DLC-NUM-DMAV IN DLC TO
                FRM-NUM-DMAV IN CCC-FLD(FRM-IFLD).
           MOVE DLC-NUM-MMAV IN DLC TO
                FRM-NUM-MMAV IN CCC-FLD(FRM-IFLD).
           MOVE DLC-NUM-SMAV IN DLC TO
                FRM-NUM-SMAV IN CCC-FLD(FRM-IFLD).
           MOVE DLC-NUM-AMAV IN DLC TO
                FRM-NUM-AMAV IN CCC-FLD(FRM-IFLD).

           MOVE RDC-KEY-IRDC IN RDC TO WSS-KEY-IRDC IN WSS-VARI.

           MOVE DLC-CIC-IOPC IN DLC TO RDC-CIC-IOPC IN RDC.

      * INI-VFP  9-JAN-1997 12:37:42 
      *    MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC.
           IF FRM-IND-TDEU IN CCC-FLD = 'D'
              MOVE DLC-NUM-IDLC IN DLC TO RDC-NUM-IDLC IN RDC
           ELSE
              MOVE ZEROES TO RDC-NUM-IDLC IN RDC.
      * FIN-VFP  9-JAN-1997 12:37:45 

           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF FIO-STAT-OKS
               MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO FRM-NUM-ACEP IN CCC-FLD(FRM-IFLD)
                   MOVE SPACES TO FRM-VRF-ACEP IN CCC-FLD(FRM-IFLD)
                   MOVE SPACES TO FRM-IND-ACEP IN CCC-FLD(FRM-IFLD)
                   MOVE SPACES TO FRM-GLS-ACEP IN CCC-FLD(FRM-IFLD)
                   MOVE 'CLIENTE INEXISTENTE' TO
                        FRM-GLS-NOMC IN CCC-FLD(FRM-IFLD)
               ELSE
                   MOVE DBC-NUM-ICLI IN DBC TO
                        FRM-NUM-ACEP IN CCC-FLD(FRM-IFLD)
                   MOVE DBC-VRF-ICLI IN DBC TO
                        FRM-VRF-ACEP IN CCC-FLD(FRM-IFLD)
                   MOVE DBC-IND-ICLI IN DBC TO
                        FRM-IND-ACEP IN CCC-FLD(FRM-IFLD)
                   MOVE DBC-GLS-ICLI IN DBC TO
                        FRM-GLS-ACEP IN CCC-FLD(FRM-IFLD)
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO FRM-GLS-NOMC IN CCC-FLD(FRM-IFLD)
           ELSE
               MOVE SPACES TO FRM-NUM-ACEP IN CCC-FLD(FRM-IFLD)
               MOVE SPACES TO FRM-VRF-ACEP IN CCC-FLD(FRM-IFLD)
               MOVE SPACES TO FRM-IND-ACEP IN CCC-FLD(FRM-IFLD)
               MOVE SPACES TO FRM-GLS-ACEP IN CCC-FLD(FRM-IFLD)
               MOVE SPACES TO FRM-GLS-NOMC IN CCC-FLD(FRM-IFLD).

           MOVE WSS-KEY-IRDC IN WSS-VARI TO RDC-KEY-IRDC IN RDC.
           MOVE DBC-CAI-ICLI IN CCC-FLD  TO DBC-CAI-ICLI IN DBC.
           MOVE DBC-IIC-ICLI IN CCC-FLD  TO DBC-IIC-ICLI IN DBC.

       FIN-CARGAR-TABLA.
           EXIT.

       SEL-REG-CAR SECTION.
       INI-SEL-REG-CAR.
           MOVE DLC-CIC-IOPC IN DLC TO OPC-KEY-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO PFS-IDLC-SEL
               GO TO FIN-SEL-REG-CAR.

           IF FRM-COD-STAT IN CCC-FLD > SPACES AND
              OPC-MSC-STAT IN OPC NOT = FRM-COD-STAT IN CCC-FLD
               MOVE 'N' TO PFS-IDLC-SEL
               GO TO FIN-SEL-REG-CAR.
           IF FRM-COD-TOOC IN CCC-FLD > SPACES AND
              OPC-COD-TOOC IN OPC NOT = FRM-COD-TOOC IN CCC-FLD
               MOVE 'N' TO PFS-IDLC-SEL
               GO TO FIN-SEL-REG-CAR.
           IF FRM-COD-AOOC IN CCC-FLD > SPACES AND
              OPC-COD-AOOC IN OPC NOT = FRM-COD-AOOC IN CCC-FLD
               MOVE 'N' TO PFS-IDLC-SEL
               GO TO FIN-SEL-REG-CAR.
           IF FRM-COD-VCOC IN CCC-FLD > SPACES AND
              OPC-COD-VCOC IN OPC NOT = FRM-COD-VCOC IN CCC-FLD
               MOVE 'N' TO PFS-IDLC-SEL
               GO TO FIN-SEL-REG-CAR.
           IF FRM-FEC-FINI IN CCC-FLD > ZEROES
               MOVE FRM-NUM-DINI IN CCC-FLD TO WSS-NUM-DCM1
               MOVE FRM-NUM-MINI IN CCC-FLD TO WSS-NUM-MCM1
               MOVE FRM-NUM-SINI IN CCC-FLD TO WSS-NUM-SCM1
               MOVE FRM-NUM-AINI IN CCC-FLD TO WSS-NUM-ACM1
               IF OPC-FEC-FINP IN OPC < WSS-FEC-FCM1
                   MOVE 'N' TO PFS-IDLC-SEL
                   GO TO FIN-SEL-REG-CAR.
           IF FRM-FEC-FTER IN CCC-FLD > ZEROES
               MOVE FRM-NUM-DTER IN CCC-FLD TO WSS-NUM-DCM1
               MOVE FRM-NUM-MTER IN CCC-FLD TO WSS-NUM-MCM1
               MOVE FRM-NUM-STER IN CCC-FLD TO WSS-NUM-SCM1
               MOVE FRM-NUM-ATER IN CCC-FLD TO WSS-NUM-ACM1
               IF OPC-FEC-FINP IN OPC > WSS-FEC-FCM1
                   MOVE 'N' TO PFS-IDLC-SEL
                   GO TO FIN-SEL-REG-CAR.
       FIN-SEL-REG-CAR.
           EXIT.

       LIMPIAR-TABLA SECTION.
       INI-LIMPIAR-TABLA.
           MOVE SPACES TO FRM-CAI-IOPC IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-IIC-IOPC IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-NUM-IDLC IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-COD-COOC IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-NUM-ACEP IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-VRF-ACEP IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-IND-ACEP IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-ACEP IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-VAL-NDLC IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-FEC-FMAV IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-COD-OFOC IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-STAT IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-COD-NUNI IN CCC-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-NOMC IN CCC-FLD(FRM-IFLD).
       FIN-LIMPIAR-TABLA.
           EXIT.

       INIT-VARI SECTION.
       INI-INIT-VARI.
           MOVE 0 TO FRM-NUM-TDLC IN CCC-FLD.
           MOVE 0 TO FRM-VAL-TDLC IN CCC-FLD.
       FIN-INIT-VARI.
           EXIT.

       COPY COLBFDLC.
       COPY COLBFOPC.
       COPY COLBFRCE.
       COPY TABBFCAM.
       COPY TABBGTVC.
       COPY SGCBGCLI.
       COPY SGCBFDBC.
       COPY GNSBGSTR.
       COPY GNSBGCPT.
       COPY GNSBGPES.
       COPY GNSBBTAB.
      *>>>>
*% END
