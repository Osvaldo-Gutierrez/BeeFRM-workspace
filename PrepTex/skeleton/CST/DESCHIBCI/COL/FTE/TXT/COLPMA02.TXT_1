       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. COLPMA02.
       AUTHOR. BEE (OGB).
       DATE-WRITTEN. 14-02-2019 11:05:08.
      *
      * MICROSERVICIO PARA INGRESO DE BOLETAS DE GARANTIA
      * ENTRADA EN COPY COLWMA02.
      *
      *

       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.

       WORKING-STORAGE SECTION.
      *------------------------
       77 WSS-TAG-COLPMA02           PIC X(0125) VALUE
           '<IDNPGM NOM=$COLPMA02$ VSN=$01-00$ GEN=$16-01-2019$
      -    'TMS=$E29$ FNC=$1901_03$/>'.

       COPY GNSWGMCS.

       01  WSS-HDR-TIPC.
           03 WSS-HDR-TIPC-01                            PIC X(02).
           03 WSS-HDR-TIPC-02                            PIC X(03).

       77  WSS-CTE-P                VALUE 'P'            PIC X(01).
       77  WSS-CTE-PORC             VALUE '%'            PIC X(01).
       01  WSS-ROC-BKP              VALUE SPACES         PIC X(1030).
       01  WSS-12-04-08 VALUE SPACES.
           03 WSS-12-04-08-04                            PIC X(04).
           03 WSS-12-04-08-08                            PIC X(08).
       77  WSS-CTE-110     VALUE '110'                   PIC X(03).
       77  WSS-CTE-100     VALUE '100'                   PIC X(03).
       77  WSS-CTE-010     VALUE '010'                   PIC X(03).

       77  WSS-CTE-AUT     VALUE 'AUT'                   PIC X(03).
       77  WSS-CTE-S       VALUE 'S'                     PIC X(01).
       77  WSS-CTE-N       VALUE 'N'                     PIC X(01).

       77  WSS-TOT-DIA         VALUE ZEROS               PIC 9(05).

       77  WSS-NUM-RAUX VALUE ZEROES                     PIC 9(08).

       01  WSS-GLS-DATA-RAUX.
           03 WSS-GLS-DATA-RAUX-NUM                      PIC 9(08).
           03 WSS-GLS-DATA-RAUX-ALF                      PIC X(52).

       77  WSS-IDX-TR   VALUE  ZEROES                    PIC 9(03).
       77  WSS-IDX-SGS-PPT    VALUE ZEROES               PIC 9(03).
       77  WSS-SGS-PPT-ENC    VALUE 'N'                  PIC X(01).

       01  WSS-SGS-INP-TBL.
           03 WSS-SGS-INP-OCC       OCCURS 30 TIMES.
              05 WSS-SGS-INP-ELM                         PIC X(03).

       77  WSS-COD-TCYA-CTBL  VALUE 'CTBL '              PIC X(05).
       77  WSS-COD-TCYA-CCMA  VALUE 'CCMA '              PIC X(05).

       01  WSS-COD-PROD VALUE SPACES.
           03  WSS-COD-PROD-VCOC                         PIC X(06).
           03  WSS-COD-TIA.
               05  WSS-COD-PROD-TOOC                     PIC X(03).
               05  WSS-COD-PROD-AOOC                     PIC X(03).

       77  WSS-CTE-TCVE-CO      VALUE 'CO'               PIC X(02).
       77  WSS-CTE-TCVE-FO-O-CO VALUE 'FO'               PIC X(02).

      * Tasa Informada
       77  WSS-FRM-IND-TINT-I VALUE 'I'                  PIC X(01).
      * Tasa propuesta por ROC(RCC)
       77  WSS-FRM-IND-TINT-P VALUE 'P'                  PIC X(01).


      * Oblig(Informada INP /Asignada 1RA OPE )
       77  WSS-IND-TCYA-OBLI VALUE 'O'                   PIC X(01).
      * Contable[Simulacion]
       77  WSS-IND-TCYA-CTBL VALUE 'C'                   PIC X(01).


       01  WSS-ERR-SEND.
           03  WSS-ERR-SEND-PEND  VALUE '1'              PIC X(00001).
           03  WSS-ERR-SEND-STAT  VALUE '1'              PIC X(00001).
           03  WSS-ERR-SEND-MENS  VALUE SPACES           PIC X(01023).

       01  WSS-ERR-IND-TCYA.
           03  WSS-ERR-IND-TCYA-00
               VALUE 'CNCNA02COL000000000001'                PIC X(22).
           03  WSS-ERR-IND-TCYA-01                           PIC X(05).
           03  WSS-ERR-IND-TCYA-02                           PIC X(52)
               VALUE ' : Error en indicador de abono'.

       01  WSS-ERR-IND-TASA.
           03  WSS-ERR-IND-TASA-00
               VALUE 'CNCNA02COL000000000004'                PIC X(22).
           03  WSS-ERR-IND-TASA-01 VALUE 'Ind Tasa(I/P) '    PIC X(14).
           03  WSS-ERR-IND-TASA-02 VALUE SPACES              PIC X(01).
           03  WSS-ERR-IND-TASA-03 VALUE ' Erroneo'          PIC X(33).

       01  WSS-ERR-VAL-CRED.
           03  WSS-ERR-VAL-CRED-00
               VALUE 'CNCNA02COL000000000005'                PIC X(22).
           03  WSS-ERR-VAL-CRED-01 VALUE 'Monto Cred: '      PIC X(12).
           03  WSS-ERR-VAL-CRED-02                           PIC X(45).

       01      WSS-ERR-SGV-TINT.
           03  WSS-ERR-SGV-TINT-00
               VALUE 'CNCNA02COL000000000006'                PIC X(22).
           03  WSS-ERR-SGV-TINT-01 VALUE 'Tasa Inter : '     PIC X(13).
           03  WSS-ERR-SGV-TINT-02                           PIC X(44).

       01      WSS-ERR-NUM-VIGU.
           03  WSS-ERR-NUM-VIGU-00
               VALUE 'CNCNA02COL000000000007'                PIC X(22).
           03  WSS-ERR-NUM-VIGU-01 VALUE 'Tot Ven Vig : '    PIC X(14).
           03  WSS-ERR-NUM-VIGU-02                           PIC X(43).


       01      WSS-ERR-NUM-SPVE.
           03  WSS-ERR-NUM-SPVE-00
               VALUE 'CNCNA02COL000000000008'                PIC X(22).
           03  WSS-ERR-NUM-SPVE-01 VALUE 'Per 1er Ven : '    PIC X(16).
           03  WSS-ERR-NUM-SPVE-02                           PIC X(41).


       01      WSS-ERR-NUM-SEVE.
           03  WSS-ERR-NUM-SEVE-00
               VALUE 'CNCNA02COL000000000009'                PIC X(22).
           03  WSS-ERR-NUM-SEVE-01 VALUE 'Sep ent Ven : '    PIC X(14).
           03  WSS-ERR-NUM-SEVE-02                           PIC X(43).


       01  WSS-ERR-NUM-CMAX.
           03  WSS-ERR-NUM-CMAX-00
               VALUE 'CNCNA02COL000000000011'                PIC X(22).
           03  WSS-ERR-NUM-CMAX-01 VALUE 'M Curse : '        PIC X(10).
           03  WSS-ERR-NUM-CMAX-02         PIC           Z.ZZZ.ZZZ.ZZ9.
           03  WSS-ERR-NUM-CMAX-03 VALUE ' > Perm : '        PIC X(10).
           03  WSS-ERR-NUM-CMAX-04         PIC           Z.ZZZ.ZZZ.ZZ9.
           03  WSS-ERR-NUM-CMAX-05 VALUE ' <Poc>'            PIC X(11).


      * Diferencia de fechas con error
       01  WSS-ERR-FEC-DIFE.
           03  WSS-ERR-FEC-DIFE-00
               VALUE 'CNCNA02COL000000000012'                PIC X(22).
           03  WSS-ERR-FEC-DIFE-01 VALUE 'Dif Fec Err : '    PIC X(14).
           03  WSS-ERR-FEC-DIFE-02 VALUE SPACES              PIC X(08).
           03  WSS-ERR-FEC-DIFE-03 VALUE ' <> '              PIC X(04).
           03  WSS-ERR-FEC-DIFE-04 VALUE SPACES              PIC X(08).
           03  WSS-ERR-FEC-DIFE-05 VALUE SPACES              PIC X(01).
           03  WSS-ERR-FEC-DIFE-06 VALUE SPACES              PIC X(34).


       01      WSS-ERR-NUM-NUMT.
           03  WSS-ERR-NUM-NUMT-00
               VALUE 'CNCNA02COL000000000013'                PIC X(22).
           03  WSS-ERR-NUM-NUMT-01 VALUE 'Num Tel Ben : '    PIC X(14).
           03  WSS-ERR-NUM-NUMT-02                           PIC X(43).


       01      WSS-ERR-NUM-RUTB.
           03  WSS-ERR-NUM-RUTB-00
               VALUE 'CNCNA02COL000000000014'                PIC X(22).
           03  WSS-ERR-NUM-RUTB-01 VALUE 'Rut Benefi  : '    PIC X(14).
           03  WSS-ERR-NUM-RUTB-02                           PIC X(43).

       01      WSS-ERR-COD-TCLI.
           03  WSS-ERR-COD-TCLI-00
               VALUE 'CNCNA02COL000000000015'                PIC X(22).
           03  WSS-ERR-COD-TCLI-01 VALUE 'Tipo Benefi : '    PIC X(14).
           03  WSS-ERR-COD-TCLI-02                           PIC X(43).

       01      WSS-ERR-COD-CDOC.
           03  WSS-ERR-COD-CDOC-00
               VALUE 'CNCNA02COL000000000016'                PIC X(22).
           03  WSS-ERR-COD-CDOC-01 VALUE 'Destino Cre : '    PIC X(14).
           03  WSS-ERR-COD-CDOC-02                           PIC X(43).

       01      WSS-ERR-COD-SEGD.
           03  WSS-ERR-COD-SEGD-00
               VALUE 'CNCNA02COL000000000017'                PIC X(22).
           03  WSS-ERR-COD-SEGD-01 VALUE 'Cod. Seguro : '    PIC X(14).
           03  WSS-ERR-COD-SEGD-02                           PIC X(43).

       01      WSS-ERR-IND-CVTA.
           03  WSS-ERR-IND-CVTA-00
               VALUE 'CNCNA02COL000000000018'                PIC X(22).
           03  WSS-ERR-IND-CVTA-01 VALUE 'Canal Venta : '    PIC X(14).
           03  WSS-ERR-IND-CVTA-02                           PIC X(43).

       01      WSS-ERR-IND-GARA.
           03  WSS-ERR-IND-GARA-00
               VALUE 'CNCNA02COL000000000019'                PIC X(22).
           03  WSS-ERR-IND-GARA-01 VALUE 'Cond. Gtia  : '    PIC X(14).
           03  WSS-ERR-IND-GARA-02                           PIC X(43).

       01      WSS-ERR-COD-COMI.
           03  WSS-ERR-COD-COMI-00
               VALUE 'CNCNA02COL000000000020'                PIC X(22).
           03  WSS-ERR-COD-COMI-01 VALUE 'Comision    : '    PIC X(14).
           03  WSS-ERR-COD-COMI-02                           PIC X(43).

       01      WSS-ERR-NUM-SEOB.
           03  WSS-ERR-NUM-SEOB-00
               VALUE 'CNCNA02COL000000000021'                PIC X(22).
           03  WSS-ERR-NUM-SEOB-01 VALUE 'Estruct Ven : '    PIC X(14).
           03  WSS-ERR-NUM-SEOB-02                           PIC X(43).

       01      WSS-ERR-VAL-GNOT.
           03  WSS-ERR-VAL-GNOT-00
               VALUE 'CNCNA02COL000000000022'                PIC X(22).
           03  WSS-ERR-VAL-GNOT-01 VALUE 'Gastos Nota : '    PIC X(14).
           03  WSS-ERR-VAL-GNOT-02                           PIC X(43).

       01      WSS-ERR-VAL-DVEN.
           03  WSS-ERR-VAL-DVEN-00
               VALUE 'CNCNA02COL000000000023'                PIC X(22).
           03  WSS-ERR-VAL-DVEN-01 VALUE 'Dia de Vcto : '    PIC X(14).
           03  WSS-ERR-VAL-DVEN-02                           PIC X(43).

       01      WSS-ERR-NUM-SEV2.
           03  WSS-ERR-NUM-SEV2-00
               VALUE 'CNCNA02COL000000000024'                PIC X(22).
           03  WSS-ERR-NUM-SEV2-01 VALUE 'Sep Vctos   : '    PIC X(14).
           03  WSS-ERR-NUM-SEV2-02                           PIC X(43).

       01      WSS-ERR-ENT-TOC.
           03  WSS-ERR-ENT-TOC-00
               VALUE 'CNCNA02COL000000000025'                PIC X(22).
           03  WSS-ERR-ENT-TOC-01  VALUE 'Tipo Opera. : '    PIC X(14).
           03  WSS-ERR-ENT-TOC-02                            PIC X(43).

       01      WSS-ERR-COD-NOBL.
           03  WSS-ERR-COD-NOBL-00
               VALUE 'CNCNA02COL000000000026'                PIC X(22).
           03  WSS-ERR-COD-NOBL-01  VALUE 'Tipo Opera. : '   PIC X(14).
           03  WSS-ERR-COD-NOBL-02                           PIC X(43).

       01      WSS-ERR-MC2-SEGU.
           03  WSS-ERR-MC2-SEGU-00
               VALUE 'CNCNA02COL000000000027'                PIC X(22).
           03  WSS-ERR-MC2-SEGU-01  VALUE 'Seguros     : '   PIC X(14).
           03  WSS-ERR-MC2-SEGU-02                           PIC X(43).

       01      WSS-ERR-POC-SEGU.
           03  WSS-ERR-POC-SEGU-00
               VALUE 'CNCNA02COL000000000028'                PIC X(22).
           03  WSS-ERR-POC-SEGU-01  VALUE 'Seguros     : '   PIC X(14).
           03  WSS-ERR-POC-SEGU-02                           PIC X(43).

           

       77  WSS-POC-VAL-CMAX        COMP-3          PIC 9(11)V9(04).

       01  WSS-QUE-TR-COLA VALUE SPACES.
           03 WSS-QUE-TR-COLA-02                         PIC X(02).
           03 WSS-QUE-TR-COLA-06                         PIC X(06).
       77  WSS-ITEM-SEGM      VALUE ZEROES            PIC 9(03).

       01  WSS-TR.
           03  WSS-TR-COD-SGMT                             PIC X(00001).
           03  WSS-TR-COD-DATA                             PIC X(01024).

       COPY GNSWGSEG.
       COPY GNSWGHOY.
       COPY GNSWGTSK.
       COPY GNSWGPFG.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGSYS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGQUE.
       COPY GNSWGFRM.
       COPY GNSWVSCR.
       COPY GNSWGMX1.
       COPY GNSWGRQA.
       COPY GNSBRTAB.
       COPY GNSWVIDD.
       COPY GNSBRMSG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGELS.
       COPY GNSWGUIB.

       COPY GNSWGAMB.
       COPY GNSWGCVT.
       COPY GNSWCSXI.
       COPY GNSWGMXX.
       COPY GNSWGFEC.

       COPY COLMWA02.
       COPY COLMW120.

       COPY COLMW046.
       COPY COLMW013.
       COPY COLMW016.
       COPY COLMW101.
       COPY COLMW032.

      * ROC-INI
       COPY TABBRUSR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABWGRCC.
       COPY TABWGSGS.
       COPY SGCWGBCC.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY SGCBROPE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY SGCBRRCO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
      * ROC-FIN

      *>>>>> GNP-INI


       77  WSS-IDX-IROC       VALUE ZEROES            PIC 9(03).

       COPY COLWGGNP.
       COPY COLWXGNP.
       COPY COLBRTOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY COLBRPOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY COLBRPVC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PVC-REQA==.

       01 WCC-CONSTANTES.
          03 WCC-1            VALUE 1                  PIC 9(01).
          03 WCC-4            VALUE 4                  PIC 9(01).
          03 WCC-0            VALUE 0                  PIC 9(01).
          03 WCC-12           VALUE 12                 PIC 9(02).
          03 WCC-59           VALUE 59                 PIC 9(02).
          03 WCC-60           VALUE 60                 PIC 9(02).
          03 WCC-19           VALUE 19                 PIC 9(02).
          03 WCC-20           VALUE 20                 PIC 9(02).
          03 WCC-100          VALUE 100                PIC 9(03).
          03 WCC-080000       VALUE 080000             PIC 9(06).
          03 WCC-200000       VALUE 200000             PIC 9(06).
          03 WCC-3C           VALUE '3'                PIC X(01).
          03 WCC-1C           VALUE '1'                PIC X(01).
          03 WCC-K            VALUE 'K'                PIC X(01).
          03 WCC-B            VALUE 'B'                PIC X(01).
          03 WCC-D            VALUE 'D'                PIC X(01).
          03 WCC-M            VALUE 'M'                PIC X(01).
          03 WCC-A            VALUE 'A'                PIC X(01).
          03 WCC-N            VALUE 'N'                PIC X(01).
          03 WCC-S            VALUE 'S'                PIC X(01).
          03 WCC-Y            VALUE 'Y'                PIC X(01).
          03 WCC-P            VALUE 'P'                PIC X(01).
          03 WCC-E            VALUE 'E'                PIC X(01).
          03 WCC-TR           VALUE 'TR'               PIC X(02).
          03 WCC-002          VALUE '002'              PIC X(03).
          03 WCC-046          VALUE '046'              PIC X(03).
          03 WCC-013          VALUE '013'              PIC X(03).
          03 WCC-016          VALUE '016'              PIC X(03).
          03 WCC-032          VALUE '032'              PIC X(03).
          03 WCC-120          VALUE '120'              PIC X(03).
          03 WCC-101          VALUE '101'              PIC X(03).
          03 WCC-VIS          VALUE 'VIS'              PIC X(03).
          03 WCC-INF          VALUE 'INF'              PIC X(03).
          03 WCC-CON          VALUE 'CON'              PIC X(03).
          03 WCC-CUR          VALUE 'CUR'              PIC X(03).
          03 WCC-CGN          VALUE 'CGN'              PIC X(03).
          03 WCC-SGS          VALUE 'SGS'              PIC X(03).
          03 WCC-CCM          VALUE 'CCM'              PIC X(03).
          03 WCC-EMI          VALUE 'EMI'              PIC X(03).
          03 WCC-PPC          VALUE 'PPC'              PIC X(03).
          03 WCC-DBC          VALUE 'DBC'              PIC X(03).
          03 WCC-INT          VALUE 'INT'              PIC X(03).
          03 WCC-DCB          VALUE 'DCB'              PIC X(03).
          03 WCC-GNS          VALUE 'GNS'              PIC X(03).
          03 WCC-BNF          VALUE 'BNF'              PIC X(03).
          03 WCC-CAP          VALUE 'CAP'              PIC X(03).
          03 WCC-GIDD         VALUE 'GIDD'             PIC X(04).
          03 WCC-PRECIO       VALUE 'PRECIO'           PIC X(06).
          03 WCC-TABPSRCC     VALUE 'TABPSRCC'         PIC X(08).
          03 WCC-COLPPTPG     VALUE 'COLPPTPG'         PIC X(08).
          03 WCC-COLPMA02     VALUE 'COLPMA02'         PIC X(08).
          03 WCC-GNSPPIDD     VALUE 'GNSPPIDD'         PIC X(08).
          03 WCC-USRCODUSER   VALUE 'USR-COD-USER'     PIC X(12).
          03 WCC-PPCG         VALUE ' <Ppc>'           PIC X(06).
          03 WCC-MSG01                                 PIC X(24)
             VALUE ' No es Persona o Empresa'.
          03 WCC-MSG02                                 PIC X(29)
             VALUE 'Destino Credito No Encontrado' .
          03 WCC-MSG03                                 PIC X(39)
             VALUE 'Codigo Seguro Desgravamen No Encontrado'.
          03 WCC-MSG04                                 PIC X(28)
             VALUE 'Canal de Venta No Encontrado' .
          03 WCC-MSG05                                 PIC X(32)
             VALUE 'Condicion Garantia No Encontrada' .
          03 WCC-MSG06                                 PIC X(37)
             VALUE 'No Existe Tabla de Dia de Vencimiento' .
          03 WCC-MSG07                                 PIC X(37)
             VALUE 'Producto Inexistente' .
          03 WCC-MSG08                                 PIC X(34)
             VALUE 'Plantilla Vencimientos Inexistente'.
          03 WCC-MSG09                                 PIC X(41)
             VALUE 'Separacion Entre Vencimientos Obligatorio'.
          03 WCC-MSG10                                 PIC X(41)
             VALUE 'No existe tabla TOC (validacion producto)'.
          03 WCC-MSG11                                 PIC X(36)
             VALUE 'Tipo operacion no operac como boleta'.
          03 WCC-MSG12                                 PIC X(44)
             VALUE 'Seguro en Plantilla de Producto no es PRECIO'.

       01  WSS-VARI.
           03 WSS-SGS-INP-TOT      VALUE ZEROES       PIC 9(03).
           03 WSS-PZO-CRED         VALUE ZEROES       PIC 9(03).
           03 WSS-X                VALUE ZEROES       PIC 9(03).
           03 WSS-IND-RESP         VALUE ZEROES       PIC 9(03).
           03 WSS-NUM-PZOB         VALUE ZEROES       PIC 9(05).
           03 WSS-IND-SPER         VALUE SPACES       PIC X(01).
           03 WSS-BGT-DIA-VEN      VALUE SPACES       PIC X(02).
           03 WSS-BGT-DIA-VEN-NUM REDEFINES
                                  WSS-BGT-DIA-VEN     PIC 9(02).
           03 WSS-FEC-FVEN.
               05  WSS-NUM-DVEN                       PIC 9(02).
               05  WSS-NUM-MVEN                       PIC 9(02).
               05  WSS-NUM-SVEN                       PIC 9(02).
               05  WSS-NUM-AVEN                       PIC 9(02).

           03 WSS-FEC-FPVN.
               05  WSS-NUM-DPVN                       PIC 9(02).
               05  WSS-NUM-MPVN                       PIC 9(02).
               05  WSS-NUM-SPVN                       PIC 9(02).
               05  WSS-NUM-APVN                       PIC 9(02).

       01 WSS-ROC-COD-TINT.
           03  WSS-ROC-COD-TIPT.
               05  WSS-ROC-MSC-BCTI                   PIC X(01).
               05  WSS-ROC-MSC-PBTI                   PIC X(01).
               05  WSS-ROC-MSC-MCTI.
                   07  WSS-ROC-MSC-BPBT               PIC X(01).
                   07  WSS-ROC-MSC-SPBT               PIC X(01).
               05  WSS-ROC-COD-CVTI                   PIC X(03).
               05  WSS-ROC-MSC-TFPR                   PIC X(01).
               05  WSS-ROC-NUM-PREP                   PIC 9(03).
               05  WSS-ROC-MSC-UTPR                   PIC X(01).

      *
      *C Vnta             (posicion  1, largo 1 )
      *Cond Gtia          (posicion  2, largo 3 )
      *Destino Cred       (posicion  5, largo 3 )
      *Periodo entre Vcto (posicion 11, largo 3 )
      *Periodo entre Vcto (posicion 14, largo 1 )
      *DLC Codigo Pago    (posicion 15, largo 3 )
      *Cod Seguro         (posicion 20, largo 6 )
      *Cod Notaria        (posicion 26, largo 6 )
      *Gastos Notaria     (posicion 32, largo 15)

       01  WSS-GLS-A02-BGT.
           03  WSS-A02-IND-CVTA   VALUE SPACES        PIC X(01).
           03  WSS-A02-IND-GARA   VALUE SPACES        PIC X(03).
           03  WSS-A02-COD-CDOC   VALUE SPACES        PIC X(03).
           03  FILLER                                 PIC X(03).
           03  WSS-A02-NUM-SEVE   VALUE SPACES        PIC X(03).
           03  WSS-A02-NUM-SEVE-NUM REDEFINES
                   WSS-A02-NUM-SEVE                   PIC 9(03).
           03  WSS-A02-NOP-IND-UTSV VALUE SPACES      PIC X(01).
           03  WSS-A02-COD-PAGO   VALUE SPACES        PIC X(03).
           03  FILLER                                 PIC X(02).
           03  WSS-A02-COD-SEGU   VALUE SPACES        PIC X(06).
           03  WSS-A02-COD-NOTC   VALUE SPACES        PIC X(06).
           03  WSS-A02-VAL-GNOT   VALUE ZEROES        PIC 9(11)V9(04).
      *

           03 WSS-NITM                                PIC 9(02).
           03 WSS-NITMMAX VALUE 10                    PIC 9(02).
           03  WSS-FEC-FMAX.
               05  WSS-NUM-SMAX                      PIC 9(02).
               05  WSS-NUM-AMAX                      PIC 9(02).
               05  WSS-NUM-MMAX                      PIC 9(02).
               05  WSS-NUM-DMAX                      PIC 9(02).
           03  WSS-FEC-FTMP.
               05  WSS-NUM-STMP                      PIC 9(02).
               05  WSS-NUM-ATMP                      PIC 9(02).
               05  WSS-NUM-MTMP                      PIC 9(02).
               05  WSS-NUM-DTMP                      PIC 9(02).

       01  WSS-FEC-FDMA.
           03 WSS-NUM-DDMA                           PIC 9(02).
           03 WSS-NUM-MDMA                           PIC 9(02).
           03 WSS-NUM-SDMA                           PIC 9(02).
           03 WSS-NUM-ADMA                           PIC 9(02).

       01  WSS-FEC-FAMD.
           03 WSS-NUM-SAMD                           PIC 9(02).
           03 WSS-NUM-AAMD                           PIC 9(02).
           03 WSS-NUM-MAMD                           PIC 9(02).
           03 WSS-NUM-DAMD                           PIC 9(02).

      *>>>>> GNP-FIN

      *
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                                  PIC X(3000).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.

      * RECIBO IDENTIFICACION DEL PC QUE ENVIO EL MSG.

           MOVE DFHCOMMAREA(1:EIBCALEN) TO MCS-CMA-COD-SREQ.

           MOVE MCS-CMA-COD-PT-MCS      TO PT-A02.

           PERFORM GNS-ERR-QUE.

           PERFORM GET-FHOY.

           PERFORM GET-TSK-TERM.

           PERFORM CRG-IDD.

           MOVE MCS-CMA-COD-COLA TO WSS-QUE-TR-COLA.
           MOVE WCC-TR           TO WSS-QUE-TR-COLA-02.

           MOVE WCC-GIDD     TO RCC-QUEU.
           MOVE TSK-TERM-ALF TO RCC-TERM.

           MOVE RCC-QIDD TO QUE-COLA.
           MOVE +490     TO QUE-LITM.
           MOVE WCC-1    TO QUE-NITM.
           MOVE QUE-GET  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
                 MOVE RCC-QIDD TO QUE-COLA
                 MOVE +490 TO QUE-LITM
                 MOVE IDD-REGI TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 PERFORM GNS-PRO-QUE.

           PERFORM GNS-ERR-QUE.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE SCR-NOM-TCPIP TO  WSS-PTR-GLS-COLA.

           MOVE SCR-NOM-TCPIP TO WSS-PTR-COD-TYPE.

           MOVE SPACES TO WSS-ERR-SEND-MENS.

      *VALIDA PARAMETROS DE ENTRADA
      *---------------------------------
           PERFORM VALIDACIONES.
           IF WSS-ERR-SEND-MENS > SPACES
              GO TO FIN-MAIN.

      *CARGA PARAMETRIA
      *---------------------------------
           PERFORM CARGA-PARAMETRIA.
           IF WSS-ERR-SEND-MENS > SPACES
              GO TO FIN-MAIN.

      *VALIDA PARAMETROS DE TABLAS LEIDAS
      *----------------------------------
           PERFORM VALIDA-PARAMETROS-TABLAS.
           IF WSS-ERR-SEND-MENS > SPACES
              GO TO FIN-MAIN.

      *CALCULA PRIMER VEN EVC INTERESES.
      *---------------------------------
           PERFORM 1ER-VEN-EVC-INT.
           IF WSS-ERR-SEND-MENS > SPACES
              GO TO FIN-MAIN.


      *BUSCA CUENTA DEL CLIENTE
      *---------------------------------
           PERFORM BUS-CTA-CLTE.
           IF WSS-ERR-SEND-MENS > SPACES
              GO TO FIN-MAIN.

           MOVE PT-046-02-CYA-CAI-ICYA TO PT-046-02-AUT-CAI-ICYA.
           MOVE PT-046-02-CYA-IIC-ICYA TO PT-046-02-AUT-IIC-ICYA.
           IF PT-046-02-AUT-IIC-ICYA-NUM > ZEROES
                 MOVE WSS-CTE-AUT   TO PT-046-02-AUT-NUM-ICAN
                 MOVE WSS-CTE-S     TO PT-046-02-AUT-MSC-STAT.

           IF PT-A02-01-OPC-COD-OFOC NOT > SPACES
                MOVE DBC-COD-OFIC IN DBC TO PT-A02-01-OPC-COD-OFOC.

      *LEE POC
           MOVE PT-A02-01-OPC-COD-VCOC TO POC-COD-VCOC IN POC.
           MOVE PT-A02-01-OPC-COD-TOOC TO POC-COD-TOOC IN POC.
           MOVE PT-A02-01-OPC-COD-AOOC TO POC-COD-AOOC IN POC.
           MOVE ZEROES                 TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WCC-MSG07 TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-MAIN.

           MOVE  POC-VAL-CMAX IN POC TO WSS-POC-VAL-CMAX.

      *LEE SEGUROS DESDE ENTRADA (A02)
      *---------------------------------
           PERFORM LEE-SEGUROS-A02.
           IF WSS-ERR-SEND-MENS > SPACES
              GO TO FIN-MAIN.

      *GENERA COLAS PARA EL INGRESO DE ENTIDADES
      *------------------------------------------
           PERFORM FORM-REQS.


       FIN-MAIN.

           EXEC CICS RETURN END-EXEC.
       EXT-MAIN.
           EXIT.


       FORM-REQS SECTION.
       INI-FORM-REQS.
           MOVE ZEROES TO WSS-ITEM-SEGM.


       CIC-FORM-REQS.

           ADD WCC-1 TO WSS-ITEM-SEGM.

      *>>>>>>>>>>>>>>>>>>    046   >>>>>>>>>>>>>>>>>>>>>>>>

           MOVE WCC-K TO WSS-TR-COD-SGMT.

           MOVE PT-A02-AHDR            TO PT-046-AHDR.
           MOVE WCC-046                TO PT-046-CREQ.
           MOVE PT-A02-01-OPC-COD-VCOC TO PT-046-01-OPC-COD-VCOC.
           MOVE PT-A02-01-OPC-COD-TOOC TO PT-046-01-OPC-COD-TOOC.
           MOVE PT-A02-01-OPC-COD-AOOC TO PT-046-01-OPC-COD-AOOC.
           MOVE PT-A02-01-OPC-COD-OFOC TO PT-046-02-OPC-COD-OFOC.
           MOVE PT-A02-01-DBC-NUM-ICLI TO PT-046-02-DBC-NUM-ICLI.
           MOVE PT-A02-01-DBC-VRF-ICLI TO PT-046-02-DBC-VRF-ICLI.
           MOVE PT-A02-01-DBC-IND-ICLI TO PT-046-02-DBC-IND-ICLI.
           MOVE PT-A02-01-DBC-GLS-ICLI TO PT-046-02-DBC-GLS-ICLI.

           PERFORM PRO-24H-INP.

           MOVE PT-A02-01-NOP-FEC-FCUR TO PT-046-02-OPC-FEC-FCOL.

           MOVE PT-A02-01-OPC-VAL-CRED
                                       TO PT-046-02-OPC-VAL-CRED.

           MOVE PT-A02-01-ITR-SGV-TINT TO PT-046-02-ITR-SGV-TINT.

           MOVE PT-A02-01-OPC-COD-RMOC TO PT-046-02-OPC-COD-RMOC.

           MOVE WSS-A02-COD-SEGU       TO PT-046-02-OPC-COD-SEGD.

           MOVE WSS-A02-IND-CVTA TO PT-046-02-OPC-COD-CVTA.
           MOVE WSS-A02-IND-GARA TO PT-046-02-OPC-IND-GARA.
           MOVE WSS-A02-COD-CDOC TO PT-046-02-OPC-COD-CDOC.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-046 TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *>>>>>>>>>>>>>>>>>>    013   >>>>>>>>>>>>>>>>>>>>>>>>

      * DLC
           MOVE WCC-E TO WSS-TR-COD-SGMT.

           MOVE PT-A02-AHDR            TO PT-013-AHDR.
           MOVE WCC-013                TO PT-013-CREQ.

           MOVE WSS-A02-COD-PAGO       TO PT-013-02-DLC-COD-PAGO.

           IF WSS-A02-COD-NOTC > SPACES 
              MOVE WSS-A02-COD-NOTC   TO PT-013-02-DLC-COD-NOTC
              MOVE PT-A02-01-DLC-VAL-GNOT-NUM 
                                      TO PT-013-02-DLC-VAL-GNOT-NUM
           ELSE
              MOVE SPACES TO PT-013-02-DLC-COD-NOTC
              MOVE ZEROES TO PT-013-02-DLC-VAL-GNOT-NUM.

      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-013  TO WSS-TR-COD-DATA.
           MOVE WSS-TR  TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *>>>>>>>>>>>>>>>>>>    016-01-FO >>>>>>>>>>>>>>>>>>>>>>>>

      * EVC
           MOVE WCC-E TO WSS-TR-COD-SGMT.

           MOVE PT-A02-AHDR            TO PT-016-AHDR.
           MOVE WCC-016                TO PT-016-CREQ.

           MOVE PT-A02-01-NOP-NUM-VIGU TO PT-016-02-EVC-NUM-VIGU.
           MOVE PT-A02-01-NOP-NUM-SPVE TO PT-016-02-FRM-NUM-SPVE.
           MOVE PT-A02-01-NOP-IND-UTPV TO PT-016-02-FRM-IND-UTPV.
           MOVE PT-A02-01-NOP-NUM-SEVE TO PT-016-02-EVC-NUM-SEVE.
           MOVE PT-A02-01-NOP-IND-UTSV TO PT-016-02-EVC-IND-UTSV.
           MOVE PT-A02-01-NOP-FEC-FPVC TO PT-016-02-EVC-FEC-FPVC.
           MOVE PT-A02-01-NOP-FEC-FPVC(1:2) TO PT-016-02-EVC-NUM-DPVE.


           MOVE POC-COD-IPVC IN POC TO PVC-CIC-IPVC IN PVC
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM COL-FIO-PVC.

           IF PVC-MSC-TCVE IN PVC > SPACES
              MOVE PVC-MSC-TCVE IN PVC TO PT-016-02-EVC-MSC-TCVE.

           MOVE ZEROES               TO PT-016-02-EVC-VAL-VENC-NUM.
           MOVE WCC-1           TO PT-016-02-EVC-NUM-IDLC-NUM.

      *REVISA SI FECHA INTERESES ES < A FECHA VEN
      *SI NO ES, NO SE GRABA EVC DE INTERESES
           MOVE WSS-NUM-SVEN TO WSS-NUM-STMP.
           MOVE WSS-NUM-AVEN TO WSS-NUM-ATMP.
           MOVE WSS-NUM-MVEN TO WSS-NUM-MTMP.
           MOVE WSS-NUM-DVEN TO WSS-NUM-DTMP.

           MOVE PT-A02-01-NOP-FEC-FPVC TO WSS-FEC-FDMA.
           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD

           IF WSS-FEC-FAMD > WSS-FEC-FTMP
              GO TO CON-EVC-01.

      * GRABA EVC INTERESES
           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-016             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       CON-EVC-01.
      *GRABA EVC CAPITAL

           MOVE WCC-1                TO PT-016-02-EVC-NUM-VIGU.
           MOVE ZEROES               TO PT-016-02-EVC-NUM-SEVE.
           MOVE SPACES               TO PT-016-02-EVC-IND-UTSV.
           MOVE WSS-FEC-FVEN         TO PT-016-02-EVC-FEC-FPVC.
           MOVE WSS-FEC-FVEN(1:2)    TO PT-016-02-EVC-NUM-DPVE.
           MOVE PT-A02-01-OPC-VAL-CRED-NUM
                                     TO PT-016-02-EVC-VAL-VENC-NUM.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-016             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *>>>>>>>>>>>>>>>>>>    016-nn-NP >>>>>>>>>>>>>>>>>>>>>>>>

       CIC-GNP.

      *>>>>>>>>>>>>>>>>>>    CEN 120   >>>>>>>>>>>>>>>>>>>>>>>>

      *CEN BNF
           MOVE WCC-E TO WSS-TR-COD-SGMT.

           MOVE SPACES                 TO PT-120.
           MOVE PT-A02-AHDR            TO PT-120-AHDR.
           MOVE WCC-120                TO PT-120-CREQ.

           MOVE WCC-BNF                TO PT-120-01-CEN-COD-ENTI.
           MOVE ZEROES                 TO PT-120-01-CEN-FEC-FENT.
           MOVE SPACES                 TO PT-120-01-CEN-COD-CREN.
           MOVE SPACES                 TO PT-120-01-CEN-COD-SREN.
           MOVE WCC-1                  TO PT-120-01-CEN-NUM-IENT-NUM.
           MOVE WCC-DBC                TO PT-120-01-CEN-COD-CCSE.
           MOVE SPACES                 TO PT-120-01-CEN-CAI-ISEN.
           MOVE SPACES                 TO PT-120-01-CEN-IIC-ISEN.
           MOVE ZEROES                 TO PT-120-01-CEN-NUM-ISEN.
           MOVE PT-A02-01-A02-NUM-ICLI TO PT-120-01-FRM-NUM-ICLI.
           MOVE PT-A02-01-A02-VRF-ICLI TO PT-120-01-FRM-VRF-ICLI.
           MOVE SPACES                 TO PT-120-01-FRM-GLS-ICLI.
           MOVE SPACES                 TO PT-120-02-CEN-MSC-STAT.
           MOVE SPACES                 TO PT-120-02-CEN-COD-TOPR.
           MOVE SPACES                 TO PT-120-02-CEN-COD-AOPR.
           MOVE SPACES                 TO PT-120-02-CEN-COD-VCAM.
           MOVE PT-A02-01-A02-GLS-COD1 TO PT-120-02-CEN-COD-COD1.
           MOVE PT-A02-01-A02-COD-TCLI TO PT-120-02-CEN-IND-IND1.
           MOVE PT-A02-01-A02-COD-TBNF TO PT-120-02-CEN-COD-COD2.
           MOVE SPACES                 TO PT-120-02-CEN-IND-IND2.
           MOVE SPACES                 TO PT-120-02-CEN-COD-COD3.
           MOVE SPACES                 TO PT-120-02-CEN-IND-IND3.
           MOVE SPACES                 TO PT-120-02-CEN-COD-COD4.
           MOVE SPACES                 TO PT-120-02-CEN-IND-IND4.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE1.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE2.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE3.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE4.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE5.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE6.
           MOVE ZEROES                 TO PT-120-02-CEN-SGV-VAL1-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-NUM-CON1-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-SGV-POR1-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-SGV-VAL2-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-NUM-CON2-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-SGV-POR2-NUM.
           MOVE PT-A02-01-A02-GLS-NOM1 TO PT-120-02-CEN-GLS-GLS1.
           MOVE PT-A02-01-A02-GLS-NOM2 TO PT-120-02-CEN-GLS-GLS2.
           MOVE PT-A02-01-A02-GLS-COD1 TO PT-120-02-CEN-GLS-GLS3.
           MOVE PT-A02-01-A02-GLS-EMAL TO PT-120-02-CEN-GLS-GLS4.

      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-120  TO WSS-TR-COD-DATA.
           MOVE WSS-TR  TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *CEN DCB
           MOVE WCC-E TO WSS-TR-COD-SGMT.

           MOVE SPACES                 TO PT-120.
           MOVE PT-A02-AHDR            TO PT-120-AHDR.
           MOVE WCC-120                TO PT-120-CREQ.

           MOVE WCC-DCB                TO PT-120-01-CEN-COD-ENTI.
           MOVE ZEROES                 TO PT-120-01-CEN-FEC-FENT.
           MOVE SPACES                 TO PT-120-01-CEN-COD-CREN.
           MOVE SPACES                 TO PT-120-01-CEN-COD-SREN.
           MOVE WCC-1                  TO PT-120-01-CEN-NUM-IENT-NUM.
           MOVE WCC-DBC                TO PT-120-01-CEN-COD-CCSE.
           MOVE SPACES                 TO PT-120-01-CEN-CAI-ISEN.
           MOVE SPACES                 TO PT-120-01-CEN-IIC-ISEN.
           MOVE ZEROES                 TO PT-120-01-CEN-NUM-ISEN.
           MOVE PT-A02-01-DBC-NUM-ICLI TO PT-120-01-FRM-NUM-ICLI.
           MOVE PT-A02-01-DBC-VRF-ICLI TO PT-120-01-FRM-VRF-ICLI.
           MOVE PT-A02-01-DBC-IND-ICLI TO PT-120-01-FRM-IND-ICLI.
           MOVE PT-A02-01-DBC-GLS-ICLI TO PT-120-01-FRM-GLS-ICLI.
           MOVE SPACES                 TO PT-120-02-CEN-MSC-STAT.
           MOVE SPACES                 TO PT-120-02-CEN-COD-TOPR.
           MOVE SPACES                 TO PT-120-02-CEN-COD-AOPR.
           MOVE SPACES                 TO PT-120-02-CEN-COD-VCAM.
           MOVE SPACES                 TO PT-120-02-CEN-COD-COD1.
           MOVE SPACES                 TO PT-120-02-CEN-IND-IND1.
           MOVE SPACES                 TO PT-120-02-CEN-COD-COD2.
           MOVE SPACES                 TO PT-120-02-CEN-IND-IND2.
           MOVE SPACES                 TO PT-120-02-CEN-COD-COD3.
           MOVE SPACES                 TO PT-120-02-CEN-IND-IND3.
           MOVE SPACES                 TO PT-120-02-CEN-COD-COD4.
           MOVE SPACES                 TO PT-120-02-CEN-IND-IND4.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE1.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE2.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE3.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE4.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE5.
           MOVE ZEROES                 TO PT-120-02-CEN-FEC-FFE6.
           MOVE ZEROES                 TO PT-120-02-CEN-SGV-VAL1-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-NUM-CON1-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-SGV-POR1-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-SGV-VAL2-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-NUM-CON2-NUM.
           MOVE ZEROES                 TO PT-120-02-CEN-SGV-POR2-NUM.
           MOVE PT-A02-01-A02-GLS-GLS1 TO PT-120-02-CEN-GLS-GLS1.
           MOVE PT-A02-01-A02-GLS-GLS2 TO PT-120-02-CEN-GLS-GLS2.
           MOVE PT-A02-01-A02-GLS-GLS3 TO PT-120-02-CEN-GLS-GLS3.
           MOVE PT-A02-01-A02-GLS-GLS4 TO PT-120-02-CEN-GLS-GLS4.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-120  TO WSS-TR-COD-DATA.
           MOVE WSS-TR  TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *>>>>>>>>>>>>>>>>>>    ROC    >>>>>>>>>>>>>>>>>>>>>>>>
      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = CGN >>>>>>>>>>>>>>>>>>>>
           IF WSS-A02-COD-NOTC = WCC-PRECIO
              PERFORM CON-MC2-CGN
              IF WSS-ERR-SEND-MENS > SPACES
                 GO TO FIN-FORM-REQS.

      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = CCM >>>>>>>>>>>>>>>>>>>>
           PERFORM CON-MC2-CCM.
           IF WSS-ERR-SEND-MENS > SPACES
              GO TO FIN-FORM-REQS.

      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = SGS >>>>>>>>>>>>>>>>>>>>
           IF WSS-A02-COD-SEGU = WCC-PRECIO
              PERFORM CON-MC2-SGS
              IF WSS-ERR-SEND-MENS > SPACES
                 GO TO FIN-FORM-REQS.

      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = INT >>>>>>>>>>>>>>>>>>>>
       INI-ROC-INT.

           IF PT-A02-01-ITR-SGV-TINT-NUM > ZEROES
              GO TO FIN-ROC.

           MOVE SPACES TO PT-101.

           MOVE WCC-E TO WSS-TR-COD-SGMT

           MOVE PT-A02-AHDR            TO PT-101-AHDR
           MOVE WCC-101                TO PT-101-CREQ

           MOVE SPACES         TO RCC-CIC-IOPE IN RCC-VARI.
           MOVE SPACES         TO RCC-IDC-ICLI IN RCC-VARI.

           MOVE PT-A02-01-DBC-NUM-ICLI TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-VRF-ICLI TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-IND-ICLI TO RCC-IND-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-GLS-ICLI TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE SPACES                 TO RCC-IND-RTBL IN RCC-VARI.
           MOVE ZEROES                 TO RCC-IND-COMP IN RCC-VARI.
           MOVE PT-A02-AHDR            TO WSS-HDR.

      *    MOVE '110'                  TO RCC-COD-TCNL IN RCC-VARI.
           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.
           MOVE WSS-HDR-TIPC-02        TO RCC-COD-TCNL IN RCC-VARI.

           MOVE SPACES                 TO RCC-COD-CNAL IN RCC-VARI.

           IF RCC-COD-TCNL IN RCC-VARI = WSS-CTE-110
                MOVE ZEROES TO RCC-COD-CNAL IN RCC-VARI
           ELSE
                MOVE WSS-CTE-010 TO RCC-COD-TCNL IN RCC-VARI
                MOVE PT-A02-01-OPC-COD-OFOC TO
                            RCC-COD-CNAL IN RCC-VARI.

           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-TOOC TO RCC-COD-TOOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-AOOC TO RCC-COD-AOOC IN RCC-VARI.
           MOVE WSS-TOT-DIA            TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE WCC-D                  TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE WCC-CUR                TO RCC-COD-EVEN IN RCC-VARI.
           MOVE WCC-INT                TO RCC-COD-CPTO IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-TCAR IN RCC-VARI.
           MOVE PT-A02-01-OPC-VAL-CRED-NUM TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCMO IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-VSOP IN RCC-VARI.
           MOVE PT-A02-01-NOP-NUM-VIGU-NUM TO RCC-VAL-FINA IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCFN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-INTE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-VASG IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCVA IN RCC-VARI.


           MOVE PT-A02-01-NOP-FEC-FCUR TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FCOL IN RCC-VARI.


           MOVE WSS-FEC-FVEN TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FVEN IN RCC-VARI.


           MOVE WCC-CON                TO RCC-COD-TCON IN RCC-VARI.
           MOVE WCC-S                  TO RCC-OFRM-SRV IN RCC-VARI.
           MOVE FIO-MSFL               TO RCC-MSFL     IN RCC-VARI.


           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE +490       TO RCC-LIDD.

           MOVE RCC-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
      *     LINK TABPSRCC RCC-COD-CPTO = INT
           MOVE WCC-TABPSRCC TO SYS-PROG.
           MOVE RCC-TCMA   TO SYS-TCMA.

           PERFORM GNS-PRO-SYS.

           MOVE SYS-CMMA TO RCC-CMMA.
           MOVE RCC-MSFL TO FIO-MSFL.

           MOVE ZEROES TO QUE-NITM.

       CIC-ROC-INT-QUE.

           ADD WCC-1 TO QUE-NITM.

           MOVE ZEROES TO WSS-IDX-IROC.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.

           MOVE QUE-GET TO QUE-CMND.
           MOVE RCC-LEN-TSSGS TO QUE-LITM.
           PERFORM GNS-PRO-QUE.

           IF QUE-STAT NOT = QUE-STAT-OKS
               GO TO FIN-ROC.

           MOVE QUE-ITEM TO OSG-APL-VEC IN OSG-VARI(1).

       CIC-ROC-INT-OCC.

           ADD WCC-1 TO WSS-IDX-IROC.

           IF OSG-SGS-COD-SIST IN OSG-VARI(WSS-IDX-IROC) NOT > SPACES
               GO TO CIC-ROC-INT-QUE.
               
           IF OSG-SGS-COD-CPTO IN OSG-VARI(WSS-IDX-IROC) = WCC-CAP
               GO TO CIC-ROC-INT-OCC.
           
           MOVE SPACES TO PT-101.
           MOVE PT-A02-AHDR TO PT-101-AHDR.
           MOVE WCC-101     TO PT-101-CREQ.

           MOVE SPACES TO PT-101-01-ROC-CAI-IOPC.

           MOVE SPACES TO PT-101-01-ROC-IIC-IOPC.

           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE    OSG-SGS-COD-SIST IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-SIST.

           MOVE    OSG-SGS-COD-EVEN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-EVEN.

           
           MOVE    OSG-SGS-COD-EVEN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-EVEN.


           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE    OSG-SGS-COD-CPTO IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-CPTO.

           MOVE SPACES TO PT-101-02-ROC-COD-SCPT.

           MOVE SPACES TO PT-101-02-ROC-COD-MODL.

           MOVE    OSG-SGS-COD-OCOB IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-OCOB.


           MOVE    OSG-SGS-CAI-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-CAI-PLAN.

           MOVE    OSG-SGS-IIC-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-IIC-PLAN.

           MOVE    OSG-SGS-IND-TPLN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-IND-TPLT.

           MOVE    OSG-SGS-COD-MONE IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-VCOC.

           MOVE    OSG-SGS-FEC-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
                   WSS-FEC-FAMD.

           MOVE
            WSS-NUM-SAMD TO
            WSS-NUM-SDMA.

           MOVE
            WSS-NUM-AAMD TO
            WSS-NUM-ADMA.

           MOVE
            WSS-NUM-MAMD TO
            WSS-NUM-MDMA.

           MOVE
            WSS-NUM-DAMD TO
            WSS-NUM-DDMA.

           MOVE     WSS-FEC-FDMA TO
              PT-101-02-ROC-FEC-PLAN.

           MOVE     OSG-SGS-HRA-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-HRA-PLAN.

           MOVE WCC-S TO PT-101-02-ROC-IND-VIGE.

           MOVE SPACES TO PT-101-02-ROC-COD-ANUL.

           MOVE SPACES TO PT-101-02-ROC-FEC-FUNO.

           MOVE     OSG-SGS-IIC-IRCC IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-NUM-ADIC.

           MOVE     OSG-SGS-CAI-IRCC IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-VRF-ADIC.


           MOVE SPACES TO PT-101-02-ROC-FEC-FDOS.

           IF PT-A02-01-FRM-IND-TINT = WSS-FRM-IND-TINT-I
                IF PT-101-02-ROC-IND-TPLT = WSS-CTE-PORC
                    MOVE ZEROES TO
                    PT-101-02-ROC-SGV-TCAL-NUM
                ELSE
                    MOVE PT-A02-01-ITR-SGV-TINT-NUM TO
                    PT-101-02-ROC-SGV-TCAL-NUM
           ELSE
               IF PT-101-02-ROC-IND-TPLT = WSS-CTE-P
                   MOVE OSG-OCI-VAL-PPRO IN OSG-VARI(WSS-IDX-IROC) TO
                   PT-101-02-ROC-SGV-TCAL-NUM
               ELSE
               IF PT-101-02-ROC-IND-TPLT = WSS-CTE-PORC
                   MOVE OSG-SGS-VAL-MNTO IN OSG-VARI(WSS-IDX-IROC) TO
                   PT-101-02-ROC-SGV-TCAL-NUM.

           MOVE      OSG-SGS-MSC-BCTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-BCTI.

           MOVE      OSG-SGS-MSC-PBTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-PBTI.

           MOVE      OSG-SGS-MSC-BPBT IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-BPBT.

           MOVE      OSG-SGS-MSC-SPBT IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-SPBT.


           MOVE ZEROES TO PT-101-02-ROC-SGV-TINF-NUM.
           MOVE OSG-SGS-SGV-TAMO IN OSG-VARI(WSS-IDX-IROC) TO
                PT-101-02-ROC-SGV-TINF-NUM

           MOVE      OSG-SGS-COD-CVTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-COD-CVTI.

           MOVE      OSG-SGS-MSC-TFPR IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-TFPR.

           MOVE      OSG-SGS-NUM-PREP IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-NUM-PREP.


           MOVE      OSG-SGS-MSC-UTPR IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-UTPR.

           MOVE      OSG-SGS-SGV-CSTF IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-SGV-CFON-NUM.

           MOVE      OSG-SGS-VAL-FRIE IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-SGV-FRIE-NUM.

      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           IF PT-101-02-ROC-IND-TPLT = WSS-CTE-P AND
              PT-A02-01-FRM-IND-TINT = WSS-FRM-IND-TINT-I
                 PERFORM PUT-ROC-N.


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.


           IF PT-101-02-ROC-IND-TPLT = WSS-CTE-PORC AND
              PT-A02-01-FRM-IND-TINT = WSS-FRM-IND-TINT-I
                 MOVE WSS-CTE-N TO PT-101-02-ROC-IND-VIGE.

           MOVE PT-101             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           PERFORM GNS-PRO-QUE.

           GO TO CIC-ROC-INT-OCC.

       FIN-ROC.


      * LIQUIDACION
           MOVE SPACES TO PT-032.

           MOVE WCC-Y              TO WSS-TR-COD-SGMT.
           MOVE PT-A02-AHDR        TO PT-032-AHDR.
      *     MOVE WCC-3C             TO PT-032-AHDR(98:1).
           MOVE WCC-032            TO PT-032-CREQ.
      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-032             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       END-FORM-REQS.

       CIC-GET-TR.

       EXT-FORM-REQS.

       FIN-FORM-REQS.
           EXIT.

       PUT-ROC-N SECTION.
       INI-PUT-ROC-N.
           MOVE PT-101 TO WSS-ROC-BKP.

           MOVE HOY-SHOY TO WSS-NUM-SDMA
           MOVE HOY-AHOY TO WSS-NUM-ADMA
           MOVE HOY-MHOY TO WSS-NUM-MDMA
           MOVE HOY-DHOY TO WSS-NUM-DDMA
           MOVE WSS-FEC-FDMA TO PT-101-02-ROC-FEC-PLAN
           MOVE HOY-HHOY     TO PT-101-02-ROC-HRA-PLAN

           MOVE WCC-USRCODUSER TO FIO-AKEY
           MOVE WSS-HDR-USER TO USR-COD-USER IN USR
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-USR
           IF FIO-STAT-OKS
               MOVE USR-COD-USER IN USR TO  WSS-12-04-08
               MOVE WSS-12-04-08-04 TO PT-101-02-ROC-CAI-PLAN
               MOVE WSS-12-04-08-08 TO PT-101-02-ROC-IIC-PLAN

               MOVE USR-NUM-IUSR IN USR TO PT-101-02-ROC-NUM-ADIC
               MOVE USR-VRF-IUSR IN USR TO PT-101-02-ROC-VRF-ADIC
           ELSE
               MOVE SPACES TO PT-101-02-ROC-CAI-PLAN
               MOVE SPACES TO PT-101-02-ROC-IIC-PLAN.

           MOVE PT-A02-01-ITR-SGV-TINT-NUM TO
                PT-101-02-ROC-SGV-TCAL-NUM.

           MOVE OSG-OCI-VAL-PPRO IN OSG-VARI(WSS-IDX-IROC) TO
                PT-101-02-ROC-SGV-TINF-NUM


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           MOVE PT-101             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           PERFORM GNS-PRO-QUE.

           MOVE WSS-ROC-BKP TO PT-101.

           MOVE WSS-CTE-N TO PT-101-02-ROC-IND-VIGE.

       FIN-PUT-ROC-N.
           EXIT.

       COPY GNSBVNUM.
       COPY GNSBGHOY.
       COPY GNSBHSYS.
       COPY GNSBGSYS.
       COPY GNSBIABT.
       COPY GNSBGTSK.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY GNSBGDTC.
       COPY GNSBGMSG.
       COPY GNSBVTAB.
       COPY TABBFUSR.

       COPY GNSBGEND.

      *Modulo Generico Manejo de TSs
       COPY GNSBGQUE.

       COPY COLBFTOC.
       COPY COLBFPOC.
       COPY COLBFPVC.

       CRG-IDD SECTION.
       INI-CRG-IDD.
           MOVE WCC-GNS      TO SCR-SIST.
           MOVE WCC-COLPMA02 TO IDD-PROG FIO-PROG.
           MOVE IDD-VARI     TO SYS-CMMA.
           MOVE +507         TO SYS-TCMA.
           MOVE WCC-GNSPPIDD TO SYS-PROG.
           MOVE SYS-LINK     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA     TO IDD-VARI.

       FIN-IDD-CRG.
           EXIT.

       COPY SGCBGBCC.
       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.

       AA-OBTIENE-FECHA SECTION.
       INI-AA-OBTIENE-FECHA.
           MOVE EIBDATE  TO SYS-JHOY.
           MOVE EIBTIME  TO SYS-HHOY.

           MOVE SYS-AAHY TO SYS-AHOY.
           DIVIDE SYS-AAHY BY WCC-4 GIVING SYS-REST REMAINDER SYS-REST.
           IF SYS-DDHY > WCC-59 AND SYS-REST NOT = WCC-0
               ADD WCC-1     TO SYS-DDHY.
           PERFORM PARRAFO-NULO VARYING SYS-SIND
               FROM WCC-1 BY WCC-1 UNTIL
               SYS-SIND > WCC-12 OR SYS-DDHY NOT > SYS-DACU(SYS-SIND).
           SUBTRACT WCC-1    FROM SYS-SIND.
           MOVE SYS-SIND TO SYS-MHOY.
           SUBTRACT SYS-DACU(SYS-SIND) FROM SYS-DDHY GIVING SYS-DHOY.

           IF SYS-AHOY > WCC-60
              MOVE WCC-19 TO SYS-SHOY
           ELSE
              MOVE WCC-20 TO SYS-SHOY.

           MOVE SYS-SHOY TO SYS-SSTP.
           MOVE SYS-AHOY TO SYS-AATS IN SYS-FSTP.
           MOVE SYS-MHOY TO SYS-MMTS IN SYS-FSTP.
           MOVE SYS-DHOY TO SYS-DDTS IN SYS-FSTP.
       FIN-AA-OBTIENE-FECHA.
           EXIT.

       PARRAFO-NULO SECTION.
       INI-PARRAFO-NULO.
       FIN-PARRAFO-NULO.
           EXIT.

       PRO-24H-INP SECTION.
       INI-PRO-24H-INP.

           PERFORM AA-OBTIENE-FECHA.
           MOVE SYS-DDTS IN SYS-FSTP TO FEC-ITM1.
           MOVE SYS-MMTS IN SYS-FSTP TO FEC-ITM2.
           MOVE SYS-SSTP             TO FEC-ITM3.
           MOVE SYS-AATS IN SYS-FSTP TO FEC-ITM4.
           MOVE FEC-VHBL-S           TO FEC-VHBL.
           MOVE FEC-FBLK-N           TO FEC-FBLK.
           MOVE FEC-CHOY-N           TO FEC-CHOY.
           MOVE FEC-FORM-FEC         TO FEC-FORM.
           MOVE FEC-VAL-FEC          TO FEC-CMND.
           PERFORM PRO-FEC.

           IF SYS-HHOY NOT > WCC-080000 OR
              SYS-HHOY NOT < WCC-200000 OR
              FEC-STAT-FER

                 MOVE FEC-FBLK-N   TO FEC-FBLK
                 MOVE FEC-CHOY-N   TO FEC-CHOY
                 MOVE FEC-FORM-FEC TO FEC-FORM
                 MOVE FEC-SIG-HBL  TO FEC-CMND
                 PERFORM CAL-FEC

                 MOVE FEC-ITM1     TO WSS-NUM-DDMA
                 MOVE FEC-ITM2     TO WSS-NUM-MDMA
                 MOVE FEC-ITM3     TO WSS-NUM-ADMA
                 MOVE FEC-ITM4     TO WSS-NUM-ADMA
                 MOVE WSS-FEC-FDMA TO PT-A02-01-NOP-FEC-FCUR.
       FIN-PRO-24H-INP.
           EXIT.

      *----------------------------------------------------
       CON-MC2-CCM SECTION.
       INI-CON-MC2-CCM.
      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = CCM >>>>>>>>>>>>>>>>>>>>
       INI-CCM.

           MOVE SPACES                     TO RCC-CIC-IOPE IN RCC-VARI.
           MOVE SPACES                     TO RCC-IDC-ICLI IN RCC-VARI.

           MOVE PT-A02-01-DBC-NUM-ICLI     TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-VRF-ICLI     TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-IND-ICLI     TO RCC-IND-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-GLS-ICLI     TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.
           MOVE WSS-HDR-TIPC-02            TO RCC-COD-TCNL IN RCC-VARI.
           MOVE ZEROES                     TO RCC-COD-CNAL IN RCC-VARI.

           IF RCC-COD-TCNL IN RCC-VARI NOT = WSS-CTE-110 AND
                                       NOT = WSS-CTE-100
              MOVE WSS-CTE-010             TO RCC-COD-TCNL IN RCC-VARI
              MOVE PT-A02-01-OPC-COD-OFOC  TO RCC-COD-CNAL IN RCC-VARI.

           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-TOOC     TO RCC-COD-TOOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-AOOC     TO RCC-COD-AOOC IN RCC-VARI.

           MOVE WSS-TOT-DIA                TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE WCC-D                      TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE WCC-CUR                    TO RCC-COD-EVEN IN RCC-VARI.
           MOVE WCC-CCM                    TO RCC-COD-CPTO IN RCC-VARI.
           MOVE SPACES                     TO RCC-COD-TCAR IN RCC-VARI.
           MOVE PT-A02-01-OPC-VAL-CRED-NUM TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCMO IN RCC-VARI.
           MOVE PT-A02-01-OPC-VAL-CRED-NUM TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VSOP IN RCC-VARI.
           MOVE PT-A02-01-NOP-NUM-VIGU-NUM TO RCC-VAL-FINA IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCFN IN RCC-VARI.
           MOVE ZEROES                     TO RCC-VAL-INTE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                     TO RCC-VAL-VASG IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCVA IN RCC-VARI.

           MOVE PT-A02-01-NOP-FEC-FCUR TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FCOL IN RCC-VARI.

           MOVE WSS-FEC-FVEN TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FVEN IN RCC-VARI.

           MOVE SPACES                 TO RCC-COD-TCON IN RCC-VARI.
           MOVE WCC-S                  TO RCC-OFRM-SRV IN RCC-VARI.
           MOVE FIO-MSFL               TO RCC-MSFL     IN RCC-VARI.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE +490       TO RCC-LIDD.

           MOVE RCC-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
      *     LINK TABPSRCC RCC-COD-CPTO = CCM
           MOVE WCC-TABPSRCC TO SYS-PROG.
           MOVE RCC-TCMA   TO SYS-TCMA.

           PERFORM GNS-PRO-SYS.

           MOVE SYS-CMMA TO RCC-CMMA.
           MOVE RCC-MSFL TO FIO-MSFL.
           IF RCC-COD-MENS IN RCC-VARI > SPACES
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE
                MOVE RCC-COD-MENS IN RCC-VARI
                                      TO WSS-ERR-COD-COMI-02
                MOVE WSS-ERR-COD-COMI TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND    TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025           TO QUE-LITM
                MOVE QUE-PUT         TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-CON-MC2-CCM.

           MOVE ZEROES TO QUE-NITM.

           PERFORM PUT-RCC-RESP.

           PERFORM PROCESA-RESP-CCM.

       FIN-CON-MC2-CCM.
           EXIT.

      *----------------------------------------------------
       PUT-RCC-RESP SECTION.
       INI-PUT-RCC-RESP.
           MOVE ZEROES TO WSS-X.
           MOVE ZEROES TO QUE-NITM.

       LUP-PUT-RCC-RESP.
           ADD WCC-1 TO WSS-X.
           ADD WCC-1 TO QUE-NITM.

           MOVE TSK-TERM-ALF  TO RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE RCC-LEN-TSSGS TO QUE-LITM.
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE QUE-ITEM TO OSG-APL-VEC(WSS-X)
              GO TO LUP-PUT-RCC-RESP.

       FIN-PUT-RCC-RESP.
           EXIT.

      *----------------------------------------------------
       PROCESA-RESP-CCM SECTION.
       INI-PROCESA-RESP-CCM.
           MOVE ZEROES TO WSS-IND-RESP IN WSS-VARI.

       LUP-PROCESA-RESP-CCM.
           ADD WCC-1 TO WSS-IND-RESP IN WSS-VARI.
           IF WSS-IND-RESP IN WSS-VARI > WCC-100   OR
              WSS-IND-RESP IN WSS-VARI = WSS-X
              GO TO FIN-PROCESA-RESP-CCM.

           IF OSG-SGS-COD-OCOB(WSS-IND-RESP) > SPACES
              AND OSG-SGS-COD-SEGU(WSS-IND-RESP) NOT = WCC-INF
              PERFORM PUT-ROC-CCM.

           GO TO LUP-PROCESA-RESP-CCM.

       FIN-PROCESA-RESP-CCM.
           EXIT.

      *----------------------------------------------------
       PUT-ROC-CCM SECTION.
       INI-PUT-ROC-CCM.

           MOVE SPACES                 TO PT-101.
           MOVE WCC-E TO WSS-TR-COD-SGMT.
           MOVE PT-A02-AHDR            TO PT-101-AHDR
           MOVE WCC-101                TO PT-101-CREQ

           MOVE SPACES TO PT-101-01-ROC-CAI-IOPC.

           MOVE SPACES TO PT-101-01-ROC-IIC-IOPC.

           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE OSG-SGS-COD-SIST(WSS-IND-RESP) TO
                                          PT-101-01-ROC-COD-SIST.

           MOVE OSG-SGS-COD-EVEN(WSS-IND-RESP) TO
                                          PT-101-01-ROC-COD-EVEN.

           MOVE WCC-CCM TO                PT-101-02-ROC-COD-CPTO.

           MOVE OSG-SGS-COD-SEGU(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-MODL.

           MOVE OSG-SGS-COD-OCOB(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-OCOB.

           MOVE OSG-SGS-COD-TSEG(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-SCPT.

           MOVE OSG-SGS-COD-MONE(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-VCOC.

           MOVE OSG-SGS-CAI-PLNT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-CAI-PLAN.

           MOVE OSG-SGS-IIC-PLNT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-IIC-PLAN.

           MOVE OSG-SGS-IND-TPLN(WSS-IND-RESP) TO
                                          PT-101-02-ROC-IND-TPLT.


           MOVE OSG-SGS-FEC-PLNT(WSS-IND-RESP) TO
                    WSS-FEC-FAMD.

           MOVE WSS-NUM-SAMD TO WSS-NUM-SDMA.
           MOVE WSS-NUM-AAMD TO WSS-NUM-ADMA.
           MOVE WSS-NUM-MAMD TO WSS-NUM-MDMA.
           MOVE WSS-NUM-DAMD TO WSS-NUM-DDMA.

           MOVE WSS-FEC-FDMA           TO PT-101-02-ROC-FEC-PLAN.

           MOVE OSG-SGS-HRA-PLNT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-HRA-PLAN.

           MOVE WCC-S                  TO PT-101-02-ROC-IND-VIGE.


           MOVE OSG-SGS-VAL-MNTO(WSS-IND-RESP)
                                       TO PT-101-02-ROC-SGV-TCAL-NUM.
                                       
           IF OSG-SGS-COD-TSEG(WSS-IND-RESP) = WCC-EMI
              MOVE OSG-SGS-SGV-TAMO(WSS-IND-RESP)
                                       TO PT-101-02-ROC-SGV-TINF-NUM.
                                       
           IF OSG-SGS-COD-TSEG(WSS-IND-RESP) = WCC-002
              MOVE OSG-SGS-SGV-TAMO(WSS-IND-RESP) 
                                       TO PT-101-02-ROC-SGV-TCAL-NUM
              MOVE OSG-SGS-SGV-TAMO(WSS-IND-RESP) 
                                       TO PT-101-02-ROC-SGV-TINF-NUM
              MOVE OSG-SGS-COD-TINT(WSS-IND-RESP)
                                       TO WSS-ROC-COD-TINT.

           MOVE WSS-ROC-MSC-BCTI       TO PT-101-02-ROC-MSC-BCTI.
           MOVE WSS-ROC-MSC-PBTI       TO PT-101-02-ROC-MSC-PBTI.
           MOVE WSS-ROC-MSC-BPBT       TO PT-101-02-ROC-MSC-BPBT.
           MOVE WSS-ROC-MSC-SPBT       TO PT-101-02-ROC-MSC-SPBT.
           MOVE WSS-ROC-COD-CVTI       TO PT-101-02-ROC-COD-CVTI.
           MOVE WSS-ROC-MSC-TFPR       TO PT-101-02-ROC-MSC-TFPR.
           MOVE WSS-ROC-NUM-PREP       TO PT-101-02-ROC-NUM-PREP-NUM.
           MOVE WSS-ROC-MSC-UTPR       TO PT-101-02-ROC-MSC-UTPR.


           MOVE OSG-SGS-SGV-CSTF(WSS-IND-RESP)
                                       TO PT-101-02-ROC-SGV-CFON-NUM.
           MOVE OSG-SGS-VAL-FRIE(WSS-IND-RESP)
                                       TO PT-101-02-ROC-SGV-FRIE.

           MOVE SPACES                 TO PT-101-02-ROC-COD-ANUL.
           MOVE SPACES                 TO PT-101-02-ROC-VRF-ADIC.
           MOVE ZEROES                 TO PT-101-02-ROC-FEC-FUNO.
           MOVE ZEROES                 TO PT-101-02-ROC-FEC-FDOS.

           MOVE OSG-SGS-IIC-IRCC(WSS-IND-RESP) TO
                                          PT-101-02-ROC-NUM-ADIC.

           MOVE OSG-SGS-CAI-IRCC(WSS-IND-RESP) TO
                                          PT-101-02-ROC-VRF-ADIC.

           MOVE WSS-QUE-TR-COLA        TO QUE-COLA.
           MOVE PT-101                 TO WSS-TR-COD-DATA.
           MOVE WSS-TR                 TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           PERFORM GNS-PRO-QUE.

       FIN-PUT-ROC-CCM.
           EXIT.

      *----------------------------------------------------
       CON-MC2-CGN SECTION.
       INI-CON-MC2-CGN.

           MOVE SPACES TO PT-101.

           MOVE SPACES                     TO RCC-CIC-IOPE IN RCC-VARI.
           MOVE SPACES                     TO RCC-IDC-ICLI IN RCC-VARI.

           MOVE PT-A02-01-DBC-NUM-ICLI     TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-VRF-ICLI     TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-IND-ICLI     TO RCC-IND-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-GLS-ICLI     TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.
           MOVE WSS-HDR-TIPC-02            TO RCC-COD-TCNL IN RCC-VARI.
           MOVE ZEROES                     TO RCC-COD-CNAL IN RCC-VARI.

           IF RCC-COD-TCNL IN RCC-VARI NOT = WSS-CTE-110 AND
                                       NOT = WSS-CTE-100
              MOVE WSS-CTE-010             TO RCC-COD-TCNL IN RCC-VARI
              MOVE PT-A02-01-OPC-COD-OFOC  TO RCC-COD-CNAL IN RCC-VARI.

           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-TOOC     TO RCC-COD-TOOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-AOOC     TO RCC-COD-AOOC IN RCC-VARI.

           MOVE WSS-TOT-DIA                TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE WCC-D                      TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE WCC-CUR                    TO RCC-COD-EVEN IN RCC-VARI.
           MOVE WCC-CGN                    TO RCC-COD-CPTO IN RCC-VARI.
           MOVE SPACES                     TO RCC-COD-TCAR IN RCC-VARI.
           MOVE PT-A02-01-OPC-VAL-CRED-NUM TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCMO IN RCC-VARI.
           MOVE ZEROES                     TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE SPACES                     TO RCC-COD-VSOP IN RCC-VARI.
           MOVE PT-A02-01-NOP-NUM-VIGU-NUM TO RCC-VAL-FINA IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCFN IN RCC-VARI.
           MOVE ZEROES                     TO RCC-VAL-INTE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                     TO RCC-VAL-VASG IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCVA IN RCC-VARI.

           MOVE PT-A02-01-NOP-FEC-FCUR TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FCOL IN RCC-VARI.

           MOVE WSS-FEC-FVEN TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FVEN IN RCC-VARI.

           MOVE SPACES                 TO RCC-COD-TCON IN RCC-VARI.
           MOVE WCC-S                  TO RCC-OFRM-SRV IN RCC-VARI.
           MOVE FIO-MSFL               TO RCC-MSFL     IN RCC-VARI.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE +490       TO RCC-LIDD.

           MOVE RCC-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
      *     LINK TABPSRCC RCC-COD-CPTO = CGN
           MOVE WCC-TABPSRCC TO SYS-PROG.
           MOVE RCC-TCMA   TO SYS-TCMA.

           PERFORM GNS-PRO-SYS.

           MOVE SYS-CMMA TO RCC-CMMA.
           MOVE RCC-MSFL TO FIO-MSFL.
           IF RCC-COD-MENS IN RCC-VARI > SPACES
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE
                MOVE RCC-COD-MENS IN RCC-VARI
                                      TO WSS-ERR-COD-COMI-02
                MOVE WSS-ERR-COD-COMI TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND    TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025           TO QUE-LITM
                MOVE QUE-PUT         TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-CON-MC2-CGN.

           MOVE ZEROES TO QUE-NITM.

           PERFORM PUT-RCC-RESP.

           PERFORM PROCESA-RESP-CGN.

       FIN-CON-MC2-CGN.
           EXIT.
      *----------------------------------------------------
       PROCESA-RESP-CGN SECTION.
       INI-PROCESA-RESP-CGN.
           MOVE ZEROES TO WSS-IND-RESP IN WSS-VARI.

       LUP-PROCESA-RESP-CGN.
           ADD WCC-1 TO WSS-IND-RESP IN WSS-VARI.

           IF WSS-IND-RESP IN WSS-VARI > WCC-100   OR
              WSS-IND-RESP IN WSS-VARI = WSS-X
              GO TO FIN-PROCESA-RESP-CGN.

           IF OSG-SGS-COD-SIST(WSS-IND-RESP) > SPACES
              PERFORM PUT-ROC-CGN.

           GO TO LUP-PROCESA-RESP-CGN.

       FIN-PROCESA-RESP-CGN.
           EXIT.
      *----------------------------------------------------
       PUT-ROC-CGN SECTION.
       INI-PUT-ROC-CGN.

           MOVE SPACES                 TO PT-101.
           MOVE WCC-E TO WSS-TR-COD-SGMT.
           MOVE PT-A02-AHDR            TO PT-101-AHDR
           MOVE WCC-101                TO PT-101-CREQ

           MOVE SPACES TO PT-101-01-ROC-CAI-IOPC.

           MOVE SPACES TO PT-101-01-ROC-IIC-IOPC.

           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE OSG-SGS-COD-SIST(WSS-IND-RESP) TO
                                          PT-101-01-ROC-COD-SIST.

           MOVE OSG-SGS-COD-EVEN(WSS-IND-RESP) TO
                                          PT-101-01-ROC-COD-EVEN.
           MOVE ZEROES TO PT-101-01-ROC-NUM-IROC-NUM.

           MOVE WCC-CGN TO                PT-101-02-ROC-COD-CPTO.

           MOVE OSG-SGS-COD-TSEG(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-SCPT.

           MOVE OSG-SGS-COD-SEGU(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-MODL.

           MOVE OSG-SGS-COD-OCOB(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-OCOB.

           MOVE OSG-SGS-CAI-PLNT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-CAI-PLAN.

           MOVE OSG-SGS-IIC-PLNT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-IIC-PLAN.

           MOVE OSG-SGS-IND-TPLN(WSS-IND-RESP) TO
                                          PT-101-02-ROC-IND-TPLT.

           MOVE OSG-SGS-COD-MONE(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-VCOC.

           MOVE OSG-SGS-FEC-PLNT(WSS-IND-RESP) TO
                                          WSS-FEC-FAMD.

           MOVE WSS-NUM-SAMD TO WSS-NUM-SDMA.

           MOVE WSS-NUM-AAMD TO WSS-NUM-ADMA.

           MOVE WSS-NUM-MAMD TO WSS-NUM-MDMA.

           MOVE WSS-NUM-DAMD TO WSS-NUM-DDMA.

           MOVE WSS-FEC-FDMA TO PT-101-02-ROC-FEC-PLAN.

           MOVE OSG-SGS-HRA-PLNT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-HRA-PLAN.

           MOVE WCC-S        TO PT-101-02-ROC-IND-VIGE.

           MOVE SPACES       TO PT-101-02-ROC-COD-ANUL.

           MOVE SPACES       TO PT-101-02-ROC-FEC-FUNO.

           MOVE OSG-SGS-IIC-IRCC(WSS-IND-RESP) TO
                                         PT-101-02-ROC-NUM-ADIC.

           MOVE OSG-SGS-CAI-IRCC(WSS-IND-RESP) TO
                                         PT-101-02-ROC-VRF-ADIC.

           MOVE SPACES TO PT-101-02-ROC-FEC-FDOS.

           MOVE OSG-SGS-SGV-TAMO(WSS-IND-RESP) TO
                                         PT-101-02-ROC-SGV-TCAL-NUM.

           MOVE OSG-SGS-MSC-BCTI(WSS-IND-RESP) TO
                                         PT-101-02-ROC-MSC-BCTI.

           MOVE OSG-SGS-MSC-PBTI(WSS-IND-RESP) TO
                                         PT-101-02-ROC-MSC-PBTI.

           MOVE OSG-SGS-MSC-BPBT(WSS-IND-RESP) TO
                                         PT-101-02-ROC-MSC-BPBT.

           MOVE OSG-SGS-MSC-SPBT(WSS-IND-RESP) TO
                                         PT-101-02-ROC-MSC-SPBT.

           MOVE ZEROES TO PT-101-02-ROC-SGV-TINF-NUM.

           MOVE OSG-SGS-COD-CVTI(WSS-IND-RESP) TO
                                         PT-101-02-ROC-COD-CVTI.

           MOVE OSG-SGS-MSC-TFPR(WSS-IND-RESP) TO
                                         PT-101-02-ROC-MSC-TFPR.

           MOVE OSG-SGS-NUM-PREP(WSS-IND-RESP) TO
                                         PT-101-02-ROC-NUM-PREP.

           MOVE OSG-SGS-MSC-UTPR(WSS-IND-RESP) TO
                                         PT-101-02-ROC-MSC-UTPR.

           MOVE OSG-SGS-SGV-CSTF(WSS-IND-RESP) TO
                                         PT-101-02-ROC-SGV-CFON-NUM.

           MOVE OSG-SGS-VAL-FRIE(WSS-IND-RESP) TO
                                         PT-101-02-ROC-SGV-FRIE-NUM.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-101             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-ROC-CGN.
           EXIT.
      *----------------------------------------------------
       CON-MC2-SGS SECTION.
       INI-CON-MC2-SGS.


           MOVE SPACES         TO RCC-CIC-IOPE IN RCC-VARI.
           MOVE SPACES         TO RCC-IDC-ICLI IN RCC-VARI.

           MOVE PT-A02-01-DBC-NUM-ICLI TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-VRF-ICLI TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-IND-ICLI TO RCC-IND-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-GLS-ICLI TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.
           MOVE WSS-HDR-TIPC-02            TO RCC-COD-TCNL IN RCC-VARI.
           MOVE ZEROES                     TO RCC-COD-CNAL IN RCC-VARI.

           IF RCC-COD-TCNL IN RCC-VARI NOT = WSS-CTE-110 AND
                                       NOT = WSS-CTE-100
              MOVE WSS-CTE-010             TO RCC-COD-TCNL IN RCC-VARI
              MOVE PT-A02-01-OPC-COD-OFOC  TO RCC-COD-CNAL IN RCC-VARI.

           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-TOOC     TO RCC-COD-TOOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-AOOC     TO RCC-COD-AOOC IN RCC-VARI.

           MOVE WSS-TOT-DIA                TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE WCC-D                      TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE WCC-CUR                    TO RCC-COD-EVEN IN RCC-VARI.
           MOVE WCC-SGS                    TO RCC-COD-CPTO IN RCC-VARI.
           MOVE SPACES                     TO RCC-COD-TCAR IN RCC-VARI.
           MOVE PT-A02-01-OPC-VAL-CRED-NUM TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCMO IN RCC-VARI.
           MOVE PT-A02-01-OPC-VAL-CRED-NUM TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VSOP IN RCC-VARI.
           MOVE PT-A02-01-NOP-NUM-VIGU-NUM TO RCC-VAL-FINA IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCFN IN RCC-VARI.
           MOVE ZEROES                     TO RCC-VAL-INTE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                     TO RCC-VAL-VASG IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC     TO RCC-COD-VCVA IN RCC-VARI.

           MOVE PT-A02-01-NOP-FEC-FCUR TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FCOL IN RCC-VARI.

           MOVE WSS-FEC-FVEN TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FVEN IN RCC-VARI.

           MOVE WCC-CON                TO RCC-COD-TCON IN RCC-VARI.
           MOVE WCC-S                  TO RCC-OFRM-SRV IN RCC-VARI.
           MOVE FIO-MSFL               TO RCC-MSFL     IN RCC-VARI.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE +490       TO RCC-LIDD.

           MOVE RCC-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
      *     LINK TABPSRCC RCC-COD-CPTO = SGS
           MOVE WCC-TABPSRCC TO SYS-PROG.
           MOVE RCC-TCMA   TO SYS-TCMA.

           PERFORM GNS-PRO-SYS.

           MOVE SYS-CMMA TO RCC-CMMA.
           MOVE RCC-MSFL TO FIO-MSFL.
           IF RCC-COD-MENS IN RCC-VARI > SPACES
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE
                MOVE RCC-COD-MENS IN RCC-VARI
                                      TO WSS-ERR-MC2-SEGU-02
                MOVE WSS-ERR-MC2-SEGU TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND    TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025           TO QUE-LITM
                MOVE QUE-PUT         TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-CON-MC2-SGS.

           MOVE ZEROES TO QUE-NITM.

           PERFORM PUT-RCC-RESP.

           PERFORM PROCESA-RESP-SGS.

       FIN-CON-MC2-SGS.
           EXIT.
      *----------------------------------------------------
       PROCESA-RESP-SGS SECTION.
       INI-PROCESA-RESP-SGS.
           MOVE ZEROES TO WSS-IND-RESP IN WSS-VARI.

       LUP-PROCESA-RESP-SGS.
           ADD WCC-1 TO WSS-IND-RESP IN WSS-VARI.

           IF WSS-IND-RESP IN WSS-VARI > WCC-100   OR
              WSS-IND-RESP IN WSS-VARI = WSS-X
              GO TO FIN-PROCESA-RESP-SGS.

           IF OSG-SGS-COD-SIST(WSS-IND-RESP) > SPACES
              PERFORM PUT-ROC-SGS.

           GO TO LUP-PROCESA-RESP-SGS.

       FIN-PROCESA-RESP-SGS.
           EXIT.
      *----------------------------------------------------
       PUT-ROC-SGS SECTION.
       INI-PUT-ROC-SGS.

           MOVE SPACES                 TO PT-101.
           MOVE WCC-E TO WSS-TR-COD-SGMT.
           MOVE PT-A02-AHDR            TO PT-101-AHDR
           MOVE WCC-101                TO PT-101-CREQ

           MOVE SPACES TO PT-101-01-ROC-CAI-IOPC.

           MOVE SPACES TO PT-101-01-ROC-IIC-IOPC.

           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE OSG-SGS-COD-SIST(WSS-IND-RESP) TO
                                          PT-101-01-ROC-COD-SIST.

           MOVE OSG-SGS-COD-EVEN(WSS-IND-RESP) TO
                                          PT-101-01-ROC-COD-EVEN.

           MOVE SPACES                 TO PT-101-01-ROC-EXT-IOPC.
           MOVE ZEROES                 TO PT-101-01-ROC-NUM-IROC-NUM.
           MOVE WCC-SGS                TO PT-101-02-ROC-COD-CPTO.

           MOVE OSG-SGS-COD-TSEG(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-SCPT.

           MOVE OSG-SGS-COD-SEGU(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-MODL.

           MOVE OSG-SGS-COD-OCOB(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-OCOB.

           MOVE OSG-SGS-CAI-PLNT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-CAI-PLAN.

           MOVE OSG-SGS-IIC-PLNT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-IIC-PLAN.

           MOVE OSG-SGS-IND-TPLN(WSS-IND-RESP) TO
                                          PT-101-02-ROC-IND-TPLT.

           MOVE OSG-SGS-COD-MONE(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-VCOC.

           MOVE OSG-SGS-FEC-PLNT(WSS-IND-RESP) TO
                                          WSS-FEC-FAMD.

           MOVE WSS-NUM-SAMD TO WSS-NUM-SDMA.
           MOVE WSS-NUM-AAMD TO WSS-NUM-ADMA.
           MOVE WSS-NUM-MAMD TO WSS-NUM-MDMA.
           MOVE WSS-NUM-DAMD TO WSS-NUM-DDMA.

           MOVE WSS-FEC-FDMA  TO PT-101-02-ROC-FEC-PLAN.

           MOVE OSG-SGS-HRA-PLNT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-HRA-PLAN.

           MOVE WCC-S                  TO PT-101-02-ROC-IND-VIGE.

      * BUSCA SGS PROPUESTO ENTRE LOS INPUT PARA GRABAR ROC 'S' O 'N'
           MOVE WCC-N TO WSS-SGS-PPT-ENC.

           PERFORM BUS-SGS-PPT VARYING WSS-IDX-SGS-PPT
                        FROM WCC-1 BY WCC-1 UNTIL
                        WSS-IDX-SGS-PPT > WSS-SGS-INP-TOT.

           IF WSS-SGS-PPT-ENC = WCC-N
                MOVE WCC-N TO PT-101-02-ROC-IND-VIGE.

           MOVE SPACES                 TO PT-101-02-ROC-COD-ANUL.

           MOVE SPACES                 TO PT-101-02-ROC-FEC-FUNO.

           MOVE OSG-SGS-IIC-IRCC(WSS-IND-RESP) TO
                                          PT-101-02-ROC-NUM-ADIC.

           MOVE OSG-SGS-CAI-IRCC(WSS-IND-RESP) TO
                                          PT-101-02-ROC-VRF-ADIC.

           MOVE SPACES                 TO PT-101-02-ROC-FEC-FDOS.

           MOVE OSG-SGS-VAL-MNTO(WSS-IND-RESP) TO
                                          PT-101-02-ROC-SGV-TCAL-NUM.
                                          
           MOVE OSG-SGS-MSC-BCTI(WSS-IND-RESP) TO
                                          PT-101-02-ROC-MSC-BCTI.

           MOVE OSG-SGS-MSC-PBTI(WSS-IND-RESP) TO
                                          PT-101-02-ROC-MSC-PBTI.

           MOVE OSG-SGS-MSC-BPBT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-MSC-BPBT.

           MOVE OSG-SGS-MSC-SPBT(WSS-IND-RESP) TO
                                          PT-101-02-ROC-MSC-SPBT.

           MOVE ZEROES TO PT-101-02-ROC-SGV-TINF-NUM.

           MOVE OSG-SGS-COD-CVTI(WSS-IND-RESP) TO
                                          PT-101-02-ROC-COD-CVTI.

           MOVE OSG-SGS-MSC-TFPR(WSS-IND-RESP) TO
                                          PT-101-02-ROC-MSC-TFPR.

           MOVE OSG-SGS-NUM-PREP(WSS-IND-RESP) TO
                                          PT-101-02-ROC-NUM-PREP.

           MOVE OSG-SGS-MSC-UTPR(WSS-IND-RESP) TO
                                          PT-101-02-ROC-MSC-UTPR.

           MOVE OSG-SGS-SGV-CSTF(WSS-IND-RESP) TO
                                          PT-101-02-ROC-SGV-CFON-NUM.

           MOVE OSG-SGS-VAL-FRIE(WSS-IND-RESP) TO
                                          PT-101-02-ROC-SGV-FRIE-NUM.
                       
           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-101             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-ROC-SGS.
           EXIT.
      *----------------------------------------------------
       FEC-SUM-1PER SECTION.
       INI-FEC-SUM-1PER.
      *SUMA 1 PERIODO A FECHA DE INICIO DE INTERESES

           IF PT-A02-01-NOP-IND-UTSV = WCC-D
               MOVE FEC-SUM-DIA                TO FEC-CMND
               MOVE PT-A02-01-NOP-NUM-SEVE-NUM TO FEC-NDIA
           ELSE
           IF PT-A02-01-NOP-IND-UTSV = WCC-M
               MOVE FEC-SUM-MES                TO FEC-CMND
               MOVE PT-A02-01-NOP-NUM-SEVE-NUM TO FEC-NMES
           ELSE
           IF PT-A02-01-NOP-IND-UTSV = WCC-A
               MOVE FEC-SUM-ANO                TO FEC-CMND
               MOVE PT-A02-01-NOP-NUM-SEVE-NUM TO FEC-NANO.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.

           MOVE WCC-S    TO WSS-IND-SPER.
       FIN-FEC-SUM-1PER.
           EXIT.
      *----------------------------------------------------
       LEE-SEP-VCTO-PVC SECTION.
       INI-LEE-SEP-VCTO-PVC.

           MOVE SPACES TO POC.

      *LEE POC
           MOVE PT-A02-01-OPC-COD-VCOC TO POC-COD-VCOC IN POC.
           MOVE PT-A02-01-OPC-COD-TOOC TO POC-COD-TOOC IN POC.
           MOVE PT-A02-01-OPC-COD-AOOC TO POC-COD-AOOC IN POC.
           MOVE ZEROES                 TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WCC-MSG07 TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-LEE-SEP-VCTO-PVC.

      *LEE PVC
           MOVE POC-COD-IPVC IN POC TO PVC-CIC-IPVC IN PVC
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM COL-FIO-PVC.
           IF NOT FIO-STAT-OKS
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WCC-MSG08
                                               TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-LEE-SEP-VCTO-PVC.

           IF WSS-A02-NUM-SEVE NOT > SPACES
              IF PVC-NUM-SVMI IN PVC = PVC-NUM-SVMA IN PVC AND
                 PVC-IND-SVMI IN PVC = PVC-IND-SVMA IN PVC AND
                 PVC-NUM-SVMI IN PVC > ZEROES
                  MOVE PVC-NUM-SVMI IN PVC TO WSS-A02-NUM-SEVE-NUM
                  MOVE PVC-IND-SVMI IN PVC TO WSS-A02-NOP-IND-UTSV.


           IF WSS-A02-NUM-SEVE-NUM NOT > ZEROES OR
              WSS-A02-NOP-IND-UTSV NOT > SPACES
                MOVE WSS-QUE-TR-COLA  TO QUE-COLA
                MOVE WCC-MSG09        TO WSS-ERR-NUM-SEOB-02
                MOVE WSS-ERR-NUM-SEOB TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-LEE-SEP-VCTO-PVC.

       FIN-LEE-SEP-VCTO-PVC.
           EXIT.
      *----------------------------------------------------
       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.
       FIN-GNX-PRO-QUE.
           EXIT.
      *----------------------------------------------------
       BUS-SGS-PPT SECTION.
       INI-BUS-SGS-PPT.
           IF PT-101-02-ROC-COD-SCPT =
              WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-IDX-SGS-PPT)
               MOVE 'S' TO WSS-SGS-PPT-ENC
               ADD 1 TO WSS-SGS-INP-TOT GIVING
                  WSS-IDX-SGS-PPT.

       FIN-BUS-SGS-PPT.
           EXIT.
      *----------------------------------------------------
       VALIDACIONES SECTION.
       INI-VALIDACIONES.
      * VALIDACION NUMERICA PT-A02-01-OPC-VAL-CRED

           MOVE PT-A02-01-OPC-VAL-CRED TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A02-01-OPC-VAL-CRED
               MOVE NUM-NN9V TO PT-A02-01-OPC-VAL-CRED-NUM
           ELSE
                MOVE NUM-MENS         TO WSS-ERR-VAL-CRED-02
                MOVE WSS-ERR-VAL-CRED TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDACIONES.


           IF PT-A02-01-FRM-IND-TINT NOT = WSS-FRM-IND-TINT-I AND
              PT-A02-01-FRM-IND-TINT NOT = WSS-FRM-IND-TINT-P

                MOVE PT-A02-01-FRM-IND-TINT TO WSS-ERR-IND-TASA-02
                MOVE WSS-ERR-IND-TASA TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-VALIDACIONES.

      * VAL-NUM PT-A02-01-ITR-SGV-TINT
           MOVE PT-A02-01-ITR-SGV-TINT TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A02-01-ITR-SGV-TINT
               MOVE NUM-NN9V TO PT-A02-01-ITR-SGV-TINT-NUM
           ELSE
                MOVE NUM-MENS         TO WSS-ERR-SGV-TINT-02
                MOVE WSS-ERR-SGV-TINT TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDACIONES.

      * VAL-NUM PT-A02-01-NOP-NUM-VIGU
           MOVE PT-A02-01-NOP-NUM-VIGU TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A02-01-NOP-NUM-VIGU
               MOVE NUM-NN9V TO PT-A02-01-NOP-NUM-VIGU-NUM
               IF PT-A02-01-NOP-NUM-VIGU-NUM = WCC-1
                   MOVE WSS-CTE-TCVE-CO TO
                        WSS-CTE-TCVE-FO-O-CO
               ELSE
                   NEXT SENTENCE
           ELSE
                MOVE NUM-MENS      TO WSS-ERR-NUM-VIGU-02
                MOVE WSS-ERR-NUM-VIGU TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDACIONES.

      * VAL-NUM PT-A02-01-NOP-NUM-SPVE
           MOVE PT-A02-01-NOP-NUM-SPVE TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A02-01-NOP-NUM-SPVE
               MOVE NUM-NN9V TO PT-A02-01-NOP-NUM-SPVE-NUM
           ELSE
                MOVE NUM-MENS      TO WSS-ERR-NUM-SPVE-02
                MOVE WSS-ERR-NUM-VIGU TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-VALIDACIONES.

      * VAL-NUM PT-A02-01-NOP-NUM-SEVE
           IF PT-A02-01-NOP-NUM-SEVE NOT > SPACES
              GO TO CON-NOP-NUM-SEVE.

           MOVE PT-A02-01-NOP-NUM-SEVE TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A02-01-NOP-NUM-SEVE
               MOVE NUM-NN9V TO PT-A02-01-NOP-NUM-SEVE-NUM
           ELSE
                MOVE NUM-MENS      TO WSS-ERR-NUM-SEVE-02
                MOVE WSS-ERR-NUM-SEVE TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-VALIDACIONES.

        CON-NOP-NUM-SEVE.

      * VAL-NUM PT-A02-01-A02-NUM-ICLI (RUT BENEFICIARIO)
           MOVE PT-A02-01-A02-NUM-ICLI-NUM TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NOT NUM-STAT-OKS
                MOVE NUM-MENS         TO WSS-ERR-NUM-RUTB-02
                MOVE WSS-ERR-NUM-RUTB TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDACIONES.

      * VAL-PT-A02-01-A02-COD-TCLI  (TIPO CLIENTE)
           IF PT-A02-01-A02-COD-TCLI NOT = WCC-P AND NOT = WCC-E
                MOVE WCC-MSG01 TO WSS-ERR-COD-TCLI-02
                MOVE WSS-ERR-COD-TCLI TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDACIONES.

      * VAL-NUM PT-A02-01-A02-GLS-COD1 (NUMERO TELEFONO BENEFICIARIO)
           IF PT-A02-01-A02-GLS-COD1 NOT > SPACES
              GO TO CON-SIN-NUM-TELE.

           MOVE PT-A02-01-A02-GLS-COD1-NUM TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NOT NUM-STAT-OKS
                MOVE NUM-MENS         TO WSS-ERR-NUM-NUMT-02
                MOVE WSS-ERR-NUM-NUMT TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-VALIDACIONES.

       CON-SIN-NUM-TELE.

      *VALIDA QUE PRODUCTO OPERE COMO BOLETA
           MOVE PT-A02-01-OPC-COD-TOOC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
                MOVE WCC-MSG10        TO WSS-ERR-ENT-TOC-02
                MOVE WSS-ERR-ENT-TOC  TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND     TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA  TO QUE-COLA
                MOVE +1025            TO QUE-LITM
                MOVE QUE-PUT          TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDACIONES.

           IF TOC-MSC-OPEC IN TOC NOT = WCC-B
                MOVE WCC-MSG11        TO WSS-ERR-COD-NOBL-02
                MOVE WSS-ERR-COD-NOBL TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND     TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA  TO QUE-COLA
                MOVE +1025            TO QUE-LITM
                MOVE QUE-PUT          TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDACIONES.
                
      *VALIDA MONTO NOTARIA
           IF PT-A02-01-DLC-VAL-GNOT-NUM NOT > ZEROES
              MOVE ZEROES TO PT-A02-01-DLC-VAL-GNOT-NUM
              GO TO CON-SIN-VAL-NOTA.
      
           MOVE PT-A02-01-DLC-VAL-GNOT TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A02-01-DLC-VAL-GNOT
               MOVE NUM-NN9V TO PT-A02-01-DLC-VAL-GNOT-NUM
           ELSE
                MOVE NUM-MENS         TO WSS-ERR-VAL-GNOT-02
                MOVE WSS-ERR-VAL-GNOT TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDACIONES.
        
           IF PT-A02-01-DLC-COD-NOTC NOT > SPACES
              MOVE ZEROES TO PT-A02-01-DLC-VAL-GNOT-NUM.
              
       CON-SIN-VAL-NOTA.
                
       FIN-VALIDACIONES.
           EXIT.
      *----------------------------------------------------
       CARGA-PARAMETRIA SECTION.
       INI-CARGA-PARAMETRIA.

      *VALORES POR DEFECTO
      *C Vnta             (posicion  1, largo 1 )
      *Cond Gtia          (posicion  2, largo 3 )
      *Destino Cred       (posicion  5, largo 3 )
      *Periodo entre Vcto (posicion 11, largo 3 )
      *Periodo entre Vcto (posicion 14, largo 1 )
      *DLC Codigo Pago    (posicion 15, largo 3 )
      *Cod Seguro         (posicion 20, largo 6 )
      *Cod Notaria        (posicion 26, largo 6 )
      *Gastos Notaria     (posicion 32, largo 15)
      *
           MOVE 'COL'           TO TAB-COD-SIST.
           MOVE 'COL'           TO FIO-SIST.
           MOVE 'A02'           TO TAB-COD-TTAB IN TAB.
           MOVE 'DEFAULT     '  TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-MSC-STAT IN TAB = WSS-CTE-S
                MOVE TAB-GLS-DATA TO WSS-GLS-A02-BGT.

      *VALORES ESPECIFICOS POR PRODUCTO
      *C Vnta             (posicion  1, largo 1 )
      *Cond Gtia          (posicion  2, largo 3 )
      *Destino Cred       (posicion  5, largo 3 )
      *Periodo entre Vcto (posicion 11, largo 3 )
      *Periodo entre Vcto (posicion 14, largo 1 )
      *DLC Codigo Pago    (posicion 15, largo 3 )
      *Cod Seguro         (posicion 20, largo 6 )
      *Cod Notaria        (posicion 26, largo 6 )
      *Gastos Notaria     (posicion 32, largo 15)
      *
           MOVE 'COL'        TO TAB-COD-SIST.
           MOVE 'COL'        TO FIO-SIST.
           MOVE 'A02'        TO TAB-COD-TTAB IN TAB.
           MOVE PT-A02-01-OPC-COD-VCOC TO WSS-COD-PROD-VCOC.
           MOVE PT-A02-01-OPC-COD-TOOC TO WSS-COD-PROD-TOOC.
           MOVE PT-A02-01-OPC-COD-AOOC TO WSS-COD-PROD-AOOC.
           MOVE WSS-COD-PROD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-MSC-STAT IN TAB = WSS-CTE-S
                MOVE TAB-GLS-DATA TO WSS-GLS-A02-BGT.

      *SE LEE PARAMETRO DE DIA DE VENCIMIENTO

           MOVE SPACES         TO TAB-COD-CTAB IN TAB.
           MOVE 'COL'          TO TAB-COD-SIST.
           MOVE 'COL'          TO FIO-SIST.
           MOVE 'DVC'          TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-TIA    TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
              MOVE TAB-GLS-DATA IN TAB(1:2) TO WSS-BGT-DIA-VEN
           ELSE
              MOVE WCC-MSG06
                                    TO WSS-ERR-VAL-DVEN-02
              MOVE WSS-ERR-VAL-DVEN TO WSS-ERR-SEND-MENS
              MOVE WSS-ERR-SEND TO QUE-ITEM
              MOVE WSS-QUE-TR-COLA TO QUE-COLA
              MOVE +1025 TO QUE-LITM
              MOVE QUE-PUT TO QUE-CMND
              PERFORM GNS-PRO-QUE
              GO TO FIN-CARGA-PARAMETRIA.
              

       FIN-CARGA-PARAMETRIA.
           EXIT.
      *----------------------------------------------------
       VALIDA-PARAMETROS-TABLAS SECTION.
       INI-VALIDA-PARAMETROS-TABLAS.
      *VALIDA PARAMETROS DE TABLAS
      
           IF PT-A02-01-DLC-COD-PAGO > SPACES
              MOVE PT-A02-01-DLC-COD-PAGO TO WSS-A02-COD-PAGO.
              
           IF PT-A02-01-OPC-COD-SEGD > SPACES
              MOVE PT-A02-01-OPC-COD-SEGD TO WSS-A02-COD-SEGU.
      
           IF PT-A02-01-OPC-COD-CDOC > SPACES
              MOVE PT-A02-01-OPC-COD-CDOC TO WSS-A02-COD-CDOC.
                            
      *VALIDA CODIGO NOTARIA TABLA
           IF WSS-A02-COD-NOTC NOT > SPACES AND
              WSS-A02-VAL-GNOT > ZEROES
              MOVE ZEROES TO WSS-A02-VAL-GNOT
              MOVE SPACES TO WSS-A02-COD-NOTC.
              
           IF WSS-A02-COD-NOTC > SPACES AND
              WSS-A02-VAL-GNOT NOT > ZEROES
              MOVE ZEROES TO WSS-A02-VAL-GNOT.
              
           IF PT-A02-01-DLC-COD-NOTC > SPACES
              MOVE PT-A02-01-DLC-COD-NOTC TO WSS-A02-COD-NOTC
              MOVE PT-A02-01-DLC-VAL-GNOT-NUM TO WSS-A02-VAL-GNOT.
             
      *ERROR SI NO SE CARGO NINGUN CODIGO DESTINO
           IF WSS-A02-COD-CDOC NOT > SPACES
                MOVE WCC-MSG02
                                      TO WSS-ERR-COD-CDOC-02
                MOVE WSS-ERR-COD-CDOC TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND    TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025           TO QUE-LITM
                MOVE QUE-PUT         TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDA-PARAMETROS-TABLAS.

           IF PT-A02-01-OPC-COD-CVTA > SPACES
              MOVE PT-A02-01-OPC-COD-CVTA TO WSS-A02-IND-CVTA.
                
      *ERROR SI NO SE CARGO NINGUN COD CANAL VENTA
           IF WSS-A02-IND-CVTA NOT > SPACES
                MOVE WCC-MSG04
                                      TO WSS-ERR-IND-CVTA-02
                MOVE WSS-ERR-IND-CVTA TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND    TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025           TO QUE-LITM
                MOVE QUE-PUT         TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDA-PARAMETROS-TABLAS.

           IF PT-A02-01-OPC-IND-GARA > SPACES
              MOVE PT-A02-01-OPC-IND-GARA TO WSS-A02-IND-GARA. 
                
      *ERROR SI NO SE CARGO NINGUN CONDICION GARANTIA
           IF WSS-A02-IND-GARA NOT > SPACES
                MOVE WCC-MSG05
                                      TO WSS-ERR-IND-GARA-02
                MOVE WSS-ERR-IND-GARA TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND    TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025           TO QUE-LITM
                MOVE QUE-PUT         TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-VALIDA-PARAMETROS-TABLAS.

      *VALIDA DIA DE VENCIMIENTO (NUMERICO)
           MOVE WSS-BGT-DIA-VEN TO NUM-NUME
           MOVE NUM-ZERO-S TO NUM-ZERO
           MOVE NUM-SGNO-S TO NUM-SGNO
           MOVE 2 TO NUM-NENT
           MOVE 0 TO NUM-NDCM
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO WSS-BGT-DIA-VEN
               MOVE NUM-NN9V TO WSS-BGT-DIA-VEN-NUM
           ELSE
               MOVE NUM-MENS         TO WSS-ERR-VAL-DVEN-02
               MOVE WSS-ERR-VAL-DVEN TO WSS-ERR-SEND-MENS
               MOVE WSS-ERR-SEND TO QUE-ITEM
               MOVE WSS-QUE-TR-COLA TO QUE-COLA
               MOVE +1025 TO QUE-LITM
               MOVE QUE-PUT TO QUE-CMND
               PERFORM GNS-PRO-QUE
               GO TO FIN-VALIDA-PARAMETROS-TABLAS.

      *SI YA VIENE SEP ENTRE VEN EN MENSAJE, SE DEJA ESE.
           IF PT-A02-01-NOP-NUM-SEVE > SPACES
              GO TO NUM-SEVE-YA-ASIG.

      *VALIDA SEPARACION ENTRE VEN (NUMERICO)
           MOVE WSS-A02-NUM-SEVE TO NUM-NUME
           MOVE NUM-ZERO-S TO NUM-ZERO
           MOVE NUM-SGNO-S TO NUM-SGNO
           MOVE 3 TO NUM-NENT
           MOVE 0 TO NUM-NDCM
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO WSS-A02-NUM-SEVE
               MOVE NUM-NN9V TO WSS-A02-NUM-SEVE-NUM
           ELSE
               MOVE NUM-MENS         TO WSS-ERR-NUM-SEV2-02
               MOVE WSS-ERR-NUM-SEV2 TO WSS-ERR-SEND-MENS
               MOVE WSS-ERR-SEND TO QUE-ITEM
               MOVE WSS-QUE-TR-COLA TO QUE-COLA
               MOVE +1025 TO QUE-LITM
               MOVE QUE-PUT TO QUE-CMND
               PERFORM GNS-PRO-QUE
               GO TO FIN-VALIDA-PARAMETROS-TABLAS.

           PERFORM LEE-SEP-VCTO-PVC.
           IF WSS-ERR-SEND-MENS > SPACES
              GO TO FIN-VALIDA-PARAMETROS-TABLAS.

           MOVE WSS-A02-NUM-SEVE-NUM TO PT-A02-01-NOP-NUM-SEVE-NUM.
           MOVE WSS-A02-NOP-IND-UTSV TO PT-A02-01-NOP-IND-UTSV.


       NUM-SEVE-YA-ASIG.
           MOVE PT-A02-01-NOP-FEC-FPVC TO WSS-FEC-FVEN.

       FIN-VALIDA-PARAMETROS-TABLAS.
           EXIT.
      *----------------------------------------------------
       1ER-VEN-EVC-INT SECTION.
       INI-1ER-VEN-EVC-INT.
      *
      *LOGICA PARA FECHA PRIMER VENCIMIENTO DE EVC DE INTERESES

      *SE CALCULA FECHA 1ER VENCIMIENTO EVC INTERESES
           MOVE PT-A02-01-NOP-FEC-FCUR TO FEC-FECH.

           IF WSS-BGT-DIA-VEN <= FEC-ITM1
      *SUMA 1 PERIODO
              PERFORM FEC-SUM-1PER.

      *SE CAMBIA DIA DE VENCIMIENTO POR EL DEFINIDO
           MOVE WSS-BGT-DIA-VEN TO FEC-ITM1.

           MOVE FEC-FECH TO PT-A02-01-NOP-FEC-FPVC.
      *    

       FEC-FPVC-YA-ASIG.
           MOVE WSS-FEC-FVEN TO FEC-FEC2.

           MOVE PT-A02-01-NOP-FEC-FCUR TO FEC-FEC1.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.

           IF NOT FEC-STAT-OKS
                MOVE FEC-FEC1         TO WSS-ERR-FEC-DIFE-02
                MOVE FEC-FEC1         TO WSS-ERR-FEC-DIFE-04
                MOVE FEC-MENS         TO WSS-ERR-FEC-DIFE-06
                MOVE WSS-ERR-FEC-DIFE     TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-1ER-VEN-EVC-INT
           ELSE
                MOVE FEC-NDIA TO WSS-TOT-DIA.
                
      *SE CALCULA EL NRO VENCIMIENTOS QUE TENDRA EVC INTERESES

           IF PT-A02-01-NOP-IND-UTSV = WCC-D
               MOVE FEC-DIF-DIA TO FEC-CMND
           ELSE
           IF PT-A02-01-NOP-IND-UTSV = WCC-M
               MOVE FEC-DIF-MES TO FEC-CMND
           ELSE
           IF PT-A02-01-NOP-IND-UTSV = WCC-A
               MOVE FEC-DIF-ANO TO FEC-CMND.

      *DIFERENCIA ENTRE FECHA CURSE Y FECHA VENCIMIENTO
           MOVE  PT-A02-01-NOP-FEC-FCUR  TO FEC-FEC1.
           MOVE  WSS-FEC-FVEN            TO FEC-FEC2.
           MOVE  FEC-FORM-FEC            TO FEC-FORM.
           PERFORM CAL-FEC.

           IF PT-A02-01-NOP-IND-UTSV = WCC-D
               MOVE FEC-NDIA TO WSS-PZO-CRED
           ELSE
           IF PT-A02-01-NOP-IND-UTSV = WCC-M
               MOVE FEC-NMES TO WSS-PZO-CRED
           ELSE
           IF PT-A02-01-NOP-IND-UTSV = WCC-A
               MOVE FEC-NANO TO WSS-PZO-CRED.

           DIVIDE WSS-PZO-CRED BY PT-A02-01-NOP-NUM-SEVE-NUM
                           GIVING PT-A02-01-NOP-NUM-VIGU-NUM.

           IF PT-A02-01-NOP-NUM-VIGU-NUM NOT > ZEROES
              MOVE WCC-1 TO PT-A02-01-NOP-NUM-VIGU-NUM.
              
      *SE VERIFICA 1 PERIODO MAS
      *COMPARA FECHA VEN Y FECHA VEN (CON DIA DE VENCIMIENTO)

           MOVE WSS-FEC-FVEN        TO WSS-FEC-FPVN.
           MOVE WSS-BGT-DIA-VEN-NUM TO WSS-NUM-DPVN.

           MOVE WSS-NUM-SVEN  TO WSS-NUM-SMAX.
           MOVE WSS-NUM-AVEN  TO WSS-NUM-AMAX.
           MOVE WSS-NUM-MVEN  TO WSS-NUM-MMAX.
           MOVE WSS-NUM-DVEN  TO WSS-NUM-DMAX.

           MOVE WSS-NUM-SPVN  TO WSS-NUM-STMP.
           MOVE WSS-NUM-APVN  TO WSS-NUM-ATMP.
           MOVE WSS-NUM-MPVN  TO WSS-NUM-MTMP.
           MOVE WSS-NUM-DPVN  TO WSS-NUM-DTMP.

      *SI FECHA VEN ES MENOR, ENTONCES CABE 1 VENCIMIENTO (INT) MAS
           IF WSS-FEC-FMAX > WSS-FEC-FTMP AND
              WSS-IND-SPER NOT = WCC-S
              ADD WCC-1 TO PT-A02-01-NOP-NUM-VIGU-NUM.

       FIN-1ER-VEN-EVC-INT.
           EXIT.
      *----------------------------------------------------
       BUS-CTA-CLTE SECTION.
       INI-BUS-CTA-CLTE.

           MOVE PT-A02-01-DBC-NUM-ICLI TO DBC-NUM-ICLI IN DBC.
           MOVE PT-A02-01-DBC-IND-ICLI TO DBC-IND-ICLI IN DBC.
           MOVE PT-A02-01-DBC-GLS-ICLI TO DBC-GLS-ICLI IN DBC.

           IF PT-A02-01-FRM-IND-ICYA = WSS-IND-TCYA-CTBL
                MOVE WSS-COD-TCYA-CTBL TO PT-046-02-CYA-IND-TCYA
                MOVE SPACES            TO PT-A02-01-CYA-CAI-ICYA
                MOVE SPACES            TO PT-A02-01-CYA-IIC-ICYA
                GO TO END-BUS-CTA-CLTE.

           MOVE 'COL'       TO FIO-SIST.
           MOVE 'COL'       TO TAB-COD-SIST.
           MOVE 'VSN'       TO TAB-COD-TTAB IN TAB.
           MOVE 'RUTAUXRCC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                MOVE TAB-GLS-DATA IN TAB   TO WSS-GLS-DATA-RAUX
                MOVE WSS-GLS-DATA-RAUX-NUM TO WSS-NUM-RAUX.

           IF PT-A02-01-FRM-IND-ICYA NOT = WSS-IND-TCYA-OBLI
                MOVE PT-A02-01-FRM-IND-ICYA TO WSS-ERR-IND-TCYA-01
                MOVE WSS-ERR-IND-TCYA TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-BUS-CTA-CLTE.

           MOVE WSS-COD-TCYA-CCMA TO PT-046-02-CYA-IND-TCYA.

           PERFORM BUS-CTE-CLI.

           IF BCC-GLS-MENS > SPACES
                MOVE BCC-GLS-MENS TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-BUS-CTA-CLTE.

           
           IF PT-A02-01-CYA-IIC-ICYA-NUM NOT > ZEROES
                MOVE BCC-CAI-IOPE TO PT-046-02-CYA-CAI-ICYA
                MOVE BCC-IIC-IOPE TO PT-046-02-CYA-IIC-ICYA
                GO TO END-BUS-CTA-CLTE.

           MOVE PT-A02-01-CYA-CAI-ICYA TO PT-046-02-CYA-CAI-ICYA.
           MOVE PT-A02-01-CYA-IIC-ICYA TO PT-046-02-CYA-IIC-ICYA.


       END-BUS-CTA-CLTE.

       FIN-BUS-CTA-CLTE.
           EXIT.

      *----------------------------------------------------
       LEE-SEGUROS-A02 SECTION.
       INI-LEE-SEGUROS-A02.
           IF   PT-A02-01-SGS-COD-SG01 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG01 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG02 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG02 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG03 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG03 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A02-01-SGS-COD-SG04 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG04 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG05 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG05 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG06 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG06 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG07 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG07 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A02-01-SGS-COD-SG08 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG08 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A02-01-SGS-COD-SG09 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG09 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG10 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG10 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG11 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG11 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG12 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG12 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG13 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG13 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG14 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG14 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG15 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG15 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG16 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG16 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG17 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG17 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG18 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG18 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG19 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG19 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG20 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG20 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG21 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG21 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG22 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG22 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG23 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG23 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG24 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG24 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG25 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG25 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG26 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG26 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG27 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG27 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG28 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG28 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG29 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG29 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A02-01-SGS-COD-SG30 NOT > SPACES
                  GO TO FIN-LEE-SEGUROS-A02.

           ADD WCC-1 TO WSS-SGS-INP-TOT.

           MOVE PT-A02-01-SGS-COD-SG30 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

       FIN-LEE-SEGUROS-A02.
           EXIT.

      *----------------------------------------------------
       ROC-PPC-OCC SECTION.
       INI-ROC-PPC-OCC.
      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = PPC >>>>>>>>>>>>>>>>>>>>

           MOVE SPACES         TO RCC-CIC-IOPE IN RCC-VARI.
           MOVE SPACES         TO RCC-IDC-ICLI IN RCC-VARI.

           MOVE PT-A02-01-DBC-NUM-ICLI TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-VRF-ICLI TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-IND-ICLI TO RCC-IND-ICLI IN RCC-VARI.
           MOVE PT-A02-01-DBC-GLS-ICLI TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE SPACES                 TO RCC-IND-RTBL IN RCC-VARI.
           MOVE ZEROES                 TO RCC-IND-COMP IN RCC-VARI.
           MOVE PT-A02-AHDR            TO WSS-HDR.

           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.
           MOVE WSS-HDR-TIPC-02        TO RCC-COD-TCNL IN RCC-VARI.

           MOVE SPACES                 TO RCC-COD-CNAL IN RCC-VARI.

           IF RCC-COD-TCNL IN RCC-VARI = WSS-CTE-110
                MOVE ZEROES TO RCC-COD-CNAL IN RCC-VARI
           ELSE
                MOVE WSS-CTE-010 TO RCC-COD-TCNL IN RCC-VARI
                MOVE PT-A02-01-OPC-COD-OFOC TO
                            RCC-COD-CNAL IN RCC-VARI.

           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-TOOC TO RCC-COD-TOOC IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-AOOC TO RCC-COD-AOOC IN RCC-VARI.
           MOVE WSS-TOT-DIA            TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE WCC-D                  TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE WCC-CUR                TO RCC-COD-EVEN IN RCC-VARI.
           MOVE WCC-PPC                TO RCC-COD-CPTO IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-TCAR IN RCC-VARI.
           MOVE PT-A02-01-OPC-VAL-CRED-NUM TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCMO IN RCC-VARI.
           MOVE PT-A02-01-OPC-VAL-CRED-NUM TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VSOP IN RCC-VARI.
           MOVE PT-A02-01-NOP-NUM-VIGU-NUM TO RCC-VAL-FINA IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCFN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-INTE IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-VASG IN RCC-VARI.
           MOVE PT-A02-01-OPC-COD-VCOC TO RCC-COD-VCVA IN RCC-VARI.

           MOVE PT-A02-01-NOP-FEC-FCUR TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FCOL IN RCC-VARI.


           MOVE WSS-FEC-FVEN TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FVEN IN RCC-VARI.

           MOVE WCC-CON      TO RCC-COD-TCON IN RCC-VARI.
           MOVE WCC-S        TO RCC-OFRM-SRV IN RCC-VARI.
           MOVE FIO-MSFL     TO RCC-MSFL     IN RCC-VARI.

           MOVE TSK-TERM-ALF  TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE +490         TO RCC-LIDD.

           MOVE RCC-CMMA     TO SYS-CMMA.
           MOVE SYS-LINK     TO SYS-CMND.
      *     LINK TABPSRCC RCC-COD-CPTO = PPC
           MOVE WCC-TABPSRCC TO SYS-PROG.
           MOVE RCC-TCMA     TO SYS-TCMA.

           PERFORM GNS-PRO-SYS.

           MOVE SYS-CMMA TO RCC-CMMA.
           MOVE RCC-MSFL TO FIO-MSFL.

           MOVE ZEROES TO QUE-NITM.

       CIC-ROC-PPC-QUE.

           ADD WCC-1 TO QUE-NITM.

           MOVE ZEROES TO WSS-IDX-IROC.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.

           MOVE QUE-GET TO QUE-CMND.
           MOVE RCC-LEN-TSSGS TO QUE-LITM.
           PERFORM GNS-PRO-QUE.

           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO OSG-APL-VEC IN OSG-VARI(1)
               MOVE WCC-PPCG TO WSS-ERR-NUM-CMAX-05
               MOVE QUE-ITEM TO OSG-APL-VEC IN OSG-VARI(1)
               MOVE OSG-SGS-SGV-TAMO IN OSG-VARI(1)
                     TO WSS-POC-VAL-CMAX.

           MOVE PT-A02-01-OPC-VAL-CRED-NUM TO WSS-ERR-NUM-CMAX-02.
           MOVE WSS-POC-VAL-CMAX           TO WSS-ERR-NUM-CMAX-04.

           IF PT-A02-01-OPC-VAL-CRED-NUM > WSS-POC-VAL-CMAX
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-ERR-NUM-CMAX TO WSS-ERR-SEND-MENS
                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE +1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE
                GO TO FIN-ROC-PPC-OCC.

       CIC-ROC-PPC-OCC.

           ADD WCC-1 TO WSS-IDX-IROC.

       FIN-ROC-PPC-OCC.
           EXIT.
