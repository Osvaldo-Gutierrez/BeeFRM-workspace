*%! Codigo adicional para programa
*% IF SETTAG
*% FNCPQ = "111002"
*% VSNPQ = "11.10.11"
*% FNCPU = "111002"
*% VSNPU = "11.10.11"
*% END
*% HDR_CST = FALSE
*% PGM_PTC = TRUE
*% NO_TIENE_TIMESTAMP = TRUE
*% IF CMT_ID
      *<<<< CMT_ID
      * ISP-INI 07/11/2011 POR PROYECTO
      * Proyecto     : 06-11-2011 1110_02 BCI CGM Log tablas POC y PVC
      * Modificacion : 06/11/2011 Ivan Silva P.
      * Objetivos    : Implementar log de administrador
      * Etiqueta de  : ISP-INI 06-11-2011 1110_02 BCI
      *                CGM Log para tablas POC y PVC
      * ISP-FIN
      *>>>> CMT_ID
*% END
*% IF WSS
      *<<<< WSS
      * ISP-INI 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
       COPY GNSWGCPT.
       01  WSS-VARI.
           03  WSS-KEY-IPVC.
               05  WSS-COD-VCOC                      PIC X(06).
               05  WSS-COD-COOC.
                   07  WSS-COD-TOOC                  PIC X(03).
                   07  WSS-COD-AOOC                  PIC X(03).
           03  WSS-NUM-NFEC             VALUE 0      PIC 9(03).
           03  WSS-FEC-NFE1.
               05  WSS-NUM-DFE1         VALUE 0      PIC 9(02).
               05  WSS-NUM-MFE1         VALUE 0      PIC 9(02).
               05  WSS-NUM-SFE1         VALUE 0      PIC 9(02).
               05  WSS-NUM-AFE1         VALUE 0      PIC 9(02).
           03  WSS-FEC-NFE2.
               05  WSS-NUM-DFE2         VALUE 0      PIC 9(02).
               05  WSS-NUM-MFE2         VALUE 0      PIC 9(02).
               05  WSS-NUM-SFE2         VALUE 0      PIC 9(02).
               05  WSS-NUM-AFE2         VALUE 0      PIC 9(02).
      * ISP-FIN 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
      * ISP-INI 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
       COPY COLBRLAP.
       77  WSS-COD-ENTI         VALUE 'PVC'        PIC X(03).
      * ISP-FIN 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
      * ISP-INI 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LAP-REQA==.
      * ISP-FIN 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
      *>>>>
*% END
*% IF INI_FIO_IBM
      *<<<< INI_FIO
      * ISP-INI 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
           PERFORM GET-FHOY.
      * ISP-FIN 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
      *>>>> INI_FIO
*% END
*% IF INI_CMN_ING
      *<<<<
           MOVE ZEROES TO PVC-FEC-FTRN IN PVC.
           MOVE ZEROES TO PVC-HRA-HRTR IN PVC.
      *>>>>
*% END
*% IF FIN_HBL_KEY
      *<<<< FIN_HBL_KEY
           MOVE '1' TO FRM-CPIM-AEY.
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
           MOVE '1' TO FRM-CPIM-AEY.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<<
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO PVC-NUM-DTRN IN PVC.
           MOVE HOY-MHOY TO PVC-NUM-MTRN IN PVC.
           MOVE HOY-SHOY TO PVC-NUM-STRN IN PVC.
           MOVE HOY-AHOY TO PVC-NUM-ATRN IN PVC.
      *>>>>
*% END
*% IF EOF
      *<<<<
        COPY GNSBPFEC.
        COPY GNSBGCPT.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING LAP POC
      * ISP-INI 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
            PERFORM PRO-ING-REG-LAP.
      * ISP-FIN 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
      *>>>> FIN_CMN_ING LAP POC
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI LAP POC ISP-INI
      * ISP-INI 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
            PERFORM PRO-ELI-REG-LAP.
      * ISP-FIN 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
      *>>>> FIN_CMN_ELI LAP POC ISP-FIN
*% END
*% IF CMN_MOD_RET
      *<<<< CMN_MOD_RET LAP POC ISP-INI
      * ISP-INI 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
            PERFORM PRO-MOD-ANT-REG-LAP.
      * ISP-FIN 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
      *>>>> CMN_MOD_RET LAP POC ISP-FIN
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD LAP POC ISP-INI
      * ISP-INI 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
            PERFORM PRO-MOD-DES-REG-LAP.
      * ISP-FIN 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
      *>>>> FIN_CMN_MOD LAP POC ISP-FIN
*% END
*% IF EOF
      *<<<< EOF
      * ISP-INI 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
       COPY COLBFLAP.

*% IF PGM_PU
       PRO-MOD-ANT-REG-LAP  SECTION.
       INI-MOD-ANT-REG-LAP.
      *-----------------------------
           MOVE   SPACES                  TO  LAP.
           MOVE   'MOD'                   TO  LAP-COD-EVEN IN LAP.
           MOVE   'M'                     TO  LAP-COD-TACC IN LAP
                                              LAP-COD-STAT IN LAP.
           MOVE   'ANT'                   TO  LAP-COD-INST IN LAP.
           MOVE     1                     TO  LAP-NUM-CLAP IN LAP
                                              LAP-NUM-CPOC IN LAP
                                              LAP-NUM-CAUT IN LAP.
           PERFORM PRO-GRABA-REG-LAP.
       FIN-MOD-ANT-REG-LAP.
            EXIT.

       PRO-MOD-DES-REG-LAP  SECTION.
       INI-MOD-DES-REG-LAP.
      *-----------------------------
           MOVE   SPACES                  TO  LAP.
           MOVE   'MOD'                   TO  LAP-COD-EVEN IN LAP.
           MOVE   'M'                     TO  LAP-COD-TACC IN LAP
                                              LAP-COD-STAT IN LAP.
           MOVE   'DES'                   TO  LAP-COD-INST IN LAP.
           MOVE     2                     TO  LAP-NUM-CLAP IN LAP
                                              LAP-NUM-CPOC IN LAP
                                              LAP-NUM-CAUT IN LAP.
           PERFORM PRO-GRABA-REG-LAP.
       FIN-MOD-DES-REG-LAP.
           EXIT.
      *
       PRO-ING-REG-LAP  SECTION.
       INI-ING-REG-LAP.
      *-------------------------
           MOVE   SPACES                  TO  LAP.
           MOVE   'ING'                   TO  LAP-COD-EVEN IN LAP.
           MOVE   'I'                     TO  LAP-COD-TACC IN LAP
                                              LAP-COD-STAT IN LAP.
           MOVE   'N/A'                   TO  LAP-COD-INST IN LAP.

           MOVE     1                     TO  LAP-NUM-CLAP IN LAP
                                              LAP-NUM-CPOC IN LAP
                                              LAP-NUM-CAUT IN LAP.

           PERFORM PRO-GRABA-REG-LAP.
       FIN-ING-REG-LAP.
           EXIT.
      *
       PRO-ELI-REG-LAP  SECTION.
       INI-ELI-REG-LAP.
      *-------------------------
           MOVE   SPACES                  TO  LAP.
           MOVE   'ELI'                   TO  LAP-COD-EVEN IN LAP.
           MOVE   'E'                     TO  LAP-COD-TACC IN LAP
                                              LAP-COD-STAT IN LAP.
           MOVE   'N/A'                   TO  LAP-COD-INST IN LAP.

           MOVE     1                     TO  LAP-NUM-CLAP IN LAP
                                              LAP-NUM-CPOC IN LAP
                                              LAP-NUM-CAUT IN LAP.
           PERFORM PRO-GRABA-REG-LAP.
       FIN-ELI-REG-LAP.
           EXIT.
      *
       PRO-GRABA-REG-LAP  SECTION.
      *---------------------------
       INI-GRABA-REG-LAP.
           MOVE   '1.0'                   TO  LAP-COD-VERS IN LAP.
           MOVE   'PVC'                   TO  LAP-COD-ENTF IN LAP
                                              LAP-COD-ENTO IN LAP
                                              LAP-COD-ENTA IN LAP
                                              LAP-COD-ENTI IN LAP.

           MOVE    HOY-FHOY               TO  LAP-FEC-FTRN IN LAP
                                              LAP-FEC-FLAP IN LAP
                                              LAP-FEC-FPOC IN LAP
                                              LAP-FEC-FAUT IN LAP.

           MOVE    HOY-HHOY               TO  LAP-HRA-HRTR IN LAP
                                              LAP-HRA-HLAP IN LAP
                                              LAP-HRA-HPOC IN LAP
                                              LAP-HRA-HAUT IN LAP.

           MOVE  PVC-KEY-IPVC IN PVC      TO  LAP-COD-KLAP IN LAP.

           MOVE  EIBTRMID                 TO  LAP-COD-OTRN IN LAP.
           MOVE  SCR-USER                 TO  LAP-COD-ATRN IN LAP
                                              LAP-COD-AUTO IN LAP.
           MOVE  EIBTRNID                 TO  LAP-COD-TCIC IN LAP.
           MOVE  SCR-CMND                 TO  LAP-COD-CMND IN LAP.
           MOVE  LAP-COD-COME IN PVC-FLD  TO  LAP-COD-COME IN LAP.
           MOVE  PVC                      TO  LAP-COD-CONT IN LAP.

           MOVE    FIO-PUT                TO  FIO-CMND.
           PERFORM COL-FIO-LAP.

       FIN-GRABA-REG-LAP.
           EXIT.
*% END
      * ISP-FIN 1110_02 BCI CGM Log para tablas COL- POC y PVC
      *         VSN=$11.10.11$
      *>>>>
*% END
*% IF FIN_PRO_ALL
      *<<<< FIN_PRO_ALL
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
           IF SCR-CCPP = 'ELI'
               PERFORM UNP-LAP-PVC
               PERFORM FST-FLD-PVC.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
      *>>>>
*% END
*% IF FIN_SCR_TRL
*% IF PGM_PU
      *<<<< FIN_PRO_ALL
      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
           IF SCR-CCPP = 'ELI'
               PERFORM UNP-LAP-PVC
               PERFORM FST-FLD-PVC.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
*% END
*% END
*% IF FIN_GET_ACC
      *<<<< FIN_GET_ACC

      * ISP-INI 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC
           IF SCR-CCPP = 'ELI'
           IF FRM-FFLD = FRM-FFLD-RET OR
              FRM-FFLD = FRM-FFLD-PF10
           IF LAP-COD-COME IN PVC-FLD NOT > SPACES
               MOVE 'COMEPVCOBL' TO MSG-COD-MENS
               MOVE 'COL'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC
                    TO FRM-MENS
                       PVC-GLS-MENS
               PERFORM UNP-LAP-PVC
               PERFORM FST-FLD-PVC
               PERFORM SCR-PUTA
               MOVE SCR-NTRN TO SYS-NTRN
               MOVE SCR-INST-GCS TO SCR-INST
               MOVE SCR-VARI TO SYS-CMMA
               MOVE SCR-TCMA TO SYS-TCMA
               MOVE SYS-RTRN TO SYS-CMND
               PERFORM GNS-PRO-SYS.
      * ISP-FIN 06-11-2011 1110_02 BCI CGM Log para tablas POC y PVC

      *>>>>
*% END
