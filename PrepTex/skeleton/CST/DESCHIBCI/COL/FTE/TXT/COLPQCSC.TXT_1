*%! Codigo adicional
*% GNSTCA_ORIG = 3000
*% GNSTCA = 3000
*% LARGO_TOTAL_COMMAREA = 3000
*% NO_TIENE_TIMESTAMP = TRUE
*%! IF PGM_CHI AND PGM_BCI
*% PGM_PTC = TRUE
*%! END
*% IF CMT_ID
      *-----------------------------------------------------------------
      *MODIFICACIONES:
      *--------------
      *OBJETIVO: ACTUALIZAR COPY NECESARIOS PARA MANTENCION
      *PROYECTO: LOF CON CANCELACIONES
      *FECHA   : AGOSTO DE 2009
      *AUTOR   : CHC
      *ETIQUETA: *AFRI-INI/LOF/CHC/08-2009
      *-----------------------------------------------------------------
      *OBJETIVO: INCORPORAR COPY COLBBDPS
      *PROYECTO: DEVOLUCION PRIMA DE SEGUROS POR PREPAGO DE CREDITOS
      *FECHA   : ENERO-2014
      *AUTOR   : BEE-TEAM [PVC]
      *ETIQUETA: *PVC-INI 28-01-2014 DEVOL. PRIMA SEGUROS POR PREPAGO
      *-----------------------------------------------------------------
      *OBJETIVO: CAMBIAR LECTURA ENTIDAD IMP POR TABLA TIM
      *PROYECTO: ITE - AUMENTO DE DECIMALES
      *FECHA   : ENERO DE 2013
      *AUTOR   : SOP
      *ETIQUETA: *AFRI-INI/ITE/SOP/01-2013
      *-----------------------------------------------------------------
      *OBJETIVO: CORREGIR SIMULACION DE CANCELACIONES DE OPERACIONES
      *          EN UF CASTIGADAS
      *PROYECTO: Error en Simulacisn CICSPRO
      *FECHA   : OCTUBRE 2013
      *AUTOR   : RGD
      *ETIQUETA: *RGD-INI 03/10/2013 OPE UF CAS
      *-----------------------------------------------------------------
      *OBJETIVO: AGREGAR COMISION CXE
      *
      *PROYECTO: ERROR SIMULADOR DE CANCELACIONES
      *FECHA   : JULIO 2014
      *AUTOR   : NGA
      *ETIQUETA: * NGA INI Simulador de Cancelaciones 24-07-2014
      *-----------------------------------------------------------------
      * PROYECTO: SELECCION DE SEGUROS A DEVOLVER
      * FECHA   : NOVIEMBRE 2014
      * AUTOR   : AFRI-CGC
      * ETIQUETA: *AFRI-INI 03-NOV-2014 SELECCION DE SEGUROS A DEVOLVER
      *----------------------------------------------------------------
      *-----------------------------------------------------------------
      * MANTENCION:
      *
      * PROYECTO: CONTROL PREPAGO CREDITOS COMERCIALES > 5000UF
      * AUTOR:    MARCO PENA SILVA
      * OBJETIVO: INCLUIR COPYS DE ENTIDAD CEN
      * ETIQUETA: * MPS-INI CONTROL PREPAG CRED COM > 5000UF 23/12/2015
      *-----------------------------------------------------------------
      * PROYECTO: ASEGURAMIENTO
      * AUTOR:    AFRI
      * OBJETIVO: COBRO COMISION NORMALIZA
      * ETIQUETA: *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *---------------------------------------------------------------*
*% END
*% IF FIN_SCR_VARI
           03 SCR-NUM-PANT               PIC 9(0005).
           03 SCR-CSC-FLD                PIC X(1100).
*% END
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.

       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRCIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.

       COPY TABBRTIO.
       COPY TABBRCAM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBRUSR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.

      * MPS-INI USO DE LA CEN EN EL CANCELADOR 23/12/2015
       COPY COLBRCEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CEN-REQA==.
      * MPS-FIN USO DE LA CEN EN EL CANCELADOR 23/12/2015
       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY COLBRPCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PCP-REQA==.
       COPY COLBRDIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DIC-REQA==.
       COPY COLBRCYA.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY COLBRAUT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
       COPY COLBRVEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY COLBRRCV.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY COLBRTOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY COLBRRDT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
       COPY COLBRDLC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY COLBREVC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY COLBRICG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY COLBRRDC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY COLBRCOM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-COM-REQA==.
       COPY COLBREJC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EJC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EJE-REQA==.
       COPY COLBRITR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY COLBRPOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       COPY COLBRROV.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.

       COPY SGCBRRCO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY SGCBROPE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY SGCBRDCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY SGCBRDCE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==SCR-CAN-REQA==.

       COPY COLBRIXT.
       COPY COLBREX1.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IXT-REQA==.
       COPY COLBRCXE.
       COPY COLWGCXE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CXE-REQA==.
       COPY COLWGRFV.
      *AFRI-INI/ITE/SOP/01-2013
       COPY COLWGTIM.
      *COPY COLBRIMP.
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IMP-REQA==.
      *AFRI-FIN/ITE/SOP/01-2013
       COPY DEUBRCRI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CRI-REQA==.
       COPY COLWGVEN.
       COPY COLWGCTO.
       COPY COLWGECA.
       COPY COLWGPVE.
       COPY COLWGPCP.
       COPY COLWGNOR.
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
       COPY COLWGGCN.
       COPY COLWGHNJ.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA

       COPY GNSWGPES.
       COPY COLWGINT.
       COPY GNSWGCVI.

       COPY COLBRTMC.
       COPY COLWGENG.
       COPY COLWGVIN.
       COPY COLWICAN.

       COPY GNSWCVRF.
       COPY GNSWGCIC.
       COPY GNSWGIDC.
       COPY GNSWVVRF.
       COPY TABWGTXC.

       COPY COLBRIYC.
       COPY COLW1CAN.
      *AFRI-INI/LOF/CHC/08-2009
       COPY LDCBRRDC REPLACING RDC BY RDL.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDL-REQA==.
       COPY LDCBRLCC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LCC-REQA==.
       COPY LDCBRRLO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RLO-REQA==.
       COPY LDCBRCLF.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.
       COPY BGLBRGDG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GDG-REQA==.
       COPY BGLBRGES.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GES-REQA==.
       COPY BGLBRGMO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GMO-REQA==.
       COPY BGLBRGVT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-GVT-REQA==.
       COPY BGLBRTAG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-BDO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AXU-REQA==.
      *AFRI-FIN/LOF/CHC/08-2009
      *AFRI-INI 03-NOV-2014 SELECCION DE SEGUROS A DEVOLVER
       COPY COLWGDPS.
      *AFRI-FIN 03-NOV-2014 SELECCION DE SEGUROS A DEVOLVER
       COPY COLW2CAN.
      *AFRI-INI/CALCULA-MORA 03062009
           03  WSS-FEC-RESV                         PIC X(08).
      *AFRI-FIN/CALCULA-MORA 03062009
      *AFRI-INI/04-06-2012 ERROR EN SERVICIO
           03  WSS-I                                PIC 9(03).
      *AFRI-FIN/04-06-2012 ERROR EN SERVICIO
           03  WSS-FEC-FVE1.
               05  WSS-NUM-SVE1                      PIC X(02).
               05  WSS-NUM-AVE1                      PIC X(02).
               05  WSS-NUM-MVE1                      PIC X(02).
               05  WSS-NUM-DVE1                      PIC X(02).
           03  WSS-IND-COMI                          PIC X(01).
           03  WSS-IND-AFEC                          PIC X(01).
           03  WSS-IND-IDLC                          PIC X(01).
           03  WSS-VAL-UF           VALUE ZEROES     PIC 9(11)V9(04).
           03  WSS-VAL-MORA         VALUE ZEROES     PIC 9(11)V9(04).
           03 WSS-IND-CANA          VALUE 'N'     PIC X(01).
           03  WSS-VAL-CMP2                COMP-2.
           03 WSS-DIAS-MORA          VALUE 0 PIC 9(03).
           03 WSS-DIAS-MORAP         VALUE 0 PIC 9(03).
           03 WSS-DIAS-MORA-BP       VALUE 0 PIC 9(03).
           03 WSS-COD-DAT2.
              05 WSS-IND-OCCA        VALUE SPACES    PIC X(01).
              05 WSS-GLS-FIL1        VALUE SPACES    PIC X(01).
           03 WSS-IND-CARG           VALUE SPACES    PIC X(01).
           03 WSS-DIAS-MORA-B        VALUE 0 PIC 9(03).
           03 WSS-DIAS-MORA-P        VALUE 0 PIC 9(03).
           03 WSS-MSC-CCAA           VALUE SPACES PIC X(05).
           03 WSS-MSC-CCAM           VALUE SPACES PIC X(05).
           03 WSS-MSC-CCAO           VALUE SPACES PIC X(05).
           03 WSS-SGV-FINA           COMP-3       PIC S9(11)V9(4).
           03 WSS-NUM-RCHK                        PIC 9(04).
           03 WSS-NUM-RLEI           VALUE ZEROS  PIC 9(08).
           03 WSS-NUM-RPRO           VALUE ZEROS  PIC 9(08).
           03 WSS-NUM-RERR           VALUE ZEROS  PIC 9(08).
           03 WSS-NUM-GIYC           VALUE ZEROS  PIC 9(08).
           03 WSS-MSG-MENS.
              05 WSS-MSG-PREV                     PIC X(09).
              05 WSS-MSG-TENT                     PIC X(01).
              05 WSS-MSG-FENT                     PIC X(01).
              05 WSS-MSG-SENT                     PIC X(01).
           03 WSS-MEN1.
              05 WSS-MEN1-1                       PIC X(15).
              05 WSS-MEN1-2                       PIC X(24).
           03 WSS-SGV-DIFE  VALUE +0              PIC S9(13)V9(05).
           03 WSS-SGV-DIFE-ALF                    PIC  X(24).
           03 WSS-SGV-DIFE-EDT REDEFINES WSS-SGV-DIFE-ALF
                               PIC --.---.---.---.---,-----.
           03 WSS-COD-CLAS       VALUE SPACES     PIC X(02).
           03 WSS-IND-EXCL       VALUE SPACES     PIC X(01).
           03 WSS-GLS-DAPP.
              05 WSS-NUM-DMRP    VALUE ZEROES     PIC 9(03).
              05 WSS-GLS-FILL                     PIC X(07).
           03 WSS-IND-PPAR       VALUE SPACES     PIC X(01).
           03 WSS-DMA-FMPP.
              05 WSS-DMA-DMPP    VALUE ZEROES     PIC 9(02).
              05 WSS-DMA-MMPP    VALUE ZEROES     PIC 9(02).
              05 WSS-DMA-SMPP    VALUE ZEROES     PIC 9(02).
              05 WSS-DMA-AMPP    VALUE ZEROES     PIC 9(02).
           03 WSS-FEC-FMPP.
              05 WSS-NUM-SMPP    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-AMPP    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-MMPP    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-DMPP    VALUE ZEROES     PIC 9(02).
           03 WSS-IND-CAUT       VALUE SPACES     PIC X(01).
           03 WSS-FEC-FPRO.
              05 WSS-NUM-DPRO    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-MPRO    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-SPRO    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-APRO    VALUE ZEROES     PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                     PIC 9(02).
              05 WSS-NUM-AFEC                     PIC 9(02).
              05 WSS-NUM-MFEC                     PIC 9(02).
              05 WSS-NUM-DFEC                     PIC 9(02).
           03 WSS-FEC-FMIN.
              05 WSS-NUM-DMIN        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MMIN        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-SMIN        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AMIN        VALUE ZEROS  PIC 9(02).
           03 WSS-FEC-FINI.
              05 WSS-NUM-DINI        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MINI        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-SINI        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AINI        VALUE ZEROS  PIC 9(02).
           03 WSS-FEC-FTER.
              05 WSS-NUM-STER        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-ATER        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MTER        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-DTER        VALUE ZEROS  PIC 9(02).
           03 WSS-FEC-FBOL.
              05 WSS-NUM-DBOL        VALUE ZEROES PIC 9(02).
              05 WSS-NUM-MBOL        VALUE ZEROES PIC 9(02).
              05 WSS-NUM-SBOL        VALUE ZEROES PIC 9(02).
              05 WSS-NUM-ABOL        VALUE ZEROES PIC 9(02).
           03 WSS-FEC-FUNO.
              05 WSS-NUM-SUNO        VALUE ZEROES PIC 9(02).
              05 WSS-NUM-AUNO        VALUE ZEROES PIC 9(02).
              05 WSS-NUM-MUNO        VALUE ZEROES PIC 9(02).
              05 WSS-NUM-DUNO        VALUE ZEROES PIC 9(02).
           03 WSS-FEC-FFCA.
              05 WSS-NUM-DFCA        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MFCA        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-SFCA        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AFCA        VALUE ZEROS  PIC 9(02).
           03 WSS-FEC-FPO1.
              05 WSS-NUM-SPO1    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-APO1    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-MPO1    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-DPO1    VALUE ZEROES     PIC 9(02).
           03 WSS-FEC-FPO2.
              05 WSS-NUM-SPO2    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-APO2    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-MPO2    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-DPO2    VALUE ZEROES     PIC 9(02).
           03 WSS-FEC-FPO3.
              05 WSS-NUM-SPO3    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-APO3    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-MPO3    VALUE ZEROES     PIC 9(02).
              05 WSS-NUM-DPO3    VALUE ZEROES     PIC 9(02).
           03 WSS-SGV-TINT      COMP-3            PIC S9(04)V9(03).
           03 WSS-GLS-MEN2           VALUE SPACES PIC X(40).
           03 WSS-AUX-APIN.
              05 FILLER                           PIC X(04).
              05 WSS-COD-APIN                     PIC X(08).
           03 WSS-RCV-KEY-ICAN.
              05 WSS-RCV-CIC-IOPC-P    VALUE SPACES PIC X(12).
              05 WSS-RCV-NUM-ICAN-P    VALUE ZEROS  PIC 9(03).
           03 WSS-AUX-COCM.
              05 FILLER                           PIC X(04).
              05 WSS-COD-COCM                     PIC X(08).
           03 WSS-COD-OFOC                        PIC X(03).
           03 WSS-COD-COOC                        PIC X(06).
           03 WSS-CIC-CTAB                        PIC X(03).
           03 WSS-CIC-ICYA       VALUE SPACES     PIC X(12).
           03 WSS-VRF-ICYA       VALUE SPACES     PIC X(01).
           03 WSS-NUM-OPCL      VALUE 0           PIC 9(06).
           03 WSS-NUM-SORG      VALUE 0           PIC 9(06).
           03 WSS-NUM-SORL      VALUE 0           PIC 9(06).
           03 WSS-NUM-CANG      VALUE 0           PIC 9(06).
           03 WSS-SGV-ACUM      VALUE 0 COMP-3    PIC S9(13)V9(02).
           03 WSS-AUX-TPAG      VALUE 0 COMP-3    PIC S9(13)V9(02).
           03 WSS-CNT-DIAS      VALUE 0           PIC 9(03).
           03 WSS-COD-CMSC           VALUE SPACES PIC X(01).
           03 WSS-VEN-KEY-IVEN.
              05 WSS-VEN-CIC-IOPC                 PIC X(12).
              05 WSS-VEN-NUM-IVEN                 PIC 9(03).
           03 WSS-IND-OTRO                        PIC X(01).
           03 WSS-OPC-KEEP                        PIC X(218).
           03 WSS-SGV-PROC COMP-3    VALUE +0     PIC S9(11)V9(04).
           03 WSS-SGV-COLO COMP-3    VALUE +0     PIC S9(11)V9(04).
           03 WSS-FEC-FIN1.
              05 WSS-NUM-DIN1        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-MIN1        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-SIN1        VALUE ZEROS  PIC 9(02).
              05 WSS-NUM-AIN1        VALUE ZEROS  PIC 9(02).
           03  WSS-GLS-ANO.
               05  WSS-GLS-ANO1                   PIC X(01).
               05  WSS-GLS-ANO2                   PIC X(01).
           03  WSS-COD-SPAC                       PIC X(01).
      *RGD-INI 03/10/2013 OPE UF CAS
           03 WSS-COD-VCOC                        PIC X(06).
      *RGD-FIN
      * NGA INI Simulador de Cancelaciones 24-07-2014
           03 WSS-CT-CCAC     VALUE 'CCMCAC'      PIC X(06).
           03 WSS-CT-CAC      VALUE 'CAC'         PIC X(03).
      * NGA FIN Simulador de Cancelaciones 24-07-2014

       01  WS-GLS-DATA-TIOS.
           02 WS-GLS-TIO   OCCURS 20  PIC X(03).
       01  WS-GLS-DATA-TIOS-VCD.
           02 WS-GLS-TIO-VCD OCCURS 20  PIC X(03).
       01  WS-GLS-DATA-BANCA.
           02 WS-SGV-MMIN             PIC 9(09)V9(04).
           02 WS-GLS-MONE             PIC X(06).
           02 WS-NUM-DIMC             PIC 9(02).
           02 WS-IND-TDMC             PIC X(01).
           02 WS-NUM-DIME             PIC 9(02).
           02 WS-IND-TDME             PIC X(01).
           02 WS-COD-PLAN  OCCURS 17  PIC X(01).
           02 WS-NUM-DIEM             PIC 9(02).
           02 WS-IND-TDEM             PIC X(01).
           02 WS-SGV-MMAX             PIC 9(09)V9(04).
       01  W-VARI-RIN.
           03 W-MVO-OPEC                          PIC X(08).
       01  HST-VARI.
           03 HST-MSC-TACC VALUE '*'              PIC X(01).
           03 HST-FEC-FFIN                        PIC X(08).


       01  PGM-STATUS.
********           03 PGM-STAT-OPC           VALUE '23'      PIC X(02).
********                 88 PGM-STAT-OPC-OKS    VALUE '00'.
********                 88 PGM-STAT-OPC-NUL    VALUE '  '.
           03 PGM-STAT-CYA           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CYA-OKS    VALUE '00'.
                 88 PGM-STAT-CYA-NUL    VALUE '  '.
           03 PGM-STAT-COM           VALUE '23'      PIC X(02).
                 88 PGM-STAT-COM-OKS    VALUE '00'.
                 88 PGM-STAT-COM-NUL    VALUE '  '.
           03 PGM-STAT-AUT           VALUE '23'      PIC X(02).
                 88 PGM-STAT-AUT-OKS    VALUE '00'.
                 88 PGM-STAT-AUT-NUL    VALUE '  '.
           03 PGM-STAT-DBC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-DBC-OKS    VALUE '00'.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
           03 PGM-STAT-VEN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-VEN-OKS    VALUE '00'.
                 88 PGM-STAT-VEN-NUL    VALUE '  '.
           03 PGM-STAT-RDC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RDC-OKS    VALUE '00'.
                 88 PGM-STAT-RDC-NUL    VALUE '  '.
           03 PGM-STAT-RCV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-RCV-OKS    VALUE '00'.
                 88 PGM-STAT-RCV-NUL    VALUE '  '.
           03 PGM-STAT-ITR           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ITR-OKS    VALUE '00'.
                 88 PGM-STAT-ITR-NUL    VALUE '  '.
           03 PGM-STAT-ICG           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ICG-OKS    VALUE '00'.
                 88 PGM-STAT-ICG-NUL    VALUE '  '.
           03 PGM-STAT-CAN           VALUE '23'      PIC X(02).
                 88 PGM-STAT-CAN-OKS    VALUE '00'.
                 88 PGM-STAT-CAN-NUL    VALUE '  '.
           03 PGM-STAT-ROV           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ROV-OKS    VALUE '00'.
                 88 PGM-STAT-ROV-NUL    VALUE '  '.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
       01  PAR-VARI.
           03 PAR-COD-TPAR                          PIC X(03).
           03 PAR-COD-PROG                          PIC X(03).
           03 PAR-COD-TPRO                          PIC X(03).
           03 PAR-COD-TFEC                          PIC X(03).
           03 PAR-COD-FPAR                          PIC X(10).
           03 PAR-COD-FPAR-R REDEFINES PAR-COD-FPAR.
              05 PAR-FEC-FPAR                       PIC X(08).
              05 PAR-GLS-FPAR                       PIC X(02).
           03 PAR-COD-STAT                          PIC 9(01).
           03 PAR-COD-MENS                          PIC X(12).
           03 PAR-COD-PAR1.
              05 PAR-COD-PA11                       PIC X(04).
              05 PAR-COD-PA12                       PIC X(03).
       01  WSS-AUXI.
           05 WSS-MSJS.
              07 WSS-MSJ0                              PIC X(22).
              07 FILLER                                PIC X(01).
              07 WSS-MSJ1                              PIC X(16).
              07 FILLER                                PIC X(01).
              07 WSS-MSJ2                              PIC X(22).
              07 FILLER                                PIC X(01).
              07 WSS-MSJ3                              PIC X(16).
       01  TBAN-VARI.
           03 TBAN-AUXI-TBAN                           PIC X(03).
           03  TBAN-IMAX                               PIC 9(02).
           03  TBAN-OMAX           VALUE 50            PIC 9(02).
           03  TBAN-VEC-TBAN.
               05 TBAN-TBAN    OCCURS 50 TIMES.
                  07  TBAN-COD-TBAN                    PIC X(03).
                  07  TBAN-NUM-NDIA                    PIC 9(02).
                  07  TBAN-FEC-FBAN.
                      09  TBAN-NUM-SBAN                PIC 9(02).
                      09  TBAN-NUM-ABAN                PIC 9(02).
                      09  TBAN-NUM-MBAN                PIC 9(02).
                      09  TBAN-NUM-DBAN                PIC 9(02).
                  07  TBAN-NUM-NDI2                    PIC 9(02).
                  07  TBAN-FEC-FBA2.
                      09  TBAN-NUM-SBA2                PIC 9(02).
                      09  TBAN-NUM-ABA2                PIC 9(02).
                      09  TBAN-NUM-MBA2                PIC 9(02).
                      09  TBAN-NUM-DBA2                PIC 9(02).
           03  TBAN-GLS-DATA.
               05  FILLER                              PIC X(10).
               05  TBAN-NUM-DREI                       PIC 9(02).
               05  FILLER                              PIC X(48).
           03  TBAN-FEC-FAUX.
               05  TBAN-NUM-SAUX                       PIC 9(02).
               05  TBAN-NUM-AAUX                       PIC 9(02).
               05  TBAN-NUM-MAUX                       PIC 9(02).
               05  TBAN-NUM-DAUX                       PIC 9(02).
           03  TBAN-FEC-FAU2.
               05  TBAN-NUM-SAU2                       PIC 9(02).
               05  TBAN-NUM-AAU2                       PIC 9(02).
               05  TBAN-NUM-MAU2                       PIC 9(02).
               05  TBAN-NUM-DAU2                       PIC 9(02).
           03  TBAN-I               VALUE ZEROES       PIC 9(02).
           03  TBAN-J               VALUE ZEROES       PIC 9(02).
       01  TBAP-VARI.
           03  TBAP-IMAX                               PIC 9(02).
           03  TBAP-OMAX           VALUE 50            PIC 9(02).
           03  TBAP-VEC-TBAN.
               05 TBAP-TBAN    OCCURS 50 TIMES.
                  07  TBAP-COD-TBAN                    PIC X(03).
                  07  TBAP-NUM-NDIA                    PIC 9(03).
                  07  TBAP-FEC-FBAN.
                      09  TBAP-NUM-SBAN                PIC 9(02).
                      09  TBAP-NUM-ABAN                PIC 9(02).
                      09  TBAP-NUM-MBAN                PIC 9(02).
                      09  TBAP-NUM-DBAN                PIC 9(02).
                  07  TBAP-NUM-NDI2                    PIC 9(03).
                  07  TBAP-FEC-FBA2.
                      09  TBAP-NUM-SBA2                PIC 9(02).
                      09  TBAP-NUM-ABA2                PIC 9(02).
                      09  TBAP-NUM-MBA2                PIC 9(02).
                      09  TBAP-NUM-DBA2                PIC 9(02).
           03  TBAP-I               VALUE ZEROES       PIC 9(02).
           03  TBAP-J               VALUE ZEROES       PIC 9(02).
       01  TPRO-VARI.
           03 TPRO-AUXI-TPRO                           PIC X(06).
           03  TPRO-IMAX                               PIC 9(02).
           03  TPRO-OMAX           VALUE 50            PIC 9(02).
           03  TPRO-VEC-TPRO.
               05 TPRO-TPRO    OCCURS 50 TIMES.
                  07  TPRO-COD-TPRO                    PIC X(06).
                  07  TPRO-NUM-NDIA                    PIC 9(02).
                  07  TPRO-FEC-FPRO.
                      09  TPRO-NUM-SPRO                PIC 9(02).
                      09  TPRO-NUM-APRO                PIC 9(02).
                      09  TPRO-NUM-MPRO                PIC 9(02).
                      09  TPRO-NUM-DPRO                PIC 9(02).
                  07  TPRO-NUM-NDI2                    PIC 9(02).
                  07  TPRO-FEC-FPR2.
                      09  TPRO-NUM-SPR2                PIC 9(02).
                      09  TPRO-NUM-APR2                PIC 9(02).
                      09  TPRO-NUM-MPR2                PIC 9(02).
                      09  TPRO-NUM-DPR2                PIC 9(02).
           03  TPRO-GLS-DATA.
               05  FILLER                              PIC X(10).
               05  TPRO-NUM-DREI                       PIC 9(02).
               05  FILLER                              PIC X(48).
           03  TPRO-FEC-FAUX.
               05  TPRO-NUM-SAUX                       PIC 9(02).
               05  TPRO-NUM-AAUX                       PIC 9(02).
               05  TPRO-NUM-MAUX                       PIC 9(02).
               05  TPRO-NUM-DAUX                       PIC 9(02).
           03  TPRO-FEC-FAU2.
           05  TPRO-NUM-SAU2                       PIC 9(02).
               05  TPRO-NUM-AAU2                       PIC 9(02).
               05  TPRO-NUM-MAU2                       PIC 9(02).
               05  TPRO-NUM-DAU2                       PIC 9(02).
           03  TPRO-I               VALUE ZEROES       PIC 9(02).
           03  TPRO-J               VALUE ZEROES       PIC 9(02).



       COPY GNSWGCPT.
       COPY GNSWGSTR.

       COPY COLWXCSC.
      *>>>>
      *<<<< WSS_DTC
       01 WSS-NUM-CCUR.
           03 WSS-NUM-ICUR-EDT  PIC  ZZ9.
           03 WSS-NUM-ICUR-ALF       PIC X(03).
           03 WSS-NUM-ICUR      REDEFINES
              WSS-NUM-ICUR-ALF       PIC 9(03).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
                MOVE TSK-TERM-ALF TO CSC-COD-TERM
                MOVE TSK-TERM-ALF TO CSC-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO CSC-COD-TERM
                MOVE EIBTRMID     TO CSC-COD-TERM-MAS.
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )
               MOVE SCR-CSC-FLD TO CSC-FLD
               GO TO FIN-INI.

           IF ( FRM-FFLD = FRM-FFLD-PF6 )
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
               ADD 1              TO QUE-NITM
               MOVE CSC-NOM-TSCSC TO QUE-COLA
               MOVE CSC-LEN-TSCSC TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                  MOVE SCR-CSC-FLD TO CSC-FLD
                  GO TO FIN-INI.
      **     PERFORM GET-FHOY.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-CSC
               PERFORM VAL-NUM-FLD-CSC
               PERFORM SCRL-TAB-CSC
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           MOVE OPC-CAI-IOPC IN CSC-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN CSC-FLD TO OPC-IIC-IOPC IN OPC.

      *RGD-INI 03/10/2013 OPE UF CAS
           MOVE OPC-COD-VCOC IN OPC TO WSS-COD-VCOC.
      *RGD-FIN
***********************************************

******* Se invoca a rutina Simula Cancelaciones

***********************************************
           PERFORM SIM-CAN.

*********Las siguientes lineas se incorporaron en SIM-CAN
           IF MSG-COD-MENS > SPACES
      **         MARCAR ERRROR
               GO TO MSG-FND-KEY.

      **     PERFORM CRG-VEC-CSC.
      **
           IF (SCR-OFRM-SRV AND WSS-J > WSS-NITMMAX)
               GO TO CON-FND-KEY.
      **
           IF ((NOT SCR-OFRM-SRV) AND WSS-J > WSS-JMAX)
               GO TO CON-FND-KEY.

      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CON-FND-KEY.
           PERFORM PUT-TAB.

      *AFRI-INI/04-06-2012 ERROR EN SERVICIO
           MOVE 'C'   TO SCR-STPP.
      *AFRI-FIN/04-06-2012 ERROR EN SERVICIO
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *----------------------------------------------------------
       MSG-FND-KEY.
           MOVE 'TAB' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
      *AFRI-INI/04-06-2012 ERROR EN SERVICIO
           MOVE 'C'   TO SCR-STPP.
      *AFRI-FIN/04-06-2012 ERROR EN SERVICIO
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF


*************************************************************

******* INICIO - rutinas Simulacion de Cancelaciones

*************************************************************
       SIM-CAN SECTION.
       SIM-CAN-INI.
           PERFORM PRM-CAN.
           IF MSG-COD-MENS > SPACES
              GO TO FIN-SIM-CAN.

           PERFORM INI-CAN.
           IF MSG-COD-MENS > SPACES
              GO TO FIN-SIM-CAN.

           PERFORM LUP-PUT-VEN.

********SE INICIALIZAN LAS VARIABLES EN MODO CONSULTA,
********YA QUE SE HABIA UTILIZADO "ING" PARA GENERAR CAN CTE.
           MOVE SPACES TO SCR-CMND.
           MOVE 'ACC'  TO SCR-CCPP.
           MOVE SPACES TO SCR-STPP.

       FIN-SIM-CAN.
           EXIT.


       PRM-CAN SECTION.
       INI-PRM-CAN.
           IF FRM-FEC-FCAL IN CSC-FLD > ZEROES
              MOVE FRM-NUM-DCAL IN CSC-FLD TO WSS-NUM-DPRO IN WSS-VARI
              MOVE FRM-NUM-MCAL IN CSC-FLD TO WSS-NUM-MPRO IN WSS-VARI
              MOVE FRM-NUM-SCAL IN CSC-FLD TO WSS-NUM-SPRO IN WSS-VARI
              MOVE FRM-NUM-ACAL IN CSC-FLD TO WSS-NUM-APRO IN WSS-VARI
           ELSE
              PERFORM GET-FHOY
              MOVE HOY-DHOY IN HOY-VARI    TO WSS-NUM-DPRO IN WSS-VARI
              MOVE HOY-MHOY IN HOY-VARI    TO WSS-NUM-MPRO IN WSS-VARI
              MOVE HOY-SHOY IN HOY-VARI    TO WSS-NUM-SPRO IN WSS-VARI
              MOVE HOY-AHOY IN HOY-VARI    TO WSS-NUM-APRO IN WSS-VARI.

           MOVE 'N' TO WSS-COD-SPAC.

      *LLENAR LOS VECTORES
           PERFORM CARGA-TAB-TBAN.
           IF TBAN-IMAX = ZEROES
   *********** DISPLAY 'NO EXISTEN CODIGOS DE TIPOS DE BANCA'
               MOVE 'COL'        TO MSG-COD-SIST
AKI            MOVE 'NOEXISTBAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRM-CAN
           ELSE
           IF TBAN-IMAX > TBAN-OMAX
    ********** DISPLAY 'OVERFLOW DE TIPOS DE BANCAS(30)'
               MOVE 'COL'        TO MSG-COD-SIST
AKI            MOVE 'OVERFLTBAN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-PRM-CAN.
           MOVE WSS-DIAS-MORA TO WSS-DIAS-MORAP.
           IF WSS-COD-SPAC = 'N'
               PERFORM CARGA-TAB-TBAN-N.
           IF WSS-DIAS-MORA < WSS-DIAS-MORAP
               MOVE WSS-DIAS-MORAP TO WSS-DIAS-MORA.
           MOVE WSS-FEC-FPRO    IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
              MOVE 'COL'        TO MSG-COD-SIST
AKI           MOVE FEC-MENS     TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-PRM-CAN.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
                                            WSS-FEC-FFCA IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-SPO2 IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-APO2 IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MPO2 IN WSS-VARI.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DPO2 IN WSS-VARI.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO WSS-NUM-DTER IN WSS-VARI.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO WSS-NUM-MTER IN WSS-VARI.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO WSS-NUM-STER IN WSS-VARI.
           MOVE WSS-NUM-APRO IN WSS-VARI TO WSS-NUM-ATER IN WSS-VARI.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI.

           MOVE WSS-NUM-SPRO IN WSS-VARI TO CAN-NUM-SCAN IN CAN
                                            CAN-NUM-SCAN IN CAN-FLD.
           MOVE WSS-NUM-APRO IN WSS-VARI TO CAN-NUM-ACAN IN CAN
                                            CAN-NUM-ACAN IN CAN-FLD.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO CAN-NUM-MCAN IN CAN
                                            CAN-NUM-MCAN IN CAN-FLD.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO CAN-NUM-DCAN IN CAN
                                            CAN-NUM-DCAN IN CAN-FLD.
       BUS-DIA-HBL.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FINI.

           MOVE WSS-FEC-FINI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF WSS-CNT-DIAS IN WSS-VARI < WSS-DIAS-MORA
              MOVE WSS-FEC-FINI IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              ADD   1           TO WSS-CNT-DIAS IN WSS-VARI
              GO TO BUS-DIA-HBL.
       RET-DIA-HBL.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FINI.

           MOVE WSS-FEC-FINI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE WSS-FEC-FINI IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              GO TO RET-DIA-HBL.

           MOVE WSS-FEC-FMIN IN WSS-VARI TO WSS-FEC-FINI IN WSS-VARI.
           MOVE WSS-NUM-DMIN IN WSS-VARI TO WSS-NUM-DUNO IN WSS-VARI.
           MOVE WSS-NUM-MMIN IN WSS-VARI TO WSS-NUM-MUNO IN WSS-VARI.
           MOVE WSS-NUM-SMIN IN WSS-VARI TO WSS-NUM-SUNO IN WSS-VARI.
           MOVE WSS-NUM-AMIN IN WSS-VARI TO WSS-NUM-AUNO IN WSS-VARI.
           MOVE TBAN-J TO TBAN-I.
           MOVE WSS-DIAS-MORA-B  IN WSS-VARI TO TBAN-NUM-NDIA(TBAN-I).
           MOVE TBAP-J TO TBAP-I.
           MOVE WSS-DIAS-MORA-BP IN WSS-VARI TO TBAP-NUM-NDIA(TBAP-I).
           PERFORM DET-FEC-TBA1.
           PERFORM DET-FEC-TBA2.
           PERFORM DET-FEC-TBAN.
           MOVE 1 TO TBAN-I.
       LUP-DISP.
           IF TBAN-I > TBAN-IMAX
               IF WSS-COD-SPAC = 'S'
                  GO TO NXT-DISP
               ELSE
                  GO TO CNT-DISP-1.
           ADD 1 TO TBAN-I.
           GO TO LUP-DISP.
       CNT-DISP-1.
           MOVE 1 TO TBAP-I.
       LUP-DISP-1.
           IF TBAP-I > TBAP-IMAX
               GO TO NXT-DISP.
           ADD 1 TO TBAP-I.
           GO TO LUP-DISP-1.
       NXT-DISP.
           MOVE TPRO-J TO TPRO-I.
           MOVE WSS-DIAS-MORA-P IN WSS-VARI TO TPRO-NUM-NDIA(TPRO-I).
           PERFORM DET-FEC-TPR2.
           PERFORM DET-FEC-TPRO.
           MOVE 1 TO TPRO-I.
       LUP-DISP-PRO.
           IF TPRO-I > TPRO-IMAX
               GO TO NXT-DISP-PRO.
           ADD 1 TO TPRO-I.
           GO TO LUP-DISP-PRO.
       NXT-DISP-PRO.
           PERFORM BUS-DIA-POST.
           IF WSS-FEC-FPO2 IN WSS-VARI > ZEROES
              MOVE WSS-FEC-FPO2 IN WSS-VARI TO WSS-FEC-FTER
                                                IN WSS-VARI
              MOVE WSS-NUM-DTER IN WSS-VARI TO WSS-NUM-DBOL
              MOVE WSS-NUM-MTER IN WSS-VARI TO WSS-NUM-MBOL
              MOVE WSS-NUM-STER IN WSS-VARI TO WSS-NUM-SBOL
              MOVE WSS-NUM-ATER IN WSS-VARI TO WSS-NUM-ABOL.

           PERFORM OBT-FEC-MOR-PAGP.

       FIN-PRM-CAN.
           EXIT.



       INI-CAN SECTION.
       INI-INI-CAN.
           MOVE 'TVAL'         TO MSC-CIC-TMSC IN MSC.
           MOVE '0'            TO MSC-CIC-CMSC IN MSC.
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'MSC-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
     ********* DISPLAY 'EN MISCELANEO TVAL NO EXISTE CODIGO 0'
              MOVE 'COL'        TO MSG-COD-SIST
AKI           MOVE 'MISTVALNO0' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-INI-CAN.
           MOVE MSC-COD-CMSC IN MSC TO WSS-COD-CMSC IN WSS-VARI.

           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-INI-CAN.
           EXIT.


       LUP-PUT-VEN SECTION.
       INI-LUP-VEN.
           MOVE OPC-CIC-IOPC IN OPC      TO VEN-CIC-IOPC IN VEN.
           MOVE OPC-CIC-IOPC IN OPC      TO CAN-CIC-IOPC IN CAN.
           MOVE ZEROES                   TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS              TO FIO-CMND.
       LUP-BUS-VEN.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN)
                  GO TO FIN-LUP-PUT-VEN.

           MOVE VEN-KEY-IVEN IN VEN TO WSS-VEN-KEY-IVEN.
           ADD 1 TO WSS-NUM-RLEI IN WSS-VARI.

           IF VEN-COD-TOPC IN VEN NOT = 'D'
      *        DISPLAY 'NO ES D'
               GO TO OTRO-VEN.

           IF VEN-IND-CALC IN VEN = 'N'
      *        DISPLAY 'CALC = N'
               GO TO OTRO-VEN.

           IF VEN-FEC-FVEN IN VEN NOT < CAN-FEC-FCAN IN CAN
      *        DISPLAY 'VEN-FEC-FVEN NOT < CAN-FEC-FCAN IN CAN'
               GO TO OTRO-VEN.

           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
              MOVE 'COL'                TO MSG-COD-SIST
              MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO OTRO-VEN.

           IF CTO-SIST IN CTO-VARI NOT = 'COL'
               GO TO OTRO-VEN.

           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
              MOVE 'COL'        TO MSG-COD-SIST
              MOVE 'CANTOOCNEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO OTRO-VEN.

           MOVE TOC-MSC-OPEC IN TOC TO WSS-OPEC.
           IF WSS-OPEC = 'B'
              NEXT SENTENCE
           ELSE
              IF VEN-VAL-SCAP IN VEN = ZEROS AND
                 VEN-VAL-SFIN IN VEN = ZEROS
                 GO TO OTRO-VEN.

       CON-LUP-PUT-VEN.
*******SOLO SE VALIDA EL PRIMER VENCIMIENTO CONTRA LA OPC
           IF VEN-NUM-IVCT IN VEN NOT = OPC-NUM-IVEN IN OPC
           AND WSS-NUM-RLEI IN WSS-VARI = 1
               MOVE 'COL'        TO MSG-COD-SIST
AKI            MOVE 'INCONS OPC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO OTRO-VEN.

      *AFRI-INI/CALCULA-MORA 03062009
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-RESV.
      *AFRI-INI/CALCULA-MORA 03062009
           PERFORM CALCULAR-MORA.
      *AFRI-INI/CALCULA-MORA 03062009
           MOVE VEN-FEC-FVEN IN VEN TO VEN-FEC-FIMV IN VEN.
           MOVE WSS-FEC-RESV        TO VEN-FEC-FVEN IN VEN.
      *AFRI-INI/CALCULA-MORA 03062009
           IF MSG-COD-MENS > SPACES
               GO TO FIN-LUP-PUT-VEN.

           MOVE VEN-CIC-IOPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES       TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT (FIO-STAT-OKS AND
                   DLC-CIC-IOPC IN DLC = VEN-CIC-IOPC IN VEN)
                MOVE 'COL'        TO MSG-COD-SIST
AKI             MOVE 'INCONS DLC' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO OTRO-VEN.
      *
       NXT-SOL-PAC.
           MOVE 'ING' TO SCR-CMND SCR-CCPP.
           MOVE 'M'   TO SCR-STPP.

           MOVE LOW-VALUES   TO CAN-FLD.
           PERFORM SCR-CLRA-CAN.
           MOVE +0 TO OPC-MSC-TVOC-LEN
           MOVE +0 TO OPC-COD-TOOC-LEN
           MOVE +0 TO OPC-COD-OFOC-LEN
           MOVE +0 TO CAN-CAI-IOPC-LEN
           MOVE +0 TO CAN-IIC-IOPC-LEN
           MOVE +0 TO FRM-GLS-TVOC-LEN
           MOVE +0 TO FRM-GLS-TOOC-LEN
           MOVE +0 TO FRM-GLS-OFOC-LEN
           MOVE +0 TO CAN-NUM-ICAN-LEN
           MOVE +0 TO DBC-GLS-NOMC-LEN
           MOVE +0 TO DBC-NUM-ICLI-LEN
           MOVE +0 TO DBC-VRF-ICLI-LEN
           MOVE +0 TO DBC-IND-ICLI-LEN
           MOVE +0 TO DBC-GLS-ICLI-LEN
           MOVE +0 TO VEN-NUM-IVCT-LEN
           MOVE +0 TO RCV-MSC-MCAN-LEN
           MOVE +0 TO CAN-COD-RCAN-LEN
           MOVE +0 TO CAN-MSC-STAT-LEN
           MOVE +0 TO FRM-GLS-STAT-LEN
           MOVE +0 TO FRM-GLS-RCAN-LEN
           MOVE +0 TO VEN-NUM-IVEN-LEN
           MOVE +0 TO CAN-MSC-CANC-LEN
           MOVE +0 TO ROV-CAI-IOPC-LEN
           MOVE +0 TO ROV-IIC-IOPC-LEN
           MOVE +0 TO FRM-GLS-CANC-LEN
           MOVE +0 TO VEN-FEC-FVEN-LEN
           MOVE +0 TO VEN-FEC-FIMV-LEN
           MOVE +0 TO CAN-FEC-FOUT-LEN
           MOVE +0 TO CAN-FEC-FCAN-LEN
           MOVE +0 TO CAN-FEC-FEGR-LEN
           MOVE +0 TO FRM-SGV-TINT-LEN
           MOVE +0 TO COM-SGV-TINT-LEN
           MOVE +0 TO ICG-SGV-TINT-LEN
           MOVE +0 TO FRM-GLS-IITR-LEN
           MOVE +0 TO FRM-IND-TIPE-LEN
           MOVE +0 TO FRM-GLS-TINT-LEN
           MOVE +0 TO CAN-COD-OFCA-LEN
           MOVE +0 TO FRM-GLS-OFCA-LEN
           MOVE +0 TO CAN-SGV-GAST-LEN
           MOVE +0 TO OPC-COD-AOOC-LEN
           MOVE +0 TO FRM-GLS-AOOC-LEN
           MOVE +0 TO CAN-SGV-TREN-LEN
           MOVE +0 TO VEN-IND-SCTB-LEN
           MOVE +0 TO FRM-GLS-SCTB-LEN
           MOVE +0 TO CAN-SGV-TPAG-LEN
           MOVE +0 TO OPC-NUM-VCVG-LEN
           MOVE +0 TO CYA-IND-TCYA-LEN
           MOVE +0 TO FRM-GLS-TCYA-LEN
           MOVE +0 TO OPC-COD-VCOC-LEN
           MOVE +0 TO FRM-GLS-VCOC-LEN
           MOVE +0 TO CYA-CAI-ICYA-LEN
           MOVE +0 TO CYA-IIC-ICYA-LEN
           MOVE +0 TO OPC-VAL-SCRE-LEN
           MOVE +0 TO CAN-SGV-DIFE-LEN
           MOVE +0 TO VEN-VAL-SCAP-LEN
           MOVE +0 TO RCV-SGV-CAPI-LEN
           MOVE +0 TO VEN-VAL-SFIN-LEN
           MOVE +0 TO RCV-SGV-FINA-LEN
           MOVE +0 TO CAN-GLS-MENS-LEN
           MOVE 'S'                     TO WSS-IBLK-COMI.
           MOVE OPC-CAI-IOPC IN OPC TO CAN-CAI-IOPC IN CAN-FLD.
           MOVE OPC-IIC-IOPC IN OPC TO CAN-IIC-IOPC IN CAN-FLD.
AKI        MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVCT IN CAN-FLD.
AKI        MOVE VEN-NUM-IVEN IN VEN TO VEN-NUM-IVEN IN CAN-FLD.
AKI        MOVE OPC-COD-VCOC IN OPC TO SCR-COD-VCOC.
AKI        MOVE SPACES TO MSG-COD-MENS.
           PERFORM GEN-CTE.
       DIS-MEN-ERR.
           IF MSG-COD-MENS > SPACES
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG
               GO TO FIN-LUP-PUT-VEN.

           PERFORM CRG-VEC-CSC.
           IF (     SCR-OFRM-SRV  AND WSS-J > WSS-NITMMAX) OR
              ((NOT SCR-OFRM-SRV) AND WSS-J > WSS-JMAX)
              GO TO FIN-LUP-PUT-VEN.

       OTRO-VEN.
           MOVE WSS-VEN-KEY-IVEN TO VEN-KEY-IVEN IN VEN.
           MOVE FIO-GET-NLS              TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-VEN.
       FIN-LUP-PUT-VEN.
           EXIT.
      *
       CALCULAR-MORA SECTION.
       INI-CALCULAR-MORA.
      *AFRI-INI/CALCULA-MORA 03062009
           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DVEN IN VEN.
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MVEN IN VEN.
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SVEN IN VEN.
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AVEN IN VEN.
      *AFRI-FIN/CALCULA-MORA 03062009
           IF VEN-FEC-FVEN IN VEN NOT < CAN-FEC-FCAN IN CAN
               MOVE 'N' TO WSS-IND-COMI
               MOVE ZEROES TO TXC-ATXC
               GO TO NXT-CALCULA-MORA.
           PERFORM BUS-CIC-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL
             GO TO FIN-CALCULAR-MORA.
           PERFORM DET-OPC-PRO-ORIG.
           IF FRM-SUAR = FRM-SUAR-MAL
               GO TO FIN-CALCULAR-MORA.
           MOVE WSS-PLZO                TO TXC-PLZO.
           MOVE OPC-COD-VCOC IN OPC     TO TXC-VCOC.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO TXC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO TXC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO TXC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO TXC-AEC2.

           MOVE VEN-CAI-IOPC IN VEN TO CAN-CAI-IOPC IN CAN-FLD.
           MOVE VEN-IIC-IOPC IN VEN TO CAN-IIC-IOPC IN CAN-FLD.
           MOVE '00000000'          TO CAN-FEC-FOUT IN CAN-FLD.
           MOVE '00000000'          TO CAN-FEC-FEGR IN CAN-FLD.
           MOVE ZEROES              TO CAN-SGV-GAST IN CAN-FLD.
           MOVE ZEROES              TO CAN-NUM-PLCO IN CAN-FLD.
           MOVE ZEROES              TO CAN-SGV-COMI IN CAN-FLD.
           MOVE ZEROES              TO CAN-SGV-TREN IN CAN-FLD.
           MOVE ZEROES              TO CAN-SGV-TPAG IN CAN-FLD.
           MOVE ZEROES              TO CAN-SGV-DIFE IN CAN-FLD.
           PERFORM PRO-FUPM.
           MOVE WSS-NUM-DUPM            TO TXC-DEC1.
           MOVE WSS-NUM-MUPM            TO TXC-MEC1.
           MOVE WSS-NUM-SUPM            TO TXC-SEC1.
           MOVE WSS-NUM-AUPM            TO TXC-AEC1.

           PERFORM TAB-BUS-TXC.

           IF TXC-CMSG > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE TXC-CMSG     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
      *         MOVE CAM-KEY-CAMB TO FRM-MEN2
               MOVE TXC-MEN2     TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-CALCULAR-MORA.
       NXT-CALCULA-MORA.
AKI   *ESTE CODIGO SE PUSO PARA OBTENER EL VALOR DE SCR-SGV-VCAM
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
      *RGD-INI 03/10/2013 OPE UF CAS
      *    MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE WSS-COD-VCOC        TO TAB-COD-CTAB IN TAB.
      *RGD-FIN
           PERFORM VAL-COD.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CALCULAR-MORA.

           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.

      *ISP SI ES MONEDA REAJUSTABLE (CHILENA Y NO PESOS) ENTONCES
      *    CONVIERTE A PESOS
           MOVE 1 TO SCR-SGV-VCAM.
           IF NOT (WSS-CIC-TVAL = '0' AND
                   WSS-CIC-VCAM NOT = '0999')
               NEXT SENTENCE
           ELSE
               MOVE '0999  '     TO TAB-CIC-CTAB IN TAB
      *RGD-INI 03/10/2013 OPE UF CAS
      *        MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB
               MOVE WSS-COD-VCOC        TO TAB-COD-CTAB IN TAB
      *RGD-FIN
               MOVE CAN-NUM-DCAN IN CAN-FLD TO TAB-NUM-DTRN IN TAB
               MOVE CAN-NUM-MCAN IN CAN-FLD TO TAB-NUM-MTRN IN TAB
               MOVE CAN-NUM-SCAN IN CAN-FLD TO TAB-NUM-STRN IN TAB
               MOVE CAN-NUM-ACAN IN CAN-FLD TO TAB-NUM-ATRN IN TAB
               PERFORM GET-VCAM
               IF MSG-COD-MENS = SPACES
                  MOVE CAM-SGV-VCAM IN CAM TO SCR-SGV-VCAM
               ELSE
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  MOVE 'TAB' TO MSG-COD-SIST
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  GO TO FIN-CALCULAR-MORA.

           COMPUTE CAN-SGV-TPAG IN CAN-FLD = VEN-VAL-SFIN IN VEN *
                   SCR-SGV-VCAM.
AKI        MOVE CAN-SGV-TPAG IN CAN-FLD TO CAN-SGV-TPAG IN CAN.

           COMPUTE WSS-VAL-MORA ROUNDED = CAN-SGV-TPAG IN CAN-FLD +
                  ((CAN-SGV-TPAG IN CAN-FLD * TXC-ATXC) / 100).

           MOVE WSS-VAL-MORA TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-MORA.

       FIN-CALCULAR-MORA.
           EXIT.


       GEN-CTE SECTION.
       INI-GEN-CTE.
           MOVE SPACES TO WSS-CMSG.
           MOVE 'CTE'                   TO CAN-MSC-CANC IN CAN-FLD
AKI                                        CAN-MSC-CANC IN CAN
                                           SCR-MSC-CANC.
           MOVE OPC-COD-RMOC IN OPC     TO CAN-COD-RCAN IN CAN-FLD.
           MOVE OPC-COD-OFOC IN OPC     TO CAN-COD-OFCA IN CAN-FLD.
           MOVE WSS-FEC-FFCA            TO CAN-FEC-FCAN IN CAN-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL
               MOVE 'ERROR' TO WSS-CMSG
     ***       DISPLAY OPC-CIC-IOPC IN OPC ':' FRM-MENS
               GO TO FIN-GEN-CTE.
           MOVE SPACES TO WSS-CMSG.
           PERFORM CMN-ING.
       FIN-GEN-CTE.
           EXIT.


       CMN-ING SECTION.
       INI-CMN-ING.
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'E'
                MOVE 1 TO CAN-NUM-TVCC IN CAN
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
                MOVE OPC-NUM-VCVG IN OPC TO CAN-NUM-TVCC IN CAN
           ELSE
           IF SCR-MSC-FCAN = 'I' OR 'P'
                MOVE ZEROES TO CAN-NUM-TVCC IN CAN
           ELSE
                MOVE 1 TO CAN-NUM-TVCC IN CAN.
           MOVE 'I' TO WSS-MSG-FENT.
           MOVE 'I' TO CAN-MSC-STAT IN CAN.

           PERFORM CHK-PNR-BGT.
           MOVE SCR-USER TO CAN-COD-ATRN IN CAN.

           MOVE 'G'  TO CAN-MSC-STAT IN CAN
           MOVE WSS-NUM-DPRO IN WSS-VARI TO CAN-NUM-DEGR IN CAN.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO CAN-NUM-MEGR IN CAN.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO CAN-NUM-SEGR IN CAN.
           MOVE WSS-NUM-APRO IN WSS-VARI TO CAN-NUM-AEGR IN CAN.
           MOVE WSS-NUM-DPRO IN WSS-VARI TO CAN-NUM-DOUT IN CAN.
           MOVE WSS-NUM-MPRO IN WSS-VARI TO CAN-NUM-MOUT IN CAN.
           MOVE WSS-NUM-SPRO IN WSS-VARI TO CAN-NUM-SOUT IN CAN.
           MOVE WSS-NUM-APRO IN WSS-VARI TO CAN-NUM-AOUT IN CAN.

           PERFORM CREA-RCV.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-CMN-ING.

      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
      *    MOVE CAN-SGV-TPAG IN CAN TO WSS-VAL-SVEN.
      *    MOVE OPC-CAI-IOPC IN CSC-FLD TO CAN-CAI-IOPC IN CAN-FLD.
      *    MOVE OPC-IIC-IOPC IN CSC-FLD TO CAN-IIC-IOPC IN CAN-FLD.
      *
      *    PERFORM PRO-LEE-JDLC.
      *
      *    IF DLC-IND-SCBZ IN DLC = 'JUDIC'
      *     IF (SCR-MSC-TCAN = 'C' AND
      *      SCR-MSC-FCAN = 'X' AND
      *      SCR-MSC-ECAN = 'E')
      *        MOVE 'COL'          TO MSG-COD-SIST
      *        MOVE 'CANNOPERPJUD' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        PERFORM BCK-OUT
      *        GO TO CON-CMN-ING
      *     ELSE
      *        PERFORM PRO-HON-JUDI
      *        IF WSS-JUD-ERRO IN JUD-VARI = 'S'
      *         MOVE 'COL' TO MSG-COD-SIST
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
      *         MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         PERFORM BCK-OUT
      *         GO TO FIN-CMN-ING
      *        ELSE
      *         ADD WSS-SGV-HCJU IN JUD-VARI TO CAN-SGV-GAST IN CAN-FLD
      *         ADD WSS-SGV-HCJU IN JUD-VARI TO CAN-SGV-GAST IN CAN
      *         ADD WSS-SGV-HCJU IN JUD-VARI TO CAN-SGV-TPAG IN CAN-FLD
      *         ADD WSS-SGV-HCJU IN JUD-VARI TO CAN-SGV-TPAG IN CAN.
      *
      *    IF WSS-SGV-HCJU IN JUD-VARI > ZEROES
      *        GO TO SIG-CMN-ING.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA

        CON-CMN-ING.
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES

      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *    PERFORM OBT-HONO.
      *    IF NOT FIO-STAT-OKS
      *        MOVE FIO-MENS TO FRM-MENS
      *        GO TO FIN-CMN-ING.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA

      *AFRI-INI/CHC/DIC-2008/HONORARIOS JUDICIALES
        SIG-CMN-ING.
      *AFRI-FIN/CHC/DIC-2008/HONORARIOS JUDICIALES

      * Calcula COMISIONES
      *MUEVE COMISION FLV DE TABLA
           MOVE CAN-CAI-IOPC IN CAN-FLD TO ICG-CAI-IOPC IN ICG.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO ICG-IIC-IOPC IN ICG.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO ICG-NUM-ICAN IN ICG.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO ICG-CAI-IOPV IN ICG.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO ICG-IIC-IOPV IN ICG.
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
              MOVE ZEROES                  TO ICG-NUM-IVCT IN ICG
           ELSE
              MOVE VEN-NUM-IVEN IN CAN-FLD TO ICG-NUM-IVCT IN ICG.
           MOVE 'FLV'                   TO ICG-IND-TTAS IN ICG.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO ICG-NUM-SINI IN ICG.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO ICG-NUM-AINI IN ICG.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO ICG-NUM-MINI IN ICG.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO ICG-NUM-DINI IN ICG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS
              MOVE ICG-SGV-TINT IN ICG TO COM-SGV-TINT IN CAN-FLD
              MOVE 'C'                 TO WSS-IBLK-COMI
           ELSE
              PERFORM LEE-COM-CAN-CUR
              IF FIO-STAT-OKS
                 MOVE ICG-SGV-TINT IN ICG TO COM-SGV-TINT IN CAN-FLD
                 MOVE 'C'                 TO WSS-IBLK-COMI
              ELSE
                 MOVE ZEROES TO FIO-STAT
                 MOVE ZEROES TO COM-SGV-TINT IN CAN-FLD.

           MOVE VEN-NUM-DIMV IN VEN TO VEN-NUM-DIMV IN CAN-FLD
           MOVE VEN-NUM-MIMV IN VEN TO VEN-NUM-MIMV IN CAN-FLD
           MOVE VEN-NUM-SIMV IN VEN TO VEN-NUM-SIMV IN CAN-FLD
           MOVE VEN-NUM-AIMV IN VEN TO VEN-NUM-AIMV IN CAN-FLD
           MOVE VEN-NUM-DVEN IN VEN TO VEN-NUM-DVEN IN CAN-FLD
           MOVE VEN-NUM-MVEN IN VEN TO VEN-NUM-MVEN IN CAN-FLD
           MOVE VEN-NUM-SVEN IN VEN TO VEN-NUM-SVEN IN CAN-FLD
           MOVE VEN-NUM-AVEN IN VEN TO VEN-NUM-AVEN IN CAN-FLD
           PERFORM VAL-ICG-SGV-TINT.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-CMN-ING.

      *BUS-TAB BUSCA GLOSA DE CODIGO EN TABLA
           IF CAN-MSC-CANC IN CAN-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CNC ' TO TAB-COD-TTAB IN TAB
               MOVE CAN-MSC-CANC IN CAN-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CANC IN CAN-FLD
               IF TAB-GLS-DATA IN TAB (1:4) NOT = SPACES
                  MOVE TAB-GLS-DATA IN TAB (1:4) TO CCO-COD-EVEN-ANT
               ELSE
                  MOVE 'CAN ' TO CCO-COD-EVEN-ANT
               END-IF
               IF TAB-GLS-DATA IN TAB (5:4) NOT = SPACES
                  MOVE TAB-GLS-DATA IN TAB (5:4) TO CCO-COD-EVEN-VEN
               ELSE
                  MOVE 'CAN ' TO CCO-COD-EVEN-VEN
               END-IF
           ELSE
               MOVE SPACES TO FRM-GLS-CANC IN CAN-FLD.

           PERFORM VAL-COM-SGV-TINT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE FIO-MENS TO FRM-MENS
               MOVE 'ERROR EN CALCULO DE COMISIONES ' TO FRM-MENS
               GO TO FIN-CMN-ING.

      * NGA INI Simulador de Cancelaciones 24-07-2014
      * Calcula COMISIONES
      *    MOVE ZEROES TO WSS-SGV-CACU.
      *    MOVE ZEROES TO PCP-CACU PCP-SUVP PCP-FANT PCP-FVEN.
      *    MOVE ZEROES TO WSS-VAL-SMO8 WSS-VAL-SM10.
      *    MOVE SPACES TO PCP-IINC.
      *    MOVE 0 TO SCR-SGV-IPFC.
      *    MOVE CAN-SGV-TPAG IN CAN-FLD TO WSS-VAL-SMO7.
      *    MOVE CAN-SGV-TREN IN CAN-FLD TO WSS-VAL-SMO9.
      *    MOVE OPC-VAL-SCRE IN OPC     TO WSS-VAL-SCRE IN WSS-VARI.
      *    PERFORM CAL-COM-PCP.
      *    IF PCP-CMSG > SPACES
      *       MOVE PCP-CMSG TO MSG-COD-MENS IN MSG
      *       MOVE FRM-SUAR-MAL   TO FRM-SUAR
      *       MOVE ZEROES TO PCP-SUCO PCP-SUIM PCP-SUVP.
      *    MOVE PCP-SUCO TO CAN-SGV-COMI IN CAN.
      *    MOVE PCP-SUCO TO CAN-SGV-COMI IN CAN-FLD.
      *    ADD  PCP-SUIM TO CAN-SGV-COMI IN CAN.
      *    ADD  PCP-SUIM TO CAN-SGV-COMI IN CAN-FLD.
      *    ADD  CAN-SGV-COMI IN CAN TO CAN-SGV-TPAG IN CAN
      *    MOVE CAN-SGV-TPAG IN CAN TO CAN-SGV-TPAG IN CAN-FLD.
           MOVE SPACES  TO CXE.
           MOVE CAN-CIC-IOPC IN CAN TO CXE-CIC-IOPC IN CXE.
           MOVE WSS-CT-CCAC         TO CXE-COD-CPTO IN CXE.
           MOVE WSS-CT-CAC          TO CXE-COD-EVEN IN CXE.
           MOVE ZEROES              TO CXE-NUM-EVEN IN CXE.
           MOVE SPACES              TO CXE-CIC-IOPV IN CXE.
           MOVE ZEROES              TO CXE-NUM-IVCT IN CXE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-CXE.
           IF NOT FIO-STAT-OKS
              MOVE ZEROES TO CAN-SGV-COMI IN CAN
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *       GO TO FIN-CMN-ING.
              GO TO XXX-CMN-ING.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA

           COMPUTE CAN-SGV-COMI IN CAN = CXE-SGV-MNTO IN CXE *
                                         SCR-SGV-VCAM.

      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
       XXX-CMN-ING.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA

           MOVE CAN-SGV-COMI IN CAN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-COMI IN CAN.

           ADD  CAN-SGV-COMI IN CAN TO CAN-SGV-TPAG IN CAN
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
           PERFORM OBT-HONO.
           MOVE CAN-SGV-TPAG IN CAN TO CAN-SGV-TPAG IN CAN-FLD.
           MOVE CAN-SGV-TPAG IN CAN TO WSS-VAL-SVEN.
           MOVE OPC-CAI-IOPC IN CSC-FLD TO CAN-CAI-IOPC IN CAN-FLD.
           MOVE OPC-IIC-IOPC IN CSC-FLD TO CAN-IIC-IOPC IN CAN-FLD.

           PERFORM PRO-LEE-JDLC.

           IF DLC-IND-SCBZ IN DLC = 'JUDIC'
            IF (SCR-MSC-TCAN = 'C' AND
             SCR-MSC-FCAN = 'X' AND
             SCR-MSC-ECAN = 'E')
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CANNOPERPJUD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               PERFORM BCK-OUT
               GO TO CON-CMN-ING
            ELSE
               PERFORM PRO-JUDIC-HONO
               IF WSS-JUD-ERRO IN JUD-VARI = 'S'
                MOVE 'COL' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                PERFORM BCK-OUT
                GO TO FIN-CMN-ING
               ELSE
                ADD WSS-SGV-HCJU IN JUD-VARI TO CAN-SGV-GAST IN CAN-FLD
                ADD WSS-SGV-HCJU IN JUD-VARI TO CAN-SGV-GAST IN CAN
                ADD WSS-SGV-HCJU IN JUD-VARI TO CAN-SGV-TPAG IN CAN-FLD
                ADD WSS-SGV-HCJU IN JUD-VARI TO CAN-SGV-TPAG IN CAN.

      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
           MOVE CAN-SGV-TPAG IN CAN TO CAN-SGV-TPAG IN CAN-FLD.
      * NGA FIN Simulador de Cancelaciones 24-07-2014

       END-CMN-ING.
       FIN-CMN-ING.
           EXIT.
**********************************************************************
***********INI SE DEBE COPIAR EL CODIGO DE ACT-RCV.
**********************************************************************
       CREA-RCV SECTION.
       INI-CREA-RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-ECAN = 'E'
              MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
              MOVE ZEROES              TO RCV-NUM-IVCT IN RCV
           ELSE
              MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV.

********* SE PUEBLAN RCV-SGV-CAPI Y RCV-SGV-FINA EN CAN-FLD.
           MOVE VEN-VAL-SCAP IN VEN  TO  VEN-VAL-SCAP IN CAN-FLD
           MOVE VEN-VAL-SFIN IN VEN  TO  VEN-VAL-SFIN IN CAN-FLD
           MOVE VEN-VAL-SCAP IN VEN  TO  RCV-SGV-CAPI IN CAN-FLD
           MOVE VEN-VAL-SFIN IN VEN  TO  RCV-SGV-FINA IN CAN-FLD.

           MOVE SCR-RCV-STAT TO RCV-MSC-STAT IN RCV.
           MOVE VEN-IND-SCTB IN VEN TO RCV-IND-SCTB IN RCV.
           MOVE VEN-IND-SCBZ IN VEN TO RCV-IND-SCBZ IN RCV.

********* SE AGREGA CODIGO PARA CALCULAR EL INTERES X MORA RCV-SGV-INTM
           PERFORM GET-CUR-ITR
           IF PGM-STAT-ITR-OKS
              PERFORM GET-NXT-ITR
           ELSE
              MOVE ZEROES TO ITR-SGV-SPRD IN ITR
              MOVE ZEROES TO ITR-SGV-TINT IN ITR
              MOVE SPACES TO ITR-COD-TINT IN ITR
              MOVE SPACES TO ITR-COD-CVTI IN ITR.

********* SE AGREGA ESTE IF PARA TENER LA TASA DE LA OPERACION.
           IF ITR-COD-CVTI IN ITR > SPACES
               MOVE ITR-SGV-SPRD IN ITR TO FRM-SGV-TINT IN CAN-FLD
               IF ITR-MSC-TFPR = 'C' AND ITR-SGV-TINT IN ITR > 0
                   MOVE ITR-SGV-TINT IN ITR TO SCR-SGV-SPR2
               ELSE
                   MOVE 0                   TO SCR-SGV-SPR2
           ELSE
               MOVE ITR-SGV-TINT IN ITR TO FRM-SGV-TINT IN CAN-FLD.

           IF VEN-IND-CALC IN VEN = 'N'
              MOVE 'COL'          TO MSG-COD-SIST
              MOVE 'VENCALCMORAN' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE FRM-SUAR-MAL  TO FRM-SUAR
              GO TO FIN-CREA-RCV.

********* SE VALIDA QUE LA TASA INGRESADA NO < TASA OPERACION
           IF WSS-IBLK-TINT NOT = 'S'
              IF FRM-VAL-TMOR IN CSC-FLD < FRM-SGV-TINT IN CAN-FLD
                 MOVE 'COL'            TO MSG-COD-SIST
                 MOVE 'TASACAN<TCRE'   TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC  TO FRM-MENS
                 MOVE FRM-SUAR-MAL  TO FRM-SUAR
                 GO TO FIN-CREA-RCV.

           MOVE VEN-VAL-SFIN IN VEN  TO WSS-VAL-SMON.

           MOVE WSS-NUM-DUPM            TO FEC-DEC1.
           MOVE WSS-NUM-MUPM            TO FEC-MEC1.
           MOVE WSS-NUM-SUPM            TO FEC-SEC1.
           MOVE WSS-NUM-AUPM            TO FEC-AEC1.
           MOVE CAN-NUM-DCAN IN CAN-FLD TO FEC-DEC2.
           MOVE CAN-NUM-MCAN IN CAN-FLD TO FEC-MEC2.
           MOVE CAN-NUM-SCAN IN CAN-FLD TO FEC-SEC2.
           MOVE CAN-NUM-ACAN IN CAN-FLD TO FEC-AEC2.
           MOVE FEC-FORM-FEC            TO FEC-FORM.
           MOVE FEC-DIF-DIA             TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
              MOVE ZEROES TO FEC-NDIA.
           MOVE FEC-NDIA                TO INT-SEPA INT-SEPD WSS-DIAM.
           MOVE 'COL'                   TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'                   TO TAB-COD-TTAB IN TAB.
           MOVE 'BCI    DPTMC'          TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE = 'S'
              NEXT SENTENCE
           ELSE
              MOVE 'COL'         TO MSG-COD-SIST
AKI           MOVE 'DPTMC NOEXI' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE FRM-SUAR-MAL  TO FRM-SUAR
              GO TO FIN-CREA-RCV.

**********PRO-MORA-TXC*******
           DIVIDE TXC-ATXC BY 100 GIVING WSS-INT-TIPE ROUNDED.
********* NO SE INGRESO TASA DE MORA EN LA PANTALLA
           IF WSS-IBLK-TINT = 'S'
              MOVE '1'          TO FRM-IND-TIPE IN CAN-FLD
              MOVE WSS-INT-TIPE TO INT-TIPE
              MULTIPLY WSS-INT-TIPE BY 100
                                    GIVING ICG-SGV-TINT IN CAN-FLD
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100
                                    GIVING INT-TIPE
              GO TO RCV-FIN-MORA-TXC.

********* SE INGRESO TASA DE MORA EN PANTALLA
           MOVE FRM-VAL-TMOR IN CSC-FLD TO  ICG-SGV-TINT IN CAN-FLD.

           IF FRM-IND-TIPE IN CAN-FLD > SPACES
              DIVIDE ICG-SGV-TINT IN CAN-FLD BY 100
                                    GIVING INT-TIPE
              GO TO RCV-CMP-TIPE-TXC.

           MOVE SPACES                  TO FRM-IND-TIPE IN CAN-FLD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE SPACES                  TO INT-CVTI.
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
              MOVE 'COL'            TO MSG-COD-SIST
AKI           MOVE INT-CMSG         TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE FRM-SUAR-MAL  TO FRM-SUAR
              GO TO FIN-CREA-RCV.

       RCV-CMP-TIPE-TXC.
           IF INT-TIPE > WSS-INT-TIPE
              MOVE 'COL'         TO MSG-COD-SIST
              MOVE 'CANTIPE>TXC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE FRM-SUAR-MAL  TO FRM-SUAR
              GO TO FIN-CREA-RCV.

**********FIN-PRO-MORA-TXC*******
       RCV-FIN-MORA-TXC.
    ***** NO SE INGRESO TASA DE MORA EN LA PANTALLA
           IF WSS-IBLK-TINT = 'S'
              GO TO RCV-CONTINUA.

           IF ICG-SGV-TINT IN CAN-FLD NOT > ZEROES
              MOVE 0 TO INT-TIPE
              GO TO RCV-CONTINUA.

           MOVE WSS-DIAM         TO INT-SEPA INT-SEPD.
           MOVE ITR-COD-TINT IN ITR     TO INT-TIPT.
           MOVE ICG-SGV-TINT IN CAN-FLD TO INT-TINT.
           MOVE SPACES                  TO INT-CVTI.
           MOVE WSS-NUM-DUPM            TO INT-DDMA.
           MOVE WSS-NUM-MUPM            TO INT-MDMA.
           MOVE WSS-NUM-SUPM            TO INT-SDMA.
           MOVE WSS-NUM-AUPM            TO INT-ADMA.
           MOVE OPC-COD-VCOC IN OPC     TO INT-VCAM.
           PERFORM OBT-VTIN.
           IF INT-CMSG > SPACES
              MOVE 'COL'            TO MSG-COD-SIST
AKI           MOVE INT-CMSG         TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC  TO FRM-MENS
              MOVE FRM-SUAR-MAL  TO FRM-SUAR
              GO TO FIN-CREA-RCV.

       RCV-CONTINUA.
           MOVE WSS-VAL-SMON TO WSS-VAL-SCRE.
           MULTIPLY INT-TIPE BY WSS-VAL-SCRE
                        GIVING  WSS-VAL-SVEN.
           COMPUTE SCR-SGV-INMO = VEN-VAL-SFIN IN VEN -
                                  VEN-VAL-SCAP IN VEN.
           MOVE WSS-VAL-SVEN TO SCR-SGV-INMO.
           MULTIPLY WSS-VAL-SVEN BY SCR-SGV-VCAM GIVING SCR-SGV-INTM.
           ADD WSS-VAL-SCRE TO WSS-VAL-SVEN.

           MOVE SCR-SGV-INTM TO RCV-SGV-INTM IN RCV.

********* SE AGREGA ESTAS LINEAS PARA EL INTERES
           COMPUTE RCV-SGV-INTE IN RCV = (VEN-VAL-SFIN IN VEN -
                                          VEN-VAL-SCAP IN VEN) *
                                          SCR-SGV-VCAM.

           COMPUTE RCV-SGV-CAPI IN RCV = RCV-SGV-CAPI IN CAN-FLD *
                                         SCR-SGV-VCAM.

********* SE LE SUMA EL INTERES POR MORA AL CAN-SGV-TPAG
           ADD  RCV-SGV-INTM IN RCV TO CAN-SGV-TPAG IN CAN.
           MOVE CAN-SGV-TPAG IN CAN TO CAN-SGV-TPAG IN CAN-FLD.


           IF WSS-CIC-TVAL = '0'
              MOVE CAN-SGV-TPAG IN CAN TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO CAN-SGV-TPAG IN CAN
              MOVE RCV-SGV-CAPI IN RCV TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-CAPI IN RCV
              MOVE RCV-SGV-INTE IN RCV TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-INTE IN RCV
              MOVE RCV-SGV-INTM IN RCV TO PES-SGV-DECI IN PES-VARI
              PERFORM PES-SCTV
              MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-INTM IN RCV.

           MOVE CAN-SGV-TPAG IN CAN TO CAN-SGV-TPAG IN CAN-FLD.


********* SE TERMINA EL CALCULO DE RCV, LOS OTROS VALORES
********* NO SON NECESARIOS PARA DESPLEGARLOS EN PANTALLA CSC

       FIN-CREA-RCV.
           EXIT.
**********************************************************************
**************FIN SE DEBE COPIAR EL CODIGO DE ACT-RCV.
**********************************************************************



       CHK-PNR-BGT SECTION.
       INI-CHK-PNR-BGT.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPC-COD-TOOC IN OPC TO TOC-COD-TOCR IN TOC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               MOVE 'CANTOOCNEX' TO MSG-COD-MENS
               GO TO FIN-CHK-PNR-BGT.
           MOVE TOC-MSC-OPEC IN TOC TO WSS-OPEC.
           IF NOT ( ( CAN-MSC-TCAN = 'N' OR 'R' OR 'P' ) AND
              ( WSS-OPEC = 'B' ) )
               GO TO FIN-CHK-PNR-BGT.
           MOVE 'TAB' TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CODTVLRNEX' TO MSG-COD-MENS
               GO TO FIN-CHK-PNR-BGT.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.
           IF NOT ( WSS-CIC-TVAL     = '0' AND
                    WSS-CIC-VCAM NOT = '0999' )
               MOVE RCV-SGV-CAPI IN RCV TO WSS-VAL-SVEN
               GO TO SUM-CHK-PNR-BGT.

           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           MOVE '0999  '            TO TAB-CIC-CTAB IN TAB.
           MOVE CAN-FEC-FCAN IN CAN TO TAB-FEC-FTRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES
               MULTIPLY RCV-SGV-CAPI IN RCV BY CAM-SGV-VCAM IN CAM
                        GIVING WSS-VAL-SVEN ROUNDED
           ELSE
               GO TO FIN-CHK-PNR-BGT.
           MOVE WSS-VAL-SVEN TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-VAL-SVEN.
       SUM-CHK-PNR-BGT.
           ADD WSS-VAL-SVEN TO CAN-SGV-TREN IN CAN.
       FIN-CHK-PNR-BGT.
           EXIT.


       BUS-DIA-POST SECTION.
       INI-BUS-DIA-POST.
       SUM-DIA-NHBL.
           MOVE WSS-NUM-DPO2 TO FEC-ITM1.
           MOVE WSS-NUM-MPO2 TO FEC-ITM2.
           MOVE WSS-NUM-SPO2 TO FEC-ITM3.
           MOVE WSS-NUM-APO2 TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1 TO WSS-NUM-DPO2.
           MOVE FEC-ITM2 TO WSS-NUM-MPO2.
           MOVE FEC-ITM3 TO WSS-NUM-SPO2.
           MOVE FEC-ITM4 TO WSS-NUM-APO2.

           MOVE WSS-NUM-DPO2 TO FEC-ITM1.
           MOVE WSS-NUM-MPO2 TO FEC-ITM2.
           MOVE WSS-NUM-SPO2 TO FEC-ITM3.
           MOVE WSS-NUM-APO2 TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              IF WSS-FEC-FPO1 IN WSS-VARI NOT > ZEROES
                 MOVE WSS-FEC-FPO2 IN WSS-VARI TO WSS-FEC-FPO1
                                                   IN WSS-VARI
                 GO TO SUM-DIA-NHBL
              ELSE
                 MOVE WSS-FEC-FPO2 IN WSS-VARI TO WSS-FEC-FPO3
                                                   IN WSS-VARI
                 GO TO SUM-DIA-NHBL.

           IF WSS-FEC-FPO3 = ZEROES
              MOVE WSS-FEC-FPO1 IN WSS-VARI TO WSS-FEC-FPO2 IN WSS-VARI
           ELSE
              MOVE WSS-FEC-FPO3 IN WSS-VARI TO WSS-FEC-FPO2 IN WSS-VARI.
       FIN-BUS-DIA-POST.
           EXIT.

      *PVC-INI 28-01-2014 DEVOL. PRIMA SEGUROS POR PREPAGO
       COPY COLBBDPS.
      *PVC-FIN 28-01-2014
      * MPS-INI USO DE LA CEN EN EL CANCELADOR 23/12/2015
       COPY COLBFCEN.
      * MPS-FIN USO DE LA CEN EN EL CANCELADOR 23/12/2015
       COPY COLBFOPC.
       COPY COLBFPCP.
       COPY COLBFDIC.
       COPY COLBFCYA.
       COPY COLBFAUT.
       COPY COLBFVEN.
       COPY COLBFRCV.
       COPY COLBFTOC.
       COPY COLBFRDT.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFICG.
       COPY COLBFRDC.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY COLBGVEN.
       COPY COLBGCTO.
*********************************************************************
******* INICIO  COPY COLBGNOR.
******* EN LUGAR DE COLBGNOR SE INCLUYE EL CODIGO, YA QUE
******* HACE REFERENCIAN A FEC-VEN-FVEN SIN ASOCIARLA CON LA TABLA VEN
*********************************************************************
       OBT-COM-NOR SECTION.
       INI-OBT-COM-NOR.
           PERFORM INI-VARI.
           PERFORM PRO-PCCN.
       FIN-OBT-COM-NOR.
           EXIT.
       INI-VARI SECTION.
       INI-INI-VARI.
           IF NOR-FCAN IS NOT NUMERIC OR
              NOR-FCAN = ZEROES OR
              NOR-FCAN = SPACES
              PERFORM GET-FHOY
              MOVE HOY-FHOY TO NOR-FEC-PROC
           ELSE
              MOVE NOR-FCAN TO NOR-FEC-PROC
           END-IF.
           MOVE 'COL'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'PCP'               TO TAB-COD-TTAB IN TAB.
           MOVE 'TIO         '      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DATA IN TAB TO NOR-GLS-DATA-TIOS
           ELSE
               MOVE 'CCNPCP  INEX'               TO NOR-CMSG
           END-IF.
           MOVE 'COL'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'PCP'               TO TAB-COD-TTAB IN TAB.
           MOVE 'TIOVCD      '      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              TAB-IND-VIGE IN TAB = 'S'
               MOVE TAB-GLS-DATA IN TAB TO NOR-GLS-DATA-TIOS-VCD
           ELSE
               MOVE 'CCNPCP  INEX'               TO NOR-CMSG
           END-IF.
           IF NOR-CMSG NOT > SPACES
              PERFORM CARGA-TABLA-BCX
           END-IF
           IF NOR-CMSG NOT > SPACES
              PERFORM CARGA-TABLA-BCV
           END-IF.
       FIN-INI-VARI.
           EXIT.

       PRO-PCCN SECTION.
       INI-PRO-PCCN.
           MOVE SPACES TO NOR-MMSG NOR-CMSG.
           MOVE 0      TO NOR-RETO.
           MOVE NOR-IOPC TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-MSC-STAT IN OPC = 'A' )
               MOVE 'OPC    NEX'        TO NOR-CMSG
           ELSE
              MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC
              MOVE 0                   TO DLC-NUM-IDLC IN DLC
              MOVE FIO-GET-NLS TO FIO-CMND
              PERFORM COL-FIO-DLC
              IF NOT ( FIO-STAT-OKS AND
                       DLC-CIC-IOPC IN DLC = OPC-CIC-IOPC IN OPC )
                 MOVE 'OPC    DLCNX'      TO NOR-CMSG
              ELSE
                 IF ( DLC-IND-SCTB IN DLC = 'VCD' AND
                      DLC-IND-SCBZ IN DLC = SPACES ) OR
                    ( DLC-IND-SCTB IN DLC = SPACES OR 'VIG' OR 'MUL' )
                    IF DLC-IND-SCTB IN DLC = 'VCD'
                       IF ( NOR-IVIG = '*' OR 'V' )
                            PERFORM VALIDA-COBRO-VCD
                       ELSE
                            MOVE ZEROES  TO  NOR-CONO
                       END-IF
                    ELSE
                       IF ( NOR-IVIG = '*' OR 'N' )
                            PERFORM VALIDA-COBRO-VIG
                       ELSE
                            MOVE ZEROES  TO  NOR-CONO
                       END-IF
                    END-IF
                 ELSE
                    MOVE ZEROES  TO  NOR-CONO
                 END-IF
              END-IF
           END-IF
           IF  NOR-CMSG  = SPACES
               PERFORM COMPLETA-RETORNO-OK
               GO TO FIN-PRO-PCCN.
           MOVE SPACES TO NOR-DOUT.
           MOVE 1      TO NOR-RETO.
           MOVE 'COL'          TO MSG-COD-SIST
           MOVE NOR-CMSG       TO MSG-COD-MENS
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC TO NOR-MMSG.
       FIN-PRO-PCCN.
           EXIT.

       COMPLETA-RETORNO-OK SECTION.
       INI-COMPLETA-RETORNO-OK.
           MOVE '0'     TO  NOR-RETO.
           MOVE SPACES  TO  NOR-MMSG.
           MOVE NOR-IOPC TO NOR-OOPC.
           MOVE NOR-VCAM TO NOR-OVCA.
           MOVE SPACES   TO NOR-FILL.
       FIN-COMPLETA-RETORNO-OK.
           EXIT.
      *
       CARGA-TABLA-BCX SECTION.
       INI-CARGA-TABLA-BCX.
           MOVE 'COL'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'BCX'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              'BCX' = TAB-COD-TTAB IN TAB AND
              TAB-IND-VIGE IN TAB = 'S'
               PERFORM REDNX-BCX UNTIL ('BCX' NOT = TAB-COD-TTAB OR
                                 FIO-STAT = '14' OR NOR-BCX = 200)
           ELSE
               MOVE 'CCNBCX   INEX' TO NOR-CMSG
           END-IF.
       FIN-CARGA-TABLA-BCX.
           EXIT.


       REDNX-BCX SECTION.
       INI-REDNX-BCX.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              'BCX' = TAB-COD-TTAB IN TAB AND TAB-IND-VIGE = 'S'
               ADD 1 TO NOR-BCX
               MOVE TAB-COD-CTAB IN TAB TO NOR-COD-BANCA(NOR-BCX)
               MOVE TAB-GLS-DATA IN TAB TO NOR-GLS-DATA(NOR-BCX)
           END-IF.
       FIN-REDNX-BCX.
           EXIT.

       CARGA-TABLA-BCV SECTION.
       INI-CARGA-TABLA-BCV.
           MOVE 'COL'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'BCV'               TO TAB-COD-TTAB IN TAB.
           MOVE SPACES              TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              'BCV' = TAB-COD-TTAB IN TAB AND
              TAB-IND-VIGE IN TAB = 'S'
               PERFORM REDNX-BCV UNTIL ('BCV' NOT = TAB-COD-TTAB OR
                                 FIO-STAT = '14' OR NOR-BCV = 200)
           ELSE
               MOVE 'CCNBCV   INEX' TO NOR-CMSG
           END-IF.
       FIN-CARGA-TABLA-BCV.
           EXIT.


       REDNX-BCV SECTION.
       INI-REDNX-BCV.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND
              'BCV' = TAB-COD-TTAB IN TAB AND TAB-IND-VIGE = 'S'
               ADD 1 TO NOR-BCV
               MOVE TAB-COD-CTAB IN TAB TO NOR-COD-BANCA-VCD(NOR-BCV)
               MOVE TAB-GLS-DATA IN TAB TO NOR-GLS-DATA-VCD(NOR-BCV)
           END-IF.
       FIN-REDNX-BCV.
           EXIT.
       VAL-FO-EVC SECTION.
       INI-VAL-FO-EVC.
           MOVE OPC-CIC-IOPC IN OPC TO EVC-CIC-IOPC IN EVC.
           MOVE ZEROES              TO EVC-NUM-IEVC IN EVC
                                       NOR-EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-EVC.
           PERFORM CAL-NUM-FO-EVC UNTIL
                   ( NOT FIO-STAT-OKS OR
                     OPC-CIC-IOPC IN OPC NOT = EVC-CIC-IOPC IN EVC OR
                     NOR-EVC > 1).
       FIN-VAL-FO-EVC.
           EXIT.
       CAL-NUM-FO-EVC SECTION.
       INI-CAL-NUM-FO-EVC.
           IF EVC-MSC-TCVE = 'FO'
               ADD 1 TO NOR-EVC
           END-IF.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-EVC.
       FIN-CAL-NUM-FO-EVC.
           EXIT.

       VALIDA-COBRO-VCD SECTION.
       INI-VALIDA-COBRO-VCD.
           MOVE 0 TO NOR-CONSUMO.
           PERFORM VAL-TIPO-OPC-VCD VARYING NOR-I FROM 1 BY 1 UNTIL
                               ( NOR-CONSUMO = 1 OR NOR-I > 20 OR
                                 NOR-GLS-TIO-VCD(NOR-I) = SPACES ).
           PERFORM VALIDA-COBRO.
       FIN-VALIDA-COBRO-VCD.
           EXIT.

       VALIDA-COBRO-VIG SECTION.
       INI-VALIDA-COBRO-VIG.
           MOVE 0 TO NOR-CONSUMO.
           PERFORM VAL-TIPO-OPC VARYING NOR-I FROM 1 BY 1 UNTIL
                               ( NOR-CONSUMO = 1 OR NOR-I > 20 OR
                                 NOR-GLS-TIO(NOR-I) = SPACES ).
           PERFORM VALIDA-COBRO.
       FIN-VALIDA-COBRO-VIG.
           EXIT.
       VALIDA-COBRO SECTION.
       INI-VALIDA-COBRO.
           IF NOR-CONSUMO = 1
      *       PERFORM VAL-FO-EVC
      *       IF NOR-EVC > 0
                 PERFORM VALIDA-BANCA-CLIENTE
                 IF  NOR-CMSG > SPACES
                     GO TO FIN-VALIDA-COBRO
                 END-IF
                 IF NOR-TBAN = 1
                    PERFORM LEER-VEN
                    IF NOR-CMSG NOT > SPACES
                       PERFORM OBT-NUM-DIAS
                       IF NOR-CMSG NOT > SPACES
                          IF NOR-NUM-DIAS > ZEROES
                             PERFORM CAL-COM-NORMA
                          ELSE
                             MOVE ZEROES  TO  NOR-CONO
                          END-IF
                       END-IF
                    END-IF
                 ELSE
                    MOVE ZEROES  TO  NOR-CONO
                 END-IF
      *       ELSE
      *          MOVE ZEROES  TO  NOR-CONO
      *       END-IF
           ELSE
              MOVE ZEROES  TO  NOR-CONO
           END-IF.
       FIN-VALIDA-COBRO.
           EXIT.
       LEER-VEN SECTION.
       INI-LEER-VEN.
           IF NOT ( NOR-FVEN IS NOT NUMERIC OR
                    NOR-FVEN = ZEROES OR
                    NOR-FVEN = SPACES)
               MOVE NOR-FVEN TO VEN-FEC-FVEN IN VEN
               GO TO FIN-LEER-VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           IF OPC-IND-VSTR IN OPC = 'S'
              MOVE 1 TO VEN-NUM-IVEN IN VEN
           ELSE
              MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
           END-IF.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              MOVE 'CCNVEN  INEX' TO NOR-CMSG
           END-IF.
       FIN-LEER-VEN.
           EXIT.
       CAL-COM-NORMA SECTION.
       INI-CAL-COM-NORMA.
           MOVE 0 TO NOR-PLAN.
           PERFORM VAL-TIPO-PLAN VARYING NOR-J FROM 1 BY 1
                                 UNTIL (NOR-PLAN = 1 OR NOR-J = 45 OR
                                        NOR-COD-PLAN(NOR-J) = SPACES)
           IF NOR-PLAN = 1
              IF NOR-NUM-DIAS NOT < NOR-NUM-DIME
                 PERFORM CONT-CAL-MORA
              END-IF
           ELSE
              IF NOR-NUM-DIAS NOT < NOR-NUM-DIMC
                 PERFORM CONT-CAL-MORA
              END-IF
           END-IF.
       FIN-CAL-COM-NORMA.
           EXIT.
       CONT-CAL-MORA SECTION.
       INI-CONT-CAL-MORA.
           PERFORM OBT-CTA-CTE.
           IF (( NOR-CTA-CTE = 1 AND NOR-ICTA = 'S' ) OR
               ( NOR-CTA-CTE = 0 AND NOR-ICTA = 'N' ) OR
               ( NOR-CTA-CTE = 1 AND NOR-ICTA = '*' ) OR
               ( NOR-CTA-CTE = 0 AND NOR-ICTA = '*' ))
              PERFORM CALCULA-PORCENTAJE
              IF NOR-PORC = 1 AND
                 NOR-SALIR = 1
                 PERFORM VAL-MTO-CALC
                 MOVE 0 TO NOR-TBAN NOR-PORC
              ELSE
                 IF NOR-PORC = 0
                    MOVE ZEROES  TO  NOR-CONO
                 ELSE
                    PERFORM VAL-MTO-CALC
                 END-IF
              END-IF
           ELSE
              MOVE ZEROES  TO  NOR-CONO
           END-IF.
       FIN-CONT-CAL-MORA.
           EXIT.
       CALCULA-PORCENTAJE SECTION.
       INI-CALCULA-PORCENTAJE.
           MOVE 0 TO NOR-PORC.
           MOVE NOR-NUM-DIAS TO NOR-DIF-DIAS-R
           IF DBC-IND-TICL IN DBC = 'P'
              MOVE DCP-COD-TBAN IN DCP TO NOR-COD-TBAN
           ELSE
              MOVE DCE-COD-TBAN IN DCE TO NOR-COD-TBAN
           END-IF

      * TRANSFORMAR VALOR PAGADO A UF PARA BUSCAR TRAMO
           IF NOR-VCAM = '0999  '
              COMPUTE NOR-SGV-TPAG ROUNDED = NOR-TPAG / NOR-SGV-VCAM
              MOVE    NOR-SGV-TPAG TO NOR-SGV-CALC-FIJO
           ELSE
              MOVE NOR-TPAG TO NOR-SGV-TPAG NOR-SGV-CALC-FIJO
           END-IF

           IF DLC-IND-SCTB IN DLC = 'VCD'
              MOVE 1 TO NOR-I
              PERFORM VAL-TRAMO-BANCA-VCD UNTIL
                      (NOR-PORC = 1 OR NOR-I > NOR-BCV)

              IF NOR-PORC = 1
                 MOVE 0 TO NOR-TRAMO-ANT NOR-SGV-CALC-R NOR-SALIR
                           NOR-SGV-AUX
                 PERFORM BUS-SGTE-TRAMO-VCD UNTIL
                        NOR-KEY-BCA NOT = NOR-VAL-KEY OR NOR-SALIR = 1
                 IF NOR-SALIR = 0
                    MOVE 0 TO NOR-SGV-CALC-R
                 END-IF

                 IF NOR-VCAM = '0999  '
                    COMPUTE NOR-SGV-CALC ROUNDED = NOR-SGV-CALC-R *
                                               NOR-SGV-VCAM / 100
                 ELSE
                   COMPUTE NOR-SGV-CALC ROUNDED = NOR-SGV-CALC-R / 100
                 END-IF
              END-IF
           ELSE
              MOVE 1 TO NOR-I
              PERFORM VAL-TRAMO-BANCA UNTIL
                     (NOR-PORC = 1 OR NOR-I > NOR-BCX)

              IF NOR-PORC = 1
                 MOVE 0 TO NOR-TRAMO-ANT NOR-SGV-CALC-R NOR-SALIR
                           NOR-SGV-AUX
                 PERFORM BUS-SGTE-TRAMO UNTIL
                         NOR-KEY-BCA NOT = NOR-VAL-KEY OR NOR-SALIR = 1
                 IF NOR-SALIR = 0
                    MOVE 0 TO NOR-SGV-CALC-R
                 END-IF
                 IF NOR-VCAM = '0999  '
                    COMPUTE NOR-SGV-CALC ROUNDED = NOR-SGV-CALC-R *
                                                  NOR-SGV-VCAM / 100
                 ELSE
                   COMPUTE NOR-SGV-CALC ROUNDED = NOR-SGV-CALC-R / 100
                 END-IF
              END-IF
           END-IF.
       FIN-CALCULA-PORCENTAJE.
           EXIT.

       VAL-TRAMO-BANCA SECTION.
       INI-VAL-TRAMO-BANCA.
           MOVE NOR-COD-BANCA(NOR-I) TO NOR-COD-KEY-BANCA.

           IF NOR-KEY-BCA NOT < NOR-VAL-KEY

               MOVE NOR-GLS-DATA(NOR-I) TO NOR-GLS-DATA-PORC
               MOVE NOR-KEY-BCA TO NOR-VAL-KEY
               MOVE 1 TO NOR-PORC
           ELSE
               ADD 1 TO NOR-I
           END-IF.
       FIN-VAL-TRAMO-BANCA.
           EXIT.

       BUS-SGTE-TRAMO SECTION.
       INI-BUS-SGTE-TRAMO.
           COMPUTE NOR-SGV-AUX = NOR-SGV-TPAG + NOR-TRAMO-ANT.
           IF NOR-SGV-AUX > NOR-TRAMO-R
               COMPUTE NOR-SGV-CALC-R = NOR-SGV-CALC-R +
                      (NOR-TRAMO-R - NOR-TRAMO-ANT) *
                       NOR-SGV-PORC
               ADD NOR-TRAMO-ANT TO NOR-SGV-TPAG
               SUBTRACT NOR-TRAMO-R FROM NOR-SGV-TPAG
               MOVE NOR-TRAMO-R TO NOR-TRAMO-ANT
               ADD 1 TO NOR-I
               MOVE NOR-COD-BANCA(NOR-I) TO NOR-COD-KEY-BANCA
               MOVE NOR-GLS-DATA(NOR-I) TO NOR-GLS-DATA-PORC
           ELSE
               IF NOR-SGV-TPAG = 0
                   MOVE 1 TO NOR-SALIR
               ELSE
                   COMPUTE NOR-SGV-CALC-R = NOR-SGV-CALC-R +
                                        (NOR-SGV-TPAG * NOR-SGV-PORC)
                   MOVE 1 TO NOR-SALIR
               END-IF
           END-IF.
       FIN-BUS-SGTE-TRAMO.
           EXIT.

       VAL-TRAMO-BANCA-VCD SECTION.
       INI-VAL-TRAMO-BANCA-VCD.
           MOVE NOR-COD-BANCA-VCD(NOR-I) TO NOR-COD-KEY-BANCA.
           IF NOR-KEY-BCA NOT < NOR-VAL-KEY
               MOVE NOR-GLS-DATA-VCD(NOR-I) TO NOR-GLS-DATA-PORC
               MOVE NOR-KEY-BCA TO NOR-VAL-KEY
               MOVE 1 TO NOR-PORC
           ELSE
               ADD 1 TO NOR-I
           END-IF.
       FIN-VAL-TRAMO-BANCA-VCD.
           EXIT.

       BUS-SGTE-TRAMO-VCD SECTION.
       INI-BUS-SGTE-TRAMO-VCD.
           COMPUTE NOR-SGV-AUX = NOR-SGV-TPAG + NOR-TRAMO-ANT.
           IF NOR-SGV-AUX > NOR-TRAMO-R
               COMPUTE NOR-SGV-CALC-R = NOR-SGV-CALC-R +
                      (NOR-TRAMO-R - NOR-TRAMO-ANT) *
                       NOR-SGV-PORC
               ADD NOR-TRAMO-ANT TO NOR-SGV-TPAG
               SUBTRACT NOR-TRAMO-R FROM NOR-SGV-TPAG
               MOVE NOR-TRAMO-R TO NOR-TRAMO-ANT
               ADD 1 TO NOR-I
               MOVE NOR-COD-BANCA-VCD(NOR-I) TO NOR-COD-KEY-BANCA
               MOVE NOR-GLS-DATA-VCD(NOR-I) TO NOR-GLS-DATA-PORC
           ELSE
               IF NOR-SGV-TPAG = 0
                   MOVE 1 TO NOR-SALIR
               ELSE
                   COMPUTE NOR-SGV-CALC-R = NOR-SGV-CALC-R +
                                        (NOR-SGV-TPAG * NOR-SGV-PORC)
                   MOVE 1 TO NOR-SALIR
               END-IF
           END-IF.
       FIN-BUS-SGTE-TRAMO-VCD.
           EXIT.

       VAL-TIPO-OPC SECTION.
       INI-VAL-TIPO-OPC.
           IF NOR-GLS-TIO(NOR-I) = OPC-COD-TOOC IN OPC
               MOVE 1 TO NOR-CONSUMO
           END-IF.
       FIN-VAL-TIPO-OPC.
           EXIT.

       VAL-TIPO-OPC-VCD SECTION.
       INI-VAL-TIPO-OPC-VCD.
           IF NOR-GLS-TIO-VCD (NOR-I) = OPC-COD-TOOC IN OPC
               MOVE 1 TO NOR-CONSUMO
           END-IF.
       FIN-VAL-TIPO-OPC-VCD.
           EXIT.

       OBT-CTA-CTE SECTION.
       INI-OBT-CTA-CTE.
           MOVE 0 TO NOR-CTA-CTE.
           MOVE RDC-CIC-ICLI IN RDC TO RCO-CIC-ICLI IN RCO
           MOVE FIO-GET-NLS TO FIO-CMND
           PERFORM SGC-FIO-RCO
           IF FIO-STAT-OKS AND
              RDC-CIC-ICLI IN RDC = RCO-CIC-ICLI IN RCO
              PERFORM REC-RCO UNTIL NOT ( FIO-STAT-OKS   AND
                      NOR-CTA-CTE = 0              AND
                      RDC-CIC-ICLI IN RDC = RCO-CIC-ICLI IN RCO )
              END-IF.
       FIN-OBT-CTA-CTE.
           EXIT.

       REC-RCO SECTION.
       INI-REC-RCO.
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS  AND
              OPE-COD-STAT IN OPE = 'VIG' AND
              OPE-FEC-FIOP IN OPE NOT = NOR-FEC-PROC
      *AFRI-INI-DIC-2005
               IF OPE-COD-TOPR IN OPE = 'CCT' OR
                  OPE-COD-TOPR IN OPE = 'CPR'
                   MOVE 1 TO NOR-CTA-CTE
               ELSE
                   MOVE 0 TO NOR-CTA-CTE
      *AFRI-FIN-DIC-2005
           ELSE
               MOVE 0 TO NOR-CTA-CTE
           END-IF.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
       FIN-REC-RCO.
           EXIT.

       VALIDA-BANCA-CLIENTE SECTION.
       INI-VALIDA-BANCA-CLIENTE.
           MOVE 0 TO NOR-TBAN.
           MOVE 1 TO NOR-I.
           MOVE LOW-VALUE           TO RDC.
           MOVE OPC-CIC-IOPC IN OPC TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-NLS         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = RDC-CIC-IOPC IN RDC AND
                    RDC-NUM-IDLC IN RDC = ZEROES )
              MOVE 'CCNRDC  INEX'  TO NOR-CMSG
           ELSE
              MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
              MOVE FIO-GET-KEY         TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF NOT FIO-STAT-OKS
                 MOVE 'CCNDBC  INEX'  TO NOR-CMSG
              ELSE
                 IF DBC-IND-TICL = 'P'
                    PERFORM PROCESO-PERSONA
                 ELSE
                    IF DBC-IND-TICL = 'E'
                       PERFORM PROCESO-EMPRESA
                    ELSE
                       MOVE 'CCNTPE  DESC'  TO NOR-CMSG
                    END-IF
                 END-IF
              END-IF
           END-IF.
       FIN-VALIDA-BANCA-CLIENTE.
           EXIT.
       PROCESO-PERSONA SECTION.
       INI-PROCESO-PERSONA.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCP
           IF NOT FIO-STAT-OKS
              MOVE 'CCNDCP  INEX'  TO NOR-CMSG
           ELSE
              MOVE DCP-COD-TBAN IN DCP TO NOR-COD-TBAN
              MOVE SPACES              TO NOR-DIF-DIAS
              IF DLC-IND-SCTB IN DLC = 'VCD'
                 PERFORM VAL-TIPO-BANCA-VCD
                             VARYING NOR-I FROM 1 BY 1 UNTIL
                             (NOR-TBAN = 1 OR NOR-I > NOR-BCV )
              ELSE
                 PERFORM VAL-TIPO-BANCA
                          VARYING NOR-I FROM 1 BY 1 UNTIL
                          (NOR-TBAN = 1 OR NOR-I > NOR-BCX )
              END-IF
              IF NOR-TBAN = 1
                 PERFORM VAL-ANEXOS-BCX
                 IF NOR-CMSG = SPACES
                    PERFORM BUSCAR-TIPO-CAMBIO
                    IF  NOR-CMSG > SPACES
                        GO TO FIN-PROCESO-PERSONA
                    ELSE
                           COMPUTE NOR-PORC-MIN ROUNDED =
                                        NOR-SGV-MMIN * NOR-SGV-VCAM
                           COMPUTE NOR-PORC-MAX ROUNDED =
                                        NOR-SGV-MMAX * NOR-SGV-VCAM
                    END-IF
                 END-IF
              ELSE
                 MOVE ZEROES  TO  NOR-CONO
              END-IF
           END-IF.
       FIN-PROCESO-PERSONA.
           EXIT.
       PROCESO-EMPRESA SECTION.
       INI-PROCESO-EMPRESA.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
              MOVE 'CCNDCE  INEX'  TO NOR-CMSG
           ELSE
              MOVE DCE-COD-TBAN IN DCE TO NOR-COD-TBAN
              MOVE SPACES              TO NOR-DIF-DIAS
              IF DLC-IND-SCTB IN DLC = 'VCD'
                 PERFORM VAL-TIPO-BANCA-VCD
                              VARYING NOR-I FROM 1 BY 1 UNTIL
                              (NOR-TBAN = 1 OR NOR-I > NOR-BCV )
              ELSE
                 PERFORM VAL-TIPO-BANCA
                              VARYING NOR-I FROM 1 BY 1 UNTIL
                              (NOR-TBAN = 1 OR NOR-I > NOR-BCX)
              END-IF
              IF NOR-TBAN = 1
                 PERFORM VAL-ANEXOS-BCX
                 IF NOR-CMSG = SPACES
                    PERFORM BUSCAR-TIPO-CAMBIO
                    IF  NOR-CMSG > SPACES
                        GO TO FIN-PROCESO-EMPRESA
                    ELSE
                           COMPUTE NOR-PORC-MIN ROUNDED =
                                     NOR-SGV-MMIN * NOR-SGV-VCAM
                           COMPUTE NOR-PORC-MAX ROUNDED =
                                     NOR-SGV-MMAX * NOR-SGV-VCAM
                    END-IF
                 END-IF
              END-IF
           END-IF.
       FIN-PROCESO-EMPRESA.
           EXIT.


       VAL-TIPO-BANCA SECTION.
       INI-VAL-TIPO-BANCA.
           IF NOR-COD-BANCA(NOR-I) = NOR-VAL-KEY
               MOVE NOR-GLS-DATA(NOR-I) TO NOR-GLS-DATA-BANCA
               MOVE 1 TO NOR-TBAN
           END-IF.
       FIN-VAL-TIPO-BANCA.
           EXIT.

       VAL-TIPO-BANCA-VCD SECTION.
       INI-VAL-TIPO-BANCA-VCD.
           IF NOR-COD-BANCA-VCD(NOR-I) = NOR-VAL-KEY
               MOVE NOR-GLS-DATA-VCD(NOR-I) TO NOR-GLS-DATA-BANCA
               MOVE 1 TO NOR-TBAN
           END-IF.
       FIN-VAL-TIPO-BANCA-VCD.
           EXIT.

       VAL-TIPO-PLAN SECTION.
       INI-VAL-TIPO-PLAN.
           IF DBC-IND-TICL IN DBC = 'P'
               IF DCP-COD-TPLN IN DCP = NOR-COD-PLAN(NOR-J)
                   MOVE 1 TO NOR-PLAN
               END-IF
           ELSE
               IF DCE-COD-TPLN IN DCE = NOR-COD-PLAN(NOR-J)
                   MOVE 1 TO NOR-PLAN
               END-IF
           END-IF.
       FIN-VAL-TIPO-PLAN.
           EXIT.


       VAL-MTO-CALC SECTION.
       INI-VAL-MTO-CALC.
           IF NOR-SGV-CALC > NOR-PORC-MAX
               MOVE NOR-PORC-MAX     TO NOR-CONO
           ELSE
               MOVE NOR-SGV-CALC     TO NOR-CONO
           END-IF.

           IF NOR-CONO < NOR-PORC-MIN
               MOVE NOR-PORC-MIN     TO NOR-CONO
           END-IF.
       FII-VAL-MTO-CALC.
           EXIT.
       OBT-NUM-DIAS SECTION.
       INI-OBT-NUM-DIAS.
********* SE AGREGA DEPENDENCIA DE VEN-FEC-FVEN CON TABLA VEN
           IF VEN-FEC-FVEN IN VEN NOT < NOR-FEC-PROC
              MOVE ZEROES   TO NOR-NUM-DIAS
              GO TO FIN-OBT-NUM-DIAS.
           MOVE VEN-NUM-DVEN IN VEN TO FEC-DEC1.
           MOVE VEN-NUM-MVEN IN VEN TO FEC-MEC1.
           MOVE VEN-NUM-SVEN IN VEN TO FEC-SEC1.
           MOVE VEN-NUM-AVEN IN VEN TO FEC-AEC1.
           MOVE NOR-NUM-DPROC TO FEC-DEC2.
           MOVE NOR-NUM-MPROC TO FEC-MEC2.
           MOVE NOR-NUM-SPROC TO FEC-SEC2.
           MOVE NOR-NUM-APROC TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'FECSTATNOOK'    TO NOR-CMSG
           ELSE
               MOVE FEC-NDIA TO NOR-NUM-DIAS.
       FIN-OBT-NUM-DIAS.
           EXIT.
       BUSCAR-TIPO-CAMBIO SECTION.
       INI-BUSCAR-TIPO-CAMBIO.
           IF NOR-GLS-MONE = '0999  '
              MOVE 1 TO NOR-SGV-VCAM
           ELSE
             MOVE NOR-FEC-PROC    TO CAM-FEC-FCAM IN CAM(1)
                                 CAM-FEC-FCAM IN CAM(2)
             MOVE NOR-GLS-MONE TO CAM-COD-VCAM IN CAM(1)
             MOVE '0999  '    TO CAM-COD-VCAM IN CAM(2)
             MOVE FIO-GET-KEY TO FIO-CMND
             PERFORM TAB-FIO-CAM
             IF FIO-STAT-OKS
                MOVE CAM-SGV-VCAM IN CAM TO NOR-SGV-VCAM
             ELSE
                IF FIO-STAT = '14'
                   MOVE 'CCNCAM  INEX'    TO NOR-CMSG
                ELSE
                   MOVE 'CCNCAM   ERR'    TO NOR-CMSG
                END-IF
             END-IF
           END-IF.
       FIN-BUSCAR-TIPO-CAMBIO.
           EXIT.
       VAL-ANEXOS-BCX SECTION.
       INI-VAL-ANEXOS-BCX.
           IF NOR-SGV-MMIN IS NOT NUMERIC
               MOVE 'CCNPJEMINNNU' TO  NOR-CMSG
           END-IF.

           IF NOR-NUM-DIMC IS NOT NUMERIC
               MOVE 'CCNDIAINMNNU' TO  NOR-CMSG
           END-IF.

           IF NOR-IND-TDMC NOT = 'H' AND 'C'
               MOVE 'CCNINDHACOER' TO  NOR-CMSG
           END-IF.

           IF NOR-GLS-MONE NOT > SPACES
               MOVE 'CCNMONINVALI' TO  NOR-CMSG
           ELSE
               PERFORM VAL-MONEDA-BCX
           END-IF.
       FIN-VAL-ANEXOS-BCX.
           EXIT.

       VAL-MONEDA-BCX SECTION.
       INI-VAL-MONEDA-BCX.
           MOVE 'TAB'         TO TAB-COD-SIST FIO-SIST.
           MOVE 'VLR '        TO TAB-COD-TTAB IN TAB.
           MOVE NOR-GLS-MONE   TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY   TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CCNMONNOOK  ' TO  NOR-CMSG
           ELSE
              IF TAB-IND-VIGE IN TAB NOT = 'S'
                 MOVE 'CCNMONNOVIG ' TO  NOR-CMSG
              END-IF
           END-IF.
       FIN-VAL-MONEDA-BCX.
           EXIT.
*********************************************************************
******* FIN  COPY COLBGNOR.
*********************************************************************
       COPY TABBFCAM.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY GNSBFMSC.
       COPY GNSBBTAB.
       COPY GNSBBMSC.
       COPY GNSBGCAM.
       COPY GNSBPFEC.
       COPY GNSBGEND.
       COPY GNSBGABT.
       COPY GNSBGPES.
       COPY COLBGINT.
       COPY GNSBGCVI.
       COPY COLB3CAN.
       COPY COLBFCOM.
       COPY COLBFEJC.
       COPY COLBFITR.
       COPY COLBFPOC.
       COPY COLBFROV.
       COPY COLIOTMC.
       COPY COLBGCLI.
       COPY COLBGVDI.
       COPY COLBGMPC.
       COPY COLBGPCP.
       PCP-PRO-SAF SECTION.
       PCP-PRO-ACT SECTION.
       PCP-PRO-VAL SECTION.
       PCP-PRO-VKY SECTION.
       PCP-PRO-VDA SECTION.
       PCP-PRO-ING SECTION.
       PCP-PRO-MOD SECTION.
       PCP-PRO-ELI SECTION.
       PCP-PRO-CON SECTION.
       PCP-PRO-CO2 SECTION.
       PCP-PRO-PF7 SECTION.
       PCP-PRO-AC7 SECTION.
       PCP-PRO-PF8 SECTION.
       PCP-PRO-AC8 SECTION.
       PCP-PRO-CUR SECTION.
       COPY COLB6CAN.
       PROCESA-PCP SECTION.
       INI-PROCESA-PCP.
           PERFORM COL-PRO-PCP.
           IF PCP-RETO = '1'
               MOVE SPACES TO PCP
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'ERROR PCP'    TO PCP-CMSG MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE PCP-MMSG       TO FRM-MEN2
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PROCESA-PCP.
       FIN-PROCESA-PCP.
           EXIT.
       COPY COLBMCAN.
       COPY GNSBFCIC.
       COPY GNSBBCIC.
       COPY GNSBGCPT.
       COPY GNSBBVRF.
       COPY GNSBVIDC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY SGCBFDBC.
       COPY SGCBFDCP.
       COPY SGCBFDCE.
       COPY TABBBOFI.
       COPY TABBBUSR.
       COPY TABBFUSR.
       COPY TABBVTDU.
       COPY COLBGPVE.
       COPY COLBFIYC.
       COPY DEUBFCRI.


       CARGA-TAB-TBAN SECTION.
       INI-CARGA-TAB-TBAN.
           MOVE 'NEX'  TO TBAN-COD-TBAN(1).
           MOVE ZEROES TO TBAN-NUM-NDIA(1).
            MOVE 1       TO TBAN-J.
            MOVE 1       TO TBAN-IMAX.
           MOVE ZEROES  TO WSS-DIAS-MORA-B.
           MOVE ZEROES  TO WSS-DIAS-MORA.
           MOVE 'SGC'   TO TAB-COD-SIST FIO-SIST.
           MOVE 'BAN '  TO TAB-COD-TTAB IN TAB.
           MOVE SPACES  TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-CARGA-TAB-TBAN.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
              TAB-COD-TTAB IN TAB = 'BAN' )
               GO TO FIN-CARGA-TAB-TBAN.

            IF NOT ( TAB-COD-CTAB IN TAB > SPACES AND
               TAB-IND-VIGE IN TAB = 'S' )
                MOVE FIO-GET-NXT TO FIO-CMND
                GO TO LUP-CARGA-TAB-TBAN.

             ADD 1 TO TBAN-IMAX.

             IF TBAN-IMAX > TBAN-OMAX
                 GO TO FIN-CARGA-TAB-TBAN.

              MOVE TAB-COD-CTAB IN TAB TO TBAN-COD-TBAN(TBAN-IMAX).
              MOVE TAB-GLS-DATA IN TAB TO TBAN-GLS-DATA.

              IF TBAN-NUM-DREI NOT NUMERIC
                  MOVE ZEROES TO TBAN-NUM-NDIA(TBAN-IMAX)
              ELSE
                  MOVE TBAN-NUM-DREI TO TBAN-NUM-NDIA(TBAN-IMAX).

           IF TBAN-NUM-NDIA(TBAN-IMAX) > WSS-DIAS-MORA-B
               MOVE TBAN-IMAX                TO TBAN-J
               MOVE TBAN-NUM-NDIA(TBAN-IMAX) TO WSS-DIAS-MORA
               MOVE TBAN-NUM-NDIA(TBAN-IMAX) TO WSS-DIAS-MORA-B.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-CARGA-TAB-TBAN.
       FIN-CARGA-TAB-TBAN.
           EXIT.

       CARGA-TAB-TBAN-N SECTION.
       INI-CARGA-TAB-TBAN-N.
           MOVE 1       TO TBAP-J.
           MOVE 1       TO TBAP-I.
           MOVE ZEROES  TO WSS-DIAS-MORA.
           MOVE ZEROES  TO WSS-DIAS-MORA-BP
           MOVE ZEROES  TO WSS-DIAS-MORA-P.
       LUP-CARGA-TAB-TBAN-N.
           IF TBAP-I > TBAP-IMAX
               GO TO CARGA-TAB-PROD-N.
           IF TBAP-NUM-NDIA(TBAP-I) > WSS-DIAS-MORA
               MOVE TBAP-I                   TO TBAP-J
               MOVE TBAP-NUM-NDIA(TBAP-I) TO WSS-DIAS-MORA-BP
               MOVE TBAP-NUM-NDIA(TBAP-I) TO WSS-DIAS-MORA.

           ADD 1 TO TBAP-I.
           GO TO LUP-CARGA-TAB-TBAN-N.
       CARGA-TAB-PROD-N.
           MOVE 1       TO TPRO-J.
           MOVE 1       TO TPRO-I.
       LUP-CARGA-TAB-PROD-N.
           IF TPRO-I > TPRO-IMAX
               GO TO FIN-CARGA-TAB-TBAN-N.
           IF TPRO-NUM-NDIA(TPRO-I) > WSS-DIAS-MORA-P
               MOVE TPRO-I                   TO TPRO-J
               MOVE TPRO-NUM-NDIA(TPRO-I) TO WSS-DIAS-MORA-P.

           IF TPRO-NUM-NDIA(TPRO-I) > WSS-DIAS-MORA
               MOVE TPRO-NUM-NDIA(TPRO-I) TO WSS-DIAS-MORA.

           ADD 1 TO TPRO-I.
           GO TO LUP-CARGA-TAB-PROD-N.
       FIN-CARGA-TAB-TBAN-N.
           EXIT.

       LLE-FEC-TBAN SECTION.
       INI-LLE-FEC-TBAN.
           MOVE 1 TO TBAN-J.
       LUP-LLE-FEC-TBAN.
           IF TBAN-J > TBAN-IMAX
               GO TO FIN-LLE-FEC-TBAN.
           IF TBAN-NUM-NDIA(TBAN-J) = TBAN-NUM-NDIA(TBAN-I)
               MOVE WSS-NUM-DMIN IN WSS-VARI TO TBAN-NUM-DBAN(TBAN-J)
               MOVE WSS-NUM-MMIN IN WSS-VARI TO TBAN-NUM-MBAN(TBAN-J)
               MOVE WSS-NUM-SMIN IN WSS-VARI TO TBAN-NUM-SBAN(TBAN-J)
               MOVE WSS-NUM-AMIN IN WSS-VARI TO TBAN-NUM-ABAN(TBAN-J).
           ADD 1 TO TBAN-J.
           GO TO LUP-LLE-FEC-TBAN.
       FIN-LLE-FEC-TBAN.
           EXIT.

       LLE-FEC-TPRO SECTION.
       INI-LLE-FEC-TPRO.
           MOVE 1 TO TPRO-J.
       LUP-LLE-FEC-TPRO.
           IF TPRO-J > TPRO-IMAX
               GO TO FIN-LLE-FEC-TPRO.
           IF TPRO-NUM-NDIA(TPRO-J) = TPRO-NUM-NDIA(TPRO-I)
               MOVE WSS-NUM-DMIN IN WSS-VARI TO TPRO-NUM-DPRO(TPRO-J)
               MOVE WSS-NUM-MMIN IN WSS-VARI TO TPRO-NUM-MPRO(TPRO-J)
               MOVE WSS-NUM-SMIN IN WSS-VARI TO TPRO-NUM-SPRO(TPRO-J)
               MOVE WSS-NUM-AMIN IN WSS-VARI TO TPRO-NUM-APRO(TPRO-J).
           ADD 1 TO TPRO-J.
           GO TO LUP-LLE-FEC-TPRO.
       FIN-LLE-FEC-TPRO.
           EXIT.

       LLE-FEC-TBA2 SECTION.
       INI-LLE-FEC-TBA2.
           MOVE 1 TO TBAP-J.
       LUP-LLE-FEC-TBA2.
           IF TBAP-J > TBAP-IMAX
               GO TO FIN-LLE-FEC-TBA2.
           IF TBAP-NUM-NDI2(TBAP-J) = TBAP-NUM-NDI2(TBAP-I)
               MOVE WSS-NUM-DMIN IN WSS-VARI TO TBAP-NUM-DBA2(TBAP-J)
               MOVE WSS-NUM-MMIN IN WSS-VARI TO TBAP-NUM-MBA2(TBAP-J)
               MOVE WSS-NUM-SMIN IN WSS-VARI TO TBAP-NUM-SBA2(TBAP-J)
               MOVE WSS-NUM-AMIN IN WSS-VARI TO TBAP-NUM-ABA2(TBAP-J).
           ADD 1 TO TBAP-J.
           GO TO LUP-LLE-FEC-TBA2.
       FIN-LLE-FEC-TBA2.
           EXIT.

       LLE-FEC-TBA1 SECTION.
       INI-LLE-FEC-TBA1.
           MOVE 1 TO TBAP-J.
       LUP-LLE-FEC-TBA1.
           IF TBAP-J > TBAP-IMAX
               GO TO FIN-LLE-FEC-TBA1.
           IF TBAP-NUM-NDIA(TBAP-J) = TBAP-NUM-NDIA(TBAP-I)
               MOVE WSS-NUM-DMIN IN WSS-VARI TO TBAP-NUM-DBAN(TBAP-J)
               MOVE WSS-NUM-MMIN IN WSS-VARI TO TBAP-NUM-MBAN(TBAP-J)
               MOVE WSS-NUM-SMIN IN WSS-VARI TO TBAP-NUM-SBAN(TBAP-J)
               MOVE WSS-NUM-AMIN IN WSS-VARI TO TBAP-NUM-ABAN(TBAP-J).
           ADD 1 TO TBAP-J.
           GO TO LUP-LLE-FEC-TBA1.
       FIN-LLE-FEC-TBA1.
           EXIT.

       LLE-FEC-TPR2 SECTION.
       INI-LLE-FEC-TPR2.
           MOVE 1 TO TPRO-J.
       LUP-LLE-FEC-TPR2.
           IF TPRO-J > TPRO-IMAX
               GO TO FIN-LLE-FEC-TPR2.
           IF TPRO-NUM-NDI2(TPRO-J) = TPRO-NUM-NDI2(TPRO-I)
               MOVE WSS-NUM-DMIN IN WSS-VARI TO TPRO-NUM-DPR2(TPRO-J)
               MOVE WSS-NUM-MMIN IN WSS-VARI TO TPRO-NUM-MPR2(TPRO-J)
               MOVE WSS-NUM-SMIN IN WSS-VARI TO TPRO-NUM-SPR2(TPRO-J)
               MOVE WSS-NUM-AMIN IN WSS-VARI TO TPRO-NUM-APR2(TPRO-J).
           ADD 1 TO TPRO-J.
           GO TO LUP-LLE-FEC-TPR2.
       FIN-LLE-FEC-TPR2.
           EXIT.

       DET-FEC-TBA2 SECTION.
       INI-DET-FEC-TBA2.
           MOVE 1 TO TBAP-I.
       LUP-DET-FEC-TBA2.
           IF TBAP-I > TBAP-IMAX
               GO TO FIN-DET-FEC-TBA2.

           IF TBAP-FEC-FBA2(TBAP-I) > ZEROES
               ADD 1 TO TBAP-I
               GO TO LUP-DET-FEC-TBA2.

           MOVE TBAP-NUM-NDI2(TBAP-I) TO WSS-DIAS-MORA-BP.
           MOVE ZEROES TO WSS-CNT-DIAS IN WSS-VARI.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI.
       BUS-DIA-HBL-TBA2.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FIN1.
           IF WSS-CNT-DIAS IN WSS-VARI < WSS-DIAS-MORA-BP
              MOVE WSS-FEC-FIN1 IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              ADD   1           TO WSS-CNT-DIAS IN WSS-VARI
              GO TO BUS-DIA-HBL-TBA2.
       RET-DIA-HBL-TBA2.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               MOVE WSS-FEC-FMIN TO FEC-FECH
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-RST-DIA  TO FEC-CMND
               MOVE 1            TO FEC-NDIA
               PERFORM CAL-FEC
               MOVE FEC-FECH TO WSS-FEC-FMIN
              GO TO RET-DIA-HBL-TBA2.
           MOVE FEC-FECH TO WSS-FEC-FMIN IN WSS-VARI.
           MOVE WSS-DIAS-MORA-BP IN WSS-VARI TO TBAP-NUM-NDI2(TBAP-I).
           PERFORM LLE-FEC-TBA2.
           ADD 1 TO TBAP-I.
           GO TO LUP-DET-FEC-TBA2.
       FIN-DET-FEC-TBA2.
           EXIT.

       DET-FEC-TBA1 SECTION.
       INI-DET-FEC-TBA1.
           MOVE 1 TO TBAP-I.
       LUP-DET-FEC-TBA1.
           IF TBAP-I > TBAP-IMAX
               GO TO FIN-DET-FEC-TBA1.

           IF TBAP-FEC-FBAN(TBAP-I) > ZEROES
               ADD 1 TO TBAP-I
               GO TO LUP-DET-FEC-TBA1.

           MOVE TBAP-NUM-NDIA(TBAP-I) TO WSS-DIAS-MORA-BP.
           MOVE ZEROES TO WSS-CNT-DIAS IN WSS-VARI.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI.
       BUS-DIA-HBL-TBA1.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FIN1.
           IF WSS-CNT-DIAS IN WSS-VARI < WSS-DIAS-MORA-BP
              MOVE WSS-FEC-FIN1 IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              ADD   1           TO WSS-CNT-DIAS IN WSS-VARI
              GO TO BUS-DIA-HBL-TBA1.

       RET-DIA-HBL-TBA1.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE WSS-FEC-FMIN TO FEC-FECH
              MOVE FEC-FORM-FEC TO FEC-FORM
              MOVE FEC-RST-DIA  TO FEC-CMND
              MOVE 1            TO FEC-NDIA
              PERFORM CAL-FEC
              MOVE FEC-FECH TO WSS-FEC-FMIN
              GO TO RET-DIA-HBL-TBA1.

           MOVE FEC-FECH TO WSS-FEC-FMIN IN WSS-VARI.
           MOVE WSS-DIAS-MORA-BP IN WSS-VARI TO TBAP-NUM-NDIA(TBAP-I).
           PERFORM LLE-FEC-TBA1.
           ADD 1 TO TBAP-I.
           GO TO LUP-DET-FEC-TBA1.
       FIN-DET-FEC-TBA1.
           EXIT.

       DET-FEC-TPR2 SECTION.
       INI-DET-FEC-TPR2.
           MOVE 1 TO TPRO-I.
       LUP-DET-FEC-TPR2.
           IF TPRO-I > TPRO-IMAX
               GO TO FIN-DET-FEC-TPR2.

           IF TPRO-FEC-FPR2(TPRO-I) > ZEROES
               ADD 1 TO TPRO-I
               GO TO LUP-DET-FEC-TPR2.

           MOVE TPRO-NUM-NDI2(TPRO-I) TO WSS-DIAS-MORA-P.
           MOVE ZEROES TO WSS-CNT-DIAS IN WSS-VARI.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI.
       BUS-DIA-HBL-TPRO.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FIN1.
           IF WSS-CNT-DIAS IN WSS-VARI < WSS-DIAS-MORA-P
              MOVE WSS-FEC-FIN1 IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              ADD   1           TO WSS-CNT-DIAS IN WSS-VARI
              GO TO BUS-DIA-HBL-TPRO.
       RET-DIA-HBL-TPRO.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FIN1.

           MOVE WSS-FEC-FIN1 TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE WSS-FEC-FIN1 IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              GO TO RET-DIA-HBL-TPRO.
           MOVE WSS-DIAS-MORA-P IN WSS-VARI TO TPRO-NUM-NDI2(TPRO-I).
           PERFORM LLE-FEC-TPR2.
           ADD 1 TO TPRO-I.
           GO TO LUP-DET-FEC-TPR2.
       FIN-DET-FEC-TPR2.
           EXIT.

       DET-FEC-TBAN SECTION.
       INI-DET-FEC-TBAN.
           MOVE 1 TO TBAN-I.
       LUP-DET-FEC-TBAN.
           IF TBAN-I > TBAN-IMAX
               GO TO FIN-DET-FEC-TBAN.

           IF TBAN-FEC-FBAN(TBAN-I) > ZEROES
               ADD 1 TO TBAN-I
               GO TO LUP-DET-FEC-TBAN.

           MOVE TBAN-NUM-NDIA(TBAN-I) TO WSS-DIAS-MORA-B.
           MOVE ZEROES TO WSS-CNT-DIAS IN WSS-VARI.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI.
       BUS-DIA-HBL-TBAN.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FIN1.
           IF WSS-CNT-DIAS IN WSS-VARI < WSS-DIAS-MORA-B
              MOVE WSS-FEC-FIN1 IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              ADD   1           TO WSS-CNT-DIAS IN WSS-VARI
              GO TO BUS-DIA-HBL-TBAN.
       RET-DIA-HBL-TBAN.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FIN1.

           MOVE WSS-FEC-FIN1 TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE WSS-FEC-FIN1 IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              GO TO RET-DIA-HBL-TBAN.
           MOVE WSS-DIAS-MORA-B IN WSS-VARI TO TBAN-NUM-NDIA(TBAN-I).
           PERFORM LLE-FEC-TBAN.
           ADD 1 TO TBAN-I.
           GO TO LUP-DET-FEC-TBAN.
       FIN-DET-FEC-TBAN.
           EXIT.

       DET-FEC-TPRO SECTION.
       INI-DET-FEC-TPRO.
           MOVE 1 TO TPRO-I.
       LUP-DET-FEC-TPRO.
           IF TPRO-I > TPRO-IMAX
               GO TO FIN-DET-FEC-TPRO.

           IF TPRO-FEC-FPRO(TPRO-I) > ZEROES
               ADD 1 TO TPRO-I
               GO TO LUP-DET-FEC-TPRO.

           MOVE TPRO-NUM-NDIA(TPRO-I) TO WSS-DIAS-MORA-P.
           MOVE ZEROES TO WSS-CNT-DIAS IN WSS-VARI.
           MOVE WSS-FEC-FPRO IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI.
       BUS-DIA-HBL-TPRO.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FIN1.
           IF WSS-CNT-DIAS IN WSS-VARI < WSS-DIAS-MORA-P
              MOVE WSS-FEC-FIN1 IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              ADD   1           TO WSS-CNT-DIAS IN WSS-VARI
              GO TO BUS-DIA-HBL-TPRO.
       RET-DIA-HBL-TPRO.
           MOVE WSS-FEC-FMIN TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-FEC-FIN1.

           MOVE WSS-FEC-FIN1 TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE WSS-FEC-FIN1 IN WSS-VARI TO WSS-FEC-FMIN IN WSS-VARI
              GO TO RET-DIA-HBL-TPRO.
           MOVE WSS-DIAS-MORA-P IN WSS-VARI TO TPRO-NUM-NDIA(TPRO-I).
           PERFORM LLE-FEC-TPRO.
           ADD 1 TO TPRO-I.
           GO TO LUP-DET-FEC-TPRO.
       FIN-DET-FEC-TPRO.
           EXIT.


       COPY TABBKTXC.
       COPY COLBFIXT.
       COPY COLBFEX1.
       COPY COLBFCXE.
       COPY COLBGCXE.
       COPY COLB1CXE.
      *AFRI-INI/ITE/SOP/01-2013
      *COPY COLBFIMP.
      *AFRI-FIN/ITE/SOP/01-2013
      *AFRI-INI/LOF/CHC/08-2009
       COPY LDCBFLCC.
       COPY LDCBFRLO.
       COPY LDCBFCLF.
       COPY BGLBFGDG.
       COPY BGLBFGES.
       COPY BGLBFGMO.
       COPY BGLBFGVT.
       COPY BGLBFTAG.
       COPY COLBGLOF.
       COPY LDCBFRDC REPLACING RDC BY RDL
                   ==ADR-RDC-REQA== BY ==ADR-RDL-REQA==.
      *AFRI-FIN/LOF/CHC/08-2009
       PUT-TS-OPC SECTION.
       INI-PUT-TS-OPC.
       FIN-PUT-TS-OPC.
           EXIT.
       NO-VAL-MLT SECTION.
       INI-NO-VAL-MLT.
       FIN-NO-VAL-MLT.
           EXIT.

       LEER-RCV SECTION.
       INI-LEER-RCV.
           MOVE SPACES TO RCV.
           MOVE CAN-KEY-ICAN IN CAN TO RCV-KEY-ICAN IN RCV.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RCV.
      ***     IF NOT ( FIO-STAT-OKS AND
      ***              CAN-KEY-ICAN IN CAN = RCV-KEY-ICAN IN RCV )
      ***           DISPLAY 'CAN SIN RCV ' CAN-KEY-ICAN IN CAN.
       FIN-LEER-RCV.
           EXIT.
      *

       OBT-FEC-MOR-PAGP SECTION.
       INI-OBT-FEC-MOR-PAGP.
      *Obtiene Dias de Mora Para Pagos Parciales
           MOVE 'TAB'    TO TAB-COD-SIST FIO-SIST.
           MOVE 'DMO'    TO TAB-COD-TTAB IN TAB.
           MOVE 'PAGPAR' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT = 'S'
               MOVE ZEROES TO WSS-NUM-DMRP IN WSS-VARI
               GO TO FIN-OBT-FEC-MOR-PAGP.

           MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-DAPP IN WSS-VARI.

           IF WSS-NUM-DMRP NOT NUMERIC
               MOVE ZEROES TO WSS-NUM-DMRP IN WSS-VARI
               GO TO FIN-OBT-FEC-MOR-PAGP.

           MOVE WSS-FEC-FPRO TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE WSS-NUM-DMRP TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-DMA-FMPP.

       DIA-HBL-PAGP.
           MOVE WSS-DMA-FMPP TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-FER
               MOVE WSS-DMA-DMPP TO WSS-NUM-DMPP
               MOVE WSS-DMA-MMPP TO WSS-NUM-MMPP
               MOVE WSS-DMA-SMPP TO WSS-NUM-SMPP
               MOVE WSS-DMA-AMPP TO WSS-NUM-AMPP
               GO TO FIN-OBT-FEC-MOR-PAGP.

           MOVE WSS-DMA-FMPP TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-RST-DIA  TO FEC-CMND.
           MOVE 1            TO FEC-NDIA.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO WSS-DMA-FMPP.
           GO TO DIA-HBL-PAGP.
       FIN-OBT-FEC-MOR-PAGP.
           EXIT.

       OBT-HONO  SECTION.
       INI-OBT-HONO.
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
      *    MOVE ZEROES              TO NOR-CONO.
      *    MOVE '*'                 TO NOR-ICTA.
      *    MOVE '*'                 TO NOR-IVIG.
      *    MOVE VEN-FEC-FVEN IN VEN TO NOR-FVEN.
      *    MOVE CAN-FEC-FCAN IN CAN TO NOR-FCAN.
      *    MOVE CAN-CIC-IOPC IN CAN TO NOR-IOPC.
      *    MOVE CAN-SGV-TPAG IN CAN TO NOR-TPAG.
      *    MOVE '0999   '           TO NOR-VCAM.
      *    PERFORM OBT-COM-NOR.
      *    IF NOR-RETO = '0'
      *       IF NOR-CONO NOT = 0
      *          MOVE '00' TO FIO-STAT.
           MOVE ZEROES                  TO GCN-CONO.
           MOVE VEN-FEC-FVEN IN VEN     TO GCN-FVEN.
           MOVE CAN-FEC-FCAN IN CAN     TO GCN-FCAN.
           MOVE CAN-CAI-IOPC IN CAN     TO GCN-CAI-IOPC.
           MOVE CAN-IIC-IOPC IN CAN     TO GCN-IIC-IOPC.
           COMPUTE GCN-TPAG = CAN-SGV-TPAG IN CAN -
                              RCV-SGV-INTM IN RCV.
           MOVE GCN-IND-CPES             TO GCN-VCAM.
           MOVE GCN-ASTE                 TO GCN-IVIG.
           MOVE GCN-ASTE                 TO GCN-ICTA.
           MOVE GCN-N                    TO GCN-IND-ICIE.
           MOVE ZEROES                   TO GCN-CAMB.
           PERFORM COL-LNK-GCN.
           IF GCN-CMSG > SPACES
               MOVE ZEROES   TO NOR-CONO
           ELSE
               MOVE GCN-CONO TO NOR-CONO.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA

           IF NOR-CONO > ZEROES
              ADD  NOR-CONO            TO CAN-SGV-TPAG IN CAN
              MOVE CAN-SGV-TPAG IN CAN TO CAN-SGV-TPAG IN CAN-FLD.

       FIN-OBT-HONO.
           EXIT.

*************************************************************

******* FIN    - rutinas Simulacion de Cancelaciones

*************************************************************


       COPY GNSBVTAB.
       COPY GNSBVCOD.

       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE CSC-NOM-TSCSC     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE CSC-NOM-TSCSC-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 1 TO SCR-NUM-PANT.
           MOVE LOW-VALUES TO WSS-GLS-NCSC-IDX-MTI.
           MOVE LOW-VALUES TO WSS-GLS-NCSC-IDX-FRM.
      *
           MOVE 1 TO FRM-IFLD.
           MOVE ZEROES  TO WSS-NITM IN WSS-VARI.

           MOVE 1 TO WSS-F IN WSS-VARI.
       LUP-PUT-TAB.
           IF WSS-F IN WSS-VARI > WSS-FMAX IN WSS-VARI
              GO TO FIN-PUT-TAB.
           IF WSS-GLS-TCAN-V(WSS-F) > SPACES
              PERFORM PUT-TAB-CSC
              PERFORM PUT-CSC-QUE
              PERFORM SET-FRM-IFLD
           ELSE
           IF FRM-IFLD = 1 AND WSS-F = 1
              MOVE 'TAB' TO MSG-COD-SIST
              MOVE 'CSC    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE '00' TO FIO-STAT
      *       MOVE 'S' TO SCR-IERR
              GO TO FIN-PUT-TAB
           ELSE
              MOVE '00' TO FIO-STAT
              GO TO FIN-PUT-TAB.

           ADD 1 TO WSS-F IN WSS-VARI.
           GO TO LUP-PUT-TAB.
       FIN-PUT-TAB.
           MOVE 1                  TO QUE-NITM.
           MOVE CSC-LEN-TSCSC-MAS  TO QUE-LITM.
           MOVE CSC-NOM-TSCSC-MAS  TO QUE-COLA.

           IF WSS-NITM > WSS-NITMMAX
              MOVE 'S'           TO CSC-MAS-IND-HMAS
           ELSE
              MOVE 'N'           TO CSC-MAS-IND-HMAS.

           MOVE WSS-NITM         TO WSS-NUM-ICUR.
           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.
           MOVE WSS-NUM-ICUR-ALF TO CSC-MAS-NUM-TOCC.
           MOVE CSC-MAS-ITEM     TO QUE-ITEM.
           MOVE QUE-PUT          TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF WSS-NITM > WSS-IMAX
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'CSCTABDMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.

       SET-FRM-IFLD SECTION.
       INI-SET-FRM-IFLD.
           IF SCR-OFRM-SRV
                MOVE 1 TO FRM-IFLD
           ELSE
                ADD 1 TO FRM-IFLD.
       FIN-SET-FRM-IFLD.
           EXIT.
      *--------------------------------------------
       SCRL-TAB-CSC SECTION.
       INI-SCRL-TAB-CSC.
           MOVE SPACES TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-CSC.
           EXIT.

      *--------------------------------------------
       PUT-TAB-CSC SECTION.
       INI-PUT-TAB-CSC.
           PERFORM CLR-WSS.
           MOVE WSS-GLS-TCAN-V IN WSS-VARI(WSS-F) TO
                                   WSS-GLS-TCAN-CSC IN WSS-VARI.
           MOVE WSS-NUM-NCAN-V IN WSS-VARI(WSS-F) TO
                                   WSS-NUM-NCAN-CSC IN WSS-VARI.
           MOVE WSS-FEC-FVEN-V IN WSS-VARI(WSS-F) TO
                                   WSS-FEC-FVEN-CSC IN WSS-VARI.
           MOVE WSS-VAL-CAPI-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-CAPI-CSC IN WSS-VARI.
           MOVE WSS-VAL-INTE-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-INTE-CSC IN WSS-VARI.
           MOVE WSS-VAL-MORA-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-MORA-CSC IN WSS-VARI.
           MOVE WSS-VAL-HONO-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-HONO-CSC IN WSS-VARI.
           MOVE WSS-VAL-IMPT-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-IMPT-CSC IN WSS-VARI.
           MOVE WSS-VAL-GAST-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-GAST-CSC IN WSS-VARI.
           MOVE WSS-VAL-COMI-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-COMI-CSC IN WSS-VARI.
           MOVE WSS-VAL-RENO-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-RENO-CSC IN WSS-VARI.
           MOVE WSS-VAL-DIFE-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-DIFE-CSC IN WSS-VARI.
           MOVE WSS-VAL-SEGU-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-SEGU-CSC IN WSS-VARI.
           MOVE WSS-VAL-TOTA-V IN WSS-VARI(WSS-F) TO
                                   WSS-VAL-TOTA-CSC IN WSS-VARI.

           MOVE WSS-GLS-TCAN-CSC IN WSS-VARI TO WSS-GLS-TCAN-FRM.
           MOVE WSS-NUM-NCAN-CSC IN WSS-VARI TO WSS-NUM-NCAN-FRM.
           MOVE WSS-FEC-FVEN-CSC IN WSS-VARI TO WSS-FEC-FVEN-FRM.
           MOVE WSS-VAL-CAPI-CSC IN WSS-VARI TO WSS-VAL-CAPI-FRM.
           MOVE WSS-VAL-INTE-CSC IN WSS-VARI TO WSS-VAL-INTE-FRM.
           MOVE WSS-VAL-MORA-CSC IN WSS-VARI TO WSS-VAL-MORA-FRM.
           MOVE WSS-VAL-HONO-CSC IN WSS-VARI TO WSS-VAL-HONO-FRM.
           MOVE WSS-VAL-IMPT-CSC IN WSS-VARI TO WSS-VAL-IMPT-FRM.
           MOVE WSS-VAL-GAST-CSC IN WSS-VARI TO WSS-VAL-GAST-FRM.
           MOVE WSS-VAL-COMI-CSC IN WSS-VARI TO WSS-VAL-COMI-FRM.
           MOVE WSS-VAL-RENO-CSC IN WSS-VARI TO WSS-VAL-RENO-FRM.
           MOVE WSS-VAL-DIFE-CSC IN WSS-VARI TO WSS-VAL-DIFE-FRM.
           MOVE WSS-VAL-SEGU-CSC IN WSS-VARI TO WSS-VAL-SEGU-FRM.
           MOVE WSS-VAL-TOTA-CSC IN WSS-VARI TO WSS-VAL-TOTA-FRM.

           IF FRM-IFLD > WSS-IMAX
              GO TO FIN-PUT-TAB-CSC.

           MOVE WSS-GLS-TCAN-CSC IN WSS-VARI TO
               FRM-GLS-TCAN IN CSC-FLD(FRM-IFLD).
           MOVE WSS-NUM-NCAN-CSC IN WSS-VARI TO
               FRM-NUM-NCAN IN CSC-FLD(FRM-IFLD).
           MOVE WSS-FEC-FVEN-CSC IN WSS-VARI TO
               FRM-FEC-FVEN IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-CAPI-CSC IN WSS-VARI TO
               FRM-VAL-CAPI IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-INTE-CSC IN WSS-VARI TO
               FRM-VAL-INTE IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-MORA-CSC IN WSS-VARI TO
               FRM-VAL-MORA IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-HONO-CSC IN WSS-VARI TO
               FRM-VAL-HONO IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-IMPT-CSC IN WSS-VARI TO
               FRM-VAL-IMPT IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-GAST-CSC IN WSS-VARI TO
               FRM-VAL-GAST IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-COMI-CSC IN WSS-VARI TO
               FRM-VAL-COMI IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-RENO-CSC IN WSS-VARI TO
               FRM-VAL-RENO IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-DIFE-CSC IN WSS-VARI TO
               FRM-VAL-DIFE IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-SEGU-CSC IN WSS-VARI TO
               FRM-VAL-SEGU IN CSC-FLD(FRM-IFLD).
           MOVE WSS-VAL-TOTA-CSC IN WSS-VARI TO
               FRM-VAL-TOTA IN CSC-FLD(FRM-IFLD).
       FIN-PUT-TAB-CSC.
           EXIT.
      *----------------------------------------------------
       PUT-CSC-QUE SECTION.
       INI-PUT-CSC-QUE.
           PERFORM PRO-FLD-QUE.
           ADD 1 TO WSS-NITM.
           MOVE CSC-NOM-TSCSC    TO QUE-COLA.
           MOVE CSC-LEN-TSCSC    TO QUE-LITM.
           MOVE WSS-NITM         TO QUE-NITM.
           MOVE SPACES           TO QUE-ITEM.
           IF SCR-OFRM-SRV
              MOVE WSS-GLS-NCSC-IDX-MTI  TO QUE-ITEM
           ELSE
              MOVE WSS-GLS-NCSC-IDX-FRM  TO QUE-ITEM.
           MOVE QUE-PUT  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PUT-CSC-QUE.
           EXIT.
      *----------------------------------------------------

       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1              TO QUE-NITM.
           MOVE CSC-NOM-TSCSC TO QUE-COLA.
           MOVE CSC-LEN-TSCSC TO QUE-LITM.
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MOVE 'CSCTABNONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
           MOVE QUE-ITEM TO FRM-GLS-TCAN-IDX(FRM-IFLD).
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO SCR-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1              TO QUE-NITM
               MOVE CSC-NOM-TSCSC TO QUE-COLA
               MOVE CSC-LEN-TSCSC TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CSCTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.

       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-NUM-PANT = 1
               MOVE 'CSCTABNOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.

           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE CSC-NOM-TSCSC TO QUE-COLA
           MOVE CSC-LEN-TSCSC TO QUE-LITM
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'CSCTABNOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           MOVE QUE-ITEM TO FRM-GLS-TCAN-IDX(FRM-IFLD).
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.

           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.

           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM SCR-NUM-PANT
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CSCTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.

       COPY GNSBGSTR.

       CLR-FRM SECTION.
       INI-CLR-FRM.
           MOVE SPACES TO FRM-GLS-TCAN IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-NCAN IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FVEN IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-CAPI IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-INTE IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-MORA IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-HONO IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-IMPT IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-GAST IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-COMI IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-RENO IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-DIFE IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-SEGU IN CSC-FLD(WSS-I).
           MOVE ZEROES TO FRM-VAL-TOTA IN CSC-FLD(WSS-I).
       FIN-CLR-FRM.
           EXIT.

       CLR-WSS SECTION.
       INI-CLR-WSS.
           MOVE SPACES TO WSS-GLS-TCAN-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-NCAN-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-FEC-FVEN-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-CAPI-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-INTE-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-MORA-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-HONO-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-IMPT-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-GAST-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-COMI-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-RENO-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-DIFE-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-SEGU-CSC IN WSS-VARI.
           MOVE ZEROES TO WSS-VAL-TOTA-CSC IN WSS-VARI.
           IF SCR-OFRM-SRV
               PERFORM CLR-FRM-MTX.
       FIN-CLR-WSS.
           EXIT.

       CLR-FRM-MTX SECTION.
       INI-CLR-FRM-MTX.
           MOVE SPACES TO FRM-GLS-TCAN IN CSC-FLD(1).
           MOVE ZEROES TO FRM-NUM-NCAN IN CSC-FLD(1).
           MOVE ZEROES TO FRM-FEC-FVEN IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-CAPI IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-INTE IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-MORA IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-HONO IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-IMPT IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-GAST IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-COMI IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-RENO IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-DIFE IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-SEGU IN CSC-FLD(1).
           MOVE ZEROES TO FRM-VAL-TOTA IN CSC-FLD(1).
       FIN-CLR-FRM-MTX.
           EXIT.

       CRG-VEC-CSC SECTION.
       INI-CRG-VEC-CSC.
           ADD 1 TO WSS-J.
           IF WSS-J IN WSS-VARI > WSS-JMAX IN WSS-VARI
               GO TO FIN-CRG-VEC-CSC.

           PERFORM CLR-CSC-VEC.

 ***********************************************

 *********   MOVER DESDE LA RESPUESTA DE LA RUTINA AL VECTOR

 ***********************************************
           MOVE CAN-MSC-CANC IN CAN  TO
                            WSS-GLS-TCAN-V IN WSS-VARI(WSS-J).
           MOVE VEN-NUM-IVEN IN VEN  TO
                            WSS-NUM-NCAN-V IN WSS-VARI(WSS-J).
     *** Convierte formato Fecha de Vencimiento de SAMD a DMSA
           MOVE VEN-NUM-DVEN IN VEN  TO WSS-NUM-DPAS IN WSS-VARI.
           MOVE VEN-NUM-MVEN IN VEN  TO WSS-NUM-MPAS IN WSS-VARI.
           MOVE VEN-NUM-SVEN IN VEN  TO WSS-NUM-SPAS IN WSS-VARI.
           MOVE VEN-NUM-AVEN IN VEN  TO WSS-NUM-APAS IN WSS-VARI.
           MOVE WSS-FEC-FPAS IN WSS-VARI TO
                            WSS-FEC-FVEN-V IN WSS-VARI(WSS-J).
           MOVE RCV-SGV-CAPI IN RCV  TO
                            WSS-VAL-CAPI-V IN WSS-VARI(WSS-J).
           MOVE RCV-SGV-INTE IN RCV  TO
                            WSS-VAL-INTE-V IN WSS-VARI(WSS-J).
           MOVE RCV-SGV-INTM IN RCV  TO
                            WSS-VAL-MORA-V IN WSS-VARI(WSS-J).
           MOVE NOR-CONO             TO
                            WSS-VAL-HONO-V IN WSS-VARI(WSS-J).
           MOVE ZEROES               TO
                            WSS-VAL-IMPT-V IN WSS-VARI(WSS-J).
           MOVE WSS-SGV-HCJU IN JUD-VARI TO
                            WSS-VAL-GAST-V IN WSS-VARI(WSS-J).
           MOVE CAN-SGV-COMI IN CAN  TO
                            WSS-VAL-COMI-V IN WSS-VARI(WSS-J).
           MOVE ZEROES               TO
                            WSS-VAL-RENO-V IN WSS-VARI(WSS-J).
           MOVE ZEROES               TO
                            WSS-VAL-DIFE-V IN WSS-VARI(WSS-J).
           MOVE ZEROES               TO
                            WSS-VAL-SEGU-V IN WSS-VARI(WSS-J).
           MOVE CAN-SGV-TPAG IN CAN  TO
                            WSS-VAL-TOTA-V IN WSS-VARI(WSS-J).
           ADD  CAN-SGV-TPAG IN CAN  TO WSS-VAL-SUM-TPAG IN WSS-VARI.
       FIN-CRG-VEC-CSC.
           EXIT.

       CLR-CSC-VEC SECTION.
       INI-CLR-CSC-VEC.
           MOVE SPACES TO WSS-GLS-TCAN-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-NUM-NCAN-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-FEC-FVEN-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-CAPI-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-INTE-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-MORA-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-HONO-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-IMPT-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-GAST-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-COMI-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-RENO-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-DIFE-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-SEGU-V IN WSS-VARI(WSS-J).
           MOVE ZEROES TO WSS-VAL-TOTA-V IN WSS-VARI(WSS-J).
       FIN-CLR-CSC-VEC.
           EXIT.

       PRO-FLD-QUE SECTION.
       INI-PRO-FLD-QUE.
           MOVE 'P' TO WSS-GLS-TCAN-ATR.
           MOVE 'P' TO WSS-NUM-NCAN-ATR.
           MOVE 'P' TO WSS-FEC-FVEN-ATR.
           MOVE 'P' TO WSS-VAL-CAPI-ATR.
           MOVE 'P' TO WSS-VAL-INTE-ATR.
           MOVE 'P' TO WSS-VAL-MORA-ATR.
           MOVE 'P' TO WSS-VAL-HONO-ATR.
           MOVE 'P' TO WSS-VAL-IMPT-ATR.
           MOVE 'P' TO WSS-VAL-GAST-ATR.
           MOVE 'P' TO WSS-VAL-COMI-ATR.
           MOVE 'P' TO WSS-VAL-RENO-ATR.
           MOVE 'P' TO WSS-VAL-DIFE-ATR.
           MOVE 'P' TO WSS-VAL-SEGU-ATR.
           MOVE 'P' TO WSS-VAL-TOTA-ATR.
       FIN-PRO-FLD-QUE.
           EXIT.
      *AFRI-INI 26-ENE-2018 COMISION NORMALIZA
       COPY COLBKGCN.
       COPY COLBKHNJ.
      *AFRI-FIN 26-ENE-2018 COMISION NORMALIZA
      *>>>> EOF
*% END
