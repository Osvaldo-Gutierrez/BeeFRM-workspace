*%! Codigo adicional para archivo
*% PGM_PTC = TRUE
*% LARGO_TOTAL_COMMAREA = 400
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 SCR-CIC-ICLI.
              05  SCR-CAI-ICLI                         PIC X(04).
              05  SCR-IIC-ICLI                         PIC X(08).
           03  SCR-VARI-PFS.
               05  SCR-KEY-ICEC-ACTU.
                   07  SCR-COD-ENTI                    PIC X(03).
                   07  SCR-GLS-IENT.
                       09  SCR-CIC-IENT                PIC X(12).
                       09  SCR-FEC-FENT                PIC 9(08).
                       09  SCR-COD-RENT                PIC X(06).
                       09  SCR-NUM-IENT                PIC 9(03).
                       09  SCR-COD-CCSE                PIC X(03).
                       09  SCR-CIC-ISEN                PIC X(12).
                       09  SCR-NUM-ISEN                PIC 9(03).
           03  SCR-NUM-ICEC                            PIC 9(03).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01 WSS-VARI.
          03 WSS-FEC-FINI.
             05 WSS-NUM-SINI                           PIC 9(02).
             05 WSS-NUM-AINI                           PIC 9(02).
             05 WSS-NUM-MINI                           PIC 9(02).
             05 WSS-NUM-DINI                           PIC 9(02).

       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY COLBRCEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CEN-REQA==.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
              PERFORM VAL-NUM-KEY-CEC
              PERFORM VAL-NUM-FLD-CEC
              PERFORM SCRL-COL-CEC
              PERFORM SCR-TRL.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE CEC-NUM-IENT IN CEC-FLD TO SCR-NUM-ICEC.
           IF SCR-CCPP = 'ING'
               PERFORM BUS-COR-CEC
               GO TO CON-FND-KEY.

           IF CEC-NUM-IENT IN CEC NOT > ZEROES
               PERFORM BUS-COR-CEC.
       CON-FND-KEY.
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           IF PGM-STAT-CEC-OKS
               MOVE CEC-KEY-ICEC IN CEC TO SCR-KEY-ICEC-ACTU.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 )
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY SGCBFDBC.
       COPY GNSBGCPT.
*% IF PGM_PU
      *<<<< EOF_PQ
*% END
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
      *<<<< EOF_PQ
       BUS-COR-CEC SECTION.
       INI-BUS-COR-CEC.
           MOVE 'CAE'  TO CEC-COD-ENTI IN CEC.
           MOVE ZEROES TO CEC-FEC-FENT IN CEC.
           MOVE SPACES TO CEC-COD-RENT IN CEC.
           MOVE 999 TO CEC-NUM-IENT    IN CEC.
           MOVE FIO-GET-LEQ TO FIO-CMND
           PERFORM COL-FIO-CEC.
           MOVE FIO-STAT TO PGM-STAT-CEC.
           IF NOT (FIO-STAT-OKS AND
              CEC-COD-ENTI IN CEC = 'CAE' AND
              CEC-CAI-IENT IN CEC = SCR-CAI-ICLI AND
              CEC-IIC-IENT IN CEC = SCR-IIC-ICLI AND
              CEC-FEC-FENT IN CEC = ZEROES AND
              CEC-COD-RENT IN CEC = SPACES)
              PERFORM KEY-ALL-CEC
              MOVE ZEROES TO CEC-NUM-IENT IN CEC
           ELSE
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM COL-FIO-CEC.

           IF SCR-CCPP = 'ING'
              ADD 1 TO CEC-NUM-IENT IN CEC
              MOVE CEC-NUM-IENT IN CEC TO CEC-NUM-IENT IN CEC-FLD.
       FIN-BUS-COR-CEC.
           EXIT.

       SCRL-COL-CEC SECTION.
       INI-SCRL-COL-CEC.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF5
              PERFORM SCRL-COL-CEC-PF7
              GO TO FIN-SCRL-COL-CEC.
           IF FRM-FFLD = FRM-FFLD-PF8  OR FRM-FFLD-PF6
              PERFORM SCRL-COL-CEC-PF8
              GO TO FIN-SCRL-COL-CEC.
       FIN-SCRL-COL-CEC.
           EXIT.

       SCRL-COL-CEC-PF7 SECTION.
       INI-SCRL-COL-CEC-PF7.
           MOVE SCR-KEY-ICEC-ACTU TO CEC-KEY-ICEC IN CEC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-CEC.
           IF NOT ( FIO-STAT-OKS AND
                    CEC-KEY-ICEC IN CEC = SCR-KEY-ICEC-ACTU)
              MOVE 'COLCURRNEX' TO MSG-COD-MENS
              GO TO MSG-SCRL-COL-CEC-PF7.
       PRV-SCRL-COL-CEC-PF8.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM COL-FIO-CEC.
           IF NOT ( FIO-STAT-OKS AND
                    CEC-COD-ENTI IN CEC = 'CAE' AND
                    CEC-CAI-IENT IN CEC = SCR-CAI-ICLI AND
                    CEC-IIC-IENT IN CEC = SCR-IIC-ICLI AND
                    CEC-FEC-FENT IN CEC = ZEROES AND
                    CEC-COD-RENT IN CEC = SPACES AND
                    CEC-COD-CCSE IN CEC = SPACES AND
                    CEC-CIC-ISEN IN CEC = SPACES AND
                    CEC-NUM-ISEN IN CEC = ZEROES )
              MOVE 'COL    NOCEC' TO MSG-COD-MENS
              GO TO MSG-SCRL-COL-CEC-PF7.
              MOVE FIO-STAT TO PGM-STAT-CEC.
              PERFORM SCR-CLRA-CEC.
              PERFORM PUT-SCR.
              GO TO FIN-SCRL-COL-CEC-PF7.
       MSG-SCRL-COL-CEC-PF7.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-COL-CEC-PF7.
           EXIT.

       SCRL-COL-CEC-PF8 SECTION.
       INI-SCRL-COL-CEC-PF8.
           MOVE SCR-KEY-ICEC-ACTU TO CEC-KEY-ICEC IN CEC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CEC.
           IF NOT ( FIO-STAT-OKS AND
                    CEC-KEY-ICEC IN CEC = SCR-KEY-ICEC-ACTU)
              MOVE 'COLCURRNEX' TO MSG-COD-MENS
              GO TO MSG-SCRL-COL-CEC-PF8.
              MOVE FIO-GET-NXT TO FIO-CMND.
              PERFORM COL-FIO-CEC.
              IF NOT ( FIO-STAT-OKS AND
                   CEC-COD-ENTI IN CEC = 'CAE' AND
                   CEC-CAI-IENT IN CEC = SCR-CAI-ICLI AND
                   CEC-IIC-IENT IN CEC = SCR-IIC-ICLI AND
                   CEC-FEC-FENT IN CEC = ZEROES AND
                   CEC-COD-RENT IN CEC = SPACES AND
                   CEC-COD-CCSE IN CEC = SPACES AND
                   CEC-CIC-ISEN IN CEC = SPACES AND
                   CEC-NUM-ISEN IN CEC = ZEROES )
              MOVE 'COL    NONXT' TO MSG-COD-MENS
              GO TO MSG-SCRL-COL-CEC-PF8.
              MOVE FIO-STAT TO PGM-STAT-CEC.
              PERFORM SCR-CLRA-CEC.
              PERFORM PUT-SCR.
              GO TO FIN-SCRL-COL-CEC-PF8.
       MSG-SCRL-COL-CEC-PF8.
           MOVE 'COL' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-COL-CEC-PF8.
           EXIT.
      *>>>>
*% END
