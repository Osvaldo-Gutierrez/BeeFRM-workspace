       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. COLPMA03.
       AUTHOR. BEETEAM.
       DATE-WRITTEN. 14-01-2019 11:05:08.
      *
      * PROGRAMA ORQUESTADOR MICROSERVICIO PRORROGA
      *
      *
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.

       WORKING-STORAGE SECTION.
      *------------------------
       77 WSS-TAG-COLPMA03           PIC X(0125) VALUE
           '<IDNPGM NOM=$COLPMA03$ VSN=$01-00$ GEN=$12-03-2019$
      -    'TMS=$E24$ FNC=$1901_03$/>'.
      *
       COPY GNSWGMCS.

       77  WSS-EDT-0602                      PIC       999999,99.
       77  WSS-EDT-0304                      PIC       ----,9999.
       77  WSS-EDT-1204                      PIC 999999999999,9999.

       01  TZ-256-01-RCV-SGV-CAPI-01.
               05  TZ-256-01-RCV-SGV-CAPI                  PIC X(00020).
               05  TZ-256-01-RCV-SGV-CAPI-R REDEFINES
                   TZ-256-01-RCV-SGV-CAPI.
                   07  TZ-256-01-RCV-SGV-CAPI-CPL          PIC X(00005).
                   07  TZ-256-01-RCV-SGV-CAPI-NUM
                                  PIC  9(11)V9(04).

       01  TZ-256-01-CAN-SGV-TPAG-01.
               05  TZ-256-01-CAN-SGV-TPAG                  PIC X(00020).
               05  TZ-256-01-CAN-SGV-TPAG-R REDEFINES
                   TZ-256-01-CAN-SGV-TPAG.
                   07  TZ-256-01-CAN-SGV-TPAG-CPL          PIC X(00005).
                   07  TZ-256-01-CAN-SGV-TPAG-NUM
                                  PIC S9(11)V9(04).

       77  WSS-CTE-CMA-TPG     VALUE +6   COMP           PIC S9(4).
      * Largo Entidad TR
       77  WSS-CTE-LENTR-1025  COMP   VALUE +1025        PIC S9(04).
       77  WSS-CTE-LENTR-20    COMP   VALUE +20          PIC S9(04).

       01  TS-TPAG.
           03 TS-TPAG-TYPE            VALUE 'TPAG'       PIC X(04).
           03 TS-TPAG-TERM            VALUE SPACES       PIC X(04).

      * Simulacion SI
       77  WSS-CTE-SIMU-S      VALUE 'S'                 PIC X(01).

      * Simulacion NO ( Ativacion )
       77  WSS-CTE-SIMU-A      VALUE 'A'                 PIC X(01).

       77  WSS-CTE-01-ALF      VALUE '1'                 PIC X(01).

      * Constante Prorroga
       77  WSS-CTE-PTT              VALUE 'PTT'          PIC X(03).

      * Constante CIE
       77  WSS-CTE-CIE              VALUE 'CIE'          PIC X(03).

       77  WSS-CTE-P                VALUE 'P'            PIC X(01).

      * Constante porcentaje
       77  WSS-CTE-PORC             VALUE '%'            PIC X(01).

      * Constante para  canal
       77  WSS-CTE-110     VALUE '110'                   PIC X(03).
       77  WSS-CTE-010     VALUE '010'                   PIC X(03).
      *
       77  WSS-CTE-1       VALUE 1                       PIC 9(02).


       77  WSS-CTE-AUT     VALUE 'AUT'                   PIC X(03).

       77  WSS-CTE-S       VALUE 'S'                     PIC X(01).

       77  WSS-CTE-N       VALUE 'N'                     PIC X(01).

      * Constantes para comprimir codigo de producto
       77  WSS-CTE-VCAM-0999        VALUE '0999  '       PIC X(06).
       77  WSS-CTE-VCAM-0999-01     VALUE '01'           PIC X(02).
       77  WSS-CTE-VCAM-0998        VALUE '0998  '       PIC X(06).
       77  WSS-CTE-VCAM-0998-02     VALUE '02'           PIC X(02).

      * Tradcutor COLPPTPG
       77  WSS-CTE-COLPPTPG   VALUE 'COLPPTPG'           PIC X(08).

      * Rangos horario funcionamento
       77  WSS-CTE-HORA-2000  VALUE 'A03HORA2000 '       PIC X(12).
       77  WSS-CTE-HORA-0800  VALUE 'A03HORA0800 '       PIC X(12).

      * Tabla PPM PARAMETROS PRODUCTO MICROSERVICIO
       01  WSS-CTE-PPM            VALUE 'PPM'            PIC X(03).
       77  WSS-CTE-IMCS-A03       VALUE 'A03'            PIC X(03).
      * Parametros de default
       77  WSS-CTE-PPM-1          VALUE '1'              PIC X(01).
      * Vigencia del producto para el microservicio
       77  WSS-CTE-PPM-2          VALUE '2'              PIC X(01).
       77  WSS-CTE-PPM-3          VALUE '3'              PIC X(01).

      * Tipo Calculo vencimiento
       77  WSS-CTE-TCVE-FO      VALUE 'FO'               PIC X(02).
       77  WSS-CTE-TCVE-CO      VALUE 'CO'               PIC X(02).
       77  WSS-CTE-TCVE-FO-O-CO VALUE 'FO'               PIC X(02).

       77  WSS-CTE-001        VALUE 1                    PIC 9(05).

       77  WSS-CTE-CTS        VALUE 'CTS'                PIC X(03).


       01  WSS-ROC-BKP              VALUE SPACES         PIC X(1030).
       01  WSS-12-04-08 VALUE SPACES.
           03 WSS-12-04-08-04                            PIC X(04).
           03 WSS-12-04-08-08                            PIC X(08).

       01  WSS-HDR-032.
           03  WSS-HDR-032-001-097  VALUE SPACES         PIC X(97).
           03  WSS-HDR-032-098-098  VALUE 'N'            PIC X(01).
           03  WSS-HDR-032-099-100  VALUE SPACES         PIC X(02).

       01  WSS-HDR-033.
           03  WSS-HDR-033-001-090                       PIC X(90).
           03  WSS-HDR-033-091-093                       PIC X(03).
           03  WSS-HDR-033-094-100                       PIC X(07).

       01  WSS-HDR-038.
           03  WSS-HDR-038-001-094                       PIC X(94).
           03  WSS-HDR-038-095-095                       PIC X(01).
           03  WSS-HDR-038-096-100                       PIC X(05).

       01  WSS-HDR-100.
           03 WSS-HDR-100-001-092                        PIC X(92).
           03 WSS-HDR-100-093-093                        PIC X(01).
           03 WSS-HDR-100-094-100                        PIC X(07).

       01  WSS-HDR-TIPC.
           03 WSS-HDR-TIPC-01                            PIC X(02).
           03 WSS-HDR-TIPC-02                            PIC X(03).



       77  WSS-SGV-TPAG        VALUE ZEROES        PIC 9(11)V9(04).
       77  WSS-IND-GOCON       VALUE 'S'                 PIC X(01).

       77  WSS-LOGPMA03        VALUE 'N'                 PIC X(01).
       77  WSS-LOGPMA03MVEN    VALUE 'N'                 PIC X(01).
       77  WSS-NUM-TOT-PER     VALUE ZEROS               PIC 9(05).
       77  WSS-TOT-DIA         VALUE ZEROS               PIC 9(05).

       77  WSS-NUM-RAUX VALUE ZEROES                     PIC 9(08).

       01  WSS-GLS-DATA-RAUX.
           03 WSS-GLS-DATA-RAUX-NUM                      PIC 9(08).
           03 WSS-GLS-DATA-RAUX-ALF                      PIC X(52).

       77  WSS-IDX-TR   VALUE  ZEROES                    PIC 9(03).
       77  TPG-M        VALUE  ZEROES                    PIC 9(03).
       77  TPG-L        VALUE  ZEROES                    PIC 9(03).

       01  WSS-SGS-INP-TBL.
           03 WSS-SGS-INP-OCC       OCCURS 30 TIMES.
              05 WSS-SGS-INP-ELM                         PIC X(03).

       77  WSS-SGS-INP-ENC    VALUE 'N'                  PIC X(01).


       77  WSS-COD-TCYA-CTBL  VALUE 'CTBL '              PIC X(05).
       77  WSS-COD-TCYA-CCMA  VALUE 'CCMA '              PIC X(05).
       77  WSS-COD-TCYA-CAJA  VALUE 'CAJA '              PIC X(05).

       01  WSS-COD-PROD VALUE SPACES.
           03  WSS-COD-PROD-VCOC                         PIC X(06).
           03  WSS-COD-PROD-TOOC                         PIC X(03).
           03  WSS-COD-PROD-AOOC                         PIC X(03).

       77  WSS-NUM-HORA-2000  VALUE ZEROES               PIC 9(12).
       77  WSS-NUM-HORA-0800  VALUE ZEROES               PIC 9(12).

      * Atributos y valores default de producto para microservicio
      * PPM = "P"aramretros default de "P"roducto "M"icroservicio
       01  WSS-GLS-PPM.
           03  WSS-IND-SEGD       VALUE 'PRECIO'         PIC X(06).
           03  WSS-IND-CVTA       VALUE SPACES           PIC X(01).
           03  WSS-IND-GARA       VALUE SPACES           PIC X(03).
           03  WSS-IND-CDOC       VALUE SPACES           PIC X(03).

       01  WSS-COD-CTAB-PPM.
           03 WSS-COD-CTAB-PPM-0103-MCS                  PIC X(03).
           03 WSS-COD-CTAB-PPM-0405-MON                  PIC X(02).
           03 WSS-COD-CTAB-PPM-0608-TIO                  PIC X(03).
           03 WSS-COD-CTAB-PPM-0911-AUX                  PIC X(03).
           03 WSS-COD-CTAB-PPM-1212-COR                  PIC X(01).

      * Seguros heredados de OPC
       77  WSS-IND-SGRS-H     VALUE 'H'                  PIC X(01).

      * Tasa Informada
       77  WSS-FRM-IND-TINT-I VALUE 'I'                  PIC X(01).
      * Tasa propuesta por ROC(RCC)
       77  WSS-FRM-IND-TINT-P VALUE 'P'                  PIC X(01).
      * Tasa heredada
       77  WSS-FRM-IND-TINT-H VALUE 'H'                  PIC X(01).


      * Oblig(Informada INP /Asignada 1RA OPE )
       77  WSS-IND-TCYA-OBLI VALUE 'O'                   PIC X(01).
      * Contable[Simulacion]
       77  WSS-IND-TCYA-CTBL VALUE 'C'                   PIC X(01).


       77  WSS-SGS-INP-TOT    VALUE ZEROES               PIC 9(03).
       77  WSS-SGS-INP-IDX-01 VALUE ZEROES               PIC 9(03).
       77  WSS-SGS-INP-IDX-02 VALUE ZEROES               PIC 9(03).

       77 WSS-SGS-PPT-ARG     VALUE SPACES               PIC X(03).

       01  WSS-SGS-PPT-TBL.
           03 WSS-SGS-PPT-OCC       OCCURS 30 TIMES.
              05 WSS-SGS-PPT-ELM                         PIC X(03).

       77  WSS-SGS-PPT-ENC    VALUE 'N'                  PIC X(01).

       77  WSS-IDX-SGS-PPT    VALUE ZEROES               PIC 9(03).


       77  WSS-IDX-SGS        VALUE ZEROES               PIC 9(03).

       77  WSS-TOT-SGS-PPT    VALUE ZEROES               PIC 9(03).

       77  WSS-NUM-VIGU-ADIC      VALUE ZEROES               PIC 9(03).


      * Mensajeria Error local - INI

       01  WSS-ERR-SEND.
           03  WSS-ERR-SEND-PEND  VALUE '1'              PIC X(00001).
           03  WSS-ERR-SEND-STAT  VALUE '1'              PIC X(00001).
           03  WSS-ERR-SEND-MENS  VALUE SPACES           PIC X(01023).

       01  WSS-ERR-IND-TCYA.
           03  WSS-ERR-IND-TCYA-00
               VALUE 'CNCNA03COL000000000001'                PIC X(22).
           03  WSS-ERR-IND-TCYA-01                           PIC X(05).
           03  WSS-ERR-IND-TCYA-02                           PIC X(52)
               VALUE ' : Error en indicador de abono'.

       01  WSS-ERR-PRO-GNOP.
           03  WSS-ERR-PRO-GNOP-00
               VALUE 'CNCNA03COL000000000002'                PIC X(22).
           03  WSS-ERR-PRO-GNOP-01 VALUE ' : Error GNP : '   PIC X(15).
           03  WSS-ERR-PRO-GNOP-02                           PIC X(12).
           03  WSS-ERR-PRO-GNOP-03                           PIC X(30).

       01  WSS-ERR-PRO-SEGU.
           03  WSS-ERR-PRO-SEGU-00
               VALUE 'CNCNA03COL000000000003'                PIC X(22).
           03  WSS-ERR-PRO-SEGU-01 VALUE 'Seguro Inp : '     PIC X(13).
           03  WSS-ERR-PRO-SEGU-02 VALUE SPACES              PIC X(03).
           03  WSS-ERR-PRO-SEGU-03 VALUE ' No Propuesto'     PIC X(41).

       01  WSS-ERR-IND-TASA.
           03  WSS-ERR-IND-TASA-00
               VALUE 'CNCNA03COL000000000004'                PIC X(22).
           03  WSS-ERR-IND-TASA-01 VALUE 'Ind Tasa(I/P) '    PIC X(14).
           03  WSS-ERR-IND-TASA-02 VALUE SPACES              PIC X(01).
           03  WSS-ERR-IND-TASA-03 VALUE ' Erroneo'          PIC X(33).

       01      WSS-ERR-VAL-CRED.
           03  WSS-ERR-VAL-CRED-00
               VALUE 'CNCNA03COL000000000005'                PIC X(22).
           03  WSS-ERR-VAL-CRED-01 VALUE 'Monto Cred: '      PIC X(12).
           03  WSS-ERR-VAL-CRED-02                           PIC X(45).

       01      WSS-ERR-SGV-TINT.
           03  WSS-ERR-SGV-TINT-00
               VALUE 'CNCNA03COL000000000006'                PIC X(22).
           03  WSS-ERR-SGV-TINT-01 VALUE 'Tasa Inter : '     PIC X(13).
           03  WSS-ERR-SGV-TINT-02                           PIC X(44).

       01      WSS-ERR-NUM-VIGU.
           03  WSS-ERR-NUM-VIGU-00
               VALUE 'CNCNA03COL000000000007'                PIC X(22).
           03  WSS-ERR-NUM-VIGU-01 VALUE 'Tot Ven Vig : '    PIC X(14).
           03  WSS-ERR-NUM-VIGU-02                           PIC X(43).

       01      WSS-ERR-NUM-SPVE.
           03  WSS-ERR-NUM-SPVE-00
               VALUE 'CNCNA03COL000000000008'                PIC X(22).
           03  WSS-ERR-NUM-SPVE-01 VALUE 'Per 1er Ven : '    PIC X(16).
           03  WSS-ERR-NUM-SPVE-02                           PIC X(41).

       01      WSS-ERR-NUM-SEVE.
           03  WSS-ERR-NUM-SEVE-00
               VALUE 'CNCNA03COL000000000009'                PIC X(22).
           03  WSS-ERR-NUM-SEVE-01 VALUE 'Sep ent Ven : '    PIC X(14).
           03  WSS-ERR-NUM-SEVE-02                           PIC X(43).

       01      WSS-ERR-NUM-PLZT.
           03  WSS-ERR-NUM-PLZT-00
               VALUE 'CNCNA03COL000000000010'                PIC X(22).
           03  WSS-ERR-NUM-PLZT-01 VALUE 'Pzo Tot Ven : '    PIC X(14).
           03  WSS-ERR-NUM-PLZT-02                           PIC X(43).

       01  WSS-ERR-NUM-CMAX.
           03  WSS-ERR-NUM-CMAX-00
               VALUE 'CNCNA03COL000000000011'                PIC X(22).
           03  WSS-ERR-NUM-CMAX-01 VALUE 'M Curse : '        PIC X(10).
           03  WSS-ERR-NUM-CMAX-02         PIC           Z.ZZZ.ZZZ.ZZ9.
           03  WSS-ERR-NUM-CMAX-03 VALUE ' > Perm : '        PIC X(10).
           03  WSS-ERR-NUM-CMAX-04         PIC           Z.ZZZ.ZZZ.ZZ9.
           03  WSS-ERR-NUM-CMAX-05 VALUE ' <Poc>'            PIC X(11).

      * Diferencia de fechas con error
       01  WSS-ERR-FEC-DIFE.
           03  WSS-ERR-FEC-DIFE-00
               VALUE 'CNCNA03COL000000000012'                PIC X(22).
           03  WSS-ERR-FEC-DIFE-01 VALUE 'Dif Fec Err : '    PIC X(14).
           03  WSS-ERR-FEC-DIFE-02 VALUE SPACES              PIC X(08).
           03  WSS-ERR-FEC-DIFE-03 VALUE ' <> '              PIC X(04).
           03  WSS-ERR-FEC-DIFE-04 VALUE SPACES              PIC X(08).
           03  WSS-ERR-FEC-DIFE-05 VALUE SPACES              PIC X(01).
           03  WSS-ERR-FEC-DIFE-06 VALUE SPACES              PIC X(34).

      * Este producto no permite prorroga
       01  WSS-ERR-INV-PROR.
           03  WSS-ERR-INV-PROR-00
               VALUE 'CNCNA03COL000000000013'                PIC X(22).
           03  WSS-ERR-INV-PROR-01 VALUE
               ' Prorroga invalida para Producto de operacion'
                                                             PIC X(48).
      * Este servicio no permite operar en este horario
       01  WSS-ERR-INV-HORA.
           03  WSS-ERR-INV-HORA-00
               VALUE 'CNCNA03COL000000000014'                PIC X(22).
           03  WSS-ERR-INV-HORA-01 VALUE
               ' Especificacion horario inexistente o no vigente'
                                                             PIC X(48).
      * Indicador Invalido de Simulacion
       01  WSS-ERR-INV-SIMU.
           03  WSS-ERR-INV-SIMU-00
               VALUE 'CNCNA03COL000000000015'                PIC X(22).
           03  WSS-ERR-INV-SIMU-01 VALUE '<'                 PIC X(01).
           03  WSS-ERR-INV-SIMU-02 VALUE SPACES              PIC X(01).
           03  WSS-ERR-INV-SIMU-03 VALUE
               '> Indicador de simulacion Invalido      '
                                                             PIC X(40).
      * Fecha de Vencimiento menor a permitido para este servicio
       01  WSS-MAX-FVEN       VALUE 10                       PIC 9(06).
       01  WSS-NUM-05         VALUE ZEROES                   PIC 9(05).
       01  WSS-NUM-06         VALUE ZEROES                   PIC 9(06).
       01  WSS-ERR-INV-FVEN.
           03  WSS-ERR-INV-FVEN-00
               VALUE 'CNCNA03COL000000000016'                PIC X(22).
           03  WSS-ERR-INV-FVEN-01 VALUE ' Fven : '          PIC X(08).
           03  WSS-ERR-INV-FVEN-02.
                 05 WSS-NUM-DVEN                             PIC X(02).
                 05 FILLER   VALUE '-'                       PIC X(01).
                 05 WSS-NUM-MVEN                             PIC X(02).
                 05 FILLER   VALUE '-'                       PIC X(01).
                 05 WSS-NUM-SVEN                             PIC X(02).
                 05 WSS-NUM-AVEN                             PIC X(02).
           03  WSS-ERR-INV-FVEN-03 VALUE ' ( '               PIC X(03).
           03  WSS-ERR-INV-FVEN-04 VALUE SPACES              PIC X(06).
           03  WSS-ERR-INV-FVEN-05 VALUE ' ) '               PIC X(03).
           03  WSS-ERR-INV-FVEN-06 VALUE ' < '               PIC X(03).
           03  WSS-ERR-INV-FVEN-07 VALUE SPACES              PIC X(06).
           03  WSS-ERR-INV-FVEN-08 VALUE
               '  Dias '
                                                             PIC X(10).
      * No acepta prorrogar morosos
       01  WSS-ERR-INV-MORO.
           03  WSS-ERR-INV-MORO-00
               VALUE 'CNCNA03COL000000000017'                PIC X(22).
           03  WSS-ERR-INV-MORO-01 VALUE ' '                 PIC X(01).
           03  WSS-ERR-INV-MORO-02 VALUE SPACES              PIC X(01).
           03  WSS-ERR-INV-MORO-03 VALUE
               'No se permite prorrogar morosos'
                                                             PIC X(32).

      * Mensajeria Error local - FIN

       77  WSS-TOT-RESP           VALUE ZEROES               PIC 9(05).

       77  WSS-POC-VAL-CMAX        COMP-3          PIC 9(11)V9(04).

       01  WSS-QUE-INP-COLA VALUE SPACES.
           03 WSS-QUE-INP-COLA-02                        PIC X(02).
           03 WSS-QUE-INP-COLA-06                        PIC X(06).
       01  WSS-QUE-TR-COLA VALUE SPACES.
           03 WSS-QUE-TR-COLA-02                         PIC X(02).
           03 WSS-QUE-TR-COLA-06                         PIC X(06).

       01  WSS-QUE-TR-COLA-032 VALUE SPACES.
           03 WSS-QUE-TR-COLA-032-02                     PIC X(02).
           03 WSS-QUE-TR-COLA-032-06                     PIC X(06).

       77  WSS-ITEM-SEGM      VALUE ZEROES            PIC 9(03).

       01  WSS-PT.
           03  WSS-PT-AHDR                                 PIC X(00100).
           03  WSS-PT-CREQ                                 PIC X(00003).
           03  WSS-PT-DMSG.
               05  WSS-PT-IMCS                             PIC X(00003).

       01  WSS-GLS-DATA.
      * Indicador del Segmento
           03  WSS-GLS-DATA-COD-SGMT                       PIC X(00001).
      * Indicador si programa invocado PY garba TS o lo hace COLPMA03
           03  WSS-GLS-DATA-IND-TSPT                      PIC X(00001).

       01  WSS-TR.
           03  WSS-TR-COD-SGMT                             PIC X(00001).
           03  WSS-TR-COD-DATA                             PIC X(01024).

       COPY GNSWGSEG.
       COPY GNSWGHOY.
       COPY GNSWGTSK.
       COPY GNSWGPFG.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGSYS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGQUE.
       COPY GNSWGFRM.
       COPY GNSWVSCR.
       COPY GNSWGMX1.
       COPY GNSWGRQA.
       COPY GNSBRTAB.
       COPY GNSWVIDD.
       COPY GNSBRMSG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGELS.
       COPY GNSWGUIB.

       COPY GNSWGAMB.
       COPY GNSWGCVT.
       COPY GNSWCSXI.
       COPY GNSWGMXX.
       COPY GNSWGFEC.

       COPY COLMWA03.

      * OPC,CON
       COPY COLMW729.

      * CAN,SCA
       COPY COLMW256.

      * CAN,ING
       COPY COLMW038.

      * CYA,ING
       COPY COLMW018.

      * CAN,VRF
       COPY COLMW043.

      * CAN,CON
       COPY COLMW037.

      * COPY-INC-INI
       COPY COLMW046.

      * COPY-INC-INI
       COPY COLMW013.

      * COPY-INC-INI
       COPY COLMW016.

      * COPY-INC-INI
       COPY COLMW101.

      * COPY-INC-INI
       COPY COLMW032.

      * COPY-INC-INI
       COPY COLMW111.

      * OPC,ACA
       COPY COLMW033.



       77  PT-101-02-ROC-NUM-ADIC-EDT PIC ZZZZZZZZ.
       77  PT-101-02-ROC-NUM-PREP-EDT PIC ZZZ.
       77  PT-101-02-ROC-SGV-CFON-EDT PIC ZZZ,ZZZZ.
       77  PT-101-02-ROC-SGV-FRIE-EDT PIC ZZZ,ZZZZ.
       77  PT-101-02-ROC-SGV-TCAL-EDT PIC ZZZZZZZZZZZ,ZZZZ.



      *77  TP-032-01-OPC-IIC-IOPC-EDT PIC 99999999.
      *77  TP-032-02-FRM-VAL-CRED-EDT PIC 99999999999,9999.
      *77  TP-032-02-FRM-VAL-INTE-EDT PIC 99999999999,9999.
      *77  TP-032-02-FRM-VAL-VCOM-EDT PIC 99999999999,9999.
      *77  TP-032-02-OPC-VAL-SEGD-EDT PIC 99999999999,9999.
      *77  TP-032-02-FRM-VAL-GAST-EDT PIC 99999999999,9999.
      *77  TP-032-02-FRM-VAL-IMPU-EDT PIC 99999999999,9999.
      *77  TP-032-02-OPC-SGV-LIQU-EDT PIC 99999999999,9999.
      *77  TP-032-02-ITR-SGV-TINT-EDT PIC 9999,9999.
      *77  TP-032-03-FRM-NUM-IVCT-EDT PIC 999.
      *77  TP-032-03-FRM-VAL-SCAP-EDT PIC 99999999,99.
      *77  TP-032-03-FRM-VAL-INTC-EDT PIC 999999,99.
      *77  TP-032-03-FRM-VAL-COMC-EDT PIC 99999,99.
      *77  TP-032-03-FRM-VAL-TOTA-EDT PIC 999999999,9999.

       COPY TABWGRCC.
       COPY TABWGSGS.
       COPY SGCWGBCC.

       COPY TABBRUSR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.

       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.

       COPY SGCBROPE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.

       COPY SGCBRRCO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.

       COPY MC2BRROC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROC-REQA==.

       COPY COLBRPOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.

       COPY COLBRVEN.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.


      *>>>>> GNP-INI  ( PVG )

       77  WSS-IDX-IGNP       VALUE ZEROES            PIC 9(03).
       77  WSS-IDX-IROC       VALUE ZEROES            PIC 9(03).
       77  WSS-IDX-TROC       VALUE ZEROES            PIC 9(03).
       77  WSS-TOT-IROC       VALUE ZEROES            PIC 9(03).

       COPY COLWGGNP.
       COPY COLWXGNP.
       01  WSS-VARI.
           03 WSS-NUM-NRNP VALUE ZEROES               PIC 9(02).
           03 WSS-NUM-PLZT VALUE ZEROES               PIC 9(05).
           03 WSS-NITM                                PIC 9(02).
           03 WSS-NITMMAX VALUE 10                    PIC 9(02).
           03 WSS-F       VALUE ZEROES                PIC 9(03).
           03 WSS-FMAX    VALUE 100                   PIC 9(03).
           03 WSS-I                                   PIC 9(02).
           03 WSS-IMAX    VALUE 10                    PIC 9(02).
           03 WSS-J       VALUE ZEROES                PIC 9(02).
           03 WSS-NUM-CCUR.
              05 WSS-NUM-ICUR-EDT                     PIC  ZZ9.
              05 WSS-NUM-ICUR-ALF                     PIC X(03).
              05 WSS-NUM-ICUR      REDEFINES
                 WSS-NUM-ICUR-ALF                     PIC 9(03).
           03  WSS-FEC-FMAX.
               05  WSS-NUM-SMAX                      PIC 9(02).
               05  WSS-NUM-AMAX                      PIC 9(02).
               05  WSS-NUM-MMAX                      PIC 9(02).
               05  WSS-NUM-DMAX                      PIC 9(02).
           03  WSS-FEC-FTMP.
               05  WSS-NUM-STMP                      PIC 9(02).
               05  WSS-NUM-ATMP                      PIC 9(02).
               05  WSS-NUM-MTMP                      PIC 9(02).
               05  WSS-NUM-DTMP                      PIC 9(02).
      *PVG INI 23-JUN-2010 ANALISIS FERIADO
           03  WSS-FEC-FPZT.
               05  WSS-NUM-SPZT                      PIC 9(02).
               05  WSS-NUM-APZT                      PIC 9(02).
               05  WSS-NUM-MPZT                      PIC 9(02).
               05  WSS-NUM-DPZT                      PIC 9(02).
           03  WSS-GLS-GMND.
               05  WSS-GLS-GMD1                      PIC X(01).
               05  WSS-GLS-GMD2                      PIC X(01).
               05  WSS-GLS-GMD3                      PIC X(01).
               05  WSS-GLS-GMD4                      PIC X(01).
               05  WSS-GLS-GMD5                      PIC X(01).
               05  WSS-GLS-GMD6                      PIC X(01).
               05  WSS-GLS-GMD7                      PIC X(01).
               05  WSS-GLS-GMD8                      PIC X(01).
           03  WSS-GLS-VLR1.
               05  WSS-DIS-VLR1                      PIC X(04).
               05  WSS-COD-VLR1                      PIC X(04).
               05  WSS-EXT-VLR1 VALUE SPACES         PIC X(02).
           03  WSS-GLS-VLR2.
               05  WSS-DIS-VLR2                      PIC X(02).
               05  WSS-COD-VLR2                      PIC X(06).
           03  WSS-GLS-GTIO.
               05  WSS-COD-GTIO                      PIC X(03).
               05  WSS-GLS-DTIO                      PIC X(01).
           03  WSS-GLS-GAUX.
               05  WSS-GLS-DAUX                      PIC X(01).
               05  WSS-COD-GAUX                      PIC X(03).

       01  WSS-FEC-FDMA.
           03 WSS-NUM-DDMA                           PIC 9(02).
           03 WSS-NUM-MDMA                           PIC 9(02).
           03 WSS-NUM-SDMA                           PIC 9(02).
           03 WSS-NUM-ADMA                           PIC 9(02).

       01  WSS-FEC-FAMD.
           03 WSS-NUM-SAMD                           PIC 9(02).
           03 WSS-NUM-AAMD                           PIC 9(02).
           03 WSS-NUM-MAMD                           PIC 9(02).
           03 WSS-NUM-DAMD                           PIC 9(02).


      *>>>>> GNP-FIN  ( PVG )

      *
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                                  PIC X(3000).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.

      * RECIBO IDENTIFICACION DEL PC QUE ENVIO EL MSG.

           MOVE DFHCOMMAREA(1:EIBCALEN) TO MCS-CMA-COD-SREQ.

           MOVE MCS-CMA-COD-PT-MCS      TO PT-A03.

           PERFORM GNS-ERR-QUE.

           PERFORM GET-FHOY.


           MOVE 'A03INP' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'A03INP' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE MCS-CMA-COD-SREQ TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'PT-A03' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PT-A03' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE PT-A03 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           PERFORM GET-TSK-TERM.


      *    MOVE MCS-CMA-COD-IDD         TO IDD-REGI.

           PERFORM CRG-IDD.

           MOVE MCS-CMA-COD-COLA TO WSS-QUE-TR-COLA.
           MOVE 'TR'             TO WSS-QUE-TR-COLA-02.

           MOVE 'GIDD'       TO RCC-QUEU.
           MOVE TSK-TERM-ALF TO RCC-TERM.

           MOVE TSK-TERM-ALF TO TS-TPAG-TERM.

           MOVE RCC-QIDD TO QUE-COLA.
           MOVE +490 TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
                 MOVE RCC-QIDD TO QUE-COLA
                 MOVE +490 TO QUE-LITM
                 MOVE IDD-REGI TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 PERFORM GNS-PRO-QUE.

           PERFORM GNS-ERR-QUE.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE SCR-NOM-TCPIP TO  WSS-PTR-GLS-COLA.

           MOVE SCR-NOM-TCPIP TO WSS-PTR-COD-TYPE.


           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'COL' TO FIO-SIST.
           MOVE 'VSN'      TO TAB-COD-TTAB IN TAB.
           MOVE 'LOGPMA03' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-MSC-STAT IN TAB TO WSS-LOGPMA03.

           MOVE 'SIMUI'                 TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +10 TO QUE-LITM.

           MOVE PT-A03-01-FRM-COD-SIMU TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'COL' TO FIO-SIST.
           MOVE 'VSN'      TO TAB-COD-TTAB IN TAB.
           MOVE 'LOGPMA03MVEN' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           IF FIO-STAT-OKS
               MOVE TAB-MSC-STAT IN TAB TO WSS-LOGPMA03MVEN.

           IF FIO-STAT-OKS AND
              TAB-MSC-STAT IN TAB = WSS-CTE-S
               MOVE TAB-GLS-ABRV IN TAB TO WSS-NUM-05
               MOVE WSS-NUM-05 TO WSS-NUM-06
               MOVE WSS-NUM-06 TO WSS-MAX-FVEN.


           IF NOT ( PT-A03-01-FRM-COD-SIMU = WSS-CTE-SIMU-S OR
                    PT-A03-01-FRM-COD-SIMU = WSS-CTE-SIMU-A )

                MOVE PT-A03-01-FRM-COD-SIMU TO WSS-ERR-INV-SIMU-02
                MOVE WSS-ERR-INV-SIMU       TO WSS-ERR-SEND-MENS

                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.



      * CTACTE
      *     IF PT-A03-01-FRM-COD-SIMU = WSS-CTE-S
      *        XX  MOVE SPACES TO PT-A03-01-CYA-CAI-ICYP
      *         XX MOVE SPACES TO PT-A03-01-CYA-IIC-ICYP
      *          MOVE SPACES TO PT-A03-01-CYA-CAI-ICYG
      *          MOVE SPACES TO PT-A03-01-CYA-IIC-ICYG
      *          MOVE SPACES TO PT-A03-01-CYA-CAI-ICYA
      *          MOVE SPACES TO PT-A03-01-CYA-IIC-ICYA
      *          MOVE SPACES TO PT-A03-01-AUT-CAI-ICYA
      *          MOVE SPACES TO PT-A03-01-AUT-IIC-ICYA
      *          MOVE WSS-IND-TCYA-CTBL TO PT-A03-01-FRM-IND-ICYA.

      * 01 >>>>>>>>>>>>>>>>>>    729  OPC,CON INI  >>>>>>>>>>>>>>>>>>>>>




           IF WSS-LOGPMA03MVEN NOT = WSS-CTE-S
                GO TO NO-VAL-VEN.

           MOVE SPACES TO VEN.
           MOVE PT-A03-01-OPC-CAI-IOPC TO VEN-CAI-IOPC IN VEN.
           MOVE PT-A03-01-OPC-IIC-IOPC TO VEN-IIC-IOPC IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.

           IF FIO-STAT-OKS AND
              PT-A03-01-OPC-CAI-IOPC = VEN-CAI-IOPC IN VEN AND
              PT-A03-01-OPC-IIC-IOPC = VEN-IIC-IOPC IN VEN

                IF HOY-FHOY > VEN-FEC-FVEN
                     MOVE WSS-ERR-INV-MORO TO WSS-ERR-SEND-MENS

                     MOVE WSS-QUE-TR-COLA TO QUE-COLA
                     MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                     MOVE QUE-DEL TO QUE-CMND
                     PERFORM GNS-PRO-QUE

                     MOVE WSS-ERR-SEND TO QUE-ITEM
                     MOVE WSS-QUE-TR-COLA TO QUE-COLA
                     MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                     MOVE QUE-PUT TO QUE-CMND
                     PERFORM GNS-PRO-QUE

                     GO TO FIN-MAIN.


           IF FIO-STAT-OKS AND
              PT-A03-01-OPC-CAI-IOPC = VEN-CAI-IOPC IN VEN AND
              PT-A03-01-OPC-IIC-IOPC = VEN-IIC-IOPC IN VEN

                 MOVE HOY-DHOY     TO FEC-DEC1
                 MOVE HOY-MHOY     TO FEC-MEC1
                 MOVE HOY-SHOY     TO FEC-SEC1
                 MOVE HOY-AHOY     TO FEC-AEC1


                 MOVE VEN-NUM-DVEN TO FEC-DEC2
                 MOVE VEN-NUM-MVEN TO FEC-MEC2
                 MOVE VEN-NUM-SVEN TO FEC-SEC2
                 MOVE VEN-NUM-AVEN TO FEC-AEC2


                 MOVE FEC-FORM-FEC        TO FEC-FORM
                 MOVE FEC-DIF-DIA         TO FEC-CMND
                 PERFORM CAL-FEC


                 MOVE 'A03NDIA'              TO QUE-COLA
                 MOVE QUE-DEL                TO QUE-CMND
                 PERFORM GNX-PRO-QUE

                 MOVE FEC-NDIA  TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 MOVE +12 TO QUE-LITM
                 PERFORM GNX-PRO-QUE



                 IF FEC-NDIA < WSS-MAX-FVEN

                     MOVE FEC-NDIA     TO WSS-ERR-INV-FVEN-04
                     MOVE WSS-MAX-FVEN TO WSS-ERR-INV-FVEN-07

                     MOVE VEN-NUM-DVEN IN VEN TO WSS-NUM-DVEN
                     MOVE VEN-NUM-MVEN IN VEN TO WSS-NUM-MVEN
                     MOVE VEN-NUM-SVEN IN VEN TO WSS-NUM-SVEN
                     MOVE VEN-NUM-AVEN IN VEN TO WSS-NUM-AVEN

                     MOVE WSS-ERR-INV-FVEN TO WSS-ERR-SEND-MENS

                     MOVE WSS-QUE-TR-COLA TO QUE-COLA
                     MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                     MOVE QUE-DEL TO QUE-CMND
                     PERFORM GNS-PRO-QUE

                     MOVE WSS-ERR-SEND TO QUE-ITEM
                     MOVE WSS-QUE-TR-COLA TO QUE-COLA
                     MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                     MOVE QUE-PUT TO QUE-CMND
                     PERFORM GNS-PRO-QUE

                     GO TO FIN-MAIN.

       NO-VAL-VEN.

           MOVE 'X' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-729-AHDR.

      *     MOVE PT-729-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-729-AHDR.

           MOVE '729'                  TO PT-729-CREQ.
           MOVE PT-A03-01-OPC-CAI-IOPC TO PT-729-01-OPC-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO PT-729-01-OPC-IIC-IOPC.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-729 TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      * 729  OPC,CON
           PERFORM GNS-PRO-SYS.

           MOVE ZEROES TO QUE-NITM.

           MOVE ZEROES TO WSS-NITM-TSPT.

       CIC-GET-TR-729.

           ADD 1 TO QUE-NITM.

           MOVE QUE-NITM TO WSS-NITM-TSPT.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM TO WSS-TR
                MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)

                GO TO CIC-GET-TR-729.


           MOVE WSS-SND TO TP-729.

           MOVE 'TP-729'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'TP-729'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE TP-729 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           IF TP-729-STAT = '1'
                GO TO FIN-MAIN.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 'NUM-01'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-01'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +50 TO QUE-LITM.

           MOVE TP-729 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

      *    PERFORM VAL-NUM-TP-REQ-729.

      * Complemento condicional de input segun inyeccion

           IF PT-A03-01-OPC-COD-VCOC NOT > SPACES
                MOVE TP-729-01-OPC-COD-VCOC TO PT-A03-01-OPC-COD-VCOC.


           IF PT-A03-01-OPC-COD-TOOC NOT > SPACES
                MOVE TP-729-01-OPC-COD-TOOC TO PT-A03-01-OPC-COD-TOOC.


           IF PT-A03-01-OPC-COD-AOOC NOT > SPACES
               MOVE TP-729-01-OPC-COD-AOOC TO PT-A03-01-OPC-COD-AOOC.

      *     IF PT-A03-01-DBC-NUM-ICLI NOT > SPACES
                MOVE TP-729-01-DBC-NUM-ICLI TO PT-A03-01-DBC-NUM-ICLI.

      *     IF PT-A03-01-DBC-VRF-ICLI NOT > SPACES
               MOVE TP-729-01-DBC-VRF-ICLI TO PT-A03-01-DBC-VRF-ICLI.

      *     IF PT-A03-01-DBC-IND-ICLI NOT > SPACES
                MOVE TP-729-01-DBC-IND-ICLI TO PT-A03-01-DBC-IND-ICLI.

      *     IF PT-A03-01-DBC-GLS-ICLI NOT > SPACES
                MOVE TP-729-01-DBC-GLS-ICLI TO PT-A03-01-DBC-GLS-ICLI.



           MOVE 'TINTALF'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +40 TO QUE-LITM.

           MOVE TP-729-01-ITR-SGV-TINT TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.









           MOVE 'TINTEDT'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +40 TO QUE-LITM.

           MOVE TP-729-01-ITR-SGV-TINT-NUM TO
                TP-032-02-ITR-SGV-TINT-EDT.

           MOVE TP-032-02-ITR-SGV-TINT-EDT TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.






           MOVE 'TINTNUM'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +40 TO QUE-LITM.

           MOVE TP-032-02-ITR-SGV-TINT-EDT TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.





           MOVE TP-032-02-ITR-SGV-TINT-EDT TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
              IF PT-A03-01-FRM-IND-TINT = WSS-FRM-IND-TINT-H
                   MOVE SPACES   TO TP-729-01-ITR-SGV-TINT
                   MOVE NUM-NN9V TO TP-729-01-ITR-SGV-TINT-NUM
                   MOVE TP-729-01-ITR-SGV-TINT-NUM TO
                        PT-A03-01-ITR-SGV-TINT-NUM
               ELSE

              IF PT-A03-01-FRM-IND-TINT = WSS-FRM-IND-TINT-I

      * VAL-NUM PT-A03-01-ITR-SGV-TINT
                  MOVE PT-A03-01-ITR-SGV-TINT TO NUM-NUME
                  MOVE NUM-ZERO-S TO NUM-ZERO
                  MOVE NUM-SGNO-S TO NUM-SGNO
                  MOVE 3 TO NUM-NENT
                  MOVE 4 TO NUM-NDCM
                  PERFORM VAL-NUM
                  IF NUM-STAT-OKS
                      MOVE SPACES   TO PT-A03-01-ITR-SGV-TINT
                      MOVE NUM-NN9V TO PT-A03-01-ITR-SGV-TINT-NUM
                  ELSE
                      MOVE NUM-MENS         TO WSS-ERR-SGV-TINT-02
                      MOVE WSS-ERR-SGV-TINT TO WSS-ERR-SEND-MENS

                      MOVE WSS-ERR-SEND TO QUE-ITEM
                      MOVE WSS-QUE-TR-COLA TO QUE-COLA
                      MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                      MOVE QUE-PUT TO QUE-CMND
                      PERFORM GNS-PRO-QUE

                      GO TO FIN-MAIN



              ELSE





                   NEXT SENTENCE

           ELSE
                MOVE NUM-MENS               TO WSS-ERR-SGV-TINT-02
                MOVE WSS-ERR-SGV-TINT       TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.




           MOVE 'YANUM'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +40 TO QUE-LITM.

           MOVE SPACES                     TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




           IF PT-A03-01-FRM-IND-TINT = WSS-FRM-IND-TINT-H
                MOVE TP-729-01-ITR-SGV-TINT-NUM TO
                     PT-A03-01-ITR-SGV-TINT-NUM.


           MOVE 'XTINT'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +40 TO QUE-LITM.

           MOVE PT-A03-01-ITR-SGV-TINT   TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


      * Complemento incondicional de inut segun consulta OPC

           MOVE TP-729-01-OPC-COD-CVTA TO WSS-IND-CVTA.

           MOVE TP-729-01-OPC-IND-GARA TO WSS-IND-GARA.

           MOVE TP-729-01-OPC-COD-CDOC TO WSS-IND-CDOC.

           MOVE TP-729-01-OPC-COD-RMOC TO PT-A03-01-OPC-COD-RMOC.


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.







      * REQ 729 NO GENERA RESPUESTA
      *     PERFORM PUT-TR VARYING WSS-IDX-TR FROM 1 BY 1 UNTIL
      *       WSS-IDX-TR > WSS-NITM-TSPT.



      * 01 >>>>>>>>>>>>>>>>>>    729  OPC,CON FIN  >>>>>>>>>>>>>>>>>>>>>




           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'GNS' TO FIO-SIST.
           MOVE WSS-CTE-PPM       TO TAB-COD-TTAB IN TAB.
           MOVE WSS-CTE-HORA-2000 TO TAB-COD-CTAB IN TAB.


           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
                    TAB-MSC-STAT IN TAB = WSS-CTE-S )

                MOVE WSS-ERR-INV-HORA TO WSS-ERR-SEND-MENS

                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.

           MOVE TAB-GLS-DCOR IN TAB TO WSS-NUM-HORA-2000.


           MOVE 'HORA20'              TO QUE-COLA.
           MOVE QUE-DEL               TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.

           MOVE WSS-NUM-HORA-2000     TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'GNS' TO FIO-SIST.
           MOVE WSS-CTE-PPM       TO TAB-COD-TTAB IN TAB.
           MOVE WSS-CTE-HORA-0800 TO TAB-COD-CTAB IN TAB.


           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
                    TAB-MSC-STAT IN TAB = WSS-CTE-S )

                MOVE WSS-ERR-INV-HORA TO WSS-ERR-SEND-MENS

                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.



           MOVE TAB-GLS-DCOR IN TAB TO WSS-NUM-HORA-0800.

           MOVE 'HORA08'              TO QUE-COLA.
           MOVE QUE-DEL               TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.

           MOVE WSS-NUM-HORA-0800     TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           PERFORM GET-FHOY.

           MOVE HOY-FHOY             TO FEC-FECH.
           MOVE FEC-VHBL-S           TO FEC-VHBL.
           MOVE FEC-FBLK-N           TO FEC-FBLK.
           MOVE FEC-CHOY-N           TO FEC-CHOY.
           MOVE FEC-FORM-FEC         TO FEC-FORM.
           MOVE FEC-VAL-FEC          TO FEC-CMND.
           PERFORM PRO-FEC.




           IF HOY-HHOY NOT > WSS-NUM-HORA-0800 OR
              HOY-HHOY NOT < WSS-NUM-HORA-2000 OR
              FEC-STAT-FER


                MOVE WSS-ERR-INV-HORA TO WSS-ERR-SEND-MENS

                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.

           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'GNS' TO FIO-SIST.
           MOVE WSS-CTE-PPM  TO TAB-COD-TTAB IN TAB.


           MOVE WSS-CTE-IMCS-A03 TO WSS-COD-CTAB-PPM-0103-MCS.

           IF PT-A03-01-OPC-COD-VCOC = WSS-CTE-VCAM-0999
               MOVE WSS-CTE-VCAM-0999-01 TO WSS-COD-CTAB-PPM-0405-MON
           ELSE
           IF PT-A03-01-OPC-COD-VCOC = WSS-CTE-VCAM-0998
               MOVE WSS-CTE-VCAM-0998-02 TO WSS-COD-CTAB-PPM-0405-MON.

           MOVE PT-A03-01-OPC-COD-TOOC TO WSS-COD-CTAB-PPM-0608-TIO.

           MOVE PT-A03-01-OPC-COD-AOOC TO WSS-COD-CTAB-PPM-0911-AUX.

           MOVE WSS-CTE-01-ALF         TO WSS-COD-CTAB-PPM-1212-COR.


           MOVE 'PRODUCTO'              TO QUE-COLA.
           MOVE QUE-DEL               TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.

           MOVE WSS-COD-CTAB-PPM     TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE WSS-COD-CTAB-PPM TO TAB-COD-CTAB IN TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
                    TAB-MSC-STAT IN TAB = WSS-CTE-S )

                MOVE WSS-ERR-INV-PROR     TO WSS-ERR-SEND-MENS

                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.

      * VALIDACION NUMERICA PT-A03-01-OPC-VAL-CRED


           MOVE 'MTO-CRED'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'MTO-CRED'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE PT-A03-01-OPC-VAL-CRED TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE PT-A03-01-OPC-VAL-CRED TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A03-01-OPC-VAL-CRED
               MOVE NUM-NN9V TO PT-A03-01-OPC-VAL-CRED-NUM
           ELSE
                MOVE NUM-MENS         TO WSS-ERR-VAL-CRED-02
                MOVE WSS-ERR-VAL-CRED TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.


           IF PT-A03-01-FRM-IND-TINT NOT = WSS-FRM-IND-TINT-I AND
              PT-A03-01-FRM-IND-TINT NOT = WSS-FRM-IND-TINT-P AND
              PT-A03-01-FRM-IND-TINT NOT = WSS-FRM-IND-TINT-H

                MOVE PT-A03-01-FRM-IND-TINT TO WSS-ERR-IND-TASA-02
                MOVE WSS-ERR-IND-TASA TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.



           MOVE 'VAL-CRED'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'VAL-CRED'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE PT-A03-01-OPC-VAL-CRED TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

      * VAL-NUM PT-A03-01-ITR-SGV-TINT
      *xx     MOVE PT-A03-01-ITR-SGV-TINT TO NUM-NUME.
      *xx     MOVE NUM-ZERO-S TO NUM-ZERO.
      *xx     MOVE NUM-SGNO-S TO NUM-SGNO.
      *xx     MOVE 3 TO NUM-NENT.
      *xx     MOVE 4 TO NUM-NDCM.
      *xx     PERFORM VAL-NUM.
      *xx     IF NUM-STAT-OKS
      *xx         MOVE SPACES   TO PT-A03-01-ITR-SGV-TINT
      *xx         MOVE NUM-NN9V TO PT-A03-01-ITR-SGV-TINT-NUM
      *xx     ELSE
      *xx          MOVE NUM-MENS         TO WSS-ERR-SGV-TINT-02
      *xx          MOVE WSS-ERR-SGV-TINT TO WSS-ERR-SEND-MENS

      *xx          MOVE WSS-ERR-SEND TO QUE-ITEM
      *xx          MOVE WSS-QUE-TR-COLA TO QUE-COLA
      *xx          MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
      *xx          MOVE QUE-PUT TO QUE-CMND
      *xx          PERFORM GNS-PRO-QUE

      *xx          GO TO FIN-MAIN.


           MOVE 'SGV1TINT'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.
           MOVE PT-A03-01-ITR-SGV-TINT TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



      * VAL-NUM PT-A03-01-NOP-NUM-VIGU
           MOVE PT-A03-01-NOP-NUM-VIGU TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A03-01-NOP-NUM-VIGU
               MOVE NUM-NN9V TO PT-A03-01-NOP-NUM-VIGU-NUM
               IF PT-A03-01-NOP-NUM-VIGU-NUM = WSS-CTE-001
                   MOVE WSS-CTE-TCVE-CO TO
                        WSS-CTE-TCVE-FO-O-CO
               ELSE
                   NEXT SENTENCE
           ELSE
                MOVE NUM-MENS      TO WSS-ERR-NUM-VIGU-02
                MOVE WSS-ERR-NUM-VIGU TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.

           MOVE 'NUM-VIGU'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'NUM-VIGU'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +10 TO QUE-LITM.
           MOVE PT-A03-01-NOP-NUM-VIGU TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


      * VAL-NUM PT-A03-01-NOP-NUM-SPVE
           MOVE PT-A03-01-NOP-NUM-SPVE TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A03-01-NOP-NUM-SPVE
               MOVE NUM-NN9V TO PT-A03-01-NOP-NUM-SPVE-NUM
           ELSE
                MOVE NUM-MENS      TO WSS-ERR-NUM-SPVE-02
                MOVE WSS-ERR-NUM-VIGU TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.

           MOVE 'NUM-SPVE'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'NUM-SPVE'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +10 TO QUE-LITM.
           MOVE PT-A03-01-NOP-NUM-SPVE TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

      * VAL-NUM PT-A03-01-NOP-NUM-SEVE
           MOVE PT-A03-01-NOP-NUM-SEVE TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
               MOVE SPACES   TO PT-A03-01-NOP-NUM-SEVE
               MOVE NUM-NN9V TO PT-A03-01-NOP-NUM-SEVE-NUM
           ELSE
                MOVE NUM-MENS      TO WSS-ERR-NUM-SEVE-02
                MOVE WSS-ERR-NUM-SEVE TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.

           MOVE 'NUM-SEVE'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'NUM-SEVE'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +10 TO QUE-LITM.
           MOVE PT-A03-01-NOP-NUM-SEVE TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

      * VAL-NUM PT-A03-01-FRM-NUM-PLZT
      *>     MOVE PT-A03-01-FRM-NUM-PLZT TO NUM-NUME.
      *>     MOVE NUM-ZERO-S TO NUM-ZERO.
      *>     MOVE NUM-SGNO-S TO NUM-SGNO.
      *>     MOVE 5 TO NUM-NENT.
      *>     MOVE 0 TO NUM-NDCM.
      *>     PERFORM VAL-NUM.
      *>     IF NUM-STAT-OKS
      *>         MOVE SPACES   TO PT-A03-01-FRM-NUM-PLZT
      *>         MOVE NUM-NN9V TO PT-A03-01-FRM-NUM-PLZT-NUM
      *>     ELSE
      *>          MOVE NUM-MENS      TO WSS-ERR-NUM-PLZT-02
      *>          MOVE WSS-ERR-NUM-PLZT TO WSS-ERR-SEND-MENS

      *>          MOVE WSS-ERR-SEND TO QUE-ITEM
      *>          MOVE WSS-QUE-TR-COLA TO QUE-COLA
      *>          MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
      *>          MOVE QUE-PUT TO QUE-CMND
      *>          PERFORM GNS-PRO-QUE

      *>          GO TO FIN-MAIN.

      *>     MOVE 'NUM-PLZT'             TO QUE-COLA.
      *>     MOVE QUE-DEL                TO QUE-CMND.
      *>     PERFORM GNX-PRO-QUE.
      *>     MOVE 'NUM-PLZT'             TO QUE-COLA.
      *>     MOVE QUE-PUT TO QUE-CMND.
      *>     MOVE +10 TO QUE-LITM.
      *>     MOVE PT-A03-01-FRM-NUM-PLZT TO QUE-ITEM.
      *>     PERFORM GNX-PRO-QUE.

           IF PT-A03-01-NOP-FEC-FPVC > ZEROES
               GO TO FEC-FPVC-YA-ASIG.

           MOVE PT-A03-01-NOP-FEC-FCUR TO FEC-FECH.

           IF PT-A03-01-NOP-IND-UTPV = 'D'
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE PT-A03-01-NOP-NUM-SPVE-NUM TO FEC-NDIA
           ELSE
           IF PT-A03-01-NOP-IND-UTPV = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE PT-A03-01-NOP-NUM-SPVE-NUM TO FEC-NMES
           ELSE
           IF PT-A03-01-NOP-IND-UTPV = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE PT-A03-01-NOP-NUM-SPVE-NUM TO  FEC-NANO.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO PT-A03-01-NOP-FEC-FPVC.


       FEC-FPVC-YA-ASIG.




           PERFORM PRO-GEN-NP.

           ADD WSS-NUM-VIGU-ADIC TO PT-A03-01-NOP-NUM-VIGU-NUM.


           MOVE 'NUM-VIG1'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'NUM-VIG1'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.
           MOVE PT-A03-01-NOP-NUM-VIGU TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF NOP-COD-MENS IN EVC-VARI > SPACES

                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE WSS-QUE-TR-COLA TO QUE-COLA


                MOVE NOP-COD-MENS TO WSS-ERR-PRO-GNOP-02
                MOVE NOP-GLS-MENS TO WSS-ERR-PRO-GNOP-03

                MOVE WSS-ERR-PRO-GNOP TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM

                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.



           MOVE 'FEC-FPVC'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'FEC-FPVC'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.
           MOVE PT-A03-01-NOP-FEC-FPVC TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           SUBTRACT 1 FROM PT-A03-01-NOP-NUM-VIGU-NUM
                      GIVING WSS-NUM-TOT-PER.
           MULTIPLY WSS-NUM-TOT-PER BY
                    PT-A03-01-NOP-NUM-SEVE-NUM
           GIVING WSS-NUM-TOT-PER.

           MOVE PT-A03-01-NOP-FEC-FPVC TO FEC-FECH.

           IF PT-A03-01-NOP-IND-UTSV = 'D'
               MOVE FEC-SUM-DIA TO FEC-CMND
               MOVE WSS-NUM-TOT-PER TO FEC-NDIA
           ELSE
           IF PT-A03-01-NOP-IND-UTSV = 'M'
               MOVE FEC-SUM-MES TO FEC-CMND
               MOVE WSS-NUM-TOT-PER TO FEC-NMES
           ELSE
           IF PT-A03-01-NOP-IND-UTSV = 'A'
               MOVE FEC-SUM-ANO TO FEC-CMND
               MOVE WSS-NUM-TOT-PER TO  FEC-NANO.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-FECH TO FEC-FEC2.

           MOVE 'FTER-F2'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'FTER-F2'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.
           MOVE FEC-FEC2 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE PT-A03-01-NOP-FEC-FCUR TO FEC-FEC1.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.

           IF NOT FEC-STAT-OKS

                MOVE FEC-FEC1         TO WSS-ERR-FEC-DIFE-02
                MOVE FEC-FEC1         TO WSS-ERR-FEC-DIFE-04
                MOVE FEC-MENS         TO WSS-ERR-FEC-DIFE-06
                MOVE WSS-ERR-FEC-DIFE     TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN

           ELSE
                MOVE FEC-NDIA TO WSS-TOT-DIA.



           MOVE 'TOT-DIA'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'TOT-DIA'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.
           MOVE WSS-TOT-DIA TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           MOVE PT-A03-01-DBC-NUM-ICLI TO DBC-NUM-ICLI IN DBC.
           MOVE PT-A03-01-DBC-IND-ICLI TO DBC-IND-ICLI IN DBC.
           MOVE PT-A03-01-DBC-GLS-ICLI TO DBC-GLS-ICLI IN DBC.

           IF PT-A03-01-FRM-IND-ICYA = WSS-IND-TCYA-CTBL
                MOVE WSS-COD-TCYA-CTBL TO PT-046-02-CYA-IND-TCYA
                MOVE SPACES            TO PT-A03-01-CYA-CAI-ICYA
                MOVE SPACES            TO PT-A03-01-CYA-IIC-ICYA
                GO TO END-BUS-CTA-CLTE.

           MOVE 'COL' TO FIO-SIST.
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'VSN' TO TAB-COD-TTAB IN TAB.
           MOVE 'RUTAUXRCC' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.


                      MOVE 'RUT-AUX0'              TO QUE-COLA
	              MOVE QUE-DEL                TO QUE-CMND
	              PERFORM GNX-PRO-QUE
	              MOVE 'RUT-AUX0'              TO QUE-COLA
	              MOVE QUE-PUT TO QUE-CMND
	              MOVE +20 TO QUE-LITM
	              MOVE FIO-STAT TO QUE-ITEM
	              PERFORM GNX-PRO-QUE



           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'



                MOVE TAB-GLS-DATA IN TAB   TO WSS-GLS-DATA-RAUX
                MOVE WSS-GLS-DATA-RAUX-NUM TO WSS-NUM-RAUX.

           MOVE 'RUT-AUX'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'RUT-AUX'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +20 TO QUE-LITM.
           MOVE WSS-NUM-RAUX TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF PT-A03-01-FRM-IND-ICYA NOT = WSS-IND-TCYA-OBLI
                MOVE PT-A03-01-FRM-IND-ICYA TO WSS-ERR-IND-TCYA-01
                MOVE WSS-ERR-IND-TCYA TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.

           MOVE WSS-COD-TCYA-CCMA TO PT-046-02-CYA-IND-TCYA.
      * CTACTE
            IF PT-A03-01-FRM-COD-SIMU = WSS-CTE-S
                MOVE WSS-COD-TCYA-CTBL TO PT-046-02-CYA-IND-TCYA.


           IF PT-A03-01-CYA-IIC-ICYA-NUM NOT > ZEROES
               IF PT-A03-01-FRM-COD-SIMU = WSS-CTE-SIMU-S
                    MOVE WSS-COD-TCYA-CTBL TO PT-038-02-CYA-IND-TCYA
                    MOVE SPACES TO PT-046-02-CYA-CAI-ICYA
                    MOVE SPACES TO PT-046-02-CYA-IIC-ICYA
                    GO TO END-BUS-CTA-CLTE
                ELSE
                    MOVE BCC-CAI-IOPE TO PT-046-02-CYA-CAI-ICYA
                    MOVE BCC-IIC-IOPE TO PT-046-02-CYA-IIC-ICYA
                    GO TO END-BUS-CTA-CLTE.

           PERFORM BUS-CTE-CLI.

           IF BCC-GLS-MENS > SPACES

                MOVE BCC-GLS-MENS TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM
                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.

           MOVE PT-A03-01-CYA-CAI-ICYA TO PT-046-02-CYA-CAI-ICYA.
           MOVE PT-A03-01-CYA-IIC-ICYA TO PT-046-02-CYA-IIC-ICYA.
           IF PT-A03-01-FRM-COD-SIMU = WSS-CTE-SIMU-S
                MOVE WSS-COD-TCYA-CTBL TO PT-038-02-CYA-IND-TCYA
                MOVE SPACES TO PT-046-02-CYA-CAI-ICYA
                MOVE SPACES TO PT-046-02-CYA-IIC-ICYA.


       END-BUS-CTA-CLTE.

           MOVE PT-046-02-CYA-CAI-ICYA TO PT-046-02-AUT-CAI-ICYA.
           MOVE PT-046-02-CYA-IIC-ICYA TO PT-046-02-AUT-IIC-ICYA.
           IF PT-046-02-AUT-IIC-ICYA-NUM > ZEROES
                 MOVE WSS-CTE-AUT   TO PT-046-02-AUT-NUM-ICAN
                 MOVE WSS-CTE-S     TO PT-046-02-AUT-MSC-STAT.

           IF PT-A03-01-FRM-COD-SIMU = WSS-CTE-SIMU-S
                MOVE SPACES TO PT-046-02-AUT-NUM-ICAN
                MOVE SPACES TO PT-046-02-AUT-MSC-STAT
                MOVE SPACES TO PT-046-02-AUT-CAI-ICYA
                MOVE SPACES TO PT-046-02-AUT-IIC-ICYA.

           IF PT-A03-01-OPC-COD-OFOC NOT > SPACES
                MOVE DBC-COD-OFIC IN DBC TO PT-A03-01-OPC-COD-OFOC.


           MOVE SPACES TO POC.

           MOVE PT-A03-01-OPC-COD-VCOC TO POC-COD-VCOC IN POC.
           MOVE PT-A03-01-OPC-COD-TOOC TO POC-COD-TOOC IN POC.
           MOVE PT-A03-01-OPC-COD-AOOC TO POC-COD-AOOC IN POC.
           MOVE ZEROES                 TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.


           MOVE 'FIO-POC'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'FIO-POC'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE POC TO QUE-ITEM.

           PERFORM GNX-PRO-QUE.

           IF NOT FIO-STAT-OKS

                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE


                MOVE WSS-QUE-TR-COLA TO QUE-COLA

                MOVE 'Producto Inexistente' TO WSS-ERR-SEND-MENS


                MOVE WSS-ERR-SEND TO QUE-ITEM

                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.


           MOVE  POC-VAL-CMAX IN POC TO WSS-POC-VAL-CMAX.


      *     MOVE 'COL' TO TAB-COD-SIST.
      *     MOVE 'COL' TO FIO-SIST.
      *     MOVE 'CSP'      TO TAB-COD-TTAB IN TAB.
      *     MOVE POC-KEY-IPOC TO TAB-COD-CTAB IN TAB.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      *     IF NOT FIO-STAT-OKS OR
      *        TAB-IND-VIGE IN TAB NOT = WSS-CTE-S
      *          MOVE WSS-ERR-INV-PROR TO WSS-ERR-SEND-MENS
      *
      *          MOVE WSS-ERR-SEND TO QUE-ITEM
      *          MOVE WSS-QUE-TR-COLA TO QUE-COLA
      *          MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
      *          MOVE QUE-PUT TO QUE-CMND
      *          PERFORM GNS-PRO-QUE
      *
      *          GO TO FIN-MAIN.





           IF   PT-A03-01-SGS-COD-SG01 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG01 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A03-01-SGS-COD-SG02 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG02 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).



           IF   PT-A03-01-SGS-COD-SG03 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG03 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG04 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG04 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).



           IF   PT-A03-01-SGS-COD-SG05 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG05 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).

           IF   PT-A03-01-SGS-COD-SG06 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG06 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).



           IF   PT-A03-01-SGS-COD-SG07 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG07 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).




           IF   PT-A03-01-SGS-COD-SG08 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG08 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG09 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG09 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG10 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG10 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).




           IF   PT-A03-01-SGS-COD-SG11 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG11 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG12 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG12 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG13 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG13 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG14 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG14 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG15 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG15 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG16 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG16 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG17 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG17 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG18 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG18 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).



           IF   PT-A03-01-SGS-COD-SG19 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG19 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG20 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG20 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG21 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG21 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG22 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG22 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG23 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG23 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG24 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG24 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG25 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG25 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).



           IF   PT-A03-01-SGS-COD-SG26 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG26 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).



           IF   PT-A03-01-SGS-COD-SG27 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG27 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG28 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG28 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG29 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG29 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).


           IF   PT-A03-01-SGS-COD-SG30 NOT > SPACES
                  GO TO FIN-CRG-SGS.

           ADD 1 TO WSS-SGS-INP-TOT.

           MOVE PT-A03-01-SGS-COD-SG30 TO
                WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-SGS-INP-TOT).




       FIN-CRG-SGS.


      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = PPC >>>>>>>>>>>>>>>>>>>>


       INI-PPC.

           MOVE SPACES         TO RCC-CIC-IOPE IN RCC-VARI.
           MOVE SPACES         TO RCC-IDC-ICLI IN RCC-VARI.

           MOVE PT-A03-01-DBC-NUM-ICLI TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-VRF-ICLI TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-IND-ICLI TO RCC-IND-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-GLS-ICLI TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE SPACES                 TO RCC-IND-RTBL IN RCC-VARI.
           MOVE ZEROES                 TO RCC-IND-COMP IN RCC-VARI.
           MOVE  PT-A03-AHDR           TO WSS-HDR.

      *    MOVE '110'                  TO RCC-COD-TCNL IN RCC-VARI.
           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.
           MOVE WSS-HDR-TIPC-02        TO RCC-COD-TCNL IN RCC-VARI.


           MOVE 'RCC-CNAL'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RCC-CNAL'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.
           MOVE SPACES TO QUE-ITEM.
           MOVE RCC-COD-TCNL TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE SPACES                 TO RCC-COD-CNAL IN RCC-VARI.

           IF RCC-COD-TCNL IN RCC-VARI = WSS-CTE-110
                MOVE ZEROES TO RCC-COD-CNAL IN RCC-VARI
           ELSE
                MOVE WSS-CTE-010 TO RCC-COD-TCNL IN RCC-VARI
                MOVE PT-A03-01-OPC-COD-OFOC TO
                            RCC-COD-CNAL IN RCC-VARI.

           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCOC IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-TOOC TO RCC-COD-TOOC IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-AOOC TO RCC-COD-AOOC IN RCC-VARI.
           MOVE WSS-TOT-DIA            TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE 'D'                    TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE 'CUR'                  TO RCC-COD-EVEN IN RCC-VARI.
           MOVE 'PPC'                  TO RCC-COD-CPTO IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-TCAR IN RCC-VARI.
           MOVE PT-A03-01-OPC-VAL-CRED-NUM TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCMO IN RCC-VARI.
           MOVE PT-A03-01-OPC-VAL-CRED-NUM TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VSOP IN RCC-VARI.
           MOVE PT-A03-01-NOP-NUM-VIGU-NUM TO RCC-VAL-FINA IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCFN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-INTE IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-VASG IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCVA IN RCC-VARI.

           MOVE PT-A03-01-NOP-FEC-FCUR TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FCOL IN RCC-VARI.


           MOVE PT-A03-01-NOP-FEC-FPVC TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FVEN IN RCC-VARI.

           MOVE 'CON'                  TO RCC-COD-TCON IN RCC-VARI.
           MOVE 'S'                    TO RCC-OFRM-SRV IN RCC-VARI.
           MOVE FIO-MSFL               TO RCC-MSFL     IN RCC-VARI.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


           MOVE 'RCC-INP'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RCC-INP'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE SPACES TO QUE-ITEM.
           MOVE 'PPC'    TO QUE-IKEY.
           MOVE RCC-VARI TO QUE-DATA.
           PERFORM GNX-PRO-QUE.






           MOVE 'GIDD'       TO RCC-QUEU.
           MOVE TSK-TERM-ALF TO RCC-TERM.

           MOVE RCC-QIDD TO QUE-COLA.
           MOVE +490 TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
                 MOVE RCC-QIDD TO QUE-COLA
                 MOVE +490 TO QUE-LITM
                 MOVE IDD-REGI TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 PERFORM GNS-PRO-QUE.




           MOVE +490       TO RCC-LIDD.




           MOVE RCC-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
      *     LINK TABPSRCC RCC-COD-CPTO = PPC
           MOVE 'TABPSRCC' TO SYS-PROG.
           MOVE RCC-TCMA   TO SYS-TCMA.
      * RCC-COD-CPTO = PPC
           PERFORM GNS-PRO-SYS.

           MOVE SYS-CMMA TO RCC-CMMA.
           MOVE RCC-MSFL TO FIO-MSFL.

           MOVE 'RCC-OUT'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RCC-OUT'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           MOVE 'PPC'    TO QUE-IKEY.
           MOVE RCC-VARI TO QUE-DATA.

           PERFORM GNX-PRO-QUE.


           MOVE ZEROES TO QUE-NITM.

       CIC-ROC-PPC-QUE.

           ADD 1 TO QUE-NITM.

           MOVE ZEROES TO WSS-IDX-IROC.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.

           MOVE QUE-GET TO QUE-CMND.
           MOVE RCC-LEN-TSSGS TO QUE-LITM.
           PERFORM GNS-PRO-QUE.

           IF QUE-STAT = QUE-STAT-OKS


               MOVE QUE-ITEM TO OSG-APL-VEC IN OSG-VARI(1)

                            MOVE 'POC-CMIX'             TO QUE-COLA
                            MOVE QUE-DEL                TO QUE-CMND
                            PERFORM GNX-PRO-QUE

               MOVE ' <Ppc>' TO WSS-ERR-NUM-CMAX-05
               MOVE QUE-ITEM TO OSG-APL-VEC IN OSG-VARI(1)
               MOVE OSG-SGS-SGV-TAMO IN OSG-VARI(1)
      *        MOVE OSG-SGS-VAL-MNTO IN OSG-VARI(1)
                     TO WSS-POC-VAL-CMAX.



           MOVE PT-A03-01-OPC-VAL-CRED-NUM TO WSS-ERR-NUM-CMAX-02.
           MOVE WSS-POC-VAL-CMAX           TO WSS-ERR-NUM-CMAX-04.


           MOVE 'POC-CMAX'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'POC-CMAX'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           MOVE WSS-ERR-NUM-CMAX-04 TO QUE-ITEM.

           PERFORM GNX-PRO-QUE.




           IF PT-A03-01-OPC-VAL-CRED-NUM > WSS-POC-VAL-CMAX

                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE WSS-QUE-TR-COLA TO QUE-COLA

                MOVE WSS-ERR-NUM-CMAX TO WSS-ERR-SEND-MENS

                MOVE WSS-ERR-SEND TO QUE-ITEM

                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-MAIN.


       CIC-ROC-PPC-OCC.

           ADD 1 TO WSS-IDX-IROC.


      *     IF PT-A03-01-OPC-VAL-CRED
      * ACA DEBE .......

      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.

      *     MOVE PT-101             TO WSS-TR-COD-DATA.
      *     MOVE WSS-TR             TO QUE-ITEM.

      *     MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.

      *     GO TO CIC-ROC-PPC-OCC.






       FIN-ROC-PPC-OCC.


           PERFORM FORM-REQS.

      *     IF PT-A03-01-FRM-COD-SIMU = WSS-CTE-S
      *         MOVE 'COL' TO TAB-COD-SIST
      *         MOVE 'COL' TO FIO-SIST
      *         MOVE FIO-BCK-OUT TO FIO-CMND
      *         PERFORM GNS-FIO-TAB.


       FIN-MAIN.


           EXEC CICS RETURN END-EXEC.
       EXT-MAIN.
           EXIT.


       FORM-REQS SECTION.
       INI-FORM-REQS.
           MOVE ZEROES TO WSS-ITEM-SEGM.

      *     MOVE 'GNS' TO TAB-COD-SIST
      *                   FIO-SIST.

      *     MOVE SPACES TO TAB.
      *     MOVE MCS-TAB-COD-TTAB TO TAB-COD-TTAB.
      *     MOVE MCS-CMA-COD-IMCS        TO MCS-TAB-COD-SREQ-IREQ.
      *     MOVE MCS-TAB-COD-SREQ-TREQ-S TO MCS-TAB-COD-SREQ-TREQ.
      *     MOVE SPACES                  TO MCS-TAB-COD-SREQ-NREQ.
      *     MOVE ZEROES                  TO MCS-TAB-COD-SREQ-CREQ.

      *     MOVE MCS-TAB-COD-SREQ TO TAB-COD-CTAB IN TAB.

      *     MOVE FIO-GET-NLS TO FIO-CMND.


      *     MOVE TAB TO QUE-ITEM.
      *     MOVE +1024 TO QUE-LITM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     MOVE 'TAB001' TO QUE-COLA.
      *     PERFORM GNS-PRO-QUE.


       CIC-FORM-REQS.

           ADD 1 TO WSS-ITEM-SEGM.

      *     PERFORM GNS-FIO-TAB.

      *     MOVE FIO-STAT TO QUE-ITEM.
      *     MOVE +1024 TO QUE-LITM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     MOVE 'TAB002' TO QUE-COLA.
      *     PERFORM GNS-PRO-QUE.


      *     MOVE TAB TO QUE-ITEM.
      *     MOVE +1024 TO QUE-LITM.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     MOVE 'TAB003' TO QUE-COLA.
      *     PERFORM GNS-PRO-QUE.

      *     IF NOT FIO-STAT-OKS
      *         GO TO END-FORM-REQS.

      *     IF TAB-COD-TTAB IN TAB NOT =
      *        MCS-TAB-COD-TTAB
      *            GO TO END-FORM-REQS.

      *     MOVE TAB-COD-CTAB IN TAB TO MCS-TAB-COD-SREQ.

      *     IF MCS-TAB-COD-SREQ-TREQ NOT =
      *        MCS-TAB-COD-SREQ-TREQ-S
      *          GO TO END-FORM-REQS.

      *     MOVE TAB-GLS-DCOR IN TAB TO SYS-PROG.


      *     MOVE TAB-GLS-DATA IN TAB   TO WSS-GLS-DATA.
      *     MOVE WSS-GLS-DATA-COD-SGMT TO WSS-TR-COD-SGMT.


      *     MOVE TAB-GLS-ABRV IN TAB TO MCS-CMA-COD-IMCS.
      *     MOVE SPACES              TO MCS-CMA-COD-VMCS.
      *     MOVE WSS-QUE-INP-COLA    TO MCS-CMA-COD-COLA.



      *     MOVE MCS-CMA-TCMA TO SYS-TCMA.
      *
      *     MOVE MCS-CMA-COD-SREQ TO SYS-CMMA.
      *     MOVE SYS-LINK   TO SYS-CMND.
      *     PERFORM GNS-PRO-SYS.
      *     MOVE SYS-CMMA   TO MCS-CMA-COD-SREQ.


      * PUT-TR PARA TRADUCTOR


      * 02.0 >>>>>>>>>>>>>>>>>>    256  CAN,SCA INI  >>>>>>>>>>>>>>>>>>
      *      Calculadora invocacion 01
      *      Inyecta "09. Tasa Interes Canc   <    0,3947 >"
      *      para obtener
      *      "19. V Renov  <       3.283.098,0000 >"


           MOVE SPACES TO PT-256.

           MOVE 'X' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-256-AHDR.

      *     MOVE PT-256-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-256-AHDR.

           MOVE '256'                  TO PT-256-CREQ.
           MOVE PT-A03-01-OPC-CAI-IOPC TO PT-256-01-CAN-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO PT-256-01-CAN-IIC-IOPC.

           MOVE WSS-CTE-PTT            TO PT-256-02-CAN-MSC-CANC.

           MOVE TP-729-01-OPC-COD-OFOC TO PT-256-02-CAN-COD-OFCA.

           MOVE TP-729-01-ITR-SGV-TINT-NUM TO
                WSS-EDT-0304.
           MOVE WSS-EDT-0304 TO
                PT-256-02-ICG-SGV-TINT.


           MOVE WSS-COD-TCYA-CTBL      TO PT-256-02-CYA-IND-TCYA.
           MOVE SPACES                 TO PT-256-02-CYA-IND-TCYA.


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-256 TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      * 256  CAN,SCA
           PERFORM GNS-PRO-SYS.

           MOVE ZEROES TO QUE-NITM.

           MOVE ZEROES TO WSS-NITM-TSPT.

       CIC-GET-TR-256-0.

           ADD 1 TO QUE-NITM.

           MOVE QUE-NITM TO WSS-NITM-TSPT.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM TO WSS-TR
                MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)

                GO TO CIC-GET-TR-256-0.


           MOVE WSS-SND TO TP-256.

           MOVE 'TP-256'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'TP-256'               TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE TP-256                 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           MOVE 'GAST-256'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'GAST-256'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +100 TO QUE-LITM.

           MOVE TP-256-01-CAN-SGV-GAST TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE TP-256-01-RCV-SGV-CAPI-NUM TO
                TZ-256-01-RCV-SGV-CAPI-NUM.

           IF TP-256-STAT = '1'
                GO TO FIN-FORM-REQS.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


      * REQ 256 NO GENERA RESPUESTA
      *     PERFORM PUT-TR VARYING WSS-IDX-TR FROM 1 BY 1 UNTIL
      *       WSS-IDX-TR > WSS-NITM-TSPT.



      * 02.0 >>>>>>>>>>>>>>>>>>    256  CAN,SCA FIN  >>>>>>>>>>>>>>>>>>





      * 02.1 >>>>>>>>>>>>>>>>>>    256  CAN,SCA INI  >>>>>>>>>>>>>>>>>>


           MOVE SPACES TO PT-256.

           MOVE 'X' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-256-AHDR.

      *     MOVE PT-256-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-256-AHDR.

           MOVE '256'                  TO PT-256-CREQ.
           MOVE PT-A03-01-OPC-CAI-IOPC TO PT-256-01-CAN-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO PT-256-01-CAN-IIC-IOPC.

           MOVE WSS-CTE-PTT            TO PT-256-02-CAN-MSC-CANC.

           MOVE TP-729-01-OPC-COD-OFOC TO PT-256-02-CAN-COD-OFCA.



           MOVE TP-729-01-ITR-SGV-TINT-NUM TO
                WSS-EDT-0304.
           MOVE WSS-EDT-0304 TO
                PT-256-02-ICG-SGV-TINT.

           MOVE TZ-256-01-RCV-SGV-CAPI-NUM TO
                WSS-EDT-1204.
           MOVE WSS-EDT-1204 TO
                PT-256-02-CAN-SGV-TREN.

           MOVE WSS-COD-TCYA-CTBL      TO PT-256-02-CYA-IND-TCYA.
      *     MOVE SPACES                 TO PT-256-02-CYA-IND-TCYA.


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-256 TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      * 256  CAN,SCA
           PERFORM GNS-PRO-SYS.

           MOVE ZEROES TO QUE-NITM.

           MOVE ZEROES TO WSS-NITM-TSPT.

       CIC-GET-TR-256.

           ADD 1 TO QUE-NITM.

           MOVE QUE-NITM TO WSS-NITM-TSPT.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM TO WSS-TR
                MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)

                GO TO CIC-GET-TR-256.


           MOVE WSS-SND TO TP-256.

           MOVE 'TP-256'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'TP-256'               TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE TP-256                 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           MOVE 'GAST-256'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'GAST-256'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +100 TO QUE-LITM.

           MOVE TP-256-01-CAN-SGV-GAST TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF TP-256-STAT = '1'
                GO TO FIN-FORM-REQS.


           MOVE TP-256-01-CAN-SGV-TPAG-NUM TO
                TZ-256-01-CAN-SGV-TPAG-NUM.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


      * REQ 256 NO GENERA RESPUESTA
      *     PERFORM PUT-TR VARYING WSS-IDX-TR FROM 1 BY 1 UNTIL
      *       WSS-IDX-TR > WSS-NITM-TSPT.



      * 02.1 >>>>>>>>>>>>>>>>>>    256  CAN,SCA FIN  >>>>>>>>>>>>>>>>>>





      * 03 >>>>>>>>>>>>>>>>>>    038  CAN,ING INI  >>>>>>>>>>>>>>>>>>>>>


           MOVE SPACES TO PT-038.

           MOVE 'X' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-038-AHDR.

      *    MOVE PT-038-AHDR            TO WSS-HDR-038.
      *    MOVE '0'                    TO WSS-HDR-038-095-095.
      *    MOVE WSS-HDR-038            TO PT-038-AHDR.

      *     MOVE PT-038-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-038-AHDR.

           MOVE '038'                  TO PT-038-CREQ.
           MOVE PT-A03-01-OPC-CAI-IOPC TO PT-038-01-CAN-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO PT-038-01-CAN-IIC-IOPC.



           MOVE ZEROES                 TO PT-038-02-CAN-SGV-TPAG.

      *     COMPUTE PT-038-02-CAN-SGV-TPAG-NUM =
      *          TP-256-01-CAN-SGV-TREN-NUM -
      *          TP-256-01-RCV-SGV-CAPI-NUM.

      *     MOVE TP-256-01-CAN-SGV-TPAG TO PT-038-02-CAN-SGV-TPAG.
      *     IF PT-038-02-CAN-SGV-TPAG-NUM > ZEROES
            IF TZ-256-01-CAN-SGV-TPAG-NUM > ZEROES
               MOVE WSS-COD-TCYA-CCMA      TO PT-038-02-CYA-IND-TCYA
               MOVE PT-A03-01-CYA-CAI-ICYP TO PT-038-02-CYA-CAI-ICYA
               MOVE PT-A03-01-CYA-IIC-ICYP TO PT-038-02-CYA-IIC-ICYA.
      * CTACTE
                IF PT-A03-01-FRM-COD-SIMU = WSS-CTE-S
                     MOVE WSS-COD-TCYA-CTBL TO PT-038-02-CYA-IND-TCYA
                     MOVE SPACES            TO PT-038-02-CYA-CAI-ICYA
                     MOVE SPACES            TO PT-038-02-CYA-IIC-ICYA.

           MOVE WSS-CTE-PTT            TO PT-038-02-CAN-MSC-CANC.

           MOVE TP-729-01-OPC-COD-OFOC TO PT-038-02-CAN-COD-OFCA.
      *    MOVE TP-729-01-ITR-SGV-TINT-NUM TO
      *         PT-038-02-ICG-SGV-TINT-NUM.

           MOVE TP-729-01-ITR-SGV-TINT-NUM TO
                WSS-EDT-0304.
           MOVE WSS-EDT-0304 TO
                PT-038-02-ICG-SGV-TINT.


           MOVE TZ-256-01-CAN-SGV-TPAG-NUM TO
                WSS-EDT-1204.
           MOVE WSS-EDT-1204 TO
                PT-038-02-CAN-SGV-TPAG-NUM.

           MOVE 'CAN-TPAG'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'CAN-TPAG'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE PT-038-02-CAN-SGV-TPAG TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-038 TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      * 038  CAN,ING
           PERFORM GNS-PRO-SYS.

           MOVE ZEROES TO QUE-NITM.

           MOVE ZEROES TO WSS-NITM-TSPT.

       CIC-GET-TR-038.

           ADD 1 TO QUE-NITM.

           MOVE QUE-NITM TO WSS-NITM-TSPT.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM TO WSS-TR
                MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)

                GO TO CIC-GET-TR-038.


           MOVE WSS-SND TO TP-038.

           MOVE 'TP-038'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'TP-038'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE TP-038 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF TP-038-STAT = '1'
                GO TO FIN-FORM-REQS.



           MOVE 'TP-038'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'TP-038'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE TP-038 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

      *    PERFORM VAL-NUM-TP-REQ-038.

      * Complemento condicional de input segun inyeccion

      *     IF PT-A03-01-CAN-COD-OFCA NOT > SPACES
      *          MOVE PT-A03-01-CAN-COD-OFCA TO
      *               PT-A03-01-OPC-COD-OFOC.

      * Complemento incondicional de inut segun consulta OPC

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


      * REQ 038 NO GENERA RESPUESTA
      *     PERFORM PUT-TR VARYING WSS-IDX-TR FROM 1 BY 1 UNTIL
      *       WSS-IDX-TR > WSS-NITM-TSPT.


      * 03 >>>>>>>>>>>>>>>>>>    038  CAN,ING FIN  >>>>>>>>>>>>>>>>>>>>>

      * 04 >>>>>>>>>>>>>>>>>>    018  CYA,ING INI  >>>>>>>>>>>>>>>>>>>>>


           IF WSS-IND-GOCON = 'S'
                GO TO COL-CAN-CON.


      *     IF TP-256-01-CAN-SGV-GAST-NUM NOT > ZEROES
      *         MOVE 2500 TO TP-256-01-CAN-SGV-GAST-NUM.
      *        GO TO FIN-GET-TR-018.

           MOVE SPACES TO PT-018.

           MOVE 'X' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-018-AHDR.

      *     MOVE PT-018-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-018-AHDR.

           MOVE '018'                  TO PT-018-CREQ.
           MOVE PT-A03-01-OPC-CAI-IOPC TO PT-018-01-CYA-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO PT-018-01-CYA-IIC-IOPC.
           MOVE TP-256-01-CAN-NUM-ICAN TO PT-018-01-CYA-NUM-ICAN.

           MOVE 'CAJA'                 TO PT-018-02-CYA-IND-TCYA.
           MOVE TP-256-01-CAN-SGV-GAST TO PT-018-02-FRM-VAL-VPES.




           MOVE 'PT-018'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PT-018'               TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE PT-018                 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-018 TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      * 018  CYA,ING
           PERFORM GNS-PRO-SYS.

           MOVE ZEROES TO QUE-NITM.

           MOVE ZEROES TO WSS-NITM-TSPT.

       CIC-GET-TR-018.

           ADD 1 TO QUE-NITM.

           MOVE QUE-NITM TO WSS-NITM-TSPT.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM TO WSS-TR
                MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)

                GO TO CIC-GET-TR-018.


           MOVE WSS-SND TO TP-018.

           MOVE 'TP-018'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'TP-018'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE TP-018 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF TP-018-STAT = '1'
                GO TO FIN-FORM-REQS.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-GET-TR-018.



      * 04 >>>>>>>>>>>>>>>>>>    018  CYA,ING FIN  >>>>>>>>>>>>>>>>>>>>>



      * 05 >>>>>>>>>>>>>>>>>>    043  CAN,VRF INI  >>>>>>>>>>>>>>>>>>>>>


           MOVE SPACES TO PT-043.

           MOVE 'X' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-043-AHDR.

      *     MOVE PT-043-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-043-AHDR.

           MOVE '043'                  TO PT-043-CREQ.
           MOVE PT-A03-01-OPC-CAI-IOPC TO PT-043-01-CAN-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO PT-043-01-CAN-IIC-IOPC.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-043 TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      * 043  CAN,VRF ( CAN )
           PERFORM GNS-PRO-SYS.

           MOVE ZEROES TO QUE-NITM.

           MOVE ZEROES TO WSS-NITM-TSPT.

       CIC-GET-TR-043.

           ADD 1 TO QUE-NITM.

           MOVE QUE-NITM TO WSS-NITM-TSPT.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM TO WSS-TR
                MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)

                GO TO CIC-GET-TR-043.


           MOVE WSS-SND TO TP-043.

           MOVE 'TP-043'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'TP-043'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE TP-043 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF TP-043-STAT = '1'
                GO TO FIN-FORM-REQS.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-GET-TR-043.



      * 05 >>>>>>>>>>>>>>>>>>    043  CAN,VRF FIN  >>>>>>>>>>>>>>>>>>>>>


       COL-CAN-CON.


      * 06 >>>>>>>>>>>>>>>>>>    037  CAN,CON INI  >>>>>>>>>>>>>>>>>>>>>
      * Obtiene numero de OPC asignada


           MOVE SPACES TO PT-037.

           MOVE 'X' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-037-AHDR.

      *     MOVE PT-037-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-037-AHDR.

           MOVE '037'                  TO PT-037-CREQ.
           MOVE PT-A03-01-OPC-CAI-IOPC TO PT-037-01-CAN-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO PT-037-01-CAN-IIC-IOPC.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-037 TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      * 037  CAN,CON
           PERFORM GNS-PRO-SYS.

           MOVE ZEROES TO QUE-NITM.

           MOVE ZEROES TO WSS-NITM-TSPT.

       CIC-GET-TR-037.

           ADD 1 TO QUE-NITM.

           MOVE QUE-NITM TO WSS-NITM-TSPT.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM TO WSS-TR
                MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)

                GO TO CIC-GET-TR-037.


           MOVE WSS-SND TO TP-037.


           MOVE 'TP-037'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'TP-037'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE TP-037 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.



           IF TP-037-STAT = '1'
                GO TO FIN-FORM-REQS.



           MOVE TP-037-01-CAN-SGV-TREN-NUM TO
                PT-A03-01-OPC-VAL-CRED-NUM.

           MOVE TS-TPAG TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE TS-TPAG TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE WSS-CTE-LENTR-20 TO QUE-LITM.
           MOVE TP-037-01-CAN-SGV-TPAG TO QUE-ITEM.
           PERFORM GNS-PRO-QUE.



      * 06 >>>>>>>>>>>>>>>>>>    037  CAN,CON FIN  >>>>>>>>>>>>>>>>>>>>>



      * 07 >>>>>>>>>>>>>>>>>>    046  OPC,ING INI  >>>>>>>>>>>>>>>>>>>>>


           MOVE 'GIDD'       TO RCC-QUEU.
           MOVE TSK-TERM-ALF TO RCC-TERM.

           MOVE RCC-QIDD TO QUE-COLA.
           MOVE +490 TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
                 MOVE RCC-QIDD TO QUE-COLA
                 MOVE +490 TO QUE-LITM
                 MOVE IDD-REGI TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 PERFORM GNS-PRO-QUE.


           MOVE 'K' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-046-AHDR.

      *     MOVE PT-046-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-046-AHDR.

           MOVE '046'                  TO PT-046-CREQ.
           MOVE TP-037-01-ROV-CAI-IOPC TO PT-046-01-OPC-CAI-IOPC.
           MOVE TP-037-01-ROV-IIC-IOPC TO PT-046-01-OPC-IIC-IOPC.
           MOVE PT-A03-01-OPC-COD-VCOC TO PT-046-01-OPC-COD-VCOC.
           MOVE PT-A03-01-OPC-COD-TOOC TO PT-046-01-OPC-COD-TOOC.
           MOVE PT-A03-01-OPC-COD-AOOC TO PT-046-01-OPC-COD-AOOC.
           MOVE PT-A03-01-OPC-COD-OFOC TO PT-046-02-OPC-COD-OFOC.
           MOVE PT-A03-01-DBC-NUM-ICLI TO PT-046-02-DBC-NUM-ICLI.
           MOVE PT-A03-01-DBC-VRF-ICLI TO PT-046-02-DBC-VRF-ICLI.
           MOVE PT-A03-01-DBC-IND-ICLI TO PT-046-02-DBC-IND-ICLI.
           MOVE PT-A03-01-DBC-GLS-ICLI TO PT-046-02-DBC-GLS-ICLI.




           IF PT-A03-01-CYA-IIC-ICYG-NUM > ZEROES
                MOVE WSS-COD-TCYA-CCMA      TO PT-046-02-CYA-IND-TCYA
                MOVE WSS-CTE-AUT            TO PT-046-02-AUT-NUM-ICAN
                MOVE WSS-CTE-S              TO PT-046-02-AUT-MSC-STAT
                MOVE PT-A03-01-CYA-CAI-ICYG TO PT-046-02-AUT-CAI-ICYA
                MOVE PT-A03-01-CYA-IIC-ICYG TO PT-046-02-AUT-IIC-ICYA
                MOVE PT-A03-01-CYA-CAI-ICYG TO PT-046-02-CYA-CAI-ICYA
                MOVE PT-A03-01-CYA-IIC-ICYG TO PT-046-02-CYA-IIC-ICYA.

           IF PT-A03-01-FRM-COD-SIMU = WSS-CTE-SIMU-S
                MOVE WSS-COD-TCYA-CTBL TO PT-046-02-CYA-IND-TCYA
                MOVE SPACES TO PT-046-02-CYA-CAI-ICYA
                MOVE SPACES TO PT-046-02-CYA-IIC-ICYA
                MOVE SPACES TO PT-046-02-AUT-NUM-ICAN
                MOVE SPACES TO PT-046-02-AUT-MSC-STAT
                MOVE SPACES TO PT-046-02-AUT-CAI-ICYA
                MOVE SPACES TO PT-046-02-AUT-IIC-ICYA.


           MOVE 'PT-046'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PT-046'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +1000 TO QUE-LITM.

           MOVE PT-046 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




           PERFORM PRO-24H-INP.

           MOVE PT-A03-01-NOP-FEC-FCUR TO PT-046-02-OPC-FEC-FCOL.

      *     MOVE PT-A03-01-OPC-VAL-CRED
      *                                 TO PT-046-02-OPC-VAL-CRED-NUM.

      *     MOVE PT-A03-01-OPC-VAL-CRED-NUM
      *                                 TO PT-046-02-OPC-VAL-CRED-NUM.
      * 655321     -->> 655.321,0000


           MOVE PT-A03-01-OPC-VAL-CRED
                                       TO PT-046-02-OPC-VAL-CRED.
      * 653321     -->> 653.321,0000

           MOVE PT-A03-01-ITR-SGV-TINT TO PT-046-02-ITR-SGV-TINT.


           MOVE 'SGV-TINT'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.

           MOVE PT-046-02-ITR-SGV-TINT TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.





           MOVE PT-A03-01-OPC-COD-RMOC TO PT-046-02-OPC-COD-RMOC.

      * ACA DEBE BUSCAR CTA CTE

      *    IF  PT-A03-01-OPC-COD-SEGD NOT > SPACES
      *           MOVE WSS-IND-SEGD TO PT-A03-01-OPC-COD-SEGD.

      *     IF  PT-A03-01-OPC-COD-CVTA NOT > SPACES
      *            MOVE WSS-IND-CVTA TO PT-A03-01-OPC-COD-CVTA.

      *      IF  PT-A03-01-OPC-IND-GARA NOT > SPACES
      *            MOVE WSS-IND-GARA TO PT-A03-01-OPC-IND-GARA.

      *     IF  PT-A03-01-OPC-COD-CDOC NOT > SPACES
      *            MOVE WSS-IND-CDOC TO PT-A03-01-OPC-COD-CDOC.

      *     MOVE PT-A03-01-OPC-COD-SEGD TO PT-046-02-OPC-COD-SEGD.
      *     MOVE PT-A03-01-OPC-COD-CVTA TO PT-046-02-OPC-COD-CVTA.
      *     MOVE PT-A03-01-OPC-IND-GARA TO PT-046-02-OPC-IND-GARA.
      *     MOVE PT-A03-01-OPC-COD-CDOC TO PT-046-02-OPC-COD-CDOC.

           MOVE WSS-IND-SEGD TO PT-046-02-OPC-COD-SEGD.
           MOVE WSS-IND-CVTA TO PT-046-02-OPC-COD-CVTA.
           MOVE WSS-IND-GARA TO PT-046-02-OPC-IND-GARA.
           MOVE WSS-IND-CDOC TO PT-046-02-OPC-COD-CDOC.


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-046 TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.



      *>>>>>>>>>>>>>>>>>>    013   >>>>>>>>>>>>>>>>>>>>>>>>

           MOVE 'E' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-013-AHDR.
           MOVE '013'                  TO PT-013-CREQ.


      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-013  TO WSS-TR-COD-DATA.
           MOVE WSS-TR  TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *>>>>>>>>>>>>>>>>>>    016-01-FO >>>>>>>>>>>>>>>>>>>>>>>>


           MOVE 'E' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-016-AHDR.
           MOVE '016'                  TO PT-016-CREQ.



      *    ADD WSS-NUM-NRNP TO PT-A03-01-NOP-NUM-VIGU-NUM.

           MOVE PT-A03-01-NOP-NUM-VIGU TO PT-016-02-EVC-NUM-VIGU.
           MOVE PT-A03-01-NOP-NUM-SPVE TO PT-016-02-FRM-NUM-SPVE.
           MOVE PT-A03-01-NOP-IND-UTPV TO PT-016-02-FRM-IND-UTPV.
           MOVE PT-A03-01-NOP-NUM-SEVE TO PT-016-02-EVC-NUM-SEVE.
           MOVE PT-A03-01-NOP-IND-UTSV TO PT-016-02-EVC-IND-UTSV.
           MOVE PT-A03-01-NOP-FEC-FPVC TO PT-016-02-EVC-FEC-FPVC.



      * ACA DEBE .......

           MOVE WSS-CTE-TCVE-FO-O-CO TO PT-016-02-EVC-MSC-TCVE.
           MOVE WSS-CTE-001          TO PT-016-02-EVC-NUM-IDLC-NUM.


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-016             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      *>>>>>>>>>>>>>>>>>>    016-nn-NP >>>>>>>>>>>>>>>>>>>>>>>>

           MOVE ZEROES TO WSS-IDX-IGNP.


       CIC-GNP.

           ADD 1 TO WSS-IDX-IGNP.

           IF NOP-CIC-IPVC-R IN EVC-VARI(WSS-IDX-IGNP) > SPACES

                MOVE SPACES TO PT-016

                MOVE 'E' TO WSS-TR-COD-SGMT

                MOVE PT-A03-AHDR            TO PT-016-AHDR
                MOVE '016'                  TO PT-016-CREQ

                MOVE NOP-CIC-IPVC-R IN EVC-VARI(WSS-IDX-IGNP) TO
                     PT-016-01-PVC-CIC-IPVC

                MOVE NOP-NUM-TVCT   IN EVC-VARI(WSS-IDX-IGNP) TO
                     PT-016-02-EVC-NUM-VIGU

                MOVE NOP-FEC-1VCT IN EVC-VARI(WSS-IDX-IGNP)  TO
                     PT-016-02-EVC-FEC-FPVC

                MOVE NOP-NUM-DPVE-R IN EVC-VARI(WSS-IDX-IGNP) TO
                     PT-016-02-EVC-NUM-DPVE

                MOVE NOP-MSC-TCVE-R IN EVC-VARI(WSS-IDX-IGNP) TO
                     PT-016-02-EVC-MSC-TCVE

                MOVE '001'                                    TO
                      PT-016-02-EVC-NUM-IDLC

                MOVE NOP-NUM-SEVE-R IN EVC-VARI(WSS-IDX-IGNP) TO
                     PT-016-02-EVC-NUM-SEVE

                MOVE NOP-IND-UTSV-R IN EVC-VARI(WSS-IDX-IGNP) TO
                     PT-016-02-EVC-IND-UTSV

      * ACA DEBE .......

                MOVE WSS-QUE-TR-COLA TO QUE-COLA

                MOVE PT-016             TO WSS-TR-COD-DATA
                MOVE WSS-TR             TO QUE-ITEM

                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO CIC-GNP.

      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = INT >>>>>>>>>>>>>>>>>>>>


       INI-ROC-INT.

           MOVE SPACES TO PT-101.

           MOVE 'E' TO WSS-TR-COD-SGMT

           MOVE PT-A03-AHDR            TO PT-101-AHDR
           MOVE '101'                  TO PT-101-CREQ

           MOVE SPACES         TO RCC-CIC-IOPE IN RCC-VARI.
           MOVE SPACES         TO RCC-IDC-ICLI IN RCC-VARI.

           MOVE PT-A03-01-DBC-NUM-ICLI TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-VRF-ICLI TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-IND-ICLI TO RCC-IND-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-GLS-ICLI TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE SPACES                 TO RCC-IND-RTBL IN RCC-VARI.
           MOVE ZEROES                 TO RCC-IND-COMP IN RCC-VARI.
           MOVE  PT-A03-AHDR           TO WSS-HDR.

      *    MOVE '110'                  TO RCC-COD-TCNL IN RCC-VARI.
           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.
           MOVE WSS-HDR-TIPC-02        TO RCC-COD-TCNL IN RCC-VARI.

           MOVE SPACES                 TO RCC-COD-CNAL IN RCC-VARI.

           IF RCC-COD-TCNL IN RCC-VARI = WSS-CTE-110
                MOVE ZEROES TO RCC-COD-CNAL IN RCC-VARI
           ELSE
                MOVE WSS-CTE-010 TO RCC-COD-TCNL IN RCC-VARI
                MOVE PT-A03-01-OPC-COD-OFOC TO
                            RCC-COD-CNAL IN RCC-VARI.

           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCOC IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-TOOC TO RCC-COD-TOOC IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-AOOC TO RCC-COD-AOOC IN RCC-VARI.
           MOVE WSS-TOT-DIA            TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE 'D'                    TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE 'CUR'                  TO RCC-COD-EVEN IN RCC-VARI.
           MOVE 'INT'                  TO RCC-COD-CPTO IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-TCAR IN RCC-VARI.
           MOVE PT-A03-01-OPC-VAL-CRED-NUM TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCMO IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-VSOP IN RCC-VARI.
           MOVE PT-A03-01-NOP-NUM-VIGU-NUM TO RCC-VAL-FINA IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCFN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-INTE IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-VASG IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCVA IN RCC-VARI.


           MOVE PT-A03-01-NOP-FEC-FCUR TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FCOL IN RCC-VARI.


           MOVE PT-A03-01-NOP-FEC-FPVC TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FVEN IN RCC-VARI.



           MOVE 'CON'                  TO RCC-COD-TCON IN RCC-VARI.
           MOVE 'S'                    TO RCC-OFRM-SRV IN RCC-VARI.
           MOVE FIO-MSFL               TO RCC-MSFL     IN RCC-VARI.


           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


           MOVE 'RCC-INP'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RCC-INP'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           MOVE 'INT'    TO QUE-IKEY.
           MOVE RCC-VARI TO QUE-DATA.


           PERFORM GNX-PRO-QUE.

           MOVE +490       TO RCC-LIDD.

           MOVE RCC-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
      *     LINK TABPSRCC RCC-COD-CPTO = INT
           MOVE 'TABPSRCC' TO SYS-PROG.
           MOVE RCC-TCMA   TO SYS-TCMA.
      * RCC-COD-CPTO = INT
           PERFORM GNS-PRO-SYS.

           MOVE SYS-CMMA TO RCC-CMMA.
           MOVE RCC-MSFL TO FIO-MSFL.

           MOVE 'RCC-OUT'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RCC-OUT'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           MOVE 'INT'    TO QUE-IKEY.
           MOVE RCC-VARI TO QUE-DATA.


           PERFORM GNX-PRO-QUE.


           MOVE ZEROES TO QUE-NITM.

       CIC-ROC-INT-QUE.

           ADD 1 TO QUE-NITM.

           MOVE ZEROES TO WSS-IDX-IROC.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.

           MOVE QUE-GET TO QUE-CMND.
           MOVE RCC-LEN-TSSGS TO QUE-LITM.
           PERFORM GNS-PRO-QUE.

           IF QUE-STAT NOT = QUE-STAT-OKS
               GO TO INI-ROC-SGS-MC2.

           MOVE QUE-ITEM TO OSG-APL-VEC IN OSG-VARI(1).

       CIC-ROC-INT-OCC.

           ADD 1 TO WSS-IDX-IROC.

           IF OSG-SGS-COD-SIST IN OSG-VARI(WSS-IDX-IROC) NOT > SPACES
               GO TO CIC-ROC-INT-QUE.

           MOVE SPACES TO PT-101-01-ROC-CAI-IOPC.

           MOVE SPACES TO PT-101-01-ROC-IIC-IOPC.

           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE    OSG-SGS-COD-SIST IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-SIST.

           MOVE    OSG-SGS-COD-EVEN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-EVEN.


           MOVE    OSG-SGS-COD-EVEN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-EVEN.


           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE    OSG-SGS-COD-CPTO IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-CPTO.

           MOVE SPACES TO PT-101-02-ROC-COD-SCPT.

           MOVE SPACES TO PT-101-02-ROC-COD-MODL.

           MOVE    OSG-SGS-COD-OCOB IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-OCOB.


           MOVE    OSG-SGS-CAI-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-CAI-PLAN.

           MOVE    OSG-SGS-IIC-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-IIC-PLAN.

           MOVE    OSG-SGS-IND-TPLN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-IND-TPLT.

           MOVE    OSG-SGS-COD-MONE IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-VCOC.

           MOVE     OSG-SGS-FEC-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
                    WSS-FEC-FAMD.

           MOVE
            WSS-NUM-SAMD TO
            WSS-NUM-SDMA.

           MOVE
            WSS-NUM-AAMD TO
            WSS-NUM-ADMA.

           MOVE
            WSS-NUM-MAMD TO
            WSS-NUM-MDMA.

           MOVE
            WSS-NUM-DAMD TO
            WSS-NUM-DDMA.

           MOVE     WSS-FEC-FDMA TO
              PT-101-02-ROC-FEC-PLAN.

           MOVE     OSG-SGS-HRA-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-HRA-PLAN.

           MOVE 'S' TO PT-101-02-ROC-IND-VIGE.

           MOVE SPACES TO PT-101-02-ROC-COD-ANUL.

           MOVE SPACES TO PT-101-02-ROC-FEC-FUNO.

           MOVE     OSG-SGS-IIC-IRCC IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-NUM-ADIC.

           MOVE     OSG-SGS-CAI-IRCC IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-VRF-ADIC.


           MOVE SPACES TO PT-101-02-ROC-FEC-FDOS.

           IF PT-A03-01-FRM-IND-TINT = WSS-FRM-IND-TINT-I
                IF PT-101-02-ROC-IND-TPLT = WSS-CTE-PORC
                    MOVE ZEROES TO
                    PT-101-02-ROC-SGV-TCAL-NUM
                ELSE
                    MOVE PT-A03-01-ITR-SGV-TINT-NUM TO
                    PT-101-02-ROC-SGV-TCAL-NUM
           ELSE
               IF PT-101-02-ROC-IND-TPLT = WSS-CTE-P
                   MOVE OSG-OCI-VAL-PPRO IN OSG-VARI(WSS-IDX-IROC) TO
                   PT-101-02-ROC-SGV-TCAL-NUM
               ELSE
               IF PT-101-02-ROC-IND-TPLT = WSS-CTE-PORC
                   MOVE OSG-SGS-VAL-MNTO IN OSG-VARI(WSS-IDX-IROC) TO
                   PT-101-02-ROC-SGV-TCAL-NUM.

           MOVE      OSG-SGS-MSC-BCTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-BCTI.

           MOVE      OSG-SGS-MSC-PBTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-PBTI.

           MOVE      OSG-SGS-MSC-BPBT IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-BPBT.

           MOVE      OSG-SGS-MSC-SPBT IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-SPBT.


           MOVE ZEROES TO PT-101-02-ROC-SGV-TINF-NUM.
           MOVE OSG-SGS-SGV-TAMO IN OSG-VARI(WSS-IDX-IROC) TO
                PT-101-02-ROC-SGV-TINF-NUM

           MOVE      OSG-SGS-COD-CVTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-COD-CVTI.

           MOVE      OSG-SGS-MSC-TFPR IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-TFPR.

           MOVE      OSG-SGS-NUM-PREP IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-NUM-PREP.


           MOVE      OSG-SGS-MSC-UTPR IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-UTPR.

           MOVE      OSG-SGS-SGV-CSTF IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-SGV-CFON-NUM.

           MOVE      OSG-SGS-VAL-FRIE IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-SGV-FRIE-NUM.

      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           IF PT-101-02-ROC-IND-TPLT = WSS-CTE-P AND
              PT-A03-01-FRM-IND-TINT = WSS-FRM-IND-TINT-I

                 MOVE 'RCC-N1'              TO QUE-COLA
                 MOVE QUE-DEL                TO QUE-CMND
                 PERFORM GNX-PRO-QUE

                 MOVE 'RCC-N1'              TO QUE-COLA
                 MOVE  PT-101 TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 MOVE +3000 TO QUE-LITM

                 PERFORM PUT-ROC-N.


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.


           IF PT-101-02-ROC-IND-TPLT = WSS-CTE-PORC AND
              PT-A03-01-FRM-IND-TINT = WSS-FRM-IND-TINT-I

                 MOVE WSS-CTE-N TO PT-101-02-ROC-IND-VIGE.

           MOVE PT-101             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

      *     IF PT-101-02-ROC-IND-TPLT = WSS-CTE-PORC AND
      *        PT-A03-01-FRM-IND-TINT = WSS-FRM-IND-TINT-I
      *           GO TO CIC-ROC-INT-OCC.

           PERFORM GNS-PRO-QUE.

           GO TO CIC-ROC-INT-OCC.

      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = SGS-MC2 >>>>>>>>>>>>>>>>>>


       INI-ROC-SGS-MC2.


           MOVE 'IND-SGRS'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +10 TO QUE-LITM.

           MOVE PT-A03-01-FRM-IND-SGRS TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


            IF PT-A03-01-FRM-IND-SGRS = WSS-IND-SGRS-H
                  GO TO INI-ROC-SGS-OPC.

           MOVE SPACES TO PT-101.

           MOVE 'E' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-101-AHDR.
           MOVE '101'                  TO PT-101-CREQ.

           MOVE SPACES         TO RCC-CIC-IOPE IN RCC-VARI.
           MOVE SPACES         TO RCC-IDC-ICLI IN RCC-VARI.

           MOVE PT-A03-01-DBC-NUM-ICLI TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-VRF-ICLI TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-IND-ICLI TO RCC-IND-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-GLS-ICLI TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE SPACES                 TO RCC-IND-RTBL IN RCC-VARI.
           MOVE ZEROES                 TO RCC-IND-COMP IN RCC-VARI.
           MOVE  PT-A03-AHDR           TO WSS-HDR.

      *    MOVE '110'                  TO RCC-COD-TCNL IN RCC-VARI.
           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.
           MOVE WSS-HDR-TIPC-02        TO RCC-COD-TCNL IN RCC-VARI.



           MOVE SPACES                 TO RCC-COD-CNAL IN RCC-VARI.

           IF RCC-COD-TCNL IN RCC-VARI = WSS-CTE-110
                MOVE ZEROES TO RCC-COD-CNAL IN RCC-VARI
           ELSE
                MOVE WSS-CTE-010 TO RCC-COD-TCNL IN RCC-VARI
                MOVE PT-A03-01-OPC-COD-OFOC TO
                            RCC-COD-CNAL IN RCC-VARI.

           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCOC IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-TOOC TO RCC-COD-TOOC IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-AOOC TO RCC-COD-AOOC IN RCC-VARI.
           MOVE WSS-TOT-DIA            TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE 'D'                    TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE 'CUR'                  TO RCC-COD-EVEN IN RCC-VARI.
           MOVE 'SGS'                  TO RCC-COD-CPTO IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-TCAR IN RCC-VARI.
           MOVE PT-A03-01-OPC-VAL-CRED-NUM TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCMO IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-VSOP IN RCC-VARI.
           MOVE PT-A03-01-NOP-NUM-VIGU-NUM TO RCC-VAL-FINA IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCFN IN RCC-VARI.
      * RUT AUXILIAR
           MOVE WSS-NUM-RAUX           TO RCC-VAL-INTE IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-VASG IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCVA IN RCC-VARI.


           MOVE PT-A03-01-NOP-FEC-FCUR TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FCOL IN RCC-VARI.


           MOVE PT-A03-01-NOP-FEC-FPVC TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FVEN IN RCC-VARI.


           MOVE 'CON'                  TO RCC-COD-TCON IN RCC-VARI.
           MOVE 'S'                    TO RCC-OFRM-SRV IN RCC-VARI.
           MOVE FIO-MSFL               TO RCC-MSFL     IN RCC-VARI.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


           MOVE 'RCC-INP'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RCC-INP'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           MOVE 'SGS'    TO QUE-IKEY.
           MOVE RCC-VARI TO QUE-DATA.


           PERFORM GNX-PRO-QUE.

           MOVE +490       TO RCC-LIDD.

           MOVE RCC-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
      *     LINK TABPSRCC RCC-COD-CPTO = SGS
           MOVE 'TABPSRCC' TO SYS-PROG.
           MOVE RCC-TCMA   TO SYS-TCMA.
      * RCC-COD-CPTO = SGS-MC2
           PERFORM GNS-PRO-SYS.

           MOVE SYS-CMMA TO RCC-CMMA.
           MOVE RCC-MSFL TO FIO-MSFL.

           MOVE 'RCC-OUT'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RCC-OUT'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           MOVE 'SGS'    TO QUE-IKEY.
           MOVE RCC-VARI TO QUE-DATA.


           PERFORM GNX-PRO-QUE.

           MOVE ZEROES TO QUE-NITM.

       CIC-ROC-SGS-MC2-QUE.

           ADD 1 TO QUE-NITM.

           MOVE ZEROES TO WSS-IDX-IROC.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.

           MOVE QUE-GET TO QUE-CMND.
           MOVE RCC-LEN-TSSGS TO QUE-LITM.
           PERFORM GNS-PRO-QUE.

           IF QUE-STAT NOT = QUE-STAT-OKS
               GO TO INI-ROC-CGN.

           MOVE QUE-ITEM TO OSG-APL-VEC IN OSG-VARI(1).

       CIC-ROC-SGS-MC2-OCC.

           ADD 1 TO WSS-IDX-IROC.

           IF OSG-SGS-COD-SIST IN OSG-VARI(WSS-IDX-IROC) NOT > SPACES
               GO TO CIC-ROC-SGS-MC2-QUE.

           MOVE SPACES TO PT-101-01-ROC-CAI-IOPC.

           MOVE SPACES TO PT-101-01-ROC-IIC-IOPC.

           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE    OSG-SGS-COD-SIST IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-SIST.

           MOVE    OSG-SGS-COD-EVEN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-EVEN.


           MOVE    OSG-SGS-COD-EVEN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-EVEN.


           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.



           MOVE 'CPTO0'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'CPTO0'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE  OSG-APL-VEC IN OSG-VARI(1) TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'CPTO1'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'CPTO1'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE  OSG-SGS-COD-TSEG IN OSG-VARI(WSS-IDX-IROC)
               TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE ZEROES TO PT-101-01-ROC-NUM-IROC-NUM.

           MOVE    'SGS' TO
             PT-101-02-ROC-COD-CPTO.


           MOVE    OSG-SGS-COD-TSEG IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-SCPT.



           MOVE    OSG-SGS-COD-SEGU  IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-MODL.

           MOVE    OSG-SGS-COD-OCOB IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-OCOB.

           MOVE    OSG-SGS-CAI-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-CAI-PLAN.

           MOVE    OSG-SGS-IIC-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-IIC-PLAN.

           MOVE    OSG-SGS-IND-TPLN  IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-IND-TPLT.

           MOVE    OSG-SGS-COD-MONE IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-VCOC.


           MOVE     OSG-SGS-FEC-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
                    WSS-FEC-FAMD.

           MOVE
            WSS-NUM-SAMD TO
            WSS-NUM-SDMA.

           MOVE
            WSS-NUM-AAMD TO
            WSS-NUM-ADMA.

           MOVE
            WSS-NUM-MAMD TO
            WSS-NUM-MDMA.

           MOVE
            WSS-NUM-DAMD TO
            WSS-NUM-DDMA.

           MOVE     WSS-FEC-FDMA TO
              PT-101-02-ROC-FEC-PLAN.


           MOVE     OSG-SGS-HRA-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-HRA-PLAN.

           MOVE 'S' TO PT-101-02-ROC-IND-VIGE.

      * BUSCA SGS PROPUESTO ENTRE LOS INPUT PARA GRABAR ROC 'S' O 'N'

           MOVE 'N' TO WSS-SGS-PPT-ENC.

           PERFORM BUS-SGS-PPT VARYING WSS-IDX-SGS-PPT
                        FROM 1 BY 1 UNTIL
                        WSS-IDX-SGS-PPT > WSS-SGS-INP-TOT.

           IF WSS-SGS-PPT-ENC = 'N'
                MOVE 'N' TO PT-101-02-ROC-IND-VIGE.

           MOVE SPACES TO PT-101-02-ROC-COD-ANUL.

           MOVE SPACES TO PT-101-02-ROC-FEC-FUNO.

           MOVE     OSG-SGS-IIC-IRCC IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-NUM-ADIC.

           MOVE     OSG-SGS-CAI-IRCC IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-VRF-ADIC.

           MOVE SPACES TO PT-101-02-ROC-FEC-FDOS.

           MOVE     OSG-SGS-SGV-TAMO IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-SGV-TCAL-NUM.

           MOVE      OSG-SGS-MSC-BCTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-BCTI.

           MOVE      OSG-SGS-MSC-PBTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-PBTI.

           MOVE      OSG-SGS-MSC-BPBT IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-BPBT.

           MOVE      OSG-SGS-MSC-SPBT IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-SPBT.

           MOVE ZEROES TO PT-101-02-ROC-SGV-TINF-NUM.

           MOVE      OSG-SGS-COD-CVTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-COD-CVTI.

           MOVE      OSG-SGS-MSC-TFPR IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-TFPR.

           MOVE      OSG-SGS-NUM-PREP IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-NUM-PREP.


           MOVE      OSG-SGS-MSC-UTPR IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-UTPR.

           MOVE      OSG-SGS-SGV-CSTF IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-SGV-CFON-NUM.

           MOVE      OSG-SGS-VAL-FRIE IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-SGV-FRIE-NUM.

           ADD 1 TO WSS-IDX-TROC.


           MOVE PT-101-02-ROC-COD-SCPT TO
               WSS-SGS-PPT-ELM IN WSS-SGS-PPT-TBL( WSS-IDX-TROC ).



           MOVE 'PPT-01'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PPT-01'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE WSS-IDX-TROC   TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'PPT-02'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PPT-02'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE PT-101-02-ROC-COD-SCPT TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-101             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           GO TO CIC-ROC-SGS-MC2-OCC.









      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = SGS-OPC >>>>>>>>>>>>>>>>>>


       INI-ROC-SGS-OPC.


           MOVE SPACES TO PT-101.

           MOVE 'E' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-101-AHDR.
           MOVE '101'                  TO PT-101-CREQ.

           MOVE  PT-A03-AHDR           TO WSS-HDR.

      *    MOVE '110'                  TO RCC-COD-TCNL IN RCC-VARI.
           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.

           MOVE ZEROES TO QUE-NITM.

           MOVE SPACES TO ROC.

           MOVE PT-A03-01-OPC-CAI-IOPC TO ROC-CAI-IOPC IN ROC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO ROC-IIC-IOPC IN ROC.


           MOVE 'KEY-ROC'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE QUE-PUT TO QUE-CMND.
           MOVE ROC TO QUE-ITEM.
           MOVE +100 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.

           MOVE FIO-GET-NLS TO FIO-CMND.

       CIC-ROC-SGS-OPC-QUE.


           PERFORM MC2-FIO-ROC.

           MOVE 'LEE-ROC'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.


           MOVE QUE-PUT TO QUE-CMND.
           MOVE ROC TO QUE-ITEM.
           MOVE +100 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           IF NOT
                ( FIO-STAT-OKS AND
                  PT-A03-01-OPC-CAI-IOPC = ROC-CAI-IOPC IN ROC AND
                  PT-A03-01-OPC-IIC-IOPC = ROC-IIC-IOPC IN ROC
                 )


                  MOVE 'SEL-ROC'             TO QUE-COLA
                  MOVE QUE-DEL               TO QUE-CMND
                  PERFORM GNX-PRO-QUE

                  MOVE QUE-PUT TO QUE-CMND
                  MOVE ROC TO QUE-ITEM
                  MOVE +100 TO QUE-LITM
                  PERFORM GNX-PRO-QUE

                 GO TO INI-ROC-CGN.




       CIC-ROC-SGS-OPC-OCC.

           ADD 1 TO WSS-IDX-IROC.


           IF ROC-COD-CPTO IN ROC NOT = 'SGS'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO CIC-ROC-SGS-OPC-QUE.

           MOVE SPACES TO PT-101-01-ROC-CAI-IOPC.

           MOVE SPACES TO PT-101-01-ROC-IIC-IOPC.

           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE        ROC-COD-SIST IN ROC TO
             PT-101-01-ROC-COD-SIST.

           MOVE        ROC-COD-EVEN IN ROC TO
             PT-101-01-ROC-COD-EVEN.


           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.


           MOVE ZEROES TO PT-101-01-ROC-NUM-IROC-NUM.

           MOVE        ROC-COD-CPTO IN ROC TO
             PT-101-02-ROC-COD-CPTO.

           MOVE        ROC-COD-SCPT IN ROC TO
             PT-101-02-ROC-COD-SCPT.

           MOVE        ROC-COD-MODL IN ROC TO
             PT-101-02-ROC-COD-MODL.

           MOVE        ROC-COD-OCOB IN ROC TO
             PT-101-02-ROC-COD-OCOB.

           MOVE        ROC-CAI-PLAN IN ROC TO
             PT-101-02-ROC-CAI-PLAN.

           MOVE        ROC-IIC-PLAN IN ROC TO
             PT-101-02-ROC-IIC-PLAN.

           MOVE        ROC-IND-TPLT IN ROC TO
             PT-101-02-ROC-IND-TPLT.

           MOVE        ROC-COD-VCOC IN ROC TO
             PT-101-02-ROC-COD-VCOC.


           MOVE     ROC-FEC-PLAN IN ROC TO
                    WSS-FEC-FAMD.

           MOVE
            WSS-NUM-SAMD TO
            WSS-NUM-SDMA.

           MOVE
            WSS-NUM-AAMD TO
            WSS-NUM-ADMA.

           MOVE
            WSS-NUM-MAMD TO
            WSS-NUM-MDMA.

           MOVE
            WSS-NUM-DAMD TO
            WSS-NUM-DDMA.

           MOVE     WSS-FEC-FDMA TO
              PT-101-02-ROC-FEC-PLAN.


           MOVE        ROC-HRA-PLAN IN ROC TO
             PT-101-02-ROC-HRA-PLAN.

           MOVE 'S' TO PT-101-02-ROC-IND-VIGE.

           MOVE SPACES TO PT-101-02-ROC-COD-ANUL.

           MOVE SPACES TO PT-101-02-ROC-FEC-FUNO.

           MOVE         ROC-NUM-ADIC IN ROC TO
              PT-101-02-ROC-NUM-ADIC-EDT
           MOVE
              PT-101-02-ROC-NUM-ADIC-EDT TO
              PT-101-02-ROC-NUM-ADIC.

           MOVE         ROC-IND-ADIC IN ROC TO
              PT-101-02-ROC-VRF-ADIC.

           MOVE SPACES TO PT-101-02-ROC-FEC-FDOS.

           MOVE         ROC-SGV-TCAL IN ROC TO
              PT-101-02-ROC-SGV-TCAL-EDT.
           MOVE
              PT-101-02-ROC-SGV-TCAL-EDT TO
              PT-101-02-ROC-SGV-TCAL.

           MOVE      OSG-SGS-MSC-BCTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-BCTI.

           MOVE      OSG-SGS-MSC-PBTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-PBTI.

           MOVE          ROC-MSC-BPBT IN ROC TO
               PT-101-02-ROC-MSC-BPBT.

           MOVE          ROC-MSC-SPBT IN ROC TO
               PT-101-02-ROC-MSC-SPBT.

           MOVE ZEROES TO PT-101-02-ROC-SGV-TINF-NUM.

           MOVE          ROC-COD-CVTI IN ROC TO
               PT-101-02-ROC-COD-CVTI.

           MOVE          ROC-MSC-TFPR IN ROC TO
               PT-101-02-ROC-MSC-TFPR.



           MOVE          ROC-NUM-PREP IN ROC TO
               PT-101-02-ROC-NUM-PREP-EDT
           MOVE
               PT-101-02-ROC-NUM-PREP-EDT TO
                         ROC-NUM-PREP.


           MOVE          ROC-MSC-UTPR IN ROC TO
               PT-101-02-ROC-MSC-UTPR.

           MOVE          ROC-SGV-CFON IN ROC TO
               PT-101-02-ROC-SGV-CFON-EDT
           MOVE
               PT-101-02-ROC-SGV-CFON-EDT TO
               PT-101-02-ROC-SGV-CFON.

           MOVE          ROC-SGV-FRIE IN ROC TO
               PT-101-02-ROC-SGV-FRIE-EDT
           MOVE
               PT-101-02-ROC-SGV-FRIE-EDT TO
               PT-101-02-ROC-SGV-FRIE.

           MOVE 'PPT-01'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PPT-01'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE WSS-IDX-TROC   TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'PPT-02'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PPT-02'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE PT-101-02-ROC-COD-SCPT TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-101             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-ROC-SGS-OPC-QUE.



      * <<<<<<<<<<<<<<<<<<<< RCC-COD-CPTO = CGN >>>>>>>>>>>>>>>>>>>>

       INI-ROC-CGN.


           MOVE 'TOT-IROC'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'TOT-IROC'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE  WSS-IDX-TROC TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


      * BUSCA SGS INPUT ENTRE LOS PROPUESTOS, SI NO ENCUENTRA => ERROR

       INI-BUS-SGS-INP.

           MOVE ZEROES TO WSS-SGS-INP-IDX-01.

       CIC-BUS-SGS-INP.

           ADD 1 TO WSS-SGS-INP-IDX-01.



      * TOTAL SEGUROS INPUT
           MOVE 'T-S-INP'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'T-S-INP'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE WSS-SGS-INP-TOT   TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'I-S-INP'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'I-S-INP'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE WSS-SGS-INP-IDX-01 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF WSS-SGS-INP-IDX-01 > WSS-SGS-INP-TOT
               GO TO FIN-BUS-SGS-INP.

           MOVE 'N' TO WSS-SGS-INP-ENC.

           MOVE WSS-SGS-INP-ELM IN
                WSS-SGS-INP-TBL( WSS-SGS-INP-IDX-01 ) TO
                WSS-SGS-PPT-ARG.

           MOVE 'A-S-INP'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'A-S-INP'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +30 TO QUE-LITM.

           MOVE WSS-SGS-PPT-ARG TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           PERFORM BUS-SEGURO VARYING WSS-SGS-INP-IDX-02
                        FROM 1 BY 1 UNTIL
                        WSS-SGS-INP-IDX-02 > WSS-IDX-TROC.

           IF WSS-SGS-INP-ENC = 'N'

                MOVE WSS-QUE-TR-COLA TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE


                MOVE WSS-QUE-TR-COLA TO QUE-COLA

                MOVE WSS-SGS-PPT-ARG TO WSS-ERR-PRO-SEGU-02

                MOVE WSS-ERR-PRO-SEGU TO WSS-ERR-SEND-MENS


                MOVE WSS-ERR-SEND TO QUE-ITEM

                MOVE WSS-CTE-LENTR-1025 TO QUE-LITM
                MOVE QUE-PUT TO QUE-CMND
                PERFORM GNS-PRO-QUE

                GO TO FIN-FORM-REQS.

       FIN-BUS-SGS-INP.


           MOVE SPACES TO PT-101.

           MOVE 'E' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-101-AHDR.
           MOVE '101'                  TO PT-101-CREQ.

           MOVE SPACES         TO RCC-CIC-IOPE IN RCC-VARI.
           MOVE SPACES         TO RCC-IDC-ICLI IN RCC-VARI.

           MOVE PT-A03-01-DBC-NUM-ICLI TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-VRF-ICLI TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-IND-ICLI TO RCC-IND-ICLI IN RCC-VARI.
           MOVE PT-A03-01-DBC-GLS-ICLI TO RCC-GLS-ICLI IN RCC-VARI.

           MOVE SPACES                 TO RCC-IND-RTBL IN RCC-VARI.
           MOVE ZEROES                 TO RCC-IND-COMP IN RCC-VARI.
           MOVE  PT-A03-AHDR           TO WSS-HDR.

      *    MOVE '110'                  TO RCC-COD-TCNL IN RCC-VARI.
           MOVE WSS-HDR-CNAL           TO WSS-HDR-TIPC.
           MOVE WSS-HDR-TIPC-02        TO RCC-COD-TCNL IN RCC-VARI.


           MOVE SPACES                 TO RCC-COD-CNAL IN RCC-VARI.

           IF RCC-COD-TCNL IN RCC-VARI = WSS-CTE-110
                MOVE ZEROES TO RCC-COD-CNAL IN RCC-VARI
           ELSE
                MOVE WSS-CTE-010 TO RCC-COD-TCNL IN RCC-VARI
                MOVE PT-A03-01-OPC-COD-OFOC TO
                            RCC-COD-CNAL IN RCC-VARI.

           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCOC IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-TOOC TO RCC-COD-TOOC IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-AOOC TO RCC-COD-AOOC IN RCC-VARI.
           MOVE WSS-TOT-DIA            TO RCC-NUM-PLZO IN RCC-VARI.
           MOVE 'D'                    TO RCC-MSC-UTPZ IN RCC-VARI.
           MOVE 'CUR'                  TO RCC-COD-EVEN IN RCC-VARI.
           MOVE 'CGN'                  TO RCC-COD-CPTO IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-TCAR IN RCC-VARI.
           MOVE PT-A03-01-OPC-VAL-CRED-NUM TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCMO IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-SOPE IN RCC-VARI.
           MOVE SPACES                 TO RCC-COD-VSOP IN RCC-VARI.
           MOVE PT-A03-01-NOP-NUM-VIGU-NUM TO RCC-VAL-FINA IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCFN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-INTE IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCIN IN RCC-VARI.
           MOVE ZEROES                 TO RCC-VAL-VASG IN RCC-VARI.
           MOVE PT-A03-01-OPC-COD-VCOC TO RCC-COD-VCVA IN RCC-VARI.


           MOVE PT-A03-01-NOP-FEC-FCUR TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FCOL IN RCC-VARI.


           MOVE PT-A03-01-NOP-FEC-FPVC TO WSS-FEC-FDMA.

           MOVE WSS-NUM-SDMA TO WSS-NUM-SAMD.
           MOVE WSS-NUM-ADMA TO WSS-NUM-AAMD.
           MOVE WSS-NUM-MDMA TO WSS-NUM-MAMD.
           MOVE WSS-NUM-DDMA TO WSS-NUM-DAMD.

           MOVE WSS-FEC-FAMD TO RCC-FEC-FVEN IN RCC-VARI.



           MOVE 'CON'                  TO RCC-COD-TCON IN RCC-VARI.
           MOVE 'S'                    TO RCC-OFRM-SRV IN RCC-VARI.
           MOVE FIO-MSFL               TO RCC-MSFL     IN RCC-VARI.


           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 'RCC-INP'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RCC-INP'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           MOVE 'CGN'    TO QUE-IKEY.
           MOVE RCC-VARI TO QUE-DATA.


           PERFORM GNX-PRO-QUE.

           MOVE +490       TO RCC-LIDD.

           MOVE RCC-CMMA   TO SYS-CMMA.
           MOVE SYS-LINK   TO SYS-CMND.
      *     LINK TABPSRCC RCC-COD-CPTO = CGN
           MOVE 'TABPSRCC' TO SYS-PROG.
           MOVE RCC-TCMA   TO SYS-TCMA.
      * RCC-COD-CPTO = CGN
           PERFORM GNS-PRO-SYS.

           MOVE SYS-CMMA TO RCC-CMMA.
           MOVE RCC-MSFL TO FIO-MSFL.

           MOVE 'RCC-OUT'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RCC-OUT'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           MOVE 'CGN'    TO QUE-IKEY.
           MOVE RCC-VARI TO QUE-DATA.


           PERFORM GNX-PRO-QUE.




           MOVE ZEROES TO QUE-NITM.

       CIC-ROC-CGN-QUE.

           ADD 1 TO QUE-NITM.

           MOVE ZEROES TO WSS-IDX-IROC.

           MOVE TSK-TERM-ALF TO  RCC-COD-TERM-SGS.
           MOVE RCC-NOM-TSSGS TO QUE-COLA.

           MOVE QUE-GET TO QUE-CMND.
           MOVE RCC-LEN-TSSGS TO QUE-LITM.
           PERFORM GNS-PRO-QUE.

           IF QUE-STAT NOT = QUE-STAT-OKS
               GO TO FIN-ROC.

           MOVE QUE-ITEM TO OSG-APL-VEC IN OSG-VARI(1).

       CIC-ROC-CGN-OCC.

           ADD 1 TO WSS-IDX-IROC.

           IF OSG-SGS-COD-SIST IN OSG-VARI(WSS-IDX-IROC) NOT > SPACES
               GO TO CIC-ROC-CGN-QUE.

           MOVE SPACES TO PT-101-01-ROC-CAI-IOPC.

           MOVE SPACES TO PT-101-01-ROC-IIC-IOPC.

           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.

           MOVE    OSG-SGS-COD-SIST IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-SIST.

           MOVE    OSG-SGS-COD-EVEN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-EVEN.


           MOVE    OSG-SGS-COD-EVEN IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-01-ROC-COD-EVEN.


           MOVE SPACES TO PT-101-01-ROC-EXT-IOPC.



           MOVE 'CPTO0'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'CPTO0'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE  OSG-APL-VEC IN OSG-VARI(1) TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'CPTO1'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'CPTO1'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE  OSG-SGS-COD-TSEG IN OSG-VARI(WSS-IDX-IROC)
               TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE ZEROES TO PT-101-01-ROC-NUM-IROC-NUM.

           MOVE    'CGN' TO
             PT-101-02-ROC-COD-CPTO.


           MOVE    OSG-SGS-COD-TSEG IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-SCPT.

           MOVE    OSG-SGS-COD-SEGU  IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-MODL.

           MOVE    OSG-SGS-COD-OCOB IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-OCOB.

           MOVE    OSG-SGS-CAI-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-CAI-PLAN.

           MOVE    OSG-SGS-IIC-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-IIC-PLAN.

           MOVE    OSG-SGS-IND-TPLN  IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-IND-TPLT.

           MOVE    OSG-SGS-COD-MONE IN OSG-VARI(WSS-IDX-IROC) TO
             PT-101-02-ROC-COD-VCOC.


           MOVE     OSG-SGS-FEC-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
                    WSS-FEC-FAMD.

           MOVE
            WSS-NUM-SAMD TO
            WSS-NUM-SDMA.

           MOVE
            WSS-NUM-AAMD TO
            WSS-NUM-ADMA.

           MOVE
            WSS-NUM-MAMD TO
            WSS-NUM-MDMA.

           MOVE
            WSS-NUM-DAMD TO
            WSS-NUM-DDMA.

           MOVE     WSS-FEC-FDMA TO
              PT-101-02-ROC-FEC-PLAN.


           MOVE     OSG-SGS-HRA-PLNT IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-HRA-PLAN.

           MOVE 'S' TO PT-101-02-ROC-IND-VIGE.

           MOVE SPACES TO PT-101-02-ROC-COD-ANUL.

           MOVE SPACES TO PT-101-02-ROC-FEC-FUNO.

           MOVE     OSG-SGS-IIC-IRCC IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-NUM-ADIC.

           MOVE     OSG-SGS-CAI-IRCC IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-VRF-ADIC.

           MOVE SPACES TO PT-101-02-ROC-FEC-FDOS.

           MOVE     OSG-SGS-SGV-TAMO IN OSG-VARI(WSS-IDX-IROC) TO
              PT-101-02-ROC-SGV-TCAL-NUM.

           MOVE      OSG-SGS-MSC-BCTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-BCTI.

           MOVE      OSG-SGS-MSC-PBTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-PBTI.

           MOVE      OSG-SGS-MSC-BPBT IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-BPBT.

           MOVE      OSG-SGS-MSC-SPBT IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-SPBT.

           MOVE ZEROES TO PT-101-02-ROC-SGV-TINF-NUM.

           MOVE      OSG-SGS-COD-CVTI IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-COD-CVTI.

           MOVE      OSG-SGS-MSC-TFPR IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-TFPR.

           MOVE      OSG-SGS-NUM-PREP IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-NUM-PREP.


           MOVE      OSG-SGS-MSC-UTPR IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-MSC-UTPR.

           MOVE      OSG-SGS-SGV-CSTF IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-SGV-CFON-NUM.

           MOVE      OSG-SGS-VAL-FRIE IN OSG-VARI(WSS-IDX-IROC) TO
               PT-101-02-ROC-SGV-FRIE-NUM.
      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-101             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           GO TO CIC-ROC-CGN-OCC.



      *>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

       FIN-ROC.

      *>>>>>>>>>>>>>>>>>>    032  OPC.LIQ INI  >>>>>>>>>>>>>>>>>>>>>>>>


      * se debe liquidar primero y Luego activar con numero de
      * operacion conocido

           MOVE SPACES TO PT-032.

           MOVE 'E' TO WSS-TR-COD-SGMT.

      *     MOVE PT-032-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-032-AHDR.

           MOVE PT-A03-AHDR            TO PT-032-AHDR.
           MOVE PT-032-AHDR            TO WSS-HDR-032.
           MOVE 'N'                    TO WSS-HDR-032-098-098.
           MOVE WSS-HDR-032            TO PT-032-AHDR.
           MOVE '032'                  TO PT-032-CREQ.

      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-032             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      * BUSCA SIGUIENTE REGISTRO

      *     MOVE FIO-GET-NXT TO FIO-CMND.

      *     GO TO CIC-FORM-REQS.



      *>>>>>>>>>>>>>>>>>>    032  OPC.LIQ FIN  >>>>>>>>>>>>>>>>>>>>>>>>

       END-FORM-REQS.

      *>>>>>>>>>>>>>> LLAMA A COLPPTPG >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>

           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      *     PERFORM GNS-PRO-SYS.
      *
      *     MOVE ZEROES TO QUE-NITM.
      *
      *     MOVE ZEROES TO WSS-NITM-TSPT.
      *
      *     MOVE ZEROES TO WSS-TOT-RESP.
      *
      * CIC-GET-TR.
      *
      *     MOVE WSS-QUE-TR-COLA TO WSS-QUE-TR-COLA-032.
      *     MOVE 'TZ'            TO WSS-QUE-TR-COLA-032-02.
      *
      *     ADD 1 TO QUE-NITM.
      *
      *     MOVE QUE-NITM TO WSS-NITM-TSPT.
      *
      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.
      *
      *     MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
      *     MOVE QUE-GET TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      *     IF QUE-STAT = QUE-STAT-OKS
      *          ADD 1 TO WSS-TOT-RESP
      *          MOVE QUE-ITEM TO WSS-TR
      *          PERFORM AJUS-032
      *          MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)
      *
      *          GO TO CIC-GET-TR.
      *
      *     MOVE WSS-SND TO TP-032.
      *
      *
      *     MOVE 'NUM-01'              TO QUE-COLA.
      *     MOVE QUE-DEL                TO QUE-CMND.
      *     PERFORM GNX-PRO-QUE.
      *
      *     MOVE 'NUM-01'              TO QUE-COLA.
      *     MOVE QUE-PUT TO QUE-CMND.
      *     MOVE +3000 TO QUE-LITM.
      *
      *     MOVE TP-032 TO QUE-ITEM.
      *     PERFORM GNX-PRO-QUE.
      *
      *    PERFORM VAL-NUM-TP-REQ-032.
      *
      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.
      *     MOVE QUE-DEL TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      *
      *     PERFORM PUT-TR VARYING WSS-IDX-TR FROM 1 BY 1 UNTIL
      *       WSS-IDX-TR > WSS-NITM-TSPT.

       EXT-FORM-REQS.

      *     MOVE SYS-XCTL        TO SYS-CMND.
      *     MOVE WSS-QUE-TR-COLA TO SYS-CMMA.
      *     MOVE WSS-IDEN-TCPIP  TO SYS-CMMA.

      *     MOVE WSS-CTE-CMA-TPG TO SYS-TCMA.
      *     MOVE 'GNSPPSGO'      TO SYS-PROG.
      *     PERFORM GNS-PRO-SYS.

      *>>>>>>>>>>>>>>>>>>    033  OPC.ACA INI  >>>>>>>>>>>>>>>>>>>>>>>>

      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.
      *     MOVE QUE-DEL TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.

           MOVE SPACES TO PT-033.

           MOVE 'E' TO WSS-TR-COD-SGMT.

      *     MOVE PT-033-AHDR            TO WSS-HDR-100.
      *     MOVE '0'                    TO WSS-HDR-100-093-093.
      *     MOVE WSS-HDR-100            TO PT-033-AHDR.

           MOVE PT-A03-AHDR            TO PT-033-AHDR.

           MOVE PT-033-AHDR            TO WSS-HDR-033.

           MOVE SPACES                 TO WSS-HDR-033-091-093.

           IF PT-A03-01-FRM-COD-SIMU = WSS-CTE-SIMU-S
               MOVE 'ACB'                  TO WSS-HDR-033-091-093.
           MOVE WSS-HDR-033            TO PT-033-AHDR.

           MOVE '033'                  TO PT-033-CREQ.
           MOVE TP-037-01-ROV-CAI-IOPC TO PT-033-01-OPC-CAI-IOPC.
           MOVE TP-037-01-ROV-IIC-IOPC TO PT-033-01-OPC-IIC-IOPC.


      * ACA DEBE .......

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-033             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


           MOVE 'PT-033'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PT-033'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE  PT-033 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


      *>>>>>>>>>>>>>> LLAMA A COLPPTPG ACA >>>>>>>>>>>>>>>>>>>>>>>>>>>


           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      *     PERFORM GNS-PRO-SYS.
      *
      *     MOVE ZEROES TO QUE-NITM.
      *
      *     MOVE ZEROES TO WSS-NITM-TSPT.
      *
      *CIC-GET-TR-033.
      *
      *     ADD 1 TO QUE-NITM.
      *
      *     MOVE QUE-NITM TO WSS-NITM-TSPT.
      *
      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.
      *
      *     MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
      *     MOVE QUE-GET TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      *     IF QUE-STAT = QUE-STAT-OKS
      *          MOVE QUE-ITEM TO WSS-TR
      *          MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)
      *
      *          GO TO CIC-GET-TR-033.
      *
      *     MOVE WSS-SND TO TP-033.
      *
      *     IF TP-033-STAT = '1'
      *          GO TO FIN-FORM-REQS.
      *
      *     MOVE TP-032 TO WSS-SND.
      *
      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.
      *     MOVE QUE-DEL TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      *
      *     PERFORM PUT-TR-RESP VARYING WSS-IDX-TR FROM 1 BY 1 UNTIL
      *       WSS-IDX-TR > WSS-TOT-RESP.


      *>>>>>>>>>>>>>>>>>>    032  OPC.ACA FIN  >>>>>>>>>>>>>>>>>>>>>>>>

      *>>>>>>>>>>>>>>>>>>    111  PLC.CON INI  >>>>>>>>>>>>>>>>>>>>>>>>

      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.
      *     MOVE QUE-DEL TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.

           MOVE SPACES TO PT-111.

           MOVE 'Y' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-111-AHDR.

           MOVE '111'                  TO PT-111-CREQ.

           MOVE PT-A03-01-OPC-CAI-IOPC TO PT-111-01-OPC-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO PT-111-01-OPC-IIC-IOPC.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-111             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


           MOVE 'PT-111'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PT-111'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE  PT-111 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


      *>>>>>>>>>>>>>> LLAMA A COLPPTPG 111  PLC.CON >>>>>>>>>>>>>>>>>>>


           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
      *      PERFORM GNS-PRO-SYS.
      *
      *     MOVE ZEROES TO QUE-NITM.
      *
      *     MOVE ZEROES TO WSS-NITM-TSPT.
      *
      *CIC-GET-TR-111.
      *
      *     ADD 1 TO QUE-NITM.
      *
      *     MOVE QUE-NITM TO WSS-NITM-TSPT.
      *
      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.
      *
      *     MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
      *     MOVE QUE-GET TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      *     IF QUE-STAT = QUE-STAT-OKS
      *          MOVE QUE-ITEM TO WSS-TR
      *          MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)
      *
      *          GO TO CIC-GET-TR-111.
      *
      *     MOVE WSS-SND TO TP-111.
      *
      *     IF TP-111-STAT = '1'
      *          GO TO FIN-FORM-REQS.
      *
      *     MOVE TP-032 TO WSS-SND.
      *
      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.
      *     MOVE QUE-DEL TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      *
      *     PERFORM PUT-TR-RESP VARYING WSS-IDX-TR FROM 1 BY 1 UNTIL
      *       WSS-IDX-TR > WSS-TOT-RESP.

      *>>>>>>>>>>>>>>>>>>    111  PLC.CON FIN  >>>>>>>>>>>>>>>>>>>>>>>>


       FIN-FORM-REQS.
           EXIT.

       AJUS-032 SECTION.
       INI-AJUS-032.

           IF WSS-NITM-TSPT = WSS-CTE-1
                MOVE WSS-QUE-TR-COLA-032 TO QUE-COLA
                MOVE QUE-DEL             TO QUE-CMND
                PERFORM GNS-PRO-QUE

                MOVE WSS-TR-COD-DATA TO TP-032
                MOVE PT-A03-01-OPC-CAI-IOPC TO TP-032-01-OPC-CAI-IOPC
                MOVE PT-A03-01-OPC-IIC-IOPC TO TP-032-01-OPC-IIC-IOPC
                MOVE TP-032 TO WSS-TR-COD-DATA.

           MOVE WSS-QUE-TR-COLA-032 TO QUE-COLA.
           MOVE QUE-PUT         TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-AJUS-032.
           EXIT.



       PUT-ROC-N SECTION.
       INI-PUT-ROC-N.
           MOVE PT-101 TO WSS-ROC-BKP.

           MOVE HOY-SHOY TO WSS-NUM-SDMA
           MOVE HOY-AHOY TO WSS-NUM-ADMA
           MOVE HOY-MHOY TO WSS-NUM-MDMA
           MOVE HOY-DHOY TO WSS-NUM-DDMA
           MOVE WSS-FEC-FDMA TO PT-101-02-ROC-FEC-PLAN
           MOVE HOY-HHOY     TO PT-101-02-ROC-HRA-PLAN

           MOVE 'USER'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'USER'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.

           MOVE WSS-HDR-USER TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE 'USR-COD-USER' TO FIO-AKEY
           MOVE WSS-HDR-USER TO USR-COD-USER IN USR
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM TAB-FIO-USR
           IF FIO-STAT-OKS
               MOVE USR-COD-USER IN USR TO  WSS-12-04-08
               MOVE WSS-12-04-08-04 TO PT-101-02-ROC-CAI-PLAN
               MOVE WSS-12-04-08-08 TO PT-101-02-ROC-IIC-PLAN

               MOVE USR-NUM-IUSR IN USR TO PT-101-02-ROC-NUM-ADIC
               MOVE USR-VRF-IUSR IN USR TO PT-101-02-ROC-VRF-ADIC
           ELSE

               MOVE 'USR-COD-USER' TO FIO-AKEY
               MOVE TP-729-01-OPC-COD-RMOC TO USR-COD-USER IN USR
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-USR
               IF FIO-STAT-OKS
                   MOVE USR-COD-USER IN USR TO  WSS-12-04-08
                   MOVE WSS-12-04-08-04 TO PT-101-02-ROC-CAI-PLAN
                   MOVE WSS-12-04-08-08 TO PT-101-02-ROC-IIC-PLAN

                   MOVE USR-NUM-IUSR IN USR TO PT-101-02-ROC-NUM-ADIC
                   MOVE USR-VRF-IUSR IN USR TO PT-101-02-ROC-VRF-ADIC

                ELSE
                   MOVE SPACES TO PT-101-02-ROC-CAI-PLAN
                   MOVE SPACES TO PT-101-02-ROC-IIC-PLAN.

           MOVE PT-A03-01-ITR-SGV-TINT-NUM TO
                PT-101-02-ROC-SGV-TCAL-NUM.

           MOVE OSG-OCI-VAL-PPRO IN OSG-VARI(WSS-IDX-IROC) TO
                PT-101-02-ROC-SGV-TINF-NUM


           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           MOVE PT-101             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           PERFORM GNS-PRO-QUE.

           MOVE WSS-ROC-BKP TO PT-101.

           MOVE WSS-CTE-N TO PT-101-02-ROC-IND-VIGE.

       FIN-PUT-ROC-N.
           EXIT.

       PRO-TR SECTION.
       INI-PRO-TR.
       FIN-PRO-TR.
           EXIT.

       PUT-TR SECTION.
       INI-PUT-TR.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           MOVE WSS-ELE-SEGS(WSS-IDX-TR) TO QUE-ITEM.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-TR.
           EXIT.

       PUT-TR-RESP SECTION.
       INI-PUT-TR-RESP.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           MOVE WSS-ELE-SEGS(WSS-IDX-TR) TO WSS-DATA-TSPT.
           IF WSS-IDX-TR < WSS-TOT-RESP
               MOVE '0' TO WSS-INDICA-TSPT
           ELSE
               MOVE '1' TO WSS-INDICA-TSPT.

           MOVE WSS-ITEM-TSPT TO QUE-ITEM.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-TR-RESP.
           EXIT.

       COPY GNSBVNUM.
       COPY GNSBGHOY.
       COPY GNSBHSYS.
       COPY GNSBGSYS.
       COPY GNSBIABT.
       COPY GNSBGTSK.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY GNSBGDTC.
       COPY GNSBGMSG.
       COPY GNSBVTAB.
       COPY TABBFUSR.

       COPY GNSBGEND.

      *Modulo Generico Manejo de TSs
       COPY GNSBGQUE.



      *>>>>> GNP-INI
       PRO-GEN-NP SECTION.
       INI-PRO-GEN-NP.


           MOVE SPACES TO NOP-COD-MENS IN EVC-VARI.
           MOVE SPACES TO NOP-GLS-MENS IN EVC-VARI.
           MOVE PT-A03-01-NOP-MES-0001 TO NOP-MES-1      IN EVC-VARI.
           MOVE PT-A03-01-NOP-MES-0002 TO NOP-MES-2      IN EVC-VARI.
           MOVE PT-A03-01-NOP-MES-0003 TO NOP-MES-3      IN EVC-VARI.
           MOVE PT-A03-01-NOP-MES-0004 TO NOP-MES-4      IN EVC-VARI.
           MOVE PT-A03-01-NOP-MES-0005 TO NOP-MES-5      IN EVC-VARI.
      *>     MOVE PT-A03-01-NOP-MES-0006 TO NOP-MES-6      IN EVC-VARI.
      *>     MOVE PT-A03-01-NOP-MES-0007 TO NOP-MES-7      IN EVC-VARI.
      *>     MOVE PT-A03-01-NOP-MES-0008 TO NOP-MES-8      IN EVC-VARI.
      *>     MOVE PT-A03-01-NOP-MES-0009 TO NOP-MES-9      IN EVC-VARI.
      *>     MOVE PT-A03-01-NOP-MES-0010 TO NOP-MES-10     IN EVC-VARI.
      *>     MOVE PT-A03-01-NOP-MES-0011 TO NOP-MES-11     IN EVC-VARI.
           MOVE ZEROES                   TO NOP-MES-6      IN EVC-VARI.
           MOVE ZEROES                   TO NOP-MES-7      IN EVC-VARI.
           MOVE ZEROES                   TO NOP-MES-8      IN EVC-VARI.
           MOVE ZEROES                   TO NOP-MES-9      IN EVC-VARI.
           MOVE ZEROES                   TO NOP-MES-10     IN EVC-VARI.
           MOVE ZEROES                   TO NOP-MES-11     IN EVC-VARI.


           MOVE PT-A03-01-NOP-NUM-VIGU TO NOP-NUM-VIGU   IN EVC-VARI.
           MOVE PT-A03-01-NOP-FEC-FPVC TO NOP-FEC-FPVC   IN EVC-VARI.
           MOVE PT-A03-01-NOP-NUM-SPVE TO NOP-NUM-SPVE   IN EVC-VARI.
           MOVE PT-A03-01-NOP-IND-UTPV TO NOP-IND-UTPV-O IN EVC-VARI.
           MOVE PT-A03-01-NOP-NUM-SEVE TO NOP-NUM-SEVE   IN EVC-VARI.
           MOVE PT-A03-01-NOP-IND-UTSV TO NOP-IND-UTSV-O IN EVC-VARI.

           MOVE WSS-CTE-CTS            TO NOP-IND-MODO   IN EVC-VARI.

           MOVE 'EVC-GNPI' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'EVC-GNPI' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +2000 TO QUE-LITM.
           MOVE EVC-VARI TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE EVC-VARI        TO SYS-CMMA.
           MOVE NOP-LEN-VARI    TO SYS-TCMA.
           MOVE SYS-LINK        TO SYS-CMND.
           MOVE 'COLPPGNP'      TO SYS-PROG.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA        TO EVC-VARI.

           IF NOP-COD-MENS IN EVC-VARI > SPACES
               GO TO FIN-PRO-GEN-NP.

           MOVE 'EVC-GNPO' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'EVC-GNPO' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +2000 TO QUE-LITM.
           MOVE EVC-VARI TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           PERFORM GNS-ERR-QUE.
           IF NOP-COD-MENS IN EVC-VARI > SPACES
              GO TO FIN-PRO-GEN-NP.

           MOVE ZEROES TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-1 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-2 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-3 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-4 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-5 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-6 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-7 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-8 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-9 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-10 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF NOP-MES-11 IN EVC-VARI > ZEROES
              ADD 1 TO WSS-NUM-NRNP IN WSS-VARI.
           IF WSS-NUM-NRNP IN WSS-VARI > 5
              PERFORM PRO-RESP-FO
           ELSE
              PERFORM PRO-RESP-NP.
       FIN-PRO-GEN-NP.
           EXIT.

       PRO-RESP-FO SECTION.
       INI-PRO-RESP-FO.


           MOVE 'RESP-FO' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RESP-FO' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +2000 TO QUE-LITM.
           MOVE WSS-NUM-NRNP IN WSS-VARI TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           MOVE ZEROES TO WSS-I.
       LUP-PRO-RESP-FO.
           ADD 1 TO WSS-I.


           IF WSS-I > 11 OR
              NOP-NUM-TVCT IN EVC-VARI(WSS-I) NOT > ZEROES
              PERFORM GNS-ERR-QUE
              GO TO EXT-PRO-RESP-FO.

           ADD NOP-NUM-TVCT IN EVC-VARI(WSS-I) TO WSS-NUM-VIGU-ADIC.



           MOVE 'NUM-TVC1'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'NUM-TVC1'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.
           MOVE WSS-NUM-VIGU-ADIC      TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




           ADD 1 TO WSS-J.
           MOVE SPACES         TO WSS-CIC-IPVC-V(WSS-J).
           MOVE 1              TO WSS-NUM-IDLC-V(WSS-J).
           MOVE NOP-NUM-TVCT IN EVC-VARI(WSS-I)
                               TO WSS-NUM-VIGU-V(WSS-J).
           MOVE NOP-FEC-1VCT IN EVC-VARI(WSS-I)
                               TO WSS-FEC-FPVC-V(WSS-J).
           MOVE ZEROES         TO WSS-NUM-DPVE-V(WSS-J).
           MOVE ZEROES         TO WSS-NUM-SPVE-V(WSS-J).
           MOVE SPACES         TO WSS-IND-UTPV-V(WSS-J).
           MOVE WSS-CTE-TCVE-FO-O-CO
                               TO WSS-MSC-TCVE-V(WSS-J).
           MOVE ZEROES         TO WSS-NUM-DESD-V(WSS-J).
           MOVE 1              TO WSS-NUM-SEVE-V(WSS-J).
           MOVE 'A'            TO WSS-IND-UTSV-V(WSS-J).
           MOVE ZEROES         TO WSS-VAL-VENC-V(WSS-J).
           MOVE SPACES         TO WSS-IND-CAUT-V(WSS-J).
           GO TO LUP-PRO-RESP-FO.
       EXT-PRO-RESP-FO.
           PERFORM PRO-NUM-PZFO.
       FIN-PRO-RESP-FO.
           EXIT.

       PRO-RESP-NP SECTION.
       INI-PRO-RESP-NP.

           MOVE 'RESP-NP' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'RESP-NP' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +20 TO QUE-LITM.
           MOVE WSS-NUM-NRNP IN WSS-VARI TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 1 TO WSS-J.
           MOVE SPACES                  TO WSS-CIC-IPVC-V(WSS-J).
           MOVE 1                       TO WSS-NUM-IDLC-V(WSS-J).
           MOVE PT-A03-01-NOP-NUM-VIGU  TO WSS-NUM-VIGU-V(WSS-J).
           MOVE PT-A03-01-NOP-FEC-FPVC  TO WSS-FEC-FPVC-V(WSS-J).
           MOVE PT-A03-01-NOP-FEC-FPVC  TO WSS-FEC-FDMA.
           MOVE WSS-NUM-DDMA            TO WSS-NUM-DPVE-V(WSS-J).
           MOVE PT-A03-01-NOP-NUM-SPVE  TO WSS-NUM-SPVE-V(WSS-J).
           MOVE PT-A03-01-NOP-IND-UTPV  TO WSS-IND-UTPV-V(WSS-J).
           MOVE WSS-CTE-TCVE-FO-O-CO    TO WSS-MSC-TCVE-V(WSS-J).
           MOVE ZEROES                  TO WSS-NUM-DESD-V(WSS-J).
           MOVE PT-A03-01-NOP-NUM-SEVE  TO WSS-NUM-SEVE-V(WSS-J).
           MOVE PT-A03-01-NOP-IND-UTSV  TO WSS-IND-UTSV-V(WSS-J).
           MOVE ZEROES                  TO WSS-VAL-VENC-V(WSS-J).
           MOVE SPACES                  TO WSS-IND-CAUT-V(WSS-J).
           IF NOP-IND-MODO IN EVC-VARI = 'CTS' AND
              NOP-NUM-VADC IN EVC-VARI > ZEROES
              ADD NOP-NUM-VADC IN EVC-VARI TO WSS-NUM-VIGU-V(WSS-J).
           PERFORM PRO-NUM-PLZT.
           IF NOP-COD-MENS IN EVC-VARI > SPACES
              GO TO FIN-PRO-RESP-NP.
           MOVE ZEROES TO WSS-I.
       LUP-PRO-RESP-NP.
           ADD 1 TO WSS-I.



           IF WSS-I > 11
              PERFORM GNS-ERR-QUE
              GO TO FIN-PRO-RESP-NP.
           IF NOP-NUM-TVCT IN EVC-VARI(WSS-I) NOT > ZEROES
              GO TO LUP-PRO-RESP-NP.


           ADD NOP-NUM-TVCT IN EVC-VARI(WSS-I) TO WSS-NUM-VIGU-ADIC.


           MOVE 'NUM-TVC2'             TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE 'NUM-TVC2'             TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +12 TO QUE-LITM.
           MOVE WSS-NUM-VIGU-ADIC      TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           ADD 1 TO WSS-J.
           MOVE NOP-CIC-IPVC-R IN EVC-VARI(WSS-I) TO
                                  WSS-CIC-IPVC-V(WSS-J).
           MOVE 1              TO WSS-NUM-IDLC-V(WSS-J).
           MOVE NOP-NUM-TVCT IN EVC-VARI(WSS-I)
                               TO WSS-NUM-VIGU-V(WSS-J).
           MOVE NOP-FEC-1VCT IN EVC-VARI(WSS-I)
                               TO WSS-FEC-FPVC-V(WSS-J).
           MOVE NOP-NUM-DPVE-R IN EVC-VARI(WSS-I) TO
                                  WSS-NUM-DPVE-V(WSS-J).
           MOVE ZEROES         TO WSS-NUM-SPVE-V(WSS-J).
           MOVE SPACES         TO WSS-IND-UTPV-V(WSS-J).
           MOVE NOP-MSC-TCVE-R IN EVC-VARI(WSS-I) TO
                                  WSS-MSC-TCVE-V(WSS-J).
           MOVE ZEROES         TO WSS-NUM-DESD-V(WSS-J).
           MOVE NOP-NUM-SEVE-R IN EVC-VARI(WSS-I) TO
                                  WSS-NUM-SEVE-V(WSS-J).
           MOVE NOP-IND-UTSV-R IN EVC-VARI(WSS-I) TO
                                  WSS-IND-UTSV-V(WSS-J).
           MOVE ZEROES         TO WSS-VAL-VENC-V(WSS-J).
           MOVE SPACES         TO WSS-IND-CAUT-V(WSS-J).
           GO TO LUP-PRO-RESP-NP.
       FIN-PRO-RESP-NP.
           EXIT.

       PRO-NUM-PLZT SECTION.
       INI-PRO-NUM-PLZT.
           MOVE WSS-NUM-VIGU-V(1) TO WSS-NUM-PLZT.
           SUBTRACT 1 FROM WSS-NUM-PLZT.
           MOVE PT-A03-01-NOP-FEC-FPVC  TO WSS-FEC-FDMA.

           MOVE WSS-NUM-DDMA  TO FEC-ITM1.
           MOVE WSS-NUM-MDMA  TO FEC-ITM2.
           MOVE WSS-NUM-SDMA  TO FEC-ITM3.
           MOVE WSS-NUM-ADMA  TO FEC-ITM4.
           MULTIPLY WSS-NUM-PLZT BY WSS-NUM-SEVE-V(WSS-J)
            GIVING WSS-NUM-PLZT.
           IF WSS-IND-UTSV-V(WSS-J) = 'D'
              MOVE WSS-NUM-PLZT         TO FEC-NDIA
              MOVE FEC-SUM-DIA          TO FEC-CMND
           ELSE
           IF WSS-IND-UTSV-V(WSS-J) = 'M'
              MOVE WSS-NUM-PLZT         TO FEC-NMES
              MOVE FEC-SUM-MES          TO FEC-CMND
           ELSE
              MOVE WSS-NUM-PLZT         TO FEC-NANO
              MOVE FEC-SUM-ANO          TO FEC-CMND.

           MOVE FEC-FORM-FEC            TO FEC-FORM.
           PERFORM CAL-FEC.
      *PVG INI 23-JUN-2010 ANALISIS FERIADO
           MOVE FEC-ITM1 TO WSS-NUM-DPZT IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MPZT IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SPZT IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-APZT IN WSS-VARI.
           PERFORM PRO-VAL-FHBL.
           MOVE WSS-NUM-DPZT IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MPZT IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SPZT IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-APZT IN WSS-VARI TO FEC-ITM4.
      *PVG FIN 23-JUN-2010
           MOVE PT-A03-01-NOP-FEC-FCUR   TO WSS-FEC-FDMA.
           MOVE WSS-NUM-DDMA  TO FEC-DEC1.
           MOVE WSS-NUM-MDMA  TO FEC-MEC1.
           MOVE WSS-NUM-SDMA  TO FEC-SEC1.
           MOVE WSS-NUM-ADMA  TO FEC-AEC1.
           MOVE FEC-ITM1                 TO FEC-DEC2.
           MOVE FEC-ITM2                 TO FEC-MEC2.
           MOVE FEC-ITM3                 TO FEC-SEC2.
           MOVE FEC-ITM4                 TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'DIFDIA NOVLD' TO NOP-COD-MENS IN EVC-VARI
               GO TO FIN-PRO-NUM-PLZT.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
               COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
      *>     MOVE FEC-NDIA TO PT-A03-01-FRM-NUM-PLZT.
      *>     MOVE 'D'      TO PT-A03-01-FRM-IND-TPZT.
       FIN-PRO-NUM-PLZT.
           EXIT.

       PRO-NUM-PZFO SECTION.
       INI-PRO-NUM-PZFO.
           MOVE ZEROES TO WSS-FEC-FMAX IN WSS-VARI.
           MOVE ZEROES TO WSS-I IN WSS-VARI.
       LUP-PRO-NUM-PZFO.
           ADD 1 TO WSS-I IN WSS-VARI.
           IF WSS-I IN WSS-VARI > 11 GO TO EXT-PRO-NUM-PZFO.
           IF NOP-NUM-TVCT IN EVC-VARI(WSS-I) NOT > ZEROES
              GO TO EXT-PRO-NUM-PZFO.
           MOVE NOP-NUM-DNOP IN EVC-VARI(WSS-I) TO FEC-ITM1.
           MOVE NOP-NUM-MNOP IN EVC-VARI(WSS-I) TO FEC-ITM2.
           MOVE NOP-NUM-SNOP IN EVC-VARI(WSS-I) TO FEC-ITM3.
           MOVE NOP-NUM-ANOP IN EVC-VARI(WSS-I) TO FEC-ITM4.
           MOVE NOP-NUM-TVCT IN EVC-VARI(WSS-I) TO FEC-NANO.
           SUBTRACT 1 FROM FEC-NANO.
           MOVE FEC-SUM-ANO  TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO WSS-NUM-DTMP IN WSS-VARI.
           MOVE FEC-ITM2     TO WSS-NUM-MTMP IN WSS-VARI.
           MOVE FEC-ITM3     TO WSS-NUM-STMP IN WSS-VARI.
           MOVE FEC-ITM4     TO WSS-NUM-ATMP IN WSS-VARI.
           IF WSS-FEC-FTMP IN WSS-VARI > WSS-FEC-FMAX IN WSS-VARI
             MOVE WSS-FEC-FTMP IN WSS-VARI TO WSS-FEC-FMAX IN WSS-VARI.
           GO TO LUP-PRO-NUM-PZFO.
       EXT-PRO-NUM-PZFO.
           IF WSS-FEC-FMAX IN WSS-VARI NOT > ZEROES
              GO TO FIN-PRO-NUM-PZFO.
           MOVE WSS-NUM-DMAX IN WSS-VARI TO WSS-NUM-DPZT IN WSS-VARI.
           MOVE WSS-NUM-MMAX IN WSS-VARI TO WSS-NUM-MPZT IN WSS-VARI.
           MOVE WSS-NUM-SMAX IN WSS-VARI TO WSS-NUM-SPZT IN WSS-VARI.
           MOVE WSS-NUM-AMAX IN WSS-VARI TO WSS-NUM-APZT IN WSS-VARI.
           PERFORM PRO-VAL-FHBL.
           MOVE WSS-NUM-DPZT IN WSS-VARI TO WSS-NUM-DMAX IN WSS-VARI.
           MOVE WSS-NUM-MPZT IN WSS-VARI TO WSS-NUM-MMAX IN WSS-VARI.
           MOVE WSS-NUM-SPZT IN WSS-VARI TO WSS-NUM-SMAX IN WSS-VARI.
           MOVE WSS-NUM-APZT IN WSS-VARI TO WSS-NUM-AMAX IN WSS-VARI.
      *PVG FIN 23-JUN-2010
           MOVE PT-A03-01-NOP-FEC-FCUR   TO WSS-FEC-FDMA.
           MOVE WSS-NUM-DDMA  TO FEC-DEC1.
           MOVE WSS-NUM-MDMA  TO FEC-MEC1.
           MOVE WSS-NUM-SDMA  TO FEC-SEC1.
           MOVE WSS-NUM-ADMA  TO FEC-AEC1.
           MOVE WSS-NUM-DMAX IN WSS-VARI TO FEC-DEC2.
           MOVE WSS-NUM-MMAX IN WSS-VARI TO FEC-MEC2.
           MOVE WSS-NUM-SMAX IN WSS-VARI TO FEC-SEC2.
           MOVE WSS-NUM-AMAX IN WSS-VARI TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'DIFDIA NOVLD' TO NOP-COD-MENS IN EVC-VARI
               GO TO FIN-PRO-NUM-PZFO.
           IF FEC-NDIA = ZEROES AND
              FEC-DEC1 = FEC-SIND AND FEC-DEC2 = FEC-REST AND
              FEC-SIND < FEC-REST
               COMPUTE FEC-NDIA = FEC-REST - FEC-SIND.
      *>     MOVE FEC-NDIA TO PT-A03-01-FRM-NUM-PLZT-NUM.
      *>     MOVE 'D'      TO PT-A03-01-FRM-IND-TPZT.
       FIN-PRO-NUM-PZFO.
           EXIT.


       PRO-VAL-FHBL SECTION.
       INI-PRO-VAL-FHBL.
           MOVE PT-A03-01-OPC-CAI-IOPC      TO WSS-GLS-GTIO IN WSS-VARI.
      *    MOVE FRM-EXT-IOPC-ALF IN GNP-FLD TO WSS-GLS-GAUX IN WSS-VARI.
      *    MOVE OPC-IIC-IOPC-ALF IN GNP-FLD TO WSS-GLS-GMND IN WSS-VARI.
           MOVE PT-A03-01-OPC-IIC-IOPC      TO WSS-GLS-GMND IN WSS-VARI.
           IF WSS-GLS-GMD3 IN WSS-VARI = '0'
              MOVE WSS-GLS-GMND IN WSS-VARI TO WSS-GLS-VLR1 IN WSS-VARI
              MOVE WSS-COD-VLR1 IN WSS-VARI TO POC-COD-VCOC IN POC
           ELSE
              MOVE WSS-GLS-GMND IN WSS-VARI TO WSS-GLS-VLR2 IN WSS-VARI
              MOVE WSS-COD-VLR2 IN WSS-VARI TO POC-COD-VCOC IN POC.
           IF NOT (WSS-COD-GTIO IN WSS-VARI > SPACES AND
                   WSS-COD-GAUX IN WSS-VARI > SPACES)
              GO TO CNT-PRO-VAL-FHBL.

           MOVE WSS-COD-GTIO IN WSS-VARI TO POC-COD-TOOC IN POC.
           MOVE WSS-COD-GAUX IN WSS-VARI TO POC-COD-AOOC IN POC.
           MOVE ZEROES                   TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
              GO TO CNT-PRO-VAL-FHBL.
           IF NOT (POC-IND-AFER IN POC = 'S')
              GO TO FIN-PRO-VAL-FHBL.
       CNT-PRO-VAL-FHBL.
           MOVE WSS-NUM-DPZT IN WSS-VARI TO FEC-ITM1.
           MOVE WSS-NUM-MPZT IN WSS-VARI TO FEC-ITM2.
           MOVE WSS-NUM-SPZT IN WSS-VARI TO FEC-ITM3.
           MOVE WSS-NUM-APZT IN WSS-VARI TO FEC-ITM4.

           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-SIG-HBL  TO FEC-CMND
               PERFORM CAL-FEC.

           MOVE FEC-ITM1 TO WSS-NUM-DPZT IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MPZT IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SPZT IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-APZT IN WSS-VARI.
       FIN-PRO-VAL-FHBL.
           EXIT.

       COPY COLBFPOC.
       COPY COLBFVEN.

       CRG-IDD SECTION.
       INI-CRG-IDD.
           MOVE 'GNS'      TO SCR-SIST.
           MOVE 'COLPMA03' TO IDD-PROG FIO-PROG.
           MOVE IDD-VARI   TO SYS-CMMA.
           MOVE +507       TO SYS-TCMA.
           MOVE 'GNSPPIDD' TO SYS-PROG.
           MOVE SYS-LINK   TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA   TO IDD-VARI.

       FIN-IDD-CRG.
           EXIT.

      * COPY-INC-INI
       COPY SGCBGBCC.
       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       COPY MC2BFROC.

       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.

           IF WSS-LOGPMA03 = 'S'
                PERFORM GNS-PRO-QUE.

       FIN-GNX-PRO-QUE.
           EXIT.

       BUS-SGS-PPT SECTION.
       INI-BUS-SGS-PPT.
           IF PT-101-02-ROC-COD-SCPT =
              WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL(WSS-IDX-SGS-PPT)
               MOVE 'S' TO WSS-SGS-PPT-ENC
               ADD 1 TO WSS-SGS-INP-TOT GIVING
                  WSS-IDX-SGS-PPT.

       FIN-BUS-SGS-PPT.
           EXIT.

       BUS-SEGURO SECTION.
       INI-BUS-SEGURO.


           MOVE 'SGS-DIGI'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'SGS-DIGI'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           MOVE WSS-SGS-INP-TBL TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE 'SGS-PRCC'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'SGS-PRCC'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           MOVE WSS-SGS-PPT-TBL TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'SGS-IDX1'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'SGS-IDX1'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           MOVE WSS-SGS-PPT-ELM
                IN WSS-SGS-PPT-TBL( WSS-SGS-INP-IDX-01 ) TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           MOVE 'SGS-INP2'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'SGS-INP2'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE WSS-SGS-INP-ELM
                IN WSS-SGS-INP-TBL( WSS-SGS-INP-IDX-02 ) TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           IF WSS-SGS-PPT-ELM IN WSS-SGS-PPT-TBL( WSS-SGS-INP-IDX-02 ) =
              WSS-SGS-INP-ELM IN WSS-SGS-INP-TBL( WSS-SGS-INP-IDX-01 )
                  MOVE 'S' TO WSS-SGS-INP-ENC
                  ADD 1 TO WSS-SGS-INP-IDX-02 GIVING
                           WSS-IDX-TROC.
       FIN-BUS-SEGURO.
           EXIT.



       VAL-NUM-TP-REQ-032 SECTION.
       INI-VAL-NUM-TP-REQ-032.


           MOVE 'INI-NUM'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'INI-NUM'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.

           MOVE TP-032-02-OPC-COD-VCOC TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'NUM-02'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-02'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           PERFORM VN-TP-032-01-OPC-IIC-IOPC.


           MOVE 'NUM-03'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-03'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

      *     PERFORM VN-TP-032-02-FRM-VAL-CRED.


           MOVE 'NUM-04'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-04'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



      *     PERFORM VN-TP-032-02-FRM-VAL-INTE.



           MOVE 'NUM-05'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-05'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.





      *     PERFORM VN-TP-032-02-FRM-VAL-VCOM.


           MOVE 'NUM-06'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-06'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


      *     PERFORM VN-TP-032-02-OPC-VAL-SEGD.



           MOVE 'NUM-07'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-07'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




      *     PERFORM VN-TP-032-02-FRM-VAL-GAST.



           MOVE 'NUM-08'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-08'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




      *     PERFORM VN-TP-032-02-FRM-VAL-IMPU.


           MOVE 'NUM-09'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-09'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




      *     PERFORM VN-TP-032-02-OPC-SGV-LIQU.

           MOVE 'NUM-10'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-10'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


      *     PERFORM VN-TP-032-02-ITR-SGV-TINT.


           MOVE 'NUM-11'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-11'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.





      *     PERFORM VN-TP-032-03-FRM-NUM-IVCT.


           MOVE 'NUM-12'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-12'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



      *     PERFORM VN-TP-032-03-FRM-VAL-SCAP.


           MOVE 'NUM-13'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-13'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



      *     PERFORM VN-TP-032-03-FRM-VAL-INTC.


           MOVE 'NUM-14'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-14'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


      *     PERFORM VN-TP-032-03-FRM-VAL-COMC.


           MOVE 'NUM-15'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-15'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



      *     PERFORM VN-TP-032-03-FRM-VAL-TOTA.


           MOVE 'NUM-16'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-16'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

       FIN-VAL-NUM-TP-REQ-032.
           EXIT.




       VN-TP-032-01-OPC-IIC-IOPC SECTION.
       VNI-TP-032-01-OPC-IIC-IOPC.
           MOVE TP-032-01-OPC-IIC-IOPC-NUM TO
                TP-032-01-OPC-IIC-IOPC-EDT.

           MOVE TP-032-01-OPC-IIC-IOPC-EDT TO
                TP-032-01-OPC-IIC-IOPC.
       VNF-TP-032-01-OPC-IIC-IOPC.
           EXIT.

       VN-TP-032-02-FRM-VAL-CRED SECTION.
       VNI-TP-032-02-FRM-VAL-CRED.
           MOVE TP-032-02-FRM-VAL-CRED-NUM TO
                TP-032-02-FRM-VAL-CRED-EDT.

           MOVE TP-032-02-FRM-VAL-CRED-EDT TO
                TP-032-02-FRM-VAL-CRED.

       VNF-TP-032-02-FRM-VAL-CRED.
           EXIT.

       VN-TP-032-02-FRM-VAL-INTE SECTION.
       VNI-TP-032-02-FRM-VAL-INTE.
           MOVE TP-032-02-FRM-VAL-INTE-NUM TO
                TP-032-02-FRM-VAL-INTE-EDT.

           MOVE TP-032-02-FRM-VAL-INTE-EDT TO
                TP-032-02-FRM-VAL-INTE.
       VNF-TP-032-02-FRM-VAL-INTE.
           EXIT.

       VN-TP-032-02-FRM-VAL-VCOM SECTION.
       VNI-TP-032-02-FRM-VAL-VCOM.
           MOVE TP-032-02-FRM-VAL-VCOM-NUM TO
                TP-032-02-FRM-VAL-VCOM-EDT.

           MOVE TP-032-02-FRM-VAL-VCOM-EDT TO
                TP-032-02-FRM-VAL-VCOM.
       VNF-TP-032-02-FRM-VAL-VCOM.
           EXIT.

       VN-TP-032-02-OPC-VAL-SEGD SECTION.
       VNI-TP-032-02-OPC-VAL-SEGD.
           MOVE TP-032-02-OPC-VAL-SEGD-NUM TO
                TP-032-02-OPC-VAL-SEGD-EDT.

           MOVE TP-032-02-OPC-VAL-SEGD-EDT TO
                TP-032-02-OPC-VAL-SEGD.
       VNF-TP-032-02-OPC-VAL-SEGD.
           EXIT.

       VN-TP-032-02-FRM-VAL-GAST SECTION.
       VNI-TP-032-02-FRM-VAL-GAST.
           MOVE TP-032-02-FRM-VAL-GAST-NUM TO
                TP-032-02-FRM-VAL-GAST-EDT.


           MOVE TP-032-02-FRM-VAL-GAST-EDT TO
                TP-032-02-FRM-VAL-GAST.
       VNF-TP-032-02-FRM-VAL-GAST.
           EXIT.

       VN-TP-032-02-FRM-VAL-IMPU SECTION.
       VNI-TP-032-02-FRM-VAL-IMPU.
           MOVE TP-032-02-FRM-VAL-IMPU-NUM TO
                TP-032-02-FRM-VAL-IMPU-EDT.

           MOVE TP-032-02-FRM-VAL-IMPU-EDT TO
                TP-032-02-FRM-VAL-IMPU.
       VNF-TP-032-02-FRM-VAL-IMPU.
           EXIT.

       VN-TP-032-02-OPC-SGV-LIQU SECTION.
       VNI-TP-032-02-OPC-SGV-LIQU.
           MOVE TP-032-02-OPC-SGV-LIQU-NUM TO
                TP-032-02-OPC-SGV-LIQU-EDT.

           MOVE TP-032-02-OPC-SGV-LIQU-EDT TO
                TP-032-02-OPC-SGV-LIQU.
       VNF-TP-032-02-OPC-SGV-LIQU.
           EXIT.

       VN-TP-032-02-ITR-SGV-TINT SECTION.
       VNI-TP-032-02-ITR-SGV-TINT.
           MOVE TP-032-02-ITR-SGV-TINT-NUM TO
                TP-032-02-ITR-SGV-TINT-EDT.

           MOVE TP-032-02-ITR-SGV-TINT-EDT TO
                TP-032-02-ITR-SGV-TINT.
       VNF-TP-032-02-ITR-SGV-TINT.
           EXIT.

       VN-TP-032-03-FRM-NUM-IVCT SECTION.
       VNI-TP-032-03-FRM-NUM-IVCT.



           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-NUM-IVCT.

           MOVE 'NUM-12.0'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-12.0'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE TP-032-03-FRM-NUM-IVCT( TPG-L , TPG-M )
                TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           IF TP-032-03-FRM-NUM-IVCT( TPG-L , TPG-M )
              NOT > SPACES
                GO TO VNF-TP-032-03-FRM-NUM-IVCT.

           MOVE TP-032-03-FRM-NUM-IVCT-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-NUM-IVCT-EDT.
           MOVE TP-032-03-FRM-NUM-IVCT-EDT TO
                TP-032-03-FRM-NUM-IVCT( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-NUM-IVCT
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-NUM-IVCT.
       VNF-TP-032-03-FRM-NUM-IVCT.
           EXIT.

       VN-TP-032-03-FRM-VAL-SCAP SECTION.
       VNI-TP-032-03-FRM-VAL-SCAP.








           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-VAL-SCAP.




           MOVE 'NUM-12.1'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-12.1'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE TP-032-03-FRM-VAL-SCAP( TPG-L , TPG-M )
                TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF TP-032-03-FRM-VAL-SCAP( TPG-L , TPG-M )
              NOT > SPACES
                GO TO VNF-TP-032-03-FRM-VAL-SCAP.

           MOVE TP-032-03-FRM-VAL-SCAP-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-VAL-SCAP-EDT.

           MOVE TP-032-03-FRM-VAL-SCAP-EDT TO
                TP-032-03-FRM-VAL-SCAP    ( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-VAL-SCAP
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-VAL-SCAP.
       VNF-TP-032-03-FRM-VAL-SCAP.
           EXIT.

       VN-TP-032-03-FRM-VAL-INTC SECTION.
       VNI-TP-032-03-FRM-VAL-INTC.
           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-VAL-INTC.


           IF TP-032-03-FRM-VAL-INTC( TPG-L , TPG-M )
              NOT > SPACES
               GO TO VNF-TP-032-03-FRM-VAL-INTC.

           MOVE TP-032-03-FRM-VAL-INTC-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-VAL-INTC-EDT.


           MOVE TP-032-03-FRM-VAL-INTC-EDT TO
                TP-032-03-FRM-VAL-INTC    ( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-VAL-INTC
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-VAL-INTC.
       VNF-TP-032-03-FRM-VAL-INTC.
           EXIT.

       VN-TP-032-03-FRM-VAL-COMC SECTION.
       VNI-TP-032-03-FRM-VAL-COMC.
           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-VAL-COMC.


           IF TP-032-03-FRM-VAL-COMC( TPG-L , TPG-M )
              NOT > SPACES
                GO TO VNF-TP-032-03-FRM-VAL-COMC.

           MOVE TP-032-03-FRM-VAL-COMC-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-VAL-COMC-EDT.


           MOVE TP-032-03-FRM-VAL-COMC-EDT TO
                TP-032-03-FRM-VAL-COMC    ( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-VAL-COMC
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-VAL-COMC.
       VNF-TP-032-03-FRM-VAL-COMC.
           EXIT.

       VN-TP-032-03-FRM-VAL-TOTA SECTION.
       VNI-TP-032-03-FRM-VAL-TOTA.
           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-VAL-TOTA.

           IF TP-032-03-FRM-VAL-TOTA( TPG-L , TPG-M )
               NOT > SPACES
                 GO TO VNF-TP-032-03-FRM-VAL-TOTA.

           MOVE TP-032-03-FRM-VAL-TOTA-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-VAL-TOTA-EDT.
           MOVE TP-032-03-FRM-VAL-TOTA-EDT TO
                TP-032-03-FRM-VAL-TOTA( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-VAL-TOTA
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-VAL-TOTA.
       VNF-TP-032-03-FRM-VAL-TOTA.
           EXIT.

       AA-OBTIENE-FECHA SECTION.
       INI-AA-OBTIENE-FECHA.
           MOVE EIBDATE  TO SYS-JHOY.
           MOVE EIBTIME  TO SYS-HHOY.

           MOVE SYS-AAHY TO SYS-AHOY.
           DIVIDE SYS-AAHY BY 4 GIVING SYS-REST REMAINDER SYS-REST.
           IF SYS-DDHY > 59 AND SYS-REST NOT = 0
               ADD 1     TO SYS-DDHY.
           PERFORM PARRAFO-NULO VARYING SYS-SIND FROM 1 BY 1 UNTIL
               SYS-SIND > 12 OR SYS-DDHY NOT > SYS-DACU(SYS-SIND).
           SUBTRACT 1    FROM SYS-SIND.
           MOVE SYS-SIND TO SYS-MHOY.
           SUBTRACT SYS-DACU(SYS-SIND) FROM SYS-DDHY GIVING SYS-DHOY.

           IF SYS-AHOY > 60
              MOVE 19 TO SYS-SHOY
           ELSE
              MOVE 20 TO SYS-SHOY
           END-IF.

           MOVE SYS-SHOY TO SYS-SSTP.
           MOVE SYS-AHOY TO SYS-AATS IN SYS-FSTP.
           MOVE SYS-MHOY TO SYS-MMTS IN SYS-FSTP.
           MOVE SYS-DHOY TO SYS-DDTS IN SYS-FSTP.
       FIN-AA-OBTIENE-FECHA.
           EXIT.

       PARRAFO-NULO SECTION.
       INI-PARRAFO-NULO.
       FIN-PARRAFO-NULO.
           EXIT.


       PRO-24H-INP SECTION.
       INI-PRO-24H-INP.

           PERFORM AA-OBTIENE-FECHA.
           MOVE SYS-DDTS IN SYS-FSTP TO FEC-ITM1.
           MOVE SYS-MMTS IN SYS-FSTP TO FEC-ITM2.
           MOVE SYS-SSTP             TO FEC-ITM3.
           MOVE SYS-AATS IN SYS-FSTP TO FEC-ITM4.
           MOVE FEC-VHBL-S           TO FEC-VHBL.
           MOVE FEC-FBLK-N           TO FEC-FBLK.
           MOVE FEC-CHOY-N           TO FEC-CHOY.
           MOVE FEC-FORM-FEC         TO FEC-FORM.
           MOVE FEC-VAL-FEC          TO FEC-CMND.
           PERFORM PRO-FEC.

           IF SYS-HHOY NOT > 080000 OR
              SYS-HHOY NOT < 200000 OR
              FEC-STAT-FER

                 MOVE FEC-FBLK-N   TO FEC-FBLK
                 MOVE FEC-CHOY-N   TO FEC-CHOY
                 MOVE FEC-FORM-FEC TO FEC-FORM
                 MOVE FEC-SIG-HBL  TO FEC-CMND
                 PERFORM CAL-FEC

                 MOVE FEC-ITM1     TO WSS-NUM-DDMA
                 MOVE FEC-ITM2     TO WSS-NUM-MDMA
                 MOVE FEC-ITM3     TO WSS-NUM-ADMA
                 MOVE FEC-ITM4     TO WSS-NUM-ADMA
                 MOVE WSS-FEC-FDMA TO PT-A03-01-NOP-FEC-FCUR.
       FIN-PRO-24H-INP.
           EXIT.


