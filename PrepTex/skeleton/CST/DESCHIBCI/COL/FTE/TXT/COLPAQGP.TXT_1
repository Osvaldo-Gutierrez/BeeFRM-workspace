*%! Codigo adicional para archivo
*% FRM = "QGP"
*%
*% ENTIDAD = "POC"
*% KEY_ENTIDAD = "POC-KEY-IPOC"
*% LARGO_KEY_ENTIDAD = 13
*% RELACION_ENTIDAD = "POC-KEY-IPOC"
*% LARGO_RELACION_ENTIDAD = 13
*% NUMERO_LINEAS_TABLA = 15
*% FIO_ENTIDAD = "COL-FIO-POC"
*% SIST_ENTIDAD = "COL"
*% BROWSE_ALL = TRUE
*% HIJO = "POC"
*% COLAR_HIJOS = TRUE
*%
*% ACEPTE_PF5 = TRUE
*% ACEPTE_PF6 = TRUE
*%
*% INCLUDE 'GNSSRC:PFSCONSEL.SRC'
*% IF WSS
      *<<<< WSS 
       03 WSS-COD-COOC.
          05 WSS-COD-TOOC                           PIC X(03).
          05 WSS-COD-AOOC                           PIC X(03).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      *>>>>
*% END
*% IF FIN_HBL_KEY OR FIN_HBL_IKY
      *<<<< FIN_HBL_KEY OR FIN_HBL_IKY
*% FOR I = 1 TO {NUMERO_LINEAS_TABLA}
           MOVE FRM-CPIM-AEY TO FRM-IND-TACC-ATR IN QGP-FLD({I}).
*% NEXT I
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF POC-COD-VCOC IN QGP-FLD = '*     '
               MOVE SPACES TO POC-COD-VCOC IN POC.
           IF POC-COD-AOOC IN QGP-FLD = '*  '
               MOVE SPACES TO POC-COD-AOOC IN POC.
           IF POC-COD-TOOC IN QGP-FLD = '*  '
               MOVE SPACES TO POC-COD-TOOC IN POC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF FIO-STAT-OKS
               MOVE POC-STP-ITRN IN POC TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-POC.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_SCR_TRL
      *<<<< FIN_SCR_TRL
           IF SCR-CCPP = 'ACC'
               PERFORM UNP-FLD-QGP.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       CARGAR-TABLA SECTION.
       INI-CARGAR-TABLA.
           MOVE POC-COD-VCOC IN POC TO FRM-COD-VCAM IN 
                                                    QGP-FLD(FRM-IFLD).
      *BUS-TAB busca glosa de codigo en tabla
           IF POC-COD-VCOC IN POC > SPACES
               MOVE 'TAB'  TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE POC-COD-VCOC IN POC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-VCAM IN QGP-FLD(FRM-IFLD)
           ELSE
               MOVE SPACES TO FRM-GLS-VCAM IN QGP-FLD(FRM-IFLD).

           MOVE POC-COD-TOOC IN POC TO FRM-COD-TIPO IN 
                                                    QGP-FLD(FRM-IFLD).
      *BUS-TAB busca glosa de codigo en tabla
           IF POC-COD-TOOC IN POC > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO ' TO TAB-COD-TTAB IN TAB
               MOVE POC-COD-TOOC IN POC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIPO IN QGP-FLD(FRM-IFLD)
           ELSE
               MOVE SPACES TO FRM-GLS-TIPO IN QGP-FLD(FRM-IFLD).

           MOVE POC-COD-AOOC IN POC TO FRM-COD-CAUX IN 
                                                    QGP-FLD(FRM-IFLD).

      *BUS-TAB busca glosa de codigo en tabla
           IF POC-COD-AOOC IN POC > SPACES
               MOVE POC-COD-TOOC IN POC TO WSS-COD-TOOC
               MOVE POC-COD-AOOC IN POC TO WSS-COD-AOOC
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-COOC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CAUX IN 
                                                   QGP-FLD(FRM-IFLD).
       FIN-CARGAR-TABLA.
           EXIT.
 
       LIMPIAR-TABLA SECTION.
       INI-LIMPIAR-TABLA.
           MOVE SPACES TO FRM-COD-VCAM IN QGP-FLD(FRM-IFLD).
           MOVE ZEROES TO FRM-GLS-VCAM IN QGP-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-COD-TIPO IN QGP-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-TIPO IN QGP-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-COD-CAUX IN QGP-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-CAUX IN QGP-FLD(FRM-IFLD).
       FIN-LIMPIAR-TABLA.
           EXIT.
      *>>>>
*% END
