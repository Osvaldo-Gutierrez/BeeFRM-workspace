*% IF FIN_VAL_CON_KEY_SPR
      *<<<< FIN_VAL_CON_KEY_SPR
      *>>>>
*% END
*% IF INI_CLR_KEY_GNP AND PGM_BQ
      *<<<< INI_CLR_KEY_GNP
           MOVE SPACES TO EVC-VARI.                                     
      *>>>>
*% END
*% IF FIN_FRM_IND_MODO
      *<<<<                                                             
           IF FRM-IND-MODO IN GNP-FLD = 'CTS' OR 'PZO'                  
              GO TO FIN-VAL-FRM-IND-MODO.                               
           MOVE 'COL'          TO MSG-COD-SIST.                         
           MOVE 'INDMODO  INV' TO MSG-COD-MENS.                         
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC   TO FRM-MENS.                             
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.                             
      *>>>>                                                             
*% END
*% IF INI_FRM_FEC_FCUR
      *<<<<                                                             
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
           IF FRM-FEC-FCUR IN GNP-FLD NOT > ZEROES                      
              PERFORM GET-FHOY                                          
              MOVE HOY-DHOY TO FRM-NUM-DCUR IN GNP-FLD                  
              MOVE HOY-MHOY TO FRM-NUM-MCUR IN GNP-FLD                  
              MOVE HOY-SHOY TO FRM-NUM-SCUR IN GNP-FLD                  
              MOVE HOY-AHOY TO FRM-NUM-ACUR IN GNP-FLD                  
              GO TO FIN-VAL-FRM-FEC-FCUR.                               
      *>>>>                                                             
*% END
*% IF INI_FRM_FEC_FPVC
      *<<<<                                                             
           MOVE FEC-FBLK-N  TO FEC-FBLK.                                
           MOVE FEC-CHOY-N  TO FEC-CHOY.                                
           MOVE FEC-VHBL-N  TO FEC-VHBL.                                
      *>>>>                                                             
*% END
*% IF INI_FRM_NUM_VIGU
      *<<<< INI_FRM_NUM_VIGU
           IF FRM-NUM-VIGU IN GNP-FLD NOT > ZEROES                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-FRM-NUM-VIGU.                             
      *>>>>                                                             
*% END
*% IF INI_FRM_NUM_SPVE
      *<<<< INI_FRM_NUM_SPVE
           IF FRM-NUM-SPVE IN GNP-FLD > ZEROES AND                      
              FRM-IND-UTPV IN GNP-FLD NOT > SPACES                      
              MOVE 'COL'          TO MSG-COD-SIST                       
              MOVE 'NUMSPVE  INV' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR.                          
      *>>>>                                                             
*% END
*% IF FIN_FRM_FEC_FPVC
      *<<<< FIN_FRM_FEC_FPVC
           MOVE FRM-NUM-DCUR IN GNP-FLD TO WSS-NUM-DMAX IN WSS-VARI.
           MOVE FRM-NUM-MCUR IN GNP-FLD TO WSS-NUM-MMAX IN WSS-VARI.    
           MOVE FRM-NUM-SCUR IN GNP-FLD TO WSS-NUM-SMAX IN WSS-VARI.    
           MOVE FRM-NUM-ACUR IN GNP-FLD TO WSS-NUM-AMAX IN WSS-VARI.    
           MOVE FRM-NUM-DPVC IN GNP-FLD TO WSS-NUM-DTMP IN WSS-VARI.    
           MOVE FRM-NUM-MPVC IN GNP-FLD TO WSS-NUM-MTMP IN WSS-VARI.    
           MOVE FRM-NUM-SPVC IN GNP-FLD TO WSS-NUM-STMP IN WSS-VARI.    
           MOVE FRM-NUM-APVC IN GNP-FLD TO WSS-NUM-ATMP IN WSS-VARI.    
           IF WSS-FEC-FTMP IN WSS-VARI < WSS-FEC-FMAX IN WSS-VARI       
              MOVE 'COL'          TO MSG-COD-SIST                       
              MOVE 'FECVCTO<CUR ' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
              GO TO FIN-VAL-FRM-FEC-FPVC.                               
      *>>>>                                                             
*% END
*% IF INI_FRM_NUM_SEVE
      *<<<<
           IF FRM-NUM-SEVE IN GNP-FLD NOT > ZEROES                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-FRM-NUM-SEVE.                             
      *>>>>                                                             
*% END
*% IF INI_FRM_IND_UTSV
      *<<<< INI_FRM_IND_UTSV
           IF FRM-IND-UTSV IN GNP-FLD NOT > SPACES                      
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-FRM-IND-UTSV.                               
      *VAL-IND Valida miscelaneo de tabla                               
           MOVE 'TAB' TO MSC-COD-SIST.                                  
           MOVE 'IPER' TO MSC-COD-TMSC IN MSC.                          
           MOVE FRM-IND-UTSV IN GNP-FLD TO MSC-COD-CMSC IN MSC.         
           PERFORM VAL-IND.                                             
           GO TO FIN-VAL-FRM-IND-UTSV.
      *>>>>                                                             
*% END
*% IF INI_VAL_CON_KEY_GNP
      *<<<< INI_VAL_CON_KEY_GNP                                         
           IF FRM-NUM-SPVE IN GNP-FLD NOT > ZEROES AND                  
              FRM-IND-UTPV NOT > SPACES                                 
              PERFORM OBT-SPVE                                          
              IF MSG-COD-MENS > SPACES                                  
                 PERFORM ERR-KEY                                        
                 PERFORM FST-KEY-GNP.                                   
      *>>>>                                                             
*% END
*% IF EOF_BQ
      *<<<<                                                             
       OBT-SPVE SECTION.                                                
       INI-OBT-SPVE.                                                    
           MOVE FRM-NUM-DCUR IN GNP-FLD  TO FEC-DEC1.                   
           MOVE FRM-NUM-MCUR IN GNP-FLD  TO FEC-MEC1.                   
           MOVE FRM-NUM-SCUR IN GNP-FLD  TO FEC-SEC1.                   
           MOVE FRM-NUM-ACUR IN GNP-FLD  TO FEC-AEC1.                   
           MOVE FRM-NUM-DPVC IN GNP-FLD  TO FEC-DEC2.                   
           MOVE FRM-NUM-MPVC IN GNP-FLD  TO FEC-MEC2.                   
           MOVE FRM-NUM-SPVC IN GNP-FLD  TO FEC-SEC2.                   
           MOVE FRM-NUM-APVC IN GNP-FLD  TO FEC-AEC2.                   
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-DIF-DIA  TO FEC-CMND.                               
           PERFORM CAL-FEC.                                             
           IF NOT FEC-STAT-OKS                                          
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'DIFDIA   INV' TO MSG-COD-MENS                      
               GO TO FIN-OBT-SPVE.                                      
           MOVE FEC-NDIA TO FRM-NUM-SPVE IN GNP-FLD.                    
           MOVE 'D'      TO FRM-IND-UTPV IN GNP-FLD.                    
       FIN-OBT-SPVE.                                                    
           EXIT.                                                        
      *>>>>                                                             
*% END
