*%! Codigo adicional para archivo
*% IF SETTAG
*% FNCBQ = " "
*% VSNBQ = " "
*% FNCBU = " "
*% VSNBU = " "
*% END

*% IF FIN_KEY_CXE_CXE
      *<<<< EVA-INI  11/08    
           PERFORM EDT-IIC.                                                   
           IF WSS-IIC-IOPV IN CMA-VARI = '00000000'                           
              MOVE SPACES TO CXE-IIC-IOPV IN CXE                             
           ELSE                                                             
              MOVE WSS-IIC-IOPV IN CMA-VARI TO CXE-IIC-IOPV IN CXE.
      *>>>> EVA-FIN  11/08                                                    
*% END
*% IF FIN_PUT_CXE_CXE
      *<<<<
           PERFORM EDT-IIC.                                                     
           IF WSS-CXE-IIC-IOPV = '00000000'                                     
              MOVE SPACES TO CXE-IIC-IOPV IN CXE-FLD                            
           ELSE                                                                 
              MOVE WSS-CXE-IIC-IOPV TO CXE-IIC-IOPV IN CXE-FLD.                 
      *>>>>
*% END
*% IF INI_CXE_FEC_FVEN
      *<<<<
           MOVE FEC-CHOY-GE TO FEC-CHOY.
      *>>>>
*% END
*% IF FIN_CXE_IIC_IOPC
      *<<<<
           MOVE CXE-CAI-IOPC IN CXE-FLD TO OPC-CAI-IOPC IN OPC.                 
           MOVE CXE-IIC-IOPC IN CXE-FLD TO OPC-IIC-IOPC IN OPC.                 
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM COL-FIO-OPC.                                                 
           IF NOT FIO-STAT-OKS                                                  
              MOVE 'COL' TO MSG-COD-SIST                                        
              MOVE 'OPC    NEX' TO MSG-COD-MENS                                 
              PERFORM GET-MSG                                                   
              MOVE MSG-GLS-DESC TO FRM-MENS                                     
              MOVE FRM-SUAR-MAL TO FRM-SUAR.                                    
                                                                                
      * EVA-FIN / JUN 2008                                                      
      *>>>>      
*% END
*% IF FIN_CXE_IIC_IOPV
      *<<<<
      * EVA-INI  11/08                                                          
           MOVE ZEROES TO WSS-IIC-IOPC IN CMA-VARI.                             
                                                                                
           IF CXE-CAI-IOPV IN CXE-FLD > SPACES AND                              
              CXE-IIC-IOPV IN CXE-FLD NOT > SPACES                              
                PERFORM ERR-GLS                                                 
                GO TO FIN-VAL-CXE-IIC-IOPV.                                     
                                                                                
           IF CXE-IIC-IOPV IN CXE-FLD NOT > SPACES                              
              MOVE SPACES TO CXE-IIC-IOPV IN CXE-FLD                            
              GO TO FIN-VAL-CXE-IIC-IOPV.                                       
                                                                                
           MOVE CXE-IIC-IOPV IN CXE-FLD TO WSS-IIC-IOPC IN CMA-VARI.            
                                                                                
           MOVE ZEROES TO IOPV-I.                                               
           MOVE ZEROES TO IOPV-J.                                               
                                                                                
           PERFORM EDT-IIC.                                                     
           IF WSS-CXE-IIC-IOPV = '00000000'                                     
              MOVE SPACES TO CXE-IIC-IOPV IN CXE-FLD                            
           ELSE                                                                 
              MOVE WSS-CXE-IIC-IOPV TO CXE-IIC-IOPV IN CXE-FLD.                 
                                                                                
           IF CXE-CAI-IOPV IN CXE-FLD > SPACES                                  
      * EVA-FIN  11/08                                                          
              MOVE CXE-CAI-IOPV IN CXE-FLD TO OPC-CAI-IOPC IN OPC               
              MOVE WSS-IIC-IOPV            TO OPC-IIC-IOPC IN OPC
              MOVE FIO-GET-KEY TO FIO-CMND                                      
              PERFORM COL-FIO-OPC                                               
              IF NOT FIO-STAT-OKS                                               
                 MOVE 'COL' TO MSG-COD-SIST                                     
                 MOVE 'OPC    NEX' TO MSG-COD-MENS                              
                 PERFORM GET-MSG                                                
                 MOVE MSG-GLS-DESC TO FRM-MENS                                  
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.                                 
      *>>>>
*% END
*% IF FIN_CXE_COD_EVEN
      *<<<<
           MOVE 'COL'                   TO TAB-COD-SIST FIO-SIST.               
           MOVE 'EVN'                   TO TAB-COD-TTAB IN TAB.                 
           MOVE CXE-COD-EVEN IN CXE-FLD TO TAB-COD-CTAB IN TAB.                 
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM GNS-FIO-TAB.                                                 
           IF NOT (FIO-STAT-OKS AND                                             
              TAB-IND-VIGE IN TAB = 'S')                                        
              MOVE 'COL' TO MSG-COD-SIST                                        
              MOVE 'EVN    NEX' TO MSG-COD-MENS                                 
              PERFORM GET-MSG                                                   
              MOVE MSG-GLS-DESC TO FRM-MENS                                     
              MOVE FRM-SUAR-MAL TO FRM-SUAR                                     
           ELSE                                                                 
              MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.             
      *>>>>
*% END
*% IF INI_CXE_COD_CPTO
      *<<<<
           IF WSS-IND-OBLG IN WSS-VARI = 'N'                                    
              MOVE SPACES TO CXE-COD-CPTO IN CXE-FLD                            
              GO TO FIN-VAL-CXE-COD-CPTO.                                       
                                                                                
           IF CXE-COD-CPTO IN CXE-FLD NOT > SPACES                              
                PERFORM ERR-GLS                                                 
                GO TO FIN-VAL-CXE-COD-CPTO.                                     
                                                                                
           MOVE 'COL'                   TO TAB-COD-SIST FIO-SIST.               
           MOVE 'CTO'                   TO TAB-COD-TTAB IN TAB.                 
           MOVE CXE-COD-CPTO IN CXE-FLD TO TAB-COD-CTAB IN TAB.                 
           MOVE FIO-GET-KEY TO FIO-CMND.                                        
           PERFORM GNS-FIO-TAB.                                                 
           IF NOT (FIO-STAT-OKS AND                                             
              TAB-IND-VIGE IN TAB = 'S')                                        
              MOVE 'COL' TO MSG-COD-SIST                                        
              MOVE 'CTO    NEX' TO MSG-COD-MENS                                 
              PERFORM GET-MSG                                                   
              MOVE MSG-GLS-DESC TO FRM-MENS                                     
              MOVE FRM-SUAR-MAL TO FRM-SUAR.

           GO TO FIN-VAL-CXE-COD-CPTO.                                    
      *>>>>		
*% END
*% IF INI_FRM_GLS_TINT
      *<<<< 
           MOVE '01' TO WSS-IND-CMPO IN CXE-VARI.                               
           PERFORM DEF-GLS.                                                     
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                                    
              MOVE WSS-GLS-DESC IN WSS-VARI TO                                  
                   FRM-GLS-TINT IN CXE-FLD                                      
           ELSE                                                                 
              MOVE 'TIP TASA INT' TO FRM-GLS-TINT IN CXE-FLD.                   
      *>>>> 
*% END
*% IF INI_FRM_GLS_CBRO
      *<<<<    
           MOVE '14' TO WSS-IND-CMPO IN CXE-VARI.                               
           PERFORM DEF-GLS.                                                     
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                                    
              MOVE WSS-GLS-DESC IN WSS-VARI TO                                  
                   FRM-GLS-CBRO IN CXE-FLD                                      
           ELSE                                                                 
      * PVC-INI 29-AGO-2011 CAMBIAR GLOSA DE TITULOS      
      *       MOVE 'MOD. COBRO  ' TO FRM-GLS-CBRO IN CXE-FLD.
              MOVE 'COD. ANUL.  ' TO FRM-GLS-CBRO IN CXE-FLD.                   
      * PVC-FIN 29-AGO-2011
      *>>>>   
*% END
*% IF INI_FRM_GLS_TTNT
      *<<<<  
           MOVE '02' TO WSS-IND-CMPO IN CXE-VARI.                               
           PERFORM DEF-GLS.                                                     
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                                    
              MOVE WSS-GLS-DESC IN WSS-VARI TO                                  
                   FRM-GLS-TTNT IN CXE-FLD                                      
           ELSE                                                                 
              MOVE 'VALOR TASA  ' TO FRM-GLS-TTNT IN CXE-FLD.                   
      *>>>> 
*% END
*% IF INI_FRM_GLS_FVEN
      *<<<< 
           MOVE '15' TO WSS-IND-CMPO IN CXE-VARI.                               
           PERFORM DEF-GLS.                                                     
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                                    
              MOVE WSS-GLS-DESC IN WSS-VARI TO                                  
                   FRM-GLS-FVEN IN CXE-FLD                                      
           ELSE
      * PVC-INI 29-AGO-2011 CAMBIAR GLOSA DE TITULOS
      *       MOVE 'FECHA VCTO  ' TO FRM-GLS-FVEN IN CXE-FLD. 
              MOVE 'FEC. ANUL.  ' TO FRM-GLS-FVEN IN CXE-FLD.
      * PVC-FIN 29-AGO-2011
      *>>>>  
*% END
*% IF INI_FRM_GLS_MNTO
      *<<<<     
           MOVE '03' TO WSS-IND-CMPO IN CXE-VARI.                               
           PERFORM DEF-GLS.                                                     
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                                    
              MOVE WSS-GLS-DESC IN WSS-VARI TO                                  
                   FRM-GLS-MNTO IN CXE-FLD                                      
           ELSE                                                                 
              MOVE 'VALOR MONTO ' TO FRM-GLS-MNTO IN CXE-FLD.                   
      *>>>>    
*% END
*% IF INI_FRM_GLS_FOGA
      *<<<< 
           MOVE '16' TO WSS-IND-CMPO IN CXE-VARI.                               
           PERFORM DEF-GLS.                                                     
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                                    
              MOVE WSS-GLS-DESC IN WSS-VARI TO                                  
                   FRM-GLS-FOGA IN CXE-FLD                                      
           ELSE
      * PVC-INI 29-AGO-2011 CAMBIAR GLOSA DE TITULOS
      *       MOVE 'IND. FOGAPE ' TO FRM-GLS-FOGA IN CXE-FLD.		
              MOVE 'IND. ANUL.  ' TO FRM-GLS-FOGA IN CXE-FLD.
      * PVC-FIN 29-AGO-2011
      *>>>>     
*% END
*% IF INI_FRM_GLS_MCAL
      *<<<<     
           MOVE '04' TO WSS-IND-CMPO IN CXE-VARI.                               
           PERFORM DEF-GLS.                                                     
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                                    
              MOVE WSS-GLS-DESC IN WSS-VARI TO                                  
                   FRM-GLS-MCAL IN CXE-FLD                                      
           ELSE                                                                 
              MOVE 'MONTO CALCUL' TO FRM-GLS-MCAL IN CXE-FLD.                   
      *>>>> 
*% END
*% IF INI_FRM_GLS_DCTO
      *<<<<   
           MOVE '05' TO WSS-IND-CMPO IN CXE-VARI.                               
           PERFORM DEF-GLS.                                                     
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                                    
              MOVE WSS-GLS-DESC IN WSS-VARI TO                                  
                   FRM-GLS-DCTO IN CXE-FLD                                      
           ELSE                                                                 
              MOVE 'IND. DCTO   ' TO FRM-GLS-DCTO IN CXE-FLD.                   
      *>>>>    
*% END
*% IF INI_FRM_GLS_HPLA
      *<<<<                                                
           MOVE '11' TO WSS-IND-CMPO IN CXE-VARI.                       
           PERFORM DEF-GLS.                                             
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                            
              MOVE WSS-GLS-DESC IN WSS-VARI TO                          
                   FRM-GLS-HPLA IN CXE-FLD                              
           ELSE                                                         
              MOVE 'HRA PLANILLA' TO FRM-GLS-HPLA IN CXE-FLD.           
      *>>>>                                                 
*% END
*% IF FIN_CXE_IND_DCTO
      *<<<<
           IF CXE-IND-DCTO IN CXE-FLD > SPACES                          
               MOVE 'GNS'   TO TAB-COD-SIST FIO-SIST                    
               MOVE 'SON '  TO TAB-COD-TTAB IN TAB                      
               MOVE CXE-IND-DCTO IN CXE-FLD TO TAB-COD-CTAB IN TAB      
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF FIO-STAT-OKS                                          
                  GO TO FIN-VAL-CXE-IND-DCTO                            
               ELSE                                                     
                  MOVE SPACES TO CXE-IND-DCTO IN CXE-FLD.               
      *>>>>
*% END	
*% IF INI_FRM_GLS_VCOC
      *<<<<                                               
           MOVE '06' TO WSS-IND-CMPO IN CXE-VARI.                       
           PERFORM DEF-GLS.                                             
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                            
              MOVE WSS-GLS-DESC IN WSS-VARI TO                          
                   FRM-GLS-VCOC IN CXE-FLD                              
           ELSE                                                         
              MOVE 'VALOR CAMBIO' TO FRM-GLS-VCOC IN CXE-FLD.           
      *>>>> 
*% END
*% IF FIN_CXE_COD_VCOC
      *<<<<
           IF CXE-COD-VCOC IN CXE-FLD > SPACES                          
               MOVE 'TAB'   TO TAB-COD-SIST FIO-SIST                    
               MOVE 'VLR '  TO TAB-COD-TTAB IN TAB                      
               MOVE CXE-COD-VCOC IN CXE-FLD TO TAB-COD-CTAB IN TAB      
               MOVE FIO-GET-KEY TO FIO-CMND                             
               PERFORM GNS-FIO-TAB                                      
               IF FIO-STAT-OKS                                          
                  GO TO FIN-VAL-CXE-COD-VCOC                            
               ELSE                                                     
                  MOVE SPACES TO CXE-COD-VCOC IN CXE-FLD.               
      *>>>>
*% END
*% IF INI_FRM_GLS_MCAM
      *<<<<                                                 
           MOVE '07' TO WSS-IND-CMPO IN CXE-VARI.                       
           PERFORM DEF-GLS.                                             
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                            
              MOVE WSS-GLS-DESC IN WSS-VARI TO                          
                   FRM-GLS-MCAM IN CXE-FLD                              
           ELSE                                                         
              MOVE 'MONTO CAMBIO' TO FRM-GLS-MCAM IN CXE-FLD.           
      *>>>>                                                
*% END
*% IF INI_FRM_GLS_IPLA
      *<<<<                                                
           MOVE '08' TO WSS-IND-CMPO IN CXE-VARI.                       
           PERFORM DEF-GLS.                                             
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                            
              MOVE WSS-GLS-DESC IN WSS-VARI TO                          
                   FRM-GLS-IPLA IN CXE-FLD                              
           ELSE                                                         
              MOVE 'PLANILLA    ' TO FRM-GLS-IPLA IN CXE-FLD.           
      *>>>>                                                 
*% END
*% IF INI_FRM_GLS_EVEX
      *<<<<                                                 
           MOVE '09' TO WSS-IND-CMPO IN CXE-VARI.                       
           PERFORM DEF-GLS.                                             
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                            
              MOVE WSS-GLS-DESC IN WSS-VARI TO                          
                   FRM-GLS-EVEX IN CXE-FLD                              
           ELSE                                                         
              MOVE 'COD. EVENTO ' TO FRM-GLS-EVEX IN CXE-FLD.           
      *>>>>                                                 
*% END
*% IF INI_FRM_GLS_FPLA
      *<<<<                                                 
           MOVE '10' TO WSS-IND-CMPO IN CXE-VARI.                       
           PERFORM DEF-GLS.                                             
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                            
              MOVE WSS-GLS-DESC IN WSS-VARI TO                          
                   FRM-GLS-FPLA IN CXE-FLD                              
           ELSE                                                         
              MOVE 'FEC PLANILLA' TO FRM-GLS-FPLA IN CXE-FLD.           
      *>>>>                                                 
*% END
*% IF INI_CXE_HRA_HPLA
      *<<<<
           IF CXE-HRA-HPLA IN CXE-FLD NOT > SPACES                      
              GO TO FIN-VAL-CXE-HRA-HPLA.                               
                                                                        
           MOVE CXE-HRA-HPLA IN CXE-FLD TO                              
                WSS-HRA-HPLA IN WSS-VARI.                               
                                                                        
           IF WSS-HRA-HORA IN WSS-VARI > '24'                           
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'ERR    HRA' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE MSG-GLS-DESC TO FRM-MENS                            
           ELSE                                                         
           IF WSS-HRA-MINU IN WSS-VARI > '59'                           
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'ERR    MIN' TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE MSG-GLS-DESC TO FRM-MENS                            
           ELSE                                                         
           IF WSS-HRA-SEGU IN WSS-VARI > '59'                           
              MOVE 'COL'        TO MSG-COD-SIST                         
              MOVE 'ERR    SEG' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              MOVE MSG-GLS-DESC TO FRM-MENS.                            
                                                                        
           IF WSS-HRA-HORA IN WSS-VARI NOT > SPACES                     
               MOVE '00' TO WSS-HRA-HORA IN WSS-VARI                    
           ELSE                                                         
           IF WSS-HRA-MINU IN WSS-VARI NOT > SPACES                     
               MOVE '00' TO WSS-HRA-MINU IN WSS-VARI                    
           ELSE                                                         
           IF WSS-HRA-SEGU IN WSS-VARI NOT > SPACES                     
               MOVE '00' TO WSS-HRA-SEGU IN WSS-VARI.                   
      *>>>>
*% END
*% IF INI_FRM_GLS_PLAN
      *<<<<                                                 
           MOVE '12' TO WSS-IND-CMPO IN CXE-VARI.                       
           PERFORM DEF-GLS.                                             
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                            
              MOVE WSS-GLS-DESC IN WSS-VARI TO                          
                   FRM-GLS-PLAN IN CXE-FLD                              
           ELSE                                                         
              MOVE 'CORRELATIVO ' TO FRM-GLS-PLAN IN CXE-FLD.           
      *>>>>                                                 
*% END
*% IF INI_FRM_GLS_SALD
      *<<<<                                                 
           MOVE '13' TO WSS-IND-CMPO IN CXE-VARI.                       
           PERFORM DEF-GLS.                                             
           IF WSS-IND-EXIS IN WSS-VARI = 'S'                            
              MOVE WSS-GLS-DESC IN WSS-VARI TO                          
                   FRM-GLS-SALD IN CXE-FLD                              
           ELSE                                                         
              MOVE 'VALOR MONTO ' TO FRM-GLS-SALD IN CXE-FLD.           
      *>>>>                                                 
*% END
*% IF EOF_BU
      *<<<<                                                 
       DEF-GLS SECTION.                                                 
       INI-DEF-GLS.                                                     
                                                                        
           MOVE 'S'       TO WSS-IND-EXIS IN WSS-VARI.                  
                                                                        
           MOVE CXE-COD-EVEN IN CXE-FLD TO WSS-IND-EVEN IN CXE-VARI.    
           MOVE CXE-COD-CPTO IN CXE-FLD TO WSS-IND-CPTO IN CXE-VARI.    
           MOVE SPACES                  TO WSS-IND-DISP IN CXE-VARI.    
                                                                        
           MOVE 'COL'                    TO TAB-COD-SIST FIO-SIST.      
           MOVE 'CXE'                    TO TAB-COD-TTAB IN TAB.        
           MOVE WSS-COD-GCXE IN CXE-VARI TO TAB-COD-CTAB IN TAB.        
           MOVE FIO-GET-KEY              TO FIO-CMND.                   
           PERFORM GNS-FIO-TAB.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               TAB-IND-VIGE IN TAB = 'S')                               
               MOVE 'N'   TO WSS-IND-EXIS IN WSS-VARI                   
               GO TO FIN-DEF-GLS.                                       
                                                                        
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DESC IN WSS-VARI.        
                                                                        
       FIN-DEF-GLS.                                                     
           EXIT.                                                        
      *>>>>                                               
*% END    
