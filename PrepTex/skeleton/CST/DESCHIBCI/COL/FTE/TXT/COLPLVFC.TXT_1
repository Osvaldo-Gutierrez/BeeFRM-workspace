*%! Codigo adicional para archivo
*% IF WSS
      *<<<< WSS
      *DPM ini  15-FEB-1996
       COPY COLWGCTO.
       COPY COLBRTOC.
       COPY TABBRTIO.
      *DPM fin  15-FEB-1996
       COPY COLBRDLC.
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY SGCBRDCP.
       COPY SGCBRDCE.
       COPY COLBROPC.
       COPY GNSWGHOY.
       COPY GNSWGFEC.
       COPY GNSWGCPT.
       COPY TABBRUSR.
       01  WSS-VARI.
           03  WSS-FEC-FHST.
               05  WSS-NUM-SHST       PIC 9(02).
               05  WSS-NUM-AHST       PIC 9(02).
               05  WSS-NUM-MHST       PIC 9(02).
               05  WSS-NUM-DHST       PIC 9(02).
           03  WSS-NUM-NDIA           PIC 9(02).
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *DPM ini  15-FEB-1996
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
      *DPM fin  15-FEB-1996
      *>>>>
*% END
*% IF INI		
      *<<<< INI
      * Acepta Numero de Dias como Parametro.
           ACCEPT WSS-NUM-NDIA IN WSS-VARI.
           IF WSS-NUM-NDIA IN WSS-VARI NOT NUMERIC
               DISPLAY 'ERROR DIAS NO NUMERICO'
               PERFORM GNS-PRO-ABT.

      * Obtengo Fecha de HOY
           PERFORM GET-FHOY.
      * Traspaso la Fecha "Desde" al Reporte  
           MOVE HOY-DHOY TO WSS-NUM-DDES IN WSS-VFC.
           MOVE HOY-MHOY TO WSS-NUM-MDES IN WSS-VFC.
           MOVE HOY-SHOY TO WSS-NUM-SDES IN WSS-VFC.
           MOVE HOY-AHOY TO WSS-NUM-ADES IN WSS-VFC.
      *
           MOVE HOY-DHOY     TO FEC-ITM1.
           MOVE HOY-MHOY     TO FEC-ITM2.
           MOVE HOY-SHOY     TO FEC-ITM3.
           MOVE HOY-AHOY     TO FEC-ITM4.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE WSS-NUM-NDIA TO FEC-NDIA.
           PERFORM CAL-FEC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE PUEDE CALCULAR NUMERO DE DIAS'
              PERFORM GNS-PRO-ABT.
           MOVE FEC-ITM1 TO WSS-NUM-DHAS IN WSS-VFC.
           MOVE FEC-ITM2 TO WSS-NUM-MHAS IN WSS-VFC.
           MOVE FEC-ITM3 TO WSS-NUM-SHAS IN WSS-VFC.
           MOVE FEC-ITM4 TO WSS-NUM-AHAS IN WSS-VFC.

           MOVE FEC-ITM1 TO WSS-NUM-DHST IN WSS-VARI.
           MOVE FEC-ITM2 TO WSS-NUM-MHST IN WSS-VARI.
           MOVE FEC-ITM3 TO WSS-NUM-SHST IN WSS-VARI.
           MOVE FEC-ITM4 TO WSS-NUM-AHST IN WSS-VARI.

      * Abro los Archivos que necesito.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO OPC'
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO RDC'
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM COL-FIO-TOC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO TOC'
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO DBC'
               PERFORM GNS-PRO-ABT.

           MOVE FIO-INP TO FIO-CMND.
           MOVE 'SGC' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               DISPLAY 'ERROR EN APERTURA ARCHIVO TAB'
               PERFORM GNS-PRO-ABT.

      *DPM ini  14-FEB-1996
           MOVE FIO-INP TO FIO-CMND.
           MOVE 'TAB' TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS 
               DISPLAY 'ERROR EN APERTURA ARCHIVO TAB'
               PERFORM GNS-PRO-ABT.

      * Proceso para Cargar las tablas  TAB/TIO  y  COL/TOC  en Memoria
           PERFORM COL-CRG-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
               PERFORM GNS-PRO-ABT.
      *DPM fin  14-FEB-1996
      *>>>>
*% END
*% IF INI_FST_INP
      *<<<< INI_FST_INP
           MOVE WSS-NUM-DDES TO VEN-NUM-DVEN IN VEN.
           MOVE WSS-NUM-MDES TO VEN-NUM-MVEN IN VEN.
           MOVE WSS-NUM-SDES TO VEN-NUM-SVEN IN VEN.
           MOVE WSS-NUM-ADES TO VEN-NUM-AVEN IN VEN.
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS 
               DISPLAY 'NO SE ENCONTRO REGISTRO VEN'
               GO TO FIN-INP-SRT
           ELSE
               GO TO LUP-INP-SRT.
      *>>>>
*% END
*% IF LUP_INP
      *<<<< LUP_INP
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FHST IN WSS-VARI
              GO TO FIN-INP-SRT.

           IF VEN-VAL-FINA IN VEN = ZEROES
              GO TO NXT-INP-SRT.

           MOVE VEN-CAI-IOPC IN VEN TO OPC-CAI-IOPC IN OPC.
           MOVE VEN-IIC-IOPC IN VEN TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE ENCONTRO REGISTRO OPC : '
                      OPC-CIC-IOPC IN OPC
              GO TO NXT-INP-SRT.

           IF OPC-MSC-STAT IN OPC NOT = 'A'
               GO TO NXT-INP-SRT.

           IF OPC-VAL-SCRE IN OPC NOT > ZEROES
               GO TO NXT-INP-SRT.

           MOVE VEN-CAI-IOPC IN VEN TO RDC-CAI-IOPC IN RDC.
           MOVE VEN-IIC-IOPC IN VEN TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'      TO FIO-AKEY.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE ENCONTRO REGISTRO RDC PARA OPC: '
                       VEN-CIC-IOPC IN VEN
              GO TO NXT-INP-SRT.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE ENCONTRO REGISTRO DBC PARA OPC: '
                       VEN-CIC-IOPC IN VEN
              GO TO NXT-INP-SRT.
           
           IF DBC-IND-TICL IN DBC = 'P'
               MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCP
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO SE ENCONTRO REGISTRO DCP PARA OPC: '
                       VEN-CIC-IOPC IN VEN
                   GO TO NXT-INP-SRT
               ELSE
                   IF DCP-COD-TBAN IN DCP = 'C1 ' OR
                      DCP-COD-TBAN IN DCP = 'C2 '
                      MOVE DCP-COD-TBAN IN DCP TO SRT-COD-TBAN IN SRT
                   ELSE
                       GO TO NXT-INP-SRT
           ELSE
               MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DCE
               IF NOT FIO-STAT-OKS
                   DISPLAY 'NO SE ENCONTRO REGISTRO DCE PARA OPC: '
                       VEN-CIC-IOPC IN VEN
                   GO TO NXT-INP-SRT
               ELSE
                   IF DCE-COD-TBAN IN DCE = 'C1 ' OR
                      DCE-COD-TBAN IN DCE = 'C2 '
                      MOVE DCE-COD-TBAN IN DCE TO SRT-COD-TBAN IN SRT
                   ELSE
                       GO TO NXT-INP-SRT.
      *>>>>
*% END
*% IF INI_NXT_INP
      *<<<< INI_NXT_INP
           MOVE 'VEN-FEC-FVEN' TO FIO-AKEY.
      *>>>>
*% END
*% IF FIN_NXT_INP
      *<<<< FIN_NXT_INP
           IF VEN-FEC-FVEN IN VEN > WSS-FEC-FHST IN WSS-VARI
               GO TO FIN-INP-SRT.
      *>>>>
*% END
*% IF LUP_OUT
      *<<<< LUP_OUT
           MOVE 'SGC'                   TO FIO-SIST.
           MOVE 'BAN'                   TO TAB-COD-TTAB.
           MOVE SRT-COD-TBAN IN SRT     TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TBAN IN WSS-VFC
           ELSE
               MOVE SPACES TO WSS-GLS-TBAN IN WSS-VFC.

           MOVE VEN-CAI-IOPC IN SRT TO OPC-CAI-IOPC IN OPC.
           MOVE VEN-IIC-IOPC IN SRT TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE ENCONTRO REGISTRO OPC : '
                      OPC-CIC-IOPC IN OPC
              GO TO NXT-OUT-SRT.

      *DPM ini  14-FEB-1996
           PERFORM OBT-GLS-MONE.
      *DPM fin  14-FEB-1996

           MOVE VEN-CAI-IOPC IN SRT TO DLC-CAI-IOPC IN DLC.
           MOVE VEN-IIC-IOPC IN SRT TO DLC-IIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS         TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE ENCONTRO REGISTRO DLC'
                      OPC-CIC-IOPC IN OPC
              GO TO NXT-OUT-SRT.
           MOVE RDC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              DISPLAY 'NO SE ENCONTRO REGISTRO DBC'
                      OPC-CIC-IOPC IN OPC
              GO TO NXT-OUT-SRT.

           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.

      *DPM ini  15-FEB-1996
      * Busca con el Codigo Tipo Operacion en la Tabla cargada en Memori
      * 'Sistema que lo Maneja' y 'Opera Como'
           MOVE OPC-COD-TOOC IN OPC TO CTO-TOOC IN CTO-VARI.
           PERFORM COL-BUS-CTO.
           IF CTO-CMSG IN CTO-VARI > SPACES
               MOVE 'COL'                TO MSG-COD-SIST
               MOVE CTO-CMSG IN CTO-VARI TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC IN MSG CTO-MEN2 IN CTO-VARI
                       'CON CODIGO : '     CTO-TOOC IN CTO-VARI
                       ' EN CREDITO : '    OPC-CIC-IOPC IN OPC
               GO TO NXT-OUT-SRT.

      * Valida el 'Sistema que lo Maneja' de la Operacion de Credito sea
      * COL - CES - TCR - SCC - SGE
      *     IF NOT ( CTO-SIST IN CTO-VARI = 'COL' )
      *         GO TO NXT-OUT-SRT.

      * Boleta Garantia
           IF CTO-OPEC IN CTO-VARI NOT = 'B'
               SUBTRACT VEN-VAL-SCAP IN SRT FROM VEN-VAL-SFIN IN SRT 
                                      GIVING WSS-VAL-INTV IN WSS-VFC
           ELSE
               MOVE VEN-VAL-SFIN IN SRT TO WSS-VAL-INTV IN WSS-VFC.
      *DPM fin  15-FEB-1996

           IF VEN-NUM-IVCT IN SRT > OPC-NUM-IVEN IN OPC
               MOVE ' SI' TO WSS-IND-MOR IN WSS-VFC
           ELSE
               MOVE ' NO' TO WSS-IND-MOR IN WSS-VFC.

           MOVE OPC-COD-RMOC IN SRT TO USR-COD-USER IN USR.
           PERFORM BUS-USR.
           MOVE USR-GLS-DESC IN USR TO WSS-GLS-RMOC IN WSS-VFC.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF

      *DPM ini  14-FEB-1996
       OBT-GLS-MONE SECTION.
       INI-OBT-GLS-MONE.
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'VLR'               TO TAB-COD-TTAB IN TAB.
           MOVE OPC-COD-VCOC IN OPC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS NOT = SPACES
              MOVE MSG-GLS-DCOR TO WSS-GLS-MONE IN WSS-VFC
           ELSE
              MOVE TAB-GLS-ABRV TO WSS-GLS-MONE IN WSS-VFC.
       FIN-OBT-GLS-MONE.
           EXIT.
      *DPM fin  14-FEB-1996

       COPY COLBFDLC.
       COPY COLBFRDC.
       COPY SGCBFDBC.
       COPY SGCBFDCE.
       COPY SGCBFDCP.
       COPY COLBFOPC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBPFEC.       
       COPY GNSBBMSG.
       COPY GNSBGCPT.
       COPY TABBBUSR.
       COPY TABBFUSR.
      *DPM ini  14-FEB-1996
       COPY GNSBBTAB.
       COPY COLBGCTO.
       COPY COLBFTOC.
       *DPM fin  14-FEB-199
      *>>>>
*% END
