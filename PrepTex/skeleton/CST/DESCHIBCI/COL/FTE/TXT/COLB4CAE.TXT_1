      ******************************************************************
       TOT-CUO SECTION.
       INI-TOT-CUO.
      *ALDI
           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           PERFORM GRB-REG-RCV.
      *ALDF
           MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN.
           MOVE 999 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = VEN-CIC-IOPC IN VEN
               MOVE VEN-NUM-IVEN IN VEN TO WSS-MAXV
           ELSE
               MOVE ZEROES TO WSS-MAXV.
           MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN.
           MOVE ZEROES TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = VEN-CIC-IOPC IN VEN
               MOVE VEN-NUM-IVEN IN VEN TO WSS-MINV
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE ZEROES TO WSS-MINV.
           MOVE CAN-CIC-IOPC IN CAN TO VEN-CIC-IOPC IN VEN.
           PERFORM PRO-VCT VARYING VEN-NUM-IVEN IN VEN
                   FROM WSS-MINV BY 1 UNTIL NOT FIO-STAT-OKS OR
                   VEN-NUM-IVEN IN VEN > WSS-MAXV.
           IF MSG-COD-MENS > SPACES
               GO TO FIN-TOT-CUO.
           MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC.
           MOVE 999 TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = DLC-CIC-IOPC IN DLC
               MOVE DLC-NUM-IDLC IN DLC TO WSS-MAXD
           ELSE
               MOVE ZEROES TO WSS-MAXD.
           MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = DLC-CIC-IOPC IN DLC
               MOVE DLC-NUM-IDLC IN DLC TO WSS-MIND
           ELSE
               MOVE FIO-STAT-NEX TO FIO-STAT
               MOVE ZEROES TO WSS-MIND.
           MOVE CAN-CIC-IOPC IN CAN TO DLC-CIC-IOPC IN DLC.
      *CAH-INI 15-FEB-2000
      *    PERFORM PRO-DLC VARYING DLC-NUM-IDLC FROM WSS-MIND BY 1
      *        UNTIL NOT FIO-STAT-OKS OR DLC-NUM-IDLC > WSS-MAXD.
           PERFORM PRO-DLC VARYING DLC-NUM-IDLC IN DLC
              FROM WSS-MIND BY 1
              UNTIL NOT FIO-STAT-OKS OR DLC-NUM-IDLC IN DLC > WSS-MAXD.
      *CAH-FIN 15-FEB-2000
           IF MSG-COD-MENS > SPACES
               GO TO FIN-TOT-CUO.
           PERFORM PRO-OPC.
       FIN-TOT-CUO.
           EXIT.
      ******************************************************************
       GRB-REG-RCV SECTION.
       INI-GRB-REG-RCV.
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE 1                   TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN.
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
       LUP-GRB-REG-RCV.
           PERFORM COL-FIO-VEN.
           IF NOT ( FIO-STAT-OKS AND
               OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN)
               GO TO FIN-GRB-REG-RCV.
           IF VEN-VAL-CAPI IN VEN = VEN-VAL-SCAP IN VEN AND
              VEN-VAL-FINA IN VEN = VEN-VAL-SFIN IN VEN
               IF OPC-IND-VSTR IN OPC = 'S'
                   GO TO FIN-GRB-REG-RCV
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-GRB-REG-RCV.
      *ALD-BCI-INI/06.08.1998
           MOVE SPACES TO RCV.
           MOVE ZEROES TO RCV-FEC-FCAN IN RCV.
           MOVE ZEROES TO RCV-FEC-FOUT IN RCV.
           MOVE ZEROES TO RCV-FEC-FTRN IN RCV.
           MOVE ZEROES TO RCV-NUM-HHTR IN RCV.
           MOVE ZEROES TO RCV-NUM-IDLC IN RCV.
           MOVE ZEROES TO RCV-NUM-IEVC IN RCV.
           MOVE ZEROES TO RCV-NUM-IVCT IN RCV.
           MOVE ZEROES TO RCV-NUM-MMTR IN RCV.
           MOVE ZEROES TO RCV-NUM-SSTR IN RCV.
           MOVE ZEROES TO RCV-SGV-CAPI IN RCV.
           MOVE ZEROES TO RCV-SGV-FINA IN RCV.
           MOVE ZEROES TO RCV-SGV-INTE IN RCV.
           MOVE ZEROES TO RCV-SGV-INTM IN RCV.
           MOVE ZEROES TO RCV-SGV-INTN IN RCV.
           MOVE ZEROES TO RCV-SGV-REAJ IN RCV.
      *ALD-BCI-FIN/06.08.1998
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE VEN-CIC-IOPC IN VEN TO RCV-CIC-IOPV IN RCV.
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE VEN-NUM-IVCT IN VEN TO RCV-NUM-IVCT IN RCV
           ELSE
               MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV.
           MOVE VEN-VAL-SCAP IN VEN TO RCV-SGV-CAPI IN RCV.
           MOVE VEN-VAL-SFIN IN VEN TO RCV-SGV-FINA IN RCV.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-GRB-REG-RCV.
       FIN-GRB-REG-RCV.
           EXIT.
      ******************************************************************
       PRO-VCT SECTION.
       INI-PRO-VCT.
      *     IF OPC-NUM-IEVC IN OPC NOT > ZEROES
      *     IF OPC-IND-VSTR IN OPC = 'S'
      *         PERFORM GET-VEN
      *         IF NOT FIO-STAT-OKS
      *             MOVE 'VENEXP NEX' TO MSG-COD-MENS
      *             GO TO FIN-PRO-VCT
      *         ELSE
      *             PERFORM EXP-VEN
      *             IF NOT VEN-STAT-EOF
      *                 GO TO FEC-PRO-VCT
      *             ELSE
      *                MOVE 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    BCK' TO MSG-COD-MENS
               GO TO FIN-PRO-VCT.
           MOVE ZEROES TO VEN-VAL-SCAP IN VEN.
           MOVE ZEROES TO VEN-VAL-SFIN IN VEN.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    BCK' TO MSG-COD-MENS.
       FEC-PRO-VCT.
           MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FAMT.
       FIN-PRO-VCT.
           EXIT.
      ******************************************************************
       PRO-DLC SECTION.
       INI-PRO-DLC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    BCK' TO MSG-COD-MENS
               GO TO FIN-PRO-DLC.
           MOVE ZEROES TO DLC-VAL-SDLC IN DLC.
      *ISP VALOR POR AMORTIZAR
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE ZEROES TO DLC-VAL-SCPA IN DLC
               MOVE ZEROES TO DLC-FEC-FAMT IN DLC.
           IF SCR-CMND = 'CAN' OR
      *DPM ini  19-APR-1996
      *        SCR-CMND = 'CVC'
              SCR-CMND = 'CVC' OR
              SCR-CMND = 'CAB'
      *DPM fin  19-APR-1996
               MOVE DLC-FEC-FDEV IN DLC TO CAN-FEC-FDVA IN CAN
               MOVE DLC-FEC-FMAV IN DLC TO DLC-FEC-FDEV IN DLC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'DLC    BCK' TO MSG-COD-MENS.
       FIN-PRO-DLC.
           EXIT.
      ******************************************************************
       PRO-OPC SECTION.
       INI-PRO-OPC.
           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    BCK' TO MSG-COD-MENS
               GO TO FIN-PRO-OPC.
           MOVE ZEROES TO OPC-VAL-SCRE IN OPC.
           IF SCR-CMND = 'COF'
               MOVE OPC-NUM-VCVG IN OPC TO CAN-NUM-TVCC IN CAN.
      *     ADD WSS-NUM-VCVG IN WSS-VARI TO OPC-NUM-TVCC IN OPC.
            SUBTRACT CAN-NUM-TVCC IN CAN FROM OPC-NUM-VCVG IN OPC.
      *     MOVE ZEROES TO OPC-NUM-VCVG IN OPC.
      *DAD ini  22-OCT-1991
           IF OPC-NUM-TVCC IN OPC > ZEROES
               ADD CAN-NUM-TVCC IN CAN TO OPC-NUM-TVCC IN OPC
           ELSE
               ADD CAN-NUM-TVCC IN CAN TO OPC-NUM-VCCO IN OPC.
      *DAD fin  22-OCT-1991
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    BCK' TO MSG-COD-MENS.
       FIN-PRO-OPC.
           EXIT.
      ******************************************************************
       GET-VEN SECTION.
       INI-GET-VEN.
      *    IF OPC-NUM-IEVC IN OPC NOT > ZEROES
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE 1 TO VEN-NUM-IVEN IN VEN.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           MOVE FIO-STAT TO PGM-STAT-VEN.
      *    IF OPC-NUM-IEVC IN OPC NOT > ZEROES
           IF OPC-IND-VSTR IN OPC = 'S'
               MOVE VEN-NUM-IVCT IN VEN TO VEN-NUM-IVEN IN VEN.
       FIN-GET-VEN.
           EXIT.

       GET-VEN-REA SECTION.
       INI-GET-VEN-REA.
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS
                   MOVE '00' TO FIO-STAT
               ELSE
                   MOVE '23' TO FIO-STAT
           ELSE
               PERFORM COL-FIO-VEN.
           MOVE FIO-STAT TO PGM-STAT-VEN.
       FIN-GET-VEN-REA.
           EXIT.
      ******************************************************************
