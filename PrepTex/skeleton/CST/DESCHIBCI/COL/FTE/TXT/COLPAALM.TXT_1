*%! Codigo adicional para archivo
*%! PGM_PTC = TRUE
*%  NO_TIENE_TIMESTAMP = TRUE
*%  NO_HDR_CST = TRUE
*% IF FIN_SCR_VARI
      *>>>>
       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
*% IF PGM_PQ
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY COLBRRDC.
       COPY SGCBRDBC.
       COPY GNSWGCPT.
*% END
      *<<<<
*% END
*% IF WSS AND PGM_PU
      *>>>> WSS_VARI
       01  WSS-CONSTANTES.           
           03  WSS-CT-ALM     VALUE 'ALM'               PIC X(03).
           03  WSS-CT-TAB     VALUE 'TAB'               PIC X(03).
           03  WSS-CT-VLR     VALUE 'VLR'               PIC X(03).
           03  WSS-CT-CODNEX  VALUE 'COD    NEX'        PIC X(10).
           03  WSS-CT-CODNVG  VALUE 'COD    NVG'        PIC X(10).
      *>>>>
*% END
*% IF WSS AND PGM_PQ
      *>>>> WSS_VARI
       01  WSS-VARI.
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC                   PIC X(03).
               05  WSS-COD-AOOC                   PIC X(03).
       01  WSS-CONSTANTES.
           03  WSS-CT-RDCKEY  VALUE 'RDC-KEY-IDLC'      PIC X(12).
           03  WSS-CT-A       VALUE 'A'                 PIC X(01).
           03  WSS-CT-ALM     VALUE 'ALM'               PIC X(03).
           03  WSS-CT-ATZ     VALUE 'ATZ'               PIC X(03).
           03  WSS-CT-COL     VALUE 'COL'               PIC X(03).
           03  WSS-CT-TAB     VALUE 'TAB'               PIC X(03).
           03  WSS-CT-VLR     VALUE 'VLR'               PIC X(03).
           03  WSS-CT-TIO     VALUE 'TIO'               PIC X(03).
           03  WSS-CT-AUX     VALUE 'AUX'               PIC X(03).
           03  WSS-CT-CODNEX  VALUE 'COD    NEX'        PIC X(10).
           03  WSS-CT-CODNVG  VALUE 'COD    NVG'        PIC X(10).
           03  WSS-CT-OPCNEX  VALUE 'OPC    NEX'        PIC X(10).
           03  WSS-CT-SALCRO  VALUE 'OPCSCRENOINF'      PIC X(12).
           03  WSS-CT-OPCNOA  VALUE 'MSCOPCNOPER'       PIC X(11).
           
      *>>>>
*% END
*% IF FIN_FND_KEY
      *>>>> FIN_FND_KEY
           MOVE OIA-CAI-IOPC IN OIA TO OPC-CAI-IOPC IN OPC
           MOVE OIA-IIC-IOPC IN OIA TO OPC-IIC-IOPC IN OPC
           PERFORM COL-FIO-OPC
           IF NOT FIO-STAT-OKS
              MOVE WSS-CT-COL      TO MSG-COD-SIST
              MOVE WSS-CT-OPCNEX   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE ZEROES   TO FIO-STAT
              GO TO FIN-FND-KEY.
              
           IF OPC-VAL-CRED IN OPC NOT > ZEROES AND 
              SCR-CMND = WSS-CT-ATZ
              MOVE WSS-CT-COL     TO MSG-COD-SIST
              MOVE WSS-CT-SALCRO  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE ZEROES   TO FIO-STAT
              GO TO FIN-FND-KEY.
              
           IF OPC-MSC-STAT IN OPC = WSS-CT-A AND
              SCR-CMND = WSS-CT-ATZ
              MOVE WSS-CT-COL     TO MSG-COD-SIST
              MOVE WSS-CT-OPCNOA  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE ZEROES   TO FIO-STAT
              GO TO FIN-FND-KEY.
              
           PERFORM PUT-OPC-ALM.
           PERFORM SET-GLS-MONEDA.
           PERFORM SET-GLS-TIO.
           PERFORM SET-GLS-AUX.
           PERFORM PUT-DBC-ALM.

           MOVE PGM-STAT-OIA TO FIO-STAT.
      *<<<<     
*% END
*% IF EOF_PU
      *>>>> EOF_PU
       COPY GNSBVTAB.
       COPY GNSBVCOD.

       COPY COLBFOPC.
      *<<<<
*% END
*% IF EOF_PQ
      *>>>> EOF_PQ
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBGCPT.
       
       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY SGCBFDBC.
      *<<<<
*% END
