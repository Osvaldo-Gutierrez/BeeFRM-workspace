       INF-CRE SECTION.
       INI-INF-CRE.
           MOVE SPACES  TO CRE-TAB-ICRE IN CRE.
           PERFORM INI-VAR VARYING CRE-R FROM 1 BY 1
                   UNTIL CRE-R > CRE-MAX-RMAX.
           MOVE ZEROES  TO CRE-R.
           MOVE ZEROES  TO CRE-RMAX.
           MOVE SPACES TO CRE-COD-MENS.
           PERFORM VAL-PARAM.
           IF CRE-COD-MENS > SPACES
               GO TO FIN-INF-CRE.
           PERFORM BUS-RDC.
           IF CRE-COD-MENS > SPACES
               MOVE ZEROES TO CRE-RMAX.
       FIN-INF-CRE.
           EXIT.
       BUS-RDC SECTION.
       INI-BUS-RDC.
           MOVE SPACES TO CRE-COD-MENS.
           MOVE DBC-CIC-ICLI IN DBC TO RDC-CIC-ICLI IN RDC.
           MOVE SPACES TO RDC-KEY-IDLC IN RDC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PUT-RDC.
           PERFORM COL-FIO-RDC.
           IF NOT ( FIO-STAT-OKS AND
                    RDC-CIC-ICLI IN RDC = DBC-CIC-ICLI IN DBC)
               GO TO FIN-PUT-RDC.
           IF RDC-NUM-IDLC IN RDC = ZEROES AND
              ( CRE-TIPD IN CRE = 'D' OR CRE-TIPD IN CRE = 'T' )
               PERFORM PUT-DIR
           ELSE
               IF RDC-NUM-IDLC IN RDC > ZEROES AND
                  ( CRE-TIPD IN CRE = 'I' OR CRE-TIPD IN CRE = 'T' )
                   PERFORM PUT-IND.
           IF CRE-COD-MENS > SPACES
               GO TO FIN-PUT-RDC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PUT-RDC.
       FIN-PUT-RDC.
           EXIT.
       PUT-DIR SECTION.
       INI-PUT-DIR.
           MOVE SPACES TO CRE-COD-MENS.
           MOVE RDC-CIC-IOPC IN RDC TO CRE-CIC-IOPE IN CRE.
           MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'RDCOPC NOCON'      TO CRE-COD-MENS
               GO TO FIN-PUT-DIR.
           IF ( OPC-MSC-STAT IN OPC NOT = 'A')       OR
              ( OPC-VAL-SCRE IN OPC NOT > 0 )
               GO TO FIN-PUT-DIR.
           ADD 1 TO CRE-RMAX.
           IF CRE-RMAX > CRE-MAX-RMAX
               MOVE 'OVERFLWRMAX' TO CRE-COD-MENS
               GO TO FIN-PUT-DIR.
           MOVE 'D' TO CRE-IND-TDEU IN CRE(CRE-RMAX).
           PERFORM PUT-OPC.
           IF CRE-COD-MENS IN CRE > SPACES
               GO TO FIN-PUT-DIR.
      *ALD
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE 1 TO VEN-NUM-IVEN IN VEN.
           MOVE OPC-CAI-IOPC IN OPC TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN OPC TO VEN-IIC-IOPC IN VEN.
           MOVE  FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    NOOPC' TO CRE-COD-MENS
               GO TO FIN-PUT-DIR.
           PERFORM PUT-VEN.
           MOVE OPC-CAI-IOPC IN OPC TO VIN-CAI-IOPC IN VIN-VARI.
           MOVE OPC-IIC-IOPC IN OPC TO VIN-IIC-IOPC IN VIN-VARI.
           MOVE ZEROES              TO VIN-NUM-IDLC IN VIN-VARI.
           PERFORM BUS-VIN.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NOICG' TO CRE-COD-MENS
               GO TO FIN-PUT-DIR.
           PERFORM PUT-ICG.
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES              TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT ( FIO-STAT-OKS AND
                    DLC-CIC-IOPC IN DLC = OPC-CIC-IOPC IN OPC )
               MOVE 'OPCDLC NOCON'      TO CRE-COD-MENS
               GO TO FIN-PUT-DIR.
           MOVE DLC-FEC-FMAV IN DLC TO CRE-FEC-FMAX IN CRE.
           MOVE DLC-FEC-FMAV IN DLC TO CRE-FEC-FMAV IN CRE(CRE-RMAX).
           MOVE DLC-COD-PLZO IN DLC TO CRE-COD-PLZO IN CRE(CRE-RMAX).
       LUP-PUT-DIR.
           PERFORM PUT-DLC.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF FIO-STAT-OKS AND
              DLC-CIC-IOPC IN DLC = RDC-CIC-IOPC IN RDC
               GO TO LUP-PUT-DIR.
       FIN-PUT-DIR.
           EXIT.
       PUT-IND SECTION.
       INI-PUT-IND.
           MOVE SPACES TO CRE-COD-MENS.
           MOVE RDC-CIC-IOPC IN RDC TO CRE-CIC-IOPE IN CRE.
           MOVE RDC-CIC-IOPC IN RDC TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
               MOVE 'RDCOPC NOCON'      TO CRE-COD-MENS
               GO TO FIN-PUT-IND.
           IF ( OPC-MSC-STAT IN OPC NOT = 'A')       OR
              ( OPC-VAL-SCRE IN OPC NOT > 0 )
                 GO TO FIN-PUT-IND.
           ADD 1 TO CRE-RMAX.
           IF CRE-RMAX > CRE-MAX-RMAX
               MOVE 'OVERFLWRMAX' TO CRE-COD-MENS
               GO TO FIN-PUT-IND.
           MOVE 'I' TO CRE-IND-TDEU IN CRE(CRE-RMAX).
           PERFORM PUT-OPC.
           IF CRE-COD-MENS IN CRE > SPACES
               GO TO FIN-PUT-IND.
           MOVE RDC-KEY-IDLC IN RDC TO DLC-KEY-IDLC IN DLC.
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
               MOVE 'RDCDLC NOCON'      TO CRE-COD-MENS
               GO TO FIN-PUT-IND.
           MOVE DLC-CAI-IOPC IN DLC TO VIN-CAI-IOPC IN VIN-VARI.
           MOVE DLC-IIC-IOPC IN DLC TO VIN-IIC-IOPC IN VIN-VARI.
           MOVE DLC-NUM-IDLC IN DLC TO VIN-NUM-IDLC IN VIN-VARI.
           PERFORM BUS-VIN.
           IF NOT FIO-STAT-OKS
               MOVE 'OPC    NOICG' TO CRE-COD-MENS
               GO TO FIN-PUT-IND.
           PERFORM PUT-ICG.
           MOVE DLC-FEC-FMAV IN DLC TO CRE-FEC-FMAX IN CRE.
           MOVE DLC-FEC-FMAV IN DLC TO CRE-FEC-FMAV IN CRE(CRE-RMAX).
           MOVE DLC-COD-PLZO IN DLC TO CRE-COD-PLZO IN CRE(CRE-RMAX).
           PERFORM PUT-DLC.
           IF OPC-IND-VSTR IN OPC NOT = 'S'
               MOVE OPC-NUM-IVEN IN OPC TO VEN-NUM-IVEN IN VEN
           ELSE
               MOVE 1 TO VEN-NUM-IVEN IN VEN.
           MOVE OPC-CAI-IOPC IN OPC TO VEN-CAI-IOPC IN VEN.
           MOVE OPC-IIC-IOPC IN OPC TO VEN-IIC-IOPC IN VEN.
           MOVE  FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
               MOVE 'VEN    NOOPC' TO CRE-COD-MENS
               GO TO FIN-PUT-IND.
           PERFORM PUT-VEN.
       FIN-PUT-IND.
           EXIT.
       PUT-VEN SECTION.
       INI-PUT-VEN.
           MOVE VEN-FEC-FVEN IN VEN TO CRE-FEC-FVEN IN CRE(CRE-RMAX).
           MOVE VEN-VAL-SFIN IN VEN TO CRE-VAL-SFIN IN CRE(CRE-RMAX).
       FIN-PUT-VEN.
           EXIT.
       PUT-OPC SECTION.
       INI-PUT-OPC.
           MOVE SPACES TO CRE-COD-MENS.
           MOVE OPC-CAI-IOPC IN OPC TO CRE-CAI-IOPC IN CRE(CRE-RMAX).
           MOVE OPC-IIC-IOPC IN OPC TO CRE-IIC-IOPC IN CRE(CRE-RMAX).
      * Codigo Clase Operacion Credito
           MOVE OPC-COD-COOC IN OPC TO CRE-COD-COOC IN CRE(CRE-RMAX).
      * Codigo Moneda Origen
           MOVE OPC-COD-VCOC IN OPC TO CRE-COD-VCOC IN CRE(CRE-RMAX).
      * Monto Credito Moneda Origen
           MOVE OPC-VAL-CRED IN OPC TO CRE-VAL-CRED IN CRE(CRE-RMAX).
      * Fecha Origen del Credito
           MOVE OPC-FEC-FCOL IN OPC TO CRE-FEC-FCOL IN CRE(CRE-RMAX).
           MOVE OPC-FEC-FINP IN OPC TO CRE-FEC-FINP IN CRE(CRE-RMAX).
      * Numero de cuotas por Pagar
           MOVE OPC-NUM-VCVG IN OPC TO CRE-NUM-VCVG IN CRE(CRE-RMAX).
      * Saldo Valor Credito en Moneda Origen
           MOVE OPC-VAL-SCRE IN OPC TO CRE-VAL-SCRE IN CRE(CRE-RMAX).
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB.
           MOVE '0999  '       TO TAB-CIC-CTAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'CICPESOINEX' TO CRE-COD-MENS
               GO TO FIN-PUT-OPC.
           IF TAB-COD-CTAB = CRE-COD-VCOC IN CRE(CRE-RMAX)
               MOVE CRE-VAL-SCRE IN CRE(CRE-RMAX) TO
                    CRE-VAL-SPES IN CRE(CRE-RMAX)
               GO TO FIN-PUT-OPC.
           MOVE CRE-NUM-DPRO IN CRE TO CAM-NUM-DCAM IN CAM(1).
           MOVE CRE-NUM-MPRO IN CRE TO CAM-NUM-MCAM IN CAM(1).
           MOVE CRE-NUM-SPRO IN CRE TO CAM-NUM-SCAM IN CAM(1).
           MOVE CRE-NUM-APRO IN CRE TO CAM-NUM-ACAM IN CAM(1).
           MOVE CRE-NUM-DPRO IN CRE TO CAM-NUM-DCAM IN CAM(2).
           MOVE CRE-NUM-MPRO IN CRE TO CAM-NUM-MCAM IN CAM(2).
           MOVE CRE-NUM-SPRO IN CRE TO CAM-NUM-SCAM IN CAM(2).
           MOVE CRE-NUM-APRO IN CRE TO CAM-NUM-ACAM IN CAM(2).
           MOVE CRE-COD-VCOC IN CRE(CRE-RMAX) TO
                                       CAM-COD-VCAM IN CAM(1).
           MOVE TAB-COD-CTAB IN TAB TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF NOT FIO-STAT-OKS
               MOVE 'VALCAMNEX' TO CRE-COD-MENS
               GO TO FIN-PUT-OPC.
           MULTIPLY CAM-SGV-VCAM IN CAM BY CRE-VAL-SCRE
                    IN CRE(CRE-RMAX) GIVING CRE-VAL-SPES
                                        IN CRE(CRE-RMAX).
           MOVE CRE-VAL-SPES  IN CRE(CRE-RMAX) TO PES-SGV-DECI
                                                    IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO CRE-VAL-SPES
                                                IN CRE(CRE-RMAX).
       FIN-PUT-OPC.
           EXIT.
       PUT-DLC SECTION.
       INI-PUT-DLC.
           IF DLC-FEC-FMAV IN DLC > CRE-FEC-FMAX IN CRE
               MOVE DLC-FEC-FMAV IN DLC TO CRE-FEC-FMAX IN CRE
               MOVE DLC-FEC-FMAV IN DLC TO CRE-FEC-FMAV IN
                                                 CRE(CRE-RMAX).
       FIN-PUT-DLC.
           EXIT.
       PUT-ICG SECTION.
       INI-PUT-ICG.
           MOVE ICG-COD-TINT IN ICG TO CRE-COD-TINT IN CRE(CRE-RMAX).
           MOVE ICG-SGV-SPRD IN ICG TO CRE-SGV-SPRD IN CRE(CRE-RMAX).
           MOVE ICG-SGV-TINT IN ICG TO CRE-SGV-TINT IN CRE(CRE-RMAX).
       FIN-PUT-ICG.
           EXIT.
       INI-VAR SECTION.
       INI-INI-VAR.
           MOVE ZEROES TO CRE-IIC-IOPC IN CRE(CRE-R).
           MOVE ZEROES TO CRE-VAL-CRED IN CRE(CRE-R).
           MOVE ZEROES TO CRE-FEC-FCOL IN CRE(CRE-R).
           MOVE ZEROES TO CRE-FEC-FINP IN CRE(CRE-R).
           MOVE ZEROES TO CRE-FEC-FMAV IN CRE(CRE-R).
           MOVE ZEROES TO CRE-VAL-SCRE IN CRE(CRE-R).
           MOVE ZEROES TO CRE-VAL-SPES IN CRE(CRE-R).
           MOVE ZEROES TO CRE-NUM-VCVG IN CRE(CRE-R).
           MOVE ZEROES TO CRE-FEC-FVEN IN CRE(CRE-R).
           MOVE ZEROES TO CRE-VAL-SFIN IN CRE(CRE-R).
           MOVE ZEROES TO CRE-SGV-SPRD IN CRE(CRE-R).
           MOVE ZEROES TO CRE-SGV-TINT IN CRE(CRE-R).
       FIN-INI-VAR.
           EXIT.
       VAL-PARAM SECTION.
       INI-VAL-PARAM.
           MOVE SPACES TO CRE-COD-MENS.
           IF NOT ( CRE-TIPD IN CRE = 'D' OR
                    CRE-TIPD IN CRE = 'I' OR
                    CRE-TIPD IN CRE = 'T' )
               MOVE 'CREDEUNDIT' TO CRE-COD-MENS IN CRE
               GO TO FIN-VAL-PARAM.
           MOVE CRE-IDC-ICLI IN CRE TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'CLI    NEX' TO CRE-COD-MENS
               GO TO FIN-VAL-PARAM.
           MOVE CRE-FEC-FPRO IN CRE TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               MOVE FEC-MENS TO CRE-COD-MENS IN CRE.
       FIN-VAL-PARAM.
           EXIT.
