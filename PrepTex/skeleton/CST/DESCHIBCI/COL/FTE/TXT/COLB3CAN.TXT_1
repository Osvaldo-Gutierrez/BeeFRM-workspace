      *JUS DIC-06-1994
       GET-OPC SECTION.
       INI-GET-OPC.
           MOVE CAN-CIC-IOPC IN CAN TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
       FIN-GET-OPC.
           EXIT.

       GET-MON SECTION.
       INI-GET-MON.
           MOVE SPACES TO WSS-CIC-VCAM.
           MOVE 'TAB'        TO TAB-COD-SIST.
           MOVE 'VLR'        TO TAB-COD-TTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB
           IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-VCAM.
       FIN-GET-MON.
           EXIT.

       INI-REG-CYA SECTION.
       INI-INI-REG-CYA.
      *     MOVE CAN-STP-ITRN IN CAN TO CYA-STP-IINV IN CYA.
           MOVE SPACES TO CYA-GLS-FLAG IN CYA.
      *     MOVE SPACES TO CYA-IND-AINV IN CYA.
      *     MOVE SPACES TO CYA-COD-OINV IN CYA.
           MOVE SPACES TO CYA-VRF-ICYA IN CYA.
           MOVE ZEROES TO CYA-SGV-LIQU IN CYA.
           MOVE SPACES TO CYA-GLS-DISP IN CYA.
      * RRM-INI 30-APR-1999
           MOVE SPACES TO CYA-IND-INTE IN CYA.
      * RRM-FIN 30-APR-1999
       FIN-INI-REG-CYA.
           EXIT.

       ACT-CYA SECTION.
       INI-ACT-CYA.
           MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF ( FIO-STAT-OKS AND
                CAN-CIC-IOPC IN CAN = CYA-CIC-IOPC IN CYA AND
                CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-CYA
               PERFORM RET-CYA-CAN
               IF CAN-SGV-TPAG IN CAN > ZEROES
                   PERFORM BUS-TCYA
                   MOVE CAN-SGV-TPAG IN CAN TO CYA-SGV-LIQU IN CYA
      * RRM-INI 30-APR-1999
                   IF RCV-SGV-CAPI IN CAN-FLD = ZEROES
                      MOVE 'I'              TO CYA-IND-INTE IN CYA
                      MOVE FIO-MOD TO FIO-CMND
                      PERFORM COL-FIO-CYA
                   ELSE
                      MOVE SPACES           TO CYA-IND-INTE IN CYA
      * RRM-FIN 30-APR-1999
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM COL-FIO-CYA
               ELSE
                   MOVE FIO-DEL TO FIO-CMND
                   PERFORM COL-FIO-CYA
           ELSE
               IF CAN-SGV-TPAG IN CAN > ZEROES
                   PERFORM INI-REG-CYA
                   MOVE CAN-CIC-IOPC IN CAN TO CYA-CIC-IOPC IN CYA
                   MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA
                   PERFORM RET-CYA-CAN
                   MOVE 1                   TO CYA-NUM-ICYA IN CYA
                   MOVE CAN-SGV-TPAG IN CAN TO CYA-SGV-LIQU IN CYA
                   PERFORM BUS-TCYA
      * RRM-INI 30-APR-1999
                   IF RCV-SGV-CAPI IN CAN-FLD = ZEROES
                      MOVE 'I'              TO CYA-IND-INTE IN CYA
                      MOVE FIO-PUT TO FIO-CMND
                      PERFORM COL-FIO-CYA
                   ELSE
      * RRM-FIN 30-APR-1999
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM COL-FIO-CYA.
       FIN-ACT-CYA.
           EXIT.

       BUS-TCYA SECTION.
       INI-BUS-TCYA.
           MOVE SPACES TO CYA-IND-MAUT IN CYA.
           IF CYA-IND-TCYA IN CYA > SPACES
               MOVE 'TAB'               TO MSC-COD-SIST
               MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC
               MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-COD-DAT1(2) TO CYA-IND-MAUT IN CYA.
       FIN-BUS-TCYA.
           EXIT.

       ACT-ICG SECTION.
       INI-ACT-ICG.
           PERFORM GET-CUR-ICG.
           IF PGM-STAT-ICG-OKS
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM COL-FIO-ICG
               IF ICG-SGV-TINT IN CAN-FLD > ZEROES
                   MOVE FIO-MOD TO FIO-CMND
               ELSE
      *DAD ini  10-SEP-1992   (Memo.26-05-92 Pto.3)
      *         IF ICG-SGV-TINT IN CAN-FLD = ZEROES AND
               IF WSS-IBLK-TINT IN WSS-VARI NOT = 'S'
                   MOVE FIO-MOD TO FIO-CMND
               ELSE
      *DAD fin  10-SEP-1992
                   MOVE FIO-DEL TO FIO-CMND
           ELSE
      *DAD ini  10-SEP-1992   (Memo.26-05-92 Pto.3)
      *         IF ICG-SGV-TINT IN CAN-FLD > ZEROES
               IF ICG-SGV-TINT IN CAN-FLD > ZEROES OR
                  WSS-IBLK-TINT IN WSS-VARI NOT = 'S'
      *DAD fin  10-SEP-1992
                   PERFORM INI-ICG
                   MOVE FIO-PUT TO FIO-CMND
               ELSE
                   MOVE '00' TO PGM-STAT-ICG
                   GO TO FIN-ACT-ICG.

           IF SCR-COD-TICG > SPACES
               MOVE SCR-COD-TICG TO ICG-COD-TINT IN ICG.
           IF ICG-COD-CVTI IN ICG > SPACES
               MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-SPRD IN ICG
           ELSE
               MOVE ICG-SGV-TINT IN CAN-FLD TO ICG-SGV-TINT IN ICG.
           PERFORM COL-FIO-ICG.
           MOVE FIO-STAT TO PGM-STAT-ICG.
       FIN-ACT-ICG.
           EXIT.

       ACT-ROV SECTION.
       INI-ACT-ROV.
           PERFORM UPD-MOD-ROV.
           IF NOT FIO-STAT-OKS
               GO TO FIN-ACT-ROV.

           IF ROV-IIC-IOPC IN CAN-FLD > ZEROES AND

              ROV-CAI-IOPC IN CAN-FLD = SCR-ROV-CAI-IOPC AND
              ROV-IIC-IOPC IN CAN-FLD = SCR-ROV-IIC-IOPC
              DIVIDE CAN-SGV-TREN IN CAN-FLD BY
                     SCR-SGV-VCAM GIVING ROV-SGV-RENO IN ROV
                     MOVE FIO-MOD TO FIO-CMND
                     PERFORM COL-FIO-ROV
           ELSE
               MOVE FIO-DEL TO FIO-CMND
               PERFORM COL-FIO-ROV
               PERFORM ASS-OPC-ROV.
       FIN-ACT-ROV.
           EXIT.

       ASS-OPC-ROV SECTION.
       INI-ASS-OPC-ROV.
           IF ROV-IIC-IOPC IN CAN-FLD > ZEROES
               MOVE ROV-CAI-IOPC IN CAN-FLD TO CIC-CAI-ICIC
               MOVE ROV-IIC-IOPC IN CAN-FLD TO CIC-IIC-ICIC
           ELSE
               PERFORM BUS-NUM-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE CIC-MENS     TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-ASS-OPC-ROV
               ELSE
                   MOVE 'COL'        TO MSG-COD-SIST
                   MOVE 'OPCASIGROV' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1

                   MOVE SPACES TO WSS-MEN2
                   MOVE CIC-CIC-ICIC TO WSS-MEN2-A
                   MOVE MSG-GLS-DATA TO WSS-MEN2-B
                   MOVE WSS-MEN2     TO FRM-MEN2
                   MOVE SPACES TO WSS-MEN2

                   MOVE FRM-MENS TO SCR-MENS-EXT.
           PERFORM INI-ROV.

           MOVE CIC-CAI-ICIC            TO ROV-CAI-IOPC IN ROV.
           MOVE CIC-IIC-ICIC            TO ROV-IIC-IOPC IN ROV.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO ROV-CAI-IOPV IN ROV.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPV IN ROV.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO ROV-NUM-IVCT IN ROV.
           DIVIDE CAN-SGV-TREN IN CAN-FLD BY
                  SCR-SGV-VCAM GIVING ROV-SGV-RENO IN ROV.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM COL-FIO-ROV.
       FIN-ASS-OPC-ROV.
           EXIT.

       BUS-NUM-CIC SECTION.
       INI-BUS-NUM-CIC.
           MOVE 'D'                     TO CIC-COD-TCIC IN CIC
           MOVE CAN-COD-OFCA IN CAN-FLD TO CIC-COD-CCIC IN CIC
           MOVE CIC-GET                 TO CIC-CMND
           PERFORM PRO-CIC
           IF CIC-STAT NOT = CIC-STAT-OKS
               GO TO FIN-BUS-NUM-CIC
           ELSE
               MOVE ADR-OPC-REQA TO ADR-AUX-REQA
               MOVE CIC-CIC-ICIC IN CIC TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               IF FIO-STAT-OKS
                   GO TO INI-BUS-NUM-CIC
               ELSE
                   MOVE ADR-AUX-REQA TO ADR-OPC-REQA
                   MOVE FIO-KDEF-S   TO FIO-KDEF
                   MOVE FIO-GET-KEY  TO FIO-CMND
                   PERFORM COL-FIO-OPC.
       FIN-BUS-NUM-CIC.
           EXIT.

       UPD-MOD-ROV SECTION.
       INI-UPD-MOD-ROV.
           MOVE SCR-ROV-CAI-IOPC TO ROV-CAI-IOPC IN ROV.
           MOVE SCR-ROV-IIC-IOPC TO ROV-IIC-IOPC IN ROV.
           MOVE CAN-CAI-IOPC IN CAN-FLD TO ROV-CAI-IOPV IN ROV.
           MOVE CAN-IIC-IOPC IN CAN-FLD TO ROV-IIC-IOPV IN ROV.
           MOVE CAN-NUM-ICAN IN CAN-FLD TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-ROV.
       FIN-UPD-MOD-ROV.
           EXIT.

       ACT-RCV SECTION.
       INI-ACT-RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.
           IF SCR-MSC-TCAN = 'C' AND
              SCR-MSC-ECAN = 'E'
                MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV
           ELSE
           IF SCR-MSC-FCAN = 'T' AND
              SCR-MSC-ECAN = 'T'
                MOVE ZEROES TO RCV-NUM-IVCT IN RCV
           ELSE
                MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF FIO-STAT-OKS
               PERFORM RET-RCV-CAN

      * RBG/INI/18-JUL-1996
      * RJZ INI 31-MAYO-1995
      *        PERFORM OBT-CAPP
      * RJZ FIN 31-MAYO-1995
      * RBG/FIN/18-JUL-1996

               PERFORM CAL-RCV
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               PERFORM INI-RCV
               PERFORM INI-KDLC
               PERFORM RET-RCV-CAN

      * RBG/INI/18-JUL-1996
      * RJZ INI 31-MAYO-1995
      *        PERFORM OBT-CAPP
      * RJZ FIN 31-MAYO-1995
      * RBG/FIN/18-JUL-1996

               PERFORM INI-KDLC
               PERFORM CAL-RCV
               MOVE FIO-PUT TO FIO-CMND.
      *JSS 5-APR-1991 00:36:06
           MOVE SCR-RCV-STAT TO RCV-MSC-STAT IN RCV.
      *DAD ini  13-DEC-1991   (Memo.27-06-91 Pto.5)
           MOVE VEN-IND-SCTB IN VEN TO RCV-IND-SCTB IN RCV.
           MOVE VEN-IND-SCBZ IN VEN TO RCV-IND-SCBZ IN RCV.
      *DAD fin  13-DEC-1991
      *RJZ INI  09-JUNIO-1995
           MOVE SCR-SGV-INTM TO RCV-SGV-INTM IN RCV.

      *DPM ini  19-FEB-1997 No estaba grabando intereses normales
      *     MOVE SCR-SGV-IPFC TO SCR-SGV-INTN.
      *DPM fin  19-FEB-1997
      *DPM ini  11-OCT-1996  Desasterisqueado campo RCV-SGV-INTN
      * Se calcula campo CAN-SGV-IMOK solo para Prorrogas
      * RBG/INI/18-JUL-1996 Asterisqueado
           IF SCR-SGV-INTN NOT < -1 AND
              SCR-SGV-INTN < 1
               MOVE ZEROES TO SCR-SGV-INTN.
           MOVE SCR-SGV-INTN TO RCV-SGV-INTN IN RCV.
      * RBG/FIN/18-JUL-1996

      *Guarda el comando para Ingresar o Modificar la RCV
           MOVE FIO-CMND TO WSS-FIO-CMND IN WSS-VARI.

           IF WSS-CIC-TVAL = '0' AND
              WSS-CIC-VCAM NOT = '0999'
               PERFORM OBT-VAL-CAM
           ELSE
           IF WSS-CIC-VCAM = '0999'
               MOVE 1 TO WSS-SGV-VCAN IN WSS-VARI
               MOVE 1 TO WSS-SGV-VCOL IN WSS-VARI
               MOVE RCV-SGV-CAPI IN RCV TO WSS-SGV-CAPI IN WSS-VARI.

      *Si es PTT se calcula campo CAN-SGV-IMOK
      *     IF CAN-MSC-TCAN IN CAN = 'P'
               PERFORM OBT-VAL-IMOK.
      *     ELSE
      *         MOVE ZEROES TO CAN-SGV-IMOK IN CAN.

           MOVE WSS-FIO-CMND TO FIO-CMND.
      *DPM fin  11-OCT-1996
      *DPM ini  9-DEC-1996 Se cuadran INTN o REAJ para tener diferencia
      * por formula:  TPAG = K - In - Im - R
      *DPM ini  24-FEB-1997 Se cambio CAPITAL para cuadrar los INTN
           COMPUTE WSS-SGV-CAPP IN WSS-VARI ROUNDED =
      *                            WSS-SGV-CAPI IN WSS-VARI *
                                  RCV-SGV-CAPI IN RCV *
                                  WSS-SGV-VCOL IN WSS-VARI.
      *DPM fin  24-FEB-1997
           MOVE WSS-SGV-CAPP IN WSS-VARI TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO WSS-SGV-CAPP IN WSS-VARI.
      *RRM-INI 8-JUN-1999
           IF CAN-MSC-TCAN IN CAN = 'R'
              IF WSS-CIC-TVAL = '0' AND WSS-CIC-VCAM NOT = '0999'
                  COMPUTE WSS-VAL-DIFE IN WSS-VARI =
                                    WSS-SGV-CAPP IN WSS-VARI -
                                    CAN-SGV-TREN IN CAN
                  IF WSS-VAL-DIFE IN WSS-VARI > -10 AND
                     WSS-VAL-DIFE IN WSS-VARI < 10
                      MOVE CAN-SGV-TREN IN CAN
                                     TO WSS-SGV-CAPP IN WSS-VARI.
      *RRM-FIN 08-JUN-1999

      *DPM ini  16-JAN-1997 Para Boletas de Grtia los intereses son :
      *   INTN = VPAG - INTM
           IF CAN-MSC-TCAN IN CAN NOT = 'P' AND
              WSS-OPEC IN WSS-VARI = 'B'
               COMPUTE RCV-SGV-INTN IN RCV =
                               ( CAN-SGV-TPAG IN CAN -
      *ALD-BCI-INI/13-08-1998
                                 CAN-SGV-GAST IN CAN -
      *ALD-BCI-FIN/13-08-1998
                                 RCV-SGV-INTM IN RCV )
           ELSE
      *DPM fin  16-JAN-1997
           IF CAN-MSC-TCAN IN CAN NOT = 'P' AND
              RCV-SGV-INTN IN RCV > ZEROES
               COMPUTE RCV-SGV-INTN IN RCV =
                             ( ( CAN-SGV-TPAG IN CAN +
                                 CAN-SGV-TREN IN CAN ) -
                                 WSS-SGV-CAPP IN WSS-VARI -
                                 RCV-SGV-INTM IN RCV -
      *ALD-BCI-INI/13-08-1998
                                 CAN-SGV-GAST IN CAN -
      *ALD-BCI-FIN/13-08-1998
                                 RCV-SGV-REAJ IN RCV )
               MOVE RCV-SGV-INTN IN RCV TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-INTN IN RCV
           ELSE
           IF CAN-MSC-TCAN IN CAN NOT = 'P' AND
              RCV-SGV-REAJ IN RCV NOT = ZEROES
               COMPUTE RCV-SGV-REAJ IN RCV =
                             ( ( CAN-SGV-TPAG IN CAN +
                                 CAN-SGV-TREN IN CAN ) -
                                 WSS-SGV-CAPP IN WSS-VARI -
                                 RCV-SGV-INTN IN RCV -
      *ALD-BCI-INI/13-08-1998
                                 CAN-SGV-GAST IN CAN -
      *ALD-BCI-FIN/13-08-1998
                                 RCV-SGV-INTM )
               MOVE RCV-SGV-REAJ IN RCV TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
      * RBG/INI/ 9-DEC-1997
      *         MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-REAJ IN RCV.
               MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-REAJ IN RCV
           ELSE
           IF CAN-MSC-TCAN IN CAN NOT = 'P' AND
              RCV-SGV-REAJ IN RCV = ZEROES AND
              RCV-SGV-INTN IN RCV = ZEROES AND
              RCV-SGV-INTM IN RCV > ZEROES
               COMPUTE RCV-SGV-INTM IN RCV =
                             ( ( CAN-SGV-TPAG IN CAN +
                                 CAN-SGV-TREN IN CAN ) -
      *ALD-BCI-INI/13-08-1998
                                 CAN-SGV-GAST IN CAN -
      *ALD-BCI-FIN/13-08-1998
                                 WSS-SGV-CAPP IN WSS-VARI )
               MOVE RCV-SGV-INTM IN RCV TO PES-SGV-DECI IN PES-VARI
               PERFORM PES-SCTV
               MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-INTM IN RCV.
      * RBG/FIN/ 9-DEC-1997

      *DPM fin  9-DEC-1996

      *RJZ FIN  09-JUNIO-1995
           PERFORM COL-FIO-RCV.
       FIN-ACT-RCV.
           EXIT.

       CAL-RCV SECTION.
       INI-CAL-RCV.
           PERFORM GET-MON.
      *ISP SI ES MONEDA REAJUSTABLE ( CHILENA Y NO PESOS ) ENTONCES
      *
           IF  WSS-CIC-TVAL = '0' AND
               WSS-CIC-VCAM NOT = '0999'
                IF SCR-MSC-ECAN = 'T'
      *JSS 1-AUG-1991 11:31:04
      *             MOVE OPC-VAL-SCRE IN OPC TO WSS-SGV-CAPI
                    PERFORM CAL-CAPI-REAJ
      *
                    PERFORM CAL-REAJ
      *             PERFORM CAL-INTE
                ELSE
      *JSS 22-JUL-1991 17:28:36
      *             MOVE RCV-SGV-CAPI IN RCV TO WSS-SGV-CAPI
                    PERFORM CAL-CAPI-REAJ
      *
                    PERFORM CAL-REAJ.
      *             PERFORM CAL-INTE.
       FIN-CAL-RCV.
           EXIT.

      *JSS 22-JUL-1991 17:25:26
       CAL-CAPI-REAJ SECTION.
       INI-CAL-CAPI-REAJ.
      *Calcular TOTAL PAGADO en moneda reajustable ( lo calcula en
      *WSS-VAL-INTE de paso, por la precision de 4 decimales ), tambien
      *transforma el interes pagado a fecha de cancelacion a moneda
      *reajustable
           IF RCV-SGV-CAPI IN RCV NOT > ZEROES
               MOVE 0 TO WSS-SGV-CAPI
               GO TO FIN-CAL-CAPI-REAJ.
           MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
           MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
           MOVE CAN-FEC-FCAN IN CAN TO TAB-FEC-FTRN IN TAB.
           PERFORM GET-VCAM.
           IF MSG-COD-MENS = SPACES AND CAM-SGV-VCAM IN CAM > ZEROES
      * RBG/INI/29-AUG-1996
              IF CAN-MSC-TCAN IN CAN = 'P'
                 DIVIDE CAN-SGV-TPAG IN CAN BY CAM-SGV-VCAM IN CAM
                                       GIVING WSS-VAL-INTE ROUNDED
                 MOVE WSS-VAL-INTE TO WSS-SGV-TPAG
                 DIVIDE SCR-SGV-IPFC BY CAM-SGV-VCAM IN CAM GIVING
                                              WSS-VAL-INTE ROUNDED
              ELSE
                 COMPUTE WSS-VAL-INTE ROUNDED = (CAN-SGV-TREN IN CAN +
                          CAN-SGV-TPAG IN CAN) / CAM-SGV-VCAM IN CAM
                 MOVE WSS-VAL-INTE TO WSS-SGV-TPAG
                 DIVIDE SCR-SGV-IPFC BY CAM-SGV-VCAM IN CAM GIVING
                                              WSS-VAL-INTE ROUNDED
      * RBG/FIN/29-AUG-1996
           ELSE
               MOVE ZEROES TO WSS-SGV-TPAG
               MOVE ZEROES TO WSS-VAL-INTE.
      *Compara el TOTAL PAGADO con el INTERES para sacar el CAPITAL
      *PAGADO en moneda reajustable
           IF WSS-SGV-TPAG NOT > WSS-VAL-INTE
               MOVE ZEROES TO WSS-SGV-CAPI
           ELSE
               SUBTRACT WSS-VAL-INTE FROM WSS-SGV-TPAG
                        GIVING WSS-SGV-CAPI.
      *sobre el supuesto que el 'capital' que 'hay' en el total pagado n
      *es mas que el que originalmente tiene la cuota, se hace un cheque
      *final para asumir como capital pagado el RCV-CAPI, en el caso que
      *sea menor que el capital calculado.
           IF WSS-SGV-CAPI > RCV-SGV-CAPI IN RCV
               MOVE RCV-SGV-CAPI IN RCV TO WSS-SGV-CAPI.
       FIN-CAL-CAPI-REAJ.
           EXIT.

       CAL-REAJ SECTION.
       INI-CAL-REAJ.
      *DPM ini  14-OCT-1996 Lo siguiente se coloco en copy COLBGMPC
      *     MOVE ZEROES TO WSS-SGV-RAFC.
      *     MOVE ZEROES TO WSS-SGV-RAFO.

      *     MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
      *     MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
      *     MOVE CAN-FEC-FCAN IN CAN TO TAB-FEC-FTRN IN TAB.
      *     PERFORM GET-VCAM.
      *     IF MSG-COD-MENS = SPACES
      *         MULTIPLY WSS-SGV-CAPI BY
      *                CAM-SGV-VCAM IN CAM GIVING
      *              WSS-SGV-RAFC.

      *     MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
      *     MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
      *JSS 18-JUN-1991 12:59:54
      *     IF OPC-IND-RENO IN OPC = 'PRO'
      *         MOVE OPC-CIC-IOPC IN OPC TO WSS-CIC-IOPC
      *         MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC
      *         MOVE RCV-NUM-IDLC IN RCV TO DLC-NUM-IDLC IN DLC
      *         MOVE FIO-GET-KEY TO FIO-CMND
      *         PERFORM COL-FIO-DLC
      *         IF FIO-STAT-OKS AND DLC-CIC-IOCO IN DLC > SPACES
      *             MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC
      *             MOVE FIO-GET-KEY TO FIO-CMND
      *             PERFORM COL-FIO-OPC
      *             IF FIO-STAT-OKS
      *                 MOVE OPC-FEC-FCOL IN OPC TO TAB-FEC-FTRN IN TAB
      *                 MOVE WSS-CIC-IOPC TO OPC-CIC-IOPC IN OPC
      *                 MOVE FIO-GET-KEY TO FIO-CMND
      *                 PERFORM COL-FIO-OPC
      *             ELSE
      *                 MOVE WSS-CIC-IOPC TO OPC-CIC-IOPC IN OPC
      *                 MOVE FIO-GET-KEY TO FIO-CMND
      *                 PERFORM COL-FIO-OPC
      *                 MOVE OPC-FEC-FCOL IN OPC TO TAB-FEC-FTRN IN TAB
      *         ELSE
      *             MOVE OPC-FEC-FCOL IN OPC TO TAB-FEC-FTRN IN TAB
      *     ELSE
      *JSS - FIN
      *         MOVE OPC-FEC-FCOL IN OPC TO TAB-FEC-FTRN IN TAB.
      *     PERFORM GET-VCAM.

           IF WSS-CIC-TVAL = '0' AND
              WSS-CIC-VCAM NOT = '0999'
               PERFORM OBT-VAL-CAM
           ELSE
           IF WSS-CIC-VCAM = '0999'
               MOVE 1 TO WSS-SGV-VCAN IN WSS-VARI
               MOVE 1 TO WSS-SGV-VCOL IN WSS-VARI.

           MULTIPLY WSS-SGV-CAPI BY
                  WSS-SGV-VCAN IN WSS-VARI GIVING
                  WSS-SGV-RAFC.
      *DPM fin  14-OCT-1996

           IF MSG-COD-MENS = SPACES
               MULTIPLY WSS-SGV-CAPI BY
      *DPM ini  9-JAN-1997
      *                CAM-SGV-VCAM IN CAM GIVING
                      WSS-SGV-VCOL IN WSS-VARI GIVING
      *DPM fin  9-JAN-1997
                    WSS-SGV-RAFO.
           SUBTRACT WSS-SGV-RAFO FROM WSS-SGV-RAFC GIVING
                    RCV-SGV-REAJ IN RCV.
           MOVE RCV-SGV-REAJ IN RCV TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV.
           MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-REAJ IN RCV.
      *DPM ini  11-OCT-1996 Se asterisqueo campo RCV-SGV-REAM
      *RJZ INI 31-MAYO-1995
      *     IF RCV-MSC-MCAN IN RCV = 'V'
      *        PERFORM REAJ-REAM
      *     ELSE
      *        MOVE ZEROES TO RCV-SGV-REAM IN RCV.
      *RJZ FIN 31-MAYO-1995
      *DPM fin  11-OCT-1996
       FIN-CAL-REAJ.
           EXIT.

      *RJZ INI 31-MAYO-1995

       REAJ-REAM SECTION.
       INI-REAJ-REAM.
      *     MOVE ZEROES       TO WSS-SGV-RAFV IN WSS-VARI.
      *     MOVE WSS-SGV-CAPI TO WSS-AUX-CAPI IN WSS-VARI.
      *     MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
      *     MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
      *     MOVE VEN-FEC-FVEN IN VEN TO TAB-FEC-FTRN IN TAB.
      *     PERFORM GET-VCAM.
      *     IF MSG-COD-MENS = SPACES
      *        MULTIPLY WSS-AUX-CAPI IN WSS-VARI BY
      *                 CAM-SGV-VCAM IN CAM GIVING WSS-SGV-RAFV
      *                                            IN WSS-VARI.
      *     SUBTRACT WSS-SGV-RAFV IN WSS-VARI FROM WSS-SGV-RAFC GIVING
      *              RCV-SGV-REAM IN RCV.
      *     MOVE RCV-SGV-REAM IN RCV TO PES-SGV-DECI IN PES-VARI.
      *     PERFORM PES-SCTV.
      *     MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-REAM IN RCV.
      * RBG/INI/18-JUL-1996
      *    SUBTRACT RCV-SGV-REAM IN RCV FROM RCV-SGV-REAJ GIVING
      *             RCV-SGV-REAJ IN RCV.
      * RBG/FIN/18-JUL-1996
       FIN-REAJ-REAM.
           EXIT.

      * RBG/INI/18-JUL-1996
      * OBT-CAPP SECTION.
      * INI-OBT-CAPP.
      *     MOVE WSS-SGV-CAPI TO WSS-AUX-CAPI IN WSS-VARI.
      *     MOVE '0999  '     TO TAB-CIC-CTAB IN TAB.
      *     MOVE SCR-COD-VCOC TO TAB-COD-CTAB IN TAB.
      *     MOVE OPC-FEC-FCOL IN OPC TO TAB-FEC-FTRN IN TAB.
      *     PERFORM GET-VCAM.
      *     IF MSG-COD-MENS = SPACES
      *        MULTIPLY RCV-SGV-CAPI IN RCV BY
      *                 CAM-SGV-VCAM IN CAM GIVING RCV-SGV-CAPP IN RCV.
      *     MOVE RCV-SGV-CAPP IN RCV TO PES-SGV-DECI IN PES-VARI.
      *     PERFORM PES-SCTV.
      *     MOVE PES-SGV-ENTE IN PES-VARI TO RCV-SGV-CAPP IN RCV.
      * FIN-OBT-CAPP.
      *     EXIT.
      * RBG/FIN/18-JUL-1996
      * RJZ FIN 31-MAYO-1995

       CAL-INTE SECTION.
       INI-CAL-INTE.
           SUBTRACT VEN-VAL-SCAP IN CAN-FLD FROM
                    VEN-VAL-SFIN IN CAN-FLD GIVING
                    RCV-SGV-INTE IN RCV.
       FIN-CAL-INTE.
           EXIT.

       SET-MSG-CLTE SECTION.
       INI-SET-MSG-CLTE.
           MOVE '00' TO PGM-STAT-DBC.
           MOVE ZEROES TO DBC-NUM-ICLI IN DBC.
           MOVE SPACES TO DBC-VRF-ICLI IN DBC.
           MOVE SPACES TO DBC-GLS-ICLI IN DBC.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC IN MSG TO DBC-GLS-NOMC IN DBC.
       FIN-SET-MSG-CLTE.
           EXIT.

       BUS-COR-CAN SECTION.
       INI-BUS-COR-CAN.
           MOVE 999 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CAI-IOPC IN CAN-FLD = CAN-CAI-IOPC IN CAN AND
                    CAN-IIC-IOPC IN CAN-FLD = CAN-IIC-IOPC IN CAN )
               PERFORM KEY-ALL-CAN
               MOVE ZEROES TO CAN-NUM-ICAN IN CAN.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO CAN-NUM-ICAN IN CAN
               MOVE CAN-NUM-ICAN IN CAN TO CAN-NUM-ICAN IN CAN-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-CAN.
           EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       INI-ROV SECTION.
       INI-INI-ROV.
      *     MOVE CAN-STP-ITRN IN CAN TO ROV-STP-IINV IN ROV.
      *     MOVE SPACES TO ROV-IND-AINV IN ROV.
      *     MOVE SPACES TO ROV-COD-OINV IN ROV.
           MOVE ZEROES TO ROV-SGV-RENO IN ROV.
           MOVE SCR-COD-VCOC TO ROV-COD-VCVR IN ROV.
           MOVE SPACES TO ROV-GLS-DISP IN ROV.
       FIN-INI-ROV.
           EXIT.

       INI-ICG SECTION.
       INI-INI-ICG.
      *     MOVE CAN-STP-ITRN IN CAN TO ICG-STP-IINV IN ICG.
      *     MOVE SPACES TO ICG-IND-AINV IN ICG.
      *     MOVE SPACES TO ICG-COD-OINV IN ICG.
           MOVE ZEROES TO ICG-FEC-FTER IN ICG.
           MOVE ZEROES TO ICG-SGV-SPRD IN ICG.
           MOVE ZEROES TO ICG-SGV-MNTO IN ICG.
           MOVE SPACES TO ICG-GLS-DISP IN ICG.
       FIN-INI-ICG.
           EXIT.

       INI-RCV SECTION.
       INI-INI-RCV.
      *     MOVE CAN-STP-ITRN IN CAN TO RCV-STP-IINV IN RCV.
      *     MOVE SPACES TO RCV-IND-AINV IN RCV.
      *     MOVE SPACES TO RCV-COD-OINV IN RCV.
           MOVE SPACES TO RCV-KEY-IDLC IN RCV.
           MOVE ZEROES TO RCV-NUM-IEVC IN RCV.
           MOVE SPACES TO RCV-MSC-MCAN IN RCV.
           MOVE ZEROES TO RCV-SGV-INTE IN RCV.
           MOVE SPACES TO RCV-IND-SCTB IN RCV.
           MOVE ZEROES TO RCV-FEC-FCAN IN RCV.
           MOVE ZEROES TO RCV-FEC-FOUT IN RCV.
           MOVE ZEROES TO RCV-SGV-REAJ IN RCV.
      * RBG/INI/22-JUL-1996
      *DPM ini  11-OCT-1996  Se asterisqueo campo RCV-SGV-REAM
      *     MOVE ZEROES TO RCV-SGV-REAM IN RCV.
           MOVE ZEROES TO RCV-SGV-INTN IN RCV.
      *DPM fin  11-OCT-1996
           MOVE ZEROES TO RCV-SGV-INTM IN RCV.
      * RBG/FIN/22-JUL-1996
           MOVE SPACES TO RCV-GLS-DISP IN RCV.
       FIN-INI-RCV.
           EXIT.

        INI-KDLC SECTION.
        INI-INI-KDLC.
            MOVE CAN-CAI-IOPC IN CAN-FLD TO VEN-CAI-IOPC IN VEN.
            MOVE CAN-IIC-IOPC IN CAN-FLD TO VEN-IIC-IOPC IN VEN.
            MOVE VEN-NUM-IVEN IN CAN-FLD TO VEN-NUM-IVEN IN VEN.
            MOVE FIO-GET-KEY TO FIO-CMND.
            IF OPC-IND-VSTR IN OPC = 'S'
               PERFORM COL-OBT-VEN
               IF VEN-STAT-OKS OR VEN-STAT-ENO
                   MOVE '00' TO FIO-STAT
               ELSE
                   MOVE '23' TO FIO-STAT
           ELSE
               PERFORM COL-FIO-VEN.
            IF FIO-STAT-OKS
                MOVE CAN-CAI-IOPC IN CAN-FLD TO RCV-CAI-IOPD IN RCV
                MOVE CAN-IIC-IOPC IN CAN-FLD TO RCV-IIC-IOPD IN RCV
                MOVE VEN-NUM-IDLC IN VEN     TO RCV-NUM-IDLC IN RCV.
        FIN-INI-KDLC.
            EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-CAN-REQA > SPACES
               PERFORM LEE-NXT-PRV-CAN
           ELSE
               PERFORM LEE-NXT-PRV-CIC.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-CAN SECTION.
       INI-LEE-NXT-PRV-CAN.
           MOVE SCR-CAN-REQA TO ADR-CAN-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE FIO-STAT TO PGM-STAT-CAN.
           IF FIO-STAT-OKS
               MOVE ADR-CAN-REQA TO SCR-CAN-REQA.
       FIN-LEE-NXT-PRV-CAN.
           EXIT.

       LEE-NXT-PRV-CIC SECTION.
       INI-LEE-NXT-PRV-CIC.
           IF CAN-IIC-IOPC IN CAN > ZEROES
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM COL-FIO-CAN
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           MOVE FIO-STAT TO PGM-STAT-CAN.
           IF FIO-STAT-OKS
               MOVE ADR-CAN-REQA TO SCR-CAN-REQA.
       FIN-LEE-NXT-PRV-CIC.
           EXIT.

       LEE-NXT-PRV-RCV SECTION.
       INI-LEE-NXT-PRV-RCV.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE CAN-CAI-IOPC IN CAN TO RCV-CAI-IOPC IN RCV.
           MOVE CAN-IIC-IOPC IN CAN TO RCV-IIC-IOPC IN RCV.
           MOVE CAN-NUM-ICAN IN CAN TO RCV-NUM-ICAN IN RCV.
           MOVE CAN-CIC-IOPC IN CAN TO RCV-CIC-IOPV IN RCV.
           MOVE VEN-NUM-IVEN IN VEN TO RCV-NUM-IVCT IN RCV.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF NOT FIO-STAT-OKS
               MOVE 'RCVNO' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-RCV.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-RCV.
           IF FIO-STAT-OKS AND
              CAN-CIC-IOPC IN CAN = RCV-CIC-IOPC IN RCV AND
              CAN-CIC-IOPC IN CAN = RCV-CIC-IOPV IN RCV AND
              CAN-NUM-ICAN IN CAN = RCV-NUM-ICAN IN RCV
               MOVE RCV-NUM-IVCT IN RCV TO VEN-NUM-IVEN IN VEN
               MOVE 'RCVSI' TO MSG-COD-MENS
               MOVE '00' TO PGM-STAT-RCV
           ELSE
               MOVE 'RCVNO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-RCV.
           EXIT.

       GET-CUR-ITR SECTION.
       INI-GET-CUR-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE CAN-CIC-IOPC IN CAN TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR.
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR.
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS AND
              ITR-CIC-IOPC IN ITR = CAN-CIC-IOPC IN CAN AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
               MOVE '00' TO PGM-STAT-ITR
           ELSE
               MOVE '23' TO PGM-STAT-ITR.
       FIN-GET-CUR-ITR.
           EXIT.

       GET-NXT-ITR SECTION.
       INI-GET-NXT-ITR.
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF FIO-STAT-OKS                              AND
              ITR-CIC-IOPC IN ITR = CAN-CIC-IOPC IN CAN AND
              ITR-NUM-ICAN IN ITR = ZEROES              AND
              ITR-CIC-IOPV IN ITR = SPACES              AND
              ITR-NUM-IVCT IN ITR = ZEROES              AND
              ITR-IND-TTAS IN ITR = 'INT'
              MOVE 'M' TO WSS-IND-MITR
           ELSE
              PERFORM GET-CUR-ITR.
       FIN-GET-NXT-ITR.
           EXIT.

       GET-CUR-ICG SECTION.
       INI-GET-CUR-ICG.
           MOVE CAN-CIC-IOPC IN CAN TO ICG-CIC-IOPC IN ICG.
           MOVE CAN-NUM-ICAN IN CAN TO ICG-NUM-ICAN IN ICG.
           MOVE CAN-CIC-IOPC IN CAN TO ICG-CIC-IOPV IN ICG
           MOVE ZEROES              TO ICG-NUM-IVCT IN ICG
           MOVE 'INT'               TO ICG-IND-TTAS IN ICG.
           MOVE ZEROES              TO ICG-FEC-FINI IN ICG.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-ICG.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-ICG
           ELSE
               MOVE '23' TO PGM-STAT-ICG.
       FIN-GET-CUR-ICG.
           EXIT.

       GET-FEC-FCVC SECTION.
       INI-GET-FEC-FCVC.
           PERFORM GET-FHOY.
      *JUS ini  2-DEC-1994 16:34:42 Muevo fecha de hoy a fecha ctbl (EGR
           MOVE HOY-DHOY TO CAN-NUM-DOUT IN CAN
                            CAN-NUM-DOUT IN CAN.
           MOVE HOY-MHOY TO CAN-NUM-MOUT IN CAN
                            CAN-NUM-MOUT IN CAN.
           MOVE HOY-SHOY TO CAN-NUM-SOUT IN CAN
                            CAN-NUM-SOUT IN CAN.
           MOVE HOY-AHOY TO CAN-NUM-AOUT IN CAN
                            CAN-NUM-AOUT IN CAN.
      *JUS fin  2-DEC-1994 16:34:42
       FIN-GET-FEC-FCVC.
           EXIT.

       FST-CYA-CAN SECTION.
       INI-FST-CYA-CAN.
           MOVE OPC-CIC-IOPC IN OPC TO CYA-CIC-IOPC IN CYA.
           MOVE CAN-NUM-ICAN IN CAN TO CYA-NUM-ICAN IN CYA.
           MOVE ZEROES              TO CYA-NUM-ICYA IN CYA.
           MOVE FIO-GET-NLS TO FIO-CMND.
       FIN-FST-CYA-CAN.
           EXIT.

       FND-KEY-CYA SECTION.
       INI-FND-KEY-CYA.
      * RECORRE CYA'S DE CANCELACION, DETECTA :
      * PAGO AUTOMATICO, PAGO POR CAJA Y MULTIPLES CYA

           PERFORM FST-CYA-CAN.
           PERFORM COL-FIO-CYA.

           IF NOT ( FIO-STAT-OKS AND
                    OPC-CIC-IOPC IN OPC = CYA-CIC-IOPC IN CYA AND
                    CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA )
               MOVE '23' TO FIO-STAT
               GO TO END-FND-KEY-CYA.

       CIC-FND-KEY-CYA.
      *JSS  25-JUL-1991 17:47:09 ( lee siempre TCYA para saber que tipo
           MOVE 'TCYA'              TO MSC-COD-TMSC IN MSC.
           MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC.
           MOVE 'TAB'       TO FIO-SIST.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF FIO-STAT-OKS
               IF MSC-CIC-CMSC IN MSC = 'CC'
      *JSS/PGV 4-DEC-1991 21:47:53
                  AND ( MSC-COD-DAT1(2) NOT = 'M' )
      *
                   MOVE 'S' TO SCR-CYA-IND-CCTE
               ELSE
                   MOVE 'N' TO SCR-CYA-IND-CCTE
           ELSE
               MOVE SPACES TO MSC-CIC-CMSC IN MSC.
      *
           IF CYA-IND-MAUT IN CYA = 'S'
                MOVE 'S' TO SCR-CYA-IND-PAUT
           ELSE
      *JSS 23-MAY-1991 17:31:06 ( si no es con pago automatico, pregunta
      *igual es con cuenta para marcar 'C' )
               IF SCR-CYA-IND-CCTE = 'S'
                   MOVE 'C' TO SCR-CYA-IND-PAUT.

           IF SCR-CYA-IND-CAJA NOT = 'S'
      *          MOVE 'TAB' TO MSC-COD-SIST
      *          MOVE 'TCYA' TO MSC-COD-TMSC IN MSC
      *          MOVE CYA-IND-TCYA IN CYA TO MSC-COD-CMSC IN MSC
      *          PERFORM BUS-MSC
      *          IF MSG-COD-MENS = SPACES
                    IF MSC-CIC-CMSC IN MSC = 'CAJA'
                         MOVE 'S' TO SCR-CYA-IND-CAJA.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-CYA.
           IF FIO-STAT-OKS AND
              OPC-CIC-IOPC IN OPC = CYA-CIC-IOPC IN CYA AND
              CAN-NUM-ICAN IN CAN = CYA-NUM-ICAN IN CYA
                 MOVE 'M' TO SCR-CYA-IND-MCYA
                 GO TO CIC-FND-KEY-CYA.

           IF SCR-CYA-IND-MCYA NOT = 'M'
               PERFORM FST-CYA-CAN
               PERFORM COL-FIO-CYA
               MOVE CYA-IND-TCYA IN CYA TO CYA-IND-TCYA IN CAN-FLD
               MOVE CYA-CAI-ICYA IN CYA TO CYA-CAI-ICYA IN CAN-FLD
               MOVE CYA-IIC-ICYA IN CYA TO CYA-IIC-ICYA IN CAN-FLD.

       END-FND-KEY-CYA.
           MOVE FIO-STAT TO PGM-STAT-CYA.
       FIN-FND-KEY-CYA.
           EXIT.

       BUS-COR-CAN-REV SECTION.
       INI-BUS-COR-CAN-REV.
           MOVE 999 TO CAN-NUM-ICAN IN CAN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-BUS-COR-CAN-REV.
           PERFORM COL-FIO-CAN.
           IF NOT ( FIO-STAT-OKS AND
                    CAN-CAI-IOPC IN CAN-FLD = CAN-CAI-IOPC IN CAN AND
                    CAN-IIC-IOPC IN CAN-FLD = CAN-IIC-IOPC IN CAN )
               PERFORM KEY-ALL-CAN
               MOVE ZEROES TO CAN-NUM-ICAN IN CAN
               GO TO FIN-BUS-COR-CAN-REV.
      *LRH ini  01-JUN-1994   (Memo.12-08-93 Pto.1)
      *     IF CAN-MSC-STAT IN CAN NOT = 'R' AND
      *        CAN-SGV-TPAG IN CAN NOT < ZEROES AND
      *        CAN-SGV-TREN IN CAN NOT < ZEROES
      *         MOVE CAN-NUM-ICAN IN CAN TO CAN-NUM-ICAN IN CAN-FLD
      *         GO TO FIN-BUS-COR-CAN-REV
           IF CAN-MSC-STAT IN CAN NOT = 'R' AND
              CAN-SGV-TPAG IN CAN > ZEROES AND
      *DAD ini  01-AGO-1994
              CAN-SGV-TREN IN CAN NOT < ZEROES
      *DAD fin  01-AGO-1994
               MOVE CAN-NUM-ICAN IN CAN TO CAN-NUM-ICAN IN CAN-FLD
               GO TO FIN-BUS-COR-CAN-REV
           ELSE
               IF CAN-MSC-STAT IN CAN NOT = 'R' AND
                  CAN-SGV-TPAG IN CAN = ZEROES AND
      *DAD ini  01-AGO-1994
                  CAN-SGV-TREN IN CAN NOT < ZEROES
      *DAD fin  01-AGO-1994
                   MOVE CAN-NUM-ICAN IN CAN TO WSS-NUM-ICAX
                   PERFORM VRF-REV-CERO
                   IF SCR-STAT = SCR-STAT-CON
                       GO TO FIN-BUS-COR-CAN-REV
                   ELSE
      *ALD-BCI-INI/ 28-OCT-1997
                       MOVE WSS-NUM-ICAX TO CAN-NUM-ICAN IN CAN
      *ALD-BCI-FIN/ 28-OCT-1997
                       MOVE WSS-NUM-ICAX TO CAN-NUM-ICAN IN CAN-FLD
                       GO TO FIN-BUS-COR-CAN-REV
      *LRH fin  01-JUN-1994
               ELSE
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-BUS-COR-CAN-REV.
       FIN-BUS-COR-CAN-REV.
           EXIT.

      *LRH ini  01-JUN-1994   (Memo.12-08-93 Pto.1)
       VRF-REV-CERO SECTION.
       INI-VRF-REV-CERO.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM COL-FIO-CAN.
           IF CAN-MSC-STAT IN CAN = 'R' AND
              CAN-CAI-IOPC IN CAN-FLD = CAN-CAI-IOPC IN CAN AND
              CAN-IIC-IOPC IN CAN-FLD = CAN-IIC-IOPC IN CAN
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'CAN    YAREV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCR-STAT-CON TO SCR-STAT.
       FIN-VRF-REV-CERO.
           EXIT.
      *LRH fin  01-JUN-1994

      *parrafo para buscar la ultima cancelacion asociada a un mismo
      *vencimiento ( despues de hacer un GET-LEQ por IVCT )
       ULT-RCV-IVCT SECTION.
       INI-ULT-RCV-IVCT.
           MOVE RCV-NUM-IVCT IN RCV TO WSS-NUM-IVCT.
           MOVE RCV-KEY-IRCV IN RCV TO WSS-RCV-KEY-IRCV.
       LUP-ULT-RCV-IVCT.
           MOVE FIO-GET-NXT    TO FIO-CMND.
      *LRH ini  18-ABR-1994
           MOVE 'RCV-KEY-IVCT' TO FIO-AKEY.
      *LRH fin  18-ABR-1994
           PERFORM COL-FIO-RCV.
           IF FIO-STAT-OKS AND
              RCV-CIC-IOPC IN RCV = WSS-RCV-CIC-IOPC AND
              RCV-NUM-IVCT IN RCV = WSS-NUM-IVCT
               IF RCV-NUM-ICAN IN RCV > WSS-RCV-NUM-ICAN
                   MOVE RCV-KEY-IRCV IN RCV TO WSS-RCV-KEY-IRCV
                   GO TO LUP-ULT-RCV-IVCT
               ELSE
                   GO TO LUP-ULT-RCV-IVCT.
           MOVE WSS-RCV-KEY-IRCV TO RCV-KEY-IRCV IN RCV.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-RCV.
      *Para resetear WSS-NUM-IVCT
           ADD 1 RCV-NUM-IVCT IN RCV GIVING WSS-NUM-IVCT.
       FIN-ULT-RCV-IVCT.
           EXIT.
