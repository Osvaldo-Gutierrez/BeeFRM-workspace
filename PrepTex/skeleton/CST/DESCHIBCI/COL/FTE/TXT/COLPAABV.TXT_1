*%! Codigo adicional para archivo
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% IF PGM_PQ
*% PGM_PTC = TRUE
*% END
*% IF PGM_PU
*% PGM_PTC = FALSE
*% END
*% IF CMT_ID_PQ
      * MANTENCIONES
      *----------------------------------------------------------------*
      * PROYECTO : BACKVALUE - UF Y TASA VARIABLE
      * NUB      : 53614
      * OBJETIVO : PERMITIR CORRECCION DE BACKVALUE PARA UF Y TASA VAR
      * RESPONSABLE : CIMA-OGB
      * ETIQUETA : OGB-INI 20-JUL-2017 BACKVALUE - UF TASA VARIABLE
      *----------------------------------------------------------------*
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY COLBROPC.
       COPY COLBRVEN.
       COPY COLBRICG.
       COPY TABBRCAM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY COLBRRDC.
       COPY SGCBRDBC.

       COPY GNSWGCPT.
       COPY GNSWGPES.
       COPY COLWGINT.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
*% IF PGM_PQ
       01  WSS-VARI.
           03  WSS-COD-PESO                       PIC X(06).
           03  WSS-IND-DESC-INT    VALUE SPACES   PIC X(01).
           03  WSS-IND-TAUT        VALUE SPACES   PIC X(03).
           03  WSS-SGV-VINT        VALUE ZEROES   PIC S9(11)V9(4).
           03  WSS-VAL-INT1        VALUE ZEROES   PIC S9(11)V9(4).
           03  WSS-IND-ABV-ING     VALUE SPACES   PIC X(01).
           03  WSS-COD-CAUX.
               05 WSS-COD-TOOC                    PIC X(03).
               05 WSS-COD-AOOC                    PIC X(03).
           03  WSS-GLS-PLZBV.
               05 WSS-NUM-PMIN                    PIC 9(03).
               05 FILLER                          PIC X(02).
               05 WSS-NUM-PMAX                    PIC 9(03).
               05 FILLER                          PIC X(02).
               05 WSS-NUM-PTOP                    PIC 9(03).
           03  WSS-GLS-MTOBV.
               05 WSS-NUM-MMNM                    PIC 9(11).
               05 FILLER                          PIC X(09).
               05 WSS-NUM-MMAX                    PIC 9(11).
               05 FILLER                          PIC X(09).
               05 WSS-NUM-MTOP                    PIC 9(11).

      *OGB-INI 20-JUL-2017 BACKVALUE - UF TASA VARIABLE
           03  WSS-NUM-NDIA           VALUE ZEROES    PIC 9(05).
           03  WSS-IND-NPER           VALUE SPACES    PIC X(01).
           03  WSS-NUM-NPER           VALUE ZEROES    PIC 9(05).

           03  WSS-DIF-DVEN           VALUE ZEROES    PIC 9(04).
           03  WSS-DIF-DICG           VALUE ZEROES    PIC 9(04).
           03  WSS-BCK-AUX-CBV.
               05 WSS-BCK-IND-MTO                     PIC X(01).
               05 WSS-BCK-IND-PZO                     PIC X(01).
               05 FILLER                              PIC X(01).
               05 WSS-BCK-COD-VCMT                    PIC X(06).
               05 WSS-BCK-SGV-MMIN                    PIC 9(11)V9(4).
               05 FILLER                              PIC X(01).
               05 WSS-BCK-SGV-MMAX                    PIC 9(11)V9(4).
               05 FILLER                              PIC X(04).
               05 WSS-BCK-NUM-PMIN                    PIC 9(05).
               05 FILLER                              PIC X(01).
               05 WSS-BCK-IND-PMIN                    PIC X(01).
               05 FILLER                              PIC X(02).
               05 WSS-BCK-NUM-PMAX                    PIC 9(05).
               05 FILLER                              PIC X(01).
               05 WSS-BCK-IND-PMAX                    PIC X(01).

           03  WSS-COD-MTBV.
               05 WSS-COD-MTOBV   VALUE 'MTOBV'       PIC X(05).
               05 WSS-COD-MNDBV                       PIC X(06).
               05 FILLER          VALUE SPACES        PIC X(01).

           03  WSS-GLS-LMMT.
               05 WSS-SGV-LMMT-MMIN                   PIC 9(11)V9(4).
               05 FILLER                              PIC X(05).
               05 WSS-SGV-LMMT-MMAX                   PIC 9(11)V9(4).

           03  WSS-GLS-VAL-AUX              PIC  ZZ.ZZZ.ZZZ.ZZ9,9999.

      *OGB-FIN 20-JUL-2017 BACKVALUE - UF TASA VARIABLE


       01  WSS-CONSTANTES.
           03  WSS-CT-RDCKEY  VALUE 'RDC-KEY-IDLC'      PIC X(12).
           03  WSS-CT-1       VALUE 1                   PIC 9(01).
           03  WSS-CT-A       VALUE 'A'                 PIC X(01).
           03  WSS-CT-L       VALUE 'L'                 PIC X(01).
           03  WSS-CT-N       VALUE 'N'                 PIC X(01).
           03  WSS-CT-S       VALUE 'S'                 PIC X(01).
           03  WSS-CT-J       VALUE 'J'                 PIC X(01).
           03  WSS-CT-ALM     VALUE 'ALM'               PIC X(03).
           03  WSS-CT-ABV     VALUE 'ABV'               PIC X(03).
           03  WSS-CT-ING     VALUE 'ING'               PIC X(03).
           03  WSS-CT-MOD     VALUE 'MOD'               PIC X(03).
           03  WSS-CT-ELI     VALUE 'ELI'               PIC X(03).
           03  WSS-CT-INT     VALUE 'INT'               PIC X(03).
           03  WSS-CT-COL     VALUE 'COL'               PIC X(03).
           03  WSS-CT-PRO     VALUE 'PRO'               PIC X(03).
           03  WSS-CT-VSN     VALUE 'VSN'               PIC X(03).
           03  WSS-CT-REN     VALUE 'REN'               PIC X(03).
           03  WSS-CT-TAB     VALUE 'TAB'               PIC X(03).
           03  WSS-CT-VLR     VALUE 'VLR'               PIC X(03).
           03  WSS-CT-TIO     VALUE 'TIO'               PIC X(03).
           03  WSS-CT-AUX     VALUE 'AUX'               PIC X(03).
           03  WSS-CT-0999    VALUE '0999  '            PIC X(06).
           03  WSS-CT-CODNEX  VALUE 'COD    NEX'        PIC X(10).
           03  WSS-CT-CODNVG  VALUE 'COD    NVG'        PIC X(10).
           03  WSS-CT-OPCNEX  VALUE 'OPC    NEX'        PIC X(10).
           03  WSS-CT-SALCRO  VALUE 'OPCSCRENOINF'      PIC X(12).
           03  WSS-CT-OPCNOA  VALUE 'MSCOPCNOPER '      PIC X(12).
           03  WSS-CT-TABAKEY VALUE 'TAB-CIC-TABL'      PIC X(12).
           03  WSS-CT-CICPESO VALUE 'CICPESONEX  '      PIC X(12).

           03  WSS-CT-NDIABV  VALUE 'NDIA > PTOP '      PIC X(12).
           03  WSS-CT-DIFDIA  VALUE 'DIFDIA   INV'      PIC X(12).
           03  WSS-CT-TABPZO  VALUE 'TABPZO NOVAL'      PIC X(12).
           03  WSS-CT-OPTVAR  VALUE 'OPE  TASAVAR'      PIC X(12).
           03  WSS-CT-OPNOPE  VALUE 'OPE   NOPESO'      PIC X(12).
           03  WSS-CT-OP1VEN  VALUE 'OPE   NO1VEN'      PIC X(12).
           03  WSS-CT-LIQNO   VALUE 'OPC    LIQNO'      PIC X(12).
           03  WSS-CT-YAACA   VALUE 'OPC    YAACA'      PIC X(12).
           03  WSS-CT-TRAREN  VALUE 'OPE  TRASREN'      PIC X(12).
           03  WSS-CT-NOCBV   VALUE 'TIOAUX NOCBV'      PIC X(12).
           03  WSS-CT-NO1VEN  VALUE 'NOEXT1ERVEN '      PIC X(12).
           03  WSS-CT-DIN1VN  VALUE 'DINT>INT1VEN'      PIC X(12).
           03  WSS-CT-NODIFF  VALUE 'NODIFDIAFEC '      PIC X(12).
      *OGB-INI 20-JUL-2017 BACKVALUE - UF TASA VARIABLE
           03  WSS-CT-CAMNEX  VALUE 'CAM    NEX'   PIC X(10).
           03  WSS-CT-C       VALUE 'C'                 PIC X(01).
           03  WSS-CT-D       VALUE 'D'                 PIC X(01).
           03  WSS-CT-M       VALUE 'M'                 PIC X(01).
      *OGB-FIN 20-JUL-2017 BACKVALUE - UF TASA VARIABLE
*% END
*% IF PGM_PU
       01  WSS-VARI.
           03  WSS-IND-DESC-INT    VALUE SPACES   PIC X(01).
           03  WSS-SGV-VINT        VALUE ZEROES   PIC S9(11)V9(4).
           03  WSS-VAL-INT1        VALUE ZEROES   PIC S9(11)V9(4).

       01  WSS-CONSTANTES.
           03  WSS-CT-COL     VALUE 'COL'               PIC X(03).
           03  WSS-CT-ABV     VALUE 'ABV'               PIC X(03).
           03  WSS-CT-ING     VALUE 'ING'               PIC X(03).
           03  WSS-CT-MOD     VALUE 'MOD'               PIC X(03).
           03  WSS-CT-OPCNEX  VALUE 'OPC    NEX'        PIC X(10).
           03  WSS-CT-1       VALUE 1                   PIC 9(01).
           03  WSS-CT-NO1VEN  VALUE 'NOEXT1ERVEN '      PIC X(12).
           03  WSS-CT-DIN1VN  VALUE 'DINT>INT1VEN'      PIC X(12).
*% END
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF FIO-STAT-OKS
              MOVE WSS-CT-S  TO WSS-IND-ABV-ING.
           IF NOT FIO-STAT-OKS AND SCR-CMND NOT = WSS-CT-ING
              GO TO FIN-FND-KEY.

           MOVE OIA-CAI-IOPC IN OIA TO OPC-CAI-IOPC IN OPC
           MOVE OIA-IIC-IOPC IN OIA TO OPC-IIC-IOPC IN OPC
           PERFORM COL-FIO-OPC
           IF NOT FIO-STAT-OKS
              MOVE WSS-CT-COL      TO MSG-COD-SIST
              MOVE WSS-CT-OPCNEX   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE ZEROES   TO FIO-STAT
              GO TO FIN-FND-KEY.

           IF OPC-VAL-CRED IN OPC NOT > ZEROES AND
              SCR-CMND = WSS-CT-ING
              MOVE WSS-CT-COL     TO MSG-COD-SIST
              MOVE WSS-CT-SALCRO  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE ZEROES   TO FIO-STAT
              GO TO FIN-FND-KEY.

           IF OPC-MSC-STAT IN OPC = WSS-CT-A AND
              SCR-CMND = WSS-CT-ING
              MOVE WSS-CT-COL     TO MSG-COD-SIST
              MOVE WSS-CT-OPCNOA  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE ZEROES   TO FIO-STAT
              GO TO FIN-FND-KEY.

           PERFORM PUT-OPC-ALM.
           PERFORM SET-GLS-MONEDA.
           PERFORM SET-GLS-TIO.
           PERFORM SET-GLS-AUX.
           PERFORM PUT-DBC-ALM.
           PERFORM VAL-BACKVALUE.
           PERFORM CAL-BACKVALUE.
           IF WSS-IND-DESC-INT NOT = WSS-CT-S
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              IF SCR-CMND = WSS-CT-MOD OR
                 SCR-CMND = WSS-CT-ELI
                 MOVE PGM-SRNF  TO FIO-STAT
                 GO TO FIN-FND-KEY
              ELSE
                 MOVE ZEROES    TO FIO-STAT
                 GO TO FIN-FND-KEY.

           MOVE PGM-STAT-OIA TO FIO-STAT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBGCPT.
       COPY GNSBGPES.
       COPY COLBGINT.
       COPY GNSBPFEC.

       COPY COLBFOPC.
       COPY COLBFRDC.
       COPY COLBFVEN.
       COPY COLBFICG.
       COPY SGCBFDBC.
       COPY TABBFCAM.

      *>>>>
*% END
