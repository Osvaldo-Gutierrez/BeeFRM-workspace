*%! Codigo Adicional
*% IF PCP_COD_VCOC
      *<<<< PCP_COD_VCOC
           IF PCP-COD-VCOC IN PCP-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-GLS-VCOC IN PCP-FLD(FRM-IFLD)
              GO TO FIN-VAL-PCP-COD-VCOC.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                         TO TAB-COD-SIST.
           MOVE 'VLR '                        TO TAB-COD-TTAB IN TAB.
           MOVE PCP-COD-VCOC IN PCP-FLD(FRM-IFLD) TO 
                                                 TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              PCP-COD-VCOC IN PCP-FLD(FRM-IFLD) NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCOC IN PCP-FLD(FRM-IFLD)
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                              FRM-GLS-VCOC IN PCP-FLD(FRM-IFLD).
*% END
*% IF INI_PCP_COD_OFIC
      *<<<< INI_PCP_COD_OFIC
           IF PCP-COD-OFIC IN PCP-FLD = '*  '
              GO TO FIN-VAL-PCP-COD-OFIC.
           IF PCP-COD-OFIC IN PCP-FLD = '   '
           AND SCR-CMND = 'CON'
              GO TO FIN-VAL-PCP-COD-OFIC.
      *>>>>
*% END
*% IF INI_PCP_FEC_FPLA
      *<<<< INI_PCP_FEC_FPLA
           IF PCP-FEC-FPLA IN PCP-FLD = ZEROES
           AND SCR-CMND = 'CON'
              GO TO FIN-VAL-PCP-FEC-FPLA.
           IF PCP-FEC-FPLA IN PCP-FLD = 99999999
           AND SCR-CMND = 'CON'
              GO TO FIN-VAL-PCP-FEC-FPLA.
      *>>>>
*% END
*% IF INI_PCP_COD_COMI 
      *<<<< INI_PCP_COD_COMI
           IF PCP-COD-COMI IN PCP-FLD(1) NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-PCP-COD-COMI.

           IF PCP-COD-COMI IN PCP-FLD(FRM-IFLD) NOT > SPACES
              GO TO FIN-VAL-PCP-COD-COMI.
      *>>>>
*% END
*% IF INI_PCP_IND_SCTB
      *<<<< INI_PCP_IND_SCTB
           IF PCP-IND-SCTB IN PCP-FLD(FRM-IFLD) NOT > SPACES
              GO TO FIN-VAL-PCP-IND-SCTB.
      *>>>>
*% END
*% IF INI_PCP_COD_TITA    
      *<<<< INI_PCP_COD_TITA    
           IF PCP-COD-TITA IN PCP-FLD(FRM-IFLD) NOT > SPACES
              GO TO FIN-VAL-PCP-COD-TITA.
           MOVE PCP-COD-TITA IN PCP-FLD(FRM-IFLD) TO
                                WSS-COD-TITA IN WSS-VARI
           MOVE 'COL' TO TAB-COD-SIST
           MOVE 'INT' TO TAB-COD-TTAB IN TAB
           MOVE WSS-COD-TIPT IN WSS-VARI TO TAB-COD-CTAB IN TAB
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'  OR 'COD    NVG'
              MOVE 'COL' TO MSG-COD-SIST
              MOVE 'CODTINT' TO MSG-COD-TMSG
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-PCP-COD-TITA.
      *>>>>
*% END
*% IF INI_PCP_COD_CONC
      *<<<< INI_PCP_COD_CONC
           IF PCP-COD-CONC IN PCP-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO PCP-COD-CONC IN PCP-FLD(FRM-IFLD)
              GO TO FIN-VAL-PCP-COD-CONC.
      *>>>>
*% END
*% IF VAL_CON_FLD_PCP
      *<<<< VAL_CON_FLD_PCP
           MOVE 'COL'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'CMS ' TO TAB-CIC-TTAB IN TAB.
           MOVE 'FLA'  TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG' TO MSG-COD-MENS
                   MOVE 'COL' TO MSG-COD-SIST
                   PERFORM GET-MSG
               ELSE
                   MOVE SPACES  TO MSG-COD-MENS 
                   MOVE TAB-COD-CTAB 
                                TO WSS-COM-TIP-FLA IN WSS-VARI
           ELSE
               MOVE 'COD    NEX' TO MSG-COD-MENS
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG.

           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PCP.

           MOVE 'COL'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'CMS ' TO TAB-CIC-TTAB IN TAB.
           MOVE 'FLV'  TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG' TO MSG-COD-MENS
                   MOVE 'COL' TO MSG-COD-SIST
                   PERFORM GET-MSG
               ELSE
                   MOVE SPACES  TO MSG-COD-MENS 
                   MOVE TAB-COD-CTAB 
                                TO WSS-COM-TIP-FLV IN WSS-VARI
           ELSE
               MOVE 'COD    NEX' TO MSG-COD-MENS
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG.

           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PCP.

           MOVE 'COL'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'CMS ' TO TAB-CIC-TTAB IN TAB.
           MOVE 'INF'  TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'COD    NVG' TO MSG-COD-MENS
                   MOVE 'COL' TO MSG-COD-SIST
                   PERFORM GET-MSG
               ELSE
                   MOVE SPACES  TO MSG-COD-MENS 
                   MOVE TAB-COD-CTAB 
                                TO WSS-COM-TIP-INF IN WSS-VARI
           ELSE
               MOVE 'COD    NEX' TO MSG-COD-MENS
               MOVE 'COL' TO MSG-COD-SIST
               PERFORM GET-MSG.

           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-PCP.

           MOVE ZEROES         TO  WSS-VAL-MANT IN WSS-VARI.
           MOVE SPACES         TO  WSS-COM-ANT IN WSS-VARI.
           MOVE SPACES         TO  WSS-VCOC-ANT IN WSS-VARI.
           PERFORM VAL-CON-PCP-COD-COMI
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > WSS-FRM-TOP
                OR FRM-SUAR = FRM-SUAR-MAL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE -1 TO PCP-COD-COMI-LEN IN PCP-FLD(FRM-IFLD)
                GO TO FIN-VAL-CON-FLD-PCP.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           IF DBC-IND-ICLI IN PCP-FLD = 'M'
      *ISP NO ACEPTA MULTIPLES DEUDORES INDIRECTOS PARA VERSION BCI
               MOVE 'COL'          TO TAB-COD-SIST
               MOVE 'VSN'          TO TAB-COD-TTAB IN TAB
               MOVE 'BCI    MDIND' TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                   MOVE ZEROES TO DBC-NUM-ICLI IN PCP-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN PCP-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN PCP-FLD
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'DLC    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN PCP-FLD
                   GO TO FIN-VAL-DBC-VRF-ICLI
               ELSE
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'BCI    MDIND' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.

      *VAL-RUT Valida Rut
           IF DBC-NUM-ICLI IN PCP-FLD NOT > ZEROES
               MOVE SPACES TO DBC-VRF-ICLI IN PCP-FLD
                              DBC-IND-ICLI IN PCP-FLD
                              DBC-GLS-ICLI IN PCP-FLD
                              PCP-CAI-ICLI IN PCP-FLD
                              PCP-IIC-ICLI IN PCP-FLD
                              GO TO FIN-VAL-DBC-VRF-ICLI.
           MOVE DBC-NUM-ICLI IN PCP-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN PCP-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           IF MSG-COD-MENS = SPACES AND
              DBC-NUM-ICLI IN PCP-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN PCP-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN PCP-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN PCP-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC IN MSG TO DBC-GLS-NOMC IN PCP-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN PCP-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO PCP-CAI-ICLI IN PCP-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO PCP-IIC-ICLI IN PCP-FLD

                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN PCP-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN PCP-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN PCP-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN PCP-FLD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       VAL-CON-PCP-COD-COMI SECTION.
       INI-VAL-CON-PCP-COD-COMI.
           IF PCP-COD-COMI IN PCP-FLD(FRM-IFLD) = SPACES
                GO TO ANT-VAL-CON-PCP-COD-COMI.
           IF WSS-COM-ANT IN WSS-VARI = WSS-COM-TIP-INF IN WSS-VARI 
           OR (  PCP-COD-COMI IN PCP-FLD(FRM-IFLD) = 
                 WSS-COM-TIP-INF IN WSS-VARI
             AND WSS-COM-ANT IN WSS-VARI > SPACES )
                MOVE 'COD    INC'  TO MSG-COD-MENS
                MOVE 'COL'         TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE  FRM-SUAR-MAL TO FRM-SUAR
                MOVE MSG-GLS-DESC  TO FRM-MENS
                GO TO FIN-VAL-CON-PCP-COD-COMI.
           IF FRM-IFLD = 1 
                GO TO ANT-VAL-CON-PCP-COD-COMI.
           IF WSS-COM-ANT  IN WSS-VARI = SPACES
                MOVE 'COD    SPA'  TO MSG-COD-MENS
                MOVE 'COL'         TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE  FRM-SUAR-MAL TO FRM-SUAR
                MOVE MSG-GLS-DESC  TO FRM-MENS
                GO TO FIN-VAL-CON-PCP-COD-COMI.
           IF WSS-COM-ANT IN WSS-VARI =
              PCP-COD-COMI IN PCP-FLD(FRM-IFLD) AND
              WSS-VCOC-ANT IN WSS-VARI =
              PCP-COD-VCOC IN PCP-FLD(FRM-IFLD)
                IF PCP-VAL-MTOP IN PCP-FLD(FRM-IFLD) NOT >
                   WSS-VAL-MANT IN WSS-VARI AND
                   PCP-VAL-MTOP IN PCP-FLD(FRM-IFLD) NOT = ZEROES
                     MOVE 'MTOAPLI<ANT' TO MSG-COD-MENS
                     MOVE 'COL'         TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE  FRM-SUAR-MAL TO FRM-SUAR
                     MOVE MSG-GLS-DESC  TO FRM-MENS
                     GO TO FIN-VAL-CON-PCP-COD-COMI.
           IF PCP-COD-COMI IN PCP-FLD(FRM-IFLD) =
              WSS-COM-TIP-INF IN WSS-VARI
              IF  PCP-COD-CONC IN PCP-FLD(FRM-IFLD)  NOT = SPACES
                   MOVE 'CPT    >SPA' TO MSG-COD-MENS
                   MOVE 'COL'         TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE  FRM-SUAR-MAL TO FRM-SUAR
                   MOVE MSG-GLS-DESC  TO FRM-MENS
                   GO TO FIN-VAL-CON-PCP-COD-COMI.
           IF ( PCP-COD-COMI IN PCP-FLD(FRM-IFLD) =
                    WSS-COM-TIP-FLA IN WSS-VARI OR
                    WSS-COM-TIP-FLV IN WSS-VARI OR
                    WSS-COM-TIP-INF IN WSS-VARI )
              NEXT SENTENCE
           ELSE
              IF  PCP-COD-CONC IN PCP-FLD(FRM-IFLD) = SPACES
                   MOVE 'CPT    SPA'  TO MSG-COD-MENS
                   MOVE 'COL'         TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE  FRM-SUAR-MAL TO FRM-SUAR
                   MOVE MSG-GLS-DESC  TO FRM-MENS
                   GO TO FIN-VAL-CON-PCP-COD-COMI.
           IF PCP-COD-COMI IN PCP-FLD(FRM-IFLD) =
              WSS-COM-TIP-INF IN WSS-VARI 
              IF ( PCP-SGV-TIMP IN PCP-FLD(FRM-IFLD) > ZEROES OR
                   PCP-COD-TITA IN PCP-FLD(FRM-IFLD) > SPACES OR
                   PCP-VAL-MTOP IN PCP-FLD(FRM-IFLD) > ZEROES OR
                   PCP-VAL-COMI IN PCP-FLD(FRM-IFLD) > ZEROES OR
                   PCP-VAL-COMA IN PCP-FLD(FRM-IFLD) )
                     MOVE 'COD    INC'  TO MSG-COD-MENS
                     MOVE 'COL'         TO MSG-COD-SIST
                     PERFORM GET-MSG
                     MOVE  FRM-SUAR-MAL TO FRM-SUAR
                     MOVE MSG-GLS-DESC  TO FRM-MENS
                     GO TO FIN-VAL-CON-PCP-COD-COMI.
      *
       ANT-VAL-CON-PCP-COD-COMI.
           MOVE PCP-COD-VCOC IN PCP-FLD(FRM-IFLD) TO
                                WSS-VCOC-ANT  IN WSS-VARI.
           MOVE PCP-COD-COMI IN PCP-FLD(FRM-IFLD) TO
                                WSS-COM-ANT  IN WSS-VARI.
           MOVE PCP-VAL-MTOP IN PCP-FLD(FRM-IFLD) TO
                                WSS-VAL-MANT IN WSS-VARI.
       FIN-VAL-CON-PCP-COD-COMI.
           EXIT.
       BUS-FLV-FLA SECTION.
       INI-BUS-FLV-FLA.
           IF PCP-COD-COMI IN PCP (WSS-IFLD) =
                WSS-COM-TIP-FLA IN WSS-VARI OR
              PCP-COD-COMI IN PCP (WSS-IFLD) =
                WSS-COM-TIP-FLV IN WSS-VARI
               MOVE 'COD    INC'  TO MSG-COD-MENS
               MOVE 'COL'         TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE  FRM-SUAR-MAL TO FRM-SUAR
               MOVE MSG-GLS-DESC  TO FRM-MENS.
       FIN-BUS-FLV-FLA.
           EXIT.
      *>>>>
*% END
 
