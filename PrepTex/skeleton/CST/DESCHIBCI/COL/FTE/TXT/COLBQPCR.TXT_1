*% IF INI_CGC_FEC_KEY4
      *<<<< INI_CGC_FEC_KEY4
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>> INI_CGC_FEC_KEY4
*% END
*% IF INI_CLR_FLD_PCR
      *<<<< INI_CLR_FLD_PCR
           IF SCR-WSS-IND-HMAS = WSS-CT-1 AND
              FRM-FFLD = FRM-FFLD-PF8
              GO TO FIN-CLR-FLD-PCR.
      *>>>> INI_CLR_FLD_PCR
*% END
*% IF INI_UNP_KEY_PCR
      *<<<< INI_UNP_KEY_PCR
           PERFORM UNP-IKY-PCR.
           PERFORM UNP-AKY-PCR.
           PERFORM UNP-MKY-PCR.
           GO TO FIN-UNP-KEY-PCR.
      *>>>> INI_UNP_KEY_PCR
*% END
*% IF INI_UNP_IKY_PCR
      *<<<< INI_UNP_IKY_PCR
           MOVE FRM-CPIM-UBY TO CGC-FEC-KEY4-ATR IN PCR-FLD.
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN PCR-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN PCR-FLD.
           MOVE FRM-CPIM-UBY TO CGC-GLS-KEY3-ATR.
           MOVE FRM-CPIM-UBY TO CGC-NUM-KEY1-ATR.
           MOVE FRM-CPIM-UBY TO CGC-GLS-KEY6-ATR.
           MOVE FRM-CPIM-UBY TO CGC-GLS-KEY8-ATR.
           MOVE FRM-CPIM-UBY TO CGC-GLS-KEY5-ATR.
           GO TO FIN-UNP-IKY-PCR.
      *>>>> INI_UNP_IKY_PCR
*% END
*% IF CGC_GLS_KEY8
      *<<<< CGC_GLS_KEY8
           IF CGC-GLS-KEY8 IN PCR-FLD NOT = WSS-CT-T AND
              CGC-GLS-KEY8 IN PCR-FLD NOT = WSS-CT-I AND
              CGC-GLS-KEY8 IN PCR-FLD NOT = WSS-CT-C AND
              CGC-GLS-KEY8 IN PCR-FLD NOT = SPACES
                MOVE 'I.R. NO PERMITIDO'     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CGC-GLS-KEY8.
      *>>>> 
*% END
*% IF INI_PUT_CGC_PCR
      *<<<< INI_PUT_CGC_PCR
           IF PGM-STAT-CGC-NUL
               GO TO FIN-PUT-CGC-PCR.
           IF NOT PGM-STAT-CGC-OKS
               PERFORM CLR-CGC-PCR
               GO TO FIN-PUT-CGC-PCR.
           GO TO FIN-PUT-CGC-PCR.
      *>>>> INI_PUT_CGC_PCR
*% END
*% IF INI_PUT_DBC_PCR
      *<<<< INI_PUT_DBC_PCR
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-PCR.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-PCR
               GO TO FIN-PUT-DBC-PCR.
           GO TO FIN-PUT-DBC-PCR.
      *>>>> INI_PUT_DBC_PCR
*% END
*% IF FIN_KEY_CGC_PCR
      *<<<< FIN_KEY_CGC_PCR
           
           IF CGC-CIC-KEY1 IN PCR-FLD > SPACES AND
              CGC-GLS-CPTO IN PCR-FLD > SPACES AND
              FRM-NUM-KEY1 IN PCR-FLD > SPACES AND
              FRM-COD-AKEY IN PCR-FLD > SPACES
              MOVE SRC-WSS-GLS-IRCH TO CGC-GLS-KEY8 IN CGC.
           
           
           IF CGC-GLS-KEY8 IN PCR-FLD = WSS-CT-T
              MOVE SPACES TO CGC-GLS-KEY8 IN CGC.
           
           IF WSS-IND-RECHAZO > SPACES
              MOVE WSS-IND-RECHAZO TO CGC-GLS-KEY8 IN CGC.
      *>>>> FIN_KEY_CGC_PCR
*% END
*% IF FIN_CLR_KEY_PCR
      *<<<< FIN_CLR_KEY_PCR
           
      *>>>> FIN_CLR_KEY_PCR
*% END
*% IF FIN_VAL_CON_KEY_PCR
      *<<<< FIN_VAL_CON_KEY_PCR
           IF NOT (CGC-FEC-KEY4 IN PCR-FLD > SPACES AND
              CGC-FEC-KEY4 IN PCR-FLD NOT = ZEROES) AND
              NOT (DBC-NUM-ICLI IN PCR-FLD > SPACES AND
              DBC-NUM-ICLI IN PCR-FLD NOT = ZEROES) AND
              NOT (CGC-GLS-KEY3 IN PCR-FLD > SPACES) AND
              CGC-NUM-KEY1 IN PCR-FLD > ZEROES
                MOVE 'CMPONOVALBUS' TO MSG-COD-MENS
                MOVE 'COL' TO MSG-COD-SIST
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR.
                                
           MOVE CGC-FEC-KEY4 IN PCR-FLD  TO SRC-WSS-GLS-FCAR.
           MOVE DBC-NUM-ICLI IN PCR-FLD  TO SRC-WSS-GLS-RUT1.
           MOVE DBC-VRF-ICLI IN PCR-FLD  TO SRC-WSS-GLS-RUT2.
           MOVE CGC-GLS-KEY3 IN PCR-FLD  TO SRC-WSS-GLS-NOFI.
           MOVE CGC-NUM-KEY1 IN PCR-FLD  TO SRC-WSS-GLS-CORR.
           MOVE CGC-GLS-KEY6 IN PCR-FLD  TO SRC-WSS-GLS-IDIN.
           MOVE CGC-GLS-KEY8 IN PCR-FLD  TO SRC-WSS-GLS-IRCH.
           MOVE CGC-GLS-KEY5 IN PCR-FLD  TO SRC-WSS-GLS-NNOM.

      *>>>> FIN_VAL_CON_KEY_PCR
*% END
