*%! Codigo adicional para archivo BGLPQCFN
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% PGM_STAT_VEN = TRUE
*% IF SETTAG
*% FNCPQ = "PROYECTO "
*% VSNPQ = "06.08.25.1"
*% END
*% IF WSS
      *<<<< WSS
       COPY TABWGOCI.                                                   
       COPY TABBRCAM.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRCMT.                                                   
       COPY GNSBRRCE.                                                   
       COPY GNSWGCPT.  
       COPY GNSWGSTR.

       01  WSS-VARI.
           03  WSS-COD-CAUX.
               05  WSS-COD-TOOC               PIC X(03).
               05  WSS-COD-AOOC               PIC X(03).
      *PVG INI 17-JUL-2008                                              
           03  WSS-FEC-FINI.                                            
               05  WSS-NUM-SINI               PIC 9(02).                
               05  WSS-NUM-AINI               PIC 9(02).                
               05  WSS-NUM-MINI               PIC 9(02).                
               05  WSS-NUM-DINI               PIC 9(02).                
      *PVG FIN 17-JUL-2008                                              
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           PERFORM OBT-COD-MONEDA.
           IF OCI-COD-MENS > SPACES                                     
               GO TO ERR-FND-KEY.                                       
                                                                        
           MOVE FRM-NUM-DPRO IN CFN-FLD TO OCI-NUM-DPRO.                
           MOVE FRM-NUM-MPRO IN CFN-FLD TO OCI-NUM-MPRO.                
           MOVE FRM-NUM-SPRO IN CFN-FLD TO OCI-NUM-SPRO.                
           MOVE FRM-NUM-APRO IN CFN-FLD TO OCI-NUM-APRO.                
                                                                        
           IF FRM-COD-VCOC IN CFN-FLD = OCI-COD-UEFE
              IF OCI-NUM-PLZD > 360
                  PERFORM UF-MAYOR-ANO
              ELSE
                  PERFORM UF-MENOR-ANO
           ELSE
              IF FRM-COD-TOOC IN CFN-FLD = 'CON' OR 'PAP' OR 'PAF' OR
                                           'ALR'
                  PERFORM PRO-CONSUMO                                  
              ELSE                                                     
                  PERFORM PRO-NO-CONSUMO.                              
           GO TO CNT-FND-KEY.                                           
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CNT-FND-KEY.
           IF OCI-COD-MENS NOT > SPACES                                 
               GO TO FIN-FND-KEY.                                       
       ERR-FND-KEY.
           MOVE 'TAB' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE CAM-COD-CAMB IN CAM TO FRM-MEN2.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF EOF                                                        
      *<<<< EOF
       COPY TABBFCAM.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBBMSC.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBPFEC.
       COPY GNSBVIND.
      *>>>>
*%END
*% IF EOF_PQ
      *<<<< EOF_PQ

       OBT-COD-MONEDA SECTION.                                       
       INI-OBT-COD-MONEDA.                                           
           MOVE SPACES         TO OCI-COD-MENS.                         
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0999  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'CICPESONEX' TO OCI-COD-MENS                        
           ELSE                                                         
               MOVE TAB-COD-CTAB IN TAB TO OCI-COD-PESO IN OCI-VARI.    

           MOVE SPACES         TO OCI-COD-MENS.                         
           MOVE 'TAB'          TO FIO-SIST.                             
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.                  
           MOVE '0998  '       TO TAB-CIC-CTAB IN TAB.                  
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.                             
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'CICUF  NEX' TO OCI-COD-MENS                        
           ELSE                                                         
               MOVE TAB-COD-CTAB IN TAB TO OCI-COD-UEFE IN OCI-VARI.    
       FIN-OBT-COD-MONEDA.                                           
           EXIT.                                                        

       UF-MENOR-ANO SECTION.                                            
       INI-UF-MENOR-ANO.                                            
           MOVE OCI-NUM-PLZD    TO OCI-NUM-PZUD.                           
           MOVE 'TAB'           TO TAB-COD-SIST FIO-SIST.               
           MOVE 'SVC'           TO TAB-COD-TTAB IN TAB.                 
           MOVE OCI-COD-UF1A    TO TAB-COD-CTAB IN TAB.                 
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-COD-CTAB IN TAB TO OCI-COD-CTAB.                    
           IF NOT (FIO-STAT-OKS AND OCI-COD-CTA1 = OCI-GLS-FILU)        
               MOVE 'SVC    NEX' TO OCI-COD-MENS
               MOVE OCI-COD-UF1A TO OCI-COD-MEN2                        
               GO TO FIN-UF-MENOR-ANO.                                  
           PERFORM LEE-CAM-CSTFND.                                      
       FIN-UF-MENOR-ANO.
           EXIT.

       UF-MAYOR-ANO SECTION.                                            
       INI-UF-MAYOR-ANO.                                            
      *PVG INI 14-ABR-2015
           IF OCI-NUM-PLZD > OCI-NUM-PZTP
              MOVE OCI-GLS-CODF TO OCI-GLS-PZUA
              GO TO LUP-UF-MAYOR-ANO.

           DIVIDE OCI-NUM-PLZD BY 360 GIVING OCI-NUM-PZCF
                                   REMAINDER OCI-REST.
           IF OCI-REST = ZEROES
               SUBTRACT 1 FROM OCI-NUM-PZCF.

           IF OCI-NUM-PZCF = OCI-NUM-CD10
              MOVE OCI-GLS-CODA TO OCI-GLS-PZUA
           ELSE                                                         
           IF OCI-NUM-PZCF = OCI-NUM-CD11
              MOVE OCI-GLS-CODB TO OCI-GLS-PZUA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD12
              MOVE OCI-GLS-CODC TO OCI-GLS-PZUA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD13
              MOVE OCI-GLS-CODD TO OCI-GLS-PZUA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD14
              MOVE OCI-GLS-CODE TO OCI-GLS-PZUA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD15
              MOVE OCI-GLS-CODF TO OCI-GLS-PZUA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD16
              MOVE OCI-GLS-CODG TO OCI-GLS-PZUA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD17
              MOVE OCI-GLS-CODH TO OCI-GLS-PZUA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD18
              MOVE OCI-GLS-CODI TO OCI-GLS-PZUA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD19
              MOVE OCI-GLS-CODJ TO OCI-GLS-PZUA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD20
              MOVE OCI-GLS-CODK TO OCI-GLS-PZUA
           ELSE
              MOVE OCI-NUM-PZCF TO OCI-NUM-PZUA.
      *PVG FIN 14-ABR-2015
       LUP-UF-MAYOR-ANO.                                                
           IF FRM-NUM-VCOR IN CFN-FLD = 1                               
               MOVE '1' TO OCI-IND-CU1V                                 
           ELSE                                                         
               MOVE 'C' TO OCI-IND-CU1V.                                
           MOVE 'TAB'           TO TAB-COD-SIST FIO-SIST.               
           MOVE 'SVC'           TO TAB-COD-TTAB IN TAB.                 
           MOVE OCI-COD-UFAA    TO TAB-COD-CTAB IN TAB.                 
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-COD-CTAB IN TAB TO OCI-COD-CTAB.                    
           IF (FIO-STAT-OKS AND OCI-COD-CT12 = OCI-GLS-FIFU)            
                PERFORM LEE-CAM-CSTFND                                  
                GO TO FIN-UF-MAYOR-ANO.                                 
           IF OCI-NUM-PZUA NOT > 1                                      
                MOVE 'SVC    NEX' TO OCI-COD-MENS                       
                MOVE OCI-COD-UFAA TO OCI-COD-MEN2                       
                GO TO FIN-UF-MAYOR-ANO.
      *PVG INI 14-ABR-2015
           IF OCI-GLS-PZUA = OCI-GLS-CODK
              MOVE OCI-GLS-CODJ TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODJ
              MOVE OCI-GLS-CODI TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODI
              MOVE OCI-GLS-CODH TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODH
              MOVE OCI-GLS-CODG TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODG
              MOVE OCI-GLS-CODF TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODF
              MOVE OCI-GLS-CODE TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODE
              MOVE OCI-GLS-CODD TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODD
              MOVE OCI-GLS-CODC TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODC
              MOVE OCI-GLS-CODB TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODB
              MOVE OCI-GLS-CODA TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZUA = OCI-GLS-CODA
              MOVE OCI-GLS-COD9 TO OCI-GLS-PZUA
           ELSE                                                         
              SUBTRACT 1      FROM OCI-NUM-PZUA.
      *PVG FIN 14-ABR-2015
           GO TO LUP-UF-MAYOR-ANO.
       FIN-UF-MAYOR-ANO.                                                
           EXIT.                                                        

       PRO-CONSUMO SECTION.                                             
       INI-PRO-CONSUMO.                                             
           IF FRM-NUM-VCOR IN CFN-FLD = 1
               IF OCI-NUM-PLZD > 90                                     
                  MOVE 90 TO OCI-NUM-PZPD                               
               ELSE                                                     
                  MOVE OCI-NUM-PLZD TO OCI-NUM-PZPD                     
           ELSE                                                         
               IF OCI-NUM-PLZD > 30                                     
                  MOVE 30 TO OCI-NUM-PZPD                               
               ELSE                                                     
                  MOVE OCI-NUM-PLZD TO OCI-NUM-PZPD.                    
           MOVE 'TAB'           TO TAB-COD-SIST FIO-SIST.               
           MOVE 'SVC'           TO TAB-COD-TTAB IN TAB.                 
           MOVE OCI-COD-PCON    TO TAB-COD-CTAB IN TAB.                 
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-COD-CTAB IN TAB TO OCI-COD-CTAB.                    
           IF NOT (FIO-STAT-OKS AND OCI-COD-CTA1 = OCI-GLS-FILP)        
                MOVE 'SVC    NEX' TO OCI-COD-MENS                        
                MOVE OCI-COD-PCON TO OCI-COD-MEN2                        
                GO TO FIN-PRO-CONSUMO.                                  
           PERFORM LEE-CAM-CSTFND.                                      
       FIN-PRO-CONSUMO.
           EXIT.

       PRO-NO-CONSUMO SECTION.                                          
       INI-PRO-NO-CONSUMO.                                          
           IF OCI-NUM-PLZD > 360                                        
               PERFORM PESO-MAYOR-ANO                                   
           ELSE                                                         
               PERFORM PESO-MENOR-ANO.                                  
       FIN-PRO-NO-CONSUMO.
           EXIT.

       PESO-MENOR-ANO SECTION.                                          
       INI-PESO-MENOR-ANO.                                          
           MOVE OCI-NUM-PLZD TO OCI-NUM-PZPD.                           
           MOVE 'TAB'           TO TAB-COD-SIST FIO-SIST.               
           MOVE 'SVC'           TO TAB-COD-TTAB IN TAB.                 
           MOVE OCI-COD-PCON    TO TAB-COD-CTAB IN TAB.                 
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-COD-CTAB IN TAB TO OCI-COD-CTAB.                    
           IF NOT (FIO-STAT-OKS AND OCI-COD-CTA1 = OCI-GLS-FILP)        
                MOVE 'SVC    NEX' TO OCI-COD-MENS                        
                MOVE OCI-COD-PCON TO OCI-COD-MEN2                        
                GO TO PESO-MENOR-ANO.                                   
           PERFORM LEE-CAM-CSTFND.                                      
       FIN-PESO-MENOR-ANO.
           EXIT.

       PESO-MAYOR-ANO SECTION.                                          
       INI-PESO-MAYOR-ANO.                                              
      *PVG INI 14-ABR-2015
           IF OCI-NUM-PLZD > OCI-NUM-PZTP
              MOVE OCI-GLS-CODF TO OCI-GLS-PZPA
              GO TO LUP-PESO-MAYOR-ANO.

           DIVIDE OCI-NUM-PLZD BY 360 GIVING OCI-NUM-PZCF
                                   REMAINDER OCI-REST.
           IF OCI-REST = ZEROES
               SUBTRACT 1 FROM OCI-NUM-PZCF.

           IF OCI-NUM-PZCF = OCI-NUM-CD10
              MOVE OCI-GLS-CODA TO OCI-GLS-PZPA
           ELSE                                                         
           IF OCI-NUM-PZCF = OCI-NUM-CD11
              MOVE OCI-GLS-CODB TO OCI-GLS-PZPA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD12
              MOVE OCI-GLS-CODC TO OCI-GLS-PZPA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD13
              MOVE OCI-GLS-CODD TO OCI-GLS-PZPA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD14
              MOVE OCI-GLS-CODE TO OCI-GLS-PZPA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD15
              MOVE OCI-GLS-CODF TO OCI-GLS-PZPA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD16
              MOVE OCI-GLS-CODG TO OCI-GLS-PZPA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD17
              MOVE OCI-GLS-CODH TO OCI-GLS-PZPA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD18
              MOVE OCI-GLS-CODI TO OCI-GLS-PZPA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD19
              MOVE OCI-GLS-CODJ TO OCI-GLS-PZPA
           ELSE
           IF OCI-NUM-PZCF = OCI-NUM-CD20
              MOVE OCI-GLS-CODK TO OCI-GLS-PZPA
           ELSE
              MOVE OCI-NUM-PZCF TO OCI-NUM-PZPA.
      *PVG FIN 14-ABR-2015
       LUP-PESO-MAYOR-ANO.                                              
           IF FRM-NUM-VCOR IN CFN-FLD = 1                               
               MOVE '1' TO OCI-IND-CP1V                                 
           ELSE                                                         
               MOVE 'C' TO OCI-IND-CP1V.                                
           MOVE 'TAB'           TO TAB-COD-SIST FIO-SIST.               
           MOVE 'SVC'           TO TAB-COD-TTAB IN TAB.                 
           MOVE OCI-COD-PEAA    TO TAB-COD-CTAB IN TAB.                 
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM GNS-FIO-TAB.                                         
           MOVE TAB-COD-CTAB IN TAB TO OCI-COD-CTAB.                    
           IF (FIO-STAT-OKS AND OCI-COD-CT12 = OCI-GLS-FIFP)            
               PERFORM LEE-CAM-CSTFND                                   
                GO TO FIN-PESO-MAYOR-ANO.                                
           IF OCI-NUM-PZPA NOT > 1                                      
               MOVE 'SVC    NEX' TO OCI-COD-MENS                        
               MOVE OCI-COD-PEAA TO OCI-COD-MEN2                        
      *PVG INI 14-ABR-2015
               GO TO FIN-PESO-MAYOR-ANO.
           IF OCI-GLS-PZPA = OCI-GLS-CODK
              MOVE OCI-GLS-CODJ TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODJ
              MOVE OCI-GLS-CODI TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODI
              MOVE OCI-GLS-CODH TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODH
              MOVE OCI-GLS-CODG TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODG
              MOVE OCI-GLS-CODF TO OCI-GLS-PZUA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODF
              MOVE OCI-GLS-CODE TO OCI-GLS-PZPA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODE
              MOVE OCI-GLS-CODD TO OCI-GLS-PZPA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODD
              MOVE OCI-GLS-CODC TO OCI-GLS-PZPA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODC
              MOVE OCI-GLS-CODB TO OCI-GLS-PZPA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODB
              MOVE OCI-GLS-CODA TO OCI-GLS-PZPA
           ELSE
           IF OCI-GLS-PZPA = OCI-GLS-CODA
              MOVE OCI-GLS-COD9 TO OCI-GLS-PZPA
           ELSE                                                         
              SUBTRACT 1 FROM OCI-NUM-PZPA.
      *PVG FIN 14-ABR-2015
           GO TO LUP-PESO-MAYOR-ANO.
       FIN-PESO-MAYOR-ANO.                                              
           EXIT.                                                        

       LEE-CAM-CSTFND SECTION.
       INI-LEE-CAM-CSTFND.
           MOVE TAB-CIC-CTAB IN TAB      TO OCI-CIC-CTAB.               
           MOVE OCI-CIC-CTA1 IN OCI-VARI TO OCI-COD-VCA1 IN OCI-VARI.   
           MOVE OCI-CIC-CTA2 IN OCI-VARI TO OCI-COD-VCA2 IN OCI-VARI.   
           PERFORM OBT-VCAM-CSTF.                                       
           IF OCI-COD-MENS NOT > SPACES
               MOVE OCI-SGV-VCAM-FHOY TO FRM-SGV-CSTF IN CFN-FLD
               PERFORM BUSCA-GLOSA
           ELSE                                                         
               MOVE 'CSTFND NEX' TO OCI-COD-MENS.
       FIN-LEE-CAM-CSTFND.
           EXIT.

       OBT-VCAM-CSTF SECTION.                                           
       INI-OBT-VCAM-CSTF.                                           
           MOVE OCI-COD-VCA1 IN OCI-VARI TO OCI-CIC-CTA3 IN OCI-VARI.   
           MOVE OCI-COD-VCA1 IN OCI-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE OCI-COD-VCA2 IN OCI-VARI TO CAM-COD-VCAM IN CAM(2).     
      *PVG INI 17-JUL-2008                                              
           MOVE FRM-NUM-SPRO IN CFN-FLD TO WSS-NUM-SINI IN WSS-VARI.    
           MOVE FRM-NUM-APRO IN CFN-FLD TO WSS-NUM-AINI IN WSS-VARI.    
           MOVE FRM-NUM-MPRO IN CFN-FLD TO WSS-NUM-MINI IN WSS-VARI.    
           MOVE FRM-NUM-DPRO IN CFN-FLD TO WSS-NUM-DINI IN WSS-VARI.    
      *PVG FIN 17-JUL-2008                                              
      *    MOVE FRM-FEC-FPRO IN CFN-FLD  TO CAM-FEC-FCAM IN CAM(1)      
           MOVE WSS-FEC-FINI IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1)      
      *PVG FIN 17-JUL-2008                                              
                                            CAM-FEC-FCAM IN CAM(2).     
           IF OCI-COD-TOOC IN OCI-VARI = 'TDC' AND                      
              FRM-FEC-FPRO IN CFN-FLD > HOY-FHOY                       
              MOVE HOY-FHOY              TO CAM-FEC-FCAM IN CAM(1)      
              MOVE HOY-FHOY              TO CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-NLS    TO FIO-CMND.                             
           PERFORM TAB-FIO-CAM.                                         
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND      
      *PVG INI 17-JUL-2008                                              
      *       FRM-FEC-FPRO IN CFN-FLD = CAM-FEC-FCAM IN CAM(1) AND      
      *       FRM-FEC-FPRO IN CFN-FLD = CAM-FEC-FCAM IN CAM(2) )        
              WSS-FEC-FINI IN WSS-VARI = CAM-FEC-FCAM IN CAM(1) AND     
              WSS-FEC-FINI IN WSS-VARI = CAM-FEC-FCAM IN CAM(2) )       
      *PVG FIN 17-JUL-2008                                              
              GO TO OBT-VCAM-CSTF-2.                                    
           IF OCI-MSC-TVAL = 'P' AND CAM-MSC-TVAL IN CAM(1) = 'P'       
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           IF OCI-MSC-TVAL = 'U' AND CAM-MSC-TVAL IN CAM(1) = 'U'       
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           MOVE CAM-COD-VCAM IN CAM(1) TO OCI-CIC-CTA4 IN OCI-VARI.     
           IF OCI-MSC-CTA3 = 'F$' AND OCI-MSC-CTA4 = 'F$'               
      *MHM-INI 29-OCT-2008                                              
              AND OCI-IND-CP1V = OCI-COD-CT44                           
      *MHM-FIN 29-OCT-2008                                              
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           IF OCI-MSC-CTA3 = 'FU' AND OCI-MSC-CTA4 = 'FU'               
      *MHM-INI 29-OCT-2008                                              
              AND OCI-IND-CU1V = OCI-COD-CT44                           
      *MHM-FIN 29-OCT-2008                                              
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
                                                                        
       OBT-VCAM-CSTF-2.                                                 
           MOVE FRM-NUM-DPRO TO FEC-ITM1.                               
           MOVE FRM-NUM-MPRO TO FEC-ITM2.                               
           MOVE FRM-NUM-SPRO TO FEC-ITM3.                               
           MOVE FRM-NUM-APRO TO FEC-ITM4.                               
           IF OCI-COD-TOOC IN OCI-VARI = 'TDC' AND                      
              FRM-FEC-FPRO IN CFN-FLD > HOY-FHOY                       
              MOVE HOY-DHOY TO FEC-ITM1                                 
              MOVE HOY-MHOY TO FEC-ITM2                                 
              MOVE HOY-SHOY TO FEC-ITM3                                 
              MOVE HOY-AHOY TO FEC-ITM4.                                
       LUP-VCAM-CSTF-2.                                                 
           MOVE 1            TO FEC-NDIA.                               
           MOVE FEC-RST-DIA  TO FEC-CMND.                               
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           PERFORM CAL-FEC.                                             
           MOVE FEC-ITM1     TO OCI-NUM-DCAM.                           
           MOVE FEC-ITM2     TO OCI-NUM-MCAM.                           
           MOVE FEC-ITM3     TO OCI-NUM-SCAM.                           
           MOVE FEC-ITM4     TO OCI-NUM-ACAM.                           
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-S   TO FEC-FBLK.                               
           MOVE FEC-CHOY-N   TO FEC-CHOY.                               
           MOVE FEC-VHBL-S   TO FEC-VHBL.                               
           MOVE FEC-VAL-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF FEC-STAT-FER                                              
              MOVE OCI-NUM-DCAM TO FEC-ITM1                             
              MOVE OCI-NUM-MCAM TO FEC-ITM2                             
              MOVE OCI-NUM-SCAM TO FEC-ITM3                             
              MOVE OCI-NUM-ACAM TO FEC-ITM4                             
              GO TO LUP-VCAM-CSTF-2.                                    
           MOVE OCI-COD-VCA1 IN OCI-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE OCI-COD-VCA2 IN OCI-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE OCI-FEC-FCAM             TO CAM-FEC-FCAM IN CAM(1)      
                                            CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-NLS    TO FIO-CMND.                             
           PERFORM TAB-FIO-CAM.                                         
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND      
              OCI-FEC-FCAM = CAM-FEC-FCAM IN CAM(1) AND           
              OCI-FEC-FCAM = CAM-FEC-FCAM IN CAM(2) )             
              GO TO OBT-VCAM-CSTF-3.                                    
           IF OCI-MSC-TVAL = 'P' AND CAM-MSC-TVAL IN CAM(1) = 'P'       
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           IF OCI-MSC-TVAL = 'U' AND CAM-MSC-TVAL IN CAM(1) = 'U'       
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           MOVE CAM-COD-VCAM IN CAM(1) TO OCI-CIC-CTA4 IN OCI-VARI.     
           IF OCI-MSC-CTA3 = 'F$' AND OCI-MSC-CTA4 = 'F$'               
      *MHM-INI 29-OCT-2008                                              
              AND OCI-IND-CP1V = OCI-COD-CT44                           
      *MHM-FIN 29-OCT-2008                                              
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           IF OCI-MSC-CTA3 = 'FU' AND OCI-MSC-CTA4 = 'FU'               
      *MHM-INI 29-OCT-2008                                              
              AND OCI-IND-CU1V = OCI-COD-CT44                           
      *MHM-FIN 29-OCT-2008                                              
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
                                                                        
       OBT-VCAM-CSTF-3.                                                 
           MOVE OCI-NUM-DCAM TO FEC-ITM1.                               
           MOVE OCI-NUM-MCAM TO FEC-ITM2.                               
           MOVE OCI-NUM-SCAM TO FEC-ITM3.                               
           MOVE OCI-NUM-ACAM TO FEC-ITM4.                               
       LUP-VCAM-CSTF-3.                                                 
           MOVE 1            TO FEC-NDIA.                               
           MOVE FEC-RST-DIA  TO FEC-CMND.                               
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           PERFORM CAL-FEC.                                             
           MOVE FEC-ITM1     TO OCI-NUM-DCAM.                           
           MOVE FEC-ITM2     TO OCI-NUM-MCAM.                           
           MOVE FEC-ITM3     TO OCI-NUM-SCAM.                           
           MOVE FEC-ITM4     TO OCI-NUM-ACAM.                           
           MOVE FEC-FORM-FEC TO FEC-FORM.                               
           MOVE FEC-FBLK-S   TO FEC-FBLK.                               
           MOVE FEC-CHOY-N   TO FEC-CHOY.                               
           MOVE FEC-VHBL-S   TO FEC-VHBL.                               
           MOVE FEC-VAL-FEC  TO FEC-CMND.                               
           PERFORM PRO-FEC.                                             
           IF FEC-STAT-FER                                              
              MOVE OCI-NUM-DCAM TO FEC-ITM1                             
              MOVE OCI-NUM-MCAM TO FEC-ITM2                             
              MOVE OCI-NUM-SCAM TO FEC-ITM3                             
              MOVE OCI-NUM-ACAM TO FEC-ITM4                             
              GO TO LUP-VCAM-CSTF-3.                                    
           MOVE OCI-COD-VCA1 IN OCI-VARI TO CAM-COD-VCAM IN CAM(1).     
           MOVE OCI-COD-VCA2 IN OCI-VARI TO CAM-COD-VCAM IN CAM(2).     
           MOVE OCI-FEC-FCAM             TO CAM-FEC-FCAM IN CAM(1)      
                                            CAM-FEC-FCAM IN CAM(2).     
           MOVE FIO-GET-NLS    TO FIO-CMND.                             
           PERFORM TAB-FIO-CAM.                                         
           IF NOT ( FIO-STAT-OKS AND CAM-MSC-STAT IN CAM = 'S' AND      
                    OCI-FEC-FCAM = CAM-FEC-FCAM IN CAM(1) AND           
                    OCI-FEC-FCAM = CAM-FEC-FCAM IN CAM(2) )             
               MOVE 'CAM    NEX'             TO OCI-COD-MENS            
               MOVE OCI-COD-VCA1 IN OCI-VARI TO CAM-COD-VCAM IN CAM(1)  
               MOVE OCI-COD-VCA2 IN OCI-VARI TO CAM-COD-VCAM IN CAM(2)  
               MOVE FRM-FEC-FPRO IN CFN-FLD  TO CAM-FEC-FCAM IN CAM(1)  
                                                CAM-FEC-FCAM IN CAM(2)  
               MOVE CAM-KEY-CAMB IN CAM      TO OCI-COD-MEN2            
               GO TO FIN-OBT-VCAM-CSTF.                                 
           IF OCI-MSC-TVAL = 'P' AND CAM-MSC-TVAL IN CAM(1) = 'P'       
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           IF OCI-MSC-TVAL = 'U' AND CAM-MSC-TVAL IN CAM(1) = 'U'       
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           MOVE CAM-COD-VCAM IN CAM(1) TO OCI-CIC-CTA4 IN OCI-VARI.     
           IF OCI-MSC-CTA3 = 'F$' AND OCI-MSC-CTA4 = 'F$'               
      *MHM-INI 29-OCT-2008                                              
              AND OCI-IND-CP1V = OCI-COD-CT44                           
      *MHM-FIN 29-OCT-2008                                              
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           IF OCI-MSC-CTA3 = 'FU' AND OCI-MSC-CTA4 = 'FU'               
      *MHM-INI 29-OCT-2008                                              
              AND OCI-IND-CU1V = OCI-COD-CT44                           
      *MHM-FIN 29-OCT-2008                                              
              MOVE CAM-SGV-VCAM IN CAM      TO OCI-SGV-VCAM-FHOY        
              GO TO FIN-OBT-VCAM-CSTF.                                  
           MOVE 'CAM    NEX'             TO OCI-COD-MENS.               
           MOVE OCI-COD-VCA1 IN OCI-VARI TO CAM-COD-VCAM IN CAM(1)      
           MOVE OCI-COD-VCA2 IN OCI-VARI TO CAM-COD-VCAM IN CAM(2)      
           MOVE FRM-FEC-FPRO IN CFN-FLD  TO CAM-FEC-FCAM IN CAM(1)      
                                            CAM-FEC-FCAM IN CAM(2).  
           MOVE CAM-KEY-CAMB IN CAM      TO OCI-COD-MEN2.               
       FIN-OBT-VCAM-CSTF.                                               
PVG        MOVE CAM-KEY-CAMB IN CAM TO FRM-MENS.                        
           IF FIO-STAT-OKS                                              
              MOVE FIO-END-BRW TO FIO-CMND                              
              PERFORM TAB-FIO-CAM.                                      
       EXT-OBT-VCAM-CSTF.                                           
           EXIT.                                                        

       BUSCA-GLOSA SECTION.
       INI-BUSCA-GLOSA.
           IF FRM-COD-VCOC IN CFN-FLD = OCI-COD-PESO IN OCI-VARI            
               MOVE 'MENSUAL' TO FRM-GLS-MONE IN CFN-FLD
           ELSE                                                         
           IF FRM-COD-VCOC IN CFN-FLD = OCI-COD-UEFE IN OCI-VARI            
               MOVE 'ANUAL'   TO FRM-GLS-MONE IN CFN-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-MONE IN CFN-FLD.             
       FIN-BUSCA-GLOSA.
           EXIT.
                                                         
       COPY GNSBGCPT.
       COPY GNSBGSTR.
      *>>>>  
*% END
