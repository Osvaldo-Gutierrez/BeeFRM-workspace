       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. COLPOA03.
       AUTHOR. BEETEAM.
       DATE-WRITTEN. 14-01-2019 11:05:08.
      * PROGRAMA TRADUCTOR
      *
      *
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.

       WORKING-STORAGE SECTION.
      *------------------------
       77 WSS-TAG-COLPOA03           PIC X(0125) VALUE
           '<IDNPGM NOM=$COLPOA03$ VSN=$01-00$ GEN=$03-06-2019$
      -    'TMS=$E07$ FNC=$1901_03$/>'.
      *
       COPY GNSWGMCS.

       77  WSS-CTE-CMA-TPG     VALUE +6   COMP           PIC S9(4).
      * Largo Entidad TR
       77  WSS-CTE-LENTR-1025  COMP   VALUE +1025        PIC S9(04).
       77  WSS-CTE-LENTR-20    COMP   VALUE +20          PIC S9(04).

       01  TS-TPAG.
           03 TS-TPAG-TYPE            VALUE 'TPAG'       PIC X(04).
           03 TS-TPAG-TERM            VALUE SPACES       PIC X(04).

       01 WSS-OPC-LIQ.
          03 WSS-032-STAT                             PIC X(00001).
          03 WSS-032-MENS                             PIC X(00079).
          03 WSS-032-DMSG.
             05 WSS-032-OPC-LIQ-GKY                   PIC X(00014).
             05 WSS-032-PLC-LIQ-GCS.
                07 WSS-032-02-HDR                     PIC X(00254).
                07 WSS-032-PLC-CON-GKY.
                   09 WSS-032-DMSG-IDX-1-03 OCCURS 16 TIMES.
                      11 WSS-032-FLD-HST OCCURS 9 TIMES.
                         15 WSS-032-03-OCCU           PIC X(00062).
          03 WSS-032-FRM-GLS-DISP                     PIC X(10724).

       01  TP-032-SI-TPAG VALUE SPACES.
           03  TP-032-SI-TPAG-STAT                    PIC X(00001).
           03  TP-032-SI-TPAG-MENS                    PIC X(00079).
           03  TP-032-01-CAN-SGV-TPAG-ATR             PIC X(00001).
           03  TP-032-01-CAN-SGV-TPAG                 PIC X(00019).
           03  TP-032-01-CAN-SGV-TPAG-R REDEFINES
               TP-032-01-CAN-SGV-TPAG.
               05  TP-032-01-CAN-SGV-TPAG-CPL   PIC X(00004).
               05  TP-032-01-CAN-SGV-TPAG-NUM
                                  PIC S9(11)V9(04).

           03  TP-032-SI-TPAG-DMSG                    PIC X(19900).

       01  WSS-HDR-100.
           03 WSS-HDR-100-001-092                        PIC X(92).
           03 WSS-HDR-100-093-093                        PIC X(01).
           03 WSS-HDR-100-094-100                        PIC X(07).

       01  WSS-HDR-033.
           03  WSS-HDR-033-001-090                       PIC X(90).
           03  WSS-HDR-033-091-093                       PIC X(03).
           03  WSS-HDR-033-094-100                       PIC X(07).


       01  WSS-HDR-038.
           03  WSS-HDR-038-001-094                       PIC X(94).
           03  WSS-HDR-038-095-095                       PIC X(01).
           03  WSS-HDR-038-096-100                       PIC X(05).

       01  WSS-HDR-TIPC.
           03 WSS-HDR-TIPC-01                            PIC X(02).
           03 WSS-HDR-TIPC-02                            PIC X(03).

       77  USP-OPID-USU   VALUE SPACES                   PIC X(03).

      *77  WSS-SGN-1404                      PIC 99999999999999,9999.
       77  WSS-SGN-1404                      PIC --------------,9999.

       77  WSS-EDT-1204                      PIC 999999999999,9999.
       77  WSS-EDT-0904                      PIC    999999999,9999.
       77  WSS-EDT-0304                      PIC         ----,9999.
       77  WSS-EDT-0902                      PIC    999999999,99.
       77  WSS-EDT-0702                      PIC      9999999,99.
       77  WSS-EDT-0704                      PIC      -------,9999.
       77  WSS-EDT-0602                      PIC       999999,99.

       01  WSS-AUXI  VALUE SPACES PIC X(50).
       77  WSS-IND-OCC-111     VALUE SPACES               PIC X(03).
       77  WSS-CTE-FIN         VALUE  'FIN'               PIC X(03).

       77  WSS-IDX-111-I       VALUE  ZEROES              PIC 9(05).
       77  WSS-IDX-111-J       VALUE  ZEROES              PIC 9(05).

       77  WSS-IDX-032-I       VALUE  1                   PIC 9(05).
       77  WSS-IDX-032-J       VALUE  ZEROES              PIC 9(05).

       77  WSS-CTE-SIMU-S      VALUE 'S'                 PIC X(01).
       77  WSS-CTE-SIMU-A      VALUE 'A'                 PIC X(01).

       77  WSS-CTE-01-ALF      VALUE '1'                 PIC X(01).
       77  WSS-SGV-TPAG        VALUE ZEROES        PIC 9(11)V9(04).
       77  WSS-IND-GOCON       VALUE 'S'                 PIC X(01).
       77  WSS-CTE-PTT              VALUE 'PTT'          PIC X(03).
       77  WSS-CTE-CIE              VALUE 'CIE'          PIC X(03).
       77  WSS-CTE-P                VALUE 'P'            PIC X(01).
       77  WSS-CTE-PORC             VALUE '%'            PIC X(01).
       01  WSS-ROC-BKP              VALUE SPACES         PIC X(1030).
       01  WSS-12-04-08 VALUE SPACES.
           03 WSS-12-04-08-04                            PIC X(04).
           03 WSS-12-04-08-08                            PIC X(08).
       77  WSS-CTE-110     VALUE '110'                   PIC X(03).
       77  WSS-CTE-010     VALUE '010'                   PIC X(03).

       77  WSS-CTE-AUT     VALUE 'AUT'                   PIC X(03).
       77  WSS-CTE-S       VALUE 'S'                     PIC X(01).
       77  WSS-CTE-N       VALUE 'N'                     PIC X(01).

       77  WSS-LOGPMA03        VALUE 'N'                 PIC X(01).
       77  WSS-BCKPMA03NO      VALUE 'N'                 PIC X(01).
       77  WSS-NUM-TOT-PER     VALUE ZEROS               PIC 9(05).
       77  WSS-TOT-DIA         VALUE ZEROS               PIC 9(05).

       77  WSS-NUM-RAUX VALUE ZEROES                     PIC 9(08).

       01  WSS-GLS-DATA-RAUX.
           03 WSS-GLS-DATA-RAUX-NUM                      PIC 9(08).
           03 WSS-GLS-DATA-RAUX-ALF                      PIC X(52).

       77  WSS-IDX-TR   VALUE  ZEROES                    PIC 9(03).
       77  TPG-M        VALUE  ZEROES                    PIC 9(03).
       77  TPG-L        VALUE  ZEROES                    PIC 9(03).

       01  WSS-SGS-INP-TBL.
           03 WSS-SGS-INP-OCC       OCCURS 30 TIMES.
              05 WSS-SGS-INP-ELM                         PIC X(03).

       77  WSS-SGS-INP-ENC    VALUE 'N'                  PIC X(01).


       77  WSS-COD-TCYA-CTBL  VALUE 'CTBL '              PIC X(05).
       77  WSS-COD-TCYA-CCMA  VALUE 'CCMA '              PIC X(05).
       77  WSS-COD-TCYA-CAJA  VALUE 'CAJA '              PIC X(05).

       01  WSS-COD-PROD VALUE SPACES.
           03  WSS-COD-PROD-VCOC                         PIC X(06).
           03  WSS-COD-PROD-TOOC                         PIC X(03).
           03  WSS-COD-PROD-AOOC                         PIC X(03).

       77  WSS-CTE-VCAM-0999        VALUE '0999  '       PIC X(06).
       77  WSS-CTE-VCAM-0999-01     VALUE '01'           PIC X(02).
       77  WSS-CTE-VCAM-0998        VALUE '0998  '       PIC X(06).
       77  WSS-CTE-VCAM-0998-02     VALUE '02'           PIC X(02).

       77  WSS-CTE-COLPPTPG   VALUE 'COLPPTPG'           PIC X(08).
       77  WSS-CTE-HORA-2000  VALUE 'A03HORA2000 '       PIC X(12).
       77  WSS-CTE-HORA-0800  VALUE 'A03HORA0800 '       PIC X(12).
       77  WSS-NUM-HORA-2000  VALUE ZEROES               PIC 9(12).
       77  WSS-NUM-HORA-0800  VALUE ZEROES               PIC 9(12).

      * Atributos y valores default de producto para microservicio
      * PPM = "P"aramretros default de "P"roducto "M"icroservicio
       01  WSS-GLS-PPM.
           03  WSS-IND-SEGD       VALUE 'PRECIO'         PIC X(06).
           03  WSS-IND-CVTA       VALUE SPACES           PIC X(01).
           03  WSS-IND-GARA       VALUE SPACES           PIC X(03).
           03  WSS-IND-CDOC       VALUE SPACES           PIC X(03).

       01  WSS-CTE-PPM            VALUE 'PPM'            PIC X(03).

       77  WSS-CTE-IMCS-A03       VALUE 'A03'            PIC X(03).
      * Parametros de default
       77  WSS-CTE-PPM-1          VALUE '1'              PIC X(01).
      * Vigencia del producto para el microservicio
       77  WSS-CTE-PPM-2          VALUE '2'              PIC X(01).
      * Dias de vigencia
       77  WSS-CTE-PPM-3          VALUE '3'              PIC X(01).


       01  WSS-COD-CTAB-PPM.
           03 WSS-COD-CTAB-PPM-0103-MCS                  PIC X(03).
           03 WSS-COD-CTAB-PPM-0405-MON                  PIC X(02).
           03 WSS-COD-CTAB-PPM-0608-TIO                  PIC X(03).
           03 WSS-COD-CTAB-PPM-0911-AUX                  PIC X(03).
           03 WSS-COD-CTAB-PPM-1212-COR                  PIC X(01).




       77  WSS-CTE-TCVE-FO    VALUE 'FO'                 PIC X(02).
       77  WSS-CTE-TCVE-CO    VALUE 'CO'                 PIC X(02).
       77  WSS-CTE-TCVE-FO-O-CO VALUE 'FO'               PIC X(02).

       77  WSS-CTE-001        VALUE 1                    PIC 9(05).

      * Seguros heredados de OPC
       77  WSS-IND-SGRS-H     VALUE 'H'                  PIC X(01).

      * Tasa Informada
       77  WSS-FRM-IND-TINT-I VALUE 'I'                  PIC X(01).
      * Tasa propuesta por ROC(RCC)
       77  WSS-FRM-IND-TINT-P VALUE 'P'                  PIC X(01).
      * Tasa heredada
       77  WSS-FRM-IND-TINT-H VALUE 'H'                  PIC X(01).


      * Oblig(Informada INP /Asignada 1RA OPE )
       77  WSS-IND-TCYA-OBLI VALUE 'O'                   PIC X(01).
      * Contable[Simulacion]
       77  WSS-IND-TCYA-CTBL VALUE 'C'                   PIC X(01).


       77  WSS-SGS-INP-TOT    VALUE ZEROES               PIC 9(03).
       77  WSS-SGS-INP-IDX-01 VALUE ZEROES               PIC 9(03).
       77  WSS-SGS-INP-IDX-02 VALUE ZEROES               PIC 9(03).

       77 WSS-SGS-PPT-ARG     VALUE SPACES               PIC X(03).

       01  WSS-SGS-PPT-TBL.
           03 WSS-SGS-PPT-OCC       OCCURS 30 TIMES.
              05 WSS-SGS-PPT-ELM                         PIC X(03).

       77  WSS-SGS-PPT-ENC    VALUE 'N'                  PIC X(01).

       77  WSS-IDX-SGS-PPT    VALUE ZEROES               PIC 9(03).


       77  WSS-IDX-SGS        VALUE ZEROES               PIC 9(03).

       77  WSS-TOT-SGS-PPT    VALUE ZEROES               PIC 9(03).


       01  WSS-ERR-SEND.
           03  WSS-ERR-SEND-PEND  VALUE '1'              PIC X(00001).
           03  WSS-ERR-SEND-STAT  VALUE '1'              PIC X(00001).
           03  WSS-ERR-SEND-MENS  VALUE SPACES           PIC X(01023).



       01  WSS-ERR-IND-TCYA.
           03  WSS-ERR-IND-TCYA-00
               VALUE 'CNCNA03COL000000000001'                PIC X(22).
           03  WSS-ERR-IND-TCYA-01                           PIC X(05).
           03  WSS-ERR-IND-TCYA-02                           PIC X(52)
               VALUE ' : Error en indicador de abono'.

       77  WSS-CTE-CTS            VALUE 'CTS'                PIC X(03).
       77  WSS-NUM-VIGU-ADIC      VALUE ZEROES               PIC 9(03).

       01  WSS-ERR-PRO-GNOP.
           03  WSS-ERR-PRO-GNOP-00
               VALUE 'CNCNA03COL000000000002'                PIC X(22).
           03  WSS-ERR-PRO-GNOP-01 VALUE ' : Error GNP : '   PIC X(15).
           03  WSS-ERR-PRO-GNOP-02                           PIC X(12).
           03  WSS-ERR-PRO-GNOP-03                           PIC X(30).



       01  WSS-ERR-PRO-SEGU.
           03  WSS-ERR-PRO-SEGU-00
               VALUE 'CNCNA03COL000000000003'                PIC X(22).
           03  WSS-ERR-PRO-SEGU-01 VALUE 'Seguro Inp : '     PIC X(13).
           03  WSS-ERR-PRO-SEGU-02 VALUE SPACES              PIC X(03).
           03  WSS-ERR-PRO-SEGU-03 VALUE ' No Propuesto'     PIC X(41).





       01  WSS-ERR-IND-TASA.
           03  WSS-ERR-IND-TASA-00
               VALUE 'CNCNA03COL000000000004'                PIC X(22).
           03  WSS-ERR-IND-TASA-01 VALUE 'Ind Tasa(I/P) '    PIC X(14).
           03  WSS-ERR-IND-TASA-02 VALUE SPACES              PIC X(01).
           03  WSS-ERR-IND-TASA-03 VALUE ' Erroneo'          PIC X(33).





       01      WSS-ERR-VAL-CRED.
           03  WSS-ERR-VAL-CRED-00
               VALUE 'CNCNA03COL000000000005'                PIC X(22).
           03  WSS-ERR-VAL-CRED-01 VALUE 'Monto Cred: '      PIC X(12).
           03  WSS-ERR-VAL-CRED-02                           PIC X(45).





       01      WSS-ERR-SGV-TINT.
           03  WSS-ERR-SGV-TINT-00
               VALUE 'CNCNA03COL000000000006'                PIC X(22).
           03  WSS-ERR-SGV-TINT-01 VALUE 'Tasa Inter : '     PIC X(13).
           03  WSS-ERR-SGV-TINT-02                           PIC X(44).



       01      WSS-ERR-NUM-VIGU.
           03  WSS-ERR-NUM-VIGU-00
               VALUE 'CNCNA03COL000000000007'                PIC X(22).
           03  WSS-ERR-NUM-VIGU-01 VALUE 'Tot Ven Vig : '    PIC X(14).
           03  WSS-ERR-NUM-VIGU-02                           PIC X(43).




       01      WSS-ERR-NUM-SPVE.
           03  WSS-ERR-NUM-SPVE-00
               VALUE 'CNCNA03COL000000000008'                PIC X(22).
           03  WSS-ERR-NUM-SPVE-01 VALUE 'Per 1er Ven : '    PIC X(16).
           03  WSS-ERR-NUM-SPVE-02                           PIC X(41).



       01      WSS-ERR-NUM-SEVE.
           03  WSS-ERR-NUM-SEVE-00
               VALUE 'CNCNA03COL000000000009'                PIC X(22).
           03  WSS-ERR-NUM-SEVE-01 VALUE 'Sep ent Ven : '    PIC X(14).
           03  WSS-ERR-NUM-SEVE-02                           PIC X(43).





       01      WSS-ERR-NUM-PLZT.
           03  WSS-ERR-NUM-PLZT-00
               VALUE 'CNCNA03COL000000000010'                PIC X(22).
           03  WSS-ERR-NUM-PLZT-01 VALUE 'Pzo Tot Ven : '    PIC X(14).
           03  WSS-ERR-NUM-PLZT-02                           PIC X(43).





       01  WSS-ERR-NUM-CMAX.
           03  WSS-ERR-NUM-CMAX-00
               VALUE 'CNCNA03COL000000000011'                PIC X(22).
           03  WSS-ERR-NUM-CMAX-01 VALUE 'M Curse : '        PIC X(10).
           03  WSS-ERR-NUM-CMAX-02         PIC           Z.ZZZ.ZZZ.ZZ9.
           03  WSS-ERR-NUM-CMAX-03 VALUE ' > Perm : '        PIC X(10).
           03  WSS-ERR-NUM-CMAX-04         PIC           Z.ZZZ.ZZZ.ZZ9.
           03  WSS-ERR-NUM-CMAX-05 VALUE ' <Poc>'            PIC X(11).





      * Diferencia de fechas con error
       01  WSS-ERR-FEC-DIFE.
           03  WSS-ERR-FEC-DIFE-00
               VALUE 'CNCNA03COL000000000012'                PIC X(22).
           03  WSS-ERR-FEC-DIFE-01 VALUE 'Dif Fec Err : '    PIC X(14).
           03  WSS-ERR-FEC-DIFE-02 VALUE SPACES              PIC X(08).
           03  WSS-ERR-FEC-DIFE-03 VALUE ' <> '              PIC X(04).
           03  WSS-ERR-FEC-DIFE-04 VALUE SPACES              PIC X(08).
           03  WSS-ERR-FEC-DIFE-05 VALUE SPACES              PIC X(01).
           03  WSS-ERR-FEC-DIFE-06 VALUE SPACES              PIC X(34).

      * Este producto no permite prorroga
       01  WSS-ERR-INV-PROR.
           03  WSS-ERR-INV-PROR-00
               VALUE 'CNCNA03COL000000000013'                PIC X(22).
           03  WSS-ERR-INV-PROR-01 VALUE
               ' Prorroga invalida para Producto de operacion'
                                                             PIC X(48).
      * Este servicio no permite operar en este horario
       01  WSS-ERR-INV-HORA.
           03  WSS-ERR-INV-HORA-00
               VALUE 'CNCNA03COL000000000014'                PIC X(22).
           03  WSS-ERR-INV-HORA-01 VALUE
               ' Especificacion horario inexistente o no vigente'
                                                             PIC X(48).


       77  WSS-TOT-RESP           VALUE ZEROES               PIC 9(05).

       77  WSS-POC-VAL-CMAX        COMP-3          PIC 9(11)V9(04).

       01  WSS-QUE-INP-COLA VALUE SPACES.
           03 WSS-QUE-INP-COLA-02                        PIC X(02).
           03 WSS-QUE-INP-COLA-06                        PIC X(06).
       01  WSS-QUE-TR-COLA VALUE SPACES.
           03 WSS-QUE-TR-COLA-02                         PIC X(02).
           03 WSS-QUE-TR-COLA-06                         PIC X(06).
       77  WSS-ITEM-SEGM      VALUE ZEROES            PIC 9(03).

       01  WSS-PT.
           03  WSS-PT-AHDR                                 PIC X(00100).
           03  WSS-PT-CREQ                                 PIC X(00003).
           03  WSS-PT-DMSG.
               05  WSS-PT-IMCS                             PIC X(00003).

       01  WSS-GLS-DATA.
      * Indicador del Segmento
           03  WSS-GLS-DATA-COD-SGMT                       PIC X(00001).
      * Indicador si programa invocado PY garba TS o lo hace COLPOA03
           03  WSS-GLS-DATA-IND-TSPT                      PIC X(00001).



       01  WSS-TR.
           03  WSS-TR-COD-SGMT                             PIC X(00001).
           03  WSS-TR-COD-DATA                             PIC X(01024).


       COPY GNSWGSEG.
       COPY GNSWGHOY.
       COPY GNSWGTSK.
       COPY GNSWGPFG.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGSYS.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGQUE.
       COPY GNSWGFRM.
       COPY GNSWVSCR.
       COPY GNSWGMX1.
       COPY GNSWGRQA.
       COPY GNSBRTAB.
       COPY GNSWVIDD.
       COPY GNSBRMSG.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGELS.
       COPY GNSWGUIB.

       COPY GNSWGAMB.
       COPY GNSWGCVT.
       COPY GNSWCSXI.
       COPY GNSWGMXX.
       COPY GNSWGFEC.

       COPY COLMWA03.

      * OPC,CON
       COPY COLMW729.

      * CAN,SCA
       COPY COLMW256.

      * CAN,ING
       COPY COLMW038.

      * CYA,ING
       COPY COLMW018.

      * CAN,VRF
       COPY COLMW043.

      * CAN,CON
       COPY COLMW037.

      * COPY-INC-INI
       COPY COLMW046.

      * COPY-INC-INI
       COPY COLMW013.

      * COPY-INC-INI
       COPY COLMW016.


       77  PT-101-02-ROC-NUM-ADIC-EDT PIC ZZZZZZZZ.
       77  PT-101-02-ROC-NUM-PREP-EDT PIC ZZZ.
       77  PT-101-02-ROC-SGV-CFON-EDT PIC ZZZ,ZZZZ.
       77  PT-101-02-ROC-SGV-FRIE-EDT PIC ZZZ,ZZZZ.
       77  PT-101-02-ROC-SGV-TCAL-EDT PIC ZZZZZZZZZZZ,ZZZZ.

      * COPY-INC-INI
       COPY COLMW101.

      * COPY-INC-INI
       COPY COLMW032.

      * OPC.ACA
       COPY COLMW033.

      * PLC.CON
       COPY COLMW111.

      *77  TP-032-01-OPC-IIC-IOPC-EDT PIC 99999999.
      *77  TP-032-02-FRM-VAL-CRED-EDT PIC 99999999999,9999.
      *77  TP-032-02-FRM-VAL-INTE-EDT PIC 99999999999,9999.
      *77  TP-032-02-FRM-VAL-VCOM-EDT PIC 99999999999,9999.
      *77  TP-032-02-OPC-VAL-SEGD-EDT PIC 99999999999,9999.
      *77  TP-032-02-FRM-VAL-GAST-EDT PIC 99999999999,9999.
      *77  TP-032-02-FRM-VAL-IMPU-EDT PIC 99999999999,9999.
      *77  TP-032-02-OPC-SGV-LIQU-EDT PIC 99999999999,9999.
      *77  TP-032-02-ITR-SGV-TINT-EDT PIC 9999,9999.
      *77  TP-032-03-FRM-NUM-IVCT-EDT PIC 999.
      *77  TP-032-03-FRM-VAL-SCAP-EDT PIC 99999999,99.
      *77  TP-032-03-FRM-VAL-INTC-EDT PIC 999999,99.
      *77  TP-032-03-FRM-VAL-COMC-EDT PIC 99999,99.
      *77  TP-032-03-FRM-VAL-TOTA-EDT PIC 999999999,9999.

      * COPY-INC-FIN

      * ROC-INI
       COPY TABBRUSR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABWGRCC.
       COPY TABWGSGS.
      * COPY-INC-INI
       COPY SGCWGBCC.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY SGCBROPE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY SGCBRRCO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY MC2BRROC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROC-REQA==.

      * ROC-FIN

      *>>>>> GNP-INI

       77  WSS-IDX-IGNP       VALUE ZEROES            PIC 9(03).
       77  WSS-IDX-IROC       VALUE ZEROES            PIC 9(03).
       77  WSS-IDX-TROC       VALUE ZEROES            PIC 9(03).
       77  WSS-TOT-IROC       VALUE ZEROES            PIC 9(03).

       COPY COLWGGNP.
       COPY COLWXGNP.
       COPY COLBRPOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-POC-REQA==.
       01  WSS-VARI.
           03 WSS-NUM-NRNP VALUE ZEROES               PIC 9(02).
           03 WSS-NUM-PLZT VALUE ZEROES               PIC 9(05).
           03 WSS-NITM                                PIC 9(02).
           03 WSS-NITMMAX VALUE 10                    PIC 9(02).
           03 WSS-F       VALUE ZEROES                PIC 9(03).
           03 WSS-FMAX    VALUE 100                   PIC 9(03).
           03 WSS-I                                   PIC 9(02).
           03 WSS-IMAX    VALUE 10                    PIC 9(02).
           03 WSS-J       VALUE ZEROES                PIC 9(02).
           03 WSS-NUM-CCUR.
              05 WSS-NUM-ICUR-EDT                     PIC  ZZ9.
              05 WSS-NUM-ICUR-ALF                     PIC X(03).
              05 WSS-NUM-ICUR      REDEFINES
                 WSS-NUM-ICUR-ALF                     PIC 9(03).
           03  WSS-FEC-FMAX.
               05  WSS-NUM-SMAX                      PIC 9(02).
               05  WSS-NUM-AMAX                      PIC 9(02).
               05  WSS-NUM-MMAX                      PIC 9(02).
               05  WSS-NUM-DMAX                      PIC 9(02).
           03  WSS-FEC-FTMP.
               05  WSS-NUM-STMP                      PIC 9(02).
               05  WSS-NUM-ATMP                      PIC 9(02).
               05  WSS-NUM-MTMP                      PIC 9(02).
               05  WSS-NUM-DTMP                      PIC 9(02).
      *PVG INI 23-JUN-2010 ANALISIS FERIADO
           03  WSS-FEC-FPZT.
               05  WSS-NUM-SPZT                      PIC 9(02).
               05  WSS-NUM-APZT                      PIC 9(02).
               05  WSS-NUM-MPZT                      PIC 9(02).
               05  WSS-NUM-DPZT                      PIC 9(02).
           03  WSS-GLS-GMND.
               05  WSS-GLS-GMD1                      PIC X(01).
               05  WSS-GLS-GMD2                      PIC X(01).
               05  WSS-GLS-GMD3                      PIC X(01).
               05  WSS-GLS-GMD4                      PIC X(01).
               05  WSS-GLS-GMD5                      PIC X(01).
               05  WSS-GLS-GMD6                      PIC X(01).
               05  WSS-GLS-GMD7                      PIC X(01).
               05  WSS-GLS-GMD8                      PIC X(01).
           03  WSS-GLS-VLR1.
               05  WSS-DIS-VLR1                      PIC X(04).
               05  WSS-COD-VLR1                      PIC X(04).
               05  WSS-EXT-VLR1 VALUE SPACES         PIC X(02).
           03  WSS-GLS-VLR2.
               05  WSS-DIS-VLR2                      PIC X(02).
               05  WSS-COD-VLR2                      PIC X(06).
           03  WSS-GLS-GTIO.
               05  WSS-COD-GTIO                      PIC X(03).
               05  WSS-GLS-DTIO                      PIC X(01).
           03  WSS-GLS-GAUX.
               05  WSS-GLS-DAUX                      PIC X(01).
               05  WSS-COD-GAUX                      PIC X(03).

       01  WSS-FEC-FDMA.
           03 WSS-NUM-DDMA                           PIC 9(02).
           03 WSS-NUM-MDMA                           PIC 9(02).
           03 WSS-NUM-SDMA                           PIC 9(02).
           03 WSS-NUM-ADMA                           PIC 9(02).

       01  WSS-FEC-FAMD.
           03 WSS-NUM-SAMD                           PIC 9(02).
           03 WSS-NUM-AAMD                           PIC 9(02).
           03 WSS-NUM-MAMD                           PIC 9(02).
           03 WSS-NUM-DAMD                           PIC 9(02).


      *>>>>> GNP-FIN

      *
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                                  PIC X(3000).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
       COPY GNSBGEDB.

      * RECIBO IDENTIFICACION DEL PC QUE ENVIO EL MSG.

           MOVE DFHCOMMAREA(1:EIBCALEN) TO MCS-CMA-COD-SREQ.

           MOVE MCS-CMA-COD-PT-MCS      TO PT-A03.

           PERFORM GNS-ERR-QUE.

           PERFORM GET-FHOY.


           MOVE 'A03INP' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'A03INP' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE MCS-CMA-COD-SREQ TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'PT-A03' TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PT-A03' TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE PT-A03 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           PERFORM GET-TSK-TERM.


      *    MOVE MCS-CMA-COD-IDD         TO IDD-REGI.

           PERFORM CRG-IDD.

           MOVE MCS-CMA-COD-COLA TO WSS-QUE-TR-COLA.
           MOVE 'TR'             TO WSS-QUE-TR-COLA-02.

           MOVE 'GIDD'       TO RCC-QUEU.
           MOVE TSK-TERM-ALF TO RCC-TERM.

           MOVE TSK-TERM-ALF TO TS-TPAG-TERM.

           MOVE RCC-QIDD TO QUE-COLA.
           MOVE +490 TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
                 MOVE RCC-QIDD TO QUE-COLA
                 MOVE +490 TO QUE-LITM
                 MOVE IDD-REGI TO QUE-ITEM
                 MOVE QUE-PUT TO QUE-CMND
                 PERFORM GNS-PRO-QUE.

           PERFORM GNS-ERR-QUE.

      *     MOVE WSS-QUE-TR-COLA TO QUE-COLA.
      *     MOVE QUE-DEL TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.

           MOVE SCR-NOM-TCPIP TO  WSS-PTR-GLS-COLA.

           MOVE SCR-NOM-TCPIP TO WSS-PTR-COD-TYPE.


           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'COL' TO FIO-SIST.
           MOVE 'VSN'      TO TAB-COD-TTAB IN TAB.
           MOVE 'LOGPMA03' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-MSC-STAT IN TAB TO WSS-LOGPMA03.



           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'COL' TO FIO-SIST.
           MOVE 'VSN'      TO TAB-COD-TTAB IN TAB.
           MOVE 'BCKPMA03NO' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               MOVE TAB-MSC-STAT IN TAB TO WSS-BCKPMA03NO.


           MOVE 'SIMUO'                 TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +10 TO QUE-LITM.

           MOVE PT-A03-01-FRM-COD-SIMU TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




      *>>>>>>>>>>>>>>>>>>    111  PLC,CON INI  >>>>>>>>>>>>>>>>>>>>>>>>

            MOVE WSS-QUE-TR-COLA TO QUE-COLA.
            MOVE QUE-DEL TO QUE-CMND.
            PERFORM GNS-PRO-QUE.

           MOVE SPACES TO PT-111.

           MOVE 'X' TO WSS-TR-COD-SGMT.

           MOVE PT-A03-AHDR            TO PT-111-AHDR.

           MOVE '111'                  TO PT-111-CREQ.

           MOVE PT-A03-01-OPC-CAI-IOPC TO PT-111-01-OPC-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO PT-111-01-OPC-IIC-IOPC.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE PT-111             TO WSS-TR-COD-DATA.
           MOVE WSS-TR             TO QUE-ITEM.

           MOVE WSS-CTE-LENTR-1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.
           PERFORM GNS-PRO-QUE.


           MOVE 'PT-111'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'PT-111'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.
           MOVE  PT-111 TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


      *>>>>>>>>>>>>>> LLAMA A COLPPTPG 111  PLC,CON >>>>>>>>>>>>>>>>>>>



           MOVE SYS-LINK            TO SYS-CMND.
           MOVE WSS-QUE-TR-COLA-06  TO SYS-CMMA.
           MOVE WSS-CTE-CMA-TPG     TO SYS-TCMA.
           MOVE WSS-CTE-COLPPTPG TO SYS-PROG.
           PERFORM GNS-PRO-SYS.














           MOVE ZEROES  TO QUE-NITM.

           MOVE ZEROES TO WSS-TOT-RESP.



       CIC-GET-TR-111.

      *      EXEC CICS ASSIGN OPID(USP-OPID-USU)
      *      END-EXEC.

            ADD 1 TO QUE-NITM.

            MOVE QUE-NITM TO WSS-NITM-TSPT.

            MOVE 'TR' TO WSS-QUE-TR-COLA-02.
            MOVE WSS-QUE-TR-COLA TO QUE-COLA.


            MOVE +1025 TO QUE-LITM.
            MOVE QUE-GET TO QUE-CMND.
            PERFORM GNS-PRO-QUE.
            IF QUE-STAT = QUE-STAT-OKS
                 ADD 1 TO WSS-TOT-RESP
                 MOVE QUE-ITEM TO WSS-TR
                 MOVE WSS-TR-COD-DATA TO WSS-ELE-SEGS(WSS-NITM-TSPT)

                 GO TO CIC-GET-TR-111.

           IF TP-111-STAT = '1'
                GO TO FIN-MAIN.

           MOVE WSS-SND TO TP-111.


           MOVE 'TP-111'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE TP-111 TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +700 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.

           MOVE SPACES TO TP-032.
           MOVE TP-111-STAT            TO TP-032-STAT.
           MOVE TP-111-MENS            TO TP-032-MENS.
           MOVE PT-A03-01-OPC-CAI-IOPC TO TP-032-01-OPC-CAI-IOPC.
           MOVE PT-A03-01-OPC-IIC-IOPC TO TP-032-01-OPC-IIC-IOPC.
           MOVE TP-111-01-OPC-COD-VCOC TO TP-032-02-OPC-COD-VCOC.
           MOVE TP-111-01-OPC-COD-TOOC TO TP-032-02-OPC-COD-TOOC.
           MOVE TP-111-01-OPC-COD-AOOC TO TP-032-02-OPC-COD-AOOC.
           MOVE TP-111-01-DBC-GLS-NOMC TO TP-032-02-DBC-GLS-NOMC.
           MOVE TP-111-01-FRM-GLS-VEXP TO TP-032-02-FRM-GLS-VEXP.
           MOVE TP-111-01-OPC-FEC-FCOL TO TP-032-02-OPC-FEC-FCOL.

           MOVE 'X03-01'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE TP-111-01-FRM-VAL-CRED TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.





           MOVE TP-111-01-FRM-VAL-CRED TO TP-032-02-FRM-VAL-CRED.
           MOVE TP-032-02-FRM-VAL-CRED-NUM TO
                WSS-EDT-1204.
           MOVE WSS-EDT-1204 TO
                TP-032-02-FRM-VAL-CRED.


           MOVE 'X03-02'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE TP-111-01-FRM-VAL-INTE TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           MOVE TP-111-01-FRM-VAL-INTE TO TP-032-02-FRM-VAL-INTE.
           MOVE TP-032-02-FRM-VAL-INTE-NUM TO
                WSS-EDT-1204.
           MOVE WSS-EDT-1204 TO
                TP-032-02-FRM-VAL-INTE.





           MOVE 'X03-03'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE TP-111-01-FRM-VAL-VCOM TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           MOVE TP-111-01-FRM-VAL-VCOM TO TP-032-02-FRM-VAL-VCOM.
           MOVE TP-032-02-FRM-VAL-VCOM-NUM TO
                WSS-EDT-1204.
           MOVE WSS-EDT-1204 TO
                TP-032-02-FRM-VAL-VCOM.










           MOVE 'X03-04'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE TP-111-01-OPC-VAL-SEGD TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           MOVE TP-111-01-OPC-VAL-SEGD TO TP-032-02-OPC-VAL-SEGD.
           MOVE TP-032-02-OPC-VAL-SEGD-NUM TO
                WSS-EDT-1204.
           MOVE WSS-EDT-1204 TO
                TP-032-02-OPC-VAL-SEGD.






           MOVE 'X03-05'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE TP-111-01-FRM-VAL-GAST TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           MOVE TP-111-01-FRM-VAL-GAST TO TP-032-02-FRM-VAL-GAST.
           MOVE TP-032-02-FRM-VAL-GAST-NUM TO
                WSS-EDT-1204.
           MOVE WSS-EDT-1204 TO
                TP-032-02-FRM-VAL-GAST.






           MOVE 'X03-06'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  TP-111-01-FRM-VAL-IMPU TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           MOVE TP-111-01-FRM-VAL-IMPU TO TP-032-02-FRM-VAL-IMPU.
           MOVE TP-032-02-FRM-VAL-IMPU-NUM TO
                WSS-EDT-1204.
           MOVE WSS-EDT-1204 TO
                TP-032-02-FRM-VAL-IMPU.






           MOVE 'X03-07'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  TP-111-01-OPC-SGV-LIQU TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           MOVE TP-111-01-OPC-SGV-LIQU TO TP-032-02-OPC-SGV-LIQU.
           MOVE TP-032-02-OPC-SGV-LIQU-NUM TO
                WSS-EDT-1204.
           MOVE WSS-EDT-1204 TO
                TP-032-02-OPC-SGV-LIQU.




           MOVE TP-111-01-FRM-GLS-TINT TO TP-032-02-FRM-GLS-TINT.









           MOVE 'X03-08'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  TP-111-01-ITR-SGV-TINT TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.



           MOVE TP-111-01-ITR-SGV-TINT TO TP-032-02-ITR-SGV-TINT.
           MOVE TP-032-02-ITR-SGV-TINT-NUM TO
                WSS-EDT-0304.
           MOVE WSS-EDT-0304 TO
                TP-032-02-ITR-SGV-TINT.




           PERFORM PUT-IDX-111-I VARYING WSS-IDX-111-I FROM 1 BY 1
                          UNTIL WSS-IDX-111-I > 8 OR
                            WSS-IND-OCC-111 = WSS-CTE-FIN.


           MOVE TP-032-STAT TO TP-032-SI-TPAG-STAT.
           MOVE TP-032-MENS TO TP-032-SI-TPAG-MENS.
           MOVE TP-032-DMSG TO TP-032-SI-TPAG-DMSG.


           MOVE TS-TPAG TO QUE-COLA.
           MOVE QUE-GET TO QUE-CMND.
           MOVE 1       TO QUE-NITM.
           MOVE WSS-CTE-LENTR-20 TO QUE-LITM.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
                MOVE QUE-ITEM  TO TP-037-01-CAN-SGV-TPAG

                MOVE TS-TPAG TO QUE-COLA
                MOVE QUE-DEL TO QUE-CMND
                PERFORM GNS-PRO-QUE



           ELSE
                MOVE ZEROES TO TP-037-01-CAN-SGV-TPAG-NUM.

           MOVE TP-037-01-CAN-SGV-TPAG-NUM TO WSS-SGN-1404.
           MOVE WSS-SGN-1404 TO
                TP-032-01-CAN-SGV-TPAG.


           MOVE TP-032-SI-TPAG TO TP-032.


           MOVE TP-032 TO WSS-SND.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           PERFORM PUT-TR-RESP VARYING WSS-IDX-TR FROM 1 BY 1 UNTIL
             WSS-IDX-TR > WSS-TOT-RESP.


           IF WSS-BCKPMA03NO = WSS-CTE-N

           IF PT-A03-01-FRM-COD-SIMU NOT = WSS-CTE-SIMU-A
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'COL' TO FIO-SIST
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM GNS-FIO-TAB.



       FIN-MAIN.
           EXEC CICS RETURN END-EXEC.
       EXT-MAIN.
           EXIT.

       PUT-IDX-111-I SECTION.
       INI-PUT-IDX-111-I.


           MOVE 'PUT-01'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  WSS-IDX-111-I TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           PERFORM PUT-IDX-111-J VARYING WSS-IDX-111-J FROM 1 BY 1
                         UNTIL WSS-IDX-111-J > 9 OR
                            WSS-IND-OCC-111 = WSS-CTE-FIN.
       FIN-PUT-IDX-111-I.
           EXIT.


       PUT-IDX-111-J SECTION.
       INI-PUT-IDX-111-J.

           MOVE 'PUT-02'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  WSS-IDX-111-J TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           IF TP-111-03-FRM-NUM-IVCT-NUM
            ( WSS-IDX-111-I , WSS-IDX-111-J ) NOT > ZEROES
                  MOVE WSS-CTE-FIN TO WSS-IND-OCC-111
                  GO TO FIN-PUT-IDX-111-J.


           MOVE 'PUT-03'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  WSS-IDX-111-I TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           ADD 1 TO WSS-IDX-032-J.
           IF WSS-IDX-032-J > 9
               MOVE 1 TO WSS-IDX-032-J
               ADD  1 TO WSS-IDX-032-I.


           MOVE 'PUT-04'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  WSS-IDX-111-I TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           MOVE 'PUT-05'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  WSS-IDX-111-J TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           MOVE TP-111-03-FRM-NUM-IVCT IN TP-111
                          ( WSS-IDX-111-I , WSS-IDX-111-J ) TO
                TP-032-03-FRM-NUM-IVCT IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).



           MOVE 'X03-09'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  SPACES TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.

           MOVE TP-111-03-FRM-FEC-FVEN IN TP-111
                          ( WSS-IDX-111-I , WSS-IDX-111-J ) TO
                TP-032-03-FRM-FEC-FVEN IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).


           MOVE 'X03-10'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  TP-111-03-FRM-VAL-SCAP
                          ( WSS-IDX-032-I , WSS-IDX-032-J )
                 TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.

           MOVE '111-I'                TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE  WSS-IDX-111-I TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.

           MOVE '111-J'                TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE  WSS-IDX-111-J TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.

           MOVE '032-I'                TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE  WSS-IDX-032-I TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.

           MOVE '032-J'                TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.
           MOVE  WSS-IDX-032-J TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.



           MOVE TP-111-03-FRM-VAL-SCAP IN TP-111
                          ( WSS-IDX-111-I , WSS-IDX-111-J ) TO
                TP-032-03-FRM-VAL-SCAP IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).

           MOVE 'X03-101'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  TP-032-03-FRM-VAL-SCAP IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J )
                 TO QUE-ITEM.

           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.



           MOVE     TP-032-03-FRM-VAL-SCAP-NUM IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ) TO
                    WSS-EDT-0902.

           MOVE 'X03-102'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  WSS-EDT-0902 TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


           MOVE     WSS-EDT-0902 TO
                  TP-032-03-FRM-VAL-SCAP IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).



           MOVE 'X03-11'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  SPACES TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.




           MOVE TP-111-03-FRM-VAL-INTC IN TP-111
                          ( WSS-IDX-111-I , WSS-IDX-111-J ) TO
                TP-032-03-FRM-VAL-INTC IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).

           MOVE TP-032-03-FRM-VAL-INTC-NUM IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ) TO
                   WSS-EDT-0702.
           MOVE    WSS-EDT-0702 TO
                  TP-032-03-FRM-VAL-INTC IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).


           MOVE 'X03-12'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  SPACES TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.








           MOVE TP-111-03-FRM-VAL-COMC IN TP-111
                          ( WSS-IDX-111-I , WSS-IDX-111-J ) TO
                TP-032-03-FRM-VAL-COMC IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).

           MOVE TP-032-03-FRM-VAL-COMC-NUM IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ) TO
                  WSS-EDT-0602.
           MOVE   WSS-EDT-0602 TO
               TP-032-03-FRM-VAL-COMC IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).



           MOVE 'X03-13'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  SPACES TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.



           MOVE TP-111-03-FRM-VAL-TOTA IN TP-111
                          ( WSS-IDX-111-I , WSS-IDX-111-J ) TO
                TP-032-03-FRM-VAL-TOTA IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).

           MOVE TP-032-03-FRM-VAL-TOTA-NUM IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ) TO
                  WSS-EDT-0904.
           MOVE   WSS-EDT-0904 TO
                TP-032-03-FRM-VAL-TOTA IN TP-032
                          ( WSS-IDX-032-I , WSS-IDX-032-J ).

           MOVE 'X03-14'               TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE  SPACES TO QUE-ITEM.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.
           PERFORM GNX-PRO-QUE.


       FIN-PUT-IDX-111-J.
           EXIT.



       PRO-TR SECTION.
       INI-PRO-TR.
       FIN-PRO-TR.
           EXIT.

       PUT-TR SECTION.
       INI-PUT-TR.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           MOVE WSS-ELE-SEGS(WSS-IDX-TR) TO QUE-ITEM.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-TR.
           EXIT.

       PUT-TR-RESP SECTION.
       INI-PUT-TR-RESP.

           MOVE WSS-QUE-TR-COLA TO QUE-COLA.

           MOVE +1025 TO QUE-LITM.
           MOVE QUE-PUT TO QUE-CMND.

           MOVE WSS-ELE-SEGS(WSS-IDX-TR) TO WSS-DATA-TSPT.
           IF WSS-IDX-TR < WSS-TOT-RESP
               MOVE '0' TO WSS-INDICA-TSPT
           ELSE
               MOVE '1' TO WSS-INDICA-TSPT.

           MOVE WSS-ITEM-TSPT TO QUE-ITEM.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-TR-RESP.
           EXIT.

       COPY GNSBVNUM.
       COPY GNSBGHOY.
       COPY GNSBHSYS.
       COPY GNSBGSYS.
       COPY GNSBIABT.
       COPY GNSBGTSK.
       COPY GNSBGFEC.
       COPY GNSBPFEC.
       COPY GNSBFMSG.
       COPY GNSBFTAB.
       COPY GNSBGDTC.
       COPY GNSBGMSG.
       COPY GNSBVTAB.
       COPY TABBFUSR.

       COPY GNSBGEND.

      *Modulo Generico Manejo de TSs
       COPY GNSBGQUE.

       COPY COLBFPOC.

       CRG-IDD SECTION.
       INI-CRG-IDD.
           MOVE 'GNS'      TO SCR-SIST.
           MOVE 'COLPMA03' TO IDD-PROG FIO-PROG.
           MOVE IDD-VARI   TO SYS-CMMA.
           MOVE +507       TO SYS-TCMA.
           MOVE 'GNSPPIDD' TO SYS-PROG.
           MOVE SYS-LINK   TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
           MOVE SYS-CMMA   TO IDD-VARI.

       FIN-IDD-CRG.
           EXIT.

      * COPY-INC-INI
       COPY SGCBGBCC.
       COPY SGCBFDBC.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       COPY MC2BFROC.

       GNX-PRO-QUE SECTION.
       INI-GNX-PRO-QUE.

           IF WSS-LOGPMA03 = 'S'
                PERFORM GNS-PRO-QUE.

       FIN-GNX-PRO-QUE.
           EXIT.

       VAL-NUM-TP-REQ-032 SECTION.
       INI-VAL-NUM-TP-REQ-032.


           MOVE 'INI-NUM'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'INI-NUM'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +300 TO QUE-LITM.

           MOVE TP-032-02-OPC-COD-VCOC TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           MOVE 'NUM-02'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-02'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           PERFORM VN-TP-032-01-OPC-IIC-IOPC.


           MOVE 'NUM-03'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-03'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           PERFORM VN-TP-032-02-FRM-VAL-CRED.


           MOVE 'NUM-04'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-04'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           PERFORM VN-TP-032-02-FRM-VAL-INTE.



           MOVE 'NUM-05'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-05'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.





           PERFORM VN-TP-032-02-FRM-VAL-VCOM.


           MOVE 'NUM-06'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-06'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           PERFORM VN-TP-032-02-OPC-VAL-SEGD.



           MOVE 'NUM-07'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-07'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




           PERFORM VN-TP-032-02-FRM-VAL-GAST.



           MOVE 'NUM-08'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-08'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




           PERFORM VN-TP-032-02-FRM-VAL-IMPU.


           MOVE 'NUM-09'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-09'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.




           PERFORM VN-TP-032-02-OPC-SGV-LIQU.

           MOVE 'NUM-10'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-10'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           PERFORM VN-TP-032-02-ITR-SGV-TINT.


           MOVE 'NUM-11'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-11'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.





           PERFORM VN-TP-032-03-FRM-NUM-IVCT.


           MOVE 'NUM-12'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-12'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           PERFORM VN-TP-032-03-FRM-VAL-SCAP.


           MOVE 'NUM-13'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-13'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           PERFORM VN-TP-032-03-FRM-VAL-INTC.


           MOVE 'NUM-14'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-14'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           PERFORM VN-TP-032-03-FRM-VAL-COMC.


           MOVE 'NUM-15'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-15'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.



           PERFORM VN-TP-032-03-FRM-VAL-TOTA.


           MOVE 'NUM-16'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-16'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE SPACES TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

       FIN-VAL-NUM-TP-REQ-032.
           EXIT.




       VN-TP-032-01-OPC-IIC-IOPC SECTION.
       VNI-TP-032-01-OPC-IIC-IOPC.
           MOVE TP-032-01-OPC-IIC-IOPC-NUM TO
                TP-032-01-OPC-IIC-IOPC-EDT.

           MOVE TP-032-01-OPC-IIC-IOPC-EDT TO
                TP-032-01-OPC-IIC-IOPC.
       VNF-TP-032-01-OPC-IIC-IOPC.
           EXIT.

       VN-TP-032-02-FRM-VAL-CRED SECTION.
       VNI-TP-032-02-FRM-VAL-CRED.
           MOVE TP-032-02-FRM-VAL-CRED-NUM TO
                TP-032-02-FRM-VAL-CRED-EDT.

           MOVE TP-032-02-FRM-VAL-CRED-EDT TO
                TP-032-02-FRM-VAL-CRED.

       VNF-TP-032-02-FRM-VAL-CRED.
           EXIT.

       VN-TP-032-02-FRM-VAL-INTE SECTION.
       VNI-TP-032-02-FRM-VAL-INTE.
           MOVE TP-032-02-FRM-VAL-INTE-NUM TO
                TP-032-02-FRM-VAL-INTE-EDT.

           MOVE TP-032-02-FRM-VAL-INTE-EDT TO
                TP-032-02-FRM-VAL-INTE.
       VNF-TP-032-02-FRM-VAL-INTE.
           EXIT.

       VN-TP-032-02-FRM-VAL-VCOM SECTION.
       VNI-TP-032-02-FRM-VAL-VCOM.
           MOVE TP-032-02-FRM-VAL-VCOM-NUM TO
                TP-032-02-FRM-VAL-VCOM-EDT.

           MOVE TP-032-02-FRM-VAL-VCOM-EDT TO
                TP-032-02-FRM-VAL-VCOM.
       VNF-TP-032-02-FRM-VAL-VCOM.
           EXIT.

       VN-TP-032-02-OPC-VAL-SEGD SECTION.
       VNI-TP-032-02-OPC-VAL-SEGD.
           MOVE TP-032-02-OPC-VAL-SEGD-NUM TO
                TP-032-02-OPC-VAL-SEGD-EDT.

           MOVE TP-032-02-OPC-VAL-SEGD-EDT TO
                TP-032-02-OPC-VAL-SEGD.
       VNF-TP-032-02-OPC-VAL-SEGD.
           EXIT.

       VN-TP-032-02-FRM-VAL-GAST SECTION.
       VNI-TP-032-02-FRM-VAL-GAST.
           MOVE TP-032-02-FRM-VAL-GAST-NUM TO
                TP-032-02-FRM-VAL-GAST-EDT.


           MOVE TP-032-02-FRM-VAL-GAST-EDT TO
                TP-032-02-FRM-VAL-GAST.
       VNF-TP-032-02-FRM-VAL-GAST.
           EXIT.

       VN-TP-032-02-FRM-VAL-IMPU SECTION.
       VNI-TP-032-02-FRM-VAL-IMPU.
           MOVE TP-032-02-FRM-VAL-IMPU-NUM TO
                TP-032-02-FRM-VAL-IMPU-EDT.

           MOVE TP-032-02-FRM-VAL-IMPU-EDT TO
                TP-032-02-FRM-VAL-IMPU.
       VNF-TP-032-02-FRM-VAL-IMPU.
           EXIT.

       VN-TP-032-02-OPC-SGV-LIQU SECTION.
       VNI-TP-032-02-OPC-SGV-LIQU.
           MOVE TP-032-02-OPC-SGV-LIQU-NUM TO
                TP-032-02-OPC-SGV-LIQU-EDT.

           MOVE TP-032-02-OPC-SGV-LIQU-EDT TO
                TP-032-02-OPC-SGV-LIQU.
       VNF-TP-032-02-OPC-SGV-LIQU.
           EXIT.

       VN-TP-032-02-ITR-SGV-TINT SECTION.
       VNI-TP-032-02-ITR-SGV-TINT.
           MOVE TP-032-02-ITR-SGV-TINT-NUM TO
                TP-032-02-ITR-SGV-TINT-EDT.

           MOVE TP-032-02-ITR-SGV-TINT-EDT TO
                TP-032-02-ITR-SGV-TINT.
       VNF-TP-032-02-ITR-SGV-TINT.
           EXIT.

       VN-TP-032-03-FRM-NUM-IVCT SECTION.
       VNI-TP-032-03-FRM-NUM-IVCT.



           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-NUM-IVCT.

           MOVE 'NUM-12.0'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-12.0'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE TP-032-03-FRM-NUM-IVCT( TPG-L , TPG-M )
                TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.

           IF TP-032-03-FRM-NUM-IVCT( TPG-L , TPG-M )
              NOT > SPACES
                GO TO VNF-TP-032-03-FRM-NUM-IVCT.

           MOVE TP-032-03-FRM-NUM-IVCT-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-NUM-IVCT-EDT.
           MOVE TP-032-03-FRM-NUM-IVCT-EDT TO
                TP-032-03-FRM-NUM-IVCT( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-NUM-IVCT
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-NUM-IVCT.
       VNF-TP-032-03-FRM-NUM-IVCT.
           EXIT.

       VN-TP-032-03-FRM-VAL-SCAP SECTION.
       VNI-TP-032-03-FRM-VAL-SCAP.








           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-VAL-SCAP.




           MOVE 'NUM-12.1'              TO QUE-COLA.
           MOVE QUE-DEL                TO QUE-CMND.
           PERFORM GNX-PRO-QUE.

           MOVE 'NUM-12.1'              TO QUE-COLA.
           MOVE QUE-PUT TO QUE-CMND.
           MOVE +3000 TO QUE-LITM.

           MOVE TP-032-03-FRM-VAL-SCAP( TPG-L , TPG-M )
                TO QUE-ITEM.
           PERFORM GNX-PRO-QUE.


           IF TP-032-03-FRM-VAL-SCAP( TPG-L , TPG-M )
              NOT > SPACES
                GO TO VNF-TP-032-03-FRM-VAL-SCAP.

           MOVE TP-032-03-FRM-VAL-SCAP-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-VAL-SCAP-EDT.

           MOVE TP-032-03-FRM-VAL-SCAP-EDT TO
                TP-032-03-FRM-VAL-SCAP    ( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-VAL-SCAP
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-VAL-SCAP.
       VNF-TP-032-03-FRM-VAL-SCAP.
           EXIT.

       VN-TP-032-03-FRM-VAL-INTC SECTION.
       VNI-TP-032-03-FRM-VAL-INTC.
           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-VAL-INTC.


           IF TP-032-03-FRM-VAL-INTC( TPG-L , TPG-M )
              NOT > SPACES
               GO TO VNF-TP-032-03-FRM-VAL-INTC.

           MOVE TP-032-03-FRM-VAL-INTC-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-VAL-INTC-EDT.


           MOVE TP-032-03-FRM-VAL-INTC-EDT TO
                TP-032-03-FRM-VAL-INTC    ( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-VAL-INTC
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-VAL-INTC.
       VNF-TP-032-03-FRM-VAL-INTC.
           EXIT.

       VN-TP-032-03-FRM-VAL-COMC SECTION.
       VNI-TP-032-03-FRM-VAL-COMC.
           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-VAL-COMC.


           IF TP-032-03-FRM-VAL-COMC( TPG-L , TPG-M )
              NOT > SPACES
                GO TO VNF-TP-032-03-FRM-VAL-COMC.

           MOVE TP-032-03-FRM-VAL-COMC-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-VAL-COMC-EDT.


           MOVE TP-032-03-FRM-VAL-COMC-EDT TO
                TP-032-03-FRM-VAL-COMC    ( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-VAL-COMC
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-VAL-COMC.
       VNF-TP-032-03-FRM-VAL-COMC.
           EXIT.

       VN-TP-032-03-FRM-VAL-TOTA SECTION.
       VNI-TP-032-03-FRM-VAL-TOTA.
           MOVE 1 TO TPG-M.
           MOVE 1 TO TPG-L.
       CVN-TP-032-03-FRM-VAL-TOTA.

           IF TP-032-03-FRM-VAL-TOTA( TPG-L , TPG-M )
               NOT > SPACES
                 GO TO VNF-TP-032-03-FRM-VAL-TOTA.

           MOVE TP-032-03-FRM-VAL-TOTA-NUM( TPG-L , TPG-M ) TO
                TP-032-03-FRM-VAL-TOTA-EDT.
           MOVE TP-032-03-FRM-VAL-TOTA-EDT TO
                TP-032-03-FRM-VAL-TOTA( TPG-L , TPG-M ).
           ADD 1 TO TPG-M.
           IF TPG-M NOT > 9
              GO TO CVN-TP-032-03-FRM-VAL-TOTA
           ELSE
              ADD 1 TO  TPG-L
              MOVE 1 TO  TPG-M
              IF TPG-L NOT > 16
                  GO TO CVN-TP-032-03-FRM-VAL-TOTA.
       VNF-TP-032-03-FRM-VAL-TOTA.
           EXIT.
