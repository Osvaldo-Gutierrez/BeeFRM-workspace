      *
      * MC2BUATE
      * Version 3.0.1 Nov-2005
      * 17-Feb-16 10:49 AM
      *
       SET-TAG-MC2BUATE SECTION.
       INI-SET-TAG-MC2BUATE.
           MOVE
           '<IDNMOD NOM=$MC2BUATE$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$17-Feb-16 10:49 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-MC2BUATE.
           EXIT.
           
       RET-ALL-ATE SECTION.
       INI-RET-ALL-ATE.
           PERFORM KEY-ALL-ATE.
           PERFORM RET-DBC-ATE.
       FIN-RET-ALL-ATE.
           EXIT.
       
       RET-DBC-ATE SECTION.
       INI-RET-DBC-ATE.
       FIN-RET-DBC-ATE.
           EXIT.
       
       KEY-ALL-ATE SECTION.
       INI-KEY-ALL-ATE.
           PERFORM KEY-DBC-ATE.
       FIN-KEY-ALL-ATE.
           EXIT.
       
       KEY-DBC-ATE SECTION.
       INI-KEY-DBC-ATE.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN ATE-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN ATE-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN ATE-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN ATE-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-ATE.
           EXIT.
       
       SCR-CLRA-ATE SECTION.
       INI-SCR-CLRA-ATE.
           PERFORM CLR-KEY-ATE.
           PERFORM CLR-FLD-ATE.
       FIN-SCR-CLRA-ATE.
           EXIT.
       
       CLR-KEY-ATE SECTION.
       INI-CLR-KEY-ATE.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN ATE-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN ATE-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN ATE-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN ATE-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-COD-TCNL IN ATE-FLD.
           MOVE SPACES TO FRM-COD-CNAL IN ATE-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FINI IN ATE-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-HRA-HINI IN ATE-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-FTER IN ATE-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-HRA-HTER IN ATE-FLD.
       FIN-CLR-KEY-ATE.
           EXIT.
       
       CLR-FLD-ATE SECTION.
       INI-CLR-FLD-ATE.
           MOVE SPACES TO FRM-COD-VCOC IN ATE-FLD(1).
           MOVE SPACES TO FRM-COD-VCOC IN ATE-FLD(2).
           MOVE SPACES TO FRM-COD-VCOC IN ATE-FLD(3).
           MOVE SPACES TO FRM-COD-VCOC IN ATE-FLD(4).
           MOVE SPACES TO FRM-COD-TOOC IN ATE-FLD(1).
           MOVE SPACES TO FRM-COD-TOOC IN ATE-FLD(2).
           MOVE SPACES TO FRM-COD-TOOC IN ATE-FLD(3).
           MOVE SPACES TO FRM-COD-TOOC IN ATE-FLD(4).
           MOVE SPACES TO FRM-COD-AOOC IN ATE-FLD(1).
           MOVE SPACES TO FRM-COD-AOOC IN ATE-FLD(2).
           MOVE SPACES TO FRM-COD-AOOC IN ATE-FLD(3).
           MOVE SPACES TO FRM-COD-AOOC IN ATE-FLD(4).
           MOVE SPACES TO FRM-COD-GRUP IN ATE-FLD(1).
           MOVE SPACES TO FRM-COD-GRUP IN ATE-FLD(2).
           MOVE SPACES TO FRM-COD-GRUP IN ATE-FLD(3).
           MOVE SPACES TO FRM-COD-GRUP IN ATE-FLD(4).
           MOVE SPACES TO FRM-COD-CPTO IN ATE-FLD(1).
           MOVE SPACES TO FRM-COD-CPTO IN ATE-FLD(2).
           MOVE SPACES TO FRM-COD-CPTO IN ATE-FLD(3).
           MOVE SPACES TO FRM-COD-CPTO IN ATE-FLD(4).
           MOVE SPACES TO FRM-COD-SCPT IN ATE-FLD(1).
           MOVE SPACES TO FRM-COD-SCPT IN ATE-FLD(2).
           MOVE SPACES TO FRM-COD-SCPT IN ATE-FLD(3).
           MOVE SPACES TO FRM-COD-SCPT IN ATE-FLD(4).
           MOVE SPACES TO FRM-GLS-CICT IN ATE-FLD(1).
           MOVE SPACES TO FRM-GLS-CICT IN ATE-FLD(2).
           MOVE SPACES TO FRM-GLS-CICT IN ATE-FLD(3).
           MOVE SPACES TO FRM-GLS-CICT IN ATE-FLD(4).
           MOVE ZEROES TO FRM-SGV-TASA IN ATE-FLD(1).
           MOVE ZEROES TO FRM-SGV-TASA IN ATE-FLD(2).
           MOVE ZEROES TO FRM-SGV-TASA IN ATE-FLD(3).
           MOVE ZEROES TO FRM-SGV-TASA IN ATE-FLD(4).
           MOVE SPACES TO FRM-MSC-BCTI IN ATE-FLD(1).
           MOVE SPACES TO FRM-MSC-BCTI IN ATE-FLD(2).
           MOVE SPACES TO FRM-MSC-BCTI IN ATE-FLD(3).
           MOVE SPACES TO FRM-MSC-BCTI IN ATE-FLD(4).
           MOVE SPACES TO FRM-MSC-PBTI IN ATE-FLD(1).
           MOVE SPACES TO FRM-MSC-PBTI IN ATE-FLD(2).
           MOVE SPACES TO FRM-MSC-PBTI IN ATE-FLD(3).
           MOVE SPACES TO FRM-MSC-PBTI IN ATE-FLD(4).
           MOVE SPACES TO FRM-MSC-BPBT IN ATE-FLD(1).
           MOVE SPACES TO FRM-MSC-BPBT IN ATE-FLD(2).
           MOVE SPACES TO FRM-MSC-BPBT IN ATE-FLD(3).
           MOVE SPACES TO FRM-MSC-BPBT IN ATE-FLD(4).
           MOVE SPACES TO FRM-MSC-SPBT IN ATE-FLD(1).
           MOVE SPACES TO FRM-MSC-SPBT IN ATE-FLD(2).
           MOVE SPACES TO FRM-MSC-SPBT IN ATE-FLD(3).
           MOVE SPACES TO FRM-MSC-SPBT IN ATE-FLD(4).
           MOVE SPACES TO FRM-COD-CVTI IN ATE-FLD(1).
           MOVE SPACES TO FRM-COD-CVTI IN ATE-FLD(2).
           MOVE SPACES TO FRM-COD-CVTI IN ATE-FLD(3).
           MOVE SPACES TO FRM-COD-CVTI IN ATE-FLD(4).
           MOVE SPACES TO FRM-MSC-TFPR IN ATE-FLD(1).
           MOVE SPACES TO FRM-MSC-TFPR IN ATE-FLD(2).
           MOVE SPACES TO FRM-MSC-TFPR IN ATE-FLD(3).
           MOVE SPACES TO FRM-MSC-TFPR IN ATE-FLD(4).
           MOVE ZEROES TO FRM-NUM-PREP IN ATE-FLD(1).
           MOVE ZEROES TO FRM-NUM-PREP IN ATE-FLD(2).
           MOVE ZEROES TO FRM-NUM-PREP IN ATE-FLD(3).
           MOVE ZEROES TO FRM-NUM-PREP IN ATE-FLD(4).
           MOVE SPACES TO FRM-MSC-UTPR IN ATE-FLD(1).
           MOVE SPACES TO FRM-MSC-UTPR IN ATE-FLD(2).
           MOVE SPACES TO FRM-MSC-UTPR IN ATE-FLD(3).
           MOVE SPACES TO FRM-MSC-UTPR IN ATE-FLD(4).
           MOVE ZEROES TO FRM-SGV-MNTO IN ATE-FLD(1).
           MOVE ZEROES TO FRM-SGV-MNTO IN ATE-FLD(2).
           MOVE ZEROES TO FRM-SGV-MNTO IN ATE-FLD(3).
           MOVE ZEROES TO FRM-SGV-MNTO IN ATE-FLD(4).
           MOVE SPACES TO FRM-IND-EXPO IN ATE-FLD(1).
           MOVE SPACES TO FRM-IND-EXPO IN ATE-FLD(2).
           MOVE SPACES TO FRM-IND-EXPO IN ATE-FLD(3).
           MOVE SPACES TO FRM-IND-EXPO IN ATE-FLD(4).
           MOVE SPACES TO FRM-IND-BASE IN ATE-FLD(1).
           MOVE SPACES TO FRM-IND-BASE IN ATE-FLD(2).
           MOVE SPACES TO FRM-IND-BASE IN ATE-FLD(3).
           MOVE SPACES TO FRM-IND-BASE IN ATE-FLD(4).
           MOVE SPACES TO FRM-COD-SIST IN ATE-FLD(1).
           MOVE SPACES TO FRM-COD-SIST IN ATE-FLD(2).
           MOVE SPACES TO FRM-COD-SIST IN ATE-FLD(3).
           MOVE SPACES TO FRM-COD-SIST IN ATE-FLD(4).
           MOVE SPACES TO FRM-COD-EVTO IN ATE-FLD(1).
           MOVE SPACES TO FRM-COD-EVTO IN ATE-FLD(2).
           MOVE SPACES TO FRM-COD-EVTO IN ATE-FLD(3).
           MOVE SPACES TO FRM-COD-EVTO IN ATE-FLD(4).
           MOVE SPACES TO FRM-GLS-CICP IN ATE-FLD(1).
           MOVE SPACES TO FRM-GLS-CICP IN ATE-FLD(2).
           MOVE SPACES TO FRM-GLS-CICP IN ATE-FLD(3).
           MOVE SPACES TO FRM-GLS-CICP IN ATE-FLD(4).
           PERFORM CLR-DBC-ATE.
      *<<<< FIN_CLR_FLD_ATE
           PERFORM MUESTRA-CICS VARYING WSS-NUM-CNT1 FROM 
                   WSS-CT-1 BY WSS-CT-1
                   UNTIL (WSS-NUM-CNT1 > WSS-NUM-MAX-REG).
           MOVE SPACES TO SCR-IND-CICS.
      *>>>>
       FIN-CLR-FLD-ATE.
           EXIT.
       
       CLR-DBC-ATE SECTION.
       INI-CLR-DBC-ATE.
       FIN-CLR-DBC-ATE.
           EXIT.
       
       FST-KEY-ATE SECTION.
       INI-FST-KEY-ATE.
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN ATE-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
       FIN-FST-KEY-ATE.
           EXIT.
       
       FST-FLD-ATE SECTION.
       INI-FST-FLD-ATE.
           MOVE -1 TO FRM-COD-VCOC-LEN IN ATE-FLD(1).
       FIN-FST-FLD-ATE.
           EXIT.
       
       PRO-KEY-ATE SECTION.
       INI-PRO-KEY-ATE.
           MOVE FRM-CPIM-AEY TO FRM-COD-TCNL-ATR IN ATE-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-CNAL-ATR IN ATE-FLD.
           MOVE FRM-CPIM-AEY TO FRM-FEC-FINI-ATR IN ATE-FLD.
           MOVE FRM-CPIM-AEY TO FRM-HRA-HINI-ATR IN ATE-FLD.
           MOVE FRM-CPIM-AEY TO FRM-FEC-FTER-ATR IN ATE-FLD.
           MOVE FRM-CPIM-AEY TO FRM-HRA-HTER-ATR IN ATE-FLD.
           PERFORM PRO-MKY-ATE.
       FIN-PRO-KEY-ATE.
           EXIT.
       
       PRO-MKY-ATE SECTION.
       INI-PRO-MKY-ATE.
       FIN-PRO-MKY-ATE.
           EXIT.
       
       PRO-FLD-ATE SECTION.
       INI-PRO-FLD-ATE.
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-TOOC-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-AOOC-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-GRUP-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-GRUP-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-GRUP-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-GRUP-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-CPTO-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-CPTO-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-CPTO-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-CPTO-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-SCPT-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-SCPT-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-SCPT-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-SCPT-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-TASA-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-TASA-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-TASA-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-TASA-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-MSC-BCTI-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-MSC-BCTI-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-MSC-BCTI-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-MSC-BCTI-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-MSC-PBTI-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-MSC-PBTI-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-MSC-PBTI-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-MSC-PBTI-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-MSC-BPBT-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-MSC-BPBT-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-MSC-BPBT-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-MSC-BPBT-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-MSC-SPBT-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-MSC-SPBT-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-MSC-SPBT-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-MSC-SPBT-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-CVTI-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-CVTI-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-CVTI-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-CVTI-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-MSC-TFPR-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-MSC-TFPR-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-MSC-TFPR-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-MSC-TFPR-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-NUM-PREP-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-NUM-PREP-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-NUM-PREP-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-NUM-PREP-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-MSC-UTPR-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-MSC-UTPR-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-MSC-UTPR-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-MSC-UTPR-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-SGV-MNTO-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-SGV-MNTO-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-SGV-MNTO-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-SGV-MNTO-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IND-EXPO-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IND-EXPO-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IND-EXPO-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IND-EXPO-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IND-BASE-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IND-BASE-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IND-BASE-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IND-BASE-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-SIST-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-SIST-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-SIST-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-SIST-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-EVTO-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-EVTO-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-EVTO-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-EVTO-ATR IN ATE-FLD(4).
           PERFORM PRO-DBC-ATE.
       FIN-PRO-FLD-ATE.
           EXIT.
       
       PRO-DBC-ATE SECTION.
       INI-PRO-DBC-ATE.
       FIN-PRO-DBC-ATE.
           EXIT.
       
       UNP-KEY-ATE SECTION.
       INI-UNP-KEY-ATE.
           MOVE FRM-CPIM-UBY TO FRM-COD-TCNL-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CNAL-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FINI-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-HRA-HINI-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FTER-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-HRA-HTER-ATR IN ATE-FLD.
           PERFORM UNP-IKY-ATE.
           PERFORM UNP-AKY-ATE.
           PERFORM UNP-MKY-ATE.
       FIN-UNP-KEY-ATE.
           EXIT.
       
       UNP-IKY-ATE SECTION.
       INI-UNP-IKY-ATE.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN ATE-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-COD-TCNL-ATR.
           MOVE FRM-CPIM-UBY TO FRM-COD-CNAL-ATR.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FINI-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-HRA-HINI-ATR.
           MOVE FRM-CPIM-UBY TO FRM-FEC-FTER-ATR IN ATE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-HRA-HTER-ATR.
       FIN-UNP-IKY-ATE.
           EXIT.
       
       UNP-MKY-ATE SECTION.
       INI-UNP-MKY-ATE.
       FIN-UNP-MKY-ATE.
           EXIT.
       
       UNP-AKY-ATE SECTION.
       INI-UNP-AKY-ATE.
       FIN-UNP-AKY-ATE.
           EXIT.
       
       UNP-FLD-ATE SECTION.
       INI-UNP-FLD-ATE.
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-TOOC-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-AOOC-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-GRUP-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-GRUP-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-GRUP-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-GRUP-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-CPTO-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-CPTO-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-CPTO-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-CPTO-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-SCPT-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-SCPT-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-SCPT-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-SCPT-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-TASA-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-TASA-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-TASA-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-TASA-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-MSC-BCTI-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-MSC-BCTI-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-MSC-BCTI-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-MSC-BCTI-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-MSC-PBTI-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-MSC-PBTI-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-MSC-PBTI-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-MSC-PBTI-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-MSC-BPBT-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-MSC-BPBT-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-MSC-BPBT-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-MSC-BPBT-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-MSC-SPBT-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-MSC-SPBT-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-MSC-SPBT-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-MSC-SPBT-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-CVTI-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-CVTI-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-CVTI-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-CVTI-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-MSC-TFPR-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-MSC-TFPR-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-MSC-TFPR-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-MSC-TFPR-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-NUM-PREP-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-NUM-PREP-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-NUM-PREP-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-NUM-PREP-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-MSC-UTPR-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-MSC-UTPR-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-MSC-UTPR-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-MSC-UTPR-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-SGV-MNTO-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-SGV-MNTO-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-SGV-MNTO-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-SGV-MNTO-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IND-EXPO-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IND-EXPO-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IND-EXPO-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IND-EXPO-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IND-BASE-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IND-BASE-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IND-BASE-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IND-BASE-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-SIST-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-SIST-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-SIST-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-SIST-ATR IN ATE-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-EVTO-ATR IN ATE-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-EVTO-ATR IN ATE-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-EVTO-ATR IN ATE-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-EVTO-ATR IN ATE-FLD(4).
           PERFORM UNP-DBC-ATE.
       FIN-UNP-FLD-ATE.
           EXIT.
       
       UNP-DBC-ATE SECTION.
       INI-UNP-DBC-ATE.
       FIN-UNP-DBC-ATE.
           EXIT.
       
       VAL-MKY-ATE SECTION.
       INI-VAL-MKY-ATE.
       FIN-VAL-MKY-ATE.
           EXIT.
       
       VAL-FLD-ATE SECTION.
       INI-VAL-FLD-ATE.
           PERFORM VAL-FRM-COD-VCOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-VCOC-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-COD-TOOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-TOOC-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-COD-AOOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-AOOC-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-COD-GRUP
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-GRUP-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-COD-CPTO
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-CPTO-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-COD-SCPT
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-SCPT-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-GLS-CICT
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-GLS-CICT-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-SGV-TASA
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-SGV-TASA-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-MSC-BCTI
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-MSC-BCTI-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-MSC-PBTI
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-MSC-PBTI-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-MSC-BPBT
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-MSC-BPBT-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-MSC-SPBT
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-MSC-SPBT-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-COD-CVTI
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-CVTI-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-MSC-TFPR
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-MSC-TFPR-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-NUM-PREP
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-NUM-PREP-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-MSC-UTPR
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-MSC-UTPR-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-SGV-MNTO
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-SGV-MNTO-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-IND-EXPO
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-IND-EXPO-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-IND-BASE
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-IND-BASE-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-COD-SIST
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-SIST-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-COD-EVTO
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-EVTO-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
           PERFORM VAL-FRM-GLS-CICP
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 4
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-GLS-CICP-LEN IN ATE-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-ATE.
       FIN-VAL-FLD-ATE.
           EXIT.
       
       VAL-FRM-COD-VCOC SECTION.
       INI-VAL-FRM-COD-VCOC.
           IF FRM-COD-VCOC IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-VCOC IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_COD_VCOC
           IF FRM-COD-VCOC IN ATE-FLD(FRM-IFLD) > SPACES
              MOVE WSS-CT-TAB              TO TAB-COD-SIST
              MOVE WSS-CT-VLR              TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-VCOC IN ATE-FLD(FRM-IFLD)
                                           TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>             
       FIN-VAL-FRM-COD-VCOC.
           EXIT.
       
       VAL-FRM-COD-TOOC SECTION.
       INI-VAL-FRM-COD-TOOC.
           IF FRM-COD-TOOC IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-TOOC IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_COD_TOOC
           IF FRM-COD-TOOC IN ATE-FLD(FRM-IFLD) > SPACES
              MOVE WSS-CT-TAB              TO TAB-COD-SIST
              MOVE WSS-CT-TIO              TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TOOC IN ATE-FLD(FRM-IFLD)
                                           TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
       FIN-VAL-FRM-COD-TOOC.
           EXIT.
       
       VAL-FRM-COD-AOOC SECTION.
       INI-VAL-FRM-COD-AOOC.
           IF FRM-COD-AOOC IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-AOOC IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_COD_AOOC
           IF FRM-COD-AOOC IN ATE-FLD(FRM-IFLD) NOT > SPACES
                 GO TO FIN-VAL-FRM-COD-AOOC.

      *VAL-COD Valida codigo de tabla
           MOVE WSS-CT-TAB               TO TAB-COD-SIST.
           MOVE WSS-CT-AUX               TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TOOC IN ATE-FLD(FRM-IFLD)
                                         TO WSS-COD-TOOC IN WSS-VARI
           MOVE FRM-COD-AOOC IN ATE-FLD(FRM-IFLD)
                                         TO WSS-COD-AOOC IN WSS-VARI
           MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CT-CNEX OR WSS-CT-CNVG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-FRM-COD-AOOC.
           EXIT.
       
       VAL-FRM-COD-GRUP SECTION.
       INI-VAL-FRM-COD-GRUP.
           IF FRM-COD-GRUP IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-GRUP IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_COD_GRUP
           IF FRM-COD-GRUP IN ATE-FLD(FRM-IFLD) > SPACES AND
            ( FRM-COD-VCOC IN ATE-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-TOOC IN ATE-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-AOOC IN ATE-FLD(FRM-IFLD) > SPACES )
               MOVE WSS-CT-TAB     TO MSG-COD-SIST
               MOVE WSS-CT-GNVL    TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-GRUP.

           IF FRM-COD-GRUP IN ATE-FLD(FRM-IFLD) NOT > SPACES
              GO TO FIN-VAL-FRM-COD-GRUP.

           MOVE FRM-COD-GRUP IN ATE-FLD(FRM-IFLD)
                                        TO PLN-CIC-PLAN IN PLN.
           MOVE WSS-CT-8N9              TO PLN-FEC-FINI IN PLN.
           MOVE WSS-CT-6N9              TO PLN-HRA-HINI IN PLN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-VAL-FRM-COD-GRUP.
           PERFORM TAB-FIO-PLN.
           IF NOT (FIO-STAT-OKS AND
              PLN-CIC-PLAN IN PLN = FRM-COD-GRUP IN ATE-FLD(FRM-IFLD))
              MOVE WSS-CT-TAB   TO MSG-COD-SIST
              MOVE WSS-CT-PNEX  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-GRUP.

           IF PLN-MSC-STAT IN PLN NOT = WSS-CT-A
              MOVE FIO-GET-PRV TO FIO-CMND
              GO TO LUP-VAL-FRM-COD-GRUP.

      *>>>>
       FIN-VAL-FRM-COD-GRUP.
           EXIT.
       
       VAL-FRM-COD-CPTO SECTION.
       INI-VAL-FRM-COD-CPTO.
           IF FRM-COD-CPTO IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-CPTO IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_COD_CPTO
           IF FRM-COD-CPTO IN ATE-FLD(FRM-IFLD) NOT > SPACES
              GO TO FIN-VAL-FRM-COD-CPTO.

           MOVE WSS-CT-TAB               TO TAB-COD-SIST
           MOVE WSS-CT-TCP               TO TAB-COD-TTAB IN TAB
           MOVE FRM-COD-CPTO IN ATE-FLD(FRM-IFLD)
                                         TO TAB-COD-CTAB IN TAB
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CT-CNEX OR WSS-CT-CNVG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-FRM-COD-CPTO.
           EXIT.
       
       VAL-FRM-COD-SCPT SECTION.
       INI-VAL-FRM-COD-SCPT.
           IF FRM-COD-SCPT IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-SCPT IN ATE-FLD(FRM-IFLD).
       FIN-VAL-FRM-COD-SCPT.
           EXIT.
       
       VAL-FRM-GLS-CICT SECTION.
       INI-VAL-FRM-GLS-CICT.
       FIN-VAL-FRM-GLS-CICT.
           EXIT.
       
       VAL-FRM-SGV-TASA SECTION.
       INI-VAL-FRM-SGV-TASA.
       FIN-VAL-FRM-SGV-TASA.
           EXIT.
       
       VAL-FRM-MSC-BCTI SECTION.
       INI-VAL-FRM-MSC-BCTI.
           IF FRM-MSC-BCTI IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-MSC-BCTI IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_MSC_BCTI
           IF ( FRM-MSC-PBTI IN ATE-FLD(FRM-IFLD) > SPACES OR
                FRM-MSC-BPBT IN ATE-FLD(FRM-IFLD) > SPACES OR
                FRM-MSC-SPBT IN ATE-FLD(FRM-IFLD) > SPACES ) AND
                FRM-MSC-BCTI IN ATE-FLD(FRM-IFLD) NOT > SPACES

                MOVE WSS-CT-TAB   TO MSG-COD-SIST
                MOVE WSS-CT-MSCO  TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-FRM-MSC-BCTI.
           
      *VAL-IND Valida miscelaneo de tabla
             MOVE WSS-CT-COL              TO MSC-COD-SIST.
             MOVE WSS-CT-BCTI             TO MSC-COD-TMSC IN MSC.
             MOVE FRM-MSC-BCTI IN ATE-FLD(FRM-IFLD)
                                          TO MSC-COD-CMSC IN MSC.
             PERFORM VAL-IND.
      *>>>>
       FIN-VAL-FRM-MSC-BCTI.
           EXIT.
       
       VAL-FRM-MSC-PBTI SECTION.
       INI-VAL-FRM-MSC-PBTI.
           IF FRM-MSC-PBTI IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-MSC-PBTI IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_MSC_PBTI
           IF ( FRM-MSC-BCTI IN ATE-FLD(FRM-IFLD) > SPACES OR
                FRM-MSC-BPBT IN ATE-FLD(FRM-IFLD) > SPACES OR
                FRM-MSC-SPBT IN ATE-FLD(FRM-IFLD) > SPACES ) AND
                FRM-MSC-PBTI IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE WSS-CT-TAB   TO MSG-COD-SIST
              MOVE WSS-CT-PBTO  TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-MSC-PBTI.

      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-CT-COL              TO MSC-COD-SIST.
           MOVE WSS-CT-PBTI             TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-PBTI IN ATE-FLD(FRM-IFLD)
                                        TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
       FIN-VAL-FRM-MSC-PBTI.
           EXIT.
       
       VAL-FRM-MSC-BPBT SECTION.
       INI-VAL-FRM-MSC-BPBT.
           IF FRM-MSC-BPBT IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-MSC-BPBT IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_MSC_BPBT
           IF ( FRM-MSC-BCTI IN ATE-FLD(FRM-IFLD) > SPACES OR
                FRM-MSC-PBTI IN ATE-FLD(FRM-IFLD) > SPACES OR
                FRM-MSC-SPBT IN ATE-FLD(FRM-IFLD) > SPACES ) AND
                FRM-MSC-BPBT IN ATE-FLD(FRM-IFLD) NOT > SPACES
               MOVE WSS-CT-TAB   TO MSG-COD-SIST
               MOVE WSS-CT-BPBO  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-MSC-BPBT.

      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-CT-COL              TO MSC-COD-SIST.
           MOVE WSS-CT-MCTI             TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-BPBT IN ATE-FLD(FRM-IFLD)
                                       TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
       FIN-VAL-FRM-MSC-BPBT.
           EXIT.
       
       VAL-FRM-MSC-SPBT SECTION.
       INI-VAL-FRM-MSC-SPBT.
           IF FRM-MSC-SPBT IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-MSC-SPBT IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_MSC_SPBT
           IF ( FRM-MSC-BCTI IN ATE-FLD(FRM-IFLD) > SPACES OR
                FRM-MSC-PBTI IN ATE-FLD(FRM-IFLD) > SPACES OR
                FRM-MSC-BPBT IN ATE-FLD(FRM-IFLD) > SPACES ) AND
                FRM-MSC-SPBT IN ATE-FLD(FRM-IFLD) NOT > SPACES
               MOVE WSS-CT-TAB   TO MSG-COD-SIST
               MOVE WSS-CT-SPBO  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-MSC-SPBT.

      *VAL-IND Valida miscelaneo de tabla
           MOVE WSS-CT-COL              TO MSC-COD-SIST.
           MOVE WSS-CT-MCTI             TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-SPBT IN ATE-FLD(FRM-IFLD)
                                        TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
       FIN-VAL-FRM-MSC-SPBT.
           EXIT.
       
       VAL-FRM-COD-CVTI SECTION.
       INI-VAL-FRM-COD-CVTI.
           IF FRM-COD-CVTI IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-CVTI IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_COD_CVTI
           IF FRM-COD-CVTI IN ATE-FLD(FRM-IFLD) NOT > SPACES
               GO TO FIN-VAL-FRM-COD-CVTI.

      *VAL-COD Valida codigo de tabla
           MOVE WSS-CT-TAB              TO TAB-COD-SIST.
           MOVE WSS-CT-VLR              TO TAB-COD-TTAB IN TAB.
           MOVE WSS-CT-I                TO WSS-COD-TVTI.
           MOVE FRM-COD-CVTI IN ATE-FLD(FRM-IFLD)
                                        TO WSS-COD-CVTI.
           MOVE FRM-MSC-PBTI IN ATE-FLD(FRM-IFLD)
                                        TO WSS-COD-TCTI.
           MOVE WSS-COD-VCAM            TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
       FIN-VAL-FRM-COD-CVTI.
           EXIT.
       
       VAL-FRM-MSC-TFPR SECTION.
       INI-VAL-FRM-MSC-TFPR.
           IF FRM-MSC-TFPR IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-MSC-TFPR IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_MSC_TFPR
      *VAL-IND Valida miscelaneo de tabla
           IF FRM-MSC-TFPR IN ATE-FLD(FRM-IFLD) > SPACES
              MOVE WSS-CT-COL              TO MSC-COD-SIST
              MOVE WSS-CT-TFPR             TO MSC-COD-TMSC IN MSC
              MOVE FRM-MSC-TFPR IN ATE-FLD(FRM-IFLD)
                                           TO MSC-COD-CMSC IN MSC
              PERFORM VAL-IND.
      *>>>>
       FIN-VAL-FRM-MSC-TFPR.
           EXIT.
       
       VAL-FRM-NUM-PREP SECTION.
       INI-VAL-FRM-NUM-PREP.
       FIN-VAL-FRM-NUM-PREP.
           EXIT.
       
       VAL-FRM-MSC-UTPR SECTION.
       INI-VAL-FRM-MSC-UTPR.
           IF FRM-MSC-UTPR IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-MSC-UTPR IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_MSC_UTPR
           IF FRM-NUM-PREP IN ATE-FLD(FRM-IFLD) NOT > ZEROES AND
              FRM-MSC-UTPR IN ATE-FLD(FRM-IFLD)> SPACES
               MOVE WSS-CT-TAB   TO MSG-COD-SIST
               MOVE WSS-CT-UTRI  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-MSC-UTPR.

           MOVE WSS-CT-TAB              TO MSC-COD-SIST.
           MOVE WSS-CT-IPER             TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-UTPR IN ATE-FLD(FRM-IFLD)
                                        TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
       FIN-VAL-FRM-MSC-UTPR.
           EXIT.
       
       VAL-FRM-SGV-MNTO SECTION.
       INI-VAL-FRM-SGV-MNTO.
      *<<<< FRM_SGV_MNTO
           IF FRM-SGV-MNTO IN ATE-FLD(FRM-IFLD) NOT > ZEROES AND
             (FRM-COD-VCOC IN ATE-FLD(FRM-IFLD) > SPACES OR
              FRM-COD-GRUP IN ATE-FLD(FRM-IFLD) > SPACES)
              MOVE WSS-PTI-VAL-MNTO TO
                              FRM-SGV-MNTO IN ATE-FLD(FRM-IFLD).
      *>>>>
       FIN-VAL-FRM-SGV-MNTO.
           EXIT.
       
       VAL-FRM-IND-EXPO SECTION.
       INI-VAL-FRM-IND-EXPO.
           IF FRM-IND-EXPO IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-IND-EXPO IN ATE-FLD(FRM-IFLD).
       FIN-VAL-FRM-IND-EXPO.
           EXIT.
       
       VAL-FRM-IND-BASE SECTION.
       INI-VAL-FRM-IND-BASE.
           IF FRM-IND-BASE IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-IND-BASE IN ATE-FLD(FRM-IFLD).
       FIN-VAL-FRM-IND-BASE.
           EXIT.
       
       VAL-FRM-COD-SIST SECTION.
       INI-VAL-FRM-COD-SIST.
           IF FRM-COD-SIST IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-SIST IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_COD_SIST

      *VAL-COD Valida codigo de tabla
           IF FRM-COD-SIST IN ATE-FLD(FRM-IFLD) > SPACES
              MOVE WSS-CT-TAB              TO TAB-COD-SIST
              MOVE WSS-CT-SIS              TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-SIST IN ATE-FLD(FRM-IFLD)
                                           TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF (MSG-COD-MENS = WSS-CT-CNEX OR WSS-CT-CNVG)
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-FRM-COD-SIST.
           EXIT.
       
       VAL-FRM-COD-EVTO SECTION.
       INI-VAL-FRM-COD-EVTO.
           IF FRM-COD-EVTO IN ATE-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-EVTO IN ATE-FLD(FRM-IFLD).
      *<<<< FRM_COD_EVTO
      *VAL-COD Valida codigo de tabla
           IF FRM-COD-EVTO IN ATE-FLD(FRM-IFLD) > SPACES
              MOVE WSS-CT-TAB               TO TAB-COD-SIST
              MOVE WSS-CT-EVT               TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-SIST IN ATE-FLD(FRM-IFLD)
                                            TO WSS-COD-SIST IN WSS-VARI
              MOVE FRM-COD-EVTO IN ATE-FLD(FRM-IFLD)
                                            TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF (MSG-COD-MENS = WSS-CT-CNEX OR WSS-CT-CNVG)
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-FRM-COD-EVTO.
           EXIT.
       
       VAL-FRM-GLS-CICP SECTION.
       INI-VAL-FRM-GLS-CICP.
       FIN-VAL-FRM-GLS-CICP.
           EXIT.
       
       VAL-CON-FLD-ATE SECTION.
       INI-VAL-CON-FLD-ATE.
      *<<<< VAL_CON_FLD_ATE
           MOVE WSS-CT-1 TO WSS-NUM-CNT1.

       CON-VAL-CON-FLD-ATE.
           IF WSS-NUM-CNT1 > WSS-NUM-MAX-REG
              GO TO FIN-VAL-CON-FLD-ATE.

           IF (FRM-COD-TOOC IN ATE-FLD(WSS-NUM-CNT1)  > SPACES  OR
               FRM-COD-GRUP IN ATE-FLD(WSS-NUM-CNT1)  > SPACES) AND
              (FRM-COD-CPTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
               FRM-SGV-TASA IN ATE-FLD(WSS-NUM-CNT1) NOT > ZEROES  OR
               FRM-COD-SIST IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
               FRM-MSC-PBTI IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
               FRM-COD-EVTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES)
                MOVE WSS-CT-TAB     TO MSG-COD-SIST
                MOVE WSS-CT-ATEN    TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-FLD-ATE.

           IF FRM-COD-CPTO IN ATE-FLD(WSS-NUM-CNT1)     > SPACES  AND
            ((FRM-COD-TOOC IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  AND
              FRM-COD-GRUP IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES) OR
              FRM-SGV-TASA IN ATE-FLD(WSS-NUM-CNT1) NOT > ZEROES  OR
              FRM-COD-SIST IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
              FRM-MSC-PBTI IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
              FRM-COD-EVTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES)
                MOVE WSS-CT-TAB     TO MSG-COD-SIST
                MOVE WSS-CT-ATEN    TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-FLD-ATE.

           IF FRM-SGV-TASA IN ATE-FLD(WSS-NUM-CNT1)     > ZEROES  AND
             (FRM-COD-CPTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
             (FRM-COD-TOOC IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  AND
              FRM-COD-GRUP IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES) OR
              FRM-MSC-PBTI IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
              FRM-COD-SIST IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
              FRM-COD-EVTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES)
                MOVE WSS-CT-TAB     TO MSG-COD-SIST
                MOVE WSS-CT-ATEN    TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-FLD-ATE.

           IF FRM-COD-SIST IN ATE-FLD(WSS-NUM-CNT1)     > SPACES  AND
             (FRM-SGV-TASA IN ATE-FLD(WSS-NUM-CNT1) NOT > ZEROES  OR
              FRM-COD-CPTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
              FRM-MSC-PBTI IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
             (FRM-COD-TOOC IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  AND
              FRM-COD-GRUP IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES) OR
              FRM-COD-EVTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES)
                MOVE WSS-CT-TAB     TO MSG-COD-SIST
                MOVE WSS-CT-ATEN    TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-FLD-ATE.

           IF FRM-COD-EVTO IN ATE-FLD(WSS-NUM-CNT1)     > SPACES  AND
             (FRM-COD-SIST IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
              FRM-SGV-TASA IN ATE-FLD(WSS-NUM-CNT1) NOT > ZEROES  OR
              FRM-COD-CPTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
              FRM-MSC-PBTI IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
             (FRM-COD-TOOC IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  AND
              FRM-COD-GRUP IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES))
                MOVE WSS-CT-TAB     TO MSG-COD-SIST
                MOVE WSS-CT-ATEN    TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-FLD-ATE.

           IF FRM-MSC-PBTI IN ATE-FLD(WSS-NUM-CNT1)     > SPACES  AND
             (FRM-COD-EVTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
              FRM-COD-SIST IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
              FRM-SGV-TASA IN ATE-FLD(WSS-NUM-CNT1) NOT > ZEROES  OR
              FRM-COD-CPTO IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  OR
             (FRM-COD-TOOC IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES  AND
              FRM-COD-GRUP IN ATE-FLD(WSS-NUM-CNT1) NOT > SPACES))
                MOVE WSS-CT-TAB     TO MSG-COD-SIST
                MOVE WSS-CT-ATEN    TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-FLD-ATE.


           ADD WSS-CT-1 TO WSS-NUM-CNT1.
           GO TO CON-VAL-CON-FLD-ATE.

      *>>>>
       FIN-VAL-CON-FLD-ATE.
           EXIT.
       
       VAL-CON-ATE SECTION.
       INI-VAL-CON-ATE.
       FIN-VAL-CON-ATE.
           EXIT.
       
       VAL-NUM-KEY-ATE SECTION.
       INI-VAL-NUM-KEY-ATE.
           PERFORM VAL-NUM-IKY-ATE.
           PERFORM VAL-NUM-MKY-ATE.
           PERFORM VAL-NUM-AKY-ATE.
       FIN-VAL-NUM-KEY-ATE.
           EXIT.
       
       VAL-NUM-IKY-ATE SECTION.
       INI-VAL-NUM-IKY-ATE.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN ATE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN ATE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN ATE-FLD
                GO TO FIN-VAL-NUM-IKY-ATE.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-HRA-HINI.
           MOVE FRM-HRA-HINI-ALF IN ATE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-HRA-HINI IN ATE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-HRA-HINI-LEN IN ATE-FLD
                GO TO FIN-VAL-NUM-IKY-ATE.
       VAL-NUM-FRM-HRA-HTER.
           MOVE FRM-HRA-HTER-ALF IN ATE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-HRA-HTER IN ATE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-HRA-HTER-LEN IN ATE-FLD
                GO TO FIN-VAL-NUM-IKY-ATE.
       FIN-VAL-NUM-IKY-ATE.
           EXIT.
       
       VAL-NUM-MKY-ATE SECTION.
       INI-VAL-NUM-MKY-ATE.
       FIN-VAL-NUM-MKY-ATE.
           EXIT.
       
       VAL-NUM-AKY-ATE SECTION.
       INI-VAL-NUM-AKY-ATE.
       FIN-VAL-NUM-AKY-ATE.
           EXIT.
       
       VAL-NUM-FLD-ATE SECTION.
       INI-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-SGV-TASA-1.
           MOVE FRM-SGV-TASA-ALF IN ATE-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-TASA IN ATE-FLD(1)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-TASA-LEN IN ATE-FLD(1)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-SGV-TASA-2.
           MOVE FRM-SGV-TASA-ALF IN ATE-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-TASA IN ATE-FLD(2)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-TASA-LEN IN ATE-FLD(2)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-SGV-TASA-3.
           MOVE FRM-SGV-TASA-ALF IN ATE-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-TASA IN ATE-FLD(3)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-TASA-LEN IN ATE-FLD(3)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-SGV-TASA-4.
           MOVE FRM-SGV-TASA-ALF IN ATE-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-TASA IN ATE-FLD(4)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-TASA-LEN IN ATE-FLD(4)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-NUM-PREP-1.
           MOVE FRM-NUM-PREP-ALF IN ATE-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-PREP IN ATE-FLD(1)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-PREP-LEN IN ATE-FLD(1)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-NUM-PREP-2.
           MOVE FRM-NUM-PREP-ALF IN ATE-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-PREP IN ATE-FLD(2)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-PREP-LEN IN ATE-FLD(2)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-NUM-PREP-3.
           MOVE FRM-NUM-PREP-ALF IN ATE-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-PREP IN ATE-FLD(3)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-PREP-LEN IN ATE-FLD(3)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-NUM-PREP-4.
           MOVE FRM-NUM-PREP-ALF IN ATE-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-PREP IN ATE-FLD(4)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-PREP-LEN IN ATE-FLD(4)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-SGV-MNTO-1.
           MOVE FRM-SGV-MNTO-ALF IN ATE-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-MNTO IN ATE-FLD(1)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-MNTO-LEN IN ATE-FLD(1)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-SGV-MNTO-2.
           MOVE FRM-SGV-MNTO-ALF IN ATE-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-MNTO IN ATE-FLD(2)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-MNTO-LEN IN ATE-FLD(2)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-SGV-MNTO-3.
           MOVE FRM-SGV-MNTO-ALF IN ATE-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-MNTO IN ATE-FLD(3)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-MNTO-LEN IN ATE-FLD(3)
                GO TO FIN-VAL-NUM-FLD-ATE.
       VAL-NUM-FRM-SGV-MNTO-4.
           MOVE FRM-SGV-MNTO-ALF IN ATE-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 13 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-SGV-MNTO IN ATE-FLD(4)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-MNTO-LEN IN ATE-FLD(4)
                GO TO FIN-VAL-NUM-FLD-ATE.
       FIN-VAL-NUM-FLD-ATE.
           EXIT.
       
       EDT-KEY-ATE SECTION.
       INI-EDT-KEY-ATE.
           PERFORM EDT-IKY-ATE.
           PERFORM EDT-MKY-ATE.
           PERFORM EDT-AKY-ATE.
       FIN-EDT-KEY-ATE.
           EXIT.
       
       EDT-IKY-ATE SECTION.
       INI-EDT-IKY-ATE.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN ATE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN ATE-FLD
                GO TO FIN-EDT-IKY-ATE.
           MOVE DBC-NUM-ICLI IN ATE-FLD TO
                DBC-NUM-ICLI-EDT IN ATE-EDT.
           MOVE DBC-NUM-ICLI-EDT IN ATE-EDT TO
                DBC-NUM-ICLI-ALF IN ATE-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-HRA-HINI-LEN IN ATE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-HRA-HINI-LEN IN ATE-FLD
                GO TO FIN-EDT-IKY-ATE.
           MOVE FRM-HRA-HINI IN ATE-FLD TO FRM-HRA-HINI-EDT IN ATE-EDT.
           MOVE FRM-HRA-HINI-EDT IN ATE-EDT TO 
                FRM-HRA-HINI-ALF IN ATE-FLD.
           IF FRM-HRA-HTER-LEN IN ATE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-HRA-HTER-LEN IN ATE-FLD
                GO TO FIN-EDT-IKY-ATE.
           MOVE FRM-HRA-HTER IN ATE-FLD TO FRM-HRA-HTER-EDT IN ATE-EDT.
           MOVE FRM-HRA-HTER-EDT IN ATE-EDT TO 
                FRM-HRA-HTER-ALF IN ATE-FLD.
       FIN-EDT-IKY-ATE.
           EXIT.
       
       EDT-MKY-ATE SECTION.
       INI-EDT-MKY-ATE.
       FIN-EDT-MKY-ATE.
           EXIT.
       
       EDT-AKY-ATE SECTION.
       INI-EDT-AKY-ATE.
       FIN-EDT-AKY-ATE.
           EXIT.
       
       EDT-FLD-ATE SECTION.
       INI-EDT-FLD-ATE.
           IF FRM-SGV-TASA-LEN IN ATE-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-TASA-LEN IN ATE-FLD(1)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-SGV-TASA IN ATE-FLD(1) TO 
                FRM-SGV-TASA-EDT IN ATE-EDT.
           MOVE FRM-SGV-TASA-EDT IN ATE-EDT TO 
                FRM-SGV-TASA-ALF IN ATE-FLD(1).
           IF FRM-SGV-TASA-LEN IN ATE-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-TASA-LEN IN ATE-FLD(2)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-SGV-TASA IN ATE-FLD(2) TO 
                FRM-SGV-TASA-EDT IN ATE-EDT.
           MOVE FRM-SGV-TASA-EDT IN ATE-EDT TO 
                FRM-SGV-TASA-ALF IN ATE-FLD(2).
           IF FRM-SGV-TASA-LEN IN ATE-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-TASA-LEN IN ATE-FLD(3)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-SGV-TASA IN ATE-FLD(3) TO 
                FRM-SGV-TASA-EDT IN ATE-EDT.
           MOVE FRM-SGV-TASA-EDT IN ATE-EDT TO 
                FRM-SGV-TASA-ALF IN ATE-FLD(3).
           IF FRM-SGV-TASA-LEN IN ATE-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-TASA-LEN IN ATE-FLD(4)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-SGV-TASA IN ATE-FLD(4) TO 
                FRM-SGV-TASA-EDT IN ATE-EDT.
           MOVE FRM-SGV-TASA-EDT IN ATE-EDT TO 
                FRM-SGV-TASA-ALF IN ATE-FLD(4).
           IF FRM-NUM-PREP-LEN IN ATE-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-PREP-LEN IN ATE-FLD(1)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-NUM-PREP IN ATE-FLD(1) TO 
                FRM-NUM-PREP-EDT IN ATE-EDT.
           MOVE FRM-NUM-PREP-EDT IN ATE-EDT TO 
                FRM-NUM-PREP-ALF IN ATE-FLD(1).
           IF FRM-NUM-PREP-LEN IN ATE-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-PREP-LEN IN ATE-FLD(2)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-NUM-PREP IN ATE-FLD(2) TO 
                FRM-NUM-PREP-EDT IN ATE-EDT.
           MOVE FRM-NUM-PREP-EDT IN ATE-EDT TO 
                FRM-NUM-PREP-ALF IN ATE-FLD(2).
           IF FRM-NUM-PREP-LEN IN ATE-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-PREP-LEN IN ATE-FLD(3)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-NUM-PREP IN ATE-FLD(3) TO 
                FRM-NUM-PREP-EDT IN ATE-EDT.
           MOVE FRM-NUM-PREP-EDT IN ATE-EDT TO 
                FRM-NUM-PREP-ALF IN ATE-FLD(3).
           IF FRM-NUM-PREP-LEN IN ATE-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-PREP-LEN IN ATE-FLD(4)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-NUM-PREP IN ATE-FLD(4) TO 
                FRM-NUM-PREP-EDT IN ATE-EDT.
           MOVE FRM-NUM-PREP-EDT IN ATE-EDT TO 
                FRM-NUM-PREP-ALF IN ATE-FLD(4).
           IF FRM-SGV-MNTO-LEN IN ATE-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-MNTO-LEN IN ATE-FLD(1)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-SGV-MNTO IN ATE-FLD(1) TO 
                FRM-SGV-MNTO-EDT IN ATE-EDT.
           MOVE FRM-SGV-MNTO-EDT IN ATE-EDT TO 
                FRM-SGV-MNTO-ALF IN ATE-FLD(1).
           IF FRM-SGV-MNTO-LEN IN ATE-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-MNTO-LEN IN ATE-FLD(2)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-SGV-MNTO IN ATE-FLD(2) TO 
                FRM-SGV-MNTO-EDT IN ATE-EDT.
           MOVE FRM-SGV-MNTO-EDT IN ATE-EDT TO 
                FRM-SGV-MNTO-ALF IN ATE-FLD(2).
           IF FRM-SGV-MNTO-LEN IN ATE-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-MNTO-LEN IN ATE-FLD(3)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-SGV-MNTO IN ATE-FLD(3) TO 
                FRM-SGV-MNTO-EDT IN ATE-EDT.
           MOVE FRM-SGV-MNTO-EDT IN ATE-EDT TO 
                FRM-SGV-MNTO-ALF IN ATE-FLD(3).
           IF FRM-SGV-MNTO-LEN IN ATE-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-MNTO-LEN IN ATE-FLD(4)
                GO TO FIN-EDT-FLD-ATE.
           MOVE FRM-SGV-MNTO IN ATE-FLD(4) TO 
                FRM-SGV-MNTO-EDT IN ATE-EDT.
           MOVE FRM-SGV-MNTO-EDT IN ATE-EDT TO 
                FRM-SGV-MNTO-ALF IN ATE-FLD(4).
       FIN-EDT-FLD-ATE.
           EXIT.
