      *
      * MC2BUSFC
      * Version 3.0.1 Nov-2005
      * 22-Feb-19 12:59 PM
      *
       SET-TAG-MC2BUSFC SECTION.
       INI-SET-TAG-MC2BUSFC.
           MOVE
           '<IDNMOD NOM=$MC2BUSFC$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$22-Feb-19 12:59 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-MC2BUSFC.
           EXIT.
           
       RET-ALL-SFC SECTION.
       INI-RET-ALL-SFC.
           PERFORM KEY-ALL-SFC.
           PERFORM RET-SFC-SFC.
           PERFORM RET-DBC-SFC.
       FIN-RET-ALL-SFC.
           EXIT.
       
       RET-SFC-SFC SECTION.
       INI-RET-SFC-SFC.
           MOVE SFC-MSC-STAT IN SFC-FLD TO SFC-MSC-STAT IN SFC.
           MOVE SFC-COD-APRA IN SFC-FLD TO SFC-COD-APRA IN SFC.
           MOVE SFC-NUM-NAPR IN SFC-FLD TO SFC-NUM-NAPR IN SFC.
           MOVE SFC-COD-MAIL IN SFC-FLD TO SFC-COD-MAIL IN SFC.
           MOVE SFC-COD-RAPR IN SFC-FLD TO SFC-COD-RAPR IN SFC.
           MOVE SFC-COD-USER IN SFC-FLD TO SFC-COD-USER IN SFC.
           MOVE SFC-COD-EJEC IN SFC-FLD TO SFC-COD-EJEC IN SFC.
           MOVE SFC-COD-OFIC IN SFC-FLD TO SFC-COD-OFIC IN SFC.
           MOVE SFC-COD-REGN IN SFC-FLD TO SFC-COD-REGN IN SFC.
           MOVE SFC-COD-BANC IN SFC-FLD TO SFC-COD-BANC IN SFC.
           MOVE SFC-SGV-MNTO IN SFC-FLD TO SFC-SGV-MNTO IN SFC.
           MOVE SFC-IND-MNTO IN SFC-FLD TO SFC-IND-MNTO IN SFC.
           MOVE SFC-NUM-PLZO IN SFC-FLD TO SFC-NUM-PLZO IN SFC.
           MOVE SFC-IND-PLZO IN SFC-FLD TO SFC-IND-PLZO IN SFC.
           MOVE SFC-SGV-TMPR IN SFC-FLD TO SFC-SGV-TMPR IN SFC.
           MOVE SFC-SGV-TMSF IN SFC-FLD TO SFC-SGV-TMSF IN SFC.
           MOVE SFC-IND-TAMO IN SFC-FLD TO SFC-IND-TAMO IN SFC.
           MOVE SFC-SGV-SPPR IN SFC-FLD TO SFC-SGV-SPPR IN SFC.
           MOVE SFC-SGV-SPSF IN SFC-FLD TO SFC-SGV-SPSF IN SFC.
           MOVE SFC-IND-SPRD IN SFC-FLD TO SFC-IND-SPRD IN SFC.
           MOVE SFC-SGV-VARI IN SFC-FLD TO SFC-SGV-VARI IN SFC.
           MOVE SFC-SGV-VLRG IN SFC-FLD TO SFC-SGV-VLRG IN SFC.
           MOVE SFC-SGV-VLPI IN SFC-FLD TO SFC-SGV-VLPI IN SFC.
           MOVE SFC-SGV-VLPE IN SFC-FLD TO SFC-SGV-VLPE IN SFC.
           MOVE SFC-GLS-DES1 IN SFC-FLD TO SFC-GLS-DES1 IN SFC.
           MOVE SFC-GLS-DES2 IN SFC-FLD TO SFC-GLS-DES2 IN SFC.
       FIN-RET-SFC-SFC.
           EXIT.
       
       RET-DBC-SFC SECTION.
       INI-RET-DBC-SFC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN SFC-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN SFC-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN SFC-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN SFC-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
      *<<<<
           MOVE SCR-CIC-ICLI            TO SFC-CIC-ICLI IN SFC.
      *>>>>
       FIN-RET-DBC-SFC.
           EXIT.
       
       KEY-ALL-SFC SECTION.
       INI-KEY-ALL-SFC.
           PERFORM KEY-SFC-SFC.
           PERFORM KEY-DBC-SFC.
       FIN-KEY-ALL-SFC.
           EXIT.
       
       KEY-SFC-SFC SECTION.
       INI-KEY-SFC-SFC.
           MOVE SFC-CAI-IOPE IN SFC-FLD TO SFC-CAI-IOPE IN SFC.
           MOVE SFC-IIC-IOPE IN SFC-FLD TO SFC-IIC-IOPE IN SFC.
           MOVE SFC-EXT-IOPE IN SFC-FLD TO SFC-EXT-IOPE IN SFC.
           MOVE SFC-COD-SIST IN SFC-FLD TO SFC-COD-SIST IN SFC.
           MOVE SFC-COD-EVEN IN SFC-FLD TO SFC-COD-EVEN IN SFC.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE SFC-NUM-DINI IN SFC-FLD TO SFC-NUM-DINI IN SFC.
           MOVE SFC-NUM-MINI IN SFC-FLD TO SFC-NUM-MINI IN SFC.
           MOVE SFC-NUM-SINI IN SFC-FLD TO SFC-NUM-SINI IN SFC.
           MOVE SFC-NUM-AINI IN SFC-FLD TO SFC-NUM-AINI IN SFC.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE SFC-HRA-HINI IN SFC-FLD TO SFC-HRA-HINI IN SFC.
       FIN-KEY-SFC-SFC.
           EXIT.
       
       KEY-DBC-SFC SECTION.
       INI-KEY-DBC-SFC.
       FIN-KEY-DBC-SFC.
           EXIT.
       
       SCR-CLRA-SFC SECTION.
       INI-SCR-CLRA-SFC.
           PERFORM CLR-KEY-SFC.
           PERFORM CLR-FLD-SFC.
       FIN-SCR-CLRA-SFC.
           EXIT.
       
       CLR-KEY-SFC SECTION.
       INI-CLR-KEY-SFC.
           MOVE SPACES TO SFC-CAI-IOPE IN SFC-FLD.
           MOVE SPACES TO SFC-IIC-IOPE IN SFC-FLD.
           MOVE SPACES TO SFC-EXT-IOPE IN SFC-FLD.
           MOVE SPACES TO SFC-COD-SIST IN SFC-FLD.
           MOVE SPACES TO SFC-COD-EVEN IN SFC-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO SFC-FEC-FINI IN SFC-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO SFC-HRA-HINI IN SFC-FLD.
       FIN-CLR-KEY-SFC.
           EXIT.
       
       CLR-FLD-SFC SECTION.
       INI-CLR-FLD-SFC.
           MOVE SPACES TO FRM-GLS-SIST IN SFC-FLD.
           MOVE SPACES TO FRM-GLS-EVEN IN SFC-FLD.
           MOVE SPACES TO FRM-GLS-MNTO IN SFC-FLD.
           MOVE SPACES TO FRM-GLS-PLZO IN SFC-FLD.
           MOVE SPACES TO FRM-GLS-TAMO IN SFC-FLD.
           MOVE SPACES TO FRM-GLS-SPRD IN SFC-FLD.
           PERFORM CLR-SFC-SFC.
           PERFORM CLR-DBC-SFC.
       FIN-CLR-FLD-SFC.
           EXIT.
       
       CLR-SFC-SFC SECTION.
       INI-CLR-SFC-SFC.
           MOVE SPACES TO SFC-MSC-STAT IN SFC-FLD.
           MOVE SPACES TO SFC-COD-APRA IN SFC-FLD.
           MOVE ZEROES TO SFC-NUM-NAPR IN SFC-FLD.
           MOVE SPACES TO SFC-COD-MAIL IN SFC-FLD.
           MOVE SPACES TO SFC-COD-RAPR IN SFC-FLD.
           MOVE SPACES TO SFC-COD-USER IN SFC-FLD.
           MOVE SPACES TO SFC-COD-EJEC IN SFC-FLD.
           MOVE SPACES TO SFC-COD-OFIC IN SFC-FLD.
           MOVE SPACES TO SFC-COD-REGN IN SFC-FLD.
           MOVE SPACES TO SFC-COD-BANC IN SFC-FLD.
           MOVE ZEROES TO SFC-SGV-MNTO IN SFC-FLD.
           MOVE SPACES TO SFC-IND-MNTO IN SFC-FLD.
           MOVE ZEROES TO SFC-NUM-PLZO IN SFC-FLD.
           MOVE SPACES TO SFC-IND-PLZO IN SFC-FLD.
           MOVE ZEROES TO SFC-SGV-TMPR IN SFC-FLD.
           MOVE ZEROES TO SFC-SGV-TMSF IN SFC-FLD.
           MOVE SPACES TO SFC-IND-TAMO IN SFC-FLD.
           MOVE ZEROES TO SFC-SGV-SPPR IN SFC-FLD.
           MOVE ZEROES TO SFC-SGV-SPSF IN SFC-FLD.
           MOVE SPACES TO SFC-IND-SPRD IN SFC-FLD.
           MOVE ZEROES TO SFC-SGV-VARI IN SFC-FLD.
           MOVE ZEROES TO SFC-SGV-VLRG IN SFC-FLD.
           MOVE ZEROES TO SFC-SGV-VLPI IN SFC-FLD.
           MOVE ZEROES TO SFC-SGV-VLPE IN SFC-FLD.
           MOVE SPACES TO SFC-GLS-DES1 IN SFC-FLD.
           MOVE SPACES TO SFC-GLS-DES2 IN SFC-FLD.
       FIN-CLR-SFC-SFC.
           EXIT.
       
       CLR-DBC-SFC SECTION.
       INI-CLR-DBC-SFC.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN SFC-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN SFC-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN SFC-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN SFC-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-DBC-SFC.
           EXIT.
       
       FST-KEY-SFC SECTION.
       INI-FST-KEY-SFC.
           MOVE -1 TO SFC-CAI-IOPE-LEN IN SFC-FLD.
       FIN-FST-KEY-SFC.
           EXIT.
       
       FST-FLD-SFC SECTION.
       INI-FST-FLD-SFC.
      *<<<<
           IF SCR-CMND = 'APR' OR 'RCH'
           MOVE -1 TO SFC-COD-RAPR-LEN IN SFC-FLD
           GO TO FIN-FST-FLD-SFC.

           MOVE -1 TO SFC-COD-APRA-LEN IN SFC-FLD.
           GO TO FIN-FST-FLD-SFC.
      *>>>>
           MOVE -1 TO SFC-MSC-STAT-LEN IN SFC-FLD.
       FIN-FST-FLD-SFC.
           EXIT.
       
       PRO-KEY-SFC SECTION.
       INI-PRO-KEY-SFC.
           PERFORM PRO-MKY-SFC.
       FIN-PRO-KEY-SFC.
           EXIT.
       
       PRO-MKY-SFC SECTION.
       INI-PRO-MKY-SFC.
       FIN-PRO-MKY-SFC.
           EXIT.
       
       PRO-FLD-SFC SECTION.
       INI-PRO-FLD-SFC.
           PERFORM PRO-SFC-SFC.
           PERFORM PRO-DBC-SFC.
       FIN-PRO-FLD-SFC.
           EXIT.
       
       PRO-SFC-SFC SECTION.
       INI-PRO-SFC-SFC.
           MOVE FRM-CPIM-AEY TO SFC-MSC-STAT-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-COD-APRA-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-NUM-NAPR-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-COD-MAIL-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-COD-RAPR-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-COD-USER-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-COD-EJEC-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-COD-OFIC-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-COD-REGN-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-COD-BANC-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-SGV-MNTO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-IND-MNTO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-NUM-PLZO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-IND-PLZO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-SGV-TMPR-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-SGV-TMSF-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-IND-TAMO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-SGV-SPPR-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-SGV-SPSF-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-IND-SPRD-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-SGV-VARI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-SGV-VLRG-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-SGV-VLPI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-SGV-VLPE-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-GLS-DES1-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO SFC-GLS-DES2-ATR IN SFC-FLD.
       FIN-PRO-SFC-SFC.
           EXIT.
       
       PRO-DBC-SFC SECTION.
       INI-PRO-DBC-SFC.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN SFC-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-DBC-SFC.
           EXIT.
       
       UNP-KEY-SFC SECTION.
       INI-UNP-KEY-SFC.
           PERFORM UNP-IKY-SFC.
           PERFORM UNP-AKY-SFC.
           PERFORM UNP-MKY-SFC.
       FIN-UNP-KEY-SFC.
           EXIT.
       
       UNP-IKY-SFC SECTION.
       INI-UNP-IKY-SFC.
           MOVE FRM-CPIM-UBY TO SFC-CAI-IOPE-ATR.
           MOVE FRM-CPIM-UBY TO SFC-IIC-IOPE-ATR.
           MOVE FRM-CPIM-UBY TO SFC-EXT-IOPE-ATR.
           MOVE FRM-CPIM-UBY TO SFC-COD-SIST-ATR.
           MOVE FRM-CPIM-UBY TO SFC-COD-EVEN-ATR.
           MOVE FRM-CPIM-UBY TO SFC-FEC-FINI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-HRA-HINI-ATR.
       FIN-UNP-IKY-SFC.
           EXIT.
       
       UNP-MKY-SFC SECTION.
       INI-UNP-MKY-SFC.
       FIN-UNP-MKY-SFC.
           EXIT.
       
       UNP-AKY-SFC SECTION.
       INI-UNP-AKY-SFC.
       FIN-UNP-AKY-SFC.
           EXIT.
       
       UNP-FLD-SFC SECTION.
       INI-UNP-FLD-SFC.
           PERFORM UNP-SFC-SFC.
           PERFORM UNP-DBC-SFC.
       FIN-UNP-FLD-SFC.
           EXIT.
       
       UNP-SFC-SFC SECTION.
       INI-UNP-SFC-SFC.
           MOVE FRM-CPIM-UBY TO SFC-MSC-STAT-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-COD-APRA-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-NUM-NAPR-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-COD-MAIL-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-COD-RAPR-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-COD-USER-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-COD-EJEC-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-COD-OFIC-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-COD-REGN-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-COD-BANC-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-SGV-MNTO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-IND-MNTO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-NUM-PLZO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-IND-PLZO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-SGV-TMPR-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-SGV-TMSF-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-IND-TAMO-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-SGV-SPPR-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-SGV-SPSF-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-IND-SPRD-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-SGV-VARI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-SGV-VLRG-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-SGV-VLPI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-SGV-VLPE-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-GLS-DES1-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO SFC-GLS-DES2-ATR IN SFC-FLD.
      *<<<<
           MOVE FRM-CPIM-AEY TO SFC-MSC-STAT-ATR IN SFC-FLD.
           IF SCR-CMND = 'APR' OR 'RCH'
              MOVE FRM-CPIM-AEY TO SFC-MSC-STAT-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-APRA-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-NUM-NAPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-MAIL-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-COD-RAPR-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-COD-USER-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-EJEC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-OFIC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-REGN-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-BANC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-MNTO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-MNTO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-NUM-PLZO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-PLZO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-TMPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-TMSF-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-TAMO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-SPPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-SPSF-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-SPRD-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VARI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VLRG-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VLPI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VLPE-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-GLS-DES1-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-GLS-DES2-ATR IN SFC-FLD
              GO TO FIN-UNP-SFC-SFC.
           IF SCR-CMND = 'ING' OR 'MOD'
              MOVE FRM-CPIM-AEY TO SFC-MSC-STAT-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-COD-APRA-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-NUM-NAPR-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-COD-MAIL-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-RAPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-USER-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-EJEC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-OFIC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-REGN-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-BANC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-MNTO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-MNTO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-NUM-PLZO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-PLZO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-TMPR-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-SGV-TMSF-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-TAMO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-SPPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-SPSF-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-SPRD-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VARI-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-SGV-VLRG-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-SGV-VLPI-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-SGV-VLPE-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-GLS-DES1-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-GLS-DES2-ATR IN SFC-FLD
              GO TO FIN-UNP-SFC-SFC.
      *>>>>
       FIN-UNP-SFC-SFC.
           EXIT.
       
       UNP-DBC-SFC SECTION.
       INI-UNP-DBC-SFC.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN SFC-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN SFC-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
      *<<<<
           IF SCR-CMND = 'APR' OR 'RCH' OR 'ING' OR 'MOD'
              MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN SFC-FLD
              GO TO FIN-UNP-DBC-SFC.
      *>>>>
       FIN-UNP-DBC-SFC.
           EXIT.
       
       VAL-MKY-SFC SECTION.
       INI-VAL-MKY-SFC.
       FIN-VAL-MKY-SFC.
           EXIT.
       
       VAL-FLD-SFC SECTION.
       INI-VAL-FLD-SFC.
           PERFORM VAL-FRM-GLS-SIST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SIST-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-FRM-GLS-EVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-EVEN-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-MSC-STAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-MSC-STAT-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-COD-APRA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-COD-APRA-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-NUM-NAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-NUM-NAPR-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-COD-MAIL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-COD-MAIL-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-COD-RAPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-COD-RAPR-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-COD-USER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-COD-USER-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-COD-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-COD-EJEC-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-COD-OFIC-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-COD-REGN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-COD-REGN-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-COD-BANC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-COD-BANC-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-SFC-SGV-MNTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-SGV-MNTO-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-IND-MNTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-IND-MNTO-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-FRM-GLS-MNTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-MNTO-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-NUM-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-NUM-PLZO-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-IND-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-IND-PLZO-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-FRM-GLS-PLZO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PLZO-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-SGV-TMPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-SGV-TMPR-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-SGV-TMSF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-SGV-TMSF-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-IND-TAMO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-IND-TAMO-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-FRM-GLS-TAMO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-TAMO-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-SGV-SPPR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-SGV-SPPR-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-SGV-SPSF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-SGV-SPSF-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-IND-SPRD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-IND-SPRD-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-FRM-GLS-SPRD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-SPRD-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-SGV-VARI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-SGV-VARI-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-SGV-VLRG.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-SGV-VLRG-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-SGV-VLPI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-SGV-VLPI-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-SGV-VLPE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-SGV-VLPE-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-GLS-DES1.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-GLS-DES1-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
           PERFORM VAL-SFC-GLS-DES2.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO SFC-GLS-DES2-LEN IN SFC-FLD
                GO TO FIN-VAL-FLD-SFC.
       FIN-VAL-FLD-SFC.
           EXIT.
       
       VAL-FRM-GLS-SIST SECTION.
       INI-VAL-FRM-GLS-SIST.
       FIN-VAL-FRM-GLS-SIST.
           EXIT.
       
       VAL-FRM-GLS-EVEN SECTION.
       INI-VAL-FRM-GLS-EVEN.
       FIN-VAL-FRM-GLS-EVEN.
           EXIT.
       
       VAL-SFC-MSC-STAT SECTION.
       INI-VAL-SFC-MSC-STAT.
           IF SFC-MSC-STAT IN SFC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SFC-MSC-STAT.
      *<<<< SFC_MSC_STAT
      *>>>>
       FIN-VAL-SFC-MSC-STAT.
           EXIT.
       
       VAL-SFC-COD-APRA SECTION.
       INI-VAL-SFC-COD-APRA.
           IF SFC-COD-APRA IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-COD-APRA IN SFC-FLD.
      *<<<< SFC_COD_APRA
           IF SFC-COD-APRA IN SFC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SFC-COD-APRA.
           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE 'RXF'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-APRA IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-SFC-COD-APRA.
      *>>>>
       FIN-VAL-SFC-COD-APRA.
           EXIT.
       
       VAL-SFC-NUM-NAPR SECTION.
       INI-VAL-SFC-NUM-NAPR.
       FIN-VAL-SFC-NUM-NAPR.
           EXIT.
       
       VAL-SFC-COD-MAIL SECTION.
       INI-VAL-SFC-COD-MAIL.
           IF SFC-COD-MAIL IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-COD-MAIL IN SFC-FLD.
       FIN-VAL-SFC-COD-MAIL.
           EXIT.
       
       VAL-SFC-COD-RAPR SECTION.
       INI-VAL-SFC-COD-RAPR.
           IF SFC-COD-RAPR IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-COD-RAPR IN SFC-FLD.
      *<<<< SFC_COD_RAPR
           IF (SFC-COD-RAPR IN SFC-FLD NOT > SPACES AND
              (SCR-CMND = 'APR' OR 'RCH'))
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'SFCRAPR  OBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-SFC-COD-RAPR.

           IF SFC-COD-RAPR IN SFC-FLD > SPACES
              MOVE 'MC2'                   TO TAB-COD-SIST
              MOVE 'RDF'                   TO TAB-COD-TTAB IN TAB
              MOVE SFC-COD-RAPR IN SFC-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-SFC-COD-RAPR.
      *>>>>
       FIN-VAL-SFC-COD-RAPR.
           EXIT.
       
       VAL-SFC-COD-USER SECTION.
       INI-VAL-SFC-COD-USER.
           IF SFC-COD-USER IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-COD-USER IN SFC-FLD.
      *<<<< SFC_COD_USER
           IF (SFC-COD-USER IN SFC-FLD NOT > SPACES AND
              (SCR-CMND = 'APR' OR 'RCH'))
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'SFCUSER  OBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-SFC-COD-USER.

      *VAL-TDU Valida Tipo de Usuario
           IF SFC-COD-USER IN SFC-FLD > SPACES
              MOVE 'USR '                  TO USR-COD-TTAB IN USR
              MOVE SFC-COD-USER IN SFC-FLD TO USR-COD-USER IN USR
              PERFORM VAL-TDU
              IF MSG-COD-MENS > SPACES
      *PVG INI 26-JUN-2015
                 MOVE 'EJC '                  TO USR-COD-TTAB IN USR
                 MOVE SFC-COD-USER IN SFC-FLD TO USR-COD-USER IN USR
                 PERFORM VAL-TDU
                 IF MSG-COD-MENS > SPACES
      *PVG FIN 26-JUN-2015
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    GO TO FIN-VAL-SFC-COD-USER.
      *>>>>
       FIN-VAL-SFC-COD-USER.
           EXIT.
       
       VAL-SFC-COD-EJEC SECTION.
       INI-VAL-SFC-COD-EJEC.
           IF (SFC-COD-EJEC IN SFC-FLD NOT > SPACES AND
               SCR-COD-RMOC IN SCR-VARI    > SPACES)
               MOVE SCR-COD-RMOC IN SCR-VARI TO
                    SFC-COD-EJEC IN SFC-FLD.

           IF SFC-COD-EJEC IN SFC-FLD NOT > SPACES
              PERFORM ERR-GLS
              MOVE FRM-CPIM-UBY TO SFC-COD-EJEC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-EJEC.

      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '                  TO USR-COD-TTAB IN USR.
           MOVE SFC-COD-EJEC IN SFC-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-COD-EJEC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-EJEC.
           MOVE USR-COD-BNCA IN USR TO WSS-COD-BEJC IN WSS-VARI.

           MOVE USR-COD-OFUS IN USR TO WSS-COD-OFUS IN WSS-VARI.
           MOVE USR-COD-REGL IN USR TO WSS-COD-REGL IN WSS-VARI.
           MOVE USR-COD-BNCA IN USR TO WSS-COD-BNCA IN WSS-VARI.

           GO TO FIN-VAL-SFC-COD-EJEC.
           IF SFC-COD-EJEC IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-COD-EJEC IN SFC-FLD.
       FIN-VAL-SFC-COD-EJEC.
           EXIT.
       
       VAL-SFC-COD-OFIC SECTION.
       INI-VAL-SFC-COD-OFIC.
           IF (SFC-COD-OFIC IN SFC-FLD NOT > SPACES AND
               WSS-COD-OFUS IN WSS-VARI    > SPACES)
               MOVE WSS-COD-OFUS IN WSS-VARI TO
                    SFC-COD-OFIC IN SFC-FLD.

           IF SFC-COD-OFIC IN SFC-FLD NOT > SPACES
              PERFORM ERR-GLS
              MOVE FRM-CPIM-UBY TO SFC-COD-OFIC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-OFIC.

           MOVE SFC-COD-OFIC IN SFC-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-COD-OFIC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-OFIC.
           GO TO FIN-VAL-SFC-COD-OFIC.
           IF SFC-COD-OFIC IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-COD-OFIC IN SFC-FLD.
       FIN-VAL-SFC-COD-OFIC.
           EXIT.
       
       VAL-SFC-COD-REGN SECTION.
       INI-VAL-SFC-COD-REGN.
           IF SFC-COD-REGN IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-COD-REGN IN SFC-FLD.
      *<<<< SFC_COD_REGN
           IF (SFC-COD-REGN IN SFC-FLD NOT > SPACES AND
               WSS-COD-REGL IN WSS-VARI    > SPACES)
               MOVE WSS-COD-REGL IN WSS-VARI TO
                    SFC-COD-REGN IN SFC-FLD.

           IF SFC-COD-REGN IN SFC-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'RGL'                   TO TAB-COD-TTAB IN TAB
              MOVE SFC-COD-REGN IN SFC-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE FRM-CPIM-UBY TO SFC-COD-REGN-ATR IN SFC-FLD
                 GO TO FIN-VAL-SFC-COD-REGN.
      *>>>>
       FIN-VAL-SFC-COD-REGN.
           EXIT.
       
       VAL-SFC-COD-BANC SECTION.
       INI-VAL-SFC-COD-BANC.
           IF SFC-COD-BANC IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-COD-BANC IN SFC-FLD.
      *<<<< SFC_COD_BANC
           IF SFC-COD-BANC IN SFC-FLD NOT > SPACES AND
              SCR-COD-BANC IN SCR-VARI    > SPACES
              MOVE SCR-COD-BANC IN SCR-VARI TO
                   SFC-COD-BANC IN SFC-FLD.

           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE 'AGB'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-BANC IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-COD-BANC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-BANC.
      *>>>>
       FIN-VAL-SFC-COD-BANC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.

           IF DBC-NUM-ICLI IN SFC-FLD > ZEROES OR
              DBC-VRF-ICLI IN SFC-FLD > SPACES OR
              DBC-IND-ICLI IN SFC-FLD > SPACES OR
              DBC-GLS-ICLI IN SFC-FLD > SPACES
              GO TO FIN-VAL-DBC-NUM-ICLI.
           IF DBC-NUM-ICLI IN SFC-FLD NOT > ZEROES AND
              DBC-VRF-ICLI IN SFC-FLD NOT > SPACES AND
              DBC-IND-ICLI IN SFC-FLD NOT > SPACES AND
              DBC-GLS-ICLI IN SFC-FLD NOT > SPACES

              MOVE SCR-NUM-ICLI IN SCR-VARI TO DBC-NUM-ICLI IN SFC-FLD
              MOVE SCR-VRF-ICLI IN SCR-VARI TO DBC-VRF-ICLI IN SFC-FLD
              MOVE SCR-IND-ICLI IN SCR-VARI TO DBC-IND-ICLI IN SFC-FLD
              MOVE SCR-GLS-ICLI IN SCR-VARI TO DBC-GLS-ICLI IN SFC-FLD.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN SFC-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN SFC-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN SFC-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN SFC-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<<
           MOVE IDC-NUM-RUTV TO DBC-NUM-ICLI IN SFC-FLD.
           MOVE IDC-VRF-RUTV TO DBC-VRF-ICLI IN SFC-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR-CLR
              MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN SFC-FLD
               GO TO FIN-VAL-DBC-VRF-ICLI.

           MOVE DBC-NUM-ICLI IN SFC-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN SFC-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN SFC-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN SFC-FLD
               GO TO FIN-VAL-DBC-VRF-ICLI.

           MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN SFC-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN SFC-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN SFC-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN SFC-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN SFC-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN SFC-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN SFC-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN SFC-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-SFC-SGV-MNTO SECTION.
       INI-VAL-SFC-SGV-MNTO.
      *<<<< SFC_SGV_MNTO
           IF SFC-SGV-MNTO IN SFC-FLD NOT > ZEROES AND
              SCR-VAL-CRED IN SCR-VARI    > ZEROES
              MOVE SCR-VAL-CRED IN SCR-VARI TO
                   SFC-SGV-MNTO IN SFC-FLD.
      *>>>>
       FIN-VAL-SFC-SGV-MNTO.
           EXIT.
       
       VAL-SFC-IND-MNTO SECTION.
       INI-VAL-SFC-IND-MNTO.
           IF SFC-IND-MNTO IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-IND-MNTO IN SFC-FLD.
      *<<<< SFC_IND_MNTO
           IF SFC-IND-MNTO IN SFC-FLD NOT > SPACES AND
              SCR-COD-VCOC IN SCR-VARI    > SPACES
              MOVE SCR-COD-VCOC IN SCR-VARI TO
                   SFC-IND-MNTO IN SFC-FLD.

           IF SFC-IND-MNTO IN SFC-FLD NOT > SPACES
              MOVE SPACES       TO FRM-GLS-MNTO IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-MNTO.

           MOVE SFC-IND-MNTO IN SFC-FLD TO SFC-IND-MNTO IN SFC.
           IF NOT (SFC-MSC-TVOC IN SFC = '0' OR  '1')
              MOVE 'MC2' TO MSG-COD-SIST
              MOVE 'INDMNTO  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-MNTO-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-MNTO.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-IND-MNTO IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-MNTO IN SFC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-MNTO-ATR IN SFC-FLD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-MNTO IN SFC-FLD.
      *>>>>
       FIN-VAL-SFC-IND-MNTO.
           EXIT.
       
       VAL-FRM-GLS-MNTO SECTION.
       INI-VAL-FRM-GLS-MNTO.
       FIN-VAL-FRM-GLS-MNTO.
           EXIT.
       
       VAL-SFC-NUM-PLZO SECTION.
       INI-VAL-SFC-NUM-PLZO.
      *<<<< SFC_NUM_PLZO
           IF SFC-NUM-PLZO IN SFC-FLD NOT > ZEROES AND
              SCR-NUM-PLZD IN SCR-VARI    > ZEROES
              MOVE SCR-NUM-PLZD IN SCR-VARI TO
                   SFC-NUM-PLZO IN SFC-FLD.
      *>>>>
       FIN-VAL-SFC-NUM-PLZO.
           EXIT.
       
       VAL-SFC-IND-PLZO SECTION.
       INI-VAL-SFC-IND-PLZO.
           IF SFC-IND-PLZO IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-IND-PLZO IN SFC-FLD.
      *<<<< SFC_IND_PLZO
           IF SFC-IND-PLZO IN SFC-FLD NOT > SPACES AND
              SCR-IND-PLZO IN SCR-VARI    > SPACES
              MOVE SCR-IND-PLZO IN SCR-VARI TO
                   SFC-IND-PLZO IN SFC-FLD.

           IF SFC-IND-PLZO IN SFC-FLD NOT > SPACES
              MOVE SPACES       TO FRM-GLS-PLZO IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-PLZO.

           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           MOVE SFC-IND-PLZO IN SFC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-PLZO IN SFC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-PLZO-ATR IN SFC-FLD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-PLZO IN SFC-FLD.
      *>>>>
       FIN-VAL-SFC-IND-PLZO.
           EXIT.
       
       VAL-FRM-GLS-PLZO SECTION.
       INI-VAL-FRM-GLS-PLZO.
       FIN-VAL-FRM-GLS-PLZO.
           EXIT.
       
       VAL-SFC-SGV-TMPR SECTION.
       INI-VAL-SFC-SGV-TMPR.
      *<<<< SFC_SGV_TMPR
           IF SFC-SGV-TMPR IN SFC-FLD NOT > ZEROES AND
              SCR-SGV-TMPR IN SCR-VARI    > ZEROES
              MOVE SCR-SGV-TMPR IN SCR-VARI TO
                   SFC-SGV-TMPR IN SFC-FLD.

           IF SFC-SGV-TMPR IN SFC-FLD NOT > ZEROES
              PERFORM ERR-GLS
              MOVE FRM-CPIM-UBY TO SFC-SGV-TMPR-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-SGV-TMPR.
      *>>>>
       FIN-VAL-SFC-SGV-TMPR.
           EXIT.
       
       VAL-SFC-SGV-TMSF SECTION.
       INI-VAL-SFC-SGV-TMSF.
      *<<<< SFC_SGV_TMSF
           IF SFC-SGV-TMSF IN SFC-FLD NOT > ZEROES AND
              SCR-SGV-TINT IN SCR-VARI    > ZEROES
              MOVE SCR-SGV-TINT IN SCR-VARI TO
                   SFC-SGV-TMSF IN SFC-FLD.
           IF SFC-SGV-TMSF IN SFC-FLD NOT > ZEROES
              PERFORM ERR-GLS
              MOVE FRM-CPIM-UBY TO SFC-SGV-TMSF-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-SGV-TMSF.
           IF SFC-SGV-TMSF IN SFC-FLD NOT < SFC-SGV-TMPR IN SFC-FLD
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'SGVTMSF  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-SGV-TMSF-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-SGV-TMSF.
      *>>>>
       FIN-VAL-SFC-SGV-TMSF.
           EXIT.
       
       VAL-SFC-IND-TAMO SECTION.
       INI-VAL-SFC-IND-TAMO.
           IF SFC-IND-TAMO IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-IND-TAMO IN SFC-FLD.
      *<<<< SFC_IND_TAMO
           IF SFC-IND-TAMO IN SFC-FLD NOT > SPACES AND
              SCR-COD-TINT IN SCR-VARI    > SPACES
              MOVE SCR-COD-TINT IN SCR-VARI TO
                   SFC-IND-TAMO IN SFC-FLD.

           IF SFC-IND-TAMO IN SFC-FLD NOT > SPACES
              MOVE SPACES       TO FRM-GLS-TAMO IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-TAMO.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'INT'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-IND-TAMO IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-TAMO IN SFC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-TAMO-ATR IN SFC-FLD
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TAMO IN SFC-FLD.
      *>>>>
       FIN-VAL-SFC-IND-TAMO.
           EXIT.
       
       VAL-FRM-GLS-TAMO SECTION.
       INI-VAL-FRM-GLS-TAMO.
       FIN-VAL-FRM-GLS-TAMO.
           EXIT.
       
       VAL-SFC-SGV-SPPR SECTION.
       INI-VAL-SFC-SGV-SPPR.
      *<<<< SFC_SGV_SPPR
      *>>>>
       FIN-VAL-SFC-SGV-SPPR.
           EXIT.
       
       VAL-SFC-SGV-SPSF SECTION.
       INI-VAL-SFC-SGV-SPSF.
      *<<<< SFC_SGV_SPSF
      *>>>>
       FIN-VAL-SFC-SGV-SPSF.
           EXIT.
       
       VAL-SFC-IND-SPRD SECTION.
       INI-VAL-SFC-IND-SPRD.
           IF SFC-IND-SPRD IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-IND-SPRD IN SFC-FLD.
      *<<<< SFC_IND_SPRD
           IF SFC-IND-SPRD IN SFC-FLD NOT > SPACES
              MOVE SPACES       TO FRM-GLS-SPRD IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-SPRD.

           MOVE 'COL'                   TO MSC-COD-SIST.
           MOVE 'PBTI'                  TO MSC-COD-TMSC IN MSC.
           MOVE SFC-IND-SPRD IN SFC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-SPRD IN SFC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-SPRD-ATR IN SFC-FLD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-SPRD IN SFC-FLD.
      *>>>>
       FIN-VAL-SFC-IND-SPRD.
           EXIT.
       
       VAL-FRM-GLS-SPRD SECTION.
       INI-VAL-FRM-GLS-SPRD.
       FIN-VAL-FRM-GLS-SPRD.
           EXIT.
       
       VAL-SFC-SGV-VARI SECTION.
       INI-VAL-SFC-SGV-VARI.
      *<<<< SFC_SGV_VARI
      *>>>>
       FIN-VAL-SFC-SGV-VARI.
           EXIT.
       
       VAL-SFC-SGV-VLRG SECTION.
       INI-VAL-SFC-SGV-VLRG.
       FIN-VAL-SFC-SGV-VLRG.
           EXIT.
       
       VAL-SFC-SGV-VLPI SECTION.
       INI-VAL-SFC-SGV-VLPI.
      *<<<< SFC_SGV_VLPI
            IF SFC-SGV-VLPI IN SFC-FLD > ZEROES OR
               SCR-CIC-ICLI IN SCR-VARI NOT > SPACES
               GO TO FIN-VAL-SFC-SGV-VLPI.

           MOVE ZEROES                   TO SFC-SGV-VLPI IN SFC-FLD.
           MOVE SFC-NUM-SINI IN SFC-FLD  TO WSS-NUM-SCON IN WSS-VARI.
           MOVE SFC-NUM-AINI IN SFC-FLD  TO WSS-NUM-ACON IN WSS-VARI.
           MOVE SFC-NUM-MINI IN SFC-FLD  TO WSS-NUM-MCON IN WSS-VARI.
           MOVE SFC-NUM-DINI IN SFC-FLD  TO WSS-NUM-DCON IN WSS-VARI.

           MOVE WSS-COD-CPTO IN WSS-VARI TO CAC-COD-CPTO IN CAC.
           MOVE SCR-CIC-ICLI IN SCR-VARI TO CAC-CIC-ICLI IN CAC.
           MOVE WSS-FEC-FCON IN WSS-VARI TO CAC-FEC-FINI IN CAC.
           MOVE SFC-HRA-HINI IN SFC-FLD  TO CAC-HRA-HINI IN CAC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-CAC.
           IF NOT (FIO-STAT-OKS AND
                   CAC-COD-CPTO IN CAC = WSS-COD-CPTO IN WSS-VARI AND
                   CAC-CIC-ICLI IN CAC = SCR-CIC-ICLI IN SCR-VARI)
               GO TO FIN-VAL-SFC-SGV-VLPI.
           IF NOT (CAC-IND-VIGE IN CAC = 'S'   AND
                  (CAC-FEC-FTER IN CAC = ZEROES OR
                   CAC-FEC-FTER IN CAC > WSS-FEC-FCON IN WSS-VARI))
               GO TO FIN-VAL-SFC-SGV-VLPI.
           MOVE CAC-VAL-PORC IN CAC      TO SFC-SGV-VLPI IN SFC-FLD.
      *>>>>
       FIN-VAL-SFC-SGV-VLPI.
           EXIT.
       
       VAL-SFC-SGV-VLPE SECTION.
       INI-VAL-SFC-SGV-VLPE.
      *<<<< SFC_SGV_VLPE
      *>>>>
       FIN-VAL-SFC-SGV-VLPE.
           EXIT.
       
       VAL-SFC-GLS-DES1 SECTION.
       INI-VAL-SFC-GLS-DES1.
           IF SFC-GLS-DES1 IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-GLS-DES1 IN SFC-FLD.
       FIN-VAL-SFC-GLS-DES1.
           EXIT.
       
       VAL-SFC-GLS-DES2 SECTION.
       INI-VAL-SFC-GLS-DES2.
           IF SFC-GLS-DES2 IN SFC-FLD NOT > SPACES
              MOVE SPACES TO SFC-GLS-DES2 IN SFC-FLD.
       FIN-VAL-SFC-GLS-DES2.
           EXIT.
       
       VAL-CON-FLD-SFC SECTION.
       INI-VAL-CON-FLD-SFC.
           IF NOT (SCR-CMND = 'ING' OR 'MOD')
              GO TO FIN-VAL-CON-FLD-SFC.

      *Validacion Nivel de Aprobacion
           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE 'AGB'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-BANC IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'BEJC  NEXAGB' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.

           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE TAB-CIC-CTAB IN TAB     TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-APRA IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'APRA  NEXABX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.

           IF TAB-COD-DAT3 IN TAB(1) NOT NUMERIC
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'NVEL  ABXERR' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.

           MOVE TAB-COD-DAT3 IN TAB(1) TO WSS-GLS-NAPR IN WSS-VARI.
           IF SFC-NUM-NAPR IN SFC-FLD NOT > ZEROES
              MOVE WSS-NUM-NAPR IN WSS-VARI TO SFC-NUM-NAPR IN SFC-FLD
              GO TO CNT-VAL-CON-FLD-SFC.
           IF NOT (SFC-NUM-NAPR IN SFC-FLD = WSS-NUM-NAPR IN WSS-VARI)
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'NVELINF  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.

       CNT-VAL-CON-FLD-SFC.
      *Validacion Spread Propuesto/Solicitado

           MOVE SFC-IND-MNTO IN SFC-FLD  TO WSS-IND-MNTO IN CFN-VARI.
           MOVE SFC-NUM-PLZO IN SFC-FLD  TO WSS-NUM-PLZO IN CFN-VARI.
           MOVE SFC-IND-PLZO IN SFC-FLD  TO WSS-IND-PLZO IN CFN-VARI.
           MOVE SCR-COD-COOC IN SCR-VARI TO WSS-COD-COOC IN CFN-VARI.
           MOVE SCR-NUM-VCOR IN SCR-VARI TO WSS-NUM-VCOR IN CFN-VARI.
           MOVE SCR-FEC-FCOL IN SCR-VARI TO WSS-FEC-FPRO IN CFN-VARI.

           PERFORM PRO-CAL-CSTF.
           IF WSS-COD-MENS IN CFN-VARI > SPACES
              MOVE WSS-COD-MENS IN CFN-VARI TO FRM-MEN1
              MOVE WSS-COD-MEN2 IN CFN-VARI TO FRM-MEN2
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.
           MOVE SFC-IND-TAMO IN SFC-FLD TO SFC-IND-TAMO IN SFC.

           IF SFC-MSC-PBTI IN SFC = WSS-EXP-CSTF IN CFN-VARI
              GO TO EXT-VAL-CON-FLD-SFC.

           IF SFC-MSC-PBTI IN SFC = 'A' OR 'X'
              IF WSS-EXP-CSTF IN CFN-VARI = 'A'
                 GO TO EXT-VAL-CON-FLD-SFC
              ELSE
              IF WSS-EXP-CSTF IN CFN-VARI = 'M'
                 MULTIPLY WSS-SGV-CSTF IN CFN-VARI BY 12
                   GIVING WSS-SGV-CSTF IN CFN-VARI ROUNDED
                 GO TO EXT-VAL-CON-FLD-SFC.

           IF SFC-MSC-PBTI IN SFC = 'M' OR 'T'
              IF WSS-EXP-CSTF IN CFN-VARI = 'A'
                 DIVIDE WSS-SGV-CSTF IN CFN-VARI BY 12
                 GIVING WSS-SGV-CSTF IN CFN-VARI ROUNDED
                 GO TO EXT-VAL-CON-FLD-SFC
              ELSE
              IF WSS-EXP-CSTF IN CFN-VARI = 'M'
                 GO TO EXT-VAL-CON-FLD-SFC.

           IF SFC-MSC-PBTI IN SFC = 'D'
              IF WSS-EXP-CSTF IN CFN-VARI = 'A'
                 DIVIDE WSS-SGV-CSTF IN CFN-VARI BY 360
                 GIVING WSS-SGV-CSTF IN CFN-VARI ROUNDED
                 GO TO EXT-VAL-CON-FLD-SFC
              ELSE
              IF WSS-EXP-CSTF IN CFN-VARI = 'M'
                 DIVIDE WSS-SGV-CSTF IN CFN-VARI BY 30
                 GIVING WSS-SGV-CSTF IN CFN-VARI ROUNDED
                 GO TO EXT-VAL-CON-FLD-SFC.
       MSG-VAL-CON-FLD-SFC.
           MOVE 'MC2'          TO MSG-COD-SIST.
           MOVE 'SFCPBTI  INV' TO MSG-COD-MENS.
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC TO FRM-MENS
           MOVE FRM-SUAR-MAL TO FRM-SUAR
           GO TO FIN-VAL-CON-FLD-SFC.
       EXT-VAL-CON-FLD-SFC.
           MOVE SFC-MSC-PBTI IN SFC TO SFC-IND-SPRD IN SFC-FLD.
           SUBTRACT WSS-SGV-CSTF IN CFN-VARI
               FROM SFC-SGV-TMPR IN SFC-FLD
             GIVING SFC-SGV-SPPR IN SFC-FLD ROUNDED.
           SUBTRACT WSS-SGV-CSTF IN CFN-VARI
               FROM SFC-SGV-TMSF IN SFC-FLD
             GIVING SFC-SGV-SPSF IN SFC-FLD ROUNDED.

           COMPUTE SFC-SGV-VARI IN SFC-FLD ROUNDED =
                  ((1 - ( SFC-SGV-SPSF IN SFC-FLD /
                          SFC-SGV-SPPR IN SFC-FLD )) * 100).
       FIN-VAL-CON-FLD-SFC.
           EXIT.
       
       VAL-CON-SFC SECTION.
       INI-VAL-CON-SFC.
       FIN-VAL-CON-SFC.
           EXIT.
       
       VAL-NUM-KEY-SFC SECTION.
       INI-VAL-NUM-KEY-SFC.
           PERFORM VAL-NUM-IKY-SFC.
           PERFORM VAL-NUM-MKY-SFC.
           PERFORM VAL-NUM-AKY-SFC.
       FIN-VAL-NUM-KEY-SFC.
           EXIT.
       
       VAL-NUM-IKY-SFC SECTION.
       INI-VAL-NUM-IKY-SFC.
       VAL-NUM-SFC-HRA-HINI.
           MOVE SFC-HRA-HINI-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO SFC-HRA-HINI IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-HRA-HINI-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-IKY-SFC.
       FIN-VAL-NUM-IKY-SFC.
           EXIT.
       
       VAL-NUM-MKY-SFC SECTION.
       INI-VAL-NUM-MKY-SFC.
       FIN-VAL-NUM-MKY-SFC.
           EXIT.
       
       VAL-NUM-AKY-SFC SECTION.
       INI-VAL-NUM-AKY-SFC.
       FIN-VAL-NUM-AKY-SFC.
           EXIT.
       
       VAL-NUM-FLD-SFC SECTION.
       INI-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-NUM-NAPR.
           MOVE SFC-NUM-NAPR-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO SFC-NUM-NAPR IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-NUM-NAPR-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-SFC-SGV-MNTO.
           MOVE SFC-SGV-MNTO-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO SFC-SGV-MNTO IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-SGV-MNTO-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-NUM-PLZO.
           MOVE SFC-NUM-PLZO-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO SFC-NUM-PLZO IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-NUM-PLZO-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-SGV-TMPR.
           MOVE SFC-SGV-TMPR-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO SFC-SGV-TMPR IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-SGV-TMPR-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-SGV-TMSF.
           MOVE SFC-SGV-TMSF-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO SFC-SGV-TMSF IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-SGV-TMSF-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-SGV-SPPR.
           MOVE SFC-SGV-SPPR-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO SFC-SGV-SPPR IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-SGV-SPPR-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-SGV-SPSF.
           MOVE SFC-SGV-SPSF-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO SFC-SGV-SPSF IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-SGV-SPSF-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-SGV-VARI.
           MOVE SFC-SGV-VARI-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO SFC-SGV-VARI IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-SGV-VARI-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-SGV-VLRG.
           MOVE SFC-SGV-VLRG-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO SFC-SGV-VLRG IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-SGV-VLRG-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-SGV-VLPI.
           MOVE SFC-SGV-VLPI-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO SFC-SGV-VLPI IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-SGV-VLPI-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       VAL-NUM-SFC-SGV-VLPE.
           MOVE SFC-SGV-VLPE-ALF IN SFC-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO SFC-SGV-VLPE IN SFC-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO SFC-SGV-VLPE-LEN IN SFC-FLD
                GO TO FIN-VAL-NUM-FLD-SFC.
       FIN-VAL-NUM-FLD-SFC.
           EXIT.
       
       EDT-KEY-SFC SECTION.
       INI-EDT-KEY-SFC.
           PERFORM EDT-IKY-SFC.
           PERFORM EDT-MKY-SFC.
           PERFORM EDT-AKY-SFC.
       FIN-EDT-KEY-SFC.
           EXIT.
       
       EDT-IKY-SFC SECTION.
       INI-EDT-IKY-SFC.
           IF SFC-HRA-HINI-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-HRA-HINI-LEN IN SFC-FLD
                GO TO FIN-EDT-IKY-SFC.
           MOVE SFC-HRA-HINI IN SFC-FLD TO SFC-HRA-HINI-EDT IN SFC-EDT.
           MOVE SFC-HRA-HINI-EDT IN SFC-EDT TO 
                SFC-HRA-HINI-ALF IN SFC-FLD.
       FIN-EDT-IKY-SFC.
           EXIT.
       
       EDT-MKY-SFC SECTION.
       INI-EDT-MKY-SFC.
       FIN-EDT-MKY-SFC.
           EXIT.
       
       EDT-AKY-SFC SECTION.
       INI-EDT-AKY-SFC.
       FIN-EDT-AKY-SFC.
           EXIT.
       
       EDT-FLD-SFC SECTION.
       INI-EDT-FLD-SFC.
           IF SFC-NUM-NAPR-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-NUM-NAPR-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-NUM-NAPR IN SFC-FLD TO SFC-NUM-NAPR-EDT IN SFC-EDT.
           MOVE SFC-NUM-NAPR-EDT IN SFC-EDT TO 
                SFC-NUM-NAPR-ALF IN SFC-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE DBC-NUM-ICLI IN SFC-FLD TO
                DBC-NUM-ICLI-EDT IN SFC-EDT.
           MOVE DBC-NUM-ICLI-EDT IN SFC-EDT TO
                DBC-NUM-ICLI-ALF IN SFC-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF SFC-SGV-MNTO-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-SGV-MNTO-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-SGV-MNTO IN SFC-FLD TO SFC-SGV-MNTO-EDT IN SFC-EDT.
           MOVE SFC-SGV-MNTO-EDT IN SFC-EDT TO 
                SFC-SGV-MNTO-ALF IN SFC-FLD.
           IF SFC-NUM-PLZO-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-NUM-PLZO-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-NUM-PLZO IN SFC-FLD TO SFC-NUM-PLZO-EDT IN SFC-EDT.
           MOVE SFC-NUM-PLZO-EDT IN SFC-EDT TO 
                SFC-NUM-PLZO-ALF IN SFC-FLD.
           IF SFC-SGV-TMPR-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-SGV-TMPR-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-SGV-TMPR IN SFC-FLD TO SFC-SGV-TMPR-EDT IN SFC-EDT.
           MOVE SFC-SGV-TMPR-EDT IN SFC-EDT TO 
                SFC-SGV-TMPR-ALF IN SFC-FLD.
           IF SFC-SGV-TMSF-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-SGV-TMSF-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-SGV-TMSF IN SFC-FLD TO SFC-SGV-TMSF-EDT IN SFC-EDT.
           MOVE SFC-SGV-TMSF-EDT IN SFC-EDT TO 
                SFC-SGV-TMSF-ALF IN SFC-FLD.
           IF SFC-SGV-SPPR-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-SGV-SPPR-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-SGV-SPPR IN SFC-FLD TO SFC-SGV-SPPR-EDT IN SFC-EDT.
           MOVE SFC-SGV-SPPR-EDT IN SFC-EDT TO 
                SFC-SGV-SPPR-ALF IN SFC-FLD.
           IF SFC-SGV-SPSF-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-SGV-SPSF-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-SGV-SPSF IN SFC-FLD TO SFC-SGV-SPSF-EDT IN SFC-EDT.
           MOVE SFC-SGV-SPSF-EDT IN SFC-EDT TO 
                SFC-SGV-SPSF-ALF IN SFC-FLD.
           IF SFC-SGV-VARI-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-SGV-VARI-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-SGV-VARI IN SFC-FLD TO SFC-SGV-VARI-EDT IN SFC-EDT.
           MOVE SFC-SGV-VARI-EDT IN SFC-EDT TO 
                SFC-SGV-VARI-ALF IN SFC-FLD.
           IF SFC-SGV-VLRG-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-SGV-VLRG-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-SGV-VLRG IN SFC-FLD TO SFC-SGV-VLRG-EDT IN SFC-EDT.
           MOVE SFC-SGV-VLRG-EDT IN SFC-EDT TO 
                SFC-SGV-VLRG-ALF IN SFC-FLD.
           IF SFC-SGV-VLPI-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-SGV-VLPI-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-SGV-VLPI IN SFC-FLD TO SFC-SGV-VLPI-EDT IN SFC-EDT.
           MOVE SFC-SGV-VLPI-EDT IN SFC-EDT TO 
                SFC-SGV-VLPI-ALF IN SFC-FLD.
           IF SFC-SGV-VLPE-LEN IN SFC-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO SFC-SGV-VLPE-LEN IN SFC-FLD
                GO TO FIN-EDT-FLD-SFC.
           MOVE SFC-SGV-VLPE IN SFC-FLD TO SFC-SGV-VLPE-EDT IN SFC-EDT.
           MOVE SFC-SGV-VLPE-EDT IN SFC-EDT TO 
                SFC-SGV-VLPE-ALF IN SFC-FLD.
       FIN-EDT-FLD-SFC.
           EXIT.
