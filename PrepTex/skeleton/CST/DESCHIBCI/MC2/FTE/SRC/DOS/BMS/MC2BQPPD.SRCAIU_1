      *
      * MC2BQPPD
      * Version 3.0.1 Nov-2005
      * 10-Feb-17 01:10 PM
      *
       SET-TAG-MC2BQPPD SECTION.
       INI-SET-TAG-MC2BQPPD.
           MOVE
           '<IDNMOD NOM=$MC2BQPPD$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$10-Feb-17 01:10 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-MC2BQPPD.
           EXIT.
           
       PUT-ALL-PPD SECTION.
       INI-PUT-ALL-PPD.
           PERFORM PUT-PPD-PPD.
       FIN-PUT-ALL-PPD.
           EXIT.
       
       PUT-PPD-PPD SECTION.
       INI-PUT-PPD-PPD.
           IF PGM-STAT-PPD-NUL
               GO TO FIN-PUT-PPD-PPD.
           IF NOT PGM-STAT-PPD-OKS
               PERFORM CLR-PPD-PPD
               GO TO FIN-PUT-PPD-PPD.
           MOVE PPD-CAI-IPPD IN PPD TO PPD-CAI-IPPD IN PPD-FLD.
           MOVE PPD-IIC-IPPD IN PPD TO PPD-IIC-IPPD IN PPD-FLD.
           MOVE PPD-COD-SIST IN PPD TO PPD-COD-SIST IN PPD-FLD.
           MOVE PPD-COD-EVEN IN PPD TO PPD-COD-EVEN IN PPD-FLD.
           MOVE PPD-IND-TPLT IN PPD TO PPD-IND-TPLT IN PPD-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE PPD-NUM-DINI IN PPD TO PPD-NUM-DINI IN PPD-FLD.
           MOVE PPD-NUM-MINI IN PPD TO PPD-NUM-MINI IN PPD-FLD.
           MOVE PPD-NUM-SINI IN PPD TO PPD-NUM-SINI IN PPD-FLD.
           MOVE PPD-NUM-AINI IN PPD TO PPD-NUM-AINI IN PPD-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE PPD-HRA-HINI IN PPD TO PPD-HRA-HINI IN PPD-FLD.
           MOVE PPD-COD-VCOC IN PPD TO PPD-COD-VCOC IN PPD-FLD.
           MOVE PPD-IND-VIGE IN PPD TO PPD-IND-VIGE IN PPD-FLD.
           MOVE PPD-COD-RENO IN PPD TO PPD-COD-RENO IN PPD-FLD.
           MOVE PPD-VAL-CMIN IN PPD TO PPD-VAL-CMIN IN PPD-FLD.
           MOVE PPD-COD-ENDO IN PPD TO PPD-COD-ENDO IN PPD-FLD.
           MOVE PPD-VAL-CMAX IN PPD TO PPD-VAL-CMAX IN PPD-FLD.
           MOVE PPD-COD-BCTI IN PPD TO PPD-COD-BCTI IN PPD-FLD.
           MOVE PPD-NUM-PMIN IN PPD TO PPD-NUM-PMIN IN PPD-FLD.
           MOVE PPD-IND-PMIN IN PPD TO PPD-IND-PMIN IN PPD-FLD.
           MOVE PPD-COD-PBTI IN PPD TO PPD-COD-PBTI IN PPD-FLD.
           MOVE PPD-NUM-PMAX IN PPD TO PPD-NUM-PMAX IN PPD-FLD.
           MOVE PPD-IND-PMAX IN PPD TO PPD-IND-PMAX IN PPD-FLD.
           MOVE PPD-COD-SPBT IN PPD TO PPD-COD-SPBT IN PPD-FLD.
           MOVE PPD-NUM-VMIN IN PPD TO PPD-NUM-VMIN IN PPD-FLD.
           MOVE PPD-NUM-VMAX IN PPD TO PPD-NUM-VMAX IN PPD-FLD.
           MOVE PPD-COD-CVTI IN PPD TO PPD-COD-CVTI IN PPD-FLD.
           MOVE PPD-NUM-SMNV IN PPD TO PPD-NUM-SMNV IN PPD-FLD.
           MOVE PPD-IND-SMNV IN PPD TO PPD-IND-SMNV IN PPD-FLD.
           MOVE PPD-COD-TFPR IN PPD TO PPD-COD-TFPR IN PPD-FLD.
           MOVE PPD-NUM-SMXV IN PPD TO PPD-NUM-SMXV IN PPD-FLD.
           MOVE PPD-IND-SMXV IN PPD TO PPD-IND-SMXV IN PPD-FLD.
           MOVE PPD-NUM-PREP IN PPD TO PPD-NUM-PREP IN PPD-FLD.
           MOVE PPD-IND-PREP IN PPD TO PPD-IND-PREP IN PPD-FLD.
           MOVE PPD-COD-MORE IN PPD TO PPD-COD-MORE IN PPD-FLD.
           MOVE PPD-COD-TCDP IN PPD TO PPD-COD-TCDP IN PPD-FLD.
           MOVE PPD-COD-PLPA IN PPD TO PPD-COD-PLPA IN PPD-FLD.
           MOVE PPD-COD-RESC IN PPD TO PPD-COD-RESC IN PPD-FLD.
           MOVE PPD-IND-VIGC IN PPD TO PPD-IND-VIGC IN PPD-FLD.
           MOVE PPD-NUM-PLRE IN PPD TO PPD-NUM-PLRE IN PPD-FLD.
           MOVE PPD-IND-PLRE IN PPD TO PPD-IND-PLRE IN PPD-FLD.
           MOVE PPD-COD-GARA IN PPD TO PPD-COD-GARA IN PPD-FLD.
           MOVE PPD-NUM-PRES IN PPD TO PPD-NUM-PRES IN PPD-FLD.
           MOVE PPD-NUM-PNTE IN PPD TO PPD-NUM-PNTE IN PPD-FLD.
           MOVE PPD-IND-PNTE IN PPD TO PPD-IND-PNTE IN PPD-FLD.
           MOVE PPD-COD-AFER IN PPD TO PPD-COD-AFER IN PPD-FLD.
           MOVE PPD-COD-AACC IN PPD TO PPD-COD-AACC IN PPD-FLD.
           MOVE PPD-COD-NAPR IN PPD TO PPD-COD-NAPR IN PPD-FLD.
           MOVE PPD-CAI-ICIC IN PPD TO PPD-CAI-ICIC IN PPD-FLD.
           MOVE PPD-IIC-ICIC IN PPD TO PPD-IIC-ICIC IN PPD-FLD.
      *<<<< FIN_PUT_PPD_PPD
           IF PPD-COD-SIST IN PPD-FLD > SPACES
              MOVE WSS-TAB                  TO TAB-COD-SIST
              MOVE WSS-SIS                  TO TAB-COD-TTAB IN TAB
              MOVE PPD-COD-SIST IN PPD-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-SIST IN PPD-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-SIST IN PPD-FLD.
           IF PPD-COD-EVEN IN PPD-FLD > SPACES
              MOVE WSS-TAB                  TO TAB-COD-SIST
              MOVE WSS-EVT                  TO TAB-COD-TTAB IN TAB
              MOVE PPD-COD-SIST IN PPD-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE PPD-COD-EVEN IN PPD-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-EVEN IN PPD-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-EVEN IN PPD-FLD.
           IF PPD-IND-VIGE IN PPD-FLD > SPACES
              MOVE WSS-GNS                  TO TAB-COD-SIST
              MOVE WSS-STT                  TO TAB-COD-TTAB IN TAB
              MOVE PPD-IND-VIGE IN PPD-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-VIGE IN PPD-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-VIGE IN PPD-FLD.
           IF PPD-COD-VCOC IN PPD-FLD > SPACES
              MOVE WSS-TAB                 TO TAB-COD-SIST
              MOVE WSS-VLR                 TO TAB-COD-TTAB IN TAB
              MOVE PPD-COD-VCOC IN PPD-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VCOC IN PPD-FLD
           ELSE
              MOVE SPACES              TO FRM-GLS-VCOC IN PPD-FLD.
           MOVE WSS-TAB             TO TAB-COD-SIST.
           MOVE WSS-DPL             TO TAB-COD-TTAB IN TAB.
           MOVE PPD-CIC-ICIC IN PPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-COD-PPD1 IN PPD-FLD.
           MOVE TAB-GLS-DATA IN TAB TO FRM-COD-PPD2 IN PPD-FLD.
      *>>>>
       FIN-PUT-PPD-PPD.
           EXIT.
       
       KEY-ALL-PPD SECTION.
       INI-KEY-ALL-PPD.
           PERFORM KEY-PPD-PPD.
       FIN-KEY-ALL-PPD.
           EXIT.
       
       KEY-PPD-PPD SECTION.
       INI-KEY-PPD-PPD.
           MOVE PPD-CAI-IPPD IN PPD-FLD TO PPD-CAI-IPPD IN PPD.
           MOVE PPD-IIC-IPPD IN PPD-FLD TO PPD-IIC-IPPD IN PPD.
           MOVE PPD-COD-SIST IN PPD-FLD TO PPD-COD-SIST IN PPD.
           MOVE PPD-COD-EVEN IN PPD-FLD TO PPD-COD-EVEN IN PPD.
           MOVE PPD-IND-TPLT IN PPD-FLD TO PPD-IND-TPLT IN PPD.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE PPD-NUM-DINI IN PPD-FLD TO PPD-NUM-DINI IN PPD.
           MOVE PPD-NUM-MINI IN PPD-FLD TO PPD-NUM-MINI IN PPD.
           MOVE PPD-NUM-SINI IN PPD-FLD TO PPD-NUM-SINI IN PPD.
           MOVE PPD-NUM-AINI IN PPD-FLD TO PPD-NUM-AINI IN PPD.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE PPD-HRA-HINI IN PPD-FLD TO PPD-HRA-HINI IN PPD.
           MOVE PPD-COD-VCOC IN PPD-FLD TO PPD-COD-VCOC IN PPD.
       FIN-KEY-PPD-PPD.
           EXIT.
       
       SCR-CLRA-PPD SECTION.
       INI-SCR-CLRA-PPD.
           PERFORM CLR-KEY-PPD.
           PERFORM CLR-FLD-PPD.
       FIN-SCR-CLRA-PPD.
           EXIT.
       
       CLR-KEY-PPD SECTION.
       INI-CLR-KEY-PPD.
           MOVE SPACES TO PPD-CAI-IPPD IN PPD-FLD.
           MOVE SPACES TO PPD-IIC-IPPD IN PPD-FLD.
           MOVE SPACES TO PPD-COD-SIST IN PPD-FLD.
           MOVE SPACES TO PPD-COD-EVEN IN PPD-FLD.
           MOVE SPACES TO PPD-IND-TPLT IN PPD-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO PPD-FEC-FINI IN PPD-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO PPD-HRA-HINI IN PPD-FLD.
           MOVE SPACES TO PPD-COD-VCOC IN PPD-FLD.
       FIN-CLR-KEY-PPD.
           EXIT.
       
       CLR-FLD-PPD SECTION.
       INI-CLR-FLD-PPD.
           MOVE SPACES TO FRM-GLS-SIST IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-EVEN IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-VCOC IN PPD-FLD.
           MOVE SPACES TO FRM-COD-PPD1 IN PPD-FLD.
           MOVE SPACES TO FRM-COD-PPD2 IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-VIGE IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-RENO IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-ENDO IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-BCTI IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-PMIN IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-PBTI IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-PMAX IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-SPBT IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-SMNV IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-SMXV IN PPD-FLD.
           MOVE SPACES TO FRM-GLS-PLPA IN PPD-FLD.
           PERFORM CLR-PPD-PPD.
       FIN-CLR-FLD-PPD.
           EXIT.
       
       CLR-PPD-PPD SECTION.
       INI-CLR-PPD-PPD.
           MOVE SPACES TO PPD-IND-VIGE IN PPD-FLD.
           MOVE SPACES TO PPD-COD-RENO IN PPD-FLD.
           MOVE ZEROES TO PPD-VAL-CMIN IN PPD-FLD.
           MOVE SPACES TO PPD-COD-ENDO IN PPD-FLD.
           MOVE ZEROES TO PPD-VAL-CMAX IN PPD-FLD.
           MOVE SPACES TO PPD-COD-BCTI IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-PMIN IN PPD-FLD.
           MOVE SPACES TO PPD-IND-PMIN IN PPD-FLD.
           MOVE SPACES TO PPD-COD-PBTI IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-PMAX IN PPD-FLD.
           MOVE SPACES TO PPD-IND-PMAX IN PPD-FLD.
           MOVE SPACES TO PPD-COD-SPBT IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-VMIN IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-VMAX IN PPD-FLD.
           MOVE SPACES TO PPD-COD-CVTI IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-SMNV IN PPD-FLD.
           MOVE SPACES TO PPD-IND-SMNV IN PPD-FLD.
           MOVE SPACES TO PPD-COD-TFPR IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-SMXV IN PPD-FLD.
           MOVE SPACES TO PPD-IND-SMXV IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-PREP IN PPD-FLD.
           MOVE SPACES TO PPD-IND-PREP IN PPD-FLD.
           MOVE SPACES TO PPD-COD-MORE IN PPD-FLD.
           MOVE SPACES TO PPD-COD-TCDP IN PPD-FLD.
           MOVE SPACES TO PPD-COD-PLPA IN PPD-FLD.
           MOVE SPACES TO PPD-COD-RESC IN PPD-FLD.
           MOVE SPACES TO PPD-IND-VIGC IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-PLRE IN PPD-FLD.
           MOVE SPACES TO PPD-IND-PLRE IN PPD-FLD.
           MOVE SPACES TO PPD-COD-GARA IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-PRES IN PPD-FLD.
           MOVE ZEROES TO PPD-NUM-PNTE IN PPD-FLD.
           MOVE SPACES TO PPD-IND-PNTE IN PPD-FLD.
           MOVE SPACES TO PPD-COD-AFER IN PPD-FLD.
           MOVE SPACES TO PPD-COD-AACC IN PPD-FLD.
           MOVE SPACES TO PPD-COD-NAPR IN PPD-FLD.
           MOVE SPACES TO PPD-CAI-ICIC IN PPD-FLD.
           MOVE ZEROES TO PPD-IIC-ICIC IN PPD-FLD.
       FIN-CLR-PPD-PPD.
           EXIT.
       
       FST-KEY-PPD SECTION.
       INI-FST-KEY-PPD.
           MOVE -1 TO PPD-CAI-IPPD-LEN IN PPD-FLD.
       FIN-FST-KEY-PPD.
           EXIT.
       
       FST-FLD-PPD SECTION.
       INI-FST-FLD-PPD.
           MOVE -1 TO FRM-COD-PPD1-LEN IN PPD-FLD.
       FIN-FST-FLD-PPD.
           EXIT.
       
       PRO-KEY-PPD SECTION.
       INI-PRO-KEY-PPD.
           PERFORM PRO-IKY-PPD.
           PERFORM PRO-AKY-PPD.
           PERFORM PRO-MKY-PPD.
       FIN-PRO-KEY-PPD.
           EXIT.
       
       PRO-IKY-PPD SECTION.
       INI-PRO-IKY-PPD.
           MOVE FRM-CPIM-AEY TO PPD-CAI-IPPD-ATR IN PPD-FLD.
           MOVE FRM-CPIM-AEY TO PPD-IIC-IPPD-ATR IN PPD-FLD.
           MOVE FRM-CPIM-AEY TO PPD-COD-SIST-ATR IN PPD-FLD.
           MOVE FRM-CPIM-AEY TO PPD-COD-EVEN-ATR IN PPD-FLD.
           MOVE FRM-CPIM-AEY TO PPD-IND-TPLT-ATR IN PPD-FLD.
           MOVE FRM-CPIM-AEY TO PPD-FEC-FINI-ATR IN PPD-FLD.
           MOVE FRM-CPIM-AEY TO PPD-HRA-HINI-ATR IN PPD-FLD.
           MOVE FRM-CPIM-AEY TO PPD-COD-VCOC-ATR IN PPD-FLD.
       FIN-PRO-IKY-PPD.
           EXIT.
       
       PRO-MKY-PPD SECTION.
       INI-PRO-MKY-PPD.
       FIN-PRO-MKY-PPD.
           EXIT.
       
       PRO-AKY-PPD SECTION.
       INI-PRO-AKY-PPD.
       FIN-PRO-AKY-PPD.
           EXIT.
       
       UNP-KEY-PPD SECTION.
       INI-UNP-KEY-PPD.
           PERFORM UNP-IKY-PPD.
           PERFORM UNP-AKY-PPD.
           PERFORM UNP-MKY-PPD.
       FIN-UNP-KEY-PPD.
           EXIT.
       
       UNP-IKY-PPD SECTION.
       INI-UNP-IKY-PPD.
           MOVE FRM-CPIM-UBY TO PPD-CAI-IPPD-ATR.
           MOVE FRM-CPIM-UBY TO PPD-IIC-IPPD-ATR.
           MOVE FRM-CPIM-UBY TO PPD-COD-SIST-ATR.
           MOVE FRM-CPIM-UBY TO PPD-COD-EVEN-ATR.
           MOVE FRM-CPIM-UBY TO PPD-IND-TPLT-ATR.
           MOVE FRM-CPIM-UBY TO PPD-FEC-FINI-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-HRA-HINI-ATR.
           MOVE FRM-CPIM-UBY TO PPD-COD-VCOC-ATR.
       FIN-UNP-IKY-PPD.
           EXIT.
       
       UNP-MKY-PPD SECTION.
       INI-UNP-MKY-PPD.
       FIN-UNP-MKY-PPD.
           EXIT.
       
       UNP-AKY-PPD SECTION.
       INI-UNP-AKY-PPD.
       FIN-UNP-AKY-PPD.
           EXIT.
       
       UNP-FLD-PPD SECTION.
       INI-UNP-FLD-PPD.
           MOVE FRM-CPIM-UBY TO FRM-COD-PPD1-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-PPD2-ATR IN PPD-FLD.
           PERFORM UNP-PPD-PPD.
       FIN-UNP-FLD-PPD.
           EXIT.
       
       UNP-PPD-PPD SECTION.
       INI-UNP-PPD-PPD.
           MOVE FRM-CPIM-UBY TO PPD-COD-RENO-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-VAL-CMIN-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-ENDO-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-VAL-CMAX-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-BCTI-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-PMIN-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-IND-PMIN-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-PBTI-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-PMAX-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-IND-PMAX-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-SPBT-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-VMIN-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-VMAX-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-CVTI-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-SMNV-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-IND-SMNV-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-TFPR-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-SMXV-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-IND-SMXV-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-PREP-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-IND-PREP-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-MORE-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-TCDP-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-PLPA-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-RESC-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-IND-VIGC-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-PLRE-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-IND-PLRE-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-GARA-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-PRES-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-NUM-PNTE-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-IND-PNTE-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-AFER-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-AACC-ATR IN PPD-FLD.
           MOVE FRM-CPIM-UBY TO PPD-COD-NAPR-ATR IN PPD-FLD.
       FIN-UNP-PPD-PPD.
           EXIT.
       
       VAL-KEY-PPD SECTION.
       INI-VAL-KEY-PPD.
           PERFORM VAL-IKY-PPD.
           PERFORM VAL-MKY-PPD.
           PERFORM VAL-AKY-PPD.
       FIN-VAL-KEY-PPD.
           EXIT.
       
       VAL-IKY-PPD SECTION.
       INI-VAL-IKY-PPD.
           PERFORM VAL-PPD-CAI-IPPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PPD-CAI-IPPD-LEN IN PPD-FLD
                GO TO FIN-VAL-IKY-PPD.
           PERFORM VAL-PPD-IIC-IPPD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PPD-IIC-IPPD-LEN IN PPD-FLD
                GO TO FIN-VAL-IKY-PPD.
           PERFORM VAL-PPD-COD-SIST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PPD-COD-SIST-LEN IN PPD-FLD
                GO TO FIN-VAL-IKY-PPD.
           PERFORM VAL-PPD-COD-EVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PPD-COD-EVEN-LEN IN PPD-FLD
                GO TO FIN-VAL-IKY-PPD.
           PERFORM VAL-PPD-IND-TPLT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PPD-IND-TPLT-LEN IN PPD-FLD
                GO TO FIN-VAL-IKY-PPD.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-PPD-FEC-FINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                PPD-FEC-FINI-LEN IN PPD-FLD
                GO TO FIN-VAL-IKY-PPD.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-PPD-HRA-HINI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PPD-HRA-HINI-LEN IN PPD-FLD
                GO TO FIN-VAL-IKY-PPD.
           PERFORM VAL-PPD-COD-VCOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO PPD-COD-VCOC-LEN IN PPD-FLD
                GO TO FIN-VAL-IKY-PPD.
       FIN-VAL-IKY-PPD.
           EXIT.
       
       VAL-MKY-PPD SECTION.
       INI-VAL-MKY-PPD.
       FIN-VAL-MKY-PPD.
           EXIT.
       
       VAL-AKY-PPD SECTION.
       INI-VAL-AKY-PPD.
       FIN-VAL-AKY-PPD.
           EXIT.
       
       VAL-PPD-CAI-IPPD SECTION.
       INI-VAL-PPD-CAI-IPPD.
           IF PPD-CAI-IPPD IN PPD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PPD-CAI-IPPD.
       FIN-VAL-PPD-CAI-IPPD.
           EXIT.
       
       VAL-PPD-IIC-IPPD SECTION.
       INI-VAL-PPD-IIC-IPPD.
           IF PPD-IIC-IPPD IN PPD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PPD-IIC-IPPD.
       FIN-VAL-PPD-IIC-IPPD.
           EXIT.
       
       VAL-PPD-COD-SIST SECTION.
       INI-VAL-PPD-COD-SIST.
           IF PPD-COD-SIST IN PPD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PPD-COD-SIST.
      *<<<< PPD_COD_SIST
      *VAL-COD Valida codigo de tabla
           MOVE WSS-TAB                 TO TAB-COD-SIST.
           MOVE WSS-SIS                 TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-SIST IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR WSS-CODNVG
              MOVE SPACES       TO FRM-GLS-SIST IN PPD-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SIST IN PPD-FLD.
      *>>>> 
       FIN-VAL-PPD-COD-SIST.
           EXIT.
       
       VAL-PPD-COD-EVEN SECTION.
       INI-VAL-PPD-COD-EVEN.
           IF PPD-COD-EVEN IN PPD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PPD-COD-EVEN.
       FIN-VAL-PPD-COD-EVEN.
           EXIT.
       
       VAL-PPD-IND-TPLT SECTION.
       INI-VAL-PPD-IND-TPLT.
           IF PPD-IND-TPLT IN PPD-FLD NOT > SPACES
              MOVE SPACES TO PPD-IND-TPLT IN PPD-FLD.
      *<<<< FIN_PPD_IND_TPLT
           IF PPD-IND-TPLT IN PPD-FLD NOT > SPACES
              MOVE WSS-P TO PPD-IND-TPLT IN PPD-FLD
              GO TO FIN-VAL-PPD-IND-TPLT.
           MOVE WSS-TAB                  TO TAB-COD-SIST.
           MOVE WSS-TDP                  TO TAB-COD-TTAB IN TAB.
           MOVE PPD-IND-TPLT IN PPD-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-TAB.
           IF MSG-COD-MENS = WSS-CODNEX OR WSS-CODNVG
              MOVE WSS-GNS      TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MEN2
              MOVE WSS-TAB      TO MSG-COD-SIST
              MOVE WSS-ERRTDP   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN1
              MOVE FRM-SUAR-MAL TO FRM-SUAR.

           IF PPD-IND-TPLT IN PPD-FLD NOT = WSS-P
              MOVE WSS-TAB      TO MSG-COD-SIST
              MOVE WSS-ERRTDP   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MEN1
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
       FIN-VAL-PPD-IND-TPLT.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-PPD-FEC-FINI SECTION.
       INI-VAL-PPD-FEC-FINI.
           IF PPD-FEC-FINI IN PPD-FLD  NOT > ZEROES
              MOVE ZEROES TO PPD-FEC-FINI IN PPD-FLD.
      *VAL-FEC Validar Fecha
           MOVE PPD-FEC-FINI IN PPD-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_PPD_FEC_FINI                                         
           MOVE FEC-VHBL-N TO FEC-VHBL.                              
           MOVE FEC-CHOY-N TO FEC-CHOY.                              
           IF SCR-CMND = WSS-ING OR WSS-MOD OR WSS-VRF OR WSS-ACA           
              MOVE FEC-CHOY-GE TO FEC-CHOY.                          
                                                                     
           IF PPD-FEC-FINI IN PPD-FLD NOT > ZEROES                   
              PERFORM GET-FHOY                                       
              MOVE HOY-DHOY IN HOY-VARI TO PPD-NUM-DINI IN PPD-FLD   
              MOVE HOY-MHOY IN HOY-VARI TO PPD-NUM-MINI IN PPD-FLD   
              MOVE HOY-SHOY IN HOY-VARI TO PPD-NUM-SINI IN PPD-FLD   
              MOVE HOY-AHOY IN HOY-VARI TO PPD-NUM-AINI IN PPD-FLD   
              IF PPD-HRA-HINI IN PPD-FLD NOT > ZEROES                
                 MOVE HOY-HHOY IN HOY-VARI TO PPD-HRA-HINI IN PPD-FLD
                 GO TO FIN-VAL-PPD-FEC-FINI                          
              ELSE                                                   
                 GO TO FIN-VAL-PPD-FEC-FINI.                         
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO PPD-FEC-FINI IN PPD-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-PPD-FEC-FINI.
       FIN-VAL-PPD-FEC-FINI.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-PPD-HRA-HINI SECTION.
       INI-VAL-PPD-HRA-HINI.
           IF PPD-HRA-HINI IN PPD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PPD-HRA-HINI.
      *<<<< PPD_HRA_HINI                                      
           IF PPD-HRA-HINI IN PPD-FLD NOT > ZEROES                
              PERFORM GET-FHOY
              MOVE HOY-HHOY IN HOY-VARI TO PPD-HRA-HINI IN PPD-FLD
              GO TO FIN-VAL-PPD-HRA-HINI.
                                                                  
           MOVE PPD-HRA-HINI IN PPD-FLD TO PPD-HRA-HINI IN PPD.   
           IF PPD-NUM-HHIN IN PPD < ZEROES OR      
              PPD-NUM-HHIN IN PPD > WSS-23             
               MOVE WSS-TAB         TO MSG-COD-SIST  
               MOVE WSS-NUMHHTRNOVA TO MSG-COD-MENS  
               PERFORM GET-MSG                     
               MOVE MSG-GLS-DESC TO FRM-MENS       
               MOVE FRM-SUAR-MAL TO FRM-SUAR       
               GO TO FIN-VAL-PPD-HRA-HINI.         
           IF PPD-NUM-MMIN IN PPD < ZEROES OR      
              PPD-NUM-MMIN IN PPD > WSS-59             
               MOVE WSS-TAB         TO MSG-COD-SIST          
               MOVE WSS-NUMMMTRNOVA TO MSG-COD-MENS  
               PERFORM GET-MSG                     
               MOVE MSG-GLS-DESC TO FRM-MENS       
               MOVE FRM-SUAR-MAL TO FRM-SUAR       
               GO TO FIN-VAL-PPD-HRA-HINI.         
           IF PPD-NUM-SSIN IN PPD < ZEROES OR      
              PPD-NUM-SSIN IN PPD > WSS-59             
               MOVE WSS-TAB         TO MSG-COD-SIST          
               MOVE WSS-NUMSSTRNOVA TO MSG-COD-MENS  
               PERFORM GET-MSG                     
               MOVE MSG-GLS-DESC TO FRM-MENS       
               MOVE FRM-SUAR-MAL TO FRM-SUAR       
               GO TO FIN-VAL-PPD-HRA-HINI.         
      *>>>> 
       FIN-VAL-PPD-HRA-HINI.
           EXIT.
       
       VAL-PPD-COD-VCOC SECTION.
       INI-VAL-PPD-COD-VCOC.
           IF PPD-COD-VCOC IN PPD-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-PPD-COD-VCOC.
      *<<<< PPD_COD_VCOC
      *VAL-COD Valida codigo de tabla
           MOVE WSS-TAB                 TO TAB-COD-SIST.
           MOVE WSS-VLR                 TO TAB-COD-TTAB IN TAB.
           MOVE PPD-COD-VCOC IN PPD-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = WSS-CODNEX OR WSS-CODNVG
              MOVE SPACES       TO FRM-GLS-VCOC IN PPD-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VCOC IN PPD-FLD.
      *>>>>
       FIN-VAL-PPD-COD-VCOC.
           EXIT.
       
       VAL-CON-KEY-PPD SECTION.
       INI-VAL-CON-KEY-PPD.
           IF     PPD-CAI-IPPD IN PPD-FLD NOT > SPACES 
              AND PPD-IIC-IPPD IN PPD-FLD NOT > SPACES 
              AND PPD-COD-SIST IN PPD-FLD NOT > SPACES 
              AND PPD-COD-EVEN IN PPD-FLD NOT > SPACES 
              AND PPD-IND-TPLT IN PPD-FLD NOT > SPACES 
              AND PPD-FEC-FINI IN PPD-FLD NOT > ZEROES
              AND PPD-HRA-HINI IN PPD-FLD NOT > SPACES 
              AND PPD-COD-VCOC IN PPD-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PPD.
       FIN-VAL-CON-KEY-PPD.
           EXIT.
       
       VAL-CON-IKY-PPD SECTION.
       INI-VAL-CON-IKY-PPD.
           IF     PPD-CAI-IPPD IN PPD-FLD NOT > SPACES 
              AND PPD-IIC-IPPD IN PPD-FLD NOT > SPACES 
              AND PPD-COD-SIST IN PPD-FLD NOT > SPACES 
              AND PPD-COD-EVEN IN PPD-FLD NOT > SPACES 
              AND PPD-IND-TPLT IN PPD-FLD NOT > SPACES 
              AND PPD-FEC-FINI IN PPD-FLD NOT > ZEROES
              AND PPD-HRA-HINI IN PPD-FLD NOT > SPACES 
              AND PPD-COD-VCOC IN PPD-FLD NOT > SPACES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-PPD.
       FIN-VAL-CON-IKY-PPD.
           EXIT.
       
       VAL-NUM-KEY-PPD SECTION.
       INI-VAL-NUM-KEY-PPD.
           PERFORM VAL-NUM-IKY-PPD.
           PERFORM VAL-NUM-MKY-PPD.
           PERFORM VAL-NUM-AKY-PPD.
       FIN-VAL-NUM-KEY-PPD.
           EXIT.
       
       VAL-NUM-IKY-PPD SECTION.
       INI-VAL-NUM-IKY-PPD.
       FIN-VAL-NUM-IKY-PPD.
           EXIT.
       
       VAL-NUM-MKY-PPD SECTION.
       INI-VAL-NUM-MKY-PPD.
       FIN-VAL-NUM-MKY-PPD.
           EXIT.
       
       VAL-NUM-AKY-PPD SECTION.
       INI-VAL-NUM-AKY-PPD.
       FIN-VAL-NUM-AKY-PPD.
           EXIT.
       
       VAL-NUM-FLD-PPD SECTION.
       INI-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-VAL-CMIN.
           MOVE PPD-VAL-CMIN-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO PPD-VAL-CMIN IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-VAL-CMIN-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-VAL-CMAX.
           MOVE PPD-VAL-CMAX-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO PPD-VAL-CMAX IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-VAL-CMAX-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-PMIN.
           MOVE PPD-NUM-PMIN-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-PMIN IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-PMIN-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-PMAX.
           MOVE PPD-NUM-PMAX-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-PMAX IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-PMAX-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-VMIN.
           MOVE PPD-NUM-VMIN-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-VMIN IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-VMIN-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-VMAX.
           MOVE PPD-NUM-VMAX-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-VMAX IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-VMAX-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-SMNV.
           MOVE PPD-NUM-SMNV-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-SMNV IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-SMNV-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-SMXV.
           MOVE PPD-NUM-SMXV-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-SMXV IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-SMXV-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-PREP.
           MOVE PPD-NUM-PREP-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-PREP IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-PREP-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-PLRE.
           MOVE PPD-NUM-PLRE-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-PLRE IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-PLRE-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-PRES.
           MOVE PPD-NUM-PRES-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-PRES IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-PRES-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-NUM-PNTE.
           MOVE PPD-NUM-PNTE-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-NUM-PNTE IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-NUM-PNTE-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       VAL-NUM-PPD-IIC-ICIC.
           MOVE PPD-IIC-ICIC-ALF IN PPD-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO PPD-IIC-ICIC IN PPD-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO PPD-IIC-ICIC-LEN IN PPD-FLD
                GO TO FIN-VAL-NUM-FLD-PPD.
       FIN-VAL-NUM-FLD-PPD.
           EXIT.
       
       EDT-KEY-PPD SECTION.
       INI-EDT-KEY-PPD.
           PERFORM EDT-IKY-PPD.
           PERFORM EDT-MKY-PPD.
           PERFORM EDT-AKY-PPD.
       FIN-EDT-KEY-PPD.
           EXIT.
       
       EDT-IKY-PPD SECTION.
       INI-EDT-IKY-PPD.
       FIN-EDT-IKY-PPD.
           EXIT.
       
       EDT-MKY-PPD SECTION.
       INI-EDT-MKY-PPD.
       FIN-EDT-MKY-PPD.
           EXIT.
       
       EDT-AKY-PPD SECTION.
       INI-EDT-AKY-PPD.
       FIN-EDT-AKY-PPD.
           EXIT.
       
       EDT-FLD-PPD SECTION.
       INI-EDT-FLD-PPD.
           IF PPD-VAL-CMIN-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-VAL-CMIN-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-VAL-CMIN IN PPD-FLD TO PPD-VAL-CMIN-EDT IN PPD-EDT.
           MOVE PPD-VAL-CMIN-EDT IN PPD-EDT TO 
                PPD-VAL-CMIN-ALF IN PPD-FLD.
           IF PPD-VAL-CMAX-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-VAL-CMAX-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-VAL-CMAX IN PPD-FLD TO PPD-VAL-CMAX-EDT IN PPD-EDT.
           MOVE PPD-VAL-CMAX-EDT IN PPD-EDT TO 
                PPD-VAL-CMAX-ALF IN PPD-FLD.
           IF PPD-NUM-PMIN-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-PMIN-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-PMIN IN PPD-FLD TO PPD-NUM-PMIN-EDT IN PPD-EDT.
           MOVE PPD-NUM-PMIN-EDT IN PPD-EDT TO 
                PPD-NUM-PMIN-ALF IN PPD-FLD.
           IF PPD-NUM-PMAX-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-PMAX-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-PMAX IN PPD-FLD TO PPD-NUM-PMAX-EDT IN PPD-EDT.
           MOVE PPD-NUM-PMAX-EDT IN PPD-EDT TO 
                PPD-NUM-PMAX-ALF IN PPD-FLD.
           IF PPD-NUM-VMIN-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-VMIN-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-VMIN IN PPD-FLD TO PPD-NUM-VMIN-EDT IN PPD-EDT.
           MOVE PPD-NUM-VMIN-EDT IN PPD-EDT TO 
                PPD-NUM-VMIN-ALF IN PPD-FLD.
           IF PPD-NUM-VMAX-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-VMAX-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-VMAX IN PPD-FLD TO PPD-NUM-VMAX-EDT IN PPD-EDT.
           MOVE PPD-NUM-VMAX-EDT IN PPD-EDT TO 
                PPD-NUM-VMAX-ALF IN PPD-FLD.
           IF PPD-NUM-SMNV-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-SMNV-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-SMNV IN PPD-FLD TO PPD-NUM-SMNV-EDT IN PPD-EDT.
           MOVE PPD-NUM-SMNV-EDT IN PPD-EDT TO 
                PPD-NUM-SMNV-ALF IN PPD-FLD.
           IF PPD-NUM-SMXV-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-SMXV-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-SMXV IN PPD-FLD TO PPD-NUM-SMXV-EDT IN PPD-EDT.
           MOVE PPD-NUM-SMXV-EDT IN PPD-EDT TO 
                PPD-NUM-SMXV-ALF IN PPD-FLD.
           IF PPD-NUM-PREP-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-PREP-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-PREP IN PPD-FLD TO PPD-NUM-PREP-EDT IN PPD-EDT.
           MOVE PPD-NUM-PREP-EDT IN PPD-EDT TO 
                PPD-NUM-PREP-ALF IN PPD-FLD.
           IF PPD-NUM-PLRE-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-PLRE-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-PLRE IN PPD-FLD TO PPD-NUM-PLRE-EDT IN PPD-EDT.
           MOVE PPD-NUM-PLRE-EDT IN PPD-EDT TO 
                PPD-NUM-PLRE-ALF IN PPD-FLD.
           IF PPD-NUM-PRES-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-PRES-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-PRES IN PPD-FLD TO PPD-NUM-PRES-EDT IN PPD-EDT.
           MOVE PPD-NUM-PRES-EDT IN PPD-EDT TO 
                PPD-NUM-PRES-ALF IN PPD-FLD.
           IF PPD-NUM-PNTE-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-NUM-PNTE-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-NUM-PNTE IN PPD-FLD TO PPD-NUM-PNTE-EDT IN PPD-EDT.
           MOVE PPD-NUM-PNTE-EDT IN PPD-EDT TO 
                PPD-NUM-PNTE-ALF IN PPD-FLD.
           IF PPD-IIC-ICIC-LEN IN PPD-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO PPD-IIC-ICIC-LEN IN PPD-FLD
                GO TO FIN-EDT-FLD-PPD.
           MOVE PPD-IIC-ICIC IN PPD-FLD TO PPD-IIC-ICIC-EDT IN PPD-EDT.
           MOVE PPD-IIC-ICIC-EDT IN PPD-EDT TO 
                PPD-IIC-ICIC-ALF IN PPD-FLD.
       FIN-EDT-FLD-PPD.
           EXIT.
