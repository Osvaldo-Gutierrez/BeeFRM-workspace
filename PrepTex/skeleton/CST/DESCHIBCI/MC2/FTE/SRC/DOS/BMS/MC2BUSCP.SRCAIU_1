      *
      * MC2BUSCP
      * Version 3.0.1 Nov-2005
      * 21-Feb-19 03:35 PM
      *
       SET-TAG-MC2BUSCP SECTION.
       INI-SET-TAG-MC2BUSCP.
           MOVE
           '<IDNMOD NOM=$MC2BUSCP$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$21-Feb-19 03:35 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-MC2BUSCP.
           EXIT.
           
       RET-ALL-SCP SECTION.
       INI-RET-ALL-SCP.
           PERFORM KEY-ALL-SCP.
           PERFORM RET-OPC-SCP.
           PERFORM RET-CAN-SCP.
           PERFORM RET-VEN-SCP.
       FIN-RET-ALL-SCP.
           EXIT.
       
       RET-OPC-SCP SECTION.
       INI-RET-OPC-SCP.
       FIN-RET-OPC-SCP.
           EXIT.
       
       RET-CAN-SCP SECTION.
       INI-RET-CAN-SCP.
       FIN-RET-CAN-SCP.
           EXIT.
       
       RET-VEN-SCP SECTION.
       INI-RET-VEN-SCP.
       FIN-RET-VEN-SCP.
           EXIT.
       
       KEY-ALL-SCP SECTION.
       INI-KEY-ALL-SCP.
           PERFORM KEY-OPC-SCP.
           PERFORM KEY-CAN-SCP.
           PERFORM KEY-VEN-SCP.
       FIN-KEY-ALL-SCP.
           EXIT.
       
       KEY-OPC-SCP SECTION.
       INI-KEY-OPC-SCP.
           MOVE OPC-CAI-IOPC IN SCP-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO OPC-IIC-IOPC IN OPC.
       FIN-KEY-OPC-SCP.
           EXIT.
       
       KEY-CAN-SCP SECTION.
       INI-KEY-CAN-SCP.
           MOVE CAN-NUM-ICAN IN SCP-FLD TO CAN-NUM-ICAN IN CAN.
       FIN-KEY-CAN-SCP.
           EXIT.
       
       KEY-VEN-SCP SECTION.
       INI-KEY-VEN-SCP.
           MOVE VEN-NUM-IVCT IN SCP-FLD TO VEN-NUM-IVCT IN VEN.
       FIN-KEY-VEN-SCP.
           EXIT.
       
       SCR-CLRA-SCP SECTION.
       INI-SCR-CLRA-SCP.
           PERFORM CLR-KEY-SCP.
           PERFORM CLR-FLD-SCP.
       FIN-SCR-CLRA-SCP.
           EXIT.
       
       CLR-KEY-SCP SECTION.
       INI-CLR-KEY-SCP.
           MOVE SPACES TO OPC-CAI-IOPC IN SCP-FLD.
           MOVE ZEROES TO OPC-IIC-IOPC IN SCP-FLD.
           MOVE ZEROES TO CAN-NUM-ICAN IN SCP-FLD.
           MOVE ZEROES TO VEN-NUM-IVCT IN SCP-FLD.
           MOVE SPACES TO FRM-COD-CPTO IN SCP-FLD.
           MOVE SPACES TO FRM-COD-CLAS IN SCP-FLD.
           MOVE SPACES TO FRM-COD-COMP IN SCP-FLD.
           MOVE ZEROES TO FRM-SGV-FACT IN SCP-FLD.
           MOVE SPACES TO FRM-CAI-ICVN IN SCP-FLD.
           MOVE ZEROES TO FRM-IIC-ICVN IN SCP-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-ICLI IN SCP-FLD.
           MOVE SPACES TO FRM-VRF-ICLI IN SCP-FLD.
           MOVE SPACES TO FRM-IND-ICLI IN SCP-FLD.
           MOVE SPACES TO FRM-GLS-ICLI IN SCP-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-VAL-TINF IN SCP-FLD.
           MOVE SPACES TO FRM-COD-TINF IN SCP-FLD.
           MOVE ZEROES TO FRM-VAL-CINF IN SCP-FLD.
       FIN-CLR-KEY-SCP.
           EXIT.
       
       CLR-FLD-SCP SECTION.
       INI-CLR-FLD-SCP.
           MOVE SPACES TO FRM-GLS-CPTO IN SCP-FLD.
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(1).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(2).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(3).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(4).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(5).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(6).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(7).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(8).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(9).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(10).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(1).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(2).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(3).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(4).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(5).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(6).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(7).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(8).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(9).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(10).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(1).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(2).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(3).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(4).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(5).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(6).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(7).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(8).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(9).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(10).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(1).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(2).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(3).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(4).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(5).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(6).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(7).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(8).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(9).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(10).
           MOVE SPACES TO FRM-CAI-IRCC IN SCP-FLD.
           MOVE SPACES TO FRM-IIC-IRCC IN SCP-FLD.
           MOVE ZEROES TO FRM-NUM-IRCC IN SCP-FLD.
           MOVE SPACES TO FRM-CAI-PLAN IN SCP-FLD.
           MOVE SPACES TO FRM-IIC-PLAN IN SCP-FLD.
           MOVE SPACES TO FRM-IND-TPLT IN SCP-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-FEC-PLAN IN SCP-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-HRA-PLAN IN SCP-FLD.
           MOVE SPACES TO FRM-COD-SIST IN SCP-FLD.
           MOVE SPACES TO FRM-COD-EVEN IN SCP-FLD.
           MOVE SPACES TO FRM-COD-MONE IN SCP-FLD.
           PERFORM CLR-OPC-SCP.
           PERFORM CLR-CAN-SCP.
           PERFORM CLR-VEN-SCP.
       FIN-CLR-FLD-SCP.
           EXIT.
       
       CLR-OPC-SCP SECTION.
       INI-CLR-OPC-SCP.
       FIN-CLR-OPC-SCP.
           EXIT.
       
       CLR-CAN-SCP SECTION.
       INI-CLR-CAN-SCP.
       FIN-CLR-CAN-SCP.
           EXIT.
       
       CLR-VEN-SCP SECTION.
       INI-CLR-VEN-SCP.
       FIN-CLR-VEN-SCP.
           EXIT.
       
       FST-KEY-SCP SECTION.
       INI-FST-KEY-SCP.
           MOVE -1 TO OPC-CAI-IOPC-LEN IN SCP-FLD.
       FIN-FST-KEY-SCP.
           EXIT.
       
       FST-FLD-SCP SECTION.
       INI-FST-FLD-SCP.
           MOVE -1 TO FRM-IND-SELC-LEN IN SCP-FLD(1).
       FIN-FST-FLD-SCP.
           EXIT.
       
       PRO-KEY-SCP SECTION.
       INI-PRO-KEY-SCP.
           MOVE FRM-CPIM-AEY TO FRM-COD-CPTO-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-CLAS-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-COMP-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-SGV-FACT-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-CAI-ICVN-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IIC-ICVN-ATR IN SCP-FLD.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN SCP-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO FRM-VAL-TINF-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-COD-TINF-ATR IN SCP-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VAL-CINF-ATR IN SCP-FLD.
           PERFORM PRO-MKY-SCP.
       FIN-PRO-KEY-SCP.
           EXIT.
       
       PRO-MKY-SCP SECTION.
       INI-PRO-MKY-SCP.
       FIN-PRO-MKY-SCP.
           EXIT.
       
       PRO-FLD-SCP SECTION.
       INI-PRO-FLD-SCP.
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(9).
           MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(10).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(9).
           MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(10).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(1).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(2).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(3).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(4).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(5).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(6).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(7).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(8).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(9).
           MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(10).
           PERFORM PRO-OPC-SCP.
           PERFORM PRO-CAN-SCP.
           PERFORM PRO-VEN-SCP.
       FIN-PRO-FLD-SCP.
           EXIT.
       
       PRO-OPC-SCP SECTION.
       INI-PRO-OPC-SCP.
       FIN-PRO-OPC-SCP.
           EXIT.
       
       PRO-CAN-SCP SECTION.
       INI-PRO-CAN-SCP.
       FIN-PRO-CAN-SCP.
           EXIT.
       
       PRO-VEN-SCP SECTION.
       INI-PRO-VEN-SCP.
       FIN-PRO-VEN-SCP.
           EXIT.
       
       UNP-KEY-SCP SECTION.
       INI-UNP-KEY-SCP.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPTO-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-CLAS-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-COMP-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-SGV-FACT-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-CAI-ICVN-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IIC-ICVN-ATR IN SCP-FLD.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN SCP-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-VAL-TINF-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-COD-TINF-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VAL-CINF-ATR IN SCP-FLD.
           PERFORM UNP-IKY-SCP.
           PERFORM UNP-AKY-SCP.
           PERFORM UNP-MKY-SCP.
      *<<<< FIN_UNP_KEY_SCP
       CON-FIN-UNP-KEY-SCP.
      *PVG INI 09-JUN-2010                                              
           IF SCR-IND-SMDS IN SCR-VARI = 'N'                            
              MOVE FRM-CPIM-AEY TO FRM-CAI-ICVN-ATR IN SCP-FLD          
              MOVE FRM-CPIM-AEY TO FRM-IIC-ICVN-ATR IN SCP-FLD          
              MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN SCP-FLD          
              MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN SCP-FLD          
              MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN SCP-FLD          
              MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN SCP-FLD.         
      *PVG FIN 09-JUN-2010
       FIN-UNP-KEY-SCP.
           EXIT.
       
       UNP-IKY-SCP SECTION.
       INI-UNP-IKY-SCP.
           MOVE FRM-CPIM-UBY TO OPC-CAI-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO OPC-IIC-IOPC-ATR.
           MOVE FRM-CPIM-UBY TO FRM-COD-CPTO-ATR.
           MOVE FRM-CPIM-UBY TO FRM-COD-CLAS-ATR.
           MOVE FRM-CPIM-UBY TO FRM-COD-COMP-ATR.
           MOVE FRM-CPIM-UBY TO FRM-SGV-FACT-ATR.
           MOVE FRM-CPIM-UBY TO FRM-CAI-ICVN-ATR.
           MOVE FRM-CPIM-UBY TO FRM-IIC-ICVN-ATR.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLI-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLI-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLI-ATR IN SCP-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLI-ATR IN SCP-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-VAL-TINF-ATR.
           MOVE FRM-CPIM-UBY TO FRM-COD-TINF-ATR.
           MOVE FRM-CPIM-UBY TO FRM-VAL-CINF-ATR.
       FIN-UNP-IKY-SCP.
           EXIT.
       
       UNP-MKY-SCP SECTION.
       INI-UNP-MKY-SCP.
       FIN-UNP-MKY-SCP.
           EXIT.
       
       UNP-AKY-SCP SECTION.
       INI-UNP-AKY-SCP.
           MOVE FRM-CPIM-UBY TO CAN-NUM-ICAN-ATR.
           MOVE FRM-CPIM-UBY TO VEN-NUM-IVCT-ATR.
       FIN-UNP-AKY-SCP.
           EXIT.
       
       UNP-FLD-SCP SECTION.
       INI-UNP-FLD-SCP.
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-IND-SELC-ATR IN SCP-FLD(10).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-VAL-MNTO-ATR IN SCP-FLD(10).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(1).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(2).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(3).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(4).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(5).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(6).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(7).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(8).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(9).
           MOVE FRM-CPIM-UBY TO FRM-COD-VCOC-ATR IN SCP-FLD(10).
           PERFORM UNP-OPC-SCP.
           PERFORM UNP-CAN-SCP.
           PERFORM UNP-VEN-SCP.
      *<<<< FIN_UNP_FLD_SCP                                             
           IF FRM-COD-CPTO IN SCP-FLD = 'INT' OR 'PPC'                  
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(1)      
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(2)      
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(3)      
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(4)      
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(5)      
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(6)      
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(7)      
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(8)      
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(9)      
               MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(10).    
      *PVG INI 09-JUN-2010                                              
           IF FRM-COD-SEGU IN SCP-FLD(1)  NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(1)       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(1).      
           IF FRM-COD-SEGU IN SCP-FLD(2)  NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(2)       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(2).      
           IF FRM-COD-SEGU IN SCP-FLD(3)  NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(3)       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(3).      
           IF FRM-COD-SEGU IN SCP-FLD(4)  NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(4)       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(4).      
           IF FRM-COD-SEGU IN SCP-FLD(5)  NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(5)       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(5).      
           IF FRM-COD-SEGU IN SCP-FLD(6)  NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(6)       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(6).      
           IF FRM-COD-SEGU IN SCP-FLD(7)  NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(7)       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(7).      
           IF FRM-COD-SEGU IN SCP-FLD(8)  NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(8)       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(8).      
           IF FRM-COD-SEGU IN SCP-FLD(9)  NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(9)       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(9).      
           IF FRM-COD-SEGU IN SCP-FLD(10) NOT = 'INF'                   
              MOVE FRM-CPIM-AEY TO FRM-VAL-MNTO-ATR IN SCP-FLD(10)      
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(10).     
      *PVG FIN 09-JUN-2010                                              
      *PVG INI 15-MAR-2010 MANEJA DEPENDENCIA-EXCLUSION DE SEGUROS
           IF FRM-COD-TSEG IN SCP-FLD(1) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(1).
           IF FRM-COD-TSEG IN SCP-FLD(2) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(2).
           IF FRM-COD-TSEG IN SCP-FLD(3) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(3).
           IF FRM-COD-TSEG IN SCP-FLD(4) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(4).
           IF FRM-COD-TSEG IN SCP-FLD(5) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(5).
           IF FRM-COD-TSEG IN SCP-FLD(6) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(6).
           IF FRM-COD-TSEG IN SCP-FLD(7) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(7).
           IF FRM-COD-TSEG IN SCP-FLD(8) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(8).
           IF FRM-COD-TSEG IN SCP-FLD(9) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(9).
           IF FRM-COD-TSEG IN SCP-FLD(10) NOT > SPACES
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(10).
      *PVG FIN 15-MAR-2010
      *PVG INI 09-JUN-2010                                              
           IF NOT FRM-COD-CPTO IN SCP-FLD = 'CCM'                       
      *PVG INI 15-NOV-2011
      *       GO TO FIN-UNP-FLD-SCP.
              GO TO CNT-UNP-FLD-SCP.
      *PVG FIN 15-NOV-2011
      *MANEJO DE CAMPOS PARA CONCEPTO COMISIONES                        
           IF FRM-IND-SELC IN SCP-FLD(1) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(1).
           IF FRM-IND-SELC IN SCP-FLD(2) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(2).
           IF FRM-IND-SELC IN SCP-FLD(3) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(3).
           IF FRM-IND-SELC IN SCP-FLD(4) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(4).
           IF FRM-IND-SELC IN SCP-FLD(5) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(5).
           IF FRM-IND-SELC IN SCP-FLD(6) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(6).
           IF FRM-IND-SELC IN SCP-FLD(7) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(7).
           IF FRM-IND-SELC IN SCP-FLD(8) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(8).
           IF FRM-IND-SELC IN SCP-FLD(9) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(9).
           IF FRM-IND-SELC IN SCP-FLD(10) = 'S'
              MOVE FRM-CPIM-AEY TO FRM-IND-SELC-ATR IN SCP-FLD(10).
      *PVG INI 15-NOV-2011
       CNT-UNP-FLD-SCP.
      *PVG FIN 15-NOV-2011
           IF FRM-COD-SEGU IN SCP-FLD(1) = 'INF'                        
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(1).      
           IF FRM-COD-SEGU IN SCP-FLD(2) = 'INF'                        
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(2).      
           IF FRM-COD-SEGU IN SCP-FLD(3) = 'INF'                        
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(3).      
           IF FRM-COD-SEGU IN SCP-FLD(4) = 'INF'                        
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(4).      
           IF FRM-COD-SEGU IN SCP-FLD(5) = 'INF'                        
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(5).      
           IF FRM-COD-SEGU IN SCP-FLD(6) = 'INF'                        
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(6).      
           IF FRM-COD-SEGU IN SCP-FLD(7) = 'INF'                        
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(7).      
           IF FRM-COD-SEGU IN SCP-FLD(8) = 'INF'                        
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(8).      
           IF FRM-COD-SEGU IN SCP-FLD(9) = 'INF'                        
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(9).      
           IF FRM-COD-SEGU IN SCP-FLD(10) = 'INF'                       
              MOVE FRM-CPIM-AEY TO FRM-COD-VCOC-ATR IN SCP-FLD(10).     
      *PVG FIN 09-JUN-2010 
      *>>>>
       FIN-UNP-FLD-SCP.
           EXIT.
       
       UNP-OPC-SCP SECTION.
       INI-UNP-OPC-SCP.
       FIN-UNP-OPC-SCP.
           EXIT.
       
       UNP-CAN-SCP SECTION.
       INI-UNP-CAN-SCP.
       FIN-UNP-CAN-SCP.
           EXIT.
       
       UNP-VEN-SCP SECTION.
       INI-UNP-VEN-SCP.
       FIN-UNP-VEN-SCP.
           EXIT.
       
       VAL-MKY-SCP SECTION.
       INI-VAL-MKY-SCP.
       FIN-VAL-MKY-SCP.
           EXIT.
       
       VAL-FLD-SCP SECTION.
       INI-VAL-FLD-SCP.
           PERFORM VAL-FRM-GLS-CPTO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CPTO-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-IND-SELC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 10
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-IND-SELC-LEN IN SCP-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-GLS-SELC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 10
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-GLS-SELC-LEN IN SCP-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-COD-TSEG
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 10
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-TSEG-LEN IN SCP-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-GLS-TSEG
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 10
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-GLS-TSEG-LEN IN SCP-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-COD-OCOB
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 10
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-OCOB-LEN IN SCP-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-COD-SEGU
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 10
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-SEGU-LEN IN SCP-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-VAL-MNTO
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 10
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-VAL-MNTO-LEN IN SCP-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-COD-VCOC
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 10
                OR FRM-SUAR = FRM-SUAR-MAL
                OR FRM-SUAR = FRM-SUAR-CLR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                SUBTRACT 1 FROM FRM-IFLD
                MOVE FRM-IND-ERRO TO 
                FRM-COD-VCOC-LEN IN SCP-FLD(FRM-IFLD)
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-CAI-IRCC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-CAI-IRCC-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-IIC-IRCC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IIC-IRCC-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-NUM-IRCC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-NUM-IRCC-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-CAI-PLAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-CAI-PLAN-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-IIC-PLAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IIC-PLAN-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-IND-TPLT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-IND-TPLT-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-FEC-PLAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FRM-FEC-PLAN-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FRM-HRA-PLAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-HRA-PLAN-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-COD-SIST.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-SIST-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-COD-EVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-EVEN-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
           PERFORM VAL-FRM-COD-MONE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-COD-MONE-LEN IN SCP-FLD
                GO TO FIN-VAL-FLD-SCP.
       FIN-VAL-FLD-SCP.
           EXIT.
       
       VAL-FRM-GLS-CPTO SECTION.
       INI-VAL-FRM-GLS-CPTO.
       FIN-VAL-FRM-GLS-CPTO.
           EXIT.
       
       VAL-FRM-IND-SELC SECTION.
       INI-VAL-FRM-IND-SELC.
           IF FRM-IND-SELC IN SCP-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(FRM-IFLD).
      *<<<< FRM_IND_SELC                                                
      *PVG INI 23-MAY-2014
          IF FRM-IND-SELC IN SCP-FLD(FRM-IFLD) > SPACES                
              MOVE 'GNS' TO TAB-COD-SIST                               
              MOVE 'SON' TO TAB-COD-TTAB IN TAB                        
              MOVE FRM-IND-SELC IN SCP-FLD(FRM-IFLD) TO                
                     TAB-COD-CTAB IN TAB                               
              PERFORM VAL-COD                                          
              IF MSG-COD-MENS = 'COD    NEX'                           
                   MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(FRM-IFLD)    
              ELSE                                                     
                   MOVE TAB-GLS-ABRV IN TAB TO                         
                   FRM-GLS-SELC IN SCP-FLD(FRM-IFLD).                  
      *PVG FIN 23-MAY-2014
                                                                        
      *PVG INI 15-MAR-2010 MANEJA DEPENDENCIA-EXCLUSION DE SEGUROS
           IF FRM-COD-TSEG IN SCP-FLD(FRM-IFLD) > SPACES AND
              FRM-IND-SELC IN SCP-FLD(FRM-IFLD) NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-IND-SELC.
      *PVG FIN 15-MAR-2010
      *>>>>                                                             
       FIN-VAL-FRM-IND-SELC.
           EXIT.
       
       VAL-FRM-GLS-SELC SECTION.
       INI-VAL-FRM-GLS-SELC.
       FIN-VAL-FRM-GLS-SELC.
           EXIT.
       
       VAL-FRM-COD-TSEG SECTION.
       INI-VAL-FRM-COD-TSEG.
       FIN-VAL-FRM-COD-TSEG.
           EXIT.
       
       VAL-FRM-GLS-TSEG SECTION.
       INI-VAL-FRM-GLS-TSEG.
       FIN-VAL-FRM-GLS-TSEG.
           EXIT.
       
       VAL-FRM-COD-OCOB SECTION.
       INI-VAL-FRM-COD-OCOB.
       FIN-VAL-FRM-COD-OCOB.
           EXIT.
       
       VAL-FRM-COD-SEGU SECTION.
       INI-VAL-FRM-COD-SEGU.
       FIN-VAL-FRM-COD-SEGU.
           EXIT.
       
       VAL-FRM-VAL-MNTO SECTION.
       INI-VAL-FRM-VAL-MNTO.
      *<<<< FRM_VAL_MNTO
      *PVG INI 09-JUN-2010 OPCION SCP                                   
           IF FRM-IND-SELC IN SCP-FLD(FRM-IFLD) = 'S'   AND             
              FRM-COD-SEGU IN SCP-FLD(FRM-IFLD) = 'INF' AND             
              FRM-VAL-MNTO IN SCP-FLD(FRM-IFLD) NOT > ZEROES            
              PERFORM ERR-GLS                                           
              GO TO FIN-VAL-FRM-VAL-MNTO.                               
      *PVG FIN 09-JUN-2010                                              
      *>>>>
       FIN-VAL-FRM-VAL-MNTO.
           EXIT.
       
       VAL-FRM-COD-VCOC SECTION.
       INI-VAL-FRM-COD-VCOC.
           IF FRM-COD-VCOC IN SCP-FLD(FRM-IFLD) NOT > SPACES
              MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(FRM-IFLD).
      *<<<< FRM_COD_VCOC
                                                                        
           IF FRM-COD-VCOC IN SCP-FLD(FRM-IFLD) > SPACES                
              MOVE 'TAB' TO TAB-COD-SIST                                
              MOVE 'VLR' TO TAB-COD-TTAB IN TAB                         
              MOVE FRM-COD-VCOC IN SCP-FLD(FRM-IFLD)                    
                         TO TAB-COD-CTAB IN TAB                         
              PERFORM VAL-COD.                                          
      *>>>>
       FIN-VAL-FRM-COD-VCOC.
           EXIT.
       
       VAL-FRM-CAI-IRCC SECTION.
       INI-VAL-FRM-CAI-IRCC.
       FIN-VAL-FRM-CAI-IRCC.
           EXIT.
       
       VAL-FRM-IIC-IRCC SECTION.
       INI-VAL-FRM-IIC-IRCC.
       FIN-VAL-FRM-IIC-IRCC.
           EXIT.
       
       VAL-FRM-NUM-IRCC SECTION.
       INI-VAL-FRM-NUM-IRCC.
       FIN-VAL-FRM-NUM-IRCC.
           EXIT.
       
       VAL-FRM-CAI-PLAN SECTION.
       INI-VAL-FRM-CAI-PLAN.
       FIN-VAL-FRM-CAI-PLAN.
           EXIT.
       
       VAL-FRM-IIC-PLAN SECTION.
       INI-VAL-FRM-IIC-PLAN.
       FIN-VAL-FRM-IIC-PLAN.
           EXIT.
       
       VAL-FRM-IND-TPLT SECTION.
       INI-VAL-FRM-IND-TPLT.
       FIN-VAL-FRM-IND-TPLT.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-FRM-FEC-PLAN SECTION.
       INI-VAL-FRM-FEC-PLAN.
           IF FRM-FEC-PLAN IN SCP-FLD  NOT > ZEROES
              MOVE ZEROES TO FRM-FEC-PLAN IN SCP-FLD.
       FIN-VAL-FRM-FEC-PLAN.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-FRM-HRA-PLAN SECTION.
       INI-VAL-FRM-HRA-PLAN.
       FIN-VAL-FRM-HRA-PLAN.
           EXIT.
       
       VAL-FRM-COD-SIST SECTION.
       INI-VAL-FRM-COD-SIST.
       FIN-VAL-FRM-COD-SIST.
           EXIT.
       
       VAL-FRM-COD-EVEN SECTION.
       INI-VAL-FRM-COD-EVEN.
       FIN-VAL-FRM-COD-EVEN.
           EXIT.
       
       VAL-FRM-COD-MONE SECTION.
       INI-VAL-FRM-COD-MONE.
       FIN-VAL-FRM-COD-MONE.
           EXIT.
       
       VAL-CON-FLD-SCP SECTION.
       INI-VAL-CON-FLD-SCP.
      *<<<< VAL_CON_FLD_SCP
      *PVG INI 15-MAR-2010 MANEJA DEPENDENCIA-EXCLUSION DE SEGUROS
           MOVE 'N' TO WSS-IND-EVAD IN WSS-VAD.
           PERFORM VAL-CON-TVAD
            VARYING WSS-VAD-I FROM 1 BY 1 UNTIL WSS-VAD-I > 10
                 OR FRM-COD-TSEG IN SCP-FLD(WSS-VAD-I) NOT > SPACES
                 OR WSS-IND-EVAD IN WSS-VAD = 'S'.

           IF WSS-IND-EVAD IN WSS-VAD = 'S'
              SUBTRACT 1 FROM WSS-VAD-I
              MOVE WSS-VAD-MENS TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE 'S'          TO FRM-UCUR
              MOVE FRM-POS-CURS TO
                   FRM-IND-SELC-LEN IN SCP-FLD(WSS-VAD-I).
      *PVG FIN 15-MAR-2010
      *>>>>
       FIN-VAL-CON-FLD-SCP.
           EXIT.
       
       VAL-CON-SCP SECTION.
       INI-VAL-CON-SCP.
       FIN-VAL-CON-SCP.
           EXIT.
       
       VAL-NUM-KEY-SCP SECTION.
       INI-VAL-NUM-KEY-SCP.
           PERFORM VAL-NUM-IKY-SCP.
           PERFORM VAL-NUM-MKY-SCP.
           PERFORM VAL-NUM-AKY-SCP.
       FIN-VAL-NUM-KEY-SCP.
           EXIT.
       
       VAL-NUM-IKY-SCP SECTION.
       INI-VAL-NUM-IKY-SCP.
       VAL-NUM-OPC-IIC-IOPC.
           MOVE OPC-IIC-IOPC-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO OPC-IIC-IOPC IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OPC-IIC-IOPC-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-IKY-SCP.
       VAL-NUM-FRM-SGV-FACT.
           MOVE FRM-SGV-FACT-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO FRM-SGV-FACT IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-FACT-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-IKY-SCP.
       VAL-NUM-FRM-IIC-ICVN.
           MOVE FRM-IIC-ICVN-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-IIC-ICVN IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-IIC-ICVN-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-IKY-SCP.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-ICLI.
           MOVE FRM-NUM-ICLI-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLI IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLI-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-IKY-SCP.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-VAL-TINF.
           MOVE FRM-VAL-TINF-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-VAL-TINF IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-TINF-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-IKY-SCP.
       VAL-NUM-FRM-VAL-CINF.
           MOVE FRM-VAL-CINF-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-VAL-CINF IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-CINF-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-IKY-SCP.
       FIN-VAL-NUM-IKY-SCP.
           EXIT.
       
       VAL-NUM-MKY-SCP SECTION.
       INI-VAL-NUM-MKY-SCP.
       FIN-VAL-NUM-MKY-SCP.
           EXIT.
       
       VAL-NUM-AKY-SCP SECTION.
       INI-VAL-NUM-AKY-SCP.
       VAL-NUM-CAN-NUM-ICAN.
           MOVE CAN-NUM-ICAN-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CAN-NUM-ICAN IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CAN-NUM-ICAN-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-AKY-SCP.
       VAL-NUM-VEN-NUM-IVCT.
           MOVE VEN-NUM-IVCT-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO VEN-NUM-IVCT IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO VEN-NUM-IVCT-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-AKY-SCP.
       FIN-VAL-NUM-AKY-SCP.
           EXIT.
       
       VAL-NUM-FLD-SCP SECTION.
       INI-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-1.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(1) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(1)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(1)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-2.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(2) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(2)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(2)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-3.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(3) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(3)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(3)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-4.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(4) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(4)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(4)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-5.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(5) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(5)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(5)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-6.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(6) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(6)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(6)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-7.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(7) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(7)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(7)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-8.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(8) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(8)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(8)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-9.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(9) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(9)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(9)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-VAL-MNTO-10.
           MOVE FRM-VAL-MNTO-ALF IN SCP-FLD(10) TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO FRM-VAL-MNTO IN SCP-FLD(10)
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-MNTO-LEN IN SCP-FLD(10)
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-NUM-IRCC.
           MOVE FRM-NUM-IRCC-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-IRCC IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-IRCC-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-FLD-SCP.
       VAL-NUM-FRM-HRA-PLAN.
           MOVE FRM-HRA-PLAN-ALF IN SCP-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 6 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-HRA-PLAN IN SCP-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-HRA-PLAN-LEN IN SCP-FLD
                GO TO FIN-VAL-NUM-FLD-SCP.
       FIN-VAL-NUM-FLD-SCP.
           EXIT.
       
       EDT-KEY-SCP SECTION.
       INI-EDT-KEY-SCP.
           PERFORM EDT-IKY-SCP.
           PERFORM EDT-MKY-SCP.
           PERFORM EDT-AKY-SCP.
       FIN-EDT-KEY-SCP.
           EXIT.
       
       EDT-IKY-SCP SECTION.
       INI-EDT-IKY-SCP.
           IF OPC-IIC-IOPC-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPC-IIC-IOPC-LEN IN SCP-FLD
                GO TO FIN-EDT-IKY-SCP.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO OPC-IIC-IOPC-EDT IN SCP-EDT.
           MOVE OPC-IIC-IOPC-EDT IN SCP-EDT TO 
                OPC-IIC-IOPC-ALF IN SCP-FLD.
           IF FRM-SGV-FACT-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-FACT-LEN IN SCP-FLD
                GO TO FIN-EDT-IKY-SCP.
           MOVE FRM-SGV-FACT IN SCP-FLD TO FRM-SGV-FACT-EDT IN SCP-EDT.
           MOVE FRM-SGV-FACT-EDT IN SCP-EDT TO 
                FRM-SGV-FACT-ALF IN SCP-FLD.
           IF FRM-IIC-ICVN-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-IIC-ICVN-LEN IN SCP-FLD
                GO TO FIN-EDT-IKY-SCP.
           MOVE FRM-IIC-ICVN IN SCP-FLD TO FRM-IIC-ICVN-EDT IN SCP-EDT.
           MOVE FRM-IIC-ICVN-EDT IN SCP-EDT TO 
                FRM-IIC-ICVN-ALF IN SCP-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-ICLI-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLI-LEN IN SCP-FLD
                GO TO FIN-EDT-IKY-SCP.
           MOVE FRM-NUM-ICLI IN SCP-FLD TO
                FRM-NUM-ICLI-EDT IN SCP-EDT.
           MOVE FRM-NUM-ICLI-EDT IN SCP-EDT TO
                FRM-NUM-ICLI-ALF IN SCP-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-VAL-TINF-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-TINF-LEN IN SCP-FLD
                GO TO FIN-EDT-IKY-SCP.
           MOVE FRM-VAL-TINF IN SCP-FLD TO FRM-VAL-TINF-EDT IN SCP-EDT.
           MOVE FRM-VAL-TINF-EDT IN SCP-EDT TO 
                FRM-VAL-TINF-ALF IN SCP-FLD.
           IF FRM-VAL-CINF-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-CINF-LEN IN SCP-FLD
                GO TO FIN-EDT-IKY-SCP.
           MOVE FRM-VAL-CINF IN SCP-FLD TO FRM-VAL-CINF-EDT IN SCP-EDT.
           MOVE FRM-VAL-CINF-EDT IN SCP-EDT TO 
                FRM-VAL-CINF-ALF IN SCP-FLD.
       FIN-EDT-IKY-SCP.
           EXIT.
       
       EDT-MKY-SCP SECTION.
       INI-EDT-MKY-SCP.
       FIN-EDT-MKY-SCP.
           EXIT.
       
       EDT-AKY-SCP SECTION.
       INI-EDT-AKY-SCP.
           IF CAN-NUM-ICAN-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CAN-NUM-ICAN-LEN IN SCP-FLD
                GO TO FIN-EDT-AKY-SCP.
           MOVE CAN-NUM-ICAN IN SCP-FLD TO CAN-NUM-ICAN-EDT IN SCP-EDT.
           MOVE CAN-NUM-ICAN-EDT IN SCP-EDT TO 
                CAN-NUM-ICAN-ALF IN SCP-FLD.
           IF VEN-NUM-IVCT-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO VEN-NUM-IVCT-LEN IN SCP-FLD
                GO TO FIN-EDT-AKY-SCP.
           MOVE VEN-NUM-IVCT IN SCP-FLD TO VEN-NUM-IVCT-EDT IN SCP-EDT.
           MOVE VEN-NUM-IVCT-EDT IN SCP-EDT TO 
                VEN-NUM-IVCT-ALF IN SCP-FLD.
       FIN-EDT-AKY-SCP.
           EXIT.
       
       EDT-FLD-SCP SECTION.
       INI-EDT-FLD-SCP.
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(1) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(1)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(1) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(1).
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(2) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(2)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(2) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(2).
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(3) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(3)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(3) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(3).
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(4) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(4)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(4) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(4).
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(5) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(5)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(5) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(5).
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(6) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(6)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(6) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(6).
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(7) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(7)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(7) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(7).
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(8) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(8)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(8) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(8).
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(9) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(9)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(9) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(9).
           IF FRM-VAL-MNTO-LEN IN SCP-FLD(10) = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-MNTO-LEN IN SCP-FLD(10)
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-VAL-MNTO IN SCP-FLD(10) TO 
                FRM-VAL-MNTO-EDT IN SCP-EDT.
           MOVE FRM-VAL-MNTO-EDT IN SCP-EDT TO 
                FRM-VAL-MNTO-ALF IN SCP-FLD(10).
           IF FRM-NUM-IRCC-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-IRCC-LEN IN SCP-FLD
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-NUM-IRCC IN SCP-FLD TO FRM-NUM-IRCC-EDT IN SCP-EDT.
           MOVE FRM-NUM-IRCC-EDT IN SCP-EDT TO 
                FRM-NUM-IRCC-ALF IN SCP-FLD.
           IF FRM-HRA-PLAN-LEN IN SCP-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-HRA-PLAN-LEN IN SCP-FLD
                GO TO FIN-EDT-FLD-SCP.
           MOVE FRM-HRA-PLAN IN SCP-FLD TO FRM-HRA-PLAN-EDT IN SCP-EDT.
           MOVE FRM-HRA-PLAN-EDT IN SCP-EDT TO 
                FRM-HRA-PLAN-ALF IN SCP-FLD.
      *<<<< FIN_EDT_FLD_SCP                                             
           MOVE SCP-FLD TO SCR-SCP-FLD.                                 
      *>>>>
       FIN-EDT-FLD-SCP.
           EXIT.
      *<<<< EOF_BU
      *PVG INI 15-MAR-2010 MANEJA DEPENDENCIA-EXCLUSION DE SEGUROS
       VAL-CON-TVAD SECTION.
       INI-VAL-CON-TVAD.
           IF FRM-IND-SELC IN SCP-FLD(WSS-VAD-I) = 'N'
              GO TO FIN-VAL-CON-TVAD.

           MOVE 'TAB' TO TAB-COD-SIST FIO-SIST.
           MOVE 'VAD' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TSEG IN SCP-FLD(WSS-VAD-I)
                      TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              GO TO FIN-VAL-CON-TVAD.
           IF TAB-GLS-DATA IN TAB NOT > SPACES
              GO TO FIN-VAL-CON-TVAD.
           MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DVAD.

           PERFORM CHQ-VAD-SOBL
            VARYING WSS-VAD-J FROM 1 BY 1 UNTIL WSS-VAD-J > 10
                 OR WSS-IND-EVAD IN WSS-VAD = 'S'.
           IF WSS-IND-EVAD IN WSS-VAD = 'S'
              GO TO FIN-VAL-CON-TVAD.

           PERFORM CHQ-VAD-SEXC
            VARYING WSS-VAD-J FROM 11 BY 1 UNTIL WSS-VAD-J > 20
                 OR WSS-IND-EVAD IN WSS-VAD = 'S'.
       FIN-VAL-CON-TVAD.
           EXIT.
       CHQ-VAD-SOBL SECTION.
       INI-CHQ-VAD-SOBL.
           IF WSS-COD-VVAD(WSS-VAD-J) NOT > SPACES
              GO TO FIN-CHQ-VAD-SOBL.
           PERFORM CHK-VEC-TSEG
            VARYING WSS-VAD-K FROM 1 BY 1 UNTIL WSS-VAD-K > 10
                 OR
                 ( FRM-IND-SELC IN SCP-FLD(WSS-VAD-K) = 'N'
                 AND
                   FRM-COD-TSEG IN SCP-FLD(WSS-VAD-K) =
                   WSS-COD-VVAD(WSS-VAD-J)
                 ).
           IF WSS-VAD-K > 10
              GO TO FIN-CHQ-VAD-SOBL.

           MOVE 'S' TO WSS-IND-EVAD IN WSS-VAD.
           MOVE 'PARA SELECCIONAR '                    TO WSS-GLS-MNS1.
           MOVE FRM-COD-TSEG IN SCP-FLD(WSS-VAD-I)     TO WSS-GLS-MNS2.
           MOVE ' DEBE INCLUIR '                       TO WSS-GLS-MNS3.
           MOVE WSS-COD-VVAD(WSS-VAD-J)                TO WSS-GLS-MNS4.
           MOVE '    VER DETALLE EN TABLA VAD CODIGO ' TO WSS-GLS-MNS5.
           MOVE FRM-COD-TSEG IN SCP-FLD(WSS-VAD-I)     TO WSS-GLS-MNS6.
           MOVE SPACES                                 TO WSS-GLS-MNS7.
       FIN-CHQ-VAD-SOBL.
           EXIT.
       CHQ-VAD-SEXC SECTION.
       INI-CHQ-VAD-SEXC.
           IF WSS-COD-VVAD(WSS-VAD-J) NOT > SPACES
              GO TO FIN-CHQ-VAD-SEXC.

           PERFORM CHK-VEC-TSEG
            VARYING WSS-VAD-K FROM 1 BY 1 UNTIL WSS-VAD-K > 10
                 OR
                 ( FRM-IND-SELC IN SCP-FLD(WSS-VAD-K) = 'S'
                 AND
                   FRM-COD-TSEG IN SCP-FLD(WSS-VAD-K) =
                   WSS-COD-VVAD(WSS-VAD-J)
                 ).
           IF WSS-VAD-K > 10
              GO TO FIN-CHQ-VAD-SEXC.

           MOVE 'S' TO WSS-IND-EVAD IN WSS-VAD.
           MOVE 'PARA SELECCIONAR '                    TO WSS-GLS-MNS1.
           MOVE FRM-COD-TSEG IN SCP-FLD(WSS-VAD-I)     TO WSS-GLS-MNS2.
           MOVE ' DEBE EXCLUIR '                       TO WSS-GLS-MNS3.
           MOVE WSS-COD-VVAD(WSS-VAD-J)                TO WSS-GLS-MNS4.
           MOVE '    VER DETALLE EN TABLA VAD CODIGO ' TO WSS-GLS-MNS5.
           MOVE FRM-COD-TSEG IN SCP-FLD(WSS-VAD-I)     TO WSS-GLS-MNS6.
           MOVE SPACES                                 TO WSS-GLS-MNS7.
       FIN-CHQ-VAD-SEXC.
           EXIT.
      *PVG FIN 15-MAR-2010
      *>>>>
