*% IF SETTAG
*% FNCBQ = "180122"
*% VSNBQ = "01-00"
*% FNCBU = "180122"
*% VSNBU = "01-00"
*% END
*% IF FRM_BGC_BNCA
      *<<<< FRM_BGC_BNCA
           MOVE WCC-SGC IN WSS-VARI TO FIO-SIST.
           MOVE WCC-BAN IN WSS-VARI TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FRM-BGC-BNCA IN IGC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS01   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-BNCA.
               
           IF TAB-IND-VIGE IN TAB NOT = WCC-S
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS02   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-BNCA.
      *>>>>
*% END

*% IF FRM_BGC_PROD
      *<<<< FRM_BGC_PROD
           MOVE WCC-TAB IN WSS-VARI TO FIO-SIST.
           MOVE WCC-TIO IN WSS-VARI TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FRM-BGC-PROD IN IGC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS03   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-PROD.
               
           IF TAB-IND-VIGE IN TAB NOT = WCC-S
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS04   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-PROD.
      *>>>>
*% END

*% IF FRM_BGC_TCLI
      *<<<< FRM_BGC_TCLI
           IF FRM-BGC-TCLI = WCC-AST IN WSS-VARI
              GO TO FIN-VAL-FRM-BGC-TCLI.

           MOVE WCC-SGC  IN WSS-VARI TO FIO-SIST.
           MOVE WCC-TICL  IN WSS-VARI TO MSC-COD-TMSC IN MSC.
           MOVE FRM-BGC-TCLI IN IGC-FLD TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS05   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-TCLI.

           IF MSC-IND-VIGE IN MSC NOT = WCC-S
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS06   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-TCLI.
      *>>>>
*% END

*% IF FRM_BGC_CATE
      *<<<< FRM_BGC_CATE
           IF FRM-BGC-CATE = WCC-AST IN WSS-VARI
              GO TO FIN-VAL-FRM-BGC-CATE.

           IF FRM-BGC-TCLI NOT = WCC-E
              MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
              MOVE WCC-GLS-MS07   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-BGC-CATE.

           MOVE WCC-SGC  IN WSS-VARI TO FIO-SIST.
           MOVE WCC-CATE  IN WSS-VARI TO MSC-COD-TMSC IN MSC.
           MOVE FRM-BGC-CATE IN IGC-FLD TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS08   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-CATE.
               
           IF MSC-IND-VIGE IN MSC NOT = WCC-S
               MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS09   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-CATE.
      *>>>>
*% END

*% IF FRM_BGC_MINI
      *<<<< FRM_BGC_MINI
      *>>>>
*% END

*% IF FRM_BGC_MAXI
      *<<<< FRM_BGC_MAXI
             IF FRM-BGC-MAXI NOT > FRM-BGC-MINI
              MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
              MOVE WCC-GLS-MS12        TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-BGC-MAXI.
      *>>>>
*% END

*% IF FRM_BGC_NDIA
      *<<<< FRM_BGC_NDIA
      *>>>>
*% END

*% IF FRM_BGC_TIPO
      *<<<< FRM_BGC_TIPO
           MOVE WCC-MC2 IN WSS-VARI TO FIO-SIST.
           MOVE WCC-TDI IN WSS-VARI TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FRM-BGC-TIPO IN IGC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS13   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-TIPO.
               
           IF TAB-IND-VIGE IN TAB NOT = WCC-S
               MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS14   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-TIPO.
      *>>>>
*% END

*% IF FRM_BGC_MONE
      *<<<< FRM_BGC_MONE
           MOVE WCC-MC2 IN WSS-VARI TO FIO-SIST.
           MOVE WCC-TMO IN WSS-VARI TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FRM-BGC-MONE IN IGC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS21   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-MONE.
               
           IF TAB-IND-VIGE IN TAB NOT = WCC-S
               MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS24   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-MONE.
               
           MOVE WCC-TAB IN WSS-VARI TO FIO-SIST.
           MOVE WCC-VLR IN WSS-VARI TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FRM-BGC-MONE IN IGC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS15   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-MONE.
               
           IF TAB-IND-VIGE IN TAB NOT = WCC-S
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS16   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-MONE.
      *>>>>
*% END

*% IF FRM_BGC_TRAM
      *<<<< FRM_BGC_TRAM
           IF SCR-CMND = WCC-ING
              PERFORM VAL-PAN-TRA.
      *>>>>
*% END

*% IF FRM_BGC_VIGE
      *<<<< FRM_BGC_VIGE
           MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST.
           MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC.
           MOVE FRM-BGC-VIGE IN IGC-FLD TO MSC-COD-CMSC IN MSC.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM GNS-FIO-MSC.
           IF NOT FIO-STAT-OKS
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS17   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-VIGE.

           IF MSC-IND-VIGE IN MSC NOT = WCC-S
               MOVE WCC-TAB IN WSS-VARI TO MSG-COD-SIST
               MOVE WCC-GLS-MS18   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-BGC-VIGE.
      *>>>>
*% END

*% IF FRM_TRM_TR01
      *<<<< FRM-TRM-TR01
            IF FRM-TRM-TR01 > ZEROES AND 
               FRM-TRM-PO01 > ZEROES AND
               FRM-TRM-VI01 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI01 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS20   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR01
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR01 
            ELSE
               IF FRM-TRM-TR01 > ZEROES OR 
                  FRM-TRM-PO01 > ZEROES OR
                  FRM-TRM-VI01 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS22   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR01
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR01. 
      *>>>>
*% END

*% IF FRM_TRM_TR02
      *<<<< FRM-TRM-TR02
            IF FRM-TRM-TR02 > ZEROES AND 
               FRM-TRM-PO02 > ZEROES AND
               FRM-TRM-VI02 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI02 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS23   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR02
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR02 
            ELSE
               IF FRM-TRM-TR02 > ZEROES OR 
                  FRM-TRM-PO02 > ZEROES OR
                  FRM-TRM-VI02 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS25   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR02
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR02. 
      *>>>>
*% END

*% IF FRM_TRM_TR03
      *<<<< FRM-TRM-TR03
            IF FRM-TRM-TR03 > ZEROES AND 
               FRM-TRM-PO03 > ZEROES AND
               FRM-TRM-VI03 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI03 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS26   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR03
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR03 
            ELSE
               IF FRM-TRM-TR03 > ZEROES OR 
                  FRM-TRM-PO03 > ZEROES OR
                  FRM-TRM-VI03 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS28   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR03
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR03. 
      *>>>>
*% END

*% IF FRM_TRM_TR04
      *<<<< FRM-TRM-TR04
            IF FRM-TRM-TR04 > ZEROES AND 
               FRM-TRM-PO04 > ZEROES AND
               FRM-TRM-VI04 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI04 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS29   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR04
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR04 
            ELSE
               IF FRM-TRM-TR04 > ZEROES OR 
                  FRM-TRM-PO04 > ZEROES OR
                  FRM-TRM-VI04 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS31   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR04
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR04. 
      *>>>>
*% END

*% IF FRM_TRM_TR05
      *<<<< FRM-TRM-TR05
            IF FRM-TRM-TR05 > ZEROES AND 
               FRM-TRM-PO05 > ZEROES AND
               FRM-TRM-VI05 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI05 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS32   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR05
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR05 
            ELSE
               IF FRM-TRM-TR05 > ZEROES OR 
                  FRM-TRM-PO05 > ZEROES OR
                  FRM-TRM-VI05 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS34   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR05
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR05. 
      *>>>>
*% END

*% IF FRM_TRM_TR06
      *<<<< FRM-TRM-TR06
            IF FRM-TRM-TR06 > ZEROES AND 
               FRM-TRM-PO06 > ZEROES AND
               FRM-TRM-VI06 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI06 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS35   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR06
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR06 
            ELSE
               IF FRM-TRM-TR06 > ZEROES OR 
                  FRM-TRM-PO06 > ZEROES OR
                  FRM-TRM-VI06 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS37   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR06
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR06. 
      *>>>>
*% END

*% IF FRM_TRM_TR07
      *<<<< FRM-TRM-TR07
            IF FRM-TRM-TR07 > ZEROES AND 
               FRM-TRM-PO07 > ZEROES AND
               FRM-TRM-VI07 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI07 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS38   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR07
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR07 
            ELSE
               IF FRM-TRM-TR07 > ZEROES OR 
                  FRM-TRM-PO07 > ZEROES OR
                  FRM-TRM-VI07 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS40   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR07
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR07. 
      *>>>>
*% END

*% IF FRM_TRM_TR08
      *<<<< FRM-TRM-TR08
            IF FRM-TRM-TR08 > ZEROES AND 
               FRM-TRM-PO08 > ZEROES AND
               FRM-TRM-VI08 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI08 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS41   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR08
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR08 
            ELSE
               IF FRM-TRM-TR08 > ZEROES OR 
                  FRM-TRM-PO08 > ZEROES OR
                  FRM-TRM-VI08 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS43   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR08
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR08. 
      *>>>>
*% END

*% IF FRM_TRM_TR09
      *<<<< FRM-TRM-TR09
            IF FRM-TRM-TR09 > ZEROES AND 
               FRM-TRM-PO09 > ZEROES AND
               FRM-TRM-VI09 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI09 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS44   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR09
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR09 
            ELSE
               IF FRM-TRM-TR09 > ZEROES OR 
                  FRM-TRM-PO09 > ZEROES OR
                  FRM-TRM-VI09 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS46   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR09
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR09. 
      *>>>>
*% END

*% IF FRM_TRM_TR10
      *<<<< FRM-TRM-TR10
            IF FRM-TRM-TR10 > ZEROES AND 
               FRM-TRM-PO10 > ZEROES AND
               FRM-TRM-VI10 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI10 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS47   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR10
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR10 
            ELSE
               IF FRM-TRM-TR10 > ZEROES OR 
                  FRM-TRM-PO10 > ZEROES OR
                  FRM-TRM-VI10 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS49   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR10
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR10. 
      *>>>>
*% END

*% IF FRM_TRM_TR11
      *<<<< FRM-TRM-TR11
            IF FRM-TRM-TR11 > ZEROES AND 
               FRM-TRM-PO11 > ZEROES AND
               FRM-TRM-VI11 > SPACES

               MOVE WCC-GNS  IN WSS-VARI TO FIO-SIST
               MOVE WCC-VIGE    IN WSS-VARI TO MSC-COD-TMSC IN MSC
               MOVE FRM-TRM-VI11 IN IGC-FLD TO MSC-COD-CMSC IN MSC
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-MSC
               IF NOT FIO-STAT-OKS OR MSC-IND-VIGE IN MSC NOT = WCC-S
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS50   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR11
               ELSE
                  ADD WCC-1 IN WSS-VARI TO WSS-NTRA IN WSS-VARI
                  GO TO FIN-VAL-FRM-TRM-TR11 
            ELSE
               IF FRM-TRM-TR11 > ZEROES OR 
                  FRM-TRM-PO11 > ZEROES OR
                  FRM-TRM-VI11 > SPACES
                  MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                  MOVE WCC-GLS-MS52   TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FRM-TRM-TR11
               ELSE
                  GO TO FIN-VAL-FRM-TRM-TR11. 
      *>>>>
*% END


*% IF FIN_VAL_FLD_IGC
      *<<<< FIN_VAL_FLD_IGC
      * PARA VALIDAR QUE LOS TRAMOS INGRESADOS ESTEN COMPLETOS Y
      * NO EXISTAN DUPLICADOS

           IF WSS-NTRA NOT > 0
              MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
              MOVE WCC-GLS-MS19   TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FLD-IGC.
           
           PERFORM CAR-PAN-VEC.
               
           MOVE WCC-1  TO WSS-I.
           MOVE WCC-1  TO WSS-J.
           MOVE WCC-N  TO WSS-IR-FIN.
       LOOP-I.
           IF WSS-I <= WCC-11
              PERFORM REV-VEC-TRA
              IF WSS-IR-FIN = WCC-S
                 GO TO FIN-VAL-FLD-IGC
              ELSE   
                 ADD WCC-1 TO WSS-I
                 GO TO LOOP-I.  
      *>>>>
*% END

*% IF INI_KEY_ALL_IGC
      *<<<< INI_KEY_ALL_IGC
           PERFORM KEY-BGC-IGC.
      *>>>>
*% END

*% IF INI_PUT_ALL_IGC
      *<<<< INI_PUT_ALL_IGC
      * SE CARGA LECTURA TABLA BGC
           MOVE BGC-MON-MMIN IN WSS-VARI TO FRM-BGC-MINI IN IGC-FLD.
           MOVE BGC-MON-MMAX IN WSS-VARI TO FRM-BGC-MAXI IN IGC-FLD.
           MOVE TAB-IND-VIGE IN TAB      TO FRM-BGC-VIGE IN IGC-FLD.
           MOVE BGC-VAL-NDIA IN WSS-VARI TO FRM-BGC-NDIA IN IGC-FLD.
           MOVE BGC-VAL-TIPO IN WSS-VARI TO FRM-BGC-TIPO IN IGC-FLD.
           MOVE BGC-VAL-MONE IN WSS-VARI TO FRM-BGC-MONE IN IGC-FLD.
           MOVE BGC-VAL-TRAM IN WSS-VARI TO FRM-BGC-TRAM IN IGC-FLD.
      * SE LEE TABLA TRM Y SE CARGA LA SALIDA     
           MOVE WCC-1   IN WSS-VARI     TO WSS-I IN WSS-VARI.
           MOVE SPACES                  TO VEC-TRM.
           MOVE WCC-MC2 IN WSS-VARI     TO FIO-SIST.
           MOVE WCC-TRM IN WSS-VARI     TO TAB-COD-TTAB IN TAB.
           MOVE SPACES                  TO TAB-COD-CTAB IN TAB.
           MOVE FRM-BGC-TRAM IN IGC-FLD TO 
           TAB-COD-CTAB IN TAB(WCC-1:WCC-3).
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-TAB.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              IF WSS-I > WCC-1
                 PERFORM CAR-VEC-PAN 
                 GO TO FIN-PUT-ALL-IGC
              ELSE
                 MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                 MOVE WCC-GLS-MS10   TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-PUT-ALL-IGC.

           IF TAB-COD-TTAB IN TAB = WCC-TRM IN WSS-VARI AND
              TAB-COD-CTAB IN TAB (WCC-1:WCC-3) = 
              FRM-BGC-TRAM IN IGC-FLD
              MOVE TAB-GLS-DATA IN TAB TO MC2-DAT-TRM IN WSS-VARI
              MOVE TAB-COD-CTAB IN TAB (WCC-7:WCC-6)  
              TO TRM-VEC-TRAM(WSS-I)
              MOVE TRM-VAL-PORC IN WSS-VARI TO TRM-VEC-PORC (WSS-I)
              MOVE TAB-IND-VIGE IN TAB TO TRM-VEC-VIGE(WSS-I)
              ADD WCC-1 IN WSS-VARI TO WSS-I
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO LOOP-TAB
           ELSE
              IF WSS-I > WCC-1
                 PERFORM CAR-VEC-PAN
                 GO TO FIN-PUT-ALL-IGC
              ELSE
                 MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                 MOVE WCC-GLS-MS10   TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-PUT-ALL-IGC.  
      *>>>>
*% END

*% IF EOF_BU
      *<<<< EOF_BU
      
      * PARA VERIFICAR DUPLICIDAD DE TRAMOS
      
       REV-VEC-TRA SECTION.
       INI-REV-VEC-TRA.
           IF WSS-J <= WCC-11
              IF WSS-J NOT = WSS-I
                 IF TRM-VEC-TRAM (WSS-I) = TRM-VEC-TRAM (WSS-J)
                    AND  TRM-VEC-TRAM (WSS-I) > ZEROES
                    MOVE WCC-MC2 IN WSS-VARI TO MSG-COD-SIST
                    MOVE WCC-GLS-MS53   TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    MOVE WCC-S TO WSS-IR-FIN
                    GO TO FIN-REV-VEC-TRA               
                 ELSE
                    ADD WCC-1 TO WSS-J
                    GO TO INI-REV-VEC-TRA
              ELSE
                 ADD WCC-1 TO WSS-J
                 GO TO INI-REV-VEC-TRA
           ELSE
              MOVE WCC-1 TO WSS-J.
       FIN-REV-VEC-TRA.
           EXIT.

      * PARA VALIDAR EL CAMPO TRAMO DE LA BGC (O CARGAR LOS TRAMOS DE LA TRM)
      * EN EL COMANDO INGRESO

       VAL-PAN-TRA SECTION.
       INI-VAL-PAN-TRA.
      * SE LEE LLAVE TABLA TRM
           MOVE WCC-1   IN WSS-VARI      TO WSS-I IN WSS-VARI.
           MOVE SPACES                   TO VEC-TRM.
           MOVE WCC-MC2 IN WSS-VARI      TO FIO-SIST.
           MOVE WCC-TRM IN WSS-VARI      TO TAB-COD-TTAB IN TAB.
           MOVE SPACES                   TO TAB-COD-CTAB IN TAB.
           MOVE FRM-BGC-TRAM  IN IGC-FLD TO 
           TAB-COD-CTAB IN TAB(WCC-1:WCC-3).
           MOVE FIO-GET-NLS TO FIO-CMND.
       LOOP-TRAMO.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
              IF WSS-I > WCC-1
                 PERFORM CAR-VEC-PAN
                 PERFORM BLQ-PAN-TRA
                 MOVE ZEROES TO FIO-STAT
                 GO TO FIN-VAL-FRM-BGC-TRAM
              ELSE
                 MOVE ZEROES TO FIO-STAT
                 GO TO FIN-VAL-FRM-BGC-TRAM.

      * SI EL TRAMO YA EXISTE EN LA TABLA TRM SE RELLENA EL VECTOR CON
      * LOS DATOS DE LA TABLA TRM
           IF TAB-COD-TTAB IN TAB = WCC-TRM IN WSS-VARI AND
              TAB-COD-CTAB IN TAB (WCC-1:WCC-3) = 
              FRM-BGC-TRAM IN IGC-FLD
              MOVE TAB-GLS-DATA IN TAB TO MC2-DAT-TRM IN WSS-VARI
              MOVE TAB-COD-CTAB IN TAB (WCC-7:WCC-6)  
              TO TRM-VEC-TRAM(WSS-I)
              MOVE TRM-VAL-PORC IN WSS-VARI TO TRM-VEC-PORC (WSS-I)
              MOVE TAB-IND-VIGE IN TAB TO TRM-VEC-VIGE(WSS-I)
              ADD WCC-1 IN WSS-VARI TO WSS-I
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO LOOP-TRAMO
           ELSE
              IF WSS-I > WCC-1
                 PERFORM CAR-VEC-PAN
                 MOVE ZEROES TO FIO-STAT
                 GO TO FIN-VAL-FRM-BGC-TRAM
              ELSE
                 MOVE ZEROES TO FIO-STAT
                 GO TO FIN-VAL-FRM-BGC-TRAM.
       FIN-VAL-PAN-TRA.
           EXIT.
      *>>>>
*% END

*% IF EOF
      *<<<< EOF
       KEY-BGC-IGC SECTION.
       INI-KEY-BGC-IGC.
           MOVE SPACES                   TO TAB.
           MOVE FRM-BGC-BNCA IN IGC-FLD  TO WSS-KEY-BNCA IN WSS-VARI.
           MOVE FRM-BGC-PROD IN IGC-FLD  TO WSS-KEY-PROD IN WSS-VARI.
           MOVE FRM-BGC-TCLI IN IGC-FLD  TO WSS-KEY-TCLI IN WSS-VARI.
           MOVE FRM-BGC-CATE IN IGC-FLD  TO WSS-KEY-CATE IN WSS-VARI.
           MOVE SPACES                   TO WSS-KEY-FILL IN WSS-VARI.
           MOVE WCC-MC2 IN WSS-VARI      TO FIO-SIST.
           MOVE WCC-BGC IN WSS-VARI      TO TAB-COD-TTAB IN TAB.
           MOVE WSS-KEY-BGC  IN WSS-VARI TO TAB-COD-CTAB IN TAB.

           MOVE FRM-BGC-MINI IN IGC-FLD  TO BGC-MON-MMIN IN MC2-DAT-BGC.
           MOVE FRM-BGC-MAXI IN IGC-FLD  TO BGC-MON-MMAX IN MC2-DAT-BGC.
           MOVE FRM-BGC-NDIA IN IGC-FLD  TO BGC-VAL-NDIA IN MC2-DAT-BGC.
           MOVE FRM-BGC-TIPO IN IGC-FLD  TO BGC-VAL-TIPO IN MC2-DAT-BGC.
           MOVE FRM-BGC-MONE IN IGC-FLD  TO BGC-VAL-MONE IN MC2-DAT-BGC.
           MOVE FRM-BGC-TRAM IN IGC-FLD  TO BGC-VAL-TRAM IN MC2-DAT-BGC.
           MOVE SPACES                   TO BGC-VAL-FILL IN MC2-DAT-BGC.
           MOVE FRM-BGC-VIGE IN IGC-FLD  TO TAB-IND-VIGE IN TAB.
           MOVE MC2-DAT-BGC  IN WSS-VARI TO TAB-GLS-DATA IN TAB.
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN             TO TAB-STP-ITRN.           
       FIN-KEY-BGC-IGC.
           EXIT.

      * SE CARGA LA PANTALLA CON LOS DATOS DEL VECTOR
 
       CAR-VEC-PAN SECTION.
       INI-CAR-VEC-PAN.
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-1) TO FRM-TRM-TR01
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-1) TO FRM-TRM-PO01
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-1) TO FRM-TRM-VI01
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-2) TO FRM-TRM-TR02
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-2) TO FRM-TRM-PO02
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-2) TO FRM-TRM-VI02
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-3) TO FRM-TRM-TR03
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-3) TO FRM-TRM-PO03
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-3) TO FRM-TRM-VI03
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-4) TO FRM-TRM-TR04
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-4) TO FRM-TRM-PO04
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-4) TO FRM-TRM-VI04
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-5) TO FRM-TRM-TR05
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-5) TO FRM-TRM-PO05
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-5) TO FRM-TRM-VI05
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-6) TO FRM-TRM-TR06
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-6) TO FRM-TRM-PO06
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-6) TO FRM-TRM-VI06
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-7) TO FRM-TRM-TR07
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-7) TO FRM-TRM-PO07
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-7) TO FRM-TRM-VI07
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-8) TO FRM-TRM-TR08
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-8) TO FRM-TRM-PO08
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-8) TO FRM-TRM-VI08
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-9) TO FRM-TRM-TR09
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-9) TO FRM-TRM-PO09
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-9) TO FRM-TRM-VI09
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-10) TO FRM-TRM-TR10
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-10) TO FRM-TRM-PO10
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-10) TO FRM-TRM-VI10
                  
           MOVE TRM-VEC-TRAM IN WSS-VARI (WCC-11) TO FRM-TRM-TR11
           MOVE TRM-VEC-PORC IN WSS-VARI (WCC-11) TO FRM-TRM-PO11
           MOVE TRM-VEC-VIGE IN WSS-VARI (WCC-11) TO FRM-TRM-VI11.
       FIN-CAR-VEC-PAN.
           EXIT.
           

      * SE BLOQUEAN LOS CAMPOS DEL TRAMO EN EL COMANDO INGRESO
      * (SI EL TRAMO INGRESADO PARA LA BGC YA EXISTE)
 
       BLQ-PAN-TRA SECTION.
       INI-BLQ-PAN-TRA.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR01-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO01-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI01-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR02-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO02-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI02-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR06-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO06-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI06-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR07-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO07-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI07-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR08-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO08-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI08-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR09-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO09-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI09-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR10-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO10-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI10-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR11-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO11-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI11-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR03-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO03-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI03-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR04-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO04-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI04-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-TR05-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-PO05-ATR IN IGC-FLD.
           MOVE FRM-CPIM-AEY TO FRM-TRM-VI05-ATR IN IGC-FLD.
       FIN-BLQ-PAN-TRA.
           EXIT.
           
      * PARA BLOQUEAR EL CAMPO TRAMO (PARTE DE LA LLAVE)
      * DE LOS TRAMOS YA INGRESADOS EN EL COMANDO DE 
      * MODIFICACION (MIT)
 
       BLQ-MIT-TRA SECTION.
       INI-BLQ-MIT-TRA.
           IF FRM-TRM-TR01 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR01-ATR IN IGC-FLD.
           IF FRM-TRM-TR02 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR02-ATR IN IGC-FLD.
           IF FRM-TRM-TR03 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR03-ATR IN IGC-FLD.
           IF FRM-TRM-TR04 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR04-ATR IN IGC-FLD.
           IF FRM-TRM-TR05 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR05-ATR IN IGC-FLD.
           IF FRM-TRM-TR06 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR06-ATR IN IGC-FLD.
           IF FRM-TRM-TR07 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR07-ATR IN IGC-FLD.
           IF FRM-TRM-TR08 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR08-ATR IN IGC-FLD.
           IF FRM-TRM-TR09 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR09-ATR IN IGC-FLD.
           IF FRM-TRM-TR10 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR10-ATR IN IGC-FLD.
           IF FRM-TRM-TR11 > ZEROES 
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR11-ATR IN IGC-FLD.
       FIN-BLQ-MIT-TRA.
           EXIT.
      *>>>>
*% END

*% IF FIN_UNP_FLD_IGC
      *<<<< FIN_UNP_FLD_IGC
      * PARA BLOQUEAR CAMPOS EN EL CASO DEL COMANDO DE 
      * MODIFICACION (MOD Y MIT)

           IF SCR-CMND = WCC-MOD
      * SE BLOQUEAN CAMPOS TRM
              MOVE FRM-CPIM-AEY TO FRM-BGC-TRAM-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR01-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO01-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI01-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR02-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO02-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI02-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR06-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO06-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI06-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR07-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO07-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI07-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR08-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO08-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI08-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR09-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO09-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI09-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR10-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO10-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI10-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR11-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO11-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI11-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR03-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO03-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI03-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR04-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO04-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI04-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-TR05-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-PO05-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-TRM-VI05-ATR IN IGC-FLD.
      * SE BLOQUEA LLAVE
              MOVE FRM-CPIM-AEY TO FRM-BGC-BNCA-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-PROD-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-TCLI-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-CATE-ATR IN IGC-FLD
           IF SCR-CMND = WCC-MIT
      * SE BLOQUEA LLAVE           
              MOVE FRM-CPIM-AEY TO FRM-BGC-BNCA-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-PROD-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-TCLI-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-CATE-ATR IN IGC-FLD
      * SE BLOQUEAN CAMPOS BGC
              MOVE FRM-CPIM-AEY TO FRM-BGC-MINI-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-MAXI-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-VIGE-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-NDIA-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-TIPO-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-MONE-ATR IN IGC-FLD
              MOVE FRM-CPIM-AEY TO FRM-BGC-TRAM-ATR IN IGC-FLD
              PERFORM BLQ-MIT-TRA.
      *>>>>
*% END
