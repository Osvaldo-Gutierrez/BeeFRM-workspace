*% IF SFC_COD_SIST
      *<<<< SFC_COD_SIST                                                
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-SIST IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-SIST IN SFC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SIST IN SFC-FLD.
      *>>>>                                                             
*% END
*% IF FIN_PUT_DBC_SFC
      *<<<<
           MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI.
      *>>>>
*% END
*% IF INI_FST_FLD_SFC
      *<<<<
           IF SCR-CMND = 'APR' OR 'RCH'
           MOVE -1 TO SFC-COD-RAPR-LEN IN SFC-FLD
           GO TO FIN-FST-FLD-SFC.

           MOVE -1 TO SFC-COD-APRA-LEN IN SFC-FLD.
           GO TO FIN-FST-FLD-SFC.
      *>>>>
*% END
*% IF FIN_UNP_DBC_SFC
      *<<<<
           IF SCR-CMND = 'APR' OR 'RCH' OR 'ING' OR 'MOD'
              MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN SFC-FLD
              GO TO FIN-UNP-DBC-SFC.
      *>>>>
*% END
*% IF FIN_UNP_SFC_SFC
      *<<<<
           MOVE FRM-CPIM-AEY TO SFC-MSC-STAT-ATR IN SFC-FLD.
           IF SCR-CMND = 'APR' OR 'RCH'
              MOVE FRM-CPIM-AEY TO SFC-MSC-STAT-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-APRA-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-NUM-NAPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-MAIL-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-COD-RAPR-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-COD-USER-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-EJEC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-OFIC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-REGN-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-BANC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-MNTO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-MNTO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-NUM-PLZO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-PLZO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-TMPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-TMSF-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-TAMO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-SPPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-SPSF-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-SPRD-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VARI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VLRG-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VLPI-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VLPE-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-GLS-DES1-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-GLS-DES2-ATR IN SFC-FLD
              GO TO FIN-UNP-SFC-SFC.
           IF SCR-CMND = 'ING' OR 'MOD'
              MOVE FRM-CPIM-AEY TO SFC-MSC-STAT-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-COD-APRA-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-NUM-NAPR-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-COD-MAIL-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-RAPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-USER-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-EJEC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-OFIC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-REGN-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-COD-BANC-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-MNTO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-MNTO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-NUM-PLZO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-PLZO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-TMPR-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-SGV-TMSF-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-TAMO-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-SPPR-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-SPSF-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-IND-SPRD-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-SGV-VARI-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-SGV-VLRG-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-SGV-VLPI-ATR IN SFC-FLD
      *       MOVE FRM-CPIM-AEY TO SFC-SGV-VLPE-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-GLS-DES1-ATR IN SFC-FLD
              MOVE FRM-CPIM-AEY TO SFC-GLS-DES2-ATR IN SFC-FLD
              GO TO FIN-UNP-SFC-SFC.
      *>>>>
*% END
*% IF FIN_PUT_SFC_SFC
      *<<<<
           IF SFC-COD-SIST IN SFC-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB
              MOVE SFC-COD-SIST IN SFC-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SIST IN SFC-FLD
           ELSE
              MOVE SPACES              TO FRM-GLS-SIST IN SFC-FLD.

           IF SFC-COD-EVEN IN SFC-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB
              MOVE SFC-COD-SIST IN SFC-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE SFC-COD-EVEN IN SFC-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EVEN IN SFC-FLD
           ELSE
              MOVE SPACES              TO FRM-GLS-EVEN IN SFC-FLD.

           IF SFC-IND-MNTO IN SFC-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB
              MOVE SFC-IND-MNTO IN SFC-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-MNTO IN SFC-FLD
           ELSE
              MOVE SPACES              TO FRM-GLS-MNTO IN SFC-FLD.

           IF SFC-IND-PLZO IN SFC-FLD > SPACES
              MOVE 'TAB'                   TO MSC-COD-SIST
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC
              MOVE SFC-IND-PLZO IN SFC-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-PLZO IN SFC-FLD
           ELSE
              MOVE SPACES              TO FRM-GLS-PLZO IN SFC-FLD.

           IF SFC-IND-TAMO IN SFC-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'INT'                   TO TAB-COD-TTAB IN TAB
              MOVE SFC-IND-TAMO IN SFC-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TAMO IN SFC-FLD
           ELSE
              MOVE SPACES              TO FRM-GLS-TAMO IN SFC-FLD.

           IF SFC-IND-SPRD IN SFC-FLD > SPACES
              MOVE 'COL'                   TO MSC-COD-SIST
              MOVE 'PBTI'                  TO MSC-COD-TMSC IN MSC
              MOVE SFC-IND-SPRD IN SFC-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-SPRD IN SFC-FLD
           ELSE
              MOVE SPACES              TO FRM-GLS-SPRD IN SFC-FLD.

           MOVE SFC-CIC-ICLI IN SFC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
      *>>>>
*% END
*% IF FIN_SFC_COD_EVEN
      *<<<< FIN_SFC_COD_EVEN
      *VAL-COD Valida codigo de tabla
           IF SFC-COD-EVEN IN SFC-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'EVT'                   TO TAB-COD-TTAB IN TAB
              MOVE SFC-COD-SIST IN SFC-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE SFC-COD-EVEN IN SFC-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
                 MOVE SPACES       TO FRM-GLS-EVEN IN SFC-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EVEN IN SFC-FLD.
      *>>>>                                                             
*% END
*% IF INI_SFC_FEC_FINI
      *<<<< INI_SFC_FEC_FINI
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           IF SCR-CMND = 'ING' OR 'MOD' OR 'VRF' OR 'ACA'
              MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           IF SFC-FEC-FINI IN SFC-FLD NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-DHOY IN HOY-VARI TO SFC-NUM-DINI IN SFC-FLD
              MOVE HOY-MHOY IN HOY-VARI TO SFC-NUM-MINI IN SFC-FLD
              MOVE HOY-SHOY IN HOY-VARI TO SFC-NUM-SINI IN SFC-FLD
              MOVE HOY-AHOY IN HOY-VARI TO SFC-NUM-AINI IN SFC-FLD
              IF SFC-HRA-HINI IN SFC-FLD NOT > ZEROES
                 MOVE HOY-HHOY IN HOY-VARI TO SFC-HRA-HINI IN SFC-FLD
                 GO TO FIN-VAL-SFC-FEC-FINI
              ELSE
                 GO TO FIN-VAL-SFC-FEC-FINI.
      *>>>>
*% END
*% IF SFC_HRA_HINI
      *<<<< SFC_HRA_HINI
           IF SFC-HRA-HINI IN SFC-FLD NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-HHOY IN HOY-VARI TO SFC-HRA-HINI IN SFC-FLD
              GO TO FIN-VAL-SFC-HRA-HINI.

           MOVE SFC-HRA-HINI IN SFC-FLD TO SFC-HRA-HINI IN SFC.
           IF SFC-NUM-HHIN IN SFC < ZEROES OR
              SFC-NUM-HHIN IN SFC > 23
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-SFC-HRA-HINI.
           IF SFC-NUM-MMIN IN SFC < ZEROES OR
              SFC-NUM-MMIN IN SFC > 59
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'NUMMMTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-SFC-HRA-HINI.
           IF SFC-NUM-SSIN IN SFC < ZEROES OR
              SFC-NUM-SSIN IN SFC > 59
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'NUMSSTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-SFC-HRA-HINI.
      *>>>>
*% END
*% IF SFC_MSC_STAT
      *<<<< SFC_MSC_STAT
      *>>>>
*% END
*% IF SFC_COD_USER
      *<<<< SFC_COD_USER
           IF (SFC-COD-USER IN SFC-FLD NOT > SPACES AND
              (SCR-CMND = 'APR' OR 'RCH'))
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'SFCUSER  OBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-SFC-COD-USER.

      *VAL-TDU Valida Tipo de Usuario
           IF SFC-COD-USER IN SFC-FLD > SPACES
              MOVE 'USR '                  TO USR-COD-TTAB IN USR
              MOVE SFC-COD-USER IN SFC-FLD TO USR-COD-USER IN USR
              PERFORM VAL-TDU
              IF MSG-COD-MENS > SPACES
      *PVG INI 26-JUN-2015
                 MOVE 'EJC '                  TO USR-COD-TTAB IN USR
                 MOVE SFC-COD-USER IN SFC-FLD TO USR-COD-USER IN USR
                 PERFORM VAL-TDU
                 IF MSG-COD-MENS > SPACES
      *PVG FIN 26-JUN-2015
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    GO TO FIN-VAL-SFC-COD-USER.
      *>>>>
*% END
*% IF SFC_COD_REGN
      *<<<< SFC_COD_REGN
           IF (SFC-COD-REGN IN SFC-FLD NOT > SPACES AND
               WSS-COD-REGL IN WSS-VARI    > SPACES)
               MOVE WSS-COD-REGL IN WSS-VARI TO
                    SFC-COD-REGN IN SFC-FLD.

           IF SFC-COD-REGN IN SFC-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'RGL'                   TO TAB-COD-TTAB IN TAB
              MOVE SFC-COD-REGN IN SFC-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE FRM-CPIM-UBY TO SFC-COD-REGN-ATR IN SFC-FLD
                 GO TO FIN-VAL-SFC-COD-REGN.
      *>>>>
*% END
*% IF SFC_COD_BANC
      *<<<< SFC_COD_BANC
           IF SFC-COD-BANC IN SFC-FLD NOT > SPACES AND
              SCR-COD-BANC IN SCR-VARI    > SPACES
              MOVE SCR-COD-BANC IN SCR-VARI TO
                   SFC-COD-BANC IN SFC-FLD.

           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE 'AGB'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-BANC IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-COD-BANC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-BANC.
      *>>>>
*% END
*% IF SFC_SGV_MNTO
      *<<<< SFC_SGV_MNTO
           IF SFC-SGV-MNTO IN SFC-FLD NOT > ZEROES AND
              SCR-VAL-CRED IN SCR-VARI    > ZEROES
              MOVE SCR-VAL-CRED IN SCR-VARI TO
                   SFC-SGV-MNTO IN SFC-FLD.
      *>>>>
*% END
*% IF SFC_IND_MNTO
      *<<<< SFC_IND_MNTO
           IF SFC-IND-MNTO IN SFC-FLD NOT > SPACES AND
              SCR-COD-VCOC IN SCR-VARI    > SPACES
              MOVE SCR-COD-VCOC IN SCR-VARI TO
                   SFC-IND-MNTO IN SFC-FLD.

           IF SFC-IND-MNTO IN SFC-FLD NOT > SPACES
              MOVE SPACES       TO FRM-GLS-MNTO IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-MNTO.

           MOVE SFC-IND-MNTO IN SFC-FLD TO SFC-IND-MNTO IN SFC.
           IF NOT (SFC-MSC-TVOC IN SFC = '0' OR  '1')
              MOVE 'MC2' TO MSG-COD-SIST
              MOVE 'INDMNTO  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-MNTO-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-MNTO.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-IND-MNTO IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-MNTO IN SFC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-MNTO-ATR IN SFC-FLD
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-MNTO IN SFC-FLD.
      *>>>>
*% END
*% IF SFC_NUM_PLZO
      *<<<< SFC_NUM_PLZO
           IF SFC-NUM-PLZO IN SFC-FLD NOT > ZEROES AND
              SCR-NUM-PLZD IN SCR-VARI    > ZEROES
              MOVE SCR-NUM-PLZD IN SCR-VARI TO
                   SFC-NUM-PLZO IN SFC-FLD.
      *>>>>
*% END
*% IF SFC_IND_PLZO
      *<<<< SFC_IND_PLZO
           IF SFC-IND-PLZO IN SFC-FLD NOT > SPACES AND
              SCR-IND-PLZO IN SCR-VARI    > SPACES
              MOVE SCR-IND-PLZO IN SCR-VARI TO
                   SFC-IND-PLZO IN SFC-FLD.

           IF SFC-IND-PLZO IN SFC-FLD NOT > SPACES
              MOVE SPACES       TO FRM-GLS-PLZO IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-PLZO.

           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           MOVE SFC-IND-PLZO IN SFC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-PLZO IN SFC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-PLZO-ATR IN SFC-FLD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-PLZO IN SFC-FLD.
      *>>>>
*% END
*% IF SFC_SGV_TMPR
      *<<<< SFC_SGV_TMPR
           IF SFC-SGV-TMPR IN SFC-FLD NOT > ZEROES AND
              SCR-SGV-TMPR IN SCR-VARI    > ZEROES
              MOVE SCR-SGV-TMPR IN SCR-VARI TO
                   SFC-SGV-TMPR IN SFC-FLD.

           IF SFC-SGV-TMPR IN SFC-FLD NOT > ZEROES
              PERFORM ERR-GLS
              MOVE FRM-CPIM-UBY TO SFC-SGV-TMPR-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-SGV-TMPR.
      *>>>>
*% END
*% IF SFC_SGV_TMSF
      *<<<< SFC_SGV_TMSF
           IF SFC-SGV-TMSF IN SFC-FLD NOT > ZEROES AND
              SCR-SGV-TINT IN SCR-VARI    > ZEROES
              MOVE SCR-SGV-TINT IN SCR-VARI TO
                   SFC-SGV-TMSF IN SFC-FLD.
           IF SFC-SGV-TMSF IN SFC-FLD NOT > ZEROES
              PERFORM ERR-GLS
              MOVE FRM-CPIM-UBY TO SFC-SGV-TMSF-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-SGV-TMSF.
           IF SFC-SGV-TMSF IN SFC-FLD NOT < SFC-SGV-TMPR IN SFC-FLD
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'SGVTMSF  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-SGV-TMSF-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-SGV-TMSF.
      *>>>>
*% END
*% IF SFC_IND_TAMO
      *<<<< SFC_IND_TAMO
           IF SFC-IND-TAMO IN SFC-FLD NOT > SPACES AND
              SCR-COD-TINT IN SCR-VARI    > SPACES
              MOVE SCR-COD-TINT IN SCR-VARI TO
                   SFC-IND-TAMO IN SFC-FLD.

           IF SFC-IND-TAMO IN SFC-FLD NOT > SPACES
              MOVE SPACES       TO FRM-GLS-TAMO IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-TAMO.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'INT'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-IND-TAMO IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-TAMO IN SFC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-TAMO-ATR IN SFC-FLD
           ELSE
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TAMO IN SFC-FLD.
      *>>>>
*% END
*% IF SFC_SGV_SPPR
      *<<<< SFC_SGV_SPPR
      *>>>>
*% END
*% IF SFC_SGV_SPSF
      *<<<< SFC_SGV_SPSF
      *>>>>
*% END
*% IF SFC_IND_SPRD
      *<<<< SFC_IND_SPRD
           IF SFC-IND-SPRD IN SFC-FLD NOT > SPACES
              MOVE SPACES       TO FRM-GLS-SPRD IN SFC-FLD
              GO TO FIN-VAL-SFC-IND-SPRD.

           MOVE 'COL'                   TO MSC-COD-SIST.
           MOVE 'PBTI'                  TO MSC-COD-TMSC IN MSC.
           MOVE SFC-IND-SPRD IN SFC-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-SPRD IN SFC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-IND-SPRD-ATR IN SFC-FLD
           ELSE
              MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-SPRD IN SFC-FLD.
      *>>>>
*% END
*% IF SFC_SGV_VARI
      *<<<< SFC_SGV_VARI
      *>>>>
*% END
*% IF SFC_SGV_VLPI
      *<<<< SFC_SGV_VLPI
            IF SFC-SGV-VLPI IN SFC-FLD > ZEROES OR
               SCR-CIC-ICLI IN SCR-VARI NOT > SPACES
               GO TO FIN-VAL-SFC-SGV-VLPI.

           MOVE ZEROES                   TO SFC-SGV-VLPI IN SFC-FLD.
           MOVE SFC-NUM-SINI IN SFC-FLD  TO WSS-NUM-SCON IN WSS-VARI.
           MOVE SFC-NUM-AINI IN SFC-FLD  TO WSS-NUM-ACON IN WSS-VARI.
           MOVE SFC-NUM-MINI IN SFC-FLD  TO WSS-NUM-MCON IN WSS-VARI.
           MOVE SFC-NUM-DINI IN SFC-FLD  TO WSS-NUM-DCON IN WSS-VARI.

           MOVE WSS-COD-CPTO IN WSS-VARI TO CAC-COD-CPTO IN CAC.
           MOVE SCR-CIC-ICLI IN SCR-VARI TO CAC-CIC-ICLI IN CAC.
           MOVE WSS-FEC-FCON IN WSS-VARI TO CAC-FEC-FINI IN CAC.
           MOVE SFC-HRA-HINI IN SFC-FLD  TO CAC-HRA-HINI IN CAC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-CAC.
           IF NOT (FIO-STAT-OKS AND
                   CAC-COD-CPTO IN CAC = WSS-COD-CPTO IN WSS-VARI AND
                   CAC-CIC-ICLI IN CAC = SCR-CIC-ICLI IN SCR-VARI)
               GO TO FIN-VAL-SFC-SGV-VLPI.
           IF NOT (CAC-IND-VIGE IN CAC = 'S'   AND
                  (CAC-FEC-FTER IN CAC = ZEROES OR
                   CAC-FEC-FTER IN CAC > WSS-FEC-FCON IN WSS-VARI))
               GO TO FIN-VAL-SFC-SGV-VLPI.
           MOVE CAC-VAL-PORC IN CAC      TO SFC-SGV-VLPI IN SFC-FLD.
      *>>>>
*% END
*% IF FIN_RET_DBC_SFC
      *<<<<
           MOVE SCR-CIC-ICLI            TO SFC-CIC-ICLI IN SFC.
      *>>>>
*% END
*% IF SFC_COD_APRA
      *<<<< SFC_COD_APRA
           IF SFC-COD-APRA IN SFC-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-SFC-COD-APRA.
           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE 'RXF'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-APRA IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-SFC-COD-APRA.
      *>>>>
*% END
*% IF SFC_COD_RAPR
      *<<<< SFC_COD_RAPR
           IF (SFC-COD-RAPR IN SFC-FLD NOT > SPACES AND
              (SCR-CMND = 'APR' OR 'RCH'))
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'SFCRAPR  OBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-SFC-COD-RAPR.

           IF SFC-COD-RAPR IN SFC-FLD > SPACES
              MOVE 'MC2'                   TO TAB-COD-SIST
              MOVE 'RDF'                   TO TAB-COD-TTAB IN TAB
              MOVE SFC-COD-RAPR IN SFC-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-SFC-COD-RAPR.
      *>>>>
*% END
*% IF INI_DBC_NUM_ICLI

           IF DBC-NUM-ICLI IN SFC-FLD > ZEROES OR
              DBC-VRF-ICLI IN SFC-FLD > SPACES OR
              DBC-IND-ICLI IN SFC-FLD > SPACES OR
              DBC-GLS-ICLI IN SFC-FLD > SPACES
              GO TO FIN-VAL-DBC-NUM-ICLI.
           IF DBC-NUM-ICLI IN SFC-FLD NOT > ZEROES AND
              DBC-VRF-ICLI IN SFC-FLD NOT > SPACES AND
              DBC-IND-ICLI IN SFC-FLD NOT > SPACES AND
              DBC-GLS-ICLI IN SFC-FLD NOT > SPACES

              MOVE SCR-NUM-ICLI IN SCR-VARI TO DBC-NUM-ICLI IN SFC-FLD
              MOVE SCR-VRF-ICLI IN SCR-VARI TO DBC-VRF-ICLI IN SFC-FLD
              MOVE SCR-IND-ICLI IN SCR-VARI TO DBC-IND-ICLI IN SFC-FLD
              MOVE SCR-GLS-ICLI IN SCR-VARI TO DBC-GLS-ICLI IN SFC-FLD.
*% END
*% IF FIN_DBC_VRF_ICLI
      *<<<<
           MOVE IDC-NUM-RUTV TO DBC-NUM-ICLI IN SFC-FLD.
           MOVE IDC-VRF-RUTV TO DBC-VRF-ICLI IN SFC-FLD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR-CLR
              MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN SFC-FLD
               GO TO FIN-VAL-DBC-VRF-ICLI.

           MOVE DBC-NUM-ICLI IN SFC-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN SFC-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN SFC-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN SFC-FLD
              MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN SFC-FLD
               GO TO FIN-VAL-DBC-VRF-ICLI.

           MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI.
      *>>>>
*% END
*% IF SFC_SGV_VLPE
      *<<<< SFC_SGV_VLPE
      *>>>>
*% END
*% IF VAL_CON_FLD_SFC
           IF NOT (SCR-CMND = 'ING' OR 'MOD')
              GO TO FIN-VAL-CON-FLD-SFC.

      *Validacion Nivel de Aprobacion
           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE 'AGB'                   TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-BANC IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'BEJC  NEXAGB' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.

           MOVE 'MC2'                   TO TAB-COD-SIST.
           MOVE TAB-CIC-CTAB IN TAB     TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-APRA IN SFC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX'
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'APRA  NEXABX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.

           IF TAB-COD-DAT3 IN TAB(1) NOT NUMERIC
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'NVEL  ABXERR' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.

           MOVE TAB-COD-DAT3 IN TAB(1) TO WSS-GLS-NAPR IN WSS-VARI.
           IF SFC-NUM-NAPR IN SFC-FLD NOT > ZEROES
              MOVE WSS-NUM-NAPR IN WSS-VARI TO SFC-NUM-NAPR IN SFC-FLD
              GO TO CNT-VAL-CON-FLD-SFC.
           IF NOT (SFC-NUM-NAPR IN SFC-FLD = WSS-NUM-NAPR IN WSS-VARI)
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'NVELINF  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.

       CNT-VAL-CON-FLD-SFC.
      *Validacion Spread Propuesto/Solicitado

           MOVE SFC-IND-MNTO IN SFC-FLD  TO WSS-IND-MNTO IN CFN-VARI.
           MOVE SFC-NUM-PLZO IN SFC-FLD  TO WSS-NUM-PLZO IN CFN-VARI.
           MOVE SFC-IND-PLZO IN SFC-FLD  TO WSS-IND-PLZO IN CFN-VARI.
           MOVE SCR-COD-COOC IN SCR-VARI TO WSS-COD-COOC IN CFN-VARI.
           MOVE SCR-NUM-VCOR IN SCR-VARI TO WSS-NUM-VCOR IN CFN-VARI.
           MOVE SCR-FEC-FCOL IN SCR-VARI TO WSS-FEC-FPRO IN CFN-VARI.

           PERFORM PRO-CAL-CSTF.
           IF WSS-COD-MENS IN CFN-VARI > SPACES
              MOVE WSS-COD-MENS IN CFN-VARI TO FRM-MEN1
              MOVE WSS-COD-MEN2 IN CFN-VARI TO FRM-MEN2
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CON-FLD-SFC.
           MOVE SFC-IND-TAMO IN SFC-FLD TO SFC-IND-TAMO IN SFC.

           IF SFC-MSC-PBTI IN SFC = WSS-EXP-CSTF IN CFN-VARI
              GO TO EXT-VAL-CON-FLD-SFC.

           IF SFC-MSC-PBTI IN SFC = 'A' OR 'X'
              IF WSS-EXP-CSTF IN CFN-VARI = 'A'
                 GO TO EXT-VAL-CON-FLD-SFC
              ELSE
              IF WSS-EXP-CSTF IN CFN-VARI = 'M'
                 MULTIPLY WSS-SGV-CSTF IN CFN-VARI BY 12
                   GIVING WSS-SGV-CSTF IN CFN-VARI ROUNDED
                 GO TO EXT-VAL-CON-FLD-SFC.

           IF SFC-MSC-PBTI IN SFC = 'M' OR 'T'
              IF WSS-EXP-CSTF IN CFN-VARI = 'A'
                 DIVIDE WSS-SGV-CSTF IN CFN-VARI BY 12
                 GIVING WSS-SGV-CSTF IN CFN-VARI ROUNDED
                 GO TO EXT-VAL-CON-FLD-SFC
              ELSE
              IF WSS-EXP-CSTF IN CFN-VARI = 'M'
                 GO TO EXT-VAL-CON-FLD-SFC.

           IF SFC-MSC-PBTI IN SFC = 'D'
              IF WSS-EXP-CSTF IN CFN-VARI = 'A'
                 DIVIDE WSS-SGV-CSTF IN CFN-VARI BY 360
                 GIVING WSS-SGV-CSTF IN CFN-VARI ROUNDED
                 GO TO EXT-VAL-CON-FLD-SFC
              ELSE
              IF WSS-EXP-CSTF IN CFN-VARI = 'M'
                 DIVIDE WSS-SGV-CSTF IN CFN-VARI BY 30
                 GIVING WSS-SGV-CSTF IN CFN-VARI ROUNDED
                 GO TO EXT-VAL-CON-FLD-SFC.
       MSG-VAL-CON-FLD-SFC.
           MOVE 'MC2'          TO MSG-COD-SIST.
           MOVE 'SFCPBTI  INV' TO MSG-COD-MENS.
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC TO FRM-MENS
           MOVE FRM-SUAR-MAL TO FRM-SUAR
           GO TO FIN-VAL-CON-FLD-SFC.
       EXT-VAL-CON-FLD-SFC.
           MOVE SFC-MSC-PBTI IN SFC TO SFC-IND-SPRD IN SFC-FLD.
           SUBTRACT WSS-SGV-CSTF IN CFN-VARI
               FROM SFC-SGV-TMPR IN SFC-FLD
             GIVING SFC-SGV-SPPR IN SFC-FLD ROUNDED.
           SUBTRACT WSS-SGV-CSTF IN CFN-VARI
               FROM SFC-SGV-TMSF IN SFC-FLD
             GIVING SFC-SGV-SPSF IN SFC-FLD ROUNDED.

           COMPUTE SFC-SGV-VARI IN SFC-FLD ROUNDED =
                  ((1 - ( SFC-SGV-SPSF IN SFC-FLD /
                          SFC-SGV-SPPR IN SFC-FLD )) * 100).
*% END
*% IF INI_SFC_COD_EJEC
           IF (SFC-COD-EJEC IN SFC-FLD NOT > SPACES AND
               SCR-COD-RMOC IN SCR-VARI    > SPACES)
               MOVE SCR-COD-RMOC IN SCR-VARI TO
                    SFC-COD-EJEC IN SFC-FLD.

           IF SFC-COD-EJEC IN SFC-FLD NOT > SPACES
              PERFORM ERR-GLS
              MOVE FRM-CPIM-UBY TO SFC-COD-EJEC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-EJEC.

      *VAL-TDU Valida Tipo de Usuario
           MOVE 'EJC '                  TO USR-COD-TTAB IN USR.
           MOVE SFC-COD-EJEC IN SFC-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-COD-EJEC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-EJEC.
           MOVE USR-COD-BNCA IN USR TO WSS-COD-BEJC IN WSS-VARI.

           MOVE USR-COD-OFUS IN USR TO WSS-COD-OFUS IN WSS-VARI.
           MOVE USR-COD-REGL IN USR TO WSS-COD-REGL IN WSS-VARI.
           MOVE USR-COD-BNCA IN USR TO WSS-COD-BNCA IN WSS-VARI.

           GO TO FIN-VAL-SFC-COD-EJEC.
*% END
*% IF INI_SFC_COD_OFIC
           IF (SFC-COD-OFIC IN SFC-FLD NOT > SPACES AND
               WSS-COD-OFUS IN WSS-VARI    > SPACES)
               MOVE WSS-COD-OFUS IN WSS-VARI TO
                    SFC-COD-OFIC IN SFC-FLD.

           IF SFC-COD-OFIC IN SFC-FLD NOT > SPACES
              PERFORM ERR-GLS
              MOVE FRM-CPIM-UBY TO SFC-COD-OFIC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-OFIC.

           MOVE SFC-COD-OFIC IN SFC-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE FRM-CPIM-UBY TO SFC-COD-OFIC-ATR IN SFC-FLD
              GO TO FIN-VAL-SFC-COD-OFIC.
           GO TO FIN-VAL-SFC-COD-OFIC.
*% END
