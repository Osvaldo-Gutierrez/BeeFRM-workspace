*%! Codigo adicional para archivo                                       
*% IF INI_DBC_NUM_ICLI
      *<<<< INI_DBC_NUM_ICLI                                            
           IF DBC-NUM-ICLI IN CCH-FLD NOT > ZEROES                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-DBC-NUM-ICLI.                             
      *>>>>                                                             
*% END
*% IF FIN_DBC_VRF_ICLI
      *<<<< FIN_DBC_VRF_ICLI
           IF MSG-COD-MENS > SPACES
              GO TO FIN-VAL-DBC-VRF-ICLI.
           MOVE DBC-NUM-ICLI IN CCH-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN CCH-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN CCH-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              GO TO CNT-VAL-DBC-VRF-ICLI.

           MOVE DBC-NUM-ICLI IN CCH-FLD TO WSS-NUM-ICLI IN WSS-VARI.
           MOVE DBC-IND-ICLI IN CCH-FLD TO WSS-IND-ICLI IN WSS-VARI.
           MOVE DBC-GLS-ICLI IN CCH-FLD TO WSS-GLS-ICLI IN WSS-VARI.
           MOVE DBC-VRF-ICLI IN CCH-FLD TO WSS-VRF-ICLI IN WSS-VARI.

           MOVE DBC-IND-TICL IN DBC TO WSS-IND-TICL IN WSS-VARI.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS OR DCP-FEC-FNAC IN DCP NOT > ZEROES
              MOVE 19                  TO DCP-NUM-SNAC IN DCP
              MOVE 80                  TO DCP-NUM-ANAC IN DCP
              MOVE 01                  TO DCP-NUM-MNAC IN DCP
              MOVE 01                  TO DCP-NUM-DNAC IN DCP.
           MOVE DCP-NUM-SNAC IN DCP TO WSS-NUM-SNAC IN WSS-VARI.
           MOVE DCP-NUM-ANAC IN DCP TO WSS-NUM-ANAC IN WSS-VARI.
           MOVE DCP-NUM-MNAC IN DCP TO WSS-NUM-MNAC IN WSS-VARI.
           MOVE DCP-NUM-DNAC IN DCP TO WSS-NUM-DNAC IN WSS-VARI.
           GO TO FIN-VAL-DBC-VRF-ICLI.
       CNT-VAL-DBC-VRF-ICLI.
           IF WSS-IND-NCLI IN WSS-VARI = 'N'
              MOVE 'SGC'        TO MSG-COD-SIST
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-DBC-VRF-ICLI.

           MOVE WSS-NUM-ICLI IN WSS-VARI TO IDC-NUM-RUTV.
           MOVE WSS-VRF-ICLI IN WSS-VARI TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           IF MSG-COD-MENS > SPACES
              GO TO FIN-VAL-DBC-VRF-ICLI.
           MOVE WSS-NUM-ICLI IN WSS-VARI TO DBC-NUM-ICLI IN DBC.
           MOVE WSS-IND-ICLI IN WSS-VARI TO DBC-IND-ICLI IN DBC.
           MOVE WSS-GLS-ICLI IN WSS-VARI TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'NOCLICHIPNEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-DBC-VRF-ICLI.

           MOVE DBC-IND-TICL IN DBC TO WSS-IND-TICL IN WSS-VARI.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS OR DCP-FEC-FNAC IN DCP NOT > ZEROES
              MOVE 19 TO DCP-NUM-SNAC IN DCP
              MOVE 80 TO DCP-NUM-ANAC IN DCP
              MOVE 01 TO DCP-NUM-MNAC IN DCP
              MOVE 01 TO DCP-NUM-DNAC IN DCP.
           MOVE DCP-NUM-SNAC IN DCP TO WSS-NUM-SNAC IN WSS-VARI.
           MOVE DCP-NUM-ANAC IN DCP TO WSS-NUM-ANAC IN WSS-VARI.
           MOVE DCP-NUM-MNAC IN DCP TO WSS-NUM-MNAC IN WSS-VARI.
           MOVE DCP-NUM-DNAC IN DCP TO WSS-NUM-DNAC IN WSS-VARI.
      *>>>>
*% END
*% IF FIN_FRM_VRF_ICLI
      *<<<< FIN_FRM_VRF_ICLI
           IF MSG-COD-MENS > SPACES
              GO TO FIN-VAL-FRM-VRF-ICLI.
           MOVE FRM-NUM-ICLI IN CCH-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-ICLI IN CCH-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-ICLI IN CCH-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
              GO TO FIN-VAL-FRM-VRF-ICLI.

           MOVE WSS-NUM-ICLI IN WSS-VARI TO DBC-NUM-ICLI IN DBC.
           MOVE WSS-IND-ICLI IN WSS-VARI TO DBC-IND-ICLI IN DBC.
           MOVE WSS-GLS-ICLI IN WSS-VARI TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'NOCLICHIPNEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_FRM_COD_GRPO
      *<<<< FIN_FRM_COD_GRPO
           IF FRM-COD-GRPO IN CCH-FLD > SPACES
              MOVE 'QHP' TO WSS-COD-SIST IN WSS-VARI.
      *>>>>
*% END
*% IF INI_FRM_FEC_FCUR
      *<<<< INI_FRM_FEC_FCUR                                    
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-CHOY-N TO FEC-CHOY.                         
           IF FRM-FEC-FCUR IN CCH-FLD  NOT > ZEROES             
              PERFORM GET-FHOY                                  
              MOVE HOY-DHOY TO FRM-NUM-DCUR IN CCH-FLD          
              MOVE HOY-MHOY TO FRM-NUM-MCUR IN CCH-FLD          
              MOVE HOY-SHOY TO FRM-NUM-SCUR IN CCH-FLD          
              MOVE HOY-AHOY TO FRM-NUM-ACUR IN CCH-FLD          
              GO TO FIN-VAL-FRM-FEC-FCUR.                       
      *>>>>                                                     
*% END
*% IF FRM_NUM_PFIN
      *<<<< FRM_NUM_PFIN
      *OGB-INI 16-MAR-2016 VARIABLES CHIP EN MC2
           IF FRM-NUM-PFIN IN CCH-FLD > WSS-CT-100
              MOVE WSS-CT-MC2     TO MSG-COD-SIST
              MOVE WSS-CT-PFIN    TO MSG-COD-MENS 
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *OGB-FIN 16-MAR-2016 VARIABLES CHIP EN MC2
      *>>>>                                                             
*% END
*% IF FRM_COD_TFIN
      *<<<< FRM_COD_TFIN
      *OGB-INI 16-MAR-2016 VARIABLES CHIP EN MC2
           IF FRM-COD-TFIN IN CCH-FLD NOT > SPACES
              GO TO FIN-VAL-FRM-COD-TFIN.
           
           MOVE SPACES TO TAB.
           MOVE 'TAB'                   TO TAB-COD-SIST.       
           MOVE 'AGD'                   TO TAB-CIC-TTAB IN TAB.           
           MOVE 'TFM'                   TO TAB-CIC-CTAB IN TAB.           
           MOVE WSS-CT-TABL             TO FIO-AKEY.                      
           PERFORM VAL-TAB.

           IF MSG-COD-MENS = WSS-CT-CNEX OR WSS-CT-CNVG
              PERFORM GET-MSG
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-TFIN. 

           IF TAB-COD-DAT3(1) > SPACES AND
              TAB-COD-DAT3(1) NOT = WSS-CT-SIS
              IF TAB-COD-DAT3(10) NOT > SPACES
                 MOVE SPACES TO TAB-COD-TTAB TAB-COD-CTAB
                 MOVE TAB-COD-DAT3(1)         TO TAB-COD-SIST
                 MOVE TAB-GLS-DAT1 IN TAB     TO TAB-COD-TTAB IN TAB
                 MOVE FRM-COD-TFIN IN CCH-FLD TO TAB-COD-CTAB IN TAB
                 PERFORM VAL-COD.
      *OGB-FIN 16-MAR-2016 VARIABLES CHIP EN 
      *>>>>                                                             
*% END
*% IF FRM_COD_TPRO
      *<<<< FRM_COD_TPRO
      *OGB-INI 16-MAR-2016 VARIABLES CHIP EN MC2
           IF FRM-COD-TPRO IN CCH-FLD NOT > SPACES
              GO TO FIN-VAL-FRM-COD-TPRO.
           
           MOVE SPACES TO TAB.
           MOVE 'TAB'                   TO TAB-COD-SIST.       
           MOVE 'AGD'                   TO TAB-CIC-TTAB IN TAB.           
           MOVE 'APD'                   TO TAB-CIC-CTAB IN TAB.           
           MOVE WSS-CT-TABL             TO FIO-AKEY.                      
           PERFORM VAL-TAB.

           IF MSG-COD-MENS = WSS-CT-CNEX OR WSS-CT-CNVG
              PERFORM GET-MSG
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-TPRO.

           IF TAB-COD-DAT3(1) > SPACES AND
              TAB-COD-DAT3(1) NOT = WSS-CT-SIS
              IF TAB-COD-DAT3(10) NOT > SPACES
                 MOVE SPACES TO TAB-COD-TTAB TAB-COD-CTAB
                 MOVE TAB-COD-DAT3(1)         TO TAB-COD-SIST
                 MOVE TAB-GLS-DAT1 IN TAB     TO TAB-COD-TTAB IN TAB
                 MOVE FRM-COD-TPRO IN CCH-FLD TO TAB-COD-CTAB IN TAB
                 PERFORM VAL-COD.
      *OGB-FIN 16-MAR-2016 VARIABLES CHIP EN MC2
      *>>>>                                                             
*% END
*% IF FRM_COD_INMB
      *<<<< FRM_COD_INMB
      *OGB-INI 16-MAR-2016 VARIABLES CHIP EN MC2
           MOVE SPACES TO WSS-COD-GINM.

           IF FRM-COD-INMB IN CCH-FLD NOT > SPACES AND
              FRM-COD-PRYI IN CCH-FLD NOT > SPACES
              GO TO FIN-VAL-FRM-COD-INMB.

           MOVE SPACES TO TAB.
           MOVE 'TAB'                   TO TAB-COD-SIST.       
           MOVE 'AGD'                   TO TAB-CIC-TTAB IN TAB.           
           MOVE 'PIN'                   TO TAB-CIC-CTAB IN TAB.           
           MOVE WSS-CT-TABL             TO FIO-AKEY.                      
           PERFORM VAL-TAB.

           IF MSG-COD-MENS = WSS-CT-CNEX OR WSS-CT-CNVG
              PERFORM GET-MSG
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-INMB. 

           IF TAB-COD-DAT3(1) > SPACES AND
              TAB-COD-DAT3(1) NOT = WSS-CT-SIS
              IF TAB-COD-DAT3(10) NOT > SPACES
                 MOVE SPACES TO TAB-COD-TTAB TAB-COD-CTAB
                 MOVE TAB-COD-DAT3(1)         TO TAB-COD-SIST
                 MOVE TAB-GLS-DAT1 IN TAB     TO TAB-COD-TTAB IN TAB
                 MOVE FRM-COD-INMB IN CCH-FLD TO WSS-COD-INMB
                 MOVE FRM-COD-PRYI IN CCH-FLD TO WSS-COD-PRYC
                 MOVE WSS-GLS-INMB            TO TAB-COD-CTAB IN TAB
                 PERFORM VAL-TAB
                 IF MSG-COD-MENS NOT > SPACES
                    MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-GINM.
      *OGB-FIN 16-MAR-2016 VARIABLES CHIP EN MC2
      *>>>>                                                             
*% END
*% IF FRM_COD_MGDM
      *<<<< FRM_COD_MGDM
           MOVE 'MC2'                   TO TAB-COD-SIST.                
           MOVE 'GDM'                   TO TAB-COD-TTAB IN TAB.         
           MOVE FRM-COD-MGDM IN CCH-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
      *>>>>                                                             
*% END
*% IF FRM_COD_TCNL
      *<<<< FRM_COD_TCNL                                                
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'CNL'                   TO TAB-COD-TTAB IN TAB.         
           MOVE FRM-COD-TCNL IN CCH-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
      *>>>>                                                             
*% END
*% IF FRM_COD_CNAL
      *<<<< FRM_COD_CNAL
           IF FRM-COD-CNAL IN CCH-FLD NOT > SPACES
              GO TO FIN-VAL-FRM-COD-CNAL.
           IF FRM-COD-TCNL IN CCH-FLD NOT = '010'                      
              MOVE 'TAB'                   TO TAB-COD-SIST             
              MOVE FRM-COD-TCNL IN CCH-FLD TO TAB-COD-TTAB IN TAB      
              MOVE FRM-COD-CNAL IN CCH-FLD TO TAB-COD-CTAB IN TAB      
              PERFORM VAL-COD                                          
           ELSE                                                        
              MOVE FRM-COD-CNAL IN CCH-FLD TO OFI-COD-OFIC IN OFI      
              PERFORM VAL-OFI.                                         
      *>>>>                                                            
*% END
*% IF FRM_COD_VCOC
      *<<<< FRM_COD_VCOC                                                
      *VAL-COD Valida codigo de tabla                                   
           IF FRM-COD-VCOC IN CCH-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-VCOC IN CCH-FLD TO TAB-COD-CTAB IN TAB
              MOVE FRM-COD-VCOC IN CCH-FLD TO WSS-COD-VCOC IN WSS-VARI
              PERFORM VAL-COD.
      *>>>>                                                             
*% END
*% IF FRM_COD_TOOC
      *<<<< FRM_COD_TOOC                                                
           IF FRM-COD-GRPO IN CCH-FLD NOT > SPACES
              IF FRM-COD-VCOC IN CCH-FLD > SPACES AND
                 FRM-COD-TOOC IN CCH-FLD NOT > SPACES
                 PERFORM ERR-GLS
                 GO TO FIN-VAL-FRM-COD-TOOC.

           IF FRM-COD-VCOC IN CCH-FLD NOT > SPACES AND
              FRM-COD-TOOC IN CCH-FLD > SPACES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'CODTOOC  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-TOOC.

           IF FRM-COD-TOOC IN CCH-FLD NOT > SPACES
              GO TO FIN-VAL-FRM-COD-TOOC.
           MOVE SPACES TO WSS-COD-SIST IN WSS-VARI.
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.         
           MOVE FRM-COD-TOOC IN CCH-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT = 'COD    NEX' AND                       
              FRM-COD-TOOC IN CCH-FLD > SPACES                          
               MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-DAT1                 
           ELSE                                                         
               MOVE SPACES              TO WSS-GLS-DAT1.                
           IF WSS-COD-SIST IN WSS-VARI NOT > SPACES                          
              MOVE 'SISTIO   NEX'        TO MSG-COD-MENS                
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
           ELSE                                                         
              IF WSS-COD-SIST IN WSS-VARI = 'COL'                          
                 MOVE 'CRE' TO WSS-COD-SIST IN WSS-VARI.                   
      *>>>>                                                             
*% END
*% IF FIN_FRM_COD_AOOC
      *<<<< FIN_FRM_COD_AOOC                                            
           IF FRM-COD-TOOC IN CCH-FLD > SPACES AND
              FRM-COD-AOOC IN CCH-FLD NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-COD-AOOC.
           IF FRM-COD-TOOC IN CCH-FLD NOT > SPACES AND
              FRM-COD-AOOC IN CCH-FLD > SPACES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'CODAOOC  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-AOOC.

           MOVE SPACES TO WSS-GLS-TAUX IN WSS-VARI.
           IF FRM-COD-AOOC IN CCH-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'AUX'                    TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TOOC IN CCH-FLD  TO WSS-COD-TTIO IN WSS-VARI
              MOVE FRM-COD-AOOC IN CCH-FLD  TO WSS-COD-TAUX IN WSS-VARI
              MOVE WSS-GLS-TAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.                                             
      *>>>>                                                             
*% END
*% IF FRM_VAL_MOPE
      *<<<< FIN_FRM_VAL_MOPE
           MOVE FRM-VAL-MOPE IN CCH-FLD TO
                FRM-VAL-MOPE-EDT IN CCH-EDT.
           MOVE FRM-VAL-MOPE-EDT IN CCH-EDT TO 
                FRM-VAL-MOPE-ALF IN CCH-FLD.
           MOVE FRM-VAL-MOPE-ALF IN CCH-FLD TO NUM-NUME.
           MOVE NUM-ZERO-N TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
              MOVE NUM-NN9V TO FRM-VAL-MOPE IN CCH-FLD
           ELSE
              MOVE NUM-MENS     TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              MOVE -9 TO FRM-VAL-MOPE-LEN IN CCH-FLD
              GO TO FIN-VAL-FRM-VAL-MOPE.
      *>>>>
*% END 
*% IF FRM_IND_MNTO
      *<<<< FRM_IND_MNTO
           IF FRM-IND-MNTO IN CCH-FLD NOT > SPACES
              MOVE 'B'    TO FRM-IND-MNTO IN CCH-FLD
              GO TO FIN-VAL-FRM-IND-MNTO.
           IF FRM-IND-MNTO IN CCH-FLD = 'B' OR 'L'
              GO TO FIN-VAL-FRM-IND-MNTO.
           MOVE 'MC2'          TO MSG-COD-SIST.
           MOVE 'INDMNTO  INV' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC   TO FRM-MENS.
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.
           GO TO FIN-VAL-FRM-IND-MNTO.
      *>>>>
*% END
*% IF FRM_IND_DSTN
      *<<<< FRM_IND_DSTN
           IF FRM-IND-DSTN IN CCH-FLD > SPACES
              MOVE 'MC2'                   TO TAB-COD-SIST
              MOVE 'DST'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-IND-DSTN IN CCH-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.                                             
      *>>>>
*% END      
*% IF FRM_IND_OBJT
      *<<<< FRM_IND_OBJT
           IF FRM-IND-OBJT IN CCH-FLD > SPACES
              MOVE 'MC2'                   TO TAB-COD-SIST
              MOVE 'OCH'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-IND-OBJT IN CCH-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.                                             
      *>>>>                                                             
*% END
*% IF FRM_IND_PPAG
      *<<<< FRM_IND_PPAG
           IF FRM-IND-PPAG IN CCH-FLD > SPACES
              MOVE 'MC2'                   TO TAB-COD-SIST
              MOVE 'SON'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-IND-PPAG IN CCH-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.                                             
      *>>>>                                                             
*% END
*% IF FRM_IND_CPAC
      *<<<< FRM_IND_CPAC
      *OGB-INI 16-MAR-2016 VARIABLES CHIP EN MC2
           IF FRM-IND-CPAC IN CCH-FLD NOT > SPACES
              GO TO FIN-VAL-FRM-IND-CPAC.
           
           MOVE SPACES TO TAB.
           MOVE 'TAB'                   TO TAB-COD-SIST.       
           MOVE 'AGD'                   TO TAB-CIC-TTAB IN TAB.           
           MOVE 'PCH'                   TO TAB-CIC-CTAB IN TAB.           
           MOVE WSS-CT-TABL             TO FIO-AKEY.                      
           PERFORM VAL-TAB.

           IF MSG-COD-MENS = WSS-CT-CNEX OR WSS-CT-CNVG
              PERFORM GET-MSG
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-IND-CPAC.

           IF TAB-COD-DAT3(1) > SPACES AND
              TAB-COD-DAT3(1) NOT = WSS-CT-SIS
              IF TAB-COD-DAT3(10) NOT > SPACES
                 MOVE SPACES TO TAB-COD-TTAB TAB-COD-CTAB
                 MOVE TAB-COD-DAT3(1)         TO TAB-COD-SIST
                 MOVE TAB-GLS-DAT1 IN TAB     TO TAB-COD-TTAB IN TAB
                 MOVE FRM-IND-CPAC IN CCH-FLD TO TAB-COD-CTAB IN TAB
                 PERFORM VAL-COD.

      *    IF FRM-IND-CPAC IN CCH-FLD > SPACES
      *       MOVE 'MC2'                   TO TAB-COD-SIST
      *       MOVE 'SON'                   TO TAB-COD-TTAB IN TAB
      *       MOVE FRM-IND-CPAC IN CCH-FLD TO TAB-COD-CTAB IN TAB
      *       PERFORM VAL-COD.         
      *OGB-FIN 16-MAR-2016 VARIABLES CHIP EN MC2
      *>>>>                                                             
*% END
*% IF INI_FRM_FEC_FVEN
      *<<<< INI_FRM_FEC_FVEN                                    
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-CHOY-N TO FEC-CHOY.                        
      *>>>>                                                     
*% END
*% IF FIN_FRM_FEC_FVEN
      *<<<< FIN_FRM_FEC_FVEN
           MOVE FRM-NUM-DCUR IN CCH-FLD TO WSS-NUM-DCUR IN WSS-VARI.
           MOVE FRM-NUM-MCUR IN CCH-FLD TO WSS-NUM-MCUR IN WSS-VARI.
           MOVE FRM-NUM-SCUR IN CCH-FLD TO WSS-NUM-SCUR IN WSS-VARI.
           MOVE FRM-NUM-ACUR IN CCH-FLD TO WSS-NUM-ACUR IN WSS-VARI.
           MOVE FRM-NUM-DVEN IN CCH-FLD TO WSS-NUM-DVEN IN WSS-VARI.
           MOVE FRM-NUM-MVEN IN CCH-FLD TO WSS-NUM-MVEN IN WSS-VARI.
           MOVE FRM-NUM-SVEN IN CCH-FLD TO WSS-NUM-SVEN IN WSS-VARI.
           MOVE FRM-NUM-AVEN IN CCH-FLD TO WSS-NUM-AVEN IN WSS-VARI.

           IF WSS-FEC-FVEN IN WSS-VARI < WSS-FEC-FCUR IN WSS-VARI
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'FCURVEN  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-FEC-FVEN.
      *>>>>
*% END
*% IF FRM_IND_UTSV
      *<<<< FRM_IND_UTSV
           MOVE 'TAB'                   TO MSC-COD-SIST.                
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.         
           MOVE FRM-IND-UTSV IN CCH-FLD TO MSC-COD-CMSC IN MSC.         
           PERFORM VAL-IND.                                             
      *>>>>
*% END
*% IF FRM_NUM_MNP1
      *<<<< FRM_NUM_MNP1
            IF FRM-NUM-MNP1 IN CCH-FLD > 12
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'NUMMNP   INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-MNP1.
      *>>>>
*% END
*% IF FRM_NUM_MNP2
      *<<<< FRM_NUM_MNP2
            IF FRM-NUM-MNP2 IN CCH-FLD > ZEROES
            IF FRM-NUM-MNP2 IN CCH-FLD > 12 OR
               FRM-NUM-MNP2 IN CCH-FLD = FRM-NUM-MNP1 IN CCH-FLD
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'NUMMNP   INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-MNP2.
      *>>>>
*% END
*% IF FRM_NUM_MNP3
      *<<<< FRM_NUM_MNP3
            IF FRM-NUM-MNP3 IN CCH-FLD > ZEROES
            IF FRM-NUM-MNP3 IN CCH-FLD > 12 OR
               FRM-NUM-MNP3 IN CCH-FLD = FRM-NUM-MNP2 IN CCH-FLD OR
               FRM-NUM-MNP3 IN CCH-FLD = FRM-NUM-MNP1 IN CCH-FLD
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'NUMMNP   INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-MNP3.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_CCH
      *<<<< FIN_VAL_CON_KEY_CCH
           IF (FRM-COD-GRPO IN CCH-FLD NOT > SPACES AND
               FRM-COD-VCOC IN CCH-FLD NOT > SPACES AND
               FRM-COD-TOOC IN CCH-FLD NOT > SPACES AND
               FRM-COD-AOOC IN CCH-FLD NOT > SPACES)
               MOVE 'S'            TO FRM-UCUR
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'CCHPROD  OBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               MOVE FRM-IND-ERRO   TO FRM-COD-GRPO-LEN IN CCH-FLD
               GO TO FIN-VAL-CON-KEY-CCH.

           IF (FRM-COD-GRPO IN CCH-FLD > SPACES AND
               FRM-COD-VCOC IN CCH-FLD > SPACES AND
               FRM-COD-TOOC IN CCH-FLD > SPACES AND
               FRM-COD-AOOC IN CCH-FLD > SPACES)
               MOVE 'S'            TO FRM-UCUR
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'CCHGRPO  INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               MOVE FRM-IND-ERRO   TO FRM-COD-GRPO-LEN IN CCH-FLD
               GO TO FIN-VAL-CON-KEY-CCH.

           IF FRM-COD-GRPO IN CCH-FLD > SPACES
              PERFORM PRO-VAL-GRPO
              IF MSG-COD-MENS > SPACES
                 MOVE 'S'            TO FRM-UCUR
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'CCHGRPO  NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 MOVE FRM-IND-ERRO   TO FRM-COD-GRPO-LEN IN CCH-FLD
                 GO TO FIN-VAL-CON-KEY-CCH
              ELSE
                 MOVE FRM-COD-GRPO IN CCH-FLD TO 
                      CCH-COD-GRPO IN CCH-VARI
                 MOVE ZEROES      TO WSS-POC-VAL-CMIN
                 MOVE 99999999999 TO WSS-POC-VAL-CMAX
                 MOVE ZEROES      TO WSS-POC-NUM-VMIN
                 MOVE 999         TO WSS-POC-NUM-VMAX
                 MOVE 'N'         TO WSS-IND-AFER IN WSS-VARI
                 MOVE 'PAG'       TO WSS-COD-TDOC IN WSS-VARI.

           IF FRM-COD-GRPO IN CCH-FLD NOT > SPACES
              PERFORM PRO-VAL-RPOC
              IF MSG-COD-MENS > SPACES
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-CON-KEY-CCH.
           IF FRM-IND-CPAC IN CCH-FLD = 'S'
              MOVE 'AUT' TO WSS-COD-TCAR IN WSS-VARI.
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
       PRO-VAL-RPOC SECTION.
       INI-PRO-VAL-RPOC.
           MOVE SPACES                  TO MSG-COD-MENS.
           MOVE FRM-COD-VCOC IN CCH-FLD TO POC-COD-VCOC IN POC.
           MOVE FRM-COD-TOOC IN CCH-FLD TO POC-COD-TOOC IN POC.
           MOVE FRM-COD-AOOC IN CCH-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
              MOVE 'COL'        TO MSG-COD-SIST
              MOVE 'POC    NEX' TO MSG-COD-MENS
              GO TO FIN-PRO-VAL-RPOC.

           MOVE 1 TO WSS-PLN IN CCH-VARI.
           MOVE FRM-COD-VCOC IN CCH-FLD TO WSS-PLN-VCOC(WSS-PLN).
           MOVE FRM-COD-TOOC IN CCH-FLD TO WSS-PLN-TOOC(WSS-PLN).
           MOVE FRM-COD-AOOC IN CCH-FLD TO WSS-PLN-AOOC(WSS-PLN).

           MOVE ZEROES      TO WSS-POC-VAL-CMIN.
           IF POC-VAL-CMIN IN POC > ZEROES
              MOVE POC-VAL-CMIN IN POC TO WSS-POC-VAL-CMIN.

           MOVE 99999999999 TO WSS-POC-VAL-CMAX.
           IF POC-VAL-CMAX IN POC > ZEROES
              MOVE POC-VAL-CMAX IN POC TO WSS-POC-VAL-CMAX.

           MOVE ZEROES      TO WSS-POC-NUM-VMIN.
           IF POC-NUM-VMIN IN POC > ZEROES
              MOVE POC-NUM-VMIN IN POC TO WSS-POC-NUM-VMIN.

           MOVE 999         TO WSS-POC-NUM-VMAX.
           IF POC-NUM-VMAX IN POC > ZEROES
              MOVE POC-NUM-VMAX IN POC TO WSS-POC-NUM-VMAX.
           
           IF POC-IND-AFER IN POC > SPACES
              MOVE POC-IND-AFER IN POC TO WSS-IND-AFER IN WSS-VARI
           ELSE
              MOVE 'N'                 TO WSS-IND-AFER IN WSS-VARI.
           
           IF POC-COD-TDOC IN POC > SPACES
              MOVE  POC-COD-TDOC IN POC TO WSS-COD-TDOC IN WSS-VARI
           ELSE
              MOVE 'PAG'                TO WSS-COD-TDOC IN WSS-VARI.
              
       FIN-PRO-VAL-RPOC.
           EXIT.

       PRO-VAL-GRPO SECTION.
       INI-PRO-VAL-GRPO.
           MOVE FRM-NUM-DCUR IN CCH-FLD TO WSS-NUM-DCON IN WSS-VARI.
           MOVE FRM-NUM-MCUR IN CCH-FLD TO WSS-NUM-MCON IN WSS-VARI.
           MOVE FRM-NUM-SCUR IN CCH-FLD TO WSS-NUM-SCON IN WSS-VARI.
           MOVE FRM-NUM-ACUR IN CCH-FLD TO WSS-NUM-ACON IN WSS-VARI.

           IF WSS-FEC-FCON IN WSS-VARI < HOY-FHOY IN HOY-VARI
              MOVE 235959               TO WSS-HRA-HCON IN WSS-VARI
           ELSE
              MOVE HOY-HHOY IN HOY-VARI TO WSS-HRA-HCON IN WSS-VARI.

           MOVE FRM-COD-GRPO IN CCH-FLD  TO PLN-CIC-PLAN IN PLN.
           MOVE WSS-STP-FCON IN WSS-VARI TO PLN-STP-FINI IN PLN.
           MOVE FIO-GET-LEQ TO FIO-CMND.
       LUP-PRO-VAL-GRPO.
           PERFORM TAB-FIO-PLN.
           MOVE FIO-STAT TO PGM-STAT-PLN.
           IF NOT ( FIO-STAT-OKS AND
                    PLN-CIC-PLAN IN PLN = FRM-COD-GRPO IN CCH-FLD)
              MOVE 'CCHPROD  NEX' TO MSG-COD-MENS
              GO TO FIN-PRO-VAL-GRPO.
           IF PLN-MSC-STAT IN PLN NOT = 'A'
              MOVE FIO-GET-PRV TO FIO-CMND
              GO TO LUP-PRO-VAL-GRPO.

           MOVE ZEROES TO WSS-PLN IN CCH-VARI.
      *BUSCA PRODUCTO EN PLAN
           MOVE PLN-CIC-IPRD IN PLN TO PRD-CIC-IPRD IN PRD.
           MOVE ZEROES              TO PRD-NUM-IPRD IN PRD.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-ANL-PRD-PROD.
           PERFORM TAB-FIO-PRD.
           MOVE FIO-STAT TO PGM-STAT-PRD.
           IF NOT (FIO-STAT-OKS AND
                   PRD-CIC-IPRD IN PRD = PLN-CIC-IPRD IN PLN )
              GO TO FIN-PRO-VAL-GRPO.

           IF NOT (PRD-COD-SIST IN PRD = 'QHP'  AND
                   PRD-COD-VCOC IN PRD > SPACES AND
                   PRD-COD-TOOC IN PRD > SPACES AND
                   PRD-COD-AOOC IN PRD > SPACES )
              GO TO NXT-ANL-PRD-PROD.
           IF NOT (PRD-COD-VCOC IN PRD = WSS-COD-VCOC IN WSS-VARI)
              GO TO NXT-ANL-PRD-PROD.
           
           ADD 1 TO WSS-PLN IN CCH-VARI.
           IF WSS-PLN IN CCH-VARI > WSS-PLNMAX IN CCH-VARI
              GO TO FIN-PRO-VAL-GRPO.

           MOVE PRD-COD-VCOC IN PRD TO WSS-PLN-VCOC(WSS-PLN).
           MOVE PRD-COD-TOOC IN PRD TO WSS-PLN-TOOC(WSS-PLN).
           MOVE PRD-COD-AOOC IN PRD TO WSS-PLN-AOOC(WSS-PLN).
       NXT-ANL-PRD-PROD.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-ANL-PRD-PROD.
       FIN-PRO-VAL-GRPO.
           IF PGM-STAT-PLN-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM TAB-FIO-PLN.
           IF PGM-STAT-PRD-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM TAB-FIO-PRD.
       EXT-PRO-VAL-GRPO.
           EXIT.
      *>>>>
*% END
