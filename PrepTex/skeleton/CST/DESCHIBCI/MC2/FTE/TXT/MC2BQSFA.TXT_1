*% IF FIN_UNP_KEY_SFA
      *<<<< FIN_UNP_KEY_SFA
           MOVE FRM-CPIM-AEY TO FRM-COD-CPTO-ATR IN SFA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-KEY-SIST-ATR IN SFA-FLD.
      *>>>> FIN_UNP_KEY_SFA
*% END
*% IF FIN_UNP_IKY_SFA
      *<<<< FIN_UNP_IKY_SFA
           MOVE FRM-CPIM-AEY TO FRM-COD-CPTO-ATR IN SFA-FLD.
           MOVE FRM-CPIM-AEY TO FRM-KEY-SIST-ATR IN SFA-FLD.
      *>>>> FIN_UNP_IKY_SFA
*% END
*% IF INI_FRM_COD_CPTO
      *<<<< INI_FRM_COD_CPTO
           IF FRM-COD-CPTO IN SFA-FLD NOT > SPACES
              MOVE WSS-IND-CPTO IN WSS-VARI TO
                   FRM-COD-CPTO IN SFA-FLD
              GO TO FIN-VAL-FRM-COD-CPTO.

           IF FRM-COD-CPTO IN SFA-FLD > SPACES AND
              FRM-COD-CPTO IN SFA-FLD = WSS-IND-CPTO IN WSS-VARI
              GO TO FIN-VAL-FRM-COD-CPTO.
      *>>>> INI_FRM_COD_CPTO
*% END
*% IF FRM_COD_CPTO
      *<<<< FRM_COD_CPTO
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'TCP'                    TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-CPTO IN SFA-FLD  TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF INI_FRM_FEC_FOPE
      *<<<< INI_FRM_FEC_FOPE
           MOVE FEC-CHOY-N TO FEC-CHOY.
           IF FRM-FEC-FOPE IN SFA-FLD  NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-DHOY TO FRM-NUM-DOPE IN SFA-FLD
              MOVE HOY-MHOY TO FRM-NUM-MOPE IN SFA-FLD
              MOVE HOY-SHOY TO FRM-NUM-SOPE IN SFA-FLD
              MOVE HOY-AHOY TO FRM-NUM-AOPE IN SFA-FLD
              GO TO FIN-VAL-FRM-FEC-FOPE.
      *>>>>
*% END
*% IF FRM_COD_TCON
      *<<<< FRM_COD_TCON
           IF FRM-COD-TCON IN SFA-FLD NOT > SPACES
      *PVG INI 27-AGO-2015
      *       MOVE 'CON'  TO FRM-COD-TCON IN SFA-FLD.
              MOVE 'CON'  TO FRM-COD-TCON IN SFA-FLD
              GO TO FIN-VAL-FRM-COD-TCON.
           IF (FRM-COD-TCON IN SFA-FLD = SFA-COD-VSPD IN SFA-VARI OR
               FRM-COD-TCON IN SFA-FLD = SFA-COD-VTAS IN SFA-VARI)
               GO TO FIN-VAL-FRM-COD-TCON.
           MOVE 'MC2'          TO MSG-COD-SIST.
           MOVE 'SFATCON  INV' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *PVG FIN 27-AGO-2015
      *>>>> FRM_COD_TCON
*% END
*% IF INI_FRM_KEY_SIST
      *<<<< INI_FRM_KEY_SIST
           IF FRM-KEY-SIST IN SFA-FLD NOT > SPACES
              MOVE WSS-IND-SIST IN WSS-VARI TO
                   FRM-KEY-SIST IN SFA-FLD
              GO TO FIN-VAL-FRM-KEY-SIST.

           IF FRM-KEY-SIST IN SFA-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-FRM-KEY-SIST.
           GO TO FIN-VAL-FRM-KEY-SIST.
      *>>>> INI_FRM_KEY_SIST
*% END
*% IF INI_FRM_IIC_IOPE
      *<<<< INI_FRM_IIC_IOPE
           IF FRM-IIC-IOPE IN SFA-FLD > ZEROES AND
              FRM-CAI-IOPE IN SFA-FLD NOT > SPACES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'SFAIIC   INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-IIC-IOPE.

           IF FRM-IIC-IOPE IN SFA-FLD NOT > ZEROES AND
              FRM-CAI-IOPE IN SFA-FLD > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-IIC-IOPE.
           GO TO FIN-VAL-FRM-IIC-IOPE.
      *>>>> INI_FRM_IIC_IOPE
*% END
*% IF FIN_FRM_EXT_IOPE
      *<<<< FIN_FRM_EXT_IOPE
           IF FRM-EXT-IOPE IN SFA-FLD > SPACES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'SFAEXT   INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-EXT-IOPE.
      *>>>> FIN_FRM_EXT_IOPE
*% END
*% IF INI_FRM_COD_EJEC
      *<<<< INI_FRM_COD_EJEC
           IF FRM-COD-EJEC IN SFA-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-EJEC IN SFA-FLD.
           IF FRM-COD-EJEC IN SFA-FLD NOT > SPACES AND
              FRM-CAI-IOPE IN SFA-FLD NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-COD-EJEC.
           IF FRM-COD-EJEC IN SFA-FLD > SPACES
              MOVE 'EJC '                  TO USR-COD-TTAB IN USR
              MOVE FRM-COD-EJEC IN SFA-FLD TO USR-COD-USER IN USR
              PERFORM VAL-TDU
              IF MSG-COD-MENS > SPACES
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE FRM-CPIM-UBY TO FRM-COD-EJEC-ATR IN SFA-FLD
                 GO TO FIN-VAL-FRM-COD-EJEC.
           GO TO FIN-VAL-FRM-COD-EJEC.
      *>>>> INI_FRM_COD_EJEC
*% END
*% IF INI_DBC_NUM_ICLI
      *<<<< INI_DBC_NUM_ICLI
           IF DBC-NUM-ICLI IN SPR-FLD NOT > ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DBC-NUM-ICLI.
      *>>>>
*% END
*% IF INI_FRM_COD_TCNL
      *<<<< INI_FRM_COD_TCNL
           IF FRM-COD-TCNL IN SFA-FLD NOT > SPACES
              MOVE SPACES TO FRM-COD-TCNL IN SFA-FLD.

           IF FRM-COD-TCNL IN SFA-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'CNL'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TCNL IN SFA-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
           ELSE
              MOVE WSS-IND-TCNL IN WSS-VARI TO FRM-COD-TCNL IN SFA-FLD.
           GO TO FIN-VAL-FRM-COD-TCNL.
      *>>>>
*% END
*% IF FRM_COD_CNAL
      *<<<< FRM_COD_CNAL
           IF FRM-COD-CNAL IN SFA-FLD NOT > SPACES
              GO TO FIN-VAL-FRM-COD-CNAL.
      *
           IF FRM-COD-TCNL IN SFA-FLD NOT = '010'
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE FRM-COD-TCNL IN SFA-FLD TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-CNAL IN SFA-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
           ELSE
              MOVE FRM-COD-CNAL IN SFA-FLD TO OFI-COD-OFIC IN OFI
              PERFORM VAL-OFI
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-CNAL.
      *>>>>
*% END
*% IF INI_FRM_COD_VCOC
      *<<<< INI_FRM_COD_VCOC
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-COD-VCOC IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFAVCOC  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-VCOC
              ELSE
                 GO TO FIN-VAL-FRM-COD-VCOC.
      *>>>> INI_FRM_COD_VCOC
*% END
*% IF FRM_COD_VCOC
      *<<<< FRM_COD_VCOC
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-VCOC IN SFA-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF INI_FRM_COD_TOOC
      *<<<< INI_FRM_COD_TOOC
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-COD-TOOC IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFATOOC  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-TOOC
              ELSE
                 GO TO FIN-VAL-FRM-COD-TOOC.
      *>>>> INI_FRM_COD_TOOC
*% END
*% IF FRM_COD_TOOC
      *<<<< FRM_COD_TOOC
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TOOC IN SFA-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX' AND
              FRM-COD-TOOC IN SFA-FLD > SPACES
               MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-DAT1
           ELSE
               MOVE SPACES              TO WSS-GLS-DAT1.
           IF TAB-GLS-DAT1 IN TAB NOT > SPACES
              MOVE 'SISTIO   NEX'        TO MSG-COD-MENS
           ELSE
              MOVE TAB-GLS-DAT1 IN TAB TO WSS-COD-SYST IN WSS-VARI.
      *SOLO BCI
           IF WSS-COD-SYST IN WSS-VARI = 'COL'
              MOVE 'CRE' TO WSS-COD-SYST IN WSS-VARI.
      *>>>>
*% END
*% IF INI_FRM_COD_AOOC
      *<<<< INI_FRM_COD_AOOC
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-COD-AOOC IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFAAOOC  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-AOOC
              ELSE
                 GO TO FIN-VAL-FRM-COD-AOOC.
      *>>>> INI_FRM_COD_AOOC
*% END
*% IF INI_FRM_NUM_PLZO
      *<<<< INI_FRM_NUM_PLZO
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-NUM-PLZO IN SFA-FLD > ZEROES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFAPLZO  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-NUM-PLZO
              ELSE
                 GO TO FIN-VAL-FRM-NUM-PLZO.
      *>>>> INI_FRM_NUM_PLZO
*% END
*% IF INI_FRM_MSC_UTPZ
      *<<<< INI_FRM_MSC_UTPZ
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-MSC-UTPZ IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFAUTPZ  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-MSC-UTPZ
              ELSE
                 GO TO FIN-VAL-FRM-MSC-UTPZ.
      *>>>> INI_FRM_MSC_UTPZ
*% END
*% IF FRM_MSC_UTPZ
      *<<<< FRM_MSC_UTPZ
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-UTPZ IN SFA-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF INI_FRM_VAL_MOPE
      *<<<< INI_FRM_VAL_MOPE
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-VAL-MOPE IN SFA-FLD > ZEROES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFAUTPZ  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-VAL-MOPE
              ELSE
                 GO TO FIN-VAL-FRM-VAL-MOPE.
      *>>>> INI_FRM_VAL_MOPE
*% END
*% IF INI_FRM_SGV_TSPR
      *<<<< INI_FRM_SGV_TSPR
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-SGV-TSPR IN SFA-FLD > ZEROES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFATSPR  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-SGV-TSPR
              ELSE
                 GO TO FIN-VAL-FRM-SGV-TSPR.
      *>>>> INI_FRM_SGV_TSPR
*% END
*% IF INI_FRM_SGV_TSSL
      *<<<< INI_FRM_SGV_TSSL
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-SGV-TSSL IN SFA-FLD > ZEROES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFATSSLININV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-SGV-TSSL
              ELSE
                 GO TO FIN-VAL-FRM-SGV-TSSL.
      *>>>> INI_FRM_SGV_TSSL
*% END
*% IF INI_FRM_MSC_BCTI
      *<<<< INI_FRM_MSC_BCTI
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-MSC-BCTI IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFABCTI  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-MSC-BCTI
              ELSE
                 GO TO FIN-VAL-FRM-MSC-BCTI.
      *>>>> INI_FRM_MSC_BCTI
*% END
*% IF FRM_MSC_BCTI
      *<<<< FRM_MSC_BCTI
           IF ( FRM-MSC-PBTI IN SFA-FLD > SPACES OR
                FRM-MSC-BPBT IN SFA-FLD > SPACES OR
                FRM-MSC-SPBT IN SFA-FLD > SPACES ) AND
                FRM-MSC-BCTI IN SFA-FLD NOT > SPACES

                MOVE 'TAB'        TO MSG-COD-SIST
                MOVE 'MSCBCTIOBL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-FRM-MSC-BCTI.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL'                   TO MSC-COD-SIST.
           MOVE 'BCTI'                  TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-BCTI IN SFA-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>> FRM_MSC_BCTI
*% END
*% IF INI_FRM_MSC_PBTI
      *<<<< INI_FRM_MSC_PBTI
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-MSC-PBTI IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFAPBTI  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-MSC-PBTI
              ELSE
                 GO TO FIN-VAL-FRM-MSC-PBTI.
      *>>>> INI_FRM_MSC_PBTI
*% END
*% IF FRM_MSC_PBTI
      *<<<< FRM_MSC_PBTI
           IF ( FRM-MSC-BCTI IN SFA-FLD > SPACES OR
                FRM-MSC-BPBT IN SFA-FLD > SPACES OR
                FRM-MSC-SPBT IN SFA-FLD > SPACES ) AND
                FRM-MSC-PBTI IN SFA-FLD NOT > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'MSCPBTIOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-MSC-PBTI.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL'                   TO MSC-COD-SIST.
           MOVE 'PBTI'                  TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-PBTI IN SFA-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>> FRM_MSC_PBTI
*% END
*% IF INI_FRM_MSC_BPBT
      *<<<< INI_FRM_MSC_BPBT
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-MSC-BPBT IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFABPBT  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-MSC-BPBT
              ELSE
                 GO TO FIN-VAL-FRM-MSC-BPBT.
      *>>>> INI_FRM_MSC_BPBT
*% END
*% IF FRM_MSC_BPBT
      *<<<< FRM_MSC_BPBT
           IF ( FRM-MSC-BCTI IN SFA-FLD > SPACES OR
                FRM-MSC-PBTI IN SFA-FLD > SPACES OR
                FRM-MSC-SPBT IN SFA-FLD > SPACES ) AND
                FRM-MSC-BPBT IN SFA-FLD NOT > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'MSCBPBTOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-MSC-BPBT.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL'                   TO MSC-COD-SIST.
           MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-BPBT IN SFA-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>> FRM_MSC_BPBT
*% END
*% IF INI_FRM_MSC_SPBT
      *<<<< INI_FRM_MSC_SPBT
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-MSC-SPBT IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFASPBT  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-MSC-SPBT
              ELSE
                 GO TO FIN-VAL-FRM-MSC-SPBT.
      *>>>> INI_FRM_MSC_SPBT
*% END
*% IF FRM_MSC_SPBT
      *<<<< FRM_MSC_SPBT
           IF ( FRM-MSC-BCTI IN SFA-FLD > SPACES OR
                FRM-MSC-PBTI IN SFA-FLD > SPACES OR
                FRM-MSC-BPBT IN SFA-FLD > SPACES ) AND
                FRM-MSC-SPBT IN SFA-FLD NOT > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'MSCSPBTOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-MSC-SPBT.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL'                   TO MSC-COD-SIST.
           MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-SPBT IN SFA-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>> FRM_MSC_SPBT
*% END
*% IF INI_FRM_COD_CVTI
      *<<<< INI_FRM_COD_CVTI 
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-MSC-SPBT IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFASPBT  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-COD-CVTI
              ELSE
                 GO TO FIN-VAL-FRM-COD-CVTI.
      *>>>> INI_FRM_COD_CVTI
*% END
*% IF FRM_COD_CVTI
      *<<<< FRM_COD_CVTI
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE 'I'                     TO WSS-COD-TVTI.
           MOVE FRM-COD-CVTI IN SFA-FLD TO WSS-COD-CVTI.
           MOVE FRM-MSC-PBTI IN SFA-FLD TO WSS-COD-TCTI.
           MOVE WSS-COD-VCAM            TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>> FRM_COD_CVTI
*% END
*% IF INI_FRM_MSC_TFPR
      *<<<< INI_FRM_MSC_TFPR
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-MSC-TFPR IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFATFPR  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-MSC-TFPR
              ELSE
                 GO TO FIN-VAL-FRM-MSC-TFPR.
      *>>>> INI_FRM_MSC_TFPR
*% END
*% IF FRM_MSC_TFPR
      *<<<< FRM_MSC_TFPR
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL'                   TO MSC-COD-SIST.
           MOVE 'TFPR'                  TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-TFPR IN SFA-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>> FRM_MSC_TFPR
*% END
*% IF INI_FRM_NUM_PREP
      *<<<< INI_FRM_NUM_PREP
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-NUM-PREP IN SFA-FLD > ZEROES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFAPREP  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-NUM-PREP
              ELSE
                 GO TO FIN-VAL-FRM-NUM-PREP.
      *>>>> INI_FRM_NUM_PREP
*% END
*% IF INI_FRM_MSC_UTPR
      *<<<< INI_FRM_MSC_UTPR
           IF FRM-CAI-IOPE IN SFA-FLD > SPACES
              IF FRM-MSC-UTPR IN SFA-FLD > SPACES
                 MOVE 'MC2'          TO MSG-COD-SIST
                 MOVE 'SFAUTPR  INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC   TO FRM-MENS
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR
                 GO TO FIN-VAL-FRM-MSC-UTPR
              ELSE
                 GO TO FIN-VAL-FRM-MSC-UTPR.
      *>>>> INI_FRM_MSC_UTPR
*% END
*% IF FRM_MSC_UTPR
      *<<<< FRM_MSC_UTPR
           IF FRM-NUM-PREP IN SFA-FLD NOT > ZEROES AND
              FRM-MSC-UTPR IN SFA-FLD > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'MSCUTPRINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-FRM-MSC-UTPR.
           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-UTPR IN SFA-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>> FRM_MSC_UTPR
*% END
*% IF INI_VAL_CON_KEY_SFA
      *<<<< INI_VAL_CON_KEY_SFA
           IF FRM-KEY-SIST IN SFA-FLD = WSS-IND-SIST IN WSS-VARI AND
              FRM-CAI-IOPE IN SFA-FLD > SPACES
              PERFORM PRO-OBT-VOPC
              IF MSG-COD-MENS > SPACES
                 MOVE 'MC2'        TO MSG-COD-SIST
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 MOVE -1 TO FRM-CAI-IOPE-LEN IN SFA-FLD
                 GO TO FIN-VAL-CON-KEY-SFA.

           IF FRM-SGV-TSSL IN SFA-FLD NOT < FRM-SGV-TSPR IN SFA-FLD
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'SFATSSL  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE -1 TO FRM-SGV-TSSL-LEN IN SFA-FLD
              GO TO FIN-VAL-CON-KEY-SFA.
      *>>>> INI_VAL_CON_KEY_SFA
*% END
*% IF FIN_VAL_CON_KEY_SFA
      *<<<< FIN_VAL_CON_KEY_SFA
      *PVG INI 27-AGO-2015
           IF FRM-COD-TCON IN SFA-FLD NOT = 'CON'
              MOVE FRM-COD-TCON IN SFA-FLD TO SFA-COD-TCON IN SFA-VARI
              MOVE FRM-COD-TCON IN SFA-FLD TO SFA-COD-TVAR IN SFA-VARI
              GO TO EXT-VAL-CON-KEY-SFA.
           MOVE FRM-COD-VCOC IN SFA-FLD TO SFA-COD-VCOC IN SFA-VARI.
           MOVE FRM-COD-TOOC IN SFA-FLD TO SFA-COD-TOOC IN SFA-VARI.
           MOVE FRM-COD-AOOC IN SFA-FLD TO SFA-COD-AOOC IN SFA-VARI.
       CNT-VAL-CON-KEY-SFA-0.

           MOVE 'MC2' TO TAB-COD-SIST FIO-SIST.
           MOVE SFA-GLS-TBFP IN SFA-VARI TO TAB-COD-TTAB IN TAB.
           MOVE SFA-GLS-CBFP IN SFA-VARI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              GO TO CNT-VAL-CON-KEY-SFA-1.
           MOVE TAB-GLS-DAT3 IN TAB TO SFA-GLS-IBFP IN SFA-VARI.
           IF (SFA-COD-TCON IN SFA-VARI = SFA-COD-PSPD IN SFA-VARI OR
               SFA-COD-TCON IN SFA-VARI = SFA-COD-PTAS IN SFA-VARI) AND
              (SFA-COD-TVAR IN SFA-VARI = SFA-COD-VSPD IN SFA-VARI OR
               SFA-COD-TVAR IN SFA-VARI = SFA-COD-VTAS IN SFA-VARI)
               GO TO EXT-VAL-CON-KEY-SFA.
       CNT-VAL-CON-KEY-SFA-1.
           IF SFA-COD-AOOC IN SFA-VARI > SPACES
              MOVE SPACES TO SFA-COD-AOOC IN SFA-VARI
              GO TO CNT-VAL-CON-KEY-SFA-0.
           IF SFA-COD-TOOC IN SFA-VARI > SPACES
              MOVE SPACES TO SFA-COD-TOOC IN SFA-VARI
              GO TO CNT-VAL-CON-KEY-SFA-0.
           IF SFA-COD-VCOC IN SFA-VARI > SPACES
              MOVE SPACES TO SFA-COD-VCOC IN SFA-VARI
              GO TO CNT-VAL-CON-KEY-SFA-0.

           MOVE SFA-COD-PSPD IN SFA-VARI TO SFA-COD-TCON IN SFA-VARI.
           MOVE SFA-COD-VSPD IN SFA-VARI TO SFA-COD-TVAR IN SFA-VARI.
           GO TO EXT-VAL-CON-KEY-SFA.
       EXT-VAL-CON-KEY-SFA.
           MOVE SFA-COD-TCON IN SFA-VARI TO FRM-COD-TCON IN SFA-FLD.
      *PVG FIN 27-AGO-2015
      *>>>> FIN_VAL_CON_KEY_SFA
*% END
*% IF INI_FRM_VAL_SOPE
      *<<<< INI_FRM_VAL_SOPE
           IF FRM-VAL-SOPE IN SPR-FLD NOT > ZEROES
              MOVE ZEROES TO FRM-VAL-SOPE IN SPR-FLD.
      *>>>>
*% END
*% IF FRM_VAL_FINA
      *<<<< FRM_VAL_FINA
           IF FRM-VAL-FINA IN SPR-FLD NOT > ZEROES
              MOVE ZEROES TO FRM-VAL-FINA IN SPR-FLD.
           IF FRM-COD-CPTO IN SPR-FLD = 'INT' AND
              FRM-VAL-FINA IN SPR-FLD NOT > ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-FRM-VAL-FINA.
      *>>>>
*% END
*% IF FRM_VAL_INTE
      *<<<< FRM_VAL_INTE
           IF FRM-VAL-INTE IN SPR-FLD NOT > ZEROES
              MOVE ZEROES TO FRM-VAL-INTE IN SPR-FLD.
      *>>>>
*% END
*% IF FRM_VAL_VASG
      *<<<< FRM_VAL_VASG
           IF FRM-VAL-VASG IN SPR-FLD NOT > ZEROES
              MOVE ZEROES TO FRM-VAL-VASG IN SPR-FLD.
      *>>>>
*% END
*% IF FRM_IND_RTBL
      *<<<< FRM_IND_RTBL
           IF FRM-IND-RTBL IN SPR-FLD > SPACES
              MOVE 'SGC'                   TO TAB-COD-SIST
              MOVE 'RTB'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-IND-RTBL IN SPR-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF INI_FRM_IND_COMP
      *<<<< INI_FRM_IND_COMP
           IF FRM-IND-COMP IN SPR-FLD NOT > SPACES
              MOVE SPACES TO FRM-IND-COMP IN SPR-FLD.
           IF FRM-IND-COMP IN SPR-FLD NOT > SPACES AND
              FRM-COD-CPTO IN SPR-FLD = 'INT'
              PERFORM ERR-GLS
              GO TO FIN-VAL-FRM-IND-COMP.
      *>>>>
*% END
*% IF FRM_COD_TCAR
      *<<<< FRM_COD_TCAR
           IF FRM-COD-TCAR IN SPR-FLD > SPACES
              MOVE 'COL'                   TO TAB-COD-SIST
              MOVE 'PAC'                   TO TAB-COD-TTAB IN TAB
              MOVE FRM-COD-TCAR IN SPR-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_SPR
      *<<<< FIN_VAL_CON_KEY_SPR
           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-EVEN IN SPR-FLD  TO WSS-COD-EVEN IN WSS-VARI.
           MOVE WSS-GLS-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
       PRO-OBT-VOPC SECTION.
       INI-PRO-OBT-VOPC.
           MOVE FRM-CAI-IOPE IN SFA-FLD TO OPC-CAI-IOPC IN OPC.
           MOVE FRM-IIC-IOPE IN SFA-FLD TO OPC-IIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF NOT FIO-STAT-OKS
              MOVE 'SFAOPC   NEX' TO MSG-COD-MENS
              GO TO FIN-PRO-OBT-VOPC.
           IF OPC-MSC-STAT IN OPC = WSS-IND-OPCL IN WSS-VARI OR
              OPC-MSC-STAT IN OPC = WSS-IND-OPCO IN WSS-VARI
              GO TO CNT-PRO-OBT-VOPC.
           MOVE 'SFAOPCSTAINV' TO MSG-COD-MENS
           GO TO FIN-PRO-OBT-VOPC.
       CNT-PRO-OBT-VOPC.

           IF FRM-COD-TCNL IN SFA-FLD = WSS-IND-TCNL IN WSS-VARI AND
              FRM-COD-CNAL IN SFA-FLD NOT > SPACES
              MOVE OPC-COD-OFOC IN OPC TO FRM-COD-CNAL IN SFA-FLD.

           MOVE OPC-COD-VCOC IN OPC TO FRM-COD-VCOC IN SFA-FLD.
           MOVE OPC-COD-TOOC IN OPC TO FRM-COD-TOOC IN SFA-FLD.
           MOVE OPC-COD-AOOC IN OPC TO FRM-COD-AOOC IN SFA-FLD.
           MOVE OPC-VAL-CRED IN OPC TO FRM-VAL-MOPE IN SFA-FLD.
           MOVE OPC-NUM-VCOR IN OPC TO FCC-NUM-VCOR IN FCC-VARI.
      *PVG INI 24-MAR-2015
           MOVE OPC-NUM-DCOL IN OPC TO FCC-NUM-DOPE IN FCC-VARI.
           MOVE OPC-NUM-MCOL IN OPC TO FCC-NUM-MOPE IN FCC-VARI.
           MOVE OPC-NUM-SCOL IN OPC TO FCC-NUM-SOPE IN FCC-VARI.
           MOVE OPC-NUM-ACOL IN OPC TO FCC-NUM-AOPE IN FCC-VARI.
      *PVG FIN 24-MAR-2015
           IF FRM-COD-EJEC IN SFA-FLD NOT > SPACES
              MOVE OPC-COD-RMOC IN OPC TO FRM-COD-EJEC IN SFA-FLD.
      *----------------------------------------------------------------*
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE 1                   TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS
              MOVE 'DLC    NEX'   TO MSG-COD-MENS
              GO TO FIN-PRO-OBT-VOPC.
           MOVE OPC-NUM-DCOL IN OPC TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC TO FEC-AEC1.
           MOVE DLC-NUM-DMAV IN DLC TO FEC-DEC2.
           MOVE DLC-NUM-MMAV IN DLC TO FEC-MEC2.
           MOVE DLC-NUM-SMAV IN DLC TO FEC-SEC2.
           MOVE DLC-NUM-AMAV IN DLC TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'DIFDIA NOVLD' TO MSG-COD-MENS
               GO TO FIN-PRO-OBT-VOPC.
           MOVE FEC-NDIA TO FRM-NUM-PLZO IN SFA-FLD.
           MOVE 'D'      TO FRM-MSC-UTPZ IN SFA-FLD.
      *----------------------------------------------------------------*
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.
           MOVE OPC-CIC-IOPC IN OPC TO ITR-CIC-IOPC IN ITR.
           MOVE ZEROES              TO ITR-NUM-ICAN IN ITR.
           MOVE SPACES              TO ITR-CIC-IOPV IN ITR
           MOVE ZEROES              TO ITR-NUM-IVCT IN ITR
           MOVE 'INT'               TO ITR-IND-TTAS IN ITR.
           MOVE ZEROES              TO ITR-FEC-FINI IN ITR.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-ITR.
           IF NOT ( FIO-STAT-OKS AND
                    ITR-CIC-IOPC IN ITR = OPC-CIC-IOPC IN OPC AND
                    ITR-NUM-ICAN IN ITR = ZEROES              AND
                    ITR-CIC-IOPV IN ITR = SPACES              AND
                    ITR-NUM-IVCT IN ITR = ZEROES              AND
                    ITR-IND-TTAS IN ITR = 'INT'  )
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'OPC    NOINT' TO MSG-COD-MENS
               GO TO FIN-PRO-OBT-VOPC.

      *PVG INI 24-MAR-2015
      *    MOVE ITR-SGV-TINT IN ITR TO FRM-SGV-TSPR IN SFA-FLD.
           MOVE ITR-SGV-TINT IN ITR TO FRM-SGV-TSSL IN SFA-FLD.
      *PVG FIN 24-MAR-2015
           MOVE ITR-MSC-BCTI IN ITR TO FRM-MSC-BCTI IN SFA-FLD.
           MOVE ITR-MSC-PBTI IN ITR TO FRM-MSC-PBTI IN SFA-FLD.
           MOVE ITR-MSC-BPBT IN ITR TO FRM-MSC-BPBT IN SFA-FLD.
           MOVE ITR-MSC-SPBT IN ITR TO FRM-MSC-SPBT IN SFA-FLD.
           MOVE ITR-COD-CVTI IN ITR TO FRM-COD-CVTI IN SFA-FLD.
           MOVE ITR-MSC-TFPR IN ITR TO FRM-MSC-TFPR IN SFA-FLD.
           MOVE ITR-NUM-PREP IN ITR TO FRM-NUM-PREP IN SFA-FLD.
           MOVE ITR-MSC-UTPR IN ITR TO FRM-MSC-UTPR IN SFA-FLD.
           IF ITR-COD-CVTI IN ITR > SPACES
      *PVG INI 24-MAR-2015
      *        MOVE ITR-SGV-SPRD IN ITR TO FRM-SGV-TSPR IN SFA-FLD.
               MOVE ITR-SGV-SPRD IN ITR TO FRM-SGV-TSSL IN SFA-FLD.

           PERFORM OBT-ROC-TSPR.
           IF WSS-IND-TSPR IN WSS-VARI = 'N'
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'ROCTSPR  NEX' TO MSG-COD-MENS
              GO TO FIN-PRO-OBT-VOPC.
      *PVG FIN 24-MAR-2015

           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT (FIO-STAT-OKS AND
                   RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC AND
                   RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC AND
                   RDC-NUM-IDLC IN RDC = ZEROES)
              MOVE 'COL'          TO MSG-COD-SIST
              MOVE 'RDC    NOCLI' TO MSG-COD-MENS
              GO TO FIN-PRO-OBT-VOPC.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'COL'          TO MSG-COD-SIST
              MOVE 'RDC    NOCLI' TO MSG-COD-MENS
              GO TO FIN-PRO-OBT-VOPC.

           MOVE DBC-CIC-ICLI IN DBC TO FCC-CIC-ICLI IN FCC-VARI.
       FIN-PRO-OBT-VOPC.
           EXIT.
      *PVG INI 24-MAR-2015
       OBT-ROC-TSPR SECTION.
       INI-OBT-ROC-TSPR.
           MOVE OPC-CAI-IOPC IN OPC TO ROC-CAI-IOPC IN ROC.
           MOVE OPC-IIC-IOPC IN OPC TO ROC-IIC-IOPC IN ROC.
           MOVE ZEROES              TO ROC-EXT-IOPC IN ROC.
           MOVE 'CRE'               TO ROC-COD-SIST IN ROC.
           MOVE 'CUR'               TO ROC-COD-EVEN IN ROC.
           MOVE ZEROES              TO ROC-NUM-IROC IN ROC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-ROC-TSPR.
           PERFORM TAB-FIO-ROC.
           IF NOT (FIO-STAT-OKS AND
                   ROC-CAI-IOPC IN ROC = OPC-CAI-IOPC IN OPC AND
                   ROC-IIC-IOPC IN ROC = OPC-IIC-IOPC IN OPC AND
                   ROC-EXT-IOPC IN ROC = ZEROES              AND
                   ROC-COD-SIST IN ROC = 'CRE'               AND
                   ROC-COD-EVEN IN ROC = 'CUR')
              GO TO EXT-OBT-ROC-TSPR.

           IF ROC-COD-CPTO IN ROC = 'INT' AND
              ROC-IND-TPLT IN ROC = 'P'
              MOVE ROC-SGV-TCAL IN ROC TO FRM-SGV-TSPR IN SFA-FLD
              MOVE 'S'                 TO WSS-IND-TSPR IN WSS-VARI
              GO TO EXT-OBT-ROC-TSPR.
       NXT-OBT-ROC-TSPR.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-OBT-ROC-TSPR.
       EXT-OBT-ROC-TSPR.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM TAB-FIO-ROC.
       FIN-OBT-ROC-TSPR.
           EXIT.
      *PVG FIN 24-MAR-2015
      *>>>> EOF_BQ
*% END
