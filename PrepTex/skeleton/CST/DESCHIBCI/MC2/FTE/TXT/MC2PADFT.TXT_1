*%! Codigo adicional para archivo
*% NO_TIENE_TIMESTAMP = FALSE
*% NO_HDR_CST = FALSE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% LARGO_MI_COMMAREA = 0
*% IF SETTAG
*% VSNPQ = "14.06.12.1"
*% VSNPU = "14.06.12.1"
*% FNCPQ = "MC2-FACTMNTO"
*% FNCPU = "MC2-FACTMNTO"
*% END
*%! Codigo adicional para archivo
*% IF WSS
      *<<<< WSS                                                         
       COPY GNSWCVRF.                                                   
       COPY GNSWVVRF.                                                   
      *COPY MC2BRDFT.                                                   
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DFT-REQA==.        
       COPY MC2BRCFT.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CFT-REQA==.        
       COPY GNSBRCIC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.        
       COPY GNSWGCIC.                                                   
       COPY GNSBRMSC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.        

       01  WSS-VARI.                                                    
           03 WSS-COD-EVEN.                                             
              05 WSS-COD-SIST                           PIC X(03).      
              05 WSS-COD-EVTO                           PIC X(06).      

           03 WSS-CIC-IDFT.                                             
              05 WSS-CAI-IDFT                           PIC X(04).      
              05 WSS-IIC-IDFT                           PIC X(08).      
      *>>>>                                                             
*% END
*% IF INI_FIO
      *<<<< INI_FIO                                                     
      *    IF SCR-OFRM-SRV                                              
      *         MOVE TSK-TERM-ALF TO CFT-COD-TERM-CIC                   
      *    ELSE                                                         
      *         MOVE EIBTRMID     TO CFT-COD-TERM-CIC.                  
      *>>>>                                                             
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *>>>>
*% END
*% IF FIN_FND_KEY 
      *<<<< FIN_FND_KEY
           PERFORM PUT-CFT-DFT.
           MOVE PGM-STAT-DFT TO FIO-STAT.
           IF SCR-CMND = 'ING' AND NOT FIO-STAT-OKS
              GO TO FIN-FND-KEY.

           IF SCR-CMND = 'CON'
              GO TO FIN-FND-KEY.

           IF CFT-MSC-STAT IN CFT = 'D'
              MOVE 'CFT    ANLYA' TO MSG-COD-MENS
              GO TO SIG-FND-KEY.

           IF CFT-MSC-STAT IN CFT = 'A' 
              MOVE 'CFT    ACAYA' TO MSG-COD-MENS
              GO TO SIG-FND-KEY.

           GO TO FIN-FND-KEY.

       SIG-FND-KEY.
           MOVE 'TAB'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00'         TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           MOVE 'S' TO SCR-IERR.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
              GO TO FIN-CMN-MOD.

           MOVE DFT-CIC-IDFT IN DFT TO CFT-CIC-IDFT IN CFT.
           MOVE 'CFT-CIC-IDFT' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           IF NOT FIO-STAT-OKS
              GO TO ERR-CMN-MOD-CFT.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           IF NOT FIO-STAT-OKS
              GO TO ERR-CMN-MOD-CFT.

           MOVE 'M' TO CFT-MSC-STAT IN CFT.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           IF NOT FIO-STAT-OKS
              GO TO ERR-CMN-MOD-CFT.
           GO TO FIN-CMN-MOD.
       ERR-CMN-MOD-CFT.
           MOVE FIO-ULK-REC TO FIO-CMND.
           PERFORM MC2-FIO-DFT.
           MOVE FIO-BCK-OUT TO FIO-CMND
           PERFORM MC2-FIO-DFT.

           MOVE FIO-ULK-REC TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           MOVE FIO-BCK-OUT TO FIO-CMND
           PERFORM MC2-FIO-CFT.

           MOVE 'MC2' TO MSG-COD-SIST
           MOVE 'ERRACCCFT' TO MSG-COD-MENS
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC TO FRM-MENS
           GO TO FIN-CMN-MOD.
      *>>>> FIN_CMN_MOD
*% END
*% IF FIN_CMN_ING
      *>>>> FIN_CMN_ING
           IF NOT FIO-STAT-OKS
              GO TO FIN-CMN-ING.

           MOVE DFT-CIC-IDFT IN DFT TO CFT-CIC-IDFT IN CFT.
           MOVE 'CFT-CIC-IDFT' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           IF NOT FIO-STAT-OKS
              GO TO ERR-CMN-ING-CFT.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           IF NOT FIO-STAT-OKS
              GO TO ERR-CMN-ING-CFT.

           MOVE 'I' TO CFT-MSC-STAT IN CFT.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           IF NOT FIO-STAT-OKS
              GO TO ERR-CMN-ING-CFT.
           GO TO FIN-CMN-ING.
       ERR-CMN-ING-CFT.
           MOVE FIO-ULK-REC TO FIO-CMND.
           PERFORM MC2-FIO-DFT.
           MOVE FIO-BCK-OUT TO FIO-CMND
           PERFORM MC2-FIO-DFT.

           MOVE FIO-ULK-REC TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           MOVE FIO-BCK-OUT TO FIO-CMND
           PERFORM MC2-FIO-CFT.

           MOVE 'MC2' TO MSG-COD-SIST
           MOVE 'ERRACCCFT' TO MSG-COD-MENS
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC TO FRM-MENS
           GO TO FIN-CMN-ING.
      *>>>> FIN_CMN_ING
*% END
*% IF FIN_CMN_ELI
      *>>>> FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
              GO TO FIN-CMN-ELI.

           MOVE DFT-CIC-IDFT IN DFT TO CFT-CIC-IDFT IN CFT.
           MOVE 'CFT-CIC-IDFT' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           IF NOT FIO-STAT-OKS
              GO TO ERR-CMN-ELI-CFT.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           IF NOT FIO-STAT-OKS
              GO TO ERR-CMN-ELI-CFT.

           MOVE 'M' TO CFT-MSC-STAT IN CFT.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           IF NOT FIO-STAT-OKS
              GO TO ERR-CMN-ELI-CFT.
           GO TO FIN-CMN-ELI.
       ERR-CMN-ELI-CFT.
           MOVE FIO-ULK-REC TO FIO-CMND.
           PERFORM MC2-FIO-DFT.
           MOVE FIO-BCK-OUT TO FIO-CMND
           PERFORM MC2-FIO-DFT.

           MOVE FIO-ULK-REC TO FIO-CMND.
           PERFORM MC2-FIO-CFT.
           MOVE FIO-BCK-OUT TO FIO-CMND
           PERFORM MC2-FIO-CFT.

           MOVE 'MC2' TO MSG-COD-SIST
           MOVE 'ERRACCCFT' TO MSG-COD-MENS
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC TO FRM-MENS
           GO TO FIN-CMN-ELI.
      *>>>> FIN_CMN_ELI
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       COPY MC2BFCFT.

       COPY GNSBVCOD.
       COPY GNSBFMSC.
       COPY GNSBVMSC.
       COPY GNSBVIND.
       COPY GNSBVTAB.
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
      *COPY MC2BFDFT.
       COPY MC2BFCFT.

       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY GNSBVCOD.
       COPY GNSBVMSC.
       COPY GNSBVIND.
       COPY GNSBVTAB.
       COPY GNSBBTAB.
       COPY GNSBBMSC.
       COPY GNSBFMSC.
      *>>>>
*% END
