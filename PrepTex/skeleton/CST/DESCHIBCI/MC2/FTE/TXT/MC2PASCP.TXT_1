*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% IF SETTAG
*% VSNPQ = "06.01.03.1"
*% VSNPU = "06.01.03.1"
*% FNCPQ = "MC2-PRECIOS"
*% FNCPU = "MC2-PRECIOS"
*% END
*% IF FIN_SCR_VARI
      *ISP DEBE QUEDAR PRIMERO QUE EL OTRO LABEL FIN_SCR_VARI 
           03  SCR-CIC-DIND.
               05  SCR-CAI-DIND                     PIC X(04).          
               05  SCR-IIC-DIND                     PIC X(08).          
           03  SCR-IND-SMDS                         PIC X(01).          
       COPY COLWGENG.
      *<<<<< FIN_SCR_VARI DESDE GNSSRC:PFSCONQUE
           03  SCR-NUM-PANT                         PIC 9(03).
           03  SCR-TOT-OCCU    VALUE 0              PIC 9(03).
      *>>>>> FIN_SCR_VARI DESDE GNSSRC:PFSCONQUE
*% END
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% PGM_STAT_SGS = TRUE
*% PFSQUECOPY = "MC2WXSCP"
*% LARGO_MI_COMMAREA = 0
*% PFSQUEMAXPAN= "10"
*% PFSQUEENT = "SCP"
*% PFSQUEPRV = "PF5"
*% PFSQUENXT = "PF6"
*% PFSQUESIS = "MC2"
*% PFSVARIPQ = "GAB"
*% PFSVARIPU = "GFL"
*%! INCLUDE 'GNSSRC:PFSCONQUE.SRC'
*% IF PGM_DTC AND EOF
      *<<<<< EOF DESDE GNSSRC:PFSCONQUE
       DEL-QUE-SCP SECTION.
       INI-DEL-QUE-SCP.
           MOVE SCP-NOM-TSSCP TO QUE-COLA.
      * MODIFICADO POR ISP EL  28-NOV-2006 17:24:06 PARA
      * IGUALAR CODIGO DAP-CVD
           MOVE 1 TO SCR-NUM-PANT.
           MOVE ZEROES TO SCR-TOT-OCCU.
           MOVE QUE-DEL TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-DEL-QUE-SCP.
           EXIT.
       SCP-MOV-TS-FRM SECTION.
       INI-SCP-MOV-TS-FRM.
           IF SCR-OFRM-SRV
               GO TO FIN-SCP-MOV-TS-FRM
           ELSE
               IF WSS-IND-PANT > WSS-MAX-PANT
                   GO TO FIN-SCP-MOV-TS-FRM.
           PERFORM SCP-MOV-TS-FRM-ELM.
      *     MOVE SCP-FLD01 TO
      *                FLD01 IN SCP-FLD(WSS-IND-PANT).
           ADD 1 TO WSS-IND-PANT.
       FIN-SCP-MOV-TS-FRM.
           EXIT.
      *>>>>> EOF DESDE GNSSRC:PFSCONQUE
      *<<<< PGM_DTC AND EOF
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *>>>>
*% END
*% IF CMT_ID_PU
      *=============================================================*
      *                        MANTENCIONES                         *
      *=============================================================*
      * MANTENCION : BCINET SIMULADOR CONSUMO
      * ETIQUETA   : *OGB-INI 24-FEB-2016 AGREGAR GRABADO TMC
      * OBJETIVO   : GUARDAR TASA MAXIMA CONVENCIONAL EN EL CAMPO 
      *              ROC-SGV-FRIE 
      * FECHA      : FEBRERO-2016
      * RESPONSABLE: CIMA-OGB
      *=============================================================*
*% END
*% IF WSS
      *<<<<< WSS DESDE GNSSRC:PFSCONQUE
       COPY MC2WXSCP.
       01  WSS-VARI-PFS-QUE.
           03 WSS-HAY-ERRO     VALUE 'N'            PIC X(01).
           03 WSS-FRM-FFLD     VALUE SPACES         PIC X(01).
           03 WSS-MAX-PANT     VALUE 10 PIC 9(05).
           03 WSS-IND-PANT     VALUE 1              PIC 9(05).
           03 WSS-IND-HMAS     VALUE 'N'            PIC X(01).
      *>>>>> WSS DESDE GNSSRC:PFSCONQUE
      *<<<< WSS
       77  WSS-ISCP            VALUE ZEROES         PIC 9(05).
       77  WSS-ISCP-AUX        VALUE ZEROES         PIC 9(05).

*% IF PGM_PQ
       COPY COLMXW05.
*% END
       01 WSS-VARI.
           03 WSS-N                                PIC 9(02).
           03 WSS-N-MAX         VALUE 30           PIC 9(02).
           03 WSS-I                                PIC 9(02).
           03 WSS-IMAX          VALUE 50           PIC 9(02).
           03 WSS-S                                PIC 9(02).
           03 WSS-NUM-NMES      VALUE ZEROES       PIC 9(06).
*% IF PGM_PQ
           03 WSS-NUM-NDIA      VALUE ZEROES       PIC 9(06).
*% END
           03 WSS-VAL-MNTO      VALUE ZEROES       PIC 9(13).
           03 WSS-COD-MONE      VALUE SPACES       PIC X(06).
           03 WSS-NUM-IROC      VALUE ZEROES       PIC 9(03).
           03 WSS-COD-TCAR      VALUE SPACES       PIC X(03).
*% IF PGM_PQ
           03 WSS-FEC-FPVT.
               05 WSS-NUM-SPVT                     PIC 9(02).
               05 WSS-NUM-APVT                     PIC 9(02).
               05 WSS-NUM-MPVT                     PIC 9(02).
               05 WSS-NUM-DPVT                     PIC 9(02).
           03 WSS-SGV-FACT-SCP.
               05 WSS-SGV-FACT-ALF                 PIC X(03).
               05 WSS-SGV-FACT      REDEFINES
                  WSS-SGV-FACT-ALF                 PIC 9(03).
           03 WSS-COD-COMP.
               05 WSS-COD-COMP-1                   PIC X(01).
               05 WSS-COD-COMP-2                   PIC X(01).
               05 WSS-COD-COMP-3                    PIC X(01).
      *PVG INI 22-MAY-2012
           03 WSS-IND-PKTT VALUE 'N'                PIC X(01).
      *PVG FIN 22-MAY-2012
      *PVG INI 21-OCT-2013
           03  WSS-GLS-HKEY.
               05  WSS-IND-NUM-ICAN                 PIC X(01).
               05  WSS-IND-NUM-IVCT                 PIC X(01).
               05  WSS-IND-COD-CLAS                 PIC X(01).
               05  WSS-IND-COD-COMP                 PIC X(01).
               05  WSS-IND-SGV-FACT                 PIC X(01).
               05  WSS-IND-CIC-ICVN                 PIC X(01).
               05  WSS-IND-IDC-ICLI                 PIC X(01).
               05  WSS-IND-VAL-TINF                 PIC X(01).
      *PVG FIN 21-OCT-2013
*% END
*% IF PGM_PU
           03 WSS-K                                PIC 9(02).
           03 WSS-KMAX          VALUE 50           PIC 9(02).
           03 WSS-L                                PIC 9(02).
           03 WSS-J                                PIC 9(02).
           03 WSS-JMAX          VALUE 50           PIC 9(02).
           03 WSS-R                                PIC 9(02).
           03 WSS-IND-DUPL      VALUE SPACES       PIC X(01).

           03 WSS-VEC-TSEG OCCURS 50.
              05 WSS-IND-SELE                      PIC X(01).
              05 WSS-COD-TSEG                      PIC X(03).

       COPY COLBRITR.
*% END           
       COPY MC2BRROC.
       COPY COLBROPC.
       COPY COLBRDLC.
       COPY COLBRTOC.
       COPY COLBRRDC.
       COPY COLBRVEN.
       COPY COLBRCAN.
*% IF PGM_PQ
      *PVG INI 22-MAY-2012
       COPY COLBRROV.
      *PVG FIN 22-MAY-2012
*% END
       COPY COLBREVC.
*% IF PGM_PQ
       COPY COLBRAUT.
*% END
*% IF PGM_PU
       COPY COLBRAUT.
*% END
       COPY SGCBRDBC.
       COPY COLWGUVD.
*% IF PGM_PQ
       COPY MC2WGSGS.
*% END
       COPY TABWGQSP.
       COPY MC2WGRCC.
      *PVG INI 09-JUN-2010
       COPY MC2WGCCM.                                                   
      *PVG FIN 09-JUN-2010
       COPY COLWGPMP.
*% IF NOT PGM_MCP AND NOT PGM_PTC
       COPY GNSWGQUE.
*% END
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.
*% IF PGM_PU
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
*% END
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
*% IF PGM_PQ
      *PVG INI 22-MAY-2012
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
      *PVG FIN 22-MAY-2012
*% END
      *>>>>
       01 WSS-NUM-VALOR VALUE ZEROES PIC 9(03).
       01 WSS-NUM-CCUR.
           03 WSS-NUM-ICUR-EDT  PIC  ZZ9.
           03 WSS-NUM-ICUR-ALF       PIC X(03).
           03 WSS-NUM-ICUR      REDEFINES
              WSS-NUM-ICUR-ALF       PIC 9(03).
*% END
*% IF FIN_SCR_VARI
      *     03 SCR-NUM-PANT               PIC 9(02).
           03 SCR-SCP-FLD                PIC X(1080).
      *PVG INI 15-MAY-2012
           03 SCR-COD-TCNL                         PIC X(03).
           03 SCR-COD-CNAL                         PIC X(03).
      *PVG FIN 15-MAY-2012
*% END
*% IF FIN_PGM_STAT
*% END
*% IF INI_FIO
*% IF PGM_PQ
      *<<<<< INI_FIO DESDE GNSSRC:PFSCONQUE
           IF SCR-OFRM-SRV
                MOVE TSK-TERM-ALF TO SCP-COD-TERM
                MOVE TSK-TERM-ALF TO SCP-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO SCP-COD-TERM
                MOVE EIBTRMID     TO SCP-COD-TERM-MAS.
           IF FRM-FFLD = FRM-FFLD-PF5 AND
              SCR-INST = SCR-INST-GAB
                MOVE FRM-FFLD-PF5 TO WSS-FRM-FFLD
                MOVE FRM-FFLD-RET TO FRM-FFLD
                MOVE SCR-INST-GKY TO SCR-INST
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF6 AND
              SCR-INST = SCR-INST-GAB
                MOVE FRM-FFLD-PF6 TO WSS-FRM-FFLD
                MOVE FRM-FFLD-RET TO FRM-FFLD
                MOVE SCR-INST-GKY TO SCR-INST
           ELSE
                MOVE FRM-FFLD-RET TO WSS-FRM-FFLD.
      *>>>>> INI_FIO DESDE GNSSRC:PFSCONQUE
*% END
*% IF PGM_PU
      *<<<<< INI_FIO DESDE GNSSRC:PFSCONQUE
           IF SCR-OFRM-SRV
                MOVE TSK-TERM-ALF TO SCP-COD-TERM
                MOVE TSK-TERM-ALF TO SCP-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO SCP-COD-TERM
                MOVE EIBTRMID     TO SCP-COD-TERM-MAS.
           IF FRM-FFLD = FRM-FFLD-PF5 AND
              SCR-INST = SCR-INST-GFL
                MOVE FRM-FFLD-PF5 TO WSS-FRM-FFLD
                MOVE FRM-FFLD-RET TO FRM-FFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF6 AND
              SCR-INST = SCR-INST-GFL
                MOVE FRM-FFLD-PF6 TO WSS-FRM-FFLD
                MOVE FRM-FFLD-RET TO FRM-FFLD
           ELSE
                MOVE FRM-FFLD-RET TO WSS-FRM-FFLD.
      *>>>>> INI_FIO DESDE GNSSRC:PFSCONQUE
*% END
      *<<<< INI_FIO
*% IF PGM_PQ
      *PVG INI 21-OCT-2013
           MOVE 'N' TO WSS-IND-NUM-ICAN IN WSS-VARI.
           MOVE 'N' TO WSS-IND-NUM-IVCT IN WSS-VARI.
           MOVE 'N' TO WSS-IND-COD-CLAS IN WSS-VARI.
           MOVE 'N' TO WSS-IND-COD-COMP IN WSS-VARI.
           MOVE 'N' TO WSS-IND-SGV-FACT IN WSS-VARI.
           MOVE 'N' TO WSS-IND-CIC-ICVN IN WSS-VARI.
           MOVE 'N' TO WSS-IND-IDC-ICLI IN WSS-VARI.
           MOVE 'N' TO WSS-IND-VAL-TINF IN WSS-VARI.

           MOVE 'TAB'          TO TAB-COD-SIST FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'HBLKEYMC2SCP' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              GO TO CNT-INI-FIO.
           IF (TAB-COD-DAT1(1) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(1) TO WSS-IND-NUM-ICAN IN WSS-VARI.
           IF (TAB-COD-DAT1(2) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(2) TO WSS-IND-NUM-IVCT IN WSS-VARI.
           IF (TAB-COD-DAT1(3) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(3) TO WSS-IND-COD-CLAS IN WSS-VARI.
           IF (TAB-COD-DAT1(4) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(4) TO WSS-IND-COD-COMP IN WSS-VARI.
           IF (TAB-COD-DAT1(5) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(5) TO WSS-IND-SGV-FACT IN WSS-VARI.
           IF (TAB-COD-DAT1(6) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(6) TO WSS-IND-CIC-ICVN IN WSS-VARI.
           IF (TAB-COD-DAT1(7) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(7) TO WSS-IND-IDC-ICLI IN WSS-VARI.
           IF (TAB-COD-DAT1(8) = 'S' OR 'N')
              MOVE TAB-COD-DAT1(8) TO WSS-IND-VAL-TINF IN WSS-VARI.
       CNT-INI-FIO.
      *PVG FIN 21-OCT-2013
      *PVG INI 09-JUN-2010
           MOVE 'N' TO SCR-IND-SMDS IN SCR-VARI.                        
           MOVE 'COL'          TO TAB-COD-SIST FIO-SIST.                
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.                  
           MOVE 'SEGMULDEUSCP' TO TAB-COD-CTAB IN TAB.                  
           MOVE FIO-GET-KEY    TO FIO-CMND.                             
           PERFORM GNS-FIO-TAB.                                         
           IF (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')              
               MOVE 'S' TO SCR-IND-SMDS IN SCR-VARI.                    
      *PVG FIN 09-JUN-2010
           IF SCR-OFRM-SRV                                              
                MOVE TSK-TERM-ALF TO RCC-COD-TERM-SGS
                MOVE 'S'          TO RCC-OFRM-SRV
           ELSE
                MOVE EIBTRMID     TO RCC-COD-TERM-SGS
                MOVE 'N'          TO RCC-OFRM-SRV.
*% ELSE
           IF SCR-OFRM-SRV                                              
                MOVE 'S'          TO RCC-OFRM-SRV
           ELSE
                MOVE 'N'          TO RCC-OFRM-SRV.
*% END
*% IF PGM_PQ
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-VEC-ENG
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'FLDING' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCR-MENS-EXT
               PERFORM ING-FPEN-CIC.
*% END
       FIN-INI-FIO.
      *>>>>
*% END
*% IF PFS_SCR_GKEY_PREV
      *<<<<< PFS_SCR_GKEY_PREV DESDE GNSSRC:PFSCONQUE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
                 IF FRM-FFLD = FRM-FFLD-PF5
                     MOVE FRM-FFLD-RET TO FRM-FFLD
              ELSE
                 IF FRM-FFLD = FRM-FFLD-PF6
                     MOVE FRM-FFLD-RET TO FRM-FFLD.
      *>>>>> PFS_SCR_GKEY_PREV DESDE GNSSRC:PFSCONQUE
*% END
*% IF SCR_GKEY_VAL_IKY
      *PTC-INI:   12-NOV-1996 08:50:01
           IF SCR-OFRM-SRV
              MOVE PTC-OPC-TYPE TO QUE-TYPE
              MOVE SCP-COD-TERM TO QUE-TERM
              MOVE PTC-OPC-LENG TO QUE-LITM
              MOVE 1            TO  QUE-NITM
              MOVE QUE-GET      TO QUE-CMND
              PERFORM GNS-PRO-QUE
              IF QUE-STAT = QUE-STAT-OKS
                  MOVE QUE-ITEM TO PTC-OPC-ITEM
                  MOVE PTC-OPC-OPC-CAI-IOPC TO OPC-CAI-IOPC IN SCP-FLD
                  MOVE PTC-OPC-OPC-IIC-IOPC TO OPC-IIC-IOPC IN SCP-FLD.
      *PTC-FIN:   12-NOV-1996 08:50:01
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
      *>>>>
*% END
*% IF INI_SCR_COM
      *<<<<< INI_SCR_COM DESDE GNSSRC:PFSCONQUE
           PERFORM DEL-QUE-SCP.
      *>>>>> INI_SCR_COM DESDE GNSSRC:PFSCONQUE
*% END
*% IF INI_FND_KEY
      *<<<<< INI_FND_KEY DESDE GNSSRC:PFSCONQUE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
              MOVE '00' TO FIO-STAT
              GO TO FIN-FND-KEY.
           PERFORM DEL-QUE-SCP.
              PERFORM SCP-ANL-KEY.
           MOVE 1 TO SCR-NUM-PANT.
           GO TO FIN-FND-KEY.
           MOVE ZEROES TO SCR-TOT-OCCU.
      *>>>>> INI_FND_KEY DESDE GNSSRC:PFSCONQUE
           PERFORM KEY-ALL-SCP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM MC2-FIO-SGS.
           MOVE FIO-STAT TO PGM-STAT-SGS.
      *<<<< FIN_FND_KEY
      *>>>>
       FIN-FND-KEY.                                                     
           IF FIO-STAT = FIO-STAT-NEX                                   
               MOVE 'S' TO SCR-IERR.                                    
           GO TO EXT-FND-KEY.
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
      *>>>>
*% END
*% IF PUT_SCR
      *<<<<< PUT_SCR DESDE GNSSRC:PFSCONQUE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
              GO TO EXT-PUT-SCR.
           PERFORM SCP-PUT-SCR.
       EXT-PUT-SCR.
      *>>>>> PUT_SCR DESDE GNSSRC:PFSCONQUE
*% END
*% IF FIN_PUT_SCR
      *<<<<< FIN_PUT_SCR DESDE GNSSRC:PFSCONQUE
      * AQUI MOVER LOS DATOS DE TS-SCP A PANTALLA
           MOVE SCR-TOT-OCCU TO SCP-MAS-NUM-TOCC.
           MOVE WSS-IND-HMAS TO SCP-MAS-IND-HMAS.
           IF WSS-FRM-FFLD = FRM-FFLD-RET
                 MOVE ZEROES TO QUE-NITM
           ELSE
           IF WSS-FRM-FFLD = FRM-FFLD-PF6
                 COMPUTE QUE-NITM = (SCR-NUM-PANT * WSS-MAX-PANT)
                 IF QUE-NITM NOT < SCR-TOT-OCCU
                     MOVE 'S' TO WSS-HAY-ERRO
                     MOVE 'TAB' TO MSG-COD-SIST
                     MOVE 'SCPPF6   NEX' TO MSG-COD-MENS
                     PERFORM GET-MSG
                     MOVE MSG-GLS-DESC TO FRM-MENS
                     COMPUTE QUE-NITM =
                       (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT
                 ELSE
                     ADD 1 TO SCR-NUM-PANT
           ELSE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5
                 COMPUTE QUE-NITM =
                    (SCR-NUM-PANT * WSS-MAX-PANT) -
                    (2 * WSS-MAX-PANT - 1)
                 IF QUE-NITM < 1
                    MOVE 'S' TO WSS-HAY-ERRO
                    MOVE 'TAB' TO MSG-COD-SIST
                    MOVE 'SCPPF5   NEX' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    COMPUTE QUE-NITM =
                     (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT
                 ELSE
                    SUBTRACT 1 FROM QUE-NITM
                    SUBTRACT 1 FROM SCR-NUM-PANT.
           MOVE SCP-NOM-TSSCP TO QUE-COLA.
           MOVE SCP-LEN-TSSCP TO QUE-LITM.
       SCP-CIC-LEE-TS.
           ADD 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO SCP-ITEM
               PERFORM SCP-MOV-TS-FRM
               GO TO SCP-CIC-LEE-TS
           ELSE
      *PVG INI 15-MAY-2012
           IF NOT SCR-OFRM-SRV
      *PVG FIN 15-MAY-2012
           IF QUE-NITM = 1
               MOVE SCR-STAT-CON TO SCR-STAT
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'SCP    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>> FIN_PUT_SCR DESDE GNSSRC:PFSCONQUE
*% END
*% IF FIN_PRO_CONF
      *<<<<< FIN_PRO_CONF DESDE GNSSRC:PFSCONQUE
           PERFORM SCP-PROC-ITEM.
           IF WSS-FRM-FFLD = FRM-FFLD-RET
              MOVE ZEROES TO QUE-NITM
           ELSE
           IF WSS-FRM-FFLD = FRM-FFLD-PF6
              COMPUTE QUE-NITM = (SCR-NUM-PANT * WSS-MAX-PANT)
              IF QUE-NITM NOT < SCR-TOT-OCCU
                 MOVE 'S' TO WSS-HAY-ERRO
                 MOVE 'TAB' TO MSG-COD-SIST
                 MOVE 'SCPPF6   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 COMPUTE QUE-NITM =
                   (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT
              ELSE
                 ADD 1 TO SCR-NUM-PANT
           ELSE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5
              COMPUTE QUE-NITM = (SCR-NUM-PANT * WSS-MAX-PANT) -
                      (2 * WSS-MAX-PANT - 1)
              IF QUE-NITM < 1
                 MOVE 'S' TO WSS-HAY-ERRO
                 MOVE 'TAB' TO MSG-COD-SIST
                 MOVE 'SCPPF5   NEX' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 COMPUTE QUE-NITM =
                   (SCR-NUM-PANT * WSS-MAX-PANT) - WSS-MAX-PANT
              ELSE
                 SUBTRACT 1 FROM QUE-NITM
                 SUBTRACT 1 FROM SCR-NUM-PANT.
           MOVE SCP-NOM-TSSCP TO QUE-COLA.
           MOVE SCP-LEN-TSSCP TO QUE-LITM.
       SCP-CIC-LEE-TS.
           ADD 1 TO QUE-NITM.
           MOVE QUE-NITM TO WSS-ISCP-AUX.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO SCP-ITEM
               PERFORM SCP-MOV-TS-FRM
               GO TO SCP-CIC-LEE-TS.
      *>>>>> FIN_PRO_CONF DESDE GNSSRC:PFSCONQUE
      *<<<< 
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR                            
              WSS-FRM-FFLD = FRM-FFLD-PF6                               
               GO TO CNT-PRO-CONF.                                      
                                                                        
           PERFORM VRF-TIP-SEG.                                         
           IF WSS-IND-DUPL = 'S'                                        
               PERFORM SCR-MSSG                                         
               PERFORM EDT-KEY-SCP                                      
               PERFORM EDT-FLD-SCP                                      
               PERFORM SCR-PUTA                                         
               PERFORM SCR-EXIT.                                        
                                                                        
       CNT-PRO-CONF.                                                    
      *>>>>
*% END
*% IF INI_SCR_GFLD
      *<<<<< INI_SCR_GFLD DESDE GNSSRC:PFSCONQUE
           IF FRM-FFLD = FRM-FFLD-PF5
              OR FRM-FFLD = FRM-FFLD-PF6
                MOVE FRM-FFLD-RET TO FRM-FFLD.
      *>>>>> INI_SCR_GFLD DESDE GNSSRC:PFSCONQUE
*% END
*% IF INI_SCR_PUTA AND PGM_PU
      *<<<<< INI_SCR_PUTA DESDE GNSSRC:PFSCONQUE
           IF (WSS-FRM-FFLD = FRM-FFLD-PF5 OR
               WSS-FRM-FFLD = FRM-FFLD-PF6) AND
               WSS-HAY-ERRO = 'N' AND
               FRM-SUAR NOT = FRM-SUAR-MAL
               MOVE SPACES TO SCP-GLS-MENS IN SCP-FLD.
      *>>>>> INI_SCR_PUTA DESDE GNSSRC:PFSCONQUE
*% END
*% IF INI_SCR_EXIT AND PGM_PU
      *<<<<< INI_SCR_EXIT DESDE GNSSRC:PFSCONQUE
           IF WSS-FRM-FFLD = FRM-FFLD-PF5 OR
              WSS-FRM-FFLD = FRM-FFLD-PF6
               MOVE SCR-INST-GFL TO SCR-INST.
      *>>>>> INI_SCR_EXIT DESDE GNSSRC:PFSCONQUE
*% END
*% IF EOF
      *<<<< EOF
*% IF NOT PGM_MCP AND NOT PGM_PTC
       COPY GNSBGQUE.
*% END
      *>>>>
      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       ING-FPEN-CIC SECTION.
       INI-ING-FPEN-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO SCP-GLS-MENS.
           PERFORM HBL-IKY.
      *PTC ini
           IF SCR-OFRM-SRV
               EXEC CICS                                                
                  RETURN                                                
               END-EXEC.                                                
      *PTC fin
       FIN-ING-FPEN-CIC.
           EXIT.

       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-MENS-EXT TO SCP-GLS-MENS.
           PERFORM HBL-IKY.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.

           MOVE WSS-NTRV(SCR-IPRO) TO SCR-NTRV.
           MOVE WSS-PROV(SCR-IPRO) TO SCR-PROV.
       FIN-ING-SETE.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-IOPC TO SCR-IPRO.
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE 'ING' TO SCR-CMND.
           MOVE 'ING' TO SCR-CCPP.
           MOVE 'M'   TO SCR-STPP.

           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      *PTC ini
           IF SCR-OFRM-SRV
                MOVE WSS-IDX-ISCP TO SCR-IPRO
           ELSE
                PERFORM GNS-PRO-SYS.
      *PTC fin
       FIN-EGR-FTER-CIC.
           EXIT.
*% IF PGM_PQ
       EGR-FPEN-CIC SECTION.                                            
       INI-EGR-FPEN-CIC.                                                
           PERFORM CRG-TBL-ENG.                                         
           ADD 1 TO SCR-IPRO.                                           
           IF SCR-IPRO > WSS-TOT-IIDX                                   
                  PERFORM EGR-FTER-CIC                                  
                  GO TO FIN-EGR-FPEN-CIC.                               
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES             
               GO TO INI-EGR-FPEN-CIC.                                  
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.                      
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.                         
           MOVE SCR-VARI TO SYS-CMMA.                                   
           MOVE SCR-TCMA TO SYS-TCMA.                                   
           MOVE SYS-XCTL TO SYS-CMND.                                   
      *PTC ini                                                          
           IF SCR-OFRM-SRV                                              
                MOVE WSS-IDX-ISCP TO SCR-IPRO                           
           ELSE                                                         
                PERFORM GNS-PRO-SYS.                                    
      *PTC fin                                                          
       FIN-EGR-FPEN-CIC.                                                
           EXIT.                                                        
*% END
       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE SCP-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
       COPY COLBGMPT.
       PUT-TAB SECTION.                                                 
       INI-PUT-TAB.                                                   
       EXT-PUT-TAB.                                                     
           EXIT.                                                        
                                                                        
       SET-FRM-IFLD SECTION.                                            
       INI-SET-FRM-IFLD.                                                
           IF SCR-OFRM-SRV                                              
                MOVE 1 TO FRM-IFLD                                      
           ELSE                                                         
                ADD 1 TO FRM-IFLD.                                      
       FIN-SET-FRM-IFLD.                                                
           EXIT.                                                        
      * COPY LDCBKCCU.                                                  
       COPY GNSBBTAB.                                                   
      *>>>> EOF                                                         
      * DEL-QUE-SCP SECTION.
      * INI-DEL-QUE-SCP.
      *     MOVE SCP-NOM-TSSCP TO QUE-COLA.
      *     MOVE QUE-DEL TO QUE-CMND.
      *     PERFORM GNS-PRO-QUE.
      * FIN-DEL-QUE-SCP.
      *     EXIT.
       SCP-PUT-SCR SECTION.
       INI-SCP-PUT-SCR.
       FIN-SCP-PUT-SCR.
           EXIT.
       SCP-MOD-TS SECTION.
       INI-SCP-MOD-TS.
           MOVE SCP-NOM-TSSCP  TO QUE-COLA.
           MOVE SCP-LEN-TSSCP  TO QUE-LITM.
           MOVE QUE-GET        TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               MOVE QUE-ITEM TO SCP-ITEM
               MOVE     FRM-IND-SELC IN SCP-FLD(WSS-ISCP) TO
                    SCP-FRM-IND-SELC
               MOVE     FRM-GLS-SELC IN SCP-FLD(WSS-ISCP) TO
                    SCP-FRM-GLS-SELC
      *PVG INI 09-JUN-2010                                              
               MOVE     FRM-VAL-MNTO IN SCP-FLD(WSS-ISCP) TO            
                    SCP-FRM-VAL-MNTO                                    
               MOVE     FRM-COD-VCOC IN SCP-FLD(WSS-ISCP) TO            
                    SCP-FRM-COD-VCOC                                    
      *PVG FIN 09-JUN-2010
               MOVE SCP-ITEM TO QUE-ITEM
               MOVE QUE-MOD TO QUE-CMND
               PERFORM GNS-PRO-QUE
               MOVE QUE-NITM TO WSS-ISCP-AUX
               ADD 1 TO QUE-NITM
           ELSE
               ADD 1 TO WSS-MAX-PANT GIVING WSS-ISCP.
       FIN-SCP-MOD-TS.
           EXIT.
       SCP-PROC-ITEM SECTION.
       INI-SCP-PROC-ITEM.
           COMPUTE QUE-NITM = ( SCR-NUM-PANT - 1 ) * WSS-MAX-PANT + 1.

           MOVE QUE-NITM TO WSS-ISCP.
           PERFORM SCP-MOD-TS VARYING WSS-ISCP FROM 1 BY 1
               UNTIL WSS-ISCP > WSS-MAX-PANT.
       FIN-SCP-PROC-ITEM.
           EXIT.

*% IF PGM_PQ
       SCP-ANL-KEY SECTION.
       INI-SCP-ANL-KEY.
      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
           MOVE OPC-CAI-IOPC IN SCP-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO OPC-IIC-IOPC IN OPC.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM COL-FIO-OPC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'COL'        TO MSG-COD-SIST                        
               MOVE 'OPC    NEX' TO MSG-COD-MENS                        
               GO TO MSG-SCP-ANL-KEY.                                   
                                                                        
           IF OPC-MSC-STAT IN OPC = 'A'                                 
               MOVE 'COL'          TO MSG-COD-SIST                      
               MOVE 'OPC    ACAYA' TO MSG-COD-MENS                      
               GO TO MSG-SCP-ANL-KEY.                                   
                                                                        
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS' AND                       
              OPC-COD-SEGD IN OPC NOT = 'PRECIO   '                     
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'OPCPRECIONEX' TO MSG-COD-MENS                      
               GO TO MSG-SCP-ANL-KEY.                                   
      *PVG FIN 22-MAR-2010
      *PVG INI 22-MAY-2012
           IF FRM-COD-CPTO IN SCP-FLD = 'INT' AND
              OPC-IND-RENO IN OPC = 'PRO'
              PERFORM PRO-SCP-PKTT
              IF RCC-COD-MENS > SPACES
                 MOVE 'MC2'        TO MSG-COD-SIST
                 MOVE RCC-COD-MENS TO MSG-COD-MENS
                 GO TO MSG-SCP-ANL-KEY
              ELSE
                 IF WSS-IND-PKTT IN WSS-VARI = 'S'
                    GO TO KTT-SCP-ANL-KEY.
      *PVG FIN 22-MAY-2012
           MOVE OPC-CAI-IOPC IN SCP-FLD TO UVD-CAI-IOPC IN UVD.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO UVD-IIC-IOPC IN UVD.
      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
      *    PERFORM BUS-UVD.                                             
      *    IF MSG-COD-MENS > SPACES                                     
      *        MOVE 'COL' TO MSG-COD-SIST                               
      *        GO TO MSG-SCP-ANL-KEY.                                   
           IF OPC-IND-VSTR IN OPC = 'N'
              PERFORM LEE-VEN-FMMV
           ELSE
              PERFORM BUS-UVD.
           IF MSG-COD-MENS IN MSG > SPACES
              MOVE 'COL' TO MSG-COD-SIST
              GO TO MSG-SCP-ANL-KEY.
      *PVG FIN 22-MAR-2010
      *PVG INI 25-AGO-2006                                              
           PERFORM BUS-HABIL.                                           
      *PVG FIN 25-AGO-2006                                              
           MOVE OPC-NUM-DCOL IN OPC    TO FEC-DEC1.
           MOVE OPC-NUM-MCOL IN OPC    TO FEC-MEC1.
           MOVE OPC-NUM-SCOL IN OPC    TO FEC-SEC1.
           MOVE OPC-NUM-ACOL IN OPC    TO FEC-AEC1.
           MOVE DLC-NUM-DVEN IN UVD(1) TO FEC-DEC2.
           MOVE DLC-NUM-MVEN IN UVD(1) TO FEC-MEC2.
           MOVE DLC-NUM-SVEN IN UVD(1) TO FEC-SEC2.
           MOVE DLC-NUM-AVEN IN UVD(1) TO FEC-AEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-DIF-DIA  TO FEC-CMND.
           PERFORM CAL-FEC.
           IF NOT FEC-STAT-OKS
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'DIFDIA NOVLD' TO MSG-COD-MENS                      
               GO TO MSG-SCP-ANL-KEY.                                   
           MOVE FEC-NDIA TO WSS-NUM-NDIA IN WSS-VARI.                   

           MOVE OPC-CAI-IOPC IN SCP-FLD TO AUT-CAI-IOPC IN AUT.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO AUT-IIC-IOPC IN AUT.
           MOVE 'AUT'                   TO AUT-NUM-ICAN IN AUT.         
           MOVE 1                       TO AUT-NUM-ICYA IN AUT.         
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-AUT.
           IF FIO-STAT-OKS
               MOVE 'AUT' TO WSS-COD-TCAR IN WSS-VARI
           ELSE
               MOVE 'PAT' TO AUT-NUM-ICAN IN AUT                        
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-AUT
               IF FIO-STAT-OKS
                  MOVE 'PAT' TO WSS-COD-TCAR IN WSS-VARI
               ELSE
                  MOVE SPACES TO WSS-COD-TCAR IN WSS-VARI.

      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
      *    MOVE OPC-CAI-IOPC IN SCP-FLD TO OPC-CAI-IOPC IN OPC.         
      *    MOVE OPC-IIC-IOPC IN SCP-FLD TO OPC-IIC-IOPC IN OPC.         
      *    MOVE FIO-GET-KEY TO FIO-CMND.                                
      *    PERFORM COL-FIO-OPC.                                         
      *    IF NOT FIO-STAT-OKS                                          
      *        MOVE 'COL'        TO MSG-COD-SIST                        
      *        MOVE 'OPC    NEX' TO MSG-COD-MENS                        
      *        GO TO MSG-SCP-ANL-KEY.                                   
      *                                                                 
      *    IF OPC-MSC-STAT IN OPC = 'A'                                 
      *        MOVE 'COL'          TO MSG-COD-SIST                      
      *        MOVE 'OPC    ACAYA' TO MSG-COD-MENS                      
      *        GO TO MSG-SCP-ANL-KEY.                                   
      *                                                                 
      *    IF FRM-COD-CPTO IN SCP-FLD = 'SGS' AND                       
      *       OPC-COD-SEGD IN OPC NOT = 'PRECIO   '                     
      *        MOVE 'TAB'          TO MSG-COD-SIST                      
      *        MOVE 'OPCPRECIONEX' TO MSG-COD-MENS                      
      *        GO TO MSG-SCP-ANL-KEY.                                   
      *PVG FIN 22-MAR-2010
      *PVG INI 09-JUN-2010                                              
           IF SCR-CIC-DIND IN SCR-VARI > SPACES                         
              MOVE FRM-NUM-ICLI IN SCP-FLD  TO DBC-NUM-ICLI IN DBC      
              MOVE FRM-VRF-ICLI IN SCP-FLD  TO DBC-VRF-ICLI IN DBC      
              MOVE FRM-IND-ICLI IN SCP-FLD  TO DBC-IND-ICLI IN DBC      
              MOVE FRM-GLS-ICLI IN SCP-FLD  TO DBC-GLS-ICLI IN DBC      
              GO TO CNT-SCP-ANL-KEY.                                    
      *PVG FIN 09-JUN-2010

           MOVE OPC-CAI-IOPC IN OPC TO RDC-CAI-IOPC IN RDC.
           MOVE OPC-IIC-IOPC IN OPC TO RDC-IIC-IOPC IN RDC.
           MOVE ZEROES              TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT (FIO-STAT-OKS AND
              RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN OPC AND
              RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN OPC)
               MOVE 'COL'        TO MSG-COD-SIST
               MOVE 'RDC    NEX' TO MSG-COD-MENS
               GO TO MSG-SCP-ANL-KEY.

           MOVE RDC-CAI-ICLI IN RDC TO DBC-CAI-ICLI IN DBC.
           MOVE RDC-IIC-ICLI IN RDC TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'DBC    NEX' TO MSG-COD-MENS
               GO TO MSG-SCP-ANL-KEY.
      *PVC-INI 20-MAY-2009                                              
       CNT-SCP-ANL-KEY.
      *PVC-FIN 20-MAY-2009                                              
      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
      *       PERFORM OBT-FEC-PVTO.
           IF OPC-IND-VSTR IN OPC = 'S'
              PERFORM OBT-FEC-PVTO
      *PVG FIN 22-MAR-2010
              IF MSG-COD-MENS > SPACES                                     
                 MOVE 'COL' TO MSG-COD-SIST                               
                 GO TO MSG-SCP-ANL-KEY.                                   
                                                                        
           MOVE OPC-CAI-IOPC IN SCP-FLD  TO RCC-CAI-IOPE IN RCC-VARI.
           MOVE OPC-IIC-IOPC IN SCP-FLD  TO RCC-IIC-IOPE IN RCC-VARI.
           MOVE SPACES                   TO RCC-EXT-IOPE IN RCC-VARI.
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'                           
              MOVE OPC-COD-RMOC IN OPC   TO RCC-CIC-IOPE IN RCC-VARI    
              MOVE 'EJC '                TO RCC-EXT-IOPE IN RCC-VARI.   
           MOVE DBC-NUM-ICLI IN DBC      TO RCC-NUM-ICLI IN RCC-VARI.
           MOVE DBC-VRF-ICLI IN DBC      TO RCC-VRF-ICLI IN RCC-VARI.
           MOVE DBC-IND-ICLI IN DBC      TO RCC-IND-ICLI IN RCC-VARI.
           MOVE DBC-GLS-ICLI IN DBC      TO RCC-GLS-ICLI IN RCC-VARI.
           MOVE FRM-COD-CLAS IN SCP-FLD  TO RCC-IND-RTBL IN RCC-VARI.
           MOVE FRM-COD-COMP IN SCP-FLD  TO RCC-IND-COMP IN RCC-VARI.
      *PVC-INI 20-MAY-2009                                              
           IF OPC-COD-OTRN IN OPC = SPACES
               MOVE '010'                TO RCC-COD-TCNL IN RCC-VARI
               MOVE OPC-COD-OFOC IN OPC  TO RCC-COD-CNAL IN RCC-VARI
           ELSE
               MOVE 'TAB'                TO TAB-COD-SIST FIO-SIST 
               MOVE 'CNL'                TO TAB-COD-TTAB IN TAB
               MOVE OPC-COD-OTRN IN OPC  TO TAB-COD-CTAB IN TAB
      *        PERFORM VAL-TAB
               MOVE FIO-GET-KEY TO FIO-CMND                                    
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB NOT = 'N'
                   IF OPC-COD-OTRN IN OPC = '010' 
                       MOVE '010'        TO RCC-COD-TCNL IN RCC-VARI
                       MOVE OPC-COD-OFOC IN OPC TO
                                            RCC-COD-CNAL IN RCC-VARI
                   ELSE
                       MOVE OPC-COD-OTRN IN OPC TO
                                            RCC-COD-TCNL IN RCC-VARI            
                       MOVE SPACES       TO RCC-COD-CNAL IN RCC-VARI            
               ELSE                                                             
                   MOVE '010'            TO RCC-COD-TCNL IN RCC-VARI            
                   MOVE OPC-COD-OFOC IN OPC TO
                                            RCC-COD-CNAL IN RCC-VARI.        
      *PVC-FIN 20-MAY-2009                                              
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCOC IN RCC-VARI.
           MOVE OPC-COD-TOOC IN OPC      TO RCC-COD-TOOC IN RCC-VARI.
           MOVE OPC-COD-AOOC IN OPC      TO RCC-COD-AOOC IN RCC-VARI.
           MOVE OPC-VAL-CRED IN OPC      TO RCC-VAL-MOPE IN RCC-VARI.
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCMO IN RCC-VARI.
           MOVE OPC-FEC-FCOL IN OPC      TO RCC-FEC-FCOL IN RCC-VARI.   
           MOVE WSS-FEC-FPVT IN WSS-VARI TO RCC-FEC-FVEN IN RCC-VARI.   
           MOVE WSS-NUM-NDIA             TO RCC-NUM-PLZO IN RCC-VARI.   
           MOVE 'D'                      TO RCC-MSC-UTPZ IN RCC-VARI.   
           MOVE 'CUR'                    TO RCC-COD-EVEN IN RCC-VARI.   
           MOVE FRM-COD-CPTO IN SCP-FLD  TO RCC-COD-CPTO IN RCC-VARI.   
           MOVE WSS-COD-TCAR             TO RCC-COD-TCAR IN RCC-VARI.
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'                           
               MOVE ZEROES               TO RCC-VAL-SOPE IN RCC-VARI    
               MOVE SPACES               TO RCC-COD-VSOP IN RCC-VARI    
           ELSE                                                         
               MOVE OPC-VAL-CRED IN OPC  TO RCC-VAL-SOPE IN RCC-VARI    
               MOVE OPC-COD-VCOC IN OPC  TO RCC-COD-VSOP IN RCC-VARI.   
           MOVE ZEROES                   TO RCC-VAL-FINA IN RCC-VARI.   
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCFN IN RCC-VARI.   
           MOVE ZEROES                   TO RCC-VAL-INTE IN RCC-VARI.   
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCIN IN RCC-VARI.   
           MOVE ZEROES                   TO RCC-VAL-VASG IN RCC-VARI.   
           MOVE OPC-COD-VCOC IN OPC      TO RCC-COD-VCVA IN RCC-VARI.   

      *PVG INI 09-JUN-2010                                              
           IF RCC-COD-CPTO IN RCC-VARI = 'SGS'                          
              DIVIDE 1 BY 2 GIVING RCC-VAL-INTE IN RCC-VARI             
              IF SCR-CIC-DIND IN SCR-VARI NOT > SPACES                  
                 PERFORM BUS-RDC-DIND.                                  
      *PVG FIN 09-JUN-2010
      *PVG INI 15-MAY-2012
           MOVE RCC-COD-TCNL IN RCC-VARI TO SCR-COD-TCNL.
           MOVE RCC-COD-CNAL IN RCC-VARI TO SCR-COD-CNAL.
      *PVG FIN 15-MAY-2012
                                                                        
           PERFORM MC2-LNK-RCC.
           IF RCC-COD-MENS > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE RCC-COD-MENS TO MSG-COD-MENS
               GO TO MSG-SCP-ANL-KEY.

           PERFORM LEE-QUE-RCC.

      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'
              PERFORM PRO-INT-INFO.
      *PVG FIN 21-OCT-2013

      *PVG INI 22-MAY-2012
       KTT-SCP-ANL-KEY.
      *PVG FIN 22-MAY-2012
           MOVE 1 TO WSS-S.
       LUP-SCP-ANL-KEY.
           IF QSP-VAL-MNTO(WSS-S) = ZEROES                              
      *PVG INI 09-JUN-2010
              AND QSP-COD-SEGU(WSS-S) NOT = 'INF'                       
      *PVG FIN 09-JUN-2010
               GO TO FIN-SCP-ANL-KEY.

           PERFORM SET-FRM-IFLD.
           PERFORM PUT-TS-SCP.
           
           ADD 1 TO WSS-S.
           GO TO LUP-SCP-ANL-KEY.

       MSG-SCP-ANL-KEY.
      *PVG INI 15-MAY-2012
           MOVE 'TAB' TO MSG-COD-SIST.
      *PVG FIN 15-MAY-2012
           PERFORM GET-MSG.
           IF RCC-COD-MEN2 > SPACES                                     
              MOVE MSG-GLS-DESC TO FRM-MEN1                             
              MOVE RCC-COD-MEN2 TO FRM-MEN2                             
           ELSE                                                         
              MOVE MSG-GLS-DESC TO FRM-MENS.
      *PVG INI 15-MAY-2012
           IF (SCR-OFRM-SRV AND
              (RCC-COD-MENS = 'CPTSEL   NEX' OR 'RCCCPT   NEX'))
              GO TO FIN-SCP-ANL-KEY.
      *PVG FIN 15-MAY-2012
           MOVE FIO-STAT-NEX TO FIO-STAT.                               
           GO TO FIN-SCP-ANL-KEY.
       FIN-SCP-ANL-KEY.
           EXIT.

       LEE-QUE-RCC SECTION.
       INI-LEE-QUE-RCC.
           MOVE ZEROES TO RCC-R IN RCC-VARI.
       LUP-LEE-QUE-RCC.
           ADD 1 TO RCC-R.
           MOVE RCC-R              TO QUE-NITM.
           MOVE RCC-NOM-TSSGS      TO QUE-COLA.
           MOVE RCC-LEN-TSSGS      TO QUE-LITM.
           MOVE QUE-GET            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF NOT (QUE-STAT = QUE-STAT-OKS)
              GO TO FIN-LEE-QUE-RCC.
           MOVE '00'     TO FIO-STAT.
           MOVE QUE-ITEM TO OSG-APL-VEC(RCC-R).
      *PVG INI 09-JUN-2010
           IF FRM-COD-CPTO IN SCP-FLD = 'CCM'
              MOVE QUE-ITEM TO RCC-CCM-VEC(RCC-R).
      *PVG FIN 09-JUN-2010
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN' OR 'CCM'
              IF NOT OSG-SGS-IND-SELE(RCC-R) = 'S'
                 GO TO LUP-LEE-QUE-RCC.
           MOVE 'S'                     TO QSP-IND-SELC(RCC-R).
      *PVG INI 09-JUN-2010
           IF FRM-COD-CPTO IN SCP-FLD = 'CCM' AND
              RCC-CCM-IND-SOBL(RCC-R) = 'N'
      *PVG INI 23-MAY-2012
              IF SCR-OFRM-SRV
                 MOVE 'S'    TO QSP-IND-SELC(RCC-R)
              ELSE
      *PVG FIN 23-MAY-2012
                 MOVE SPACES TO QSP-IND-SELC(RCC-R).
           IF FRM-COD-CPTO IN SCP-FLD = 'CCM' AND
              RCC-DCM-COD-ECCM(RCC-R) = 'INF'
              MOVE '0999  ' TO OSG-SGS-COD-MONE(RCC-R).
      *PVG FIN 09-JUN-2010
      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS'
              MOVE OSG-SGS-IND-SELE(RCC-R) TO QSP-IND-SELC(RCC-R)
              IF QSP-IND-SELC(RCC-R) = 'P'
                 MOVE 'S' TO QSP-IND-SELC(RCC-R).
      *PVG FIN 21-OCT-2013
           PERFORM MV-COD-TSEG.
           MOVE OSG-SGS-COD-OCOB(RCC-R) TO QSP-COD-OCOB(RCC-R).
           MOVE OSG-SGS-COD-SEGU(RCC-R) TO QSP-COD-SEGU(RCC-R).
           MOVE OSG-SGS-VAL-MNTO(RCC-R) TO QSP-VAL-MNTO(RCC-R).
           MOVE OSG-SGS-VAL-MONE(RCC-R) TO QSP-COD-VCOC(RCC-R).
           MOVE OSG-OCI-VAL-PPRO(RCC-R) TO QSP-VAL-PPRO(RCC-R).
           MOVE OSG-SGS-SGV-TAMO(RCC-R) TO QSP-SGV-TAMO(RCC-R).
      ***  MOVE OSG-SGS-COD-VCOC(RCC-R) TO QSP-COD-TINF(RCC-R).

      *COSTO DE FONDO           (SOLO INT)
           MOVE OSG-SGS-SGV-CSTF(RCC-R) TO QSP-SGV-CSTF(RCC-R).
      ***  MOVE OSG-SGS-IND-DCTO(RCC-R) TO QSP-IND-CSTF-U(RCC-R).
      ***  MOVE OSG-SGS-IND-CAAB(RCC-R) TO QSP-IND-CSTF-O(RCC-R).

      *TASA MAXIMA CONVENCIONAL (SOLO INT)
           MOVE OSG-SGS-SGV-TMAX(RCC-R) TO QSP-SGV-TMAX(RCC-R).
      *FACTOR DE RIESGO         (SOLO INT)
           MOVE OSG-SGS-VAL-FRIE(RCC-R) TO QSP-VAL-FRIE(RCC-R).

              IF RCC-R = 1
                MOVE OSG-SGS-CAI-IRCC(RCC-R) TO FRM-CAI-IRCC IN SCP-FLD
                MOVE OSG-SGS-IIC-IRCC(RCC-R) TO FRM-IIC-IRCC IN SCP-FLD
                MOVE OSG-SGS-NUM-IRCC(RCC-R) TO FRM-NUM-IRCC IN SCP-FLD
                MOVE OSG-SGS-CAI-PLNT(RCC-R) TO FRM-CAI-PLAN IN SCP-FLD
                MOVE OSG-SGS-IIC-PLNT(RCC-R) TO FRM-IIC-PLAN IN SCP-FLD
                MOVE OSG-SGS-IND-TPLN(RCC-R) TO FRM-IND-TPLT IN SCP-FLD
                MOVE OSG-SGS-FEC-PLNT(RCC-R) TO FRM-FEC-PLAN IN SCP-FLD 
                MOVE OSG-SGS-HRA-PLNT(RCC-R) TO FRM-HRA-PLAN IN SCP-FLD
                MOVE OSG-SGS-COD-SIST(RCC-R) TO FRM-COD-SIST IN SCP-FLD
                MOVE OSG-SGS-COD-EVEN(RCC-R) TO FRM-COD-EVEN IN SCP-FLD
                MOVE OSG-SGS-COD-MONE(RCC-R) TO FRM-COD-MONE IN SCP-FLD
                GO TO LUP-LEE-QUE-RCC
              ELSE
                GO TO LUP-LEE-QUE-RCC.

       FIN-LEE-QUE-RCC.
           EXIT.
       MV-COD-TSEG SECTION.
       INI-MV-COD-TSEG.
      *PVG INI 11-ENE-2007 INTEGRACION CGN
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN' OR 'CCM'
               MOVE OSG-SGS-COD-TSEG(RCC-R)    TO QSP-COD-TSEG(RCC-R)
               MOVE OSG-SGS-COD-MONE(RCC-R)    TO QSP-COD-MONE(RCC-R).
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS' OR 'CGN' OR 'CCM'
      *    IF FRM-COD-CPTO IN SCP-FLD = 'SGS'
      *PVG FIN 11-ENE-2007
               MOVE OSG-SGS-COD-TSEG(RCC-R) TO QSP-COD-TSEG(RCC-R)
           ELSE
               MOVE OSG-SGS-IND-TPLN(RCC-R) TO QSP-COD-TSEG(RCC-R)
               MOVE OSG-SGS-CAI-IRCC(RCC-R) TO QSP-CAI-IRCC(RCC-R)
               MOVE OSG-SGS-IIC-IRCC(RCC-R) TO QSP-IIC-IRCC(RCC-R)
               MOVE OSG-SGS-NUM-IRCC(RCC-R) TO QSP-NUM-IRCC(RCC-R)
               MOVE OSG-SGS-COD-MONE(RCC-R) TO QSP-COD-MONE(RCC-R)
               MOVE OSG-SGS-CAI-PLNT(RCC-R) TO QSP-CAI-PLAN(RCC-R)
               MOVE OSG-SGS-IIC-PLNT(RCC-R) TO QSP-IIC-PLAN(RCC-R)
               MOVE OSG-SGS-FEC-PLNT(RCC-R) TO QSP-FEC-PLAN(RCC-R)
               MOVE OSG-SGS-HRA-PLNT(RCC-R) TO QSP-HRA-PLAN(RCC-R)
               IF OSG-SGS-IND-TPLN(RCC-R) = 'P'
                  MOVE OSG-SGS-COD-TINT(RCC-R) TO QSP-COD-TINT(RCC-R)
               ELSE
                  MOVE SPACES                  TO QSP-COD-TINT(RCC-R).
      *PVG INI 11-ENE-2007 INTEGRACION CGN
           IF ((FRM-COD-CPTO IN SCP-FLD = 'CGN' OR 'CCM') AND
                OSG-SGS-IND-TPLN(RCC-R) = 'P')
                MOVE OSG-SGS-COD-TINT(RCC-R) TO QSP-COD-TINT(RCC-R).
      *PVG FIN 11-ENE-2007
       FIN-MV-COD-TSEG.
           EXIT.
       SCP-MOV-TS-FRM-ELM SECTION.
       INI-SCP-MOV-TS-FRM-ELM.
           MOVE SCP-FRM-IND-SELC TO                                     
                    FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT).              
           MOVE SCP-FRM-COD-TSEG TO                                     
                    FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT).              
           MOVE SCP-FRM-COD-OCOB TO                                     
                    FRM-COD-OCOB IN SCP-FLD(WSS-IND-PANT).              
           MOVE SCP-FRM-COD-SEGU TO                                     
                    FRM-COD-SEGU IN SCP-FLD(WSS-IND-PANT).              
           IF FRM-COD-CPTO IN SCP-FLD NOT = 'PPC'                       
           MOVE SCP-FRM-VAL-MNTO TO                                     
                   FRM-VAL-MNTO IN SCP-FLD(WSS-IND-PANT)                
           MOVE SCP-FRM-COD-VCOC TO                                     
                    FRM-COD-VCOC IN SCP-FLD(WSS-IND-PANT).              
                                                                        
           IF FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT) > SPACES            
               MOVE 'GNS' TO TAB-COD-SIST FIO-SIST                      
               MOVE 'SON' TO TAB-COD-TTAB IN TAB                        
               MOVE FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT) TO            
                      TAB-COD-CTAB IN TAB                               
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-ABRV IN TAB TO                              
                              FRM-GLS-SELC IN SCP-FLD(WSS-IND-PANT)     
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(WSS-IND-PANT).    
                                                                        
           IF FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT) NOT > SPACES        
               MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(WSS-IND-PANT)     
               GO TO FIN-SCP-MOV-TS-FRM-ELM.                            
           MOVE 'TAB' TO TAB-COD-SIST FIO-SIST.
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS'                           
              MOVE 'TAB' TO TAB-COD-SIST FIO-SIST
              MOVE 'TSE' TO TAB-COD-TTAB IN TAB.
           IF FRM-COD-CPTO IN SCP-FLD = 'INT' OR 'PPC'                  
              MOVE 'TAB' TO TAB-COD-SIST FIO-SIST
              MOVE 'TDP' TO TAB-COD-TTAB IN TAB.                        
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'                           
              MOVE 'DOC' TO TAB-COD-TTAB IN TAB.                        
           IF FRM-COD-CPTO IN SCP-FLD = 'CCM'                           
              MOVE 'CMS' TO TAB-COD-TTAB IN TAB.                        
           MOVE FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT) TO                
                TAB-COD-CTAB IN TAB.                                    
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DCOR IN TAB TO                                  
                FRM-GLS-TSEG IN SCP-FLD(WSS-IND-PANT).                  
       FIN-SCP-MOV-TS-FRM-ELM.
           EXIT.
*% END

*% IF PGM_PU
       SCP-MOV-TS-FRM-ELM SECTION.                                      
       INI-SCP-MOV-TS-FRM-ELM.                                          
      *ISP-INI                                                          
           IF WSS-IND-PANT = 1                                          
               PERFORM CLR-PANT-SCP                                     
               PERFORM HBL-FLD.                                         
      *ISP-FIN                                                          
           MOVE SCP-FRM-IND-SELC TO                                     
                    FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT).              
           MOVE SCP-FRM-COD-TSEG TO                                     
                    FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT).              
           MOVE SCP-FRM-COD-OCOB TO                                     
                    FRM-COD-OCOB IN SCP-FLD(WSS-IND-PANT).              
           MOVE SCP-FRM-COD-SEGU TO                                     
                    FRM-COD-SEGU IN SCP-FLD(WSS-IND-PANT).              
           IF FRM-COD-CPTO IN SCP-FLD NOT = 'PPC'                       
           MOVE SCP-FRM-VAL-MNTO TO                                     
                    FRM-VAL-MNTO IN SCP-FLD(WSS-IND-PANT)               
           MOVE SCP-FRM-COD-VCOC TO                                     
                    FRM-COD-VCOC IN SCP-FLD(WSS-IND-PANT).              
                                                                        
           IF FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT) > SPACES            
               MOVE 'GNS' TO TAB-COD-SIST                               
               MOVE 'SON' TO TAB-COD-TTAB IN TAB                        
               MOVE FRM-IND-SELC IN SCP-FLD(WSS-IND-PANT) TO            
                      TAB-COD-CTAB IN TAB                               
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-ABRV IN TAB TO                              
                              FRM-GLS-SELC IN SCP-FLD(WSS-IND-PANT)     
           ELSE                                                         
               MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(WSS-IND-PANT).    
                                                                        
           IF FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT) NOT > SPACES        
               MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(WSS-IND-PANT)     
               GO TO FIN-SCP-MOV-TS-FRM-ELM.                            
           MOVE 'TAB' TO TAB-COD-SIST.                                  
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS'                           
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'TSE' TO TAB-COD-TTAB IN TAB.
           IF FRM-COD-CPTO IN SCP-FLD = 'INT' OR 'PPC'                  
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'TDP' TO TAB-COD-TTAB IN TAB.                        
      *PVG INI 11-ENE-2007 INTEGRACION CGN
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'
              MOVE 'DOC' TO TAB-COD-TTAB IN TAB.
           IF FRM-COD-CPTO IN SCP-FLD = 'CCM'
              MOVE 'CMS' TO TAB-COD-TTAB IN TAB.
      *PVG FIN 11-ENE-2007
           MOVE FRM-COD-TSEG IN SCP-FLD(WSS-IND-PANT) TO                
                TAB-COD-CTAB IN TAB.                                    
           PERFORM BUS-TAB.                                             
           MOVE TAB-GLS-DCOR IN TAB TO                                  
                FRM-GLS-TSEG IN SCP-FLD(WSS-IND-PANT).                  
       FIN-SCP-MOV-TS-FRM-ELM.                                          
           EXIT.                                                        
                                                                        
       PUT-TS-SCP SECTION.                                              
       INI-PUT-TS-SCP.                                                  
           MOVE SPACES TO SCP-ITEM.                                     
           MOVE ZEROES TO SCP-FRM-VAL-MNTO.                             
           IF SCR-OFRM-SRV                                              
               MOVE QSP-VAL-MNTO(WSS-S) TO FRM-VAL-MNTO-EDT             
               MOVE FRM-VAL-MNTO-EDT TO SCP-FRM-VAL-MNTO-ALF            
           ELSE                                                         
               MOVE QSP-VAL-MNTO(WSS-S) TO SCP-FRM-VAL-MNTO.            
                                                                        
           MOVE 'S'                 TO SCP-FRM-IND-SELC.                

           IF FRM-COD-CPTO IN SCP-FLD = 'CCM'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC
              IF SCP-FRM-IND-SELC = 'N'
                 MOVE SPACES TO SCP-FRM-IND-SELC.

      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC.
      *PVG FIN 21-OCT-2013
      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC.
      *PVG FIN 21-OCT-2013

           MOVE QSP-COD-TSEG(WSS-S) TO SCP-FRM-COD-TSEG.                
           MOVE QSP-COD-OCOB(WSS-S) TO SCP-FRM-COD-OCOB.                
           MOVE QSP-COD-SEGU(WSS-S) TO SCP-FRM-COD-SEGU.                
           MOVE QSP-COD-VCOC(WSS-S) TO SCP-FRM-COD-VCOC.                
           IF SCP-FRM-IND-SELC > SPACES                                 
               MOVE 'GNS' TO TAB-COD-SIST                               
               MOVE 'SON' TO TAB-COD-TTAB IN TAB                        
               MOVE SCP-FRM-IND-SELC TO TAB-COD-CTAB IN TAB             
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-ABRV IN TAB TO SCP-FRM-GLS-SELC             
           ELSE                                                         
               MOVE SPACES TO SCP-FRM-GLS-SELC.                         
                                                                        
           MOVE SCP-NOM-TSSCP  TO QUE-COLA.                             
           MOVE SCP-LEN-TSSCP  TO QUE-LITM.                             
           MOVE SCP-ITEM       TO QUE-ITEM.                             
           MOVE QUE-PUT        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
           ADD 1 TO SCR-TOT-OCCU.                                       
       FIN-PUT-TS-SCP.                                                  
           EXIT.                                                        
*% END
*% IF PGM_PQ
       PUT-TS-SCP SECTION.                                              
       INI-PUT-TS-SCP.                                                  
           MOVE SPACES TO SCP-ITEM.                                     
           MOVE ZEROES TO SCP-FRM-VAL-MNTO.                             
           MOVE QSP-VAL-MNTO(WSS-S) TO SCP-FRM-VAL-MNTO.
                                                                        
           MOVE 'S'                 TO SCP-FRM-IND-SELC.                

           IF FRM-COD-CPTO IN SCP-FLD = 'CCM'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC
              IF SCP-FRM-IND-SELC = 'N'
                 MOVE SPACES TO SCP-FRM-IND-SELC.

      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'SGS'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC.
      *PVG FIN 21-OCT-2013
      *PVG INI 21-OCT-2013
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'
              MOVE QSP-IND-SELC(WSS-S) TO SCP-FRM-IND-SELC.
      *PVG FIN 21-OCT-2013

           MOVE QSP-COD-TSEG(WSS-S) TO SCP-FRM-COD-TSEG.                
           MOVE QSP-COD-OCOB(WSS-S) TO SCP-FRM-COD-OCOB.                
           MOVE QSP-COD-SEGU(WSS-S) TO SCP-FRM-COD-SEGU.                
           MOVE QSP-COD-VCOC(WSS-S) TO SCP-FRM-COD-VCOC.                
           MOVE QSP-CIC-IRCC(WSS-S) TO SCP-FRM-CIC-IRCC.                
           MOVE QSP-NUM-IRCC(WSS-S) TO SCP-FRM-NUM-IRCC.                
           MOVE QSP-COD-MONE(WSS-S) TO SCP-FRM-COD-MONE.                
           MOVE QSP-CIC-PLAN(WSS-S) TO SCP-FRM-CIC-PLAN.                
           MOVE QSP-FEC-PLAN(WSS-S) TO SCP-FRM-FEC-PLAN.                
           MOVE QSP-HRA-PLAN(WSS-S) TO SCP-FRM-HRA-PLAN.                
           MOVE QSP-COD-TINT(WSS-S) TO SCP-FRM-COD-TINT.                
                                                                        
           MOVE QSP-VAL-PPRO(WSS-S) TO SCP-QSP-VAL-PPRO.                
                                                                        
           MOVE QSP-SGV-TAMO(WSS-S) TO SCP-QSP-SGV-TAMO.                
      ***  MOVE QSP-COD-TINF(WSS-S) TO SCP-QSP-COD-TINF.

           MOVE QSP-SGV-CSTF(WSS-S) TO SCP-QSP-SGV-CSTF.                
      ***  MOVE QSP-IND-CSTF-U(WSS-S) TO SCP-QSP-IND-CSTF-U.
      ***  MOVE QSP-IND-CSTF-O(WSS-S) TO SCP-QSP-IND-CSTF-O.

           MOVE QSP-SGV-TMAX(WSS-S) TO SCP-QSP-SGV-TMAX.                
           MOVE QSP-VAL-FRIE(WSS-S) TO SCP-QSP-VAL-FRIE.                
           IF SCP-FRM-IND-SELC > SPACES                                 
               MOVE 'GNS' TO TAB-COD-SIST FIO-SIST                      
               MOVE 'SON' TO TAB-COD-TTAB IN TAB                        
               MOVE SCP-FRM-IND-SELC TO TAB-COD-CTAB IN TAB             
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-ABRV IN TAB TO SCP-FRM-GLS-SELC             
           ELSE                                                         
               MOVE SPACES TO SCP-FRM-GLS-SELC.                         
                                                                        
           MOVE SCP-NOM-TSSCP  TO QUE-COLA.                             
           MOVE SCP-LEN-TSSCP  TO QUE-LITM.                             
           MOVE SCP-ITEM       TO QUE-ITEM.                             
           MOVE QUE-PUT        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
           ADD 1 TO SCR-TOT-OCCU.                                       
       FIN-PUT-TS-SCP.                                                  
           EXIT.                                                        
*% END

       CLR-PANT-SCP SECTION.
       INI-CLR-PANT-SCP.
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(1).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(2).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(3).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(4).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(5).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(6).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(7).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(8).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(9).
           MOVE SPACES TO FRM-IND-SELC IN SCP-FLD(10).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(1).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(2).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(3).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(4).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(5).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(6).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(7).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(8).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(9).
           MOVE SPACES TO FRM-GLS-SELC IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-TSEG IN SCP-FLD(10).
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(1).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(2).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(3).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(4).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(5).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(6).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(7).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(8).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(9).                   
           MOVE SPACES TO FRM-GLS-TSEG IN SCP-FLD(10).                  
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-OCOB IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-SEGU IN SCP-FLD(10).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(1).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(2).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(3).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(4).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(5).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(6).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(7).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(8).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(9).
           MOVE ZEROES TO FRM-VAL-MNTO IN SCP-FLD(10).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(1).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(2).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(3).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(4).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(5).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(6).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(7).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(8).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(9).
           MOVE SPACES TO FRM-COD-VCOC IN SCP-FLD(10).
       FIN-CLR-PANT-SCP.
           EXIT.
*% IF PGM_PU
       PRO-ING-ROC SECTION.                                             
       INI-PRO-ING-ROC.                                                 
           MOVE SPACES TO MSG-COD-MENS.                                 
           PERFORM LEE-QUE-SCP.                                         
           MOVE 1 TO WSS-I.                                             
       LUP-PRO-ING-ROC.                                                 
           IF WSS-I > WSS-IMAX
               GO TO FIN-PRO-ING-ROC.                                   
           IF QSP-IND-SELC(WSS-I) = 'S'                                 
      *PVG INI 21-OCT-2013
              OR
              (FRM-COD-CPTO IN SCP-FLD = 'INT' AND
               QSP-IND-SELC(WSS-I) = 'N')
      *PVG FIN 21-OCT-2013
               PERFORM GRA-ROC                                          
               IF MSG-COD-MENS > SPACES                                 
                  GO TO FIN-PRO-ING-ROC.                                
           ADD 1 TO WSS-I.                                              
           GO TO LUP-PRO-ING-ROC.                                       
       FIN-PRO-ING-ROC.                                                 
           EXIT.                                                        
                                                                        
       LEE-QUE-SCP SECTION.                                             
       INI-LEE-QUE-SCP.                                                 
           MOVE ZEROES TO WSS-R IN WSS-VARI.                            
       LUP-LEE-QUE-SCP.                                                 
           ADD 1 TO WSS-R.                                              
           MOVE WSS-R              TO QUE-NITM.                         
           MOVE SCP-NOM-TSSCP      TO QUE-COLA.                         
           MOVE SCP-LEN-TSSCP      TO QUE-LITM.                         
           MOVE QUE-GET            TO QUE-CMND.                         
           PERFORM GNS-PRO-QUE.                                         
           IF QUE-STAT = QUE-STAT-OKS                                   
              MOVE '00' TO FIO-STAT                                     
              MOVE QUE-ITEM         TO SCP-ITEM
              MOVE SCP-FRM-IND-SELC TO QSP-IND-SELC(WSS-R)              
              MOVE SCP-FRM-COD-TSEG TO QSP-COD-TSEG(WSS-R)              
              MOVE SCP-FRM-COD-OCOB TO QSP-COD-OCOB(WSS-R)              
              MOVE SCP-FRM-COD-SEGU TO QSP-COD-SEGU(WSS-R)              
              MOVE SCP-FRM-VAL-MNTO TO QSP-VAL-MNTO(WSS-R)              
              MOVE SCP-FRM-COD-VCOC TO QSP-COD-VCOC(WSS-R)              
              MOVE SCP-FRM-CIC-IRCC TO QSP-CIC-IRCC(WSS-R)              
              MOVE SCP-FRM-NUM-IRCC TO QSP-NUM-IRCC(WSS-R)              
              MOVE SCP-FRM-COD-MONE TO QSP-COD-MONE(WSS-R)              
              MOVE SCP-FRM-CIC-PLAN TO QSP-CIC-PLAN(WSS-R)              
              MOVE SCP-FRM-FEC-PLAN TO QSP-FEC-PLAN(WSS-R)              
              MOVE SCP-FRM-HRA-PLAN TO QSP-HRA-PLAN(WSS-R)              
              MOVE SCP-FRM-COD-TINT TO QSP-COD-TINT(WSS-R)              
              MOVE SCP-QSP-VAL-PPRO TO QSP-VAL-PPRO(WSS-R)              
                                                                        
              MOVE SCP-QSP-SGV-TAMO TO QSP-SGV-TAMO(WSS-R)
      ***     MOVE SCP-QSP-COD-TINF TO QSP-COD-TINF(WSS-R)

              MOVE SCP-QSP-SGV-CSTF TO QSP-SGV-CSTF(WSS-R)              

      ***     MOVE SCP-QSP-IND-CSTF-U TO QSP-IND-CSTF-U(WSS-R)
      ***     MOVE SCP-QSP-IND-CSTF-O TO QSP-IND-CSTF-O(WSS-R)

              MOVE SCP-QSP-SGV-TMAX TO QSP-SGV-TMAX(WSS-R)
              MOVE SCP-QSP-VAL-FRIE TO QSP-VAL-FRIE(WSS-R)
              GO TO LUP-LEE-QUE-SCP.
                                                                        
       FIN-LEE-QUE-SCP.                                                 
           EXIT.                                                        
                                                                        
       GRA-ROC SECTION.                                                 
       INI-GRA-ROC.                                                     
           PERFORM GET-FHOY.                                            
           PERFORM OBT-COR-ROC.                                         
           MOVE OPC-CAI-IOPC IN SCP-FLD TO ROC-CAI-IOPC IN ROC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO ROC-IIC-IOPC IN ROC.         
           MOVE ZEROES                  TO ROC-EXT-IOPC IN ROC.         
           MOVE FRM-COD-SIST IN SCP-FLD TO ROC-COD-SIST IN ROC.         
           MOVE FRM-COD-EVEN IN SCP-FLD TO ROC-COD-EVEN IN ROC.         
           MOVE WSS-NUM-IROC            TO ROC-NUM-IROC IN ROC.         
           MOVE HOY-STP-ITRN            TO ROC-STP-ITRN IN ROC.         
           MOVE QSP-IND-SELC(WSS-I)     TO ROC-MSC-STAT IN ROC.         
           MOVE SPACES                  TO ROC-COD-OTRN IN ROC.         
           MOVE 'MC2PUSCP'              TO ROC-COD-ATRN IN ROC.
           MOVE FRM-COD-CPTO IN SCP-FLD TO ROC-COD-CPTO IN ROC.         
           MOVE QSP-COD-SEGU(WSS-I)     TO ROC-COD-MODL IN ROC.         
           MOVE QSP-COD-OCOB(WSS-I)     TO ROC-COD-OCOB IN ROC.         
                                                                        
           IF (FRM-COD-CPTO IN SCP-FLD = 'SGS' OR 'CGN' OR 'CCM')
               PERFORM MV-ROC-SGS                                       
           ELSE                                                         
           IF FRM-COD-CPTO IN SCP-FLD = 'INT'                           
               PERFORM MV-ROC-INT                                       
           ELSE                                                         
           IF FRM-COD-CPTO IN SCP-FLD = 'PPC'                           
               PERFORM MV-ROC-PPC.                                      
                                                                        
           IF ROC-MSC-STAT IN ROC = 'S'                                 
               MOVE SPACES TO ROC-COD-ANUL IN ROC                       
           ELSE                                                         
               MOVE '02'   TO ROC-COD-ANUL IN ROC.                      
                                                                        
           MOVE SPACES     TO ROC-IDC-ADIC IN ROC.                      
           MOVE SPACES     TO ROC-VRF-ADIC IN ROC.                      
           MOVE ZEROES     TO ROC-FEC-FUNO IN ROC.                      
           MOVE ZEROES     TO ROC-FEC-FDOS IN ROC.                      
           MOVE SPACES     TO ROC-GLS-DISP IN ROC.                      
                                                                        
      *PVG INI 11-ENE-2007 INTEGRACION CGN
           MOVE 'RCC'                   TO ROC-GLS-ADIC IN ROC.
           MOVE FRM-CAI-IRCC IN SCP-FLD TO ROC-IND-ADIC IN ROC.
           MOVE FRM-IIC-IRCC IN SCP-FLD TO ROC-NUM-ADIC IN ROC.
      *PVG FIN 11-ENE-2007
      *PVG INI 09-JUN-2010
           IF SCR-CIC-DIND IN SCR-VARI > SPACES
              MOVE SCR-CAI-DIND IN SCR-VARI TO ROC-CAI-ICLI IN ROC
              MOVE SCR-IIC-DIND IN SCR-VARI TO ROC-IIC-ICLI IN ROC.
      *PVG FIN 09-JUN-2010

           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM MC2-FIO-ROC.
           IF NOT FIO-STAT-OKS                                          
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'ROC    NOGRB' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-GRA-ROC.                                       
                                                                        
           IF FRM-COD-CPTO IN SCP-FLD = 'INT' AND                       
                  ROC-IND-TPLT IN ROC = 'P'                             
               PERFORM GRA-ITR.                                         
       FIN-GRA-ROC.                                                     
           EXIT.                                                        
                                                                        
       MV-ROC-SGS SECTION.                                              
       INI-MV-ROC-SGS.                                                  
           MOVE QSP-COD-TSEG(WSS-I)     TO ROC-COD-SCPT IN ROC.         
           MOVE QSP-VAL-MNTO(WSS-I)     TO ROC-SGV-TCAL IN ROC.         
           MOVE QSP-COD-MONE(WSS-I)     TO ROC-COD-VCOC IN ROC.         
      ***  MOVE QSP-COD-VCOC(WSS-I)     TO ROC-COD-TCAL IN ROC.
      ***  MOVE 'N'                     TO ROC-IND-TCAL IN ROC.
      ***  IF FRM-COD-CPTO IN SCP-FLD = 'CCM' AND
      ***     QSP-VAL-FRIE(WSS-I) > ZEROES
      ***     MOVE 'S'                  TO ROC-IND-TCAL IN ROC.
                                                                        
           MOVE SPACES                  TO ROC-COD-TINT IN ROC.         
           MOVE ZEROES                  TO ROC-NUM-PREP IN ROC.         
           MOVE ZEROES                  TO ROC-SGV-TINF IN ROC.         
           MOVE ZEROES                  TO ROC-SGV-CFON IN ROC.         

      ***  MOVE QSP-SGV-TAMO(WSS-I)     TO ROC-SGV-TINF IN ROC.
      ***  MOVE QSP-COD-TINF(WSS-I)     TO ROC-COD-TINF IN ROC.
      ***  MOVE 'N'                     TO ROC-IND-TINF IN ROC.

      *PVG INI 11-ENE-2007 INTEGRACION CGN
           IF FRM-COD-CPTO IN SCP-FLD = 'CGN'
              MOVE QSP-SGV-CSTF(WSS-I)  TO ROC-SGV-CFON IN ROC
              MOVE QSP-COD-TINT(WSS-I)  TO ROC-COD-TINT IN ROC
              MOVE QSP-SGV-TAMO(WSS-I)  TO ROC-SGV-TINF IN ROC.
      ***     MOVE QSP-COD-TINF(WSS-I)  TO ROC-COD-TINF IN ROC.
      *PVG FIN 11-ENE-2007
           MOVE ZEROES                  TO ROC-SGV-FRIE IN ROC.         
           MOVE QSP-VAL-FRIE(WSS-I)     TO ROC-SGV-FRIE IN ROC.
                                                                        
           MOVE FRM-CAI-PLAN IN SCP-FLD TO ROC-CAI-PLAN IN ROC.         
           MOVE FRM-IIC-PLAN IN SCP-FLD TO ROC-IIC-PLAN IN ROC.         
           MOVE FRM-IND-TPLT IN SCP-FLD TO ROC-IND-TPLT IN ROC.         
           MOVE FRM-FEC-PLAN IN SCP-FLD TO ROC-FEC-PLAN IN ROC.         
           MOVE FRM-HRA-PLAN IN SCP-FLD TO ROC-HRA-PLAN IN ROC.         
       FIN-MV-ROC-SGS.                                                  
           EXIT.                                                        
                                                                        
       MV-ROC-INT SECTION.                                              
       INI-MV-ROC-INT.                                                  
           MOVE SPACES              TO ROC-COD-SCPT IN ROC.             
           MOVE QSP-COD-MONE(WSS-I) TO ROC-COD-VCOC IN ROC.             
           MOVE QSP-CIC-PLAN(WSS-I) TO ROC-CIC-PLAN IN ROC.             
           MOVE QSP-COD-TSEG(WSS-I) TO ROC-IND-TPLT IN ROC.             
           MOVE QSP-FEC-PLAN(WSS-I) TO ROC-FEC-PLAN IN ROC.             
           MOVE QSP-HRA-PLAN(WSS-I) TO ROC-HRA-PLAN IN ROC.             
                                                                        
           MOVE QSP-VAL-PPRO(WSS-I) TO ROC-SGV-TCAL IN ROC.             
           MOVE QSP-COD-TINT(WSS-I) TO ROC-COD-TINT IN ROC.             
                                                                        
           MOVE QSP-SGV-TAMO(WSS-I) TO ROC-SGV-TINF IN ROC.             
                                                                        
           MOVE QSP-SGV-CSTF(WSS-I) TO ROC-SGV-CFON IN ROC.             
           MOVE QSP-VAL-FRIE(WSS-I) TO ROC-SGV-FRIE IN ROC.             
      *OGB-INI 24-FEB-2016 AGREGAR GRABADO TMC
      *    MOVE QSP-VAL-FRIE(WSS-I) TO ROC-SGV-FRIE IN ROC.
           MOVE QSP-SGV-TMAX(WSS-I) TO ROC-SGV-FRIE IN ROC.
      *OGB-FIN 24-FEB-2016 AGREGAR GRABADO TMC
       FIN-MV-ROC-INT.                                                  
           EXIT.                                                        
                                                                        
       MV-ROC-PPC SECTION.                                              
       INI-MV-ROC-PPC.                                                  
           MOVE SPACES              TO ROC-COD-SCPT IN ROC.             
           MOVE QSP-COD-MONE(WSS-I) TO ROC-COD-VCOC IN ROC.             
           MOVE QSP-CIC-PLAN(WSS-I) TO ROC-CIC-PLAN IN ROC.             
           MOVE QSP-COD-TSEG(WSS-I) TO ROC-IND-TPLT IN ROC.             
           MOVE QSP-FEC-PLAN(WSS-I) TO ROC-FEC-PLAN IN ROC.             
           MOVE QSP-HRA-PLAN(WSS-I) TO ROC-HRA-PLAN IN ROC.             
                                                                        
           MOVE ZEROES              TO ROC-SGV-TCAL IN ROC.             
           MOVE SPACES              TO ROC-COD-TINT IN ROC.             
           MOVE ZEROES              TO ROC-NUM-PREP IN ROC.             
           MOVE ZEROES              TO ROC-SGV-TINF IN ROC.             
           MOVE ZEROES              TO ROC-SGV-CFON IN ROC.             
           MOVE ZEROES              TO ROC-SGV-FRIE IN ROC.             
       FIN-MV-ROC-PPC.                                                  
           EXIT.                                                        

       OBT-COR-ROC SECTION.
       INI-OBT-COR-ROC.
           MOVE ZEROES TO WSS-NUM-IROC IN WSS-VARI.
           MOVE OPC-CAI-IOPC IN SCP-FLD TO ROC-CAI-IOPC IN ROC.
           MOVE OPC-IIC-IOPC IN SCP-FLD TO ROC-IIC-IOPC IN ROC.
           MOVE ZEROES                  TO ROC-EXT-IOPC IN ROC.
           MOVE FRM-COD-SIST IN SCP-FLD TO ROC-COD-SIST IN ROC.
           MOVE FRM-COD-EVEN IN SCP-FLD TO ROC-COD-EVEN IN ROC.
           MOVE 999 TO ROC-NUM-IROC IN ROC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM MC2-FIO-ROC.
           IF NOT (FIO-STAT-OKS AND
               ROC-CAI-IOPC IN ROC = OPC-CAI-IOPC IN SCP-FLD AND
               ROC-IIC-IOPC IN ROC = OPC-IIC-IOPC IN SCP-FLD AND
               ROC-EXT-IOPC IN ROC = ZEROES AND
               ROC-COD-SIST IN ROC = FRM-COD-SIST IN SCP-FLD AND
               ROC-COD-EVEN IN ROC = FRM-COD-EVEN IN SCP-FLD)
               MOVE 1 TO WSS-NUM-IROC IN WSS-VARI
           ELSE
               MOVE ROC-NUM-IROC IN ROC TO WSS-NUM-IROC IN WSS-VARI
               ADD 1 TO WSS-NUM-IROC IN WSS-VARI
               MOVE FIO-END-BRW TO FIO-CMND
               PERFORM MC2-FIO-ROC.
       FIN-OBT-COR-ROC.
           EXIT.

       GRA-ITR SECTION.                                                 
       INI-GRA-ITR.                                                     
           PERFORM GET-CUR-ITR.                                         
           IF NOT FIO-STAT-OKS                                          
               PERFORM PUT-ITR                                          
               GO TO FIN-GRA-ITR.                                       
           MOVE FIO-GET-KEY-UPD TO FIO-CMND                             
           PERFORM COL-FIO-ITR                                          
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ITR    NOUPD' TO MSG-COD-MENS                      
               GO TO FIN-GRA-ITR.                                       
                                                                        
           IF QSP-COD-CVTI(WSS-I) > SPACES                              
               MOVE QSP-VAL-PPRO(WSS-I)  TO ITR-SGV-SPRD IN ITR         
               MOVE ZEROES               TO ITR-SGV-TINT IN ITR         
           ELSE                                                         
               MOVE QSP-VAL-PPRO(WSS-I)  TO ITR-SGV-TINT IN ITR.        
                                                                        
           MOVE QSP-COD-TINT(WSS-I)      TO ITR-COD-TINT IN ITR.        
      *PVG INI 24-OCT-2011
           IF ITR-NUM-PREP IN ITR NOT > SPACES
              MOVE ZEROES TO ITR-NUM-PREP IN ITR.
      *PVG FIN 24-OCT-2011
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM COL-FIO-ITR.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ITR    NOMOD' TO MSG-COD-MENS                      
               GO TO FIN-GRA-ITR.                                       
       FIN-GRA-ITR.                                                     
           EXIT.                                                        
                                                                        
       PUT-ITR SECTION.                                                 
       INI-PUT-ITR.                                                     
           PERFORM INI-REG-ITR.                                         
           MOVE OPC-CAI-IOPC IN SCP-FLD  TO ITR-CAI-IOPC IN ITR.        
           MOVE OPC-IIC-IOPC IN SCP-FLD  TO ITR-IIC-IOPC IN ITR.        
           MOVE ZEROES                   TO ITR-NUM-ICAN IN ITR.        
           MOVE SPACES                   TO ITR-CIC-IOPV IN ITR.        
           MOVE ZEROES                   TO ITR-NUM-IVCT IN ITR.        
           MOVE 'INT'                    TO ITR-IND-TTAS IN ITR.        
           MOVE ZEROES                   TO ITR-FEC-FINI IN ITR.        
           IF QSP-COD-CVTI(WSS-I) > SPACES                              
               MOVE QSP-VAL-PPRO(WSS-I)  TO ITR-SGV-SPRD IN ITR         
               MOVE ZEROES               TO ITR-SGV-TINT IN ITR         
           ELSE                                                         
               MOVE ZEROES               TO ITR-SGV-SPRD IN ITR         
               MOVE QSP-VAL-PPRO(WSS-I)  TO ITR-SGV-TINT IN ITR.        
                                                                        
           MOVE QSP-COD-TINT(WSS-I)      TO ITR-COD-TINT IN ITR.        
      *PVG INI 24-OCT-2011
           IF ITR-NUM-PREP IN ITR NOT > SPACES
              MOVE ZEROES TO ITR-NUM-PREP IN ITR.
      *PVG FIN 24-OCT-2011
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM COL-FIO-ITR.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'ITR    NOGRB' TO MSG-COD-MENS.                     
       FIN-PUT-ITR.                                                     
           EXIT.                                                        
                                                                        
       INI-REG-ITR SECTION.                                             
       INI-INI-REG-ITR.                                                 
           MOVE SPACES   TO ITR-GLS-FLAG IN ITR.                        
           MOVE ZEROES   TO ITR-FEC-FTER IN ITR.                        
           MOVE ZEROES   TO ITR-SGV-SPRD IN ITR.                        
           MOVE ZEROES   TO ITR-SGV-MNTO IN ITR.                        
           MOVE SPACES   TO ITR-GLS-DISP IN ITR.                        
       FIN-INI-REG-ITR.                                                 
           EXIT.                                                        
                                                                        
       GET-CUR-ITR SECTION.                                             
       INI-GET-CUR-ITR.                                                 
           MOVE 'ITR-KEY-IICG' TO FIO-AKEY.                             
           MOVE OPC-CAI-IOPC IN SCP-FLD TO ITR-CAI-IOPC IN ITR.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO ITR-IIC-IOPC IN ITR.         
           MOVE ZEROES                  TO ITR-NUM-ICAN IN ITR.         
           MOVE SPACES                  TO ITR-CIC-IOPV IN ITR          
           MOVE ZEROES                  TO ITR-NUM-IVCT IN ITR          
           MOVE 'INT'                   TO ITR-IND-TTAS IN ITR.         
           MOVE ZEROES                  TO ITR-FEC-FINI IN ITR.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-ITR.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    ITR-CAI-IOPC IN ITR = OPC-CAI-IOPC IN SCP-FLD AND   
                    ITR-IIC-IOPC IN ITR = OPC-IIC-IOPC IN SCP-FLD AND   
                    ITR-NUM-ICAN IN ITR = ZEROES                  AND   
                    ITR-CIC-IOPV IN ITR = SPACES                  AND   
                    ITR-NUM-IVCT IN ITR = ZEROES                  AND   
                    ITR-IND-TTAS IN ITR = 'INT'  )                      
               MOVE '23' TO FIO-STAT.                                   
       FIN-GET-CUR-ITR.                                                 
           EXIT.                                                        
                                                                        
       VRF-TIP-SEG SECTION.
       INI-VRF-TIP-SEG.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE SPACES TO WSS-IND-DUPL.
           MOVE ZEROES TO WSS-L IN WSS-VARI.
           MOVE ZEROES TO WSS-K IN WSS-VARI.
           IF FRM-COD-CPTO IN SCP-FLD NOT = 'SGS'                       
               GO TO FIN-VRF-TIP-SEG.                                   
       LUP-VRF-TIP-SEG.
           ADD 1 TO WSS-L.
           MOVE WSS-L              TO QUE-NITM.
           MOVE SCP-NOM-TSSCP      TO QUE-COLA.
           MOVE SCP-LEN-TSSCP      TO QUE-LITM.
           MOVE QUE-GET            TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               GO TO FIN-VRF-TIP-SEG.

           MOVE QUE-ITEM         TO SCP-ITEM.
           IF SCP-FRM-IND-SELC = 'N'
               GO TO LUP-VRF-TIP-SEG.

           PERFORM CHK-VEC-TSEG VARYING WSS-J FROM 1 BY 1 UNTIL
             WSS-J > WSS-JMAX OR
             (SCP-FRM-COD-TSEG = WSS-COD-TSEG(WSS-J) AND
              SCP-FRM-IND-SELC = 'S')

      * Encuentra
           IF WSS-J NOT > WSS-JMAX
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'TSEG    DUPL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE SCP-FRM-COD-TSEG TO FRM-MEN2
               MOVE 'S' TO WSS-IND-DUPL
               GO TO FIN-VRF-TIP-SEG.

      * No encuentra
           ADD 1 TO WSS-K.
           IF WSS-K > WSS-KMAX
               GO TO FIN-VRF-TIP-SEG.

           MOVE SCP-FRM-COD-TSEG TO WSS-COD-TSEG(WSS-K).
           MOVE SCP-FRM-IND-SELC TO WSS-IND-SELE(WSS-K).
           GO TO LUP-VRF-TIP-SEG.

       FIN-VRF-TIP-SEG.
           EXIT.
                                                                        
       CHK-VEC-TSEG SECTION.                                            
       INI-CHK-VEC-TSEG.                                                
       FIN-CHK-VEC-TSEG.                                                
           EXIT.                                                        
*% END

       HBL-KEY-SCP SECTION.                                             
       INI-HBL-KEY-SCP.                                                 
           MOVE SCR-INST-GKY TO SCR-INST.                               
           MOVE 'SEL' TO SCR-CMND.                                      
           MOVE 'ACC' TO SCR-CCPP.                                      
           MOVE 'M'   TO SCR-STPP.                                      
           MOVE '1' TO FRM-CPIM-AEY.                                    
           MOVE FRM-CPIM-AEY TO OPC-CAI-IOPC-ATR IN SCP-FLD.            
           MOVE FRM-CPIM-AEY TO OPC-IIC-IOPC-ATR IN SCP-FLD.            
                                                                        
                                                                        
           PERFORM SCR-CLRA-SCP.                                        
           MOVE +4 TO OPC-CAI-IOPC-LEN IN SCP-FLD.                      
           MOVE -1 TO FRM-COD-CPTO-LEN IN SCP-FLD.                      
           MOVE SCR-CAI-IOPC IN SCR-VARI TO OPC-CAI-IOPC IN SCP-FLD.    
           MOVE SCR-IIC-IOPC IN SCR-VARI TO OPC-IIC-IOPC IN SCP-FLD.    
      *ISP  7-FEB-1990 DEBE SER REEMPLAZADO POR VARIABLE                
      *     INHIBE MOVE FRM-CPSF TO FRM-CPIM-AEY                        
      *     MOVE '1' TO FRM-CPIM-AEY.                                   
      *     PERFORM HBL-FLD.                                            
                                                                        
           PERFORM EDT-KEY-SCP.                                         
           PERFORM EDT-FLD-SCP.                                         
                                                                        
           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'                
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)      
               PERFORM SCR-INIT                                         
               PERFORM SCR-EXIT                                         
           ELSE                                                         
               PERFORM SCR-PUTA.                                        
                                                                        
       FIN-HBL-KEY-SCP.                                                 
           EXIT.                                                        
*% IF PGM_PQ
       OBT-FEC-PVTO SECTION.
       INI-OBT-FEC-PVTO.
           MOVE SPACES TO MSG-COD-MENS.
           MOVE ZEROES TO WSS-FEC-FPVT IN WSS-VARI.
           MOVE OPC-CAI-IOPC IN OPC TO EVC-CAI-IOPC IN EVC.
           MOVE OPC-IIC-IOPC IN OPC TO EVC-IIC-IOPC IN EVC.
           MOVE ZEROES                  TO EVC-NUM-IEVC IN EVC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-OBT-FEC-PVTO.
           PERFORM COL-FIO-EVC.
           IF NOT ( FIO-STAT-OKS AND
                    EVC-CAI-IOPC IN EVC = OPC-CAI-IOPC IN OPC AND
                    EVC-IIC-IOPC IN EVC = OPC-IIC-IOPC IN OPC )
               GO TO FIN-OBT-FEC-PVTO.
      
           IF ( EVC-VAL-VENC IN EVC > ZEROES ) OR
              ( EVC-MSC-BCCR IN EVC NOT = 'I' )
               IF WSS-FEC-FPVT NOT > ZEROES OR
                  WSS-FEC-FPVT     > EVC-FEC-FPVC IN EVC
                   IF OPC-IND-AFER IN OPC = 'N'
                       MOVE EVC-FEC-FPVC IN EVC TO WSS-FEC-FPVT
                   ELSE
                       MOVE EVC-NUM-DPVC IN EVC TO FEC-ITM1
                       MOVE EVC-NUM-MPVC IN EVC TO FEC-ITM2
                       MOVE EVC-NUM-SPVC IN EVC TO FEC-ITM3
                       MOVE EVC-NUM-APVC IN EVC TO FEC-ITM4
                       PERFORM ANL-FRDO
                       IF MSG-COD-MENS NOT > SPACES
                           MOVE FEC-ITM1 TO WSS-NUM-DPVT
                           MOVE FEC-ITM2 TO WSS-NUM-MPVT
                           MOVE FEC-ITM3 TO WSS-NUM-SPVT
                           MOVE FEC-ITM4 TO WSS-NUM-APVT
                       ELSE
                           GO TO FIN-OBT-FEC-PVTO.
      *PVG INI 09-JUN-2010
           IF WSS-FEC-FPVT IN WSS-VARI NOT > ZEROES                     
              MOVE FIO-GET-NXT TO FIO-CMND                              
              GO TO LUP-OBT-FEC-PVTO.                                   
      *PVG FIN 09-JUN-2010
       FIN-OBT-FEC-PVTO.
           EXIT.
      
       ANL-FRDO SECTION.
       INI-ANL-FRDO.
           MOVE SPACES TO MSG-COD-MENS.
      
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM PRO-FEC.
           IF ( NOT FEC-STAT-OKS ) AND ( NOT FEC-STAT-FER )
               MOVE 'ANLFRDOFVHBL' TO MSG-COD-MENS
               GO TO FIN-ANL-FRDO.
      
           IF FEC-STAT-FER
               MOVE FEC-FORM-FEC TO FEC-FORM
               MOVE FEC-SIG-HBL  TO FEC-CMND
               PERFORM CAL-FEC
               IF NOT FEC-STAT-OKS
                   MOVE 'ANLFRDOFSHBL' TO MSG-COD-MENS
                   GO TO FIN-ANL-FRDO.
      
           MOVE SPACES TO MSG-COD-MENS.
       FIN-ANL-FRDO.
           EXIT.
*% END
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBPFEC.

       COPY MC2BFROC.
       COPY COLBFTOC.
       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFRDC.
       COPY COLBFVEN.
       COPY COLBFCAN.
       COPY COLBFEVC.
*% IF PGM_PU
       COPY COLBFAUT.
*% END
*% IF PGM_PQ
       COPY COLBFAUT.
      *PVG INI 22-MAY-2012
       COPY COLBFROV.
      *PVG FIN 22-MAY-2012
*% END
*% IF PGM_PU
       COPY COLBFITR.
      *COPY GNSBVMSC.                                                   
      *COPY GNSBFMSC.                                                   
*% END
*% IF PGM_PU
       ELI-ROC-SCP SECTION.
       INI-ELI-ROC-SCP.
           MOVE OPC-CAI-IOPC IN SCP-FLD TO ROC-CAI-IOPC IN ROC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO ROC-IIC-IOPC IN ROC.         
           MOVE ZEROES              TO ROC-EXT-IOPC IN ROC.             
           MOVE 'CRE'               TO ROC-COD-SIST IN ROC.             
           MOVE 'CUR'               TO ROC-COD-EVEN IN ROC.             
           MOVE ZEROES              TO ROC-NUM-IROC IN ROC.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-ELI-ROC-SCP.
           PERFORM MC2-FIO-ROC.
           IF NOT (FIO-STAT-OKS AND                                     
              ROC-CAI-IOPC IN ROC = OPC-CAI-IOPC IN SCP-FLD AND         
              ROC-IIC-IOPC IN ROC = OPC-IIC-IOPC IN SCP-FLD AND         
              ROC-EXT-IOPC IN ROC = ZEROES AND                          
              ROC-COD-SIST IN ROC = 'CRE' AND                           
              ROC-COD-EVEN IN ROC = 'CUR')                              
              MOVE OPC-CAI-IOPC IN SCP-FLD TO ROC-CAI-IOPC IN ROC       
              MOVE OPC-IIC-IOPC IN SCP-FLD TO ROC-IIC-IOPC IN ROC       
              GO TO FIN-ELI-ROC-SCP.
           IF ROC-COD-CPTO IN ROC NOT = FRM-COD-CPTO IN SCP-FLD         
               MOVE FIO-GET-NXT TO FIO-CMND                             
              GO TO LUP-ELI-ROC-SCP.
                                                                        
           IF (SCR-CIC-DIND IN SCR-VARI > SPACES AND
               SCR-CAI-DIND IN SCR-VARI = ROC-CAI-ICLI IN ROC AND
               SCR-IIC-DIND IN SCR-VARI = ROC-IIC-ICLI IN ROC)
              GO TO CNT-ELI-ROC-SCP.
           IF (SCR-CIC-DIND IN SCR-VARI NOT > SPACES AND
               ROC-CAI-ICLI IN ROC = '0000'          AND
               ROC-IIC-ICLI IN ROC = '00000000')
              GO TO CNT-ELI-ROC-SCP.

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-ELI-ROC-SCP.
       CNT-ELI-ROC-SCP.
      *PVG FIN 09-JUN-2010
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM MC2-FIO-ROC.
           IF FIO-STAT-OKS                                              
               MOVE FIO-DEL TO FIO-CMND                                 
               PERFORM MC2-FIO-ROC
               GO TO INI-ELI-ROC-SCP.
       FIN-ELI-ROC-SCP.
           EXIT.
*% END

       COPY SGCBFDBC.
       COPY COLBGUVD.
       COPY GNSBBMSC.
       COPY MC2BKRCC.
*% IF PGM_PQ
      *PVG INI 25-AGO-2006
       BUS-HABIL SECTION.
       INI-BUS-HABIL.
           IF NOT (OPC-IND-AFER IN OPC = 'S')
              GO TO FIN-BUS-HABIL.
           MOVE DLC-NUM-DVEN IN UVD(1) TO FEC-ITM1.
           MOVE DLC-NUM-MVEN IN UVD(1) TO FEC-ITM2.
           MOVE DLC-NUM-SVEN IN UVD(1) TO FEC-ITM3.
           MOVE DLC-NUM-AVEN IN UVD(1) TO FEC-ITM4.
           GO TO LUP-BUS-HABIL.
       SUM-BUS-HABIL.
           MOVE 1            TO FEC-NDIA.
           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           PERFORM CAL-FEC.
           MOVE FEC-ITM1     TO DLC-NUM-DVEN IN UVD(1).
           MOVE FEC-ITM2     TO DLC-NUM-MVEN IN UVD(1).
           MOVE FEC-ITM3     TO DLC-NUM-SVEN IN UVD(1).
           MOVE FEC-ITM4     TO DLC-NUM-AVEN IN UVD(1).
       LUP-BUS-HABIL.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
              MOVE DLC-NUM-DVEN IN UVD(1) TO FEC-ITM1
              MOVE DLC-NUM-MVEN IN UVD(1) TO FEC-ITM2
              MOVE DLC-NUM-SVEN IN UVD(1) TO FEC-ITM3
              MOVE DLC-NUM-AVEN IN UVD(1) TO FEC-ITM4
              GO TO SUM-BUS-HABIL.
       FIN-BUS-HABIL.
           EXIT.
      *PVG FIN 25-AGO-2006
      *PVG INI 09-JUN-2010
       BUS-RDC-DIND SECTION.                                            
       INI-BUS-RDC-DIND.                                                
      *ASUME SIN AVAL                                                   
           DIVIDE 1 BY 2 GIVING RCC-VAL-INTE IN RCC-VARI.               
                                                                        
           MOVE OPC-CAI-IOPC IN SCP-FLD TO RDC-CAI-IOPC IN RDC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO RDC-IIC-IOPC IN RDC.         
           MOVE ZEROES                  TO RDC-NUM-IDLC IN RDC.         
           MOVE 'RDC-KEY-IDLC' TO FIO-AKEY.                             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-BUS-RDC-DIND.                                                
           PERFORM COL-FIO-RDC.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                   RDC-CAI-IOPC IN RDC = OPC-CAI-IOPC IN SCP-FLD AND    
                   RDC-IIC-IOPC IN RDC = OPC-IIC-IOPC IN SCP-FLD)       
              GO TO EXT-BUS-RDC-DIND.                                   
           IF RDC-NUM-IDLC IN RDC NOT > ZEROES                          
              GO TO NXT-BUS-RDC-DIND.                                   
           MOVE FIO-END-BRW TO FIO-CMND.                                
           PERFORM COL-FIO-RDC.                                         
                                                                        
           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF FIO-STAT-OKS                                              
              MOVE DBC-NUM-ICLI IN DBC TO RCC-VAL-INTE IN RCC-VARI.     
                                                                        
           GO TO FIN-BUS-RDC-DIND.                                      
       NXT-BUS-RDC-DIND.                                                
           MOVE FIO-GET-NXT     TO FIO-CMND.                            
           MOVE 'RDC-KEY-IDLC'  TO FIO-AKEY.                            
           GO TO LUP-BUS-RDC-DIND.                                      
       EXT-BUS-RDC-DIND.                                                
           IF FIO-STAT-OKS                                              
              MOVE FIO-END-BRW TO FIO-CMND                              
              PERFORM COL-FIO-RDC.                                      
       FIN-BUS-RDC-DIND.                                                
           EXIT.                                                        
      *PVG FIN 09-JUN-2010
      *PVG INI 22-MAR-2010 PROCESA CREDITOS NO ESTRUCTURADOS
       LEE-VEN-FMMV SECTION.
       INI-LEE-VEN-FMMV.
           MOVE ZEROES   TO DLC-FEC-FVEN IN UVD(1).
           MOVE 99999999 TO WSS-FEC-FPVT IN WSS-VARI.
       
           MOVE OPC-CIC-IOPC IN OPC TO VEN-CIC-IOPC IN VEN.             
           MOVE ZEROES              TO VEN-NUM-IVEN IN VEN.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM COL-FIO-VEN.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN )
              MOVE 'OPC    NOVEN' TO MSG-COD-MENS IN MSG
              GO TO EXT-LEE-VEN-FMMV.
       LUP-LEE-VEN-FMMV.
           IF VEN-FEC-FVEN IN VEN > DLC-FEC-FVEN IN UVD(1)
              MOVE VEN-FEC-FVEN IN VEN TO DLC-FEC-FVEN IN UVD(1).
           IF VEN-FEC-FVEN IN VEN < WSS-FEC-FPVT IN WSS-VARI
              MOVE VEN-FEC-FVEN IN VEN TO WSS-FEC-FPVT IN WSS-VARI.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-VEN.
           IF NOT FIO-STAT-OKS
              GO TO FIN-LEE-VEN-FMMV.
           IF OPC-CIC-IOPC IN OPC = VEN-CIC-IOPC IN VEN
              GO TO LUP-LEE-VEN-FMMV.
       EXT-LEE-VEN-FMMV.
           IF FIO-STAT-OKS
              MOVE FIO-END-BRW TO FIO-CMND
              PERFORM COL-FIO-VEN.
       FIN-LEE-VEN-FMMV.
           EXIT.
      *PVG FIN 22-MAR-2010
*% END
*% IF PGM_PU
       PGM-EBR-ALL SECTION.                                             
       INI-PGM-EBR-ALL.                                                 
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE FIO-EBR-ALL TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
       FIN-PGM-EBR-ALL.                                                 
           EXIT.          
*% END
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
           PERFORM ELI-ROC-SCP.
           PERFORM PRO-ING-ROC.                                         
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-CMN-ACC.                                       
                                                                        
      *PVG INI 06-SEP-2006 (CONTINGENCIA)                               
      *    MOVE ROC-CAI-IOPC IN ROC TO OPC-CAI-IOPC IN OPC.             
      *    MOVE ROC-IIC-IOPC IN ROC TO OPC-IIC-IOPC IN OPC.             
           MOVE OPC-CAI-IOPC IN SCP-FLD TO OPC-CAI-IOPC IN OPC.         
           MOVE OPC-IIC-IOPC IN SCP-FLD TO OPC-IIC-IOPC IN OPC.         
      *PVG FIN 06-SEP-2006                                              
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM COL-FIO-OPC.                                         
           IF FIO-STAT-OKS                                              
              IF OPC-MSC-STAT IN OPC = 'I'                              
               MOVE FIO-ULK-REC TO FIO-CMND
                 PERFORM COL-FIO-OPC                                    
              ELSE                                                      
                 MOVE 'I' TO OPC-MSC-STAT IN OPC                        
                 MOVE 'MC2PUSCP' TO OPC-COD-ATRN IN OPC                 
                 MOVE FIO-MOD TO FIO-CMND                               
                 PERFORM COL-FIO-OPC.                                   
                                                                        
           MOVE 'TAB'               TO MSG-COD-SIST.
           MOVE 'ROC    INGOK' TO MSG-COD-MENS.                         
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           GO TO CNT-CMN-ACC.                                           
      *>>>>                                                             
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
       CNT-CMN-ACC.                                                     
           IF FRM-FFLD = FRM-FFLD-PF10 AND                              
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC                                                 
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'            
               MOVE ROC-CAI-IOPC IN ROC TO OPC-CAI-IOPC IN OPC          
               MOVE ROC-IIC-IOPC IN ROC TO OPC-IIC-IOPC IN OPC          
               MOVE FIO-GET-KEY-UPD TO FIO-CMND                         
               PERFORM COL-FIO-OPC                                      
               IF FIO-STAT-OKS                                          
                   MOVE 'I' TO OPC-MSC-STAT IN OPC                      
                   MOVE FIO-MOD TO FIO-CMND                             
                   PERFORM COL-FIO-OPC.                                 
      *>>>>                                                             
*% END
*% IF SCR_GFLD_VAL_MKY
      *<<<< SCR_GFLD_VAL_MKY
           IF FRM-FFLD = FRM-FFLD-PF10 AND                              
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
*% END
*% IF FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
           IF FRM-FFLD = FRM-FFLD-PF3 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM EGR-FTER-CIC.
      *>>>>
*% END
*% IF PGM_PQ
*% IF FIN_SCR_GKEY OR FIN_SCR_GCNF OR FIN_SCR_GFLD   
      *<<<< FIN_SCR_GKEY OR FIN_SCR_GCNF OR FIN_SCR_GFLD                
           IF FRM-FFLD = FRM-FFLD-PF3 AND                               
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'                
               PERFORM EGR-FTER-CIC.                                    
      *>>>>                                                             
*% END
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM HBL-KEY-SCP.
      *>>>>
*% END
*% IF PGM_PQ AND EOF
      *PVG INI 22-MAY-2012
       PRO-SCP-PKTT SECTION.
       INI-PRO-SCP-PKTT.
           MOVE 'N'                 TO WSS-IND-PKTT IN WSS-VARI.
           MOVE OPC-CIC-IOPC IN OPC TO ROV-CIC-IOPC IN ROV.
           MOVE SPACES              TO ROV-CIC-IOPV IN ROV.
           MOVE ZEROES              TO ROV-NUM-IVCT IN ROV.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-SCP-PKTT-ROV.
           PERFORM COL-FIO-ROV.
           IF NOT (FIO-STAT-OKS AND
                   ROV-CIC-IOPC IN ROV = OPC-CIC-IOPC IN OPC)
              GO TO FIN-PRO-SCP-PKTT.
           IF ROV-IIC-IOPV IN ROV > ZEROES AND
              ROV-NUM-IVCT IN ROV > ZEROES
              MOVE ROV-KEY-IVCT IN ROV TO CAN-KEY-ICAN IN CAN
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM COL-FIO-CAN
           ELSE
              MOVE FIO-GET-NXT TO FIO-CMND
              GO TO LUP-PRO-SCP-PKTT-ROV.
      *CAN
           IF NOT (FIO-STAT-OKS                AND
                  (CAN-MSC-STAT IN CAN = 'C' OR
                   CAN-MSC-STAT IN CAN = 'P')  AND
                   CAN-MSC-CANC IN CAN = 'KTT')
              GO TO FIN-PRO-SCP-PKTT.

           MOVE 'S' TO WSS-IND-PKTT IN WSS-VARI.

      *ROC
           MOVE CAN-CAI-IOPC IN CAN TO ROC-CAI-IOPC IN ROC.
           MOVE CAN-IIC-IOPC IN CAN TO ROC-IIC-IOPC IN ROC.
           MOVE ZEROES              TO ROC-EXT-IOPC IN ROC.
           MOVE 'CRE'               TO ROC-COD-SIST IN ROC.
           MOVE 'CUR'               TO ROC-COD-EVEN IN ROC.
           MOVE ZEROES              TO ROC-NUM-IROC IN ROC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRO-SCP-PKTT.
           PERFORM MC2-FIO-ROC.
           IF NOT (FIO-STAT-OKS AND
                   ROC-CAI-IOPC IN ROC = CAN-CAI-IOPC IN CAN AND
                   ROC-IIC-IOPC IN ROC = CAN-IIC-IOPC IN CAN AND
                   ROC-EXT-IOPC IN ROC = ZEROES              AND
                   ROC-COD-SIST IN ROC = 'CRE'               AND
                   ROC-COD-EVEN IN ROC = 'CUR')
              MOVE 'ROCOPCPRONEX' TO RCC-COD-MENS
              GO TO FIN-PRO-SCP-PKTT.

           IF ROC-COD-CPTO IN ROC = 'INT' AND ROC-MSC-STAT IN ROC = 'S'
              MOVE '00' TO FIO-STAT
              MOVE 1    TO RCC-R IN RCC-VARI

              MOVE 'S'                 TO QSP-IND-SELC(RCC-R)
              MOVE ROC-IND-TPLT IN ROC TO QSP-COD-TSEG(RCC-R)
              MOVE ROC-COD-OCOB IN ROC TO QSP-COD-OCOB(RCC-R)
              MOVE ROC-COD-MODL IN ROC TO QSP-COD-SEGU(RCC-R)
              MOVE ROC-SGV-TCAL IN ROC TO QSP-VAL-MNTO(RCC-R)
      ***     MOVE ROC-COD-TCAL IN ROC TO QSP-COD-VCOC(RCC-R)
VER   ***     MOVE ROC-CIC-IRCC IN ROC TO QSP-CIC-IRCC(RCC-R)
              MOVE 1                   TO QSP-NUM-IRCC(RCC-R)
              MOVE ROC-COD-VCOC IN ROC TO QSP-COD-MONE(RCC-R)
              MOVE ROC-CIC-PLAN IN ROC TO QSP-CIC-PLAN(RCC-R)
              MOVE ROC-FEC-PLAN IN ROC TO QSP-FEC-PLAN(RCC-R)
              MOVE ROC-HRA-PLAN IN ROC TO QSP-HRA-PLAN(RCC-R)
              MOVE ROC-COD-TINT IN ROC TO QSP-COD-TINT(RCC-R)

              MOVE ROC-SGV-TCAL IN ROC TO QSP-VAL-PPRO(RCC-R)

              MOVE ROC-SGV-TINF IN ROC TO QSP-SGV-TAMO(RCC-R)
      ***     MOVE ROC-COD-TINF IN ROC TO QSP-COD-TINF(RCC-R)
              MOVE ROC-SGV-CFON IN ROC TO QSP-SGV-CSTF(RCC-R)
      ***     MOVE ROC-IND-CFUS IN ROC TO QSP-IND-CSTF-U(RCC-R)
      ***     MOVE ROC-IND-CFOP IN ROC TO QSP-IND-CSTF-O(RCC-R)
              MOVE ROC-SGV-TCAL IN ROC TO QSP-SGV-TMAX(RCC-R)
              MOVE ZEROES              TO QSP-VAL-FRIE(RCC-R)

VER   ***     MOVE ROC-CAI-IRCC IN ROC TO FRM-CAI-IRCC IN SCP-FLD
VER   ***     MOVE ROC-IIC-IRCC IN ROC TO FRM-IIC-IRCC IN SCP-FLD
              MOVE 1                   TO FRM-NUM-IRCC IN SCP-FLD
              MOVE ROC-CAI-PLAN IN ROC TO FRM-CAI-PLAN IN SCP-FLD
              MOVE ROC-IIC-PLAN IN ROC TO FRM-IIC-PLAN IN SCP-FLD
              MOVE ROC-IND-TPLT IN ROC TO FRM-IND-TPLT IN SCP-FLD
              MOVE ROC-FEC-PLAN IN ROC TO FRM-FEC-PLAN IN SCP-FLD
              MOVE ROC-HRA-PLAN IN ROC TO FRM-HRA-PLAN IN SCP-FLD
              MOVE ROC-COD-SIST IN ROC TO FRM-COD-SIST IN SCP-FLD
              MOVE ROC-COD-EVEN IN ROC TO FRM-COD-EVEN IN SCP-FLD
              MOVE ROC-COD-VCOC IN ROC TO FRM-COD-MONE IN SCP-FLD

              GO TO FIN-PRO-SCP-PKTT.
       NXT-PRO-SCP-PKTT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-PRO-SCP-PKTT.
       FIN-PRO-SCP-PKTT.
           EXIT.
      *PVG FIN 22-MAY-2012
      *PVG INI 21-OCT-2013
       PRO-INT-INFO SECTION.
       INI-PRO-INT-INFO.
           IF FRM-VAL-TINF IN SCP-FLD NOT > ZEROES
              GO TO FIN-PRO-INT-INFO.
      *----------------------------------------------------------------*
           MOVE VEC-QSP-DET(1)          TO VEC-QSP-DET(RCC-R).
           MOVE SPACES                  TO QSP-CIC-IRCC(RCC-R).
           MOVE ZEROES                  TO QSP-NUM-IRCC(RCC-R).
           MOVE SCR-USER                TO QSP-CIC-PLAN(RCC-R).
           MOVE FRM-COD-TINF IN SCP-FLD TO QSP-COD-TINT(RCC-R).
           MOVE QSP-VAL-PPRO(RCC-R)     TO QSP-SGV-TAMO(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO QSP-VAL-PPRO(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO QSP-VAL-MNTO(RCC-R).

           MOVE FRM-VAL-CINF IN SCP-FLD TO QSP-SGV-CSTF(RCC-R).
           MOVE ZEROES                  TO QSP-VAL-FRIE(RCC-R).
      *----------------------------------------------------------------*
           MOVE OSG-APL-VEC(1)          TO OSG-APL-VEC(RCC-R).
           MOVE SCR-USER                TO OSG-SGS-CIC-PLNT(RCC-R).
           MOVE SPACES                  TO OSG-SGS-CIC-IRCC(RCC-R).
           MOVE ZEROES                  TO OSG-SGS-NUM-IRCC(RCC-R).
           MOVE FRM-COD-TINF IN SCP-FLD TO OSG-SGS-COD-TINT(RCC-R).
           MOVE FRM-VAL-CINF IN SCP-FLD TO OSG-SGS-SGV-CSTF(RCC-R).
           MOVE ZEROES                  TO OSG-SGS-VAL-FRIE(RCC-R).
           MOVE OSG-OCI-VAL-PPRO(RCC-R) TO OSG-SGS-SGV-TAMO(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO OSG-OCI-VAL-PPRO(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO OSG-OCI-VAL-PMIN(RCC-R).
           MOVE FRM-VAL-TINF IN SCP-FLD TO OSG-OCI-VAL-PMAX(RCC-R).
      *----------------------------------------------------------------*
       CNT-PRO-INT-INFO.
           SUBTRACT 1 FROM RCC-R.
           IF RCC-R > ZEROES
              MOVE 'N' TO QSP-IND-SELC(RCC-R)
              MOVE 'N' TO OSG-SGS-IND-SELE(RCC-R)
              GO TO CNT-PRO-INT-INFO.
       FIN-PRO-INT-INFO.
           EXIT.
      *PVG FIN 21-OCT-2013
*% END
