*%! Codigo adicional para archivo
*% IF PDM_COD_CPTO
      *<<<< PDM_COD_CPTO
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'TCP' TO TAB-COD-TTAB IN TAB.
           MOVE PDM-COD-CPTO IN PDM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF INI_FST_FLD_PDM
      *<<<< INI_FST_FLD_PDM
           GO TO CNT-FST-FLD-PDM.
      *>>>>
*% END
*% IF FIN_FST_FLD_PDM
      *<<<< FIN_FST_FLD_PDM
       CNT-FST-FLD-PDM.
           IF SCR-CMND NOT = 'ING'
              MOVE -1           TO FRM-GLS-DES1-LEN IN PDM-FLD
              GO TO FIN-FST-FLD-PDM.
           IF FRM-GLS-DES1 IN PDM-FLD > SPACES
              MOVE FRM-CPIM-AEY TO FRM-GLS-DES1-ATR IN PDM-FLD
              MOVE FRM-CPIM-AEY TO FRM-GLS-DES2-ATR IN PDM-FLD
              MOVE -1           TO DPD-NUM-PRIO-LEN IN PDM-FLD 
           ELSE
              MOVE -1           TO FRM-GLS-DES1-LEN IN PDM-FLD.
      *>>>>
*% END
*% IF FIN_PUT_PDM_PDM
      *<<<< FIN_PUT_PDM_PDM
           IF PDM-IND-PRGR IN PDM = 'P'
               MOVE PDM-COD-VCOC IN PDM TO PDM-COD-VCOC IN PDM-FLD
               MOVE PDM-COD-TOOC IN PDM TO PDM-COD-TOOC IN PDM-FLD
               MOVE PDM-COD-AOOC IN PDM TO PDM-COD-AOOC IN PDM-FLD
               MOVE SPACES              TO FRM-COD-GRPO IN PDM-FLD
           ELSE
               MOVE SPACES              TO PDM-COD-VCOC IN PDM-FLD
               MOVE SPACES              TO PDM-COD-TOOC IN PDM-FLD
               MOVE SPACES              TO PDM-COD-AOOC IN PDM-FLD
               MOVE PDM-COD-GRPO IN PDM TO FRM-COD-GRPO IN PDM-FLD.

           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.
           MOVE PDM-CIC-IPDM IN PDM TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DES1 IN PDM-FLD.
           MOVE TAB-GLS-DATA IN TAB TO FRM-GLS-DES2 IN PDM-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DPD_PDM
      *<<<< FIN_PUT_DPD_PDM
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.
           MOVE DPD-CIC-IDPD IN DPD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DES1 IN PDM-FLD.
           MOVE TAB-GLS-DATA IN TAB TO FRM-GLS-DES2 IN PDM-FLD.

           IF DPD-COD-PRIO IN PDM-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'PDM'                   TO TAB-COD-TTAB IN TAB
              MOVE DPD-COD-PRIO IN PDM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-PRIO IN PDM-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-PRIO IN PDM-FLD.
      *>>>>
*% END
*% IF PDM_IND_TPLT
      *<<<< PDM_IND_TPLT
           IF PDM-IND-TPLT IN PDM-FLD NOT > SPACES
              MOVE 'P' TO PDM-IND-TPLT IN PDM-FLD
              GO TO FIN-VAL-PDM-IND-TPLT.
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'TDP'                   TO TAB-COD-TTAB IN TAB.
           MOVE PDM-IND-TPLT IN PDM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF PDM_COD_TCNL
      *<<<< PDM_COD_TCNL
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'CNL' TO TAB-COD-TTAB IN TAB.
           MOVE PDM-COD-TCNL IN PDM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF PDM_COD_CNAL
      *<<<< PDM_COD_CNAL                                                
           IF PDM-COD-CNAL IN PDM-FLD NOT > SPACES                          
               GO TO FIN-VAL-PDM-COD-CNAL.                              
           IF PDM-COD-TCNL IN PDM-FLD = '010'                       
              MOVE PDM-COD-CNAL IN PDM-FLD TO OFI-COD-OFIC IN OFI
              PERFORM VAL-OFI
              IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 NEXT SENTENCE
           ELSE
              MOVE 'TAB'                   TO TAB-COD-SIST              
              MOVE PDM-COD-TCNL IN PDM-FLD TO TAB-COD-TTAB IN TAB       
              MOVE PDM-COD-CNAL IN PDM-FLD TO TAB-COD-CTAB IN TAB       
              PERFORM VAL-COD.
      *>>>>                                                             
*% END
*% IF INI_PDM_FEC_FINI
      *<<<< INI_PDM_FEC_FINI
           MOVE FEC-CHOY-N TO FEC-CHOY.
           IF (SCR-CMND = 'ING' OR 'MOD' OR 'VRF' OR 'ACA')
                      MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           IF PDM-FEC-FINI IN PDM-FLD NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-DHOY IN HOY-VARI TO PDM-NUM-DINI IN PDM-FLD
              MOVE HOY-MHOY IN HOY-VARI TO PDM-NUM-MINI IN PDM-FLD
              MOVE HOY-SHOY IN HOY-VARI TO PDM-NUM-SINI IN PDM-FLD
              MOVE HOY-AHOY IN HOY-VARI TO PDM-NUM-AINI IN PDM-FLD
              IF PDM-HRA-HINI IN PDM-FLD NOT > ZEROES
                 MOVE HOY-HHOY IN HOY-VARI TO PDM-HRA-HINI IN PDM-FLD
                 GO TO FIN-VAL-PDM-FEC-FINI
              ELSE
                 GO TO FIN-VAL-PDM-FEC-FINI.
      *>>>>
*% END
*% IF PDM_HRA_HINI
      *<<<< PDM_HRA_HINI
           IF PDM-HRA-HINI IN PDM-FLD NOT > SPACES                      
              MOVE ZEROES TO PDM-HRA-HINI IN PDM-FLD.                   
           IF PDM-HRA-HINI IN PDM-FLD NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-HHOY IN HOY-VARI TO PDM-HRA-HINI IN PDM-FLD
              GO TO FIN-VAL-PDM-HRA-HINI.
           MOVE PDM-HRA-HINI IN PDM-FLD TO PDM-HRA-HINI IN PDM.
           IF PDM-NUM-HHIN IN PDM < ZEROES OR
              PDM-NUM-HHIN IN PDM > 23
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PDM-HRA-HINI.
           IF PDM-NUM-MMIN IN PDM < ZEROES OR
              PDM-NUM-MMIN IN PDM > 59
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'NUMMMTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PDM-HRA-HINI.
           IF PDM-NUM-SSIN IN PDM < ZEROES OR
              PDM-NUM-SSIN IN PDM > 59
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'NUMSSTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-PDM-HRA-HINI.
      *>>>>
*% END
*% IF PDM_COD_VCOC
      *<<<< PDM_COD_VCOC
           IF PDM-COD-VCOC IN PDM-FLD NOT > SPACES
              GO TO FIN-VAL-PDM-COD-VCOC.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE PDM-COD-VCOC IN PDM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF DPD_NUM_IDPD
      *<<<< DPD_NUM_IDPD
           IF SCR-CMND = 'MOD'
              IF DPD-NUM-IDPD IN PDM-FLD NOT > ZEROES
                 MOVE 'TAB'          TO MSG-COD-SIST
                 MOVE 'NUMPDM   OBL' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-DPD-NUM-IDPD.
      *>>>>
*% END
*% IF DPD_COD_PRIO
      *<<<< DPD_COD_PRIO
      *VAL-COD Valida codigo de tabla
            MOVE 'TAB'                   TO TAB-COD-SIST.
            MOVE 'PDM'                   TO TAB-COD-TTAB IN TAB.
            MOVE DPD-COD-PRIO IN PDM-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
            IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-PRIO IN PDM-FLD
            ELSE
               MOVE SPACES              TO FRM-GLS-PRIO IN PDM-FLD.
      *>>>>
*% END
*% IF FIN_KEY_PDM_PDM
      *<<<< FIN_KEY_PDM_PDM
           IF FRM-COD-GRPO IN PDM-FLD > SPACES
              MOVE FRM-COD-GRPO IN PDM-FLD TO PDM-COD-GRPO IN PDM
              MOVE 'G'                     TO PDM-IND-PRGR IN PDM
           ELSE
              MOVE 'P'                     TO PDM-IND-PRGR IN PDM.
      *>>>>
*% END
*% IF FIN_PRO_IKY_PDM
      *<<<< FIN_PRO_IKY_PDM
           MOVE FRM-CPIM-AEY TO FRM-COD-GRPO-ATR IN PDM-FLD.
      *>>>>
*% END
*% IF PDM_COD_TOOC
      *<<<< PDM_COD_TOOC
           IF (PDM-COD-TOOC IN PDM-FLD NOT > SPACES AND
               PDM-COD-VCOC IN PDM-FLD > SPACES)
               PERFORM ERR-GLS
               GO TO FIN-VAL-PDM-COD-TOOC.
           IF (PDM-COD-TOOC IN PDM-FLD NOT > SPACES AND
               PDM-COD-VCOC IN PDM-FLD NOT > SPACES)
               GO TO FIN-VAL-PDM-COD-TOOC.
           IF PDM-COD-TOOC IN PDM-FLD > SPACES
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'TIO' TO TAB-COD-TTAB IN TAB
              MOVE PDM-COD-TOOC IN PDM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF PDM_COD_AOOC
      *<<<< PDM_COD_AOOC
           IF (PDM-COD-AOOC IN PDM-FLD NOT > SPACES AND
               PDM-COD-TOOC IN PDM-FLD > SPACES)
               PERFORM ERR-GLS
               GO TO FIN-VAL-PDM-COD-AOOC.
           IF (PDM-COD-AOOC IN PDM-FLD > SPACES AND                      
               PDM-COD-TOOC IN PDM-FLD NOT > SPACES)
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'AOOC   NOVAL' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-VAL-PDM-COD-AOOC.
           IF PDM-COD-AOOC IN PDM-FLD > SPACES
              MOVE 'TAB' TO TAB-COD-SIST
              MOVE 'AUX' TO TAB-COD-TTAB IN TAB
              MOVE PDM-COD-TOOC IN PDM-FLD  TO WSS-COD-TOOC IN WSS-VARI
              MOVE PDM-COD-AOOC IN PDM-FLD  TO WSS-COD-AOOC IN WSS-VARI
              MOVE WSS-COD-CAUX IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF FRM_COD_GRPO
      *<<<< FRM_COD_GRPO                                                
           IF (FRM-COD-GRPO IN PDM-FLD NOT > SPACES AND
              (PDM-COD-VCOC IN PDM-FLD NOT > SPACES OR
               PDM-COD-TOOC IN PDM-FLD NOT > SPACES OR
               PDM-COD-AOOC IN PDM-FLD NOT > SPACES))
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'PROD   NOVAL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-COD-GRPO.

           IF (FRM-COD-GRPO IN PDM-FLD > SPACES AND                      
              (PDM-COD-VCOC IN PDM-FLD > SPACES OR                       
               PDM-COD-TOOC IN PDM-FLD > SPACES OR                       
               PDM-COD-AOOC IN PDM-FLD > SPACES))
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'GRPO   NOVAL' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
               GO TO FIN-VAL-FRM-COD-GRPO.                              
           IF (FRM-COD-GRPO IN PDM-FLD NOT > SPACES AND
               PDM-COD-VCOC IN PDM-FLD NOT > SPACES AND                       
               PDM-COD-TOOC IN PDM-FLD NOT > SPACES AND
               PDM-COD-AOOC IN PDM-FLD NOT > SPACES)
               PERFORM ERR-GLS
               GO TO FIN-VAL-FRM-COD-GRPO.                               
           IF FRM-COD-GRPO IN PDM-FLD NOT > SPACES                      
              GO TO FIN-VAL-FRM-COD-GRPO.                               
           MOVE FRM-COD-GRPO IN PDM-FLD TO PLN-CIC-PLAN IN PLN.         
           MOVE 99999999                TO PLN-FEC-FINI IN PLN.         
           MOVE 999999                  TO PLN-HRA-HINI IN PLN.         
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
       LUP-VAL-FRM-COD-GRPO.                                            
           PERFORM TAB-FIO-PLN.                                         
           IF NOT (FIO-STAT-OKS AND                                     
                   PLN-CIC-PLAN IN PLN = FRM-COD-GRPO IN PDM-FLD)       
              MOVE 'TAB'        TO MSG-COD-SIST                         
              MOVE 'PLN    NEX' TO MSG-COD-MENS                         
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-FRM-COD-GRPO.                               
           IF PLN-MSC-STAT IN PLN NOT = 'A'                             
              MOVE FIO-GET-PRV TO FIO-CMND                              
              GO TO LUP-VAL-FRM-COD-GRPO.                               
           MOVE 'TAB'               TO TAB-COD-SIST.                    
           MOVE 'DPN'               TO TAB-COD-TTAB IN TAB.             
           MOVE PLN-CIC-IPRD IN PLN TO TAB-COD-CTAB IN TAB.             
           PERFORM VAL-COD.                                             
      *>>>>
*% END
*% IF FIN_FRM_GLS_DES1
      *<<<< FIN_FRM_GLS_DES1
           IF FRM-GLS-DES1 IN PDM-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-FRM-GLS-DES1.
      *>>>>
*% END
*% IF FIN_DPD_NUM_PRIO
      *<<<<
           IF DPD-NUM-PRIO IN PDM-FLD > VRF-PDM-IMAX IN PDM-VARI
              MOVE 'TAB'          TO MSG-COD-SIST
              MOVE 'NUMPRIO>IMAX' TO MSG-COD-MENS                      
              PERFORM GET-MSG                                          
              MOVE MSG-GLS-DESC   TO FRM-MENS                          
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                          
              GO TO FIN-VAL-DPD-NUM-PRIO.
      *>>>>
*% END
