*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% PGM_STAT_RCC = TRUE
*% PGM_STAT_CFT = TRUE
*% PGM_STAT_DFT = TRUE
*% IF WSS
      *<<<< WSS
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.

       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY TABBRUSR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *PVG INI 24-MAR-2015
       COPY TABBRROC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROC-REQA==.
      *PVG FIN 24-MAR-2015

       COPY MC2BRCFT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CFT-REQA==.
       COPY MC2BRDFT.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DFT-REQA==.

       COPY COLBROPC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY COLBRDLC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY COLBRITR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY COLBRRDC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.

       01  WSS-VARI.
           03 WSS-GLS-DAT1.
              05 WSS-COD-SIST                         PIC X(03).
              05 WSS-GLS-FILL                         PIC X(07).
           03 WSS-COD-VCAM.
              05 WSS-COD-TVTI                         PIC X(01).
              05 WSS-COD-CVTI                         PIC X(03).
              05 WSS-COD-TCTI                         PIC X(02).
           03 WSS-GLS-EVEN.
              05 WSS-COD-SYST                         PIC X(03).
              05 WSS-COD-EVEN                         PIC X(03).

           03 WSS-IND-CPTO         VALUE 'CFT'        PIC X(03).
           03 WSS-IND-SIST         VALUE 'CRE'        PIC X(03).
           03 WSS-IND-OPCL         VALUE 'L'          PIC X(01).
           03 WSS-IND-OPCO         VALUE 'O'          PIC X(01).
           03 WSS-IND-TCNL         VALUE '010'        PIC X(03).
      *PVG INI 24-MAR-2015
           03 WSS-IND-TSPR         VALUE 'N'          PIC X(01).
      *PVG FIN 24-MAR-2015
       COPY MC2WGSFA.
       COPY MC2WGFCC.
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
      *>>>>
*% END
*% IF FIN_PGM_STAT
      *<<<<
           03 PGM-STAT.
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).

              05 PGM-STAT-DLC.
                 88 PGM-STAT-DLC-NUL    VALUE '  '.
                 07 PGM-STT1-DLC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DLC-OKS VALUE '0'.
                 07 PGM-STT2-DLC        VALUE '3' PIC X(01).

              05 PGM-STAT-ITR.
                 88 PGM-STAT-ITR-NUL    VALUE '  '.
                 07 PGM-STT1-ITR        VALUE '2' PIC X(01).
                    88 PGM-STAT-ITR-OKS VALUE '0'.
                 07 PGM-STT2-ITR        VALUE '3' PIC X(01).

              05 PGM-STAT-RCC.
                 88 PGM-STAT-RCC-NUL    VALUE '  '.
                 07 PGM-STT1-RCC        VALUE '2' PIC X(01).
                    88 PGM-STAT-RCC-OKS VALUE '0'.
                 07 PGM-STT2-RCC        VALUE '3' PIC X(01).
              05 PGM-STAT-AGD.
                 88 PGM-STAT-AGD-NUL    VALUE '  '.
                 07 PGM-STT1-AGD        VALUE '2' PIC X(01).
                    88 PGM-STAT-AGD-OKS VALUE '0'.
                 07 PGM-STT2-AGD        VALUE '3' PIC X(01).
              05 PGM-STAT-CFT.
                 88 PGM-STAT-CFT-NUL    VALUE '  '.
                 07 PGM-STT1-CFT        VALUE '2' PIC X(01).
                    88 PGM-STAT-CFT-OKS VALUE '0'.
                 07 PGM-STT2-CFT        VALUE '3' PIC X(01).
              05 PGM-STAT-DFT.
                 88 PGM-STAT-DFT-NUL    VALUE '  '.
                 07 PGM-STT1-DFT        VALUE '2' PIC X(01).
                    88 PGM-STAT-DFT-OKS VALUE '0'.
                 07 PGM-STT2-DFT        VALUE '3' PIC X(01).

      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           GO TO CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           MOVE FIO-STAT TO PGM-STAT-RCC.
       CON-FND-KEY.
      *--------------------------------------------------------------*
           PERFORM PRO-OBT-CFCA.
           IF SFA-COD-MENS IN SFA-VARI NOT > SPACES
              PERFORM PUT-TAB-SFA
              MOVE '00'         TO FIO-STAT
              MOVE SCR-STAT-CON TO SCR-STAT
           ELSE
              MOVE 'S'          TO SCR-IERR
              MOVE 'MC2'        TO MSG-COD-SIST
              MOVE SFA-COD-MENS TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE '00'         TO FIO-STAT
              IF SFA-COD-MEN2 IN SFA-VARI > SPACES
                 MOVE MSG-GLS-DESC TO FRM-MEN1
                 MOVE SFA-COD-MEN2 TO FRM-MEN2
              ELSE
                 MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBBTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY GNSBVCOD.
       COPY GNSBVTAB.

      *--------------------------------------------------------------*
       PRO-OBT-CFCA SECTION.
       INI-PRO-OBT-CFCA.

      *----------------------------------------------------------------*
           MOVE FRM-COD-EVEN IN SFA-FLD  TO FCC-COD-EVEN IN FCC-VARI.
           MOVE FRM-COD-CPTO IN SFA-FLD  TO FCC-COD-CPTO IN FCC-VARI.
      *PVG INI 24-MAR-2015
      *    MOVE FRM-FEC-FOPE IN SFA-FLD  TO FCC-FEC-FOPE IN FCC-VARI.
      *PVG FIN 24-MAR-2015
      *PVG INI 27-AGO-2015
      *    MOVE FRM-COD-TCON IN SFA-FLD  TO FCC-COD-TCON IN FCC-VARI.
           MOVE SFA-COD-TVAR IN SFA-VARI TO FCC-COD-TCON IN FCC-VARI.
      *PVG FIN 27-AGO-2015
           MOVE FRM-CAI-IOPE IN SFA-FLD  TO FCC-CAI-IOPE IN FCC-VARI.
           MOVE FRM-IIC-IOPE IN SFA-FLD  TO FCC-IIC-IOPE IN FCC-VARI.
           MOVE FRM-EXT-IOPE IN SFA-FLD  TO FCC-EXT-IOPE IN FCC-VARI.
           MOVE FRM-COD-EJEC IN SFA-FLD  TO FCC-COD-EJEC IN FCC-VARI.
           MOVE FRM-COD-TCNL IN SFA-FLD  TO FCC-COD-TCNL IN FCC-VARI.
           MOVE FRM-COD-CNAL IN SFA-FLD  TO FCC-COD-CNAL IN FCC-VARI.
           MOVE FRM-COD-VCOC IN SFA-FLD  TO FCC-COD-VCOC IN FCC-VARI.
           MOVE FRM-COD-TOOC IN SFA-FLD  TO FCC-COD-TOOC IN FCC-VARI.
           MOVE FRM-COD-AOOC IN SFA-FLD  TO FCC-COD-AOOC IN FCC-VARI.
           MOVE FRM-NUM-PLZO IN SFA-FLD  TO FCC-NUM-PLZO IN FCC-VARI.
           MOVE FRM-MSC-UTPZ IN SFA-FLD  TO FCC-MSC-UTPZ IN FCC-VARI.
           MOVE FRM-VAL-MOPE IN SFA-FLD  TO FCC-VAL-MOPE IN FCC-VARI.
           MOVE FRM-SGV-TSPR IN SFA-FLD  TO FCC-SGV-TSPR IN FCC-VARI.
           MOVE FRM-SGV-TSSL IN SFA-FLD  TO FCC-SGV-TSSL IN FCC-VARI.
           MOVE FRM-MSC-BCTI IN SFA-FLD  TO FCC-MSC-BCTI IN FCC-VARI.
           MOVE FRM-MSC-PBTI IN SFA-FLD  TO FCC-MSC-PBTI IN FCC-VARI.
           MOVE FRM-MSC-BPBT IN SFA-FLD  TO FCC-MSC-BPBT IN FCC-VARI.
           MOVE FRM-MSC-SPBT IN SFA-FLD  TO FCC-MSC-SPBT IN FCC-VARI.
           MOVE FRM-COD-CVTI IN SFA-FLD  TO FCC-COD-CVTI IN FCC-VARI.
           MOVE FRM-MSC-TFPR IN SFA-FLD  TO FCC-MSC-TFPR IN FCC-VARI.
           MOVE FRM-NUM-PREP IN SFA-FLD  TO FCC-NUM-PREP IN FCC-VARI.
           MOVE FRM-MSC-UTPR IN SFA-FLD  TO FCC-MSC-UTPR IN FCC-VARI.
      *----------------------------------------------------------------*
      *    MOVE SCR-OFRM-SRV             TO FCC-OFRM-SRV IN FCC-VARI.
           IF FCC-NUM-VCOR IN FCC-VARI NOT > ZEROES
              MOVE 1 TO FCC-NUM-VCOR IN FCC-VARI.

           PERFORM MC2-LNK-FCC.
           MOVE FCC-COD-MENS IN FCC-VARI TO SFA-COD-MENS IN SFA-VARI.
           MOVE FCC-COD-MEN2 IN FCC-VARI TO SFA-COD-MEN2 IN SFA-VARI.
           IF SFA-COD-MENS IN SFA-VARI > SPACES
              GO TO FIN-PRO-OBT-CFCA.

           MOVE FCC-CIC-IRCC IN FCC-VARI TO RCC-CIC-IRCC IN RCC.

           MOVE FCC-CIC-ICFT IN FCC-VARI TO CFT-CIC-ICFT IN CFT.
           MOVE FCC-COD-SIST IN FCC-VARI TO CFT-COD-SIST IN CFT.
           MOVE FCC-KEY-EVEN IN FCC-VARI TO CFT-COD-EVEN IN CFT.
           MOVE FCC-KEY-VCOC IN FCC-VARI TO CFT-COD-VCOC IN CFT.
           MOVE FCC-IND-TPLT IN FCC-VARI TO CFT-IND-TPLT IN CFT.
           MOVE FCC-NUM-DINI IN FCC-VARI TO CFT-NUM-DINI IN CFT.
           MOVE FCC-NUM-MINI IN FCC-VARI TO CFT-NUM-MINI IN CFT.
           MOVE FCC-NUM-SINI IN FCC-VARI TO CFT-NUM-SINI IN CFT.
           MOVE FCC-NUM-AINI IN FCC-VARI TO CFT-NUM-AINI IN CFT.
           MOVE FCC-HRA-HINI IN FCC-VARI TO CFT-HRA-HINI IN CFT.

           MOVE FCC-GLS-DSC1 IN FCC-VARI TO SFA-GLS-ICFT IN SFA-VARI.
           MOVE FCC-SGV-VARI IN FCC-VARI TO SFA-SGV-VARI IN SFA-VARI.

      *PVG INI 27-AGO-2015
           IF SFA-COD-TCON IN SFA-VARI = SFA-COD-VSPD IN SFA-VARI
              MOVE FCC-SGV-SPPR IN FCC-VARI TO FRM-SGV-TSPR IN SFA-FLD
              MOVE FCC-SGV-SPSF IN FCC-VARI TO FRM-SGV-TSSL IN SFA-FLD.
           IF SFA-COD-TCON IN SFA-VARI = SFA-COD-VTAS IN SFA-VARI
              MOVE FCC-SGV-TSPR IN FCC-VARI TO FRM-SGV-TSPR IN SFA-FLD
              MOVE FCC-SGV-TSSL IN FCC-VARI TO FRM-SGV-TSSL IN SFA-FLD.
      *PVG FIN 27-AGO-2015
           MOVE FCC-COD-RFAC(1)          TO SFA-COD-ROLF IN SFA-VARI(1).
           MOVE FCC-SGV-PDFT(1)          TO SFA-SGV-PDFT IN SFA-VARI(1).
           MOVE FCC-SGV-MDFT(1)          TO SFA-SGV-MDFT IN SFA-VARI(1).
           MOVE FCC-COD-MDFT(1)          TO SFA-COD-MDFT IN SFA-VARI(1).

           MOVE FCC-COD-RFAC(2)          TO SFA-COD-ROLF IN SFA-VARI(2).
           MOVE FCC-SGV-PDFT(2)          TO SFA-SGV-PDFT IN SFA-VARI(2).
           MOVE FCC-SGV-MDFT(2)          TO SFA-SGV-MDFT IN SFA-VARI(2).
           MOVE FCC-COD-MDFT(2)          TO SFA-COD-MDFT IN SFA-VARI(2).

           MOVE FCC-COD-RFAC(3)          TO SFA-COD-ROLF IN SFA-VARI(3).
           MOVE FCC-SGV-PDFT(3)          TO SFA-SGV-PDFT IN SFA-VARI(3).
           MOVE FCC-SGV-MDFT(3)          TO SFA-SGV-MDFT IN SFA-VARI(3).
           MOVE FCC-COD-MDFT(3)          TO SFA-COD-MDFT IN SFA-VARI(3).

           MOVE FCC-COD-RFAC(4)          TO SFA-COD-ROLF IN SFA-VARI(4).
           MOVE FCC-SGV-PDFT(4)          TO SFA-SGV-PDFT IN SFA-VARI(4).
           MOVE FCC-SGV-MDFT(4)          TO SFA-SGV-MDFT IN SFA-VARI(4).
           MOVE FCC-COD-MDFT(4)          TO SFA-COD-MDFT IN SFA-VARI(4).

           MOVE FCC-COD-RFAC(5)          TO SFA-COD-ROLF IN SFA-VARI(5).
           MOVE FCC-SGV-PDFT(5)          TO SFA-SGV-PDFT IN SFA-VARI(5).
           MOVE FCC-SGV-MDFT(5)          TO SFA-SGV-MDFT IN SFA-VARI(5).
           MOVE FCC-COD-MDFT(5)          TO SFA-COD-MDFT IN SFA-VARI(5).

           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'DPL'                    TO TAB-COD-TTAB IN TAB.
           MOVE FCC-CIC-IRCC IN FCC-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC             TO SFA-GLS-IRCC IN SFA-VARI.
       FIN-PRO-OBT-CFCA.
           EXIT.
      *--------------------------------------------------------------*

       PUT-TAB-SFA SECTION.
       INI-PUT-TAB-SFA.
           MOVE RCC-CIC-IRCC IN RCC      TO FRM-CIC-IRCC IN SFA-FLD.

           MOVE SFA-GLS-IRCC IN SFA-VARI TO FRM-GLS-IRCC IN SFA-FLD.

           MOVE CFT-CIC-ICFT IN CFT      TO FRM-CIC-ICFT IN SFA-FLD.
           MOVE CFT-COD-SIST IN CFT      TO FRM-COD-SIST IN SFA-FLD.
           MOVE CFT-COD-EVEN IN CFT      TO FRM-KEY-EVEN IN SFA-FLD.
           MOVE CFT-COD-VCOC IN CFT      TO FRM-KEY-VCOC IN SFA-FLD.
           MOVE CFT-IND-TPLT IN CFT      TO FRM-IND-TPLT IN SFA-FLD.
           MOVE CFT-NUM-DINI IN CFT      TO FRM-NUM-DINI IN SFA-FLD.
           MOVE CFT-NUM-MINI IN CFT      TO FRM-NUM-MINI IN SFA-FLD.
           MOVE CFT-NUM-SINI IN CFT      TO FRM-NUM-SINI IN SFA-FLD.
           MOVE CFT-NUM-AINI IN CFT      TO FRM-NUM-AINI IN SFA-FLD.
           MOVE CFT-HRA-HINI IN CFT      TO FRM-HRA-HINI IN SFA-FLD.

           MOVE SFA-GLS-ICFT IN SFA-VARI TO FRM-GLS-ICFT IN SFA-FLD.
           IF SCR-OFRM-SRV
              MOVE 'MC2'                       TO TAB-COD-SIST
              MOVE 'RXF'                       TO TAB-COD-TTAB IN TAB
              MOVE SFA-COD-ROLF IN SFA-VARI(1) TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-ICFT IN SFA-FLD.

           MOVE SFA-SGV-VARI IN SFA-VARI TO FRM-SGV-VARI IN SFA-FLD.

           MOVE SFA-COD-ROLF IN SFA-VARI(1) TO
                FRM-COD-RFAC IN SFA-FLD(1).
           MOVE SFA-SGV-PDFT IN SFA-VARI(1) TO
                FRM-SGV-PDFT IN SFA-FLD(1).
           MOVE SFA-SGV-MDFT IN SFA-VARI(1) TO
                FRM-SGV-MDFT IN SFA-FLD(1).
           MOVE SFA-COD-MDFT IN SFA-VARI(1) TO
                FRM-COD-MDFT IN SFA-FLD(1).

           MOVE SFA-COD-ROLF IN SFA-VARI(2) TO
                FRM-COD-RFAC IN SFA-FLD(2).
           MOVE SFA-SGV-PDFT IN SFA-VARI(2) TO
                FRM-SGV-PDFT IN SFA-FLD(2).
           MOVE SFA-SGV-MDFT IN SFA-VARI(2) TO
                FRM-SGV-MDFT IN SFA-FLD(2).
           MOVE SFA-COD-MDFT IN SFA-VARI(2) TO
                FRM-COD-MDFT IN SFA-FLD(2).

           MOVE SFA-COD-ROLF IN SFA-VARI(3) TO
                FRM-COD-RFAC IN SFA-FLD(3).
           MOVE SFA-SGV-PDFT IN SFA-VARI(3) TO
                FRM-SGV-PDFT IN SFA-FLD(3).
           MOVE SFA-SGV-MDFT IN SFA-VARI(3) TO
                FRM-SGV-MDFT IN SFA-FLD(3).
           MOVE SFA-COD-MDFT IN SFA-VARI(3) TO
                FRM-COD-MDFT IN SFA-FLD(3).

           MOVE SFA-COD-ROLF IN SFA-VARI(4) TO
                FRM-COD-RFAC IN SFA-FLD(4).
           MOVE SFA-SGV-PDFT IN SFA-VARI(4) TO
                FRM-SGV-PDFT IN SFA-FLD(4).
           MOVE SFA-SGV-MDFT IN SFA-VARI(4) TO
                FRM-SGV-MDFT IN SFA-FLD(4).
           MOVE SFA-COD-MDFT IN SFA-VARI(4) TO
                FRM-COD-MDFT IN SFA-FLD(4).

           MOVE SFA-COD-ROLF IN SFA-VARI(5) TO
                FRM-COD-RFAC IN SFA-FLD(5).
           MOVE SFA-SGV-PDFT IN SFA-VARI(5) TO
                FRM-SGV-PDFT IN SFA-FLD(5).
           MOVE SFA-SGV-MDFT IN SFA-VARI(5) TO
                FRM-SGV-MDFT IN SFA-FLD(5).
           MOVE SFA-COD-MDFT IN SFA-VARI(5) TO
                FRM-COD-MDFT IN SFA-FLD(5).
       FIN-PUT-TAB-SFA.
           EXIT.
      *------------------------------------------------------
       COPY TABBFUSR.
       COPY TABBBUSR.
       COPY TABBVTDU.
      *PVG INI 24-MAR-2015
       COPY TABBFROC.
      *PVG FIN 24-MAR-2015
       COPY GNSBPFEC.

       COPY MC2BFCFT.
       COPY MC2BFDFT.

       COPY COLBFOPC.
       COPY COLBFDLC.
       COPY COLBFITR.
       COPY COLBFRDC.
       COPY SGCBFDBC.

       COPY MC2BKFCC.
      *>>>>
*% END
