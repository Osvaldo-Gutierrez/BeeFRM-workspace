*%! Codigo adicional para archivo
*% NO_TIENE_TIMESTAMP = FALSE
*% NO_HDR_CST = FALSE
*%! LARGO_TOTAL_COMMAREA = 600
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% LARGO_MI_COMMAREA = 0
*% IF SETTAG
*% VSNPQ = "05.11.21.1"
*% VSNPU = "05.11.21.1"
*% FNCPQ = "MC2-CONVENIO"
*% FNCPU = "MC2-CONVENIO"
*% END
*% IF WSS
      *<<<< WSS                                                         
       COPY GNSWCVRF.                                                   
       COPY GNSWVVRF.                                                   
       COPY GNSBRCIC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.        
       COPY GNSBRMSC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.        
       COPY GNSWGCIC.                                                   
       COPY GNSWGCPT.                                                   
       01  WSS-VARI.                                                    
           03 WSS-GLS-FHIN.                                             
              05 WSS-FEC-FINI.                                          
                 07 WSS-NUM-SINI                        PIC 9(02).      
                 07 WSS-NUM-AINI                        PIC 9(02).      
                 07 WSS-NUM-MINI                        PIC 9(02).      
                 07 WSS-NUM-DINI                        PIC 9(02).      
              05 WSS-HRA-HINI.                                          
                 07 WSS-NUM-HHIN                        PIC 9(02).      
                 07 WSS-NUM-MMIN                        PIC 9(02).      
                 07 WSS-NUM-SSIN                        PIC 9(02).      
           03 WSS-GLS-FHTR.                                             
              05 WSS-FEC-FTER.                                          
                 07 WSS-NUM-STER                        PIC 9(02).      
                 07 WSS-NUM-ATER                        PIC 9(02).      
                 07 WSS-NUM-MTER                        PIC 9(02).      
                 07 WSS-NUM-DTER                        PIC 9(02).      
              05 WSS-HRA-HTER.                                          
                 07 WSS-NUM-HHTR                        PIC 9(02).      
                 07 WSS-NUM-MMTR                        PIC 9(02).      
                 07 WSS-NUM-SSTR                        PIC 9(02).      
           03 WSS-COD-CAUX.                                             
              05 WSS-COD-TOOC                           PIC X(03).      
              05 WSS-COD-AOOC                           PIC X(03).      
           03 WSS-COD-MENY        VALUE SPACES          PIC X(12).      
           03 WSS-COD-MENN        VALUE SPACES          PIC X(12).      
           03 WSS-COD-EVEN.                                             
              05 WSS-COD-SIST                           PIC X(03).      
              05 WSS-COD-EVTO                           PIC X(06).      
           03 WSS-CIC-PPPC.                                             
              05 WSS-GLS-PPPC VALUE 'CIC='              PIC X(04).      
              05 WSS-CPT-CAI                            PIC X(04).      
              05 WSS-CPT-IIC                            PIC X(08).      
           03 WSS-COD-VCAM.                                             
              05 WSS-COD-TVTI                           PIC X(01).      
              05 WSS-COD-CVTI                           PIC X(03).      
              05 WSS-COD-TCTI                           PIC X(02).      
      *                                                                 
           03  WSS-GLS-PCMI.                                            
               05  WSS-NUM-MCMI                         PIC 9(02).      
               05  WSS-NUM-DCMI                         PIC 9(02).      
           03  WSS-GLS-PCMA.                                            
               05  WSS-NUM-MCMA                         PIC 9(02).      
               05  WSS-NUM-DCMA                         PIC 9(02).      
           03  WSS-FEC-RANG.                                            
               05  WSS-NUM-MRAN                         PIC 9(02).      
               05  WSS-NUM-DRAN                         PIC 9(02).      
           03  WSS-NUM-DIGT                             PIC 9(02).      
           03  WSS-NUM-NFEC             VALUE 0         PIC 9(03).      
           03  WSS-FEC-NFE1.                                            
               05  WSS-NUM-DFE1         VALUE 0         PIC 9(02).      
               05  WSS-NUM-MFE1         VALUE 0         PIC 9(02).      
               05  WSS-NUM-SFE1         VALUE 0         PIC 9(02).      
               05  WSS-NUM-AFE1         VALUE 0         PIC 9(02).      
           03  WSS-FEC-NFE2.                                            
               05  WSS-NUM-DFE2         VALUE 0         PIC 9(02).      
               05  WSS-NUM-MFE2         VALUE 0         PIC 9(02).      
               05  WSS-NUM-SFE2         VALUE 0         PIC 9(02).      
               05  WSS-NUM-AFE2         VALUE 0         PIC 9(02).      
           03  WSS-IND-HABC             VALUE 'N'       PIC X(01).      
      *>>>>                                                             
*% END
*% IF INI_FIO
      *<<<< INI_FIO                                                     
      * HABILITACION DE CAMPOS EN PPC                                   
           MOVE 'TAB'                TO FIO-SIST.                       
           MOVE 'TAB'                TO TAB-COD-SIST.                   
           MOVE 'VSN'                TO TAB-COD-TTAB IN TAB.            
           MOVE 'HABCAMPOSPPC'       TO TAB-COD-CTAB IN TAB.            
           MOVE FIO-GET-KEY          TO FIO-CMND.                       
           PERFORM GNS-FIO-TAB.                                         
           IF FIO-STAT-OKS                                              
              MOVE 'S'               TO WSS-IND-HABC IN WSS-VARI        
           ELSE                                                         
              MOVE 'N'               TO WSS-IND-HABC IN WSS-VARI.       
      *>>>>                                                             
*% END
*% IF INI_FND_KEY
      *<<<< FND_KEY                                                     
           PERFORM KEY-ALL-PPC.
           IF SCR-CCPP = 'ING'                                          
               MOVE 'I'                     TO PPC-IND-VIGE IN PPC-FLD  
               MOVE 'GNS'                   TO TAB-COD-SIST             
               MOVE 'STT'                   TO TAB-COD-TTAB IN TAB      
               MOVE PPC-IND-VIGE IN PPC-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DCOR IN TAB     TO FRM-GLS-VIGE IN PPC-FLD. 
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY                                                 
           IF NOT FIO-STAT-OKS                                          
               MOVE '23' TO PGM-STAT-PPC                                
           ELSE                                                         
               MOVE '00' TO PGM-STAT-PPC.                               
      *>>>>                                                             
*% END
*% IF EOF_PQ
      *<<<< EOF                                                         
       OBT-CIC-PPC SECTION.                                             
       INI-OBT-CIC-PPC.                                                 
           MOVE 'PPPC'  TO CIC-CAI-ICIC IN CIC.                         
           MOVE CIC-GET TO CIC-CMND.                                    
           PERFORM PRO-CIC.                                             
           IF CIC-STAT NOT = CIC-STAT-OKS                               
               MOVE CIC-MENS     TO FRM-MENS                            
               MOVE FIO-STAT-NEX TO FIO-STAT                            
           ELSE                                                         
               MOVE CIC-CAI-ICIC TO WSS-CPT-CAI                         
               MOVE CIC-IIC-ICIC TO WSS-CPT-IIC                         
               MOVE WSS-CIC-PPPC TO FRM-MEN1.                           
       FIN-OBT-CIC-RCC.                                                 
           EXIT.                                                        
                                                                        
       COPY GNSBGCIC.                                                   
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBBTAB.                                                   
       COPY GNSBFMSC.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBGVSM.                                                   
       COPY GNSBGCPT.                                                   
       COPY GNSBFCIC.                                                   
       COPY GNSBPVRF.                                                   
      *>>>>                                                             
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD                                                 
           IF PPC-IND-VIGE IN PPC-FLD = 'A'                             
               MOVE 'S'            TO SCR-IERR                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'PPCACA NOMOD' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
           IF PPC-IND-VIGE IN PPC-FLD = 'D'                             
               MOVE 'S'            TO SCR-IERR                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'RCCANL NOMOD' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
           MOVE 'I' TO PPC-IND-VIGE IN PPC-FLD.                         
      *>>>>                                                             
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD                                                 
           MOVE 'TAB'               TO FIO-SIST.                        
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.             
           MOVE PPC-CIC-IPPC IN PPC TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
           MOVE FRM-COD-PPC1 IN PPC-FLD TO TAB-GLS-DESC IN TAB.         
           MOVE FRM-COD-PPC2 IN PPC-FLD TO TAB-GLS-DATA IN TAB.         
           PERFORM GET-FHOY.                                            
           MOVE HOY-FHOY                 TO TAB-FEC-FTRN IN TAB.        
           MOVE HOY-HHOY                 TO TAB-HRA-HRTR IN TAB.        
           MOVE SCR-OTRN                 TO TAB-COD-OTRN IN TAB.        
           MOVE SCR-USER                 TO TAB-COD-ATRN IN TAB.        
                                                                        
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
      *>>>>                                                             
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING                                                 
           PERFORM OBT-CIC-PPC.                                         
           IF CIC-STAT NOT = CIC-STAT-OKS                               
              GO TO FIN-CMN-ING.                                        
           MOVE CIC-CAI-ICIC IN CIC TO PPC-CAI-ICIC IN PPC.             
           MOVE CIC-IIC-ICIC IN CIC TO PPC-IIC-ICIC IN PPC.             
           MOVE CIC-CAI-ICIC IN CIC TO PPC-CAI-ICIC IN PPC-FLD.         
           MOVE CIC-IIC-ICIC IN CIC TO PPC-IIC-ICIC IN PPC-FLD.         
           MOVE 'TAB'                   TO FIO-SIST.                    
           MOVE 'DPL'                   TO TAB-COD-TTAB IN TAB          
           MOVE PPC-CIC-ICIC IN PPC     TO TAB-COD-CTAB IN TAB.         
           MOVE FRM-COD-PPC1 IN PPC-FLD TO TAB-GLS-DESC IN TAB.         
           MOVE FRM-COD-PPC2 IN PPC-FLD TO TAB-GLS-DATA IN TAB.         
           MOVE 'I'                     TO TAB-MSC-TACC IN TAB.         
           MOVE 'I'                     TO TAB-MSC-STAT IN TAB.         
           MOVE 'S'                     TO TAB-IND-VIGE IN TAB.         
           MOVE SPACES                  TO TAB-COD-OTRN IN TAB.         
           MOVE 'MC2PUPPC'              TO TAB-COD-ATRN IN TAB.         
           MOVE PPC-CIC-ICIC IN PPC     TO TAB-GLS-DCOR IN TAB.         
           MOVE PPC-CAI-ICIC IN PPC     TO TAB-GLS-ABRV IN TAB.         
           PERFORM GET-FHOY.                                            
           MOVE HOY-FHOY                 TO TAB-FEC-FTRN IN TAB.        
           MOVE HOY-HHOY                 TO TAB-HRA-HRTR IN TAB.        
           MOVE SCR-OTRN                 TO TAB-COD-OTRN IN TAB.        
           MOVE SCR-USER                 TO TAB-COD-ATRN IN TAB.        
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'TAB'               TO MSG-COD-SIST                  
              MOVE 'DPL    NOGRB'      TO MSG-COD-MENS                  
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC        TO FRM-MENS.                     
      *>>>>                                                             
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING                                                 
           IF NOT (FIO-STAT-OKS AND SCR-OFRM-SRV)                       
                 GO TO FIN-CMN-ING.                                     
      *>>>>                                                             
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC                                                 
           IF SCR-CMND = 'VRF' AND                                      
              PPC-IND-VIGE IN PPC-FLD NOT = 'I'                         
               MOVE 'S'            TO SCR-IERR                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'PPCNOI NOVRF' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               GO TO FIN-CMN-ACC.                                       
                                                                        
           IF SCR-CMND = 'ACA' AND                                      
              PPC-IND-VIGE IN PPC-FLD NOT = 'V'                         
               MOVE 'S'            TO SCR-IERR                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'PPCNOV NOACA' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               GO TO FIN-CMN-ACC.                                       
                                                                        
           IF SCR-CMND = 'ANL' AND                                      
              PPC-IND-VIGE IN PPC-FLD NOT = 'A'                         
               MOVE 'S'            TO SCR-IERR                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'PPCNOA NOANL' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               GO TO FIN-CMN-ACC.                                       
      *>>>>                                                             
*% END
*% IF CMN_ACC_RET
      *<<<< CMN_ACC_RET                                                 
           IF SCR-CMND = 'VRF'                                          
               MOVE 'V' TO PPC-IND-VIGE IN PPC                          
               MOVE 'VRFYES    ' TO WSS-COD-MENY                        
               MOVE 'VRFNOT    ' TO WSS-COD-MENN                        
           ELSE                                                         
           IF SCR-CMND = 'ACA'                                          
               MOVE 'A' TO PPC-IND-VIGE IN PPC                          
               MOVE 'ACAYES    ' TO WSS-COD-MENY                        
               MOVE 'ACANOT    ' TO WSS-COD-MENN                        
           ELSE                                                         
           IF SCR-CMND = 'ANL'                                          
               MOVE 'D' TO PPC-IND-VIGE IN PPC                          
               MOVE 'ANLYES    ' TO WSS-COD-MENY                        
               MOVE 'ANLNOT    ' TO WSS-COD-MENN.                       
      *>>>>                                                             
      *<<<< CMN_ACC                                                     
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM MC2-FIO-PPC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'          TO SCR-IERR                            
               MOVE 'TAB'        TO MSG-COD-SIST                        
               MOVE WSS-COD-MENN TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
           ELSE                                                         
               MOVE 'GNS'         TO MSG-COD-SIST                       
               MOVE WSS-COD-MENY  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC  TO FRM-MEN1.                          
           GO TO FIN-CMN-ACC.
      *>>>>                                                             
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI                                                 
           IF PPC-IND-VIGE IN PPC-FLD = 'A'                             
               MOVE 'S'            TO SCR-IERR                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'PPCACA NOELI' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               GO TO FIN-CMN-ELI.                                       
                                                                        
           IF PPC-IND-VIGE IN PPC-FLD = 'D'                             
               MOVE 'S'            TO SCR-IERR                          
               MOVE 'TAB'          TO MSG-COD-SIST                      
               MOVE 'PPCANL NOELI' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC   TO FRM-MENS                          
               GO TO FIN-CMN-ELI.                                       
      *>>>>                                                             
*% END
*% IF EOF_PU
      *<<<< EOF                                                         
       OBT-CIC-PPC SECTION.                                             
       INI-OBT-CIC-PPC.                                                 
           MOVE 'PPPC'  TO CIC-CAI-ICIC IN CIC.                         
           MOVE CIC-GET TO CIC-CMND.                                    
           PERFORM PRO-CIC.                                             
           IF CIC-STAT NOT = CIC-STAT-OKS                               
               MOVE CIC-MENS     TO FRM-MENS                            
               MOVE FIO-STAT-NEX TO FIO-STAT                            
           ELSE                                                         
               MOVE CIC-CAI-ICIC TO WSS-CPT-CAI                         
               MOVE CIC-IIC-ICIC TO WSS-CPT-IIC                         
               MOVE WSS-CIC-PPPC TO FRM-MEN1.                           
       FIN-OBT-CIC-RCC.                                                 
           EXIT.                                                        
                                                                        
       VAL-FEC-RANGO SECTION.                                           
       INI-VAL-FEC-RANGO.                                               
           IF WSS-NUM-MRAN = 02                                         
                IF WSS-NUM-DRAN NOT < 0 AND WSS-NUM-DRAN < 30           
                    GO TO FIN-VAL-FEB                                   
                ELSE                                                    
                    MOVE 'DIANORANGO' TO MSG-COD-MENS                   
                    MOVE FRM-SUAR-MAL TO FRM-SUAR                       
                    GO TO FIN-VAL-FEC-RANGO.                            
       FIN-VAL-FEB.                                                     
           IF WSS-NUM-MRAN NOT < 0 AND WSS-NUM-MRAN < 13                
               IF WSS-NUM-MRAN = 00 OR                                  
                  WSS-NUM-MRAN = 01 OR                                  
                  WSS-NUM-MRAN = 03 OR                                  
                  WSS-NUM-MRAN = 05 OR                                  
                  WSS-NUM-MRAN = 07 OR                                  
                  WSS-NUM-MRAN = 08 OR                                  
                  WSS-NUM-MRAN = 10 OR                                  
                  WSS-NUM-MRAN = 12                                     
                   IF WSS-NUM-DRAN NOT < 0 AND WSS-NUM-DRAN < 32        
                       GO TO FIN-VAL-FEC-RANGO                          
                   ELSE                                                 
                       MOVE 'DIANORANGO' TO MSG-COD-MENS                
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                       GO TO FIN-VAL-FEC-RANGO                          
               ELSE                                                     
                   IF WSS-NUM-DRAN NOT < 0 AND WSS-NUM-DRAN < 31        
                       GO TO FIN-VAL-FEC-RANGO                          
                   ELSE                                                 
                       MOVE 'DIANORANGO' TO MSG-COD-MENS                
                       MOVE FRM-SUAR-MAL TO FRM-SUAR                    
                       GO TO FIN-VAL-FEC-RANGO                          
           ELSE                                                         
               MOVE 'MESNORANGO' TO MSG-COD-MENS                        
               MOVE FRM-SUAR-MAL TO FRM-SUAR.                           
       FIN-VAL-FEC-RANGO.                                               
           EXIT.                                                        
       COPY GNSBVIND.                                                   
       COPY GNSBVMSC.                                                   
       COPY GNSBPFEC.                                                   
       COPY GNSBGCIC.                                                   
      *>>>>                                                             
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBBTAB.                                                   
       COPY GNSBFMSC.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBGVSM.                                                   
       COPY GNSBGCPT.                                                   
       COPY GNSBFCIC.                                                   
       COPY GNSBPVRF.                                                   
      *>>>>                                                             
*% END
