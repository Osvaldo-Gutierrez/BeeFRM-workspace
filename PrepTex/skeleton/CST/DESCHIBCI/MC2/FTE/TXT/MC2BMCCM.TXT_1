*%! Codigo adicional para archivo
*% IF INI_FST_FLD_CCM
      *<<<< INI_FST_FLD_CCM
           GO TO CNT-FST-FLD-CCM.
      *>>>>
*% END
*% IF FIN_CLR_KEY_CCM
      *<<<<
           MOVE ZEROES TO CCM-HRA-HINI IN CCM-FLD.                      
      *>>>>                                              
*% END
*% IF FIN_UNP_DCM_CCM
      *<<<<                                                             
           IF CCM-IND-TPLT IN CCM-FLD NOT = 'P'                         
              MOVE FRM-CPIM-AEY TO DCM-COD-ECCM-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-COD-OCOB-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-IND-COBL-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-NUM-UCOB-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-COD-CPTO-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-IND-MIVA-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-VAL-VMIN-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-VAL-VMAX-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-COD-VMYM-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-NUM-CMAX-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-IND-ACAL-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-MSC-BCTI-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-MSC-PBTI-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-MSC-BPBT-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-MSC-SPBT-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-COD-CVTI-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-MSC-TFPR-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-NUM-PREP-ATR IN CCM-FLD          
              MOVE FRM-CPIM-AEY TO DCM-MSC-UTPR-ATR IN CCM-FLD.         
      *>>>>                                                             
*% END
*% IF FIN_FST_FLD_CCM
      *<<<< FIN_FST_FLD_CCM
       CNT-FST-FLD-CCM.
           IF SCR-CMND NOT = 'ING'
              MOVE -1           TO FRM-GLS-DES1-LEN IN CCM-FLD
              GO TO FIN-FST-FLD-CCM.
           IF FRM-GLS-DES1 IN CCM-FLD > SPACES
              MOVE FRM-CPIM-AEY TO FRM-GLS-DES1-ATR IN CCM-FLD
              MOVE FRM-CPIM-AEY TO FRM-GLS-DES2-ATR IN CCM-FLD
           ELSE
              MOVE -1           TO FRM-GLS-DES1-LEN IN CCM-FLD.
           IF CCM-IND-DSCT IN CCM-FLD > SPACES
              MOVE FRM-CPIM-AEY TO CCM-IND-DSCT-ATR IN CCM-FLD
           ELSE
              MOVE -1           TO CCM-IND-DSCT-LEN IN CCM-FLD.
           IF CCM-IND-CAAB IN CCM-FLD > SPACES
              MOVE FRM-CPIM-AEY TO CCM-IND-CAAB-ATR IN CCM-FLD
           ELSE
              MOVE -1           TO CCM-IND-CAAB-LEN IN CCM-FLD.
           IF FRM-GLS-DES1 IN CCM-FLD > SPACES AND
              CCM-IND-DSCT IN CCM-FLD > SPACES AND
              CCM-IND-CAAB IN CCM-FLD > SPACES
              MOVE -1           TO DCM-COD-TCCM-LEN IN CCM-FLD.
      *>>>>
*% END
*% IF FIN_PUT_CCM_CCM
      *<<<< FIN_PUT_CCM_CCM
           IF CCM-COD-SIST IN CCM-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'SIS'                    TO TAB-COD-TTAB IN TAB
              MOVE CCM-COD-SIST IN CCM-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-SIST IN CCM-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-SIST IN CCM-FLD.
           IF CCM-COD-EVEN IN CCM-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB
              MOVE CCM-COD-SIST IN CCM-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE CCM-COD-EVEN IN CCM-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-EVEN IN CCM-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-EVEN IN CCM-FLD.
           IF CCM-COD-VCOC IN CCM-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'VLR'                    TO TAB-COD-TTAB IN TAB
              MOVE CCM-COD-VCOC IN CCM-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-VCOC IN CCM-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-VCOC IN CCM-FLD.

           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.
           MOVE CCM-CIC-ICCM IN CCM TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DES1 IN CCM-FLD.
           MOVE TAB-GLS-DATA IN TAB TO FRM-GLS-DES2 IN CCM-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DCM_CCM
      *<<<< FIN_PUT_DCM_CCM
           MOVE 'TAB'               TO TAB-COD-SIST.
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.
           MOVE DCM-CIC-IDCM IN DCM TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-DES1 IN CCM-FLD.
           MOVE TAB-GLS-DATA IN TAB TO FRM-GLS-DES2 IN CCM-FLD.

           IF DCM-COD-TCCM IN CCM-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'CMS'                    TO TAB-COD-TTAB IN TAB
              MOVE DCM-COD-TCCM IN CCM-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-TCCM IN CCM-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-TCCM IN CCM-FLD.
           IF DCM-COD-ECCM IN CCM-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'FCA'                    TO TAB-COD-TTAB IN TAB
              MOVE DCM-COD-ECCM IN CCM-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-ECCM IN CCM-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-ECCM IN CCM-FLD.
           IF DCM-COD-OCOB IN CCM-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'OCS'                    TO TAB-COD-TTAB IN TAB
              MOVE DCM-COD-OCOB IN CCM-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB      TO FRM-GLS-OCOB IN CCM-FLD
           ELSE
              MOVE SPACES                   TO FRM-GLS-OCOB IN CCM-FLD.
           IF DCM-IND-UTPT IN CCM-FLD > SPACES
              MOVE 'TAB'                   TO MSC-COD-SIST
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC
              MOVE DCM-IND-UTPT IN CCM-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-UTPT IN CCM-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-UTPT IN CCM-FLD.
           IF DCM-IND-UTET IN CCM-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'ERA'                   TO TAB-COD-TTAB IN TAB
              MOVE DCM-IND-UTET IN CCM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB     TO FRM-GLS-UTET IN CCM-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-UTET IN CCM-FLD.
           IF DCM-MSC-BCTI IN CCM-FLD > SPACES
              MOVE 'COL'                   TO MSC-COD-SIST
              MOVE 'BCTI'                  TO MSC-COD-TMSC IN MSC
              MOVE DCM-MSC-BCTI IN CCM-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-BCTI IN CCM-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-BCTI IN CCM-FLD.
           IF DCM-MSC-PBTI IN CCM-FLD > SPACES
              MOVE 'COL'                   TO MSC-COD-SIST
              MOVE 'PBTI'                  TO MSC-COD-TMSC IN MSC
              MOVE DCM-MSC-PBTI IN CCM-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-PBTI IN CCM-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-PBTI IN CCM-FLD.
           IF DCM-MSC-BPBT IN CCM-FLD > SPACES
              MOVE 'COL'                   TO MSC-COD-SIST
              MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC
              MOVE DCM-MSC-BPBT IN CCM-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-BPBT IN CCM-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-BPBT IN CCM-FLD.
           IF DCM-MSC-SPBT IN CCM-FLD > SPACES
              MOVE 'COL'                   TO MSC-COD-SIST
              MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC
              MOVE DCM-MSC-SPBT IN CCM-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-SPBT IN CCM-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-SPBT IN CCM-FLD.
           IF DCM-MSC-TFPR IN CCM-FLD > SPACES
              MOVE 'COL'                   TO MSC-COD-SIST
              MOVE 'TFPR'                  TO MSC-COD-TMSC IN MSC
              MOVE DCM-MSC-TFPR IN CCM-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-TFPR IN CCM-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-TFPR IN CCM-FLD.
           IF DCM-MSC-UTPR IN CCM-FLD > SPACES
              MOVE 'COL'                   TO MSC-COD-SIST
              MOVE 'TFPR'                  TO MSC-COD-TMSC IN MSC
              MOVE DCM-MSC-UTPR IN CCM-FLD TO MSC-COD-CMSC IN MSC
              PERFORM BUS-MSC
              MOVE MSC-GLS-DCOR IN MSC     TO FRM-GLS-UTPR IN CCM-FLD
           ELSE
              MOVE SPACES                  TO FRM-GLS-UTPR IN CCM-FLD.
      *>>>>
*% END
*% IF CCM_COD_SIST
      *<<<< CCM_COD_SIST
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.
           MOVE CCM-COD-SIST IN CCM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
              MOVE SPACES       TO FRM-GLS-SIST IN CCM-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-SIST IN CCM-FLD.
      *>>>>
*% END
*% IF CCM_COD_EVEN
      *<<<< CCM_COD_EVEN
      *VAL-COD Valida codigo de tabla
           IF CCM-COD-EVEN IN CCM-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'EVT'                    TO TAB-COD-TTAB IN TAB
              MOVE CCM-COD-SIST IN CCM-FLD  TO WSS-COD-SIST IN WSS-VARI
              MOVE CCM-COD-EVEN IN CCM-FLD  TO WSS-COD-EVTO IN WSS-VARI
              MOVE WSS-COD-EVEN IN WSS-VARI TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
              IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
                 MOVE SPACES       TO FRM-GLS-EVEN IN CCM-FLD
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
              ELSE
                 MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-EVEN IN CCM-FLD.
      *>>>>
*% END
*% IF CCM_IND_TPLT
      *<<<< CCM_IND_TPLT
           IF CCM-IND-TPLT IN CCM-FLD NOT > SPACES
              MOVE 'P'    TO CCM-IND-TPLT IN CCM-FLD
              GO TO FIN-VAL-CCM-IND-TPLT.
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'TDP'                   TO TAB-COD-TTAB IN TAB.
           MOVE CCM-IND-TPLT IN CCM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-TAB.
           IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
              MOVE 'GNS'        TO MSG-COD-SIST
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN2
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'ERR    TDP' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC IN MSG TO FRM-MEN1
              MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF INI_CCM_FEC_FINI
      *<<<< INI_CCM_FEC_FINI
           MOVE FEC-CHOY-N TO FEC-CHOY.
           IF (SCR-CMND = 'ING' OR 'MOD' OR 'VRF' OR 'ACA')
   	           MOVE FEC-CHOY-GE TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           IF CCM-FEC-FINI IN CCM-FLD NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-DHOY IN HOY-VARI TO CCM-NUM-DINI IN CCM-FLD
              MOVE HOY-MHOY IN HOY-VARI TO CCM-NUM-MINI IN CCM-FLD
              MOVE HOY-SHOY IN HOY-VARI TO CCM-NUM-SINI IN CCM-FLD
              MOVE HOY-AHOY IN HOY-VARI TO CCM-NUM-AINI IN CCM-FLD
              IF CCM-HRA-HINI IN CCM-FLD NOT > ZEROES
                 MOVE HOY-HHOY IN HOY-VARI TO CCM-HRA-HINI IN CCM-FLD
                 GO TO FIN-VAL-CCM-FEC-FINI
              ELSE
                 GO TO FIN-VAL-CCM-FEC-FINI.
      *>>>>
*% END
*% IF CCM_HRA_HINI
      *<<<< CCM_HRA_HINI
           IF CCM-HRA-HINI IN CCM-FLD NOT > SPACES                      
              MOVE ZEROES TO CCM-HRA-HINI IN CCM-FLD.                   
           IF CCM-HRA-HINI IN CCM-FLD NOT > ZEROES
              PERFORM GET-FHOY
              MOVE HOY-HHOY IN HOY-VARI TO CCM-HRA-HINI IN CCM-FLD
              GO TO FIN-VAL-CCM-HRA-HINI.
           MOVE CCM-HRA-HINI IN CCM-FLD TO CCM-HRA-HINI IN CCM.
           IF CCM-NUM-HHIN IN CCM < ZEROES OR
              CCM-NUM-HHIN IN CCM > 23
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CCM-HRA-HINI.
           IF CCM-NUM-MMIN IN CCM < ZEROES OR
              CCM-NUM-MMIN IN CCM > 59
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'NUMMMTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CCM-HRA-HINI.
           IF CCM-NUM-SSIN IN CCM < ZEROES OR
              CCM-NUM-SSIN IN CCM > 59
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'NUMSSTRNOVA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CCM-HRA-HINI.
      *>>>>
*% END
*% IF CCM_COD_VCOC
      *<<<< CCM_COD_VCOC
           IF CCM-COD-VCOC IN CCM-FLD NOT > SPACES
              GO TO FIN-VAL-CCM-COD-VCOC.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE CCM-COD-VCOC IN CCM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')
              MOVE SPACES       TO FRM-GLS-VCOC IN CCM-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VCOC IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_NUM_IDCM
      *<<<< DCM_NUM_IDCM
           IF SCR-CMND = 'MOD'
              IF DCM-NUM-IDCM IN CCM-FLD NOT > ZEROES
                 MOVE 'TAB'          TO MSG-COD-SIST
                 MOVE 'NUMCCM   OBL' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-DCM-NUM-IDCM.

           MOVE 'N' TO SCR-IND-ELI IN SCR-VARI.
           IF SCR-CMND = 'ELI' AND DCM-NUM-IDCM IN CCM-FLD = 999
              MOVE ZEROES TO DCM-NUM-IDCM IN CCM-FLD
              MOVE 'S'    TO SCR-IND-ELI IN SCR-VARI.
      *>>>>
*% END
*% IF CCM_IND_DSCT
      *<<<< CCM_IND_DSCT
      *VAL-COD Valida codigo de tabla
            MOVE 'GNS'                   TO TAB-COD-SIST.
            MOVE 'SON'                   TO TAB-COD-TTAB IN TAB.
            MOVE CCM-IND-DSCT IN CCM-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
      *>>>>
*% END
*% IF CCM_IND_CAAB
      *<<<< CCM_IND_CAAB
      *VAL-COD Valida codigo de tabla
            MOVE 'TAB'                   TO TAB-COD-SIST.
            MOVE 'MOV'                   TO TAB-COD-TTAB IN TAB.
            MOVE CCM-IND-CAAB IN CCM-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
      *>>>>
*% END
*% IF DCM_COD_TCCM
      *<<<< DCM_COD_TCCM
      *VAL-COD Valida codigo de tabla
            MOVE 'TAB'                   TO TAB-COD-SIST.
            MOVE 'CMS'                   TO TAB-COD-TTAB IN TAB.
            MOVE DCM-COD-TCCM IN CCM-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
            IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TCCM IN CCM-FLD
            ELSE
               MOVE SPACES              TO FRM-GLS-TCCM IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_COD_ECCM
      *<<<< DCM_COD_ECCM
      *VAL-COD Valida codigo de tabla
            MOVE 'TAB'                   TO TAB-COD-SIST.
            MOVE 'FCA'                   TO TAB-COD-TTAB IN TAB.
            MOVE DCM-COD-ECCM IN CCM-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
            IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-ECCM IN CCM-FLD
            ELSE
               MOVE SPACES              TO FRM-GLS-ECCM IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_COD_OCOB
      *<<<< DCM_COD_OCOB
      *VAL-COD Valida codigo de tabla
            MOVE 'TAB'                   TO TAB-COD-SIST.
            MOVE 'OCS'                   TO TAB-COD-TTAB IN TAB.
            MOVE DCM-COD-OCOB IN CCM-FLD TO TAB-COD-CTAB IN TAB.
            PERFORM VAL-COD.
            IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-OCOB IN CCM-FLD
            ELSE
               MOVE SPACES              TO FRM-GLS-OCOB IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_IND_COBL
      *<<<< DCM_IND_COBL
      *VAL-COD Valida codigo de tabla
           IF DCM-IND-COBL IN CCM-FLD > SPACES
              MOVE 'GNS'                   TO TAB-COD-SIST
              MOVE 'SON'                   TO TAB-COD-TTAB IN TAB
              MOVE DCM-IND-COBL IN CCM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
           ELSE
              MOVE 'S' TO DCM-IND-COBL IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_SGV_TAMO
      *<<<< DCM_SGV_TAMO
           IF DCM-SGV-TAMO IN CCM-FLD > ZEROES AND
              DCM-COD-ECCM IN CCM-FLD = 'INF'
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'SGVTAMOINV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-SGV-TAMO.

           IF DCM-SGV-TAMO IN CCM-FLD NOT > ZEROES
              IF ((DCM-COD-ECCM IN CCM-FLD = 'FAC' OR 'TAS') OR         
                 (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')) 
                 MOVE 'TAB'        TO MSG-COD-SIST
                 MOVE 'SGVTAMOOBL' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-DCM-SGV-TAMO.
      *>>>>
*% END
*% IF DCM_COD_VCOC
      *<<<< DCM_COD_VCOC
           IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'X')                   
              IF (DCM-COD-VCOC IN CCM-FLD > SPACES)                     
                 MOVE 'TAB'        TO MSG-COD-SIST                      
                 MOVE 'MON    INV' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DCM-COD-VCOC                             
              ELSE                                                      
                 GO TO FIN-VAL-DCM-COD-VCOC.                            
                                                                        
           IF (CCM-IND-TPLT IN CCM-FLD = 'M' OR 'Y')                    
              IF (DCM-COD-VCOC IN CCM-FLD = 'P' OR 'M')                 
                 MOVE 'TAB'        TO MSG-COD-SIST                      
                 MOVE 'MON    INV' TO MSG-COD-MENS                      
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DCM-COD-VCOC.                            
                                                                        
           IF DCM-SGV-TAMO IN CCM-FLD > ZEROES AND
              DCM-COD-VCOC IN CCM-FLD NOT > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CODVCOCOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-COD-VCOC.

           IF (DCM-COD-ECCM IN CCM-FLD = 'INF' AND                      
               DCM-COD-VCOC IN CCM-FLD > SPACES)                        
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'MON    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-COD-VCOC.

           IF DCM-COD-ECCM IN CCM-FLD = 'MFI' AND
              (DCM-COD-VCOC IN CCM-FLD = 'P' OR
               DCM-COD-VCOC IN CCM-FLD = 'M')
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'MON    NOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DCM-COD-VCOC.

           IF (DCM-COD-ECCM IN CCM-FLD = 'TAS' OR 'FAC')
              IF DCM-COD-VCOC IN CCM-FLD NOT = 'P' AND
                 DCM-COD-VCOC IN CCM-FLD NOT = 'M'
                 MOVE 'TAB'        TO MSG-COD-SIST
                 MOVE 'MON    DBP' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-DCM-COD-VCOC.
           IF DCM-COD-VCOC IN CCM-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB
              MOVE DCM-COD-VCOC IN CCM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF DCM_COD_CPTO
      *<<<< DCM_COD_CPTO
           IF DCM-COD-CPTO IN CCM-FLD > SPACES                          
              IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')  
                 MOVE 'TAB'         TO MSG-COD-SIST                     
                 MOVE 'CPTO    INV' TO MSG-COD-MENS                     
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC  TO FRM-MENS                         
                 MOVE FRM-SUAR-MAL  TO FRM-SUAR                         
                 GO TO FIN-VAL-DCM-COD-CPTO.                            
                                                                        
           IF (DCM-COD-ECCM IN CCM-FLD = 'TAS' OR 'FAC')                
              IF DCM-COD-CPTO IN CCM-FLD NOT > SPACES                   
                 MOVE 'TAB'        TO MSG-COD-SIST
                 MOVE 'CODCPTOOBL' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-DCM-COD-CPTO.

           IF (DCM-COD-ECCM IN CCM-FLD = 'MFI' OR 'INF')
              IF DCM-COD-CPTO IN CCM-FLD > SPACES
                 MOVE 'TAB'         TO MSG-COD-SIST
                 MOVE 'CPTO    INV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FRM-SUAR-MAL TO FRM-SUAR
                 GO TO FIN-VAL-DCM-COD-CPTO.

           IF DCM-COD-CPTO IN CCM-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'CTO'                   TO TAB-COD-TTAB IN TAB
              MOVE DCM-COD-CPTO IN CCM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF DCM_IND_MIVA
      *<<<< DCM_IND_MIVA
      *VAL-COD Valida codigo de tabla
           IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')     
              IF DCM-IND-MIVA IN CCM-FLD > SPACES                       
                 MOVE 'TAB'         TO MSG-COD-SIST                     
                 MOVE 'MIVA    INV' TO MSG-COD-MENS                     
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC TO FRM-MENS                          
                 MOVE FRM-SUAR-MAL TO FRM-SUAR                          
                 GO TO FIN-VAL-DCM-IND-MIVA                             
              ELSE                                                      
                 GO TO FIN-VAL-DCM-IND-MIVA                             
           ELSE                                                         
           IF DCM-IND-MIVA IN CCM-FLD > SPACES
              MOVE 'GNS'                   TO TAB-COD-SIST
              MOVE 'SON'                   TO TAB-COD-TTAB IN TAB
              MOVE DCM-IND-MIVA IN CCM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD
           ELSE
              MOVE 'N' TO DCM-IND-MIVA IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_COD_VCMT
      *<<<< DCM_COD_VCMT
           IF (DCM-COD-VCMT IN CCM-FLD = 'P' OR 'M')
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'MON    NOP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DCM-COD-VCMT.

           IF DCM-VAL-MTOP IN CCM-FLD > ZEROES AND
              DCM-COD-VCMT IN CCM-FLD NOT > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODVTOPOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DCM-COD-VCMT.

           IF DCM-VAL-MTOP IN CCM-FLD NOT > ZEROES AND
              DCM-COD-VCMT IN CCM-FLD > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODVTOPNVL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DCM-COD-VCMT.

           IF DCM-COD-VCMT IN CCM-FLD > SPACES
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB
              MOVE DCM-COD-VCMT IN CCM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF DCM_COD_CPMT
      *<<<< DCM_COD_CPMT
           IF DCM-VAL-MTOP IN CCM-FLD > ZEROES AND
              DCM-COD-CPMT IN CCM-FLD NOT > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CODCPTTOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-COD-CPMT.

           IF DCM-VAL-MTOP IN CCM-FLD NOT > ZEROES AND
              DCM-COD-CPMT IN CCM-FLD > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CODCPTTNVL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-COD-CPMT.

           IF DCM-COD-CPMT IN CCM-FLD > SPACES
              MOVE 'TAB'                    TO TAB-COD-SIST
              MOVE 'CTO'                    TO TAB-COD-TTAB IN TAB
              MOVE DCM-COD-CPMT IN CCM-FLD  TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF DCM_IND_UTPT
      *<<<< DCM_IND_UTPT
           IF DCM-NUM-PTOP IN CCM-FLD > ZEROES AND
              DCM-IND-UTPT IN CCM-FLD NOT > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'INDUTPZOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-IND-UTPT.

           IF DCM-NUM-PTOP IN CCM-FLD NOT > ZEROES AND
              DCM-IND-UTPT IN CCM-FLD > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'INDUTPZNVL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-IND-UTPT.

           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           MOVE DCM-IND-UTPT IN CCM-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF DCM_MSC_UTVD
      *<<<< DCM_MSC_UTVD
           IF DCM-NUM-VIGD IN CCM-FLD > ZEROES AND
              DCM-MSC-UTVD IN CCM-FLD NOT > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'MSCUTVDOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-UTVD.

           IF DCM-NUM-VIGD IN CCM-FLD NOT > ZEROES AND
              DCM-MSC-UTVD IN CCM-FLD > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'MSCUTVDINV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-UTVD.

           MOVE 'TAB'                   TO MSC-COD-SIST.
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.
           MOVE DCM-MSC-UTVD IN CCM-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *>>>>
*% END
*% IF DCM_IND_UTET
      *<<<< DCM_IND_UTET
           IF DCM-NUM-ETOP IN CCM-FLD > ZEROES AND
              DCM-IND-UTET IN CCM-FLD NOT > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'INDEDRAOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-IND-UTET.

           IF DCM-NUM-ETOP IN CCM-FLD NOT > ZEROES AND
              DCM-IND-UTET IN CCM-FLD > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'INDEDRAOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-IND-UTET.

           IF DCM-IND-UTET IN CCM-FLD NOT > SPACES
               GO TO FIN-VAL-DCM-IND-UTET.

           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'ERA'                   TO TAB-COD-TTAB IN TAB.
           MOVE DCM-IND-UTET IN CCM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF DCM_VAL_VMIN
      *<<<< DCM_VAL_VMIN
           IF ((DCM-COD-VMYM IN CCM-FLD = 'P' OR 'M') AND
              (DCM-VAL-VMIN IN CCM-FLD < ZEROES OR
              DCM-VAL-VMIN IN CCM-FLD > 100 ))
              MOVE 'TAB' TO MSG-COD-SIST
              MOVE 'MNTO PORC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-VAL-VMIN.
      *>>>>
*% END
*% IF DCM_VAL_VMAX
      *<<<< DCM_VAL_VMAX
           IF ((DCM-COD-VMYM IN CCM-FLD = 'P' OR 'M') AND
               (DCM-VAL-VMAX IN CCM-FLD < ZEROES OR
              DCM-VAL-VMAX IN CCM-FLD > 100 ))
              MOVE 'TAB'       TO MSG-COD-SIST
              MOVE 'MNTO PORC' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-VAL-VMAX.

           IF DCM-VAL-VMAX IN CCM-FLD > ZEROES AND
              DCM-VAL-VMAX IN CCM-FLD < DCM-VAL-VMIN IN CCM-FLD
              MOVE 'TAB'         TO MSG-COD-SIST
              MOVE 'MNTOMAX<MIN' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-VAL-VMAX.
      *>>>>
*% END
*% IF DCM_COD_VMYM
      *<<<< DCM_COD_VMYM
           IF DCM-VAL-VMIN IN CCM-FLD NOT > ZEROES AND                  
              DCM-VAL-VMAX IN CCM-FLD NOT > ZEROES AND                  
              DCM-COD-VMYM IN CCM-FLD > SPACES                          
              MOVE 'TAB'         TO MSG-COD-SIST                        
              MOVE 'VMYM    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DCM-COD-VMYM.                               
                                                                        
           IF DCM-COD-ECCM IN CCM-FLD = 'MFI' AND                       
              (DCM-COD-VMYM IN CCM-FLD = 'P' OR 'M')                    
              MOVE 'TAB'         TO MSG-COD-SIST
              MOVE 'VMYM    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-COD-VMYM.

           IF ( DCM-VAL-VMIN IN CCM-FLD > ZEROES OR
                DCM-VAL-VMAX IN CCM-FLD > ZEROES ) AND
                DCM-COD-VMYM IN CCM-FLD NOT > SPACES
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CODVMYMOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DCM-COD-VMYM.

           IF DCM-COD-VMYM IN CCM-FLD NOT > SPACES
               GO TO FIN-VAL-DCM-COD-VMYM.

           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE DCM-COD-VMYM IN CCM-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF DCM_IND_ACAL
      *<<<< DCM_IND_ACAL
      *VAL-COD Valida codigo de tabla
            IF DCM-IND-ACAL IN CCM-FLD > SPACES
               MOVE 'GNS'                   TO TAB-COD-SIST
               MOVE 'SON'                   TO TAB-COD-TTAB IN TAB
               MOVE DCM-IND-ACAL IN CCM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD.
      *>>>>
*% END
*% IF DCM_MSC_BCTI
      *<<<< DCM_MSC_BCTI
           IF DCM-MSC-BCTI IN CCM-FLD NOT > SPACES AND
              DCM-MSC-PBTI IN CCM-FLD NOT > SPACES AND
              DCM-MSC-BPBT IN CCM-FLD NOT > SPACES AND
              DCM-MSC-SPBT IN CCM-FLD NOT > SPACES AND
              DCM-COD-ECCM IN CCM-FLD = 'TAS'
              MOVE 'TAB'                   TO TAB-COD-SIST
              MOVE 'OCS'                   TO TAB-COD-TTAB IN TAB
              MOVE DCM-COD-OCOB IN CCM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              IF TAB-CIC-CTAB IN TAB NOT = 'FLT'
      *ASUME VENCIDA-MENSUAL-SIMPLE-SIMPLE
                 MOVE 'V' TO DCM-MSC-BCTI IN CCM-FLD
                 MOVE 'M' TO DCM-MSC-PBTI IN CCM-FLD
                 MOVE 'S' TO DCM-MSC-BPBT IN CCM-FLD
                 MOVE 'S' TO DCM-MSC-SPBT IN CCM-FLD.

           IF ((DCM-COD-ECCM IN CCM-FLD = 'MFI' OR 'FAC' OR 'INF') AND  
                DCM-MSC-BCTI IN CCM-FLD > SPACES)                       
              MOVE 'TAB'        TO MSG-COD-SIST                         
               MOVE 'BCTI    INV' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DCM-MSC-BCTI.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DCM-MSC-BCTI IN CCM-FLD > SPACES)                       
               MOVE 'TAB'         TO MSG-COD-SIST
               MOVE 'BCTI    INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC  TO FRM-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-VAL-DCM-MSC-BCTI.

           IF DCM-MSC-BCTI IN CCM-FLD NOT > SPACES AND                  
              DCM-COD-ECCM IN CCM-FLD = 'TAS'                           
                MOVE 'TAB'        TO MSG-COD-SIST
                MOVE 'MSCBCTIOBL' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-DCM-MSC-BCTI.

      *VAL-IND Valida miscelaneo de tabla
           IF DCM-MSC-BCTI IN CCM-FLD > SPACES                          
               MOVE 'COL'                   TO MSC-COD-SIST             
               MOVE 'BCTI'                  TO MSC-COD-TMSC IN MSC      
               MOVE DCM-MSC-BCTI IN CCM-FLD TO MSC-COD-CMSC IN MSC      
               PERFORM VAL-IND                                          
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCM-MSC-BCTI IN CCM-FLD NOT > SPACES
               MOVE SPACES              TO FRM-GLS-BCTI IN CCM-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-BCTI IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_MSC_PBTI
      *<<<< DCM_MSC_PBTI
           IF ((DCM-COD-ECCM IN CCM-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DCM-MSC-PBTI IN CCM-FLD > SPACES)                   
              MOVE 'TAB'         TO MSG-COD-SIST                        
              MOVE 'PBTI    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DCM-MSC-PBTI.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DCM-MSC-PBTI IN CCM-FLD > SPACES)                       
              MOVE 'TAB'         TO MSG-COD-SIST
              MOVE 'PBTI    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-PBTI.

           IF DCM-MSC-PBTI IN CCM-FLD NOT > SPACES AND                  
              DCM-COD-ECCM IN CCM-FLD = 'TAS'                           
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'MSCPBTIOBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-PBTI.

      *VAL-IND Valida miscelaneo de tabla
           IF DCM-MSC-PBTI IN CCM-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'PBTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE DCM-MSC-PBTI IN CCM-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND                                           
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCM-MSC-PBTI IN CCM-FLD NOT > SPACES
               MOVE SPACES              TO FRM-GLS-PBTI IN CCM-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-PBTI IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_MSC_BPBT
      *<<<< DCM_MSC_BPBT
           IF ((DCM-COD-ECCM IN CCM-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DCM-MSC-BPBT IN CCM-FLD > SPACES )                  
              MOVE 'TAB' TO MSG-COD-SIST                                
              MOVE 'BPBT    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DCM-MSC-BPBT.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DCM-MSC-BPBT IN CCM-FLD > SPACES)                       
              MOVE 'TAB' TO MSG-COD-SIST
              MOVE 'BPBT    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-BPBT.

           IF DCM-MSC-BPBT IN CCM-FLD NOT > SPACES AND                  
              DCM-COD-ECCM IN CCM-FLD = 'TAS'                           
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'MSCBPBTOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DCM-MSC-BPBT.

      *VAL-IND Valida miscelaneo de tabla
           IF DCM-MSC-BPBT IN CCM-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE DCM-MSC-BPBT IN CCM-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND                                           
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCM-MSC-BPBT IN CCM-FLD NOT > SPACES
               MOVE SPACES              TO FRM-GLS-BPBT IN CCM-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-BPBT IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_MSC_SPBT
      *<<<< DCM_MSC_SPBT
           IF ((DCM-COD-ECCM IN CCM-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DCM-MSC-SPBT IN CCM-FLD > SPACES)                   
              MOVE 'TAB'         TO MSG-COD-SIST                        
              MOVE 'SPBT    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DCM-MSC-SPBT.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DCM-MSC-SPBT IN CCM-FLD > SPACES)                       
              MOVE 'TAB'         TO MSG-COD-SIST
              MOVE 'SPBT    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-SPBT.

           IF DCM-MSC-SPBT IN CCM-FLD NOT > SPACES AND                  
              DCM-COD-ECCM IN CCM-FLD = 'TAS'                           
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'MSCSPBTOBL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DCM-MSC-SPBT.

      *VAL-IND Valida miscelaneo de tabla
           IF DCM-MSC-SPBT IN CCM-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'MCTI'                  TO MSC-COD-TMSC IN MSC       
              MOVE DCM-MSC-SPBT IN CCM-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND                                           
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCM-MSC-SPBT IN CCM-FLD NOT > SPACES
               MOVE SPACES              TO FRM-GLS-SPBT IN CCM-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-SPBT IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_COD_CVTI
      *<<<< DCM_COD_CVTI
           IF ((DCM-COD-ECCM IN CCM-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DCM-COD-CVTI IN CCM-FLD > SPACES)                   
              MOVE 'TAB' TO MSG-COD-SIST                                
              MOVE 'CVTI    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DCM-COD-CVTI.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DCM-COD-CVTI IN CCM-FLD > SPACES)                       
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CVTI    INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-DCM-COD-CVTI.

           IF DCM-COD-CVTI IN CCM-FLD NOT > SPACES
               GO TO FIN-VAL-DCM-COD-CVTI.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE 'I'                     TO WSS-COD-TVTI.
           MOVE DCM-COD-CVTI IN CCM-FLD TO WSS-COD-CVTI.
           MOVE DCM-MSC-PBTI IN CCM-FLD TO WSS-COD-TCTI.
           MOVE WSS-COD-VCAM            TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF DCM_MSC_TFPR
      *<<<< DCM_MSC_TFPR
           IF ((DCM-COD-ECCM IN CCM-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DCM-MSC-TFPR IN CCM-FLD > SPACES)                   
              MOVE 'TAB' TO MSG-COD-SIST                                
              MOVE 'TFPR    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DCM-MSC-TFPR.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DCM-MSC-TFPR IN CCM-FLD > SPACES)                       
              MOVE 'TAB' TO MSG-COD-SIST                                
              MOVE 'TFPR    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-TFPR.

      *VAL-IND Valida miscelaneo de tabla
           IF DCM-MSC-TFPR IN CCM-FLD > SPACES                          
              MOVE 'COL'                   TO MSC-COD-SIST              
              MOVE 'TFPR'                  TO MSC-COD-TMSC IN MSC       
              MOVE DCM-MSC-TFPR IN CCM-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND                                           
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCM-MSC-TFPR IN CCM-FLD NOT > SPACES
               MOVE SPACES              TO FRM-GLS-TFPR IN CCM-FLD
           ELSE
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TFPR IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_NUM_PREP
      *<<<< DCM_NUM_PREP
           IF DCM-COD-ECCM IN CCM-FLD = 'MFI' AND
              DCM-NUM-PREP IN CCM-FLD > ZEROES
              MOVE 'TAB' TO MSG-COD-SIST
              MOVE 'PREP    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-NUM-PREP.
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DCM-NUM-PREP IN CCM-FLD > ZEROES)                       
              MOVE 'TAB' TO MSG-COD-SIST                                
              MOVE 'PREP    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DCM-NUM-PREP.                               
      *>>>>
*% END
*% IF DCM_MSC_UTPR
      *<<<< DCM_MSC_UTPR
           IF ((DCM-COD-ECCM IN CCM-FLD = 'MFI' OR 'FAC' OR 'INF')      
                AND DCM-MSC-UTPR IN CCM-FLD > SPACES)                   
              MOVE 'TAB'         TO MSG-COD-SIST                        
              MOVE 'UTPR    INV' TO MSG-COD-MENS                        
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-DCM-MSC-UTPR.                               
                                                                        
           IF ((WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y') AND
                DCM-MSC-UTPR IN CCM-FLD > SPACES)                       
              MOVE 'TAB'         TO MSG-COD-SIST
              MOVE 'UTPR    INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-UTPR.

           IF DCM-NUM-PREP IN CCM-FLD > ZEROES AND
              DCM-MSC-UTPR IN CCM-FLD NOT > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'MSCUTPROBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-UTPR.

           IF DCM-NUM-PREP IN CCM-FLD NOT > ZEROES AND
              DCM-MSC-UTPR IN CCM-FLD > SPACES
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'MSCUTPROBL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DCM-MSC-UTPR.
           IF DCM-MSC-UTPR IN CCM-FLD > SPACES                          
              MOVE 'TAB'                   TO MSC-COD-SIST              
              MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC       
              MOVE DCM-MSC-UTPR IN CCM-FLD TO MSC-COD-CMSC IN MSC       
              PERFORM VAL-IND                                           
           IF MSG-COD-MENS = 'COD    NEX' OR
              DCM-MSC-UTPR IN CCM-FLD NOT > SPACES
               MOVE SPACES              TO FRM-GLS-UTPR IN CCM-FLD
           ELSE
               MOVE MSC-GLS-DCOR IN MSC TO FRM-GLS-UTPR IN CCM-FLD.
      *>>>>
*% END
*% IF DCM_COD_SCTB
      *<<<< DCM_COD_SCTB
           IF DCM-COD-SCTB IN CCM-FLD > SPACES
              MOVE 'COL'  TO MSC-COD-SIST
              MOVE 'SCTB' TO MSC-COD-TMSC IN MSC
              MOVE DCM-COD-SCTB IN CCM-FLD TO MSC-COD-CMSC IN MSC
              PERFORM VAL-IND.
      *>>>>
*% END
*% IF DCM_IND_USTC
      *<<<< DCM_IND_USTC
           IF DCM-IND-USTC IN CCM-FLD > SPACES
              MOVE 'GNS'  TO MSC-COD-SIST
              MOVE 'VIGE' TO MSC-COD-TMSC IN MSC
              MOVE DCM-IND-USTC IN CCM-FLD TO MSC-COD-CMSC IN MSC
              PERFORM VAL-IND.
      *>>>>
*% END
*% IF DCM_IND_MCSE
      *<<<< DCM_IND_MCSE
           IF DCM-IND-MCSE IN CCM-FLD > SPACES
              MOVE 'COL' TO TAB-COD-SIST
              MOVE 'IMC' TO TAB-COD-TTAB IN TAB
              MOVE DCM-IND-MCSE IN CCM-FLD TO TAB-COD-CTAB IN TAB
              PERFORM VAL-COD.
      *>>>>
*% END
*% IF FRM_GLS_SIST
      *<<<< FRM_GLS_SIST                                                
            MOVE 'TAB'                   TO TAB-COD-SIST FIO-SIST.      
            MOVE 'TDP'                   TO TAB-COD-TTAB IN TAB.        
            MOVE CCM-IND-TPLT IN CCM-FLD TO TAB-COD-CTAB IN TAB.        
            MOVE FIO-GET-KEY TO FIO-CMND.                               
            PERFORM GNS-FIO-TAB.                                        
            IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'               
               MOVE TAB-CIC-CTAB IN TAB     TO WSS-GLS-TPLT IN WSS-VARI 
            ELSE                                                        
               MOVE CCM-IND-TPLT IN CCM-FLD TO WSS-CIC-TPLT IN WSS-VARI.
      *>>>>                                                             
*% END
*% IF INI_DCM_COD_OCOB
      *<<<< INI_DCM_COD_OCOB                                            
      *PVG INI 03-NOV-2008                                              
      *    IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')     
           IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X'             
                                              OR 'Y' OR 'N')            
      *PVG FIN 03-NOV-2008                                              
              IF DCM-COD-OCOB IN CCM-FLD > SPACES                       
                 MOVE 'TAB'          TO MSG-COD-SIST                    
                 MOVE 'OCOB     INV' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC   TO FRM-MENS                        
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR                        
                 GO TO FIN-VAL-DCM-COD-OCOB                             
              ELSE                                                      
                 GO TO FIN-VAL-DCM-COD-OCOB.                            
      *>>>> INI_DCM_COD_OCOB                                            
*% END
*% IF INI_DCM_COD_ECCM
      *<<<< INI_DCM_COD_ECCM                                            
      *PVG INI 03-NOV-2008                                              
      *    IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X' OR 'Y')     
           IF (WSS-CIC-TPLT IN WSS-VARI = '%' OR 'M' OR 'X'             
                                              OR 'Y' OR 'N')            
      *PVG FIN 03-NOV-2008                                              
              IF DCM-COD-ECCM IN CCM-FLD > SPACES                       
                 MOVE 'TAB'          TO MSG-COD-SIST                    
                 MOVE 'ECCM     INV' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC   TO FRM-MENS                        
                 MOVE FRM-SUAR-MAL   TO FRM-SUAR                        
                 GO TO FIN-VAL-DCM-COD-ECCM                             
              ELSE                                                      
                 GO TO FIN-VAL-DCM-COD-ECCM.                            
      *>>>> INI_DCM_COD_ECCM                                            
*% END
