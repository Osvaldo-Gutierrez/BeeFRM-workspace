*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% IF WSS
      *<<<< WSS
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY MC2WXQSF.
      *COPY MC2BRSFC.
      *COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-SFC-REQA==.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
*% IF NOT PGM_MCP AND NOT PGM_PTC
       COPY GNSWGQUE.
*% END
      *>>>>
*% END
*% IF FIN_PGM_STAT
      *<<<< FIN_PGM_STAT
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
      *>>>> FIN_PGM_STAT
*% END
*% IF FIN_SCR_VARI
           03 SCR-NUM-PANT               PIC 9(0002).
           03 SCR-QSF-FLD                PIC X(1010).
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
                MOVE TSK-TERM-ALF TO QSF-COD-TERM
                MOVE TSK-TERM-ALF TO QSF-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO QSF-COD-TERM
                MOVE EIBTRMID     TO QSF-COD-TERM-MAS.
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )
               MOVE SCR-QSF-FLD TO QSF-FLD
               GO TO FIN-INI.

           IF ( FRM-FFLD = FRM-FFLD-PF6 )
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
               ADD 1              TO QUE-NITM
               MOVE QSF-NOM-TSQSF TO QUE-COLA
               MOVE QSF-LEN-TSQSF TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                  MOVE SCR-QSF-FLD TO QSF-FLD
                  GO TO FIN-INI.
           PERFORM GET-FHOY.
      *>>>>
*% END
*% IF INI_SCR_COM
      *<<<< INI_SCR_COM
           MOVE QSF-NOM-TSQSF TO QUE-COLA.
           MOVE QUE-DEL       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE QSF-NOM-TSQSF-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           PERFORM KEY-ALL-QSF.
           IF FRM-IND-NEXT IN QSF-FLD = 'S'
              MOVE FRM-NUM-DINI IN QSF-FLD TO SFC-NUM-DINI IN SFC
              MOVE FRM-NUM-MINI IN QSF-FLD TO SFC-NUM-MINI IN SFC
              MOVE FRM-NUM-SINI IN QSF-FLD TO SFC-NUM-SINI IN SFC
              MOVE FRM-NUM-AINI IN QSF-FLD TO SFC-NUM-AINI IN SFC
              MOVE FRM-HRA-HINI IN QSF-FLD TO SFC-HRA-HINI IN SFC
              MOVE FRM-COD-SIST IN QSF-FLD TO SFC-COD-SIST IN SFC
              MOVE FRM-COD-EVEN IN QSF-FLD TO SFC-COD-EVEN IN SFC
              MOVE FRM-CAI-IOPE IN QSF-FLD TO SFC-CAI-IOPE IN SFC
              MOVE FRM-IIC-IOPE IN QSF-FLD TO SFC-IIC-IOPE IN SFC
              MOVE FRM-EXT-IOPE IN QSF-FLD TO SFC-EXT-IOPE IN SFC
              MOVE FIO-GET-LEQ TO FIO-CMND
              PERFORM MC2-FIO-SFC
              MOVE FIO-STAT TO PGM-STAT-SFC
              GO TO NXT-LEE-SFC.

           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM MC2-FIO-SFC.
           MOVE FIO-STAT TO PGM-STAT-SFC.
           IF NOT ( FIO-STAT-OKS AND
                    SFC-NUM-SINI IN SFC = SFC-NUM-SINI IN QSF-FLD AND
                    SFC-NUM-AINI IN SFC = SFC-NUM-AINI IN QSF-FLD AND
                    SFC-NUM-MINI IN SFC = SFC-NUM-MINI IN QSF-FLD AND
                    SFC-NUM-DINI IN SFC = SFC-NUM-DINI IN QSF-FLD AND
                    SFC-COD-SIST IN SFC = SFC-COD-SIST IN QSF-FLD AND
                    SFC-COD-EVEN IN SFC = SFC-COD-EVEN IN QSF-FLD )
              MOVE '23' TO FIO-STAT PGM-STAT-SFC
              GO TO FIN-FND-KEY.

           PERFORM CLR-VEC-DQSF.
           MOVE ZEROES TO WSS-J.
           GO TO ANL-LEE-SFC.

       LUP-LEE-SFC.
           PERFORM MC2-FIO-SFC.
           MOVE FIO-STAT TO PGM-STAT-SFC.
           IF NOT ( FIO-STAT-OKS AND
                    SFC-NUM-SINI IN SFC = SFC-NUM-SINI IN QSF-FLD AND
                    SFC-NUM-AINI IN SFC = SFC-NUM-AINI IN QSF-FLD AND
                    SFC-NUM-MINI IN SFC = SFC-NUM-MINI IN QSF-FLD AND
                    SFC-NUM-DINI IN SFC = SFC-NUM-DINI IN QSF-FLD AND
                    SFC-COD-SIST IN SFC = SFC-COD-SIST IN QSF-FLD AND
                    SFC-COD-EVEN IN SFC = SFC-COD-EVEN IN QSF-FLD )
              MOVE '23' TO FIO-STAT PGM-STAT-SFC
              GO TO CON-FND-KEY.


       ANL-LEE-SFC.
           IF (SFC-CIC-IOPE IN QSF-FLD > SPACES AND
               SFC-CIC-IOPE IN QSF-FLD NOT = SFC-CIC-IOPE IN SFC)
               GO TO NXT-LEE-SFC.

           IF (SFC-EXT-IOPE IN QSF-FLD > SPACES AND
               SFC-EXT-IOPE IN QSF-FLD NOT = SFC-EXT-IOPE IN SFC)
               GO TO NXT-LEE-SFC.

           IF (SFC-COD-BANC IN QSF-FLD > SPACES AND
               SFC-COD-BANC IN QSF-FLD NOT = SFC-COD-BANC IN SFC)
               GO TO NXT-LEE-SFC.

           IF (SFC-COD-OFIC IN QSF-FLD > SPACES AND
               SFC-COD-OFIC IN QSF-FLD NOT = SFC-COD-OFIC IN SFC)
               GO TO NXT-LEE-SFC.

           IF (SFC-COD-REGN IN QSF-FLD > SPACES AND
               SFC-COD-REGN IN QSF-FLD NOT = SFC-COD-REGN IN SFC)
               GO TO NXT-LEE-SFC.

           IF (SFC-MSC-STAT IN QSF-FLD > SPACES AND
               SFC-MSC-STAT IN QSF-FLD NOT = SFC-MSC-STAT IN SFC)
               GO TO NXT-LEE-SFC.

           IF (FRM-COD-USER IN QSF-FLD > SPACES AND
               FRM-COD-USER IN QSF-FLD NOT = SFC-COD-EJEC IN SFC)
               GO TO NXT-LEE-SFC.

           PERFORM PRO-BUS-BNCO.
           IF (FRM-COD-BNCO IN QSF-FLD > SPACES AND
               FRM-COD-BNCO IN QSF-FLD NOT = WSS-COD-BNCO IN WSS-VARI)
               GO TO NXT-LEE-SFC.

           IF FRM-COD-CEPL IN QSF-FLD > SPACES
              PERFORM PRO-BUS-CEPL
              IF WSS-IND-NXTR = 'S'
                 GO TO NXT-LEE-SFC.

           IF FRM-COD-IROL IN QSF-FLD > SPACES
              PERFORM PRO-BUS-IROL
              IF WSS-IND-NXTR = 'S'
                 GO TO NXT-LEE-SFC.

           PERFORM CRG-INF-RSFC.

           IF (SCR-OFRM-SRV       AND WSS-J > WSS-NITMMAX)
              GO TO CON-FND-KEY.
           IF ((NOT SCR-OFRM-SRV) AND WSS-J > WSS-JMAX)
              GO TO CON-FND-KEY.
       NXT-LEE-SFC.
           MOVE PGM-STAT-SFC TO FIO-STAT.
           MOVE FIO-GET-PRV TO FIO-CMND.
           GO TO LUP-LEE-SFC.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CON-FND-KEY.
           PERFORM PUT-TAB.
       
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
       ----------------------------------------------------------
       MSG-FND-KEY.
           MOVE 'TAB'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00'         TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-QSF
               PERFORM VAL-NUM-FLD-QSF
               PERFORM SCRL-TAB-QSF
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBPFEC.

       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY SGCBFDBC.
       COPY TABBFOFI.
       COPY TABBVOFI.

       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE QSF-NOM-TSQSF TO QUE-COLA.
           MOVE QUE-DEL       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           MOVE QSF-NOM-TSQSF-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 1 TO SCR-NUM-PANT.
           MOVE LOW-VALUES TO FRM-IND-PAPRR-IDX-MTI
                              FRM-IND-PAPRR-IDX-FRM.
      *
           MOVE 1 TO FRM-IFLD.
           MOVE ZEROES  TO WSS-NITM IN WSS-VARI.

           MOVE 1 TO WSS-F IN WSS-VARI.
       LUP-PUT-TAB.
           IF WSS-F IN WSS-VARI > WSS-FMAX IN WSS-VARI
              GO TO FIN-PUT-TAB.
           IF WSS-IND-PAPRR-V(WSS-F) > SPACES
              PERFORM PUT-TAB-QSF
              PERFORM PUT-QSF-QUE
              PERFORM SET-FRM-IFLD
           ELSE
           IF FRM-IFLD = 1 AND WSS-F = 1
              MOVE 'MC2' TO MSG-COD-SIST
              MOVE 'SFC    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE '00' TO FIO-STAT
              GO TO FIN-PUT-TAB
           ELSE
              MOVE '00' TO FIO-STAT
              GO TO FIN-PUT-TAB.

           ADD 1 TO WSS-F IN WSS-VARI.
           GO TO LUP-PUT-TAB.
       FIN-PUT-TAB.
           MOVE 1                  TO QUE-NITM.
           MOVE QSF-LEN-TSQSF-MAS  TO QUE-LITM.
           MOVE QSF-NOM-TSQSF-MAS  TO QUE-COLA.

           IF WSS-NITM > WSS-NITMMAX
              MOVE 'S'           TO QSF-MAS-IND-HMAS
           ELSE
              MOVE 'N'           TO QSF-MAS-IND-HMAS.

           MOVE WSS-NITM         TO WSS-NUM-ICUR.
           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.
           MOVE WSS-NUM-ICUR-ALF TO QSF-MAS-NUM-TOCC.
           MOVE QSF-MAS-ITEM     TO QUE-ITEM.
           MOVE QUE-PUT          TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF WSS-NITM > WSS-IMAX
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'SFCTABDMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.

       SET-FRM-IFLD SECTION.
       INI-SET-FRM-IFLD.
           IF SCR-OFRM-SRV
                MOVE 1 TO FRM-IFLD
           ELSE
                ADD 1  TO FRM-IFLD.
       FIN-SET-FRM-IFLD.
           EXIT.
      *--------------------------------------------
       SCRL-TAB-QSF SECTION.
       INI-SCRL-TAB-QSF.
           MOVE SPACES TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-QSF.
           EXIT.

      *--------------------------------------------
       PUT-TAB-QSF SECTION.
       INI-PUT-TAB-QSF.
           PERFORM CLR-WSS.
           IF SCR-OFRM-SRV
              MOVE WSS-IND-PAPRR-V(WSS-F) TO MTI-IND-PAPRR IN WSS-VARI
              MOVE WSS-FEC-FINIR-V(WSS-F) TO MTI-FEC-FINIR IN WSS-VARI
              MOVE WSS-HRA-HINIR-V(WSS-F) TO MTI-HRA-HINIR IN WSS-VARI
              MOVE WSS-COD-SISTR-V(WSS-F) TO MTI-COD-SISTR IN WSS-VARI
              MOVE WSS-COD-EVENR-V(WSS-F) TO MTI-COD-EVENR IN WSS-VARI
              MOVE WSS-CAI-IOPER-V(WSS-F) TO MTI-CAI-IOPER IN WSS-VARI
              MOVE WSS-IIC-IOPER-V(WSS-F) TO MTI-IIC-IOPER IN WSS-VARI
              MOVE WSS-EXT-IOPER-V(WSS-F) TO MTI-EXT-IOPER IN WSS-VARI
              MOVE WSS-MSC-STATR-V(WSS-F) TO MTI-MSC-STATR IN WSS-VARI
              MOVE WSS-COD-APRAR-V(WSS-F) TO MTI-COD-APRAR IN WSS-VARI
              MOVE WSS-NUM-NAPRR-V(WSS-F) TO MTI-NUM-NAPRR IN WSS-VARI
              MOVE WSS-COD-BANCR-V(WSS-F) TO MTI-COD-BANCR IN WSS-VARI
              MOVE WSS-COD-OFICR-V(WSS-F) TO MTI-COD-OFICR IN WSS-VARI
              MOVE WSS-COD-REGNR-V(WSS-F) TO MTI-COD-REGNR IN WSS-VARI
              MOVE WSS-SGV-MNTOR-V(WSS-F) TO MTI-SGV-MNTOR IN WSS-VARI
              MOVE WSS-IND-MNTOR-V(WSS-F) TO MTI-IND-MNTOR IN WSS-VARI
              MOVE WSS-NUM-PLZOR-V(WSS-F) TO MTI-NUM-PLZOR IN WSS-VARI
              MOVE WSS-IND-PLZOR-V(WSS-F) TO MTI-IND-PLZOR IN WSS-VARI
              MOVE WSS-SGV-TMPRR-V(WSS-F) TO MTI-SGV-TMPRR IN WSS-VARI
              MOVE WSS-SGV-TMSFR-V(WSS-F) TO MTI-SGV-TMSFR IN WSS-VARI
              MOVE WSS-IND-TAMOR-V(WSS-F) TO MTI-IND-TAMOR IN WSS-VARI
              MOVE WSS-SGV-SPPRR-V(WSS-F) TO MTI-SGV-SPPRR IN WSS-VARI
              MOVE WSS-SGV-SPSFR-V(WSS-F) TO MTI-SGV-SPSFR IN WSS-VARI
              MOVE WSS-IND-SPRDR-V(WSS-F) TO MTI-IND-SPRDR IN WSS-VARI
              MOVE WSS-SGV-VARIR-V(WSS-F) TO MTI-SGV-VARIR IN WSS-VARI
              MOVE WSS-COD-MAILR-V(WSS-F) TO MTI-COD-MAILR IN WSS-VARI
              MOVE WSS-COD-EJECR-V(WSS-F) TO MTI-COD-EJECR IN WSS-VARI
              MOVE WSS-NUM-ICLIR-V(WSS-F) TO MTI-NUM-ICLIR IN WSS-VARI
              MOVE WSS-VRF-ICLIR-V(WSS-F) TO MTI-VRF-ICLIR IN WSS-VARI
              MOVE WSS-IND-ICLIR-V(WSS-F) TO MTI-IND-ICLIR IN WSS-VARI
              MOVE WSS-GLS-ICLIR-V(WSS-F) TO MTI-GLS-ICLIR IN WSS-VARI
              MOVE WSS-GLS-NOMCR-V(WSS-F) TO MTI-GLS-NOMCR IN WSS-VARI
           ELSE
              MOVE WSS-IND-PAPRR-V(WSS-F) TO WSS-IND-PAPRR IN WSS-VARI
              MOVE WSS-FEC-FINIR-V(WSS-F) TO WSS-FEC-FINIR IN WSS-VARI
              MOVE WSS-HRA-HINIR-V(WSS-F) TO WSS-HRA-HINIR IN WSS-VARI
              MOVE WSS-COD-SISTR-V(WSS-F) TO WSS-COD-SISTR IN WSS-VARI
              MOVE WSS-COD-EVENR-V(WSS-F) TO WSS-COD-EVENR IN WSS-VARI
              MOVE WSS-CAI-IOPER-V(WSS-F) TO WSS-CAI-IOPER IN WSS-VARI
              MOVE WSS-IIC-IOPER-V(WSS-F) TO WSS-IIC-IOPER IN WSS-VARI
              MOVE WSS-EXT-IOPER-V(WSS-F) TO WSS-EXT-IOPER IN WSS-VARI
              MOVE WSS-MSC-STATR-V(WSS-F) TO WSS-MSC-STATR IN WSS-VARI
              MOVE WSS-COD-APRAR-V(WSS-F) TO WSS-COD-APRAR IN WSS-VARI
              MOVE WSS-NUM-NAPRR-V(WSS-F) TO WSS-NUM-NAPRR IN WSS-VARI
              MOVE WSS-COD-BANCR-V(WSS-F) TO WSS-COD-BANCR IN WSS-VARI
              MOVE WSS-COD-OFICR-V(WSS-F) TO WSS-COD-OFICR IN WSS-VARI
              MOVE WSS-COD-REGNR-V(WSS-F) TO WSS-COD-REGNR IN WSS-VARI
              MOVE WSS-SGV-MNTOR-V(WSS-F) TO WSS-SGV-MNTOR IN WSS-VARI
              MOVE WSS-IND-MNTOR-V(WSS-F) TO WSS-IND-MNTOR IN WSS-VARI
              MOVE WSS-NUM-PLZOR-V(WSS-F) TO WSS-NUM-PLZOR IN WSS-VARI
              MOVE WSS-IND-PLZOR-V(WSS-F) TO WSS-IND-PLZOR IN WSS-VARI
              MOVE WSS-SGV-TMPRR-V(WSS-F) TO WSS-SGV-TMPRR IN WSS-VARI
              MOVE WSS-SGV-TMSFR-V(WSS-F) TO WSS-SGV-TMSFR IN WSS-VARI
              MOVE WSS-IND-TAMOR-V(WSS-F) TO WSS-IND-TAMOR IN WSS-VARI
              MOVE WSS-SGV-SPPRR-V(WSS-F) TO WSS-SGV-SPPRR IN WSS-VARI
              MOVE WSS-SGV-SPSFR-V(WSS-F) TO WSS-SGV-SPSFR IN WSS-VARI
              MOVE WSS-IND-SPRDR-V(WSS-F) TO WSS-IND-SPRDR IN WSS-VARI
              MOVE WSS-SGV-VARIR-V(WSS-F) TO WSS-SGV-VARIR IN WSS-VARI
              MOVE WSS-COD-MAILR-V(WSS-F) TO WSS-COD-MAILR IN WSS-VARI
              MOVE WSS-COD-EJECR-V(WSS-F) TO WSS-COD-EJECR IN WSS-VARI
              MOVE WSS-NUM-ICLIR-V(WSS-F) TO WSS-NUM-ICLIR IN WSS-VARI
              MOVE WSS-VRF-ICLIR-V(WSS-F) TO WSS-VRF-ICLIR IN WSS-VARI
              MOVE WSS-IND-ICLIR-V(WSS-F) TO WSS-IND-ICLIR IN WSS-VARI
              MOVE WSS-GLS-ICLIR-V(WSS-F) TO WSS-GLS-ICLIR IN WSS-VARI
              MOVE WSS-GLS-NOMCR-V(WSS-F) TO WSS-GLS-NOMCR IN WSS-VARI.

           IF FRM-IFLD > WSS-IMAX
              GO TO FIN-PUT-TAB-QSF.

           MOVE WSS-IND-PAPRR-V(WSS-F) TO
                FRM-IND-PAPRR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-FEC-FINIR-V(WSS-F) TO
                FRM-FEC-FINIR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-HRA-HINIR-V(WSS-F) TO
                FRM-HRA-HINIR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-COD-SISTR-V(WSS-F) TO
                FRM-COD-SISTR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-COD-EVENR-V(WSS-F) TO
                FRM-COD-EVENR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-CAI-IOPER-V(WSS-F) TO
                FRM-CAI-IOPER IN QSF-FLD(FRM-IFLD).
           MOVE WSS-IIC-IOPER-V(WSS-F) TO
                FRM-IIC-IOPER IN QSF-FLD(FRM-IFLD).
           MOVE WSS-EXT-IOPER-V(WSS-F) TO
                FRM-EXT-IOPER IN QSF-FLD(FRM-IFLD).
           MOVE WSS-MSC-STATR-V(WSS-F) TO
                FRM-MSC-STATR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-COD-APRAR-V(WSS-F) TO
                FRM-COD-APRAR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-NUM-NAPRR-V(WSS-F) TO
                FRM-NUM-NAPRR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-COD-BANCR-V(WSS-F) TO
                FRM-COD-BANCR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-COD-OFICR-V(WSS-F) TO
                FRM-COD-OFICR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-COD-REGNR-V(WSS-F) TO
                FRM-COD-REGNR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-SGV-MNTOR-V(WSS-F) TO
                FRM-SGV-MNTOR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-IND-MNTOR-V(WSS-F) TO
                FRM-IND-MNTOR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-NUM-PLZOR-V(WSS-F) TO
                FRM-NUM-PLZOR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-IND-PLZOR-V(WSS-F) TO
                FRM-IND-PLZOR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-SGV-TMPRR-V(WSS-F) TO
                FRM-SGV-TMPRR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-SGV-TMSFR-V(WSS-F) TO
                FRM-SGV-TMSFR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-IND-TAMOR-V(WSS-F) TO
                FRM-IND-TAMOR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-SGV-SPPRR-V(WSS-F) TO
                FRM-SGV-SPPRR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-SGV-SPSFR-V(WSS-F) TO
                FRM-SGV-SPSFR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-IND-SPRDR-V(WSS-F) TO
                FRM-IND-SPRDR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-SGV-VARIR-V(WSS-F) TO
                FRM-SGV-VARIR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-COD-MAILR-V(WSS-F) TO
                FRM-COD-MAILR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-COD-EJECR-V(WSS-F) TO
                FRM-COD-EJECR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-NUM-ICLIR-V(WSS-F) TO
                FRM-NUM-ICLIR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-VRF-ICLIR-V(WSS-F) TO
                FRM-VRF-ICLIR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-IND-ICLIR-V(WSS-F) TO
                FRM-IND-ICLIR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-GLS-ICLIR-V(WSS-F) TO
                FRM-GLS-ICLIR IN QSF-FLD(FRM-IFLD).
           MOVE WSS-GLS-NOMCR-V(WSS-F) TO
                FRM-GLS-NOMCR IN QSF-FLD(FRM-IFLD).
       FIN-PUT-TAB-QSF.
           EXIT.
      *----------------------------------------------------
       PUT-QSF-QUE SECTION.
       INI-PUT-QSF-QUE.
           PERFORM PRO-FLD-QUE.
           ADD 1 TO WSS-NITM.
           MOVE QSF-NOM-TSQSF    TO QUE-COLA.
           MOVE QSF-LEN-TSQSF    TO QUE-LITM.
           MOVE WSS-NITM         TO QUE-NITM.
           MOVE SPACES           TO QUE-ITEM.
           IF SCR-OFRM-SRV
              PERFORM EDT-VAL-QSF
              MOVE FRM-IND-PAPRR-IDX-MTI TO QUE-ITEM
           ELSE
              MOVE FRM-IND-PAPRR-IDX-FRM TO QUE-ITEM.

           MOVE QUE-PUT  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
       FIN-PUT-QSF-QUE.
           EXIT.

       EDT-VAL-QSF SECTION.
       INI-EDT-VAL-QSF.
           MOVE MTI-HRA-HINIR     TO FRM-HRA-HINIR-EDT.
           MOVE FRM-HRA-HINIR-EDT TO MTI-HRA-HINIR-ALF.

           MOVE MTI-NUM-NAPRR     TO FRM-NUM-NAPRR-EDT.
           MOVE FRM-NUM-NAPRR-EDT TO MTI-NUM-NAPRR-ALF.

           MOVE MTI-SGV-MNTOR     TO FRM-SGV-MNTOR-EDT.
           MOVE FRM-SGV-MNTOR-EDT TO MTI-SGV-MNTOR-ALF.

           MOVE MTI-NUM-PLZOR     TO FRM-NUM-PLZOR-EDT.
           MOVE FRM-NUM-PLZOR-EDT TO MTI-NUM-PLZOR-ALF.

           MOVE MTI-SGV-TMPRR     TO FRM-SGV-TMPRR-EDT.
           MOVE FRM-SGV-TMPRR-EDT TO MTI-SGV-TMPRR-ALF.

           MOVE MTI-SGV-TMSFR     TO FRM-SGV-TMSFR-EDT.
           MOVE FRM-SGV-TMSFR-EDT TO MTI-SGV-TMSFR-ALF.

           MOVE MTI-SGV-SPPRR     TO FRM-SGV-SPPRR-EDT.
           MOVE FRM-SGV-SPPRR-EDT TO MTI-SGV-SPPRR-ALF.

           MOVE MTI-SGV-SPSFR     TO FRM-SGV-SPSFR-EDT.
           MOVE FRM-SGV-SPSFR-EDT TO MTI-SGV-SPSFR-ALF.

           MOVE MTI-SGV-VARIR     TO FRM-SGV-VARIR-EDT.
           MOVE FRM-SGV-VARIR-EDT TO MTI-SGV-VARIR-ALF.

           MOVE MTI-NUM-ICLIR     TO FRM-NUM-ICLIR-EDT.
           MOVE FRM-NUM-ICLIR-EDT TO MTI-NUM-ICLIR-ALF.

       FIN-EDT-VAL-QSF.
           EXIT.
      *----------------------------------------------------

       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1              TO QUE-NITM.
           MOVE QSF-NOM-TSQSF TO QUE-COLA.
           MOVE QSF-LEN-TSQSF TO QUE-LITM.
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MOVE 'SFCTABNONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
           MOVE QUE-ITEM TO FRM-IND-PAPRR-IDX(FRM-IFLD).
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO SCR-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1              TO QUE-NITM
               MOVE QSF-NOM-TSQSF TO QUE-COLA
               MOVE QSF-LEN-TSQSF TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'SFCTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.

       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-NUM-PANT = 1
               MOVE 'SFCTABNOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.

           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE QSF-NOM-TSQSF TO QUE-COLA
           MOVE QSF-LEN-TSQSF TO QUE-LITM
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'SFCTABNOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           MOVE QUE-ITEM TO FRM-IND-PAPRR-IDX(FRM-IFLD).
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.

           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.

           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM SCR-NUM-PANT
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'SFCTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.

       CLR-FRM SECTION.
       INI-CLR-FRM.
           MOVE SPACES TO FRM-IND-PAPRR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-FEC-FINIR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-HRA-HINIR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-SISTR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-EVENR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-CAI-IOPER IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-IIC-IOPER IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-EXT-IOPER IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-MSC-STATR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-APRAR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-NAPRR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-BANCR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-OFICR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-REGNR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-MNTOR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-MNTOR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-PLZOR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-PLZOR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TMPRR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-TMSFR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-TAMOR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-SPPRR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-SPSFR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-SPRDR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-SGV-VARIR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-MAILR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-COD-EJECR IN QSF-FLD(WSS-I).
           MOVE ZEROES TO FRM-NUM-ICLIR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-VRF-ICLIR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-IND-ICLIR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-GLS-ICLIR IN QSF-FLD(WSS-I).
           MOVE SPACES TO FRM-GLS-NOMCR IN QSF-FLD(WSS-I).
       FIN-CLR-FRM.
           EXIT.

       CLR-WSS SECTION.
       INI-CLR-WSS.
           MOVE SPACES TO MTI-IND-PAPRR IN WSS-VARI.
           MOVE ZEROES TO MTI-FEC-FINIR IN WSS-VARI.
           MOVE ZEROES TO MTI-HRA-HINIR IN WSS-VARI.
           MOVE SPACES TO MTI-COD-SISTR IN WSS-VARI.
           MOVE SPACES TO MTI-COD-EVENR IN WSS-VARI.
           MOVE SPACES TO MTI-CAI-IOPER IN WSS-VARI.
           MOVE SPACES TO MTI-IIC-IOPER IN WSS-VARI.
           MOVE SPACES TO MTI-EXT-IOPER IN WSS-VARI.
           MOVE SPACES TO MTI-MSC-STATR IN WSS-VARI.
           MOVE SPACES TO MTI-COD-APRAR IN WSS-VARI.
           MOVE ZEROES TO MTI-NUM-NAPRR IN WSS-VARI.
           MOVE SPACES TO MTI-COD-BANCR IN WSS-VARI.
           MOVE SPACES TO MTI-COD-OFICR IN WSS-VARI.
           MOVE SPACES TO MTI-COD-REGNR IN WSS-VARI.
           MOVE ZEROES TO MTI-SGV-MNTOR IN WSS-VARI.
           MOVE SPACES TO MTI-IND-MNTOR IN WSS-VARI.
           MOVE ZEROES TO MTI-NUM-PLZOR IN WSS-VARI.
           MOVE SPACES TO MTI-IND-PLZOR IN WSS-VARI.
           MOVE ZEROES TO MTI-SGV-TMPRR IN WSS-VARI.
           MOVE ZEROES TO MTI-SGV-TMSFR IN WSS-VARI.
           MOVE SPACES TO MTI-IND-TAMOR IN WSS-VARI.
           MOVE ZEROES TO MTI-SGV-SPPRR IN WSS-VARI.
           MOVE ZEROES TO MTI-SGV-SPSFR IN WSS-VARI.
           MOVE SPACES TO MTI-IND-SPRDR IN WSS-VARI.
           MOVE ZEROES TO MTI-SGV-VARIR IN WSS-VARI.
           MOVE SPACES TO MTI-COD-MAILR IN WSS-VARI.
           MOVE SPACES TO MTI-COD-EJECR IN WSS-VARI.
           MOVE ZEROES TO MTI-NUM-ICLIR IN WSS-VARI.
           MOVE SPACES TO MTI-VRF-ICLIR IN WSS-VARI.
           MOVE SPACES TO MTI-IND-ICLIR IN WSS-VARI.
           MOVE SPACES TO MTI-GLS-ICLIR IN WSS-VARI.
           MOVE SPACES TO MTI-GLS-NOMCR IN WSS-VARI.

           MOVE SPACES TO WSS-IND-PAPRR IN WSS-VARI.
           MOVE ZEROES TO WSS-FEC-FINIR IN WSS-VARI.
           MOVE ZEROES TO WSS-HRA-HINIR IN WSS-VARI.
           MOVE SPACES TO WSS-COD-SISTR IN WSS-VARI.
           MOVE SPACES TO WSS-COD-EVENR IN WSS-VARI.
           MOVE SPACES TO WSS-CAI-IOPER IN WSS-VARI.
           MOVE SPACES TO WSS-IIC-IOPER IN WSS-VARI.
           MOVE SPACES TO WSS-EXT-IOPER IN WSS-VARI.
           MOVE SPACES TO WSS-MSC-STATR IN WSS-VARI.
           MOVE SPACES TO WSS-COD-APRAR IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-NAPRR IN WSS-VARI.
           MOVE SPACES TO WSS-COD-BANCR IN WSS-VARI.
           MOVE SPACES TO WSS-COD-OFICR IN WSS-VARI.
           MOVE SPACES TO WSS-COD-REGNR IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-MNTOR IN WSS-VARI.
           MOVE SPACES TO WSS-IND-MNTOR IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-PLZOR IN WSS-VARI.
           MOVE SPACES TO WSS-IND-PLZOR IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-TMPRR IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-TMSFR IN WSS-VARI.
           MOVE SPACES TO WSS-IND-TAMOR IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-SPPRR IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-SPSFR IN WSS-VARI.
           MOVE SPACES TO WSS-IND-SPRDR IN WSS-VARI.
           MOVE ZEROES TO WSS-SGV-VARIR IN WSS-VARI.
           MOVE SPACES TO WSS-COD-MAILR IN WSS-VARI.
           MOVE SPACES TO WSS-COD-EJECR IN WSS-VARI.
           MOVE ZEROES TO WSS-NUM-ICLIR IN WSS-VARI.
           MOVE SPACES TO WSS-VRF-ICLIR IN WSS-VARI.
           MOVE SPACES TO WSS-IND-ICLIR IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-ICLIR IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-NOMCR IN WSS-VARI.

           IF SCR-OFRM-SRV
               PERFORM CLR-FRM-MTX.
       FIN-CLR-WSS.
           EXIT.

       CLR-FRM-MTX SECTION.
       INI-CLR-FRM-MTX.
           MOVE SPACES TO FRM-IND-PAPRR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-FEC-FINIR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-HRA-HINIR IN QSF-FLD(1).
           MOVE SPACES TO FRM-COD-SISTR IN QSF-FLD(1).
           MOVE SPACES TO FRM-COD-EVENR IN QSF-FLD(1).
           MOVE SPACES TO FRM-CAI-IOPER IN QSF-FLD(1).
           MOVE SPACES TO FRM-IIC-IOPER IN QSF-FLD(1).
           MOVE SPACES TO FRM-EXT-IOPER IN QSF-FLD(1).
           MOVE SPACES TO FRM-MSC-STATR IN QSF-FLD(1).
           MOVE SPACES TO FRM-COD-APRAR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-NUM-NAPRR IN QSF-FLD(1).
           MOVE SPACES TO FRM-COD-BANCR IN QSF-FLD(1).
           MOVE SPACES TO FRM-COD-OFICR IN QSF-FLD(1).
           MOVE SPACES TO FRM-COD-REGNR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-SGV-MNTOR IN QSF-FLD(1).
           MOVE SPACES TO FRM-IND-MNTOR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-NUM-PLZOR IN QSF-FLD(1).
           MOVE SPACES TO FRM-IND-PLZOR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-SGV-TMPRR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-SGV-TMSFR IN QSF-FLD(1).
           MOVE SPACES TO FRM-IND-TAMOR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-SGV-SPPRR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-SGV-SPSFR IN QSF-FLD(1).
           MOVE SPACES TO FRM-IND-SPRDR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-SGV-VARIR IN QSF-FLD(1).
           MOVE SPACES TO FRM-COD-MAILR IN QSF-FLD(1).
           MOVE SPACES TO FRM-COD-EJECR IN QSF-FLD(1).
           MOVE ZEROES TO FRM-NUM-ICLIR IN QSF-FLD(1).
           MOVE SPACES TO FRM-VRF-ICLIR IN QSF-FLD(1).
           MOVE SPACES TO FRM-IND-ICLIR IN QSF-FLD(1).
           MOVE SPACES TO FRM-GLS-ICLIR IN QSF-FLD(1).
           MOVE SPACES TO FRM-GLS-NOMCR IN QSF-FLD(1).

           MOVE SPACES TO FRM-IND-PAPRR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-FEC-FINIR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-HRA-HINIR IN QSF-FLD(2).
           MOVE SPACES TO FRM-COD-SISTR IN QSF-FLD(2).
           MOVE SPACES TO FRM-COD-EVENR IN QSF-FLD(2).
           MOVE SPACES TO FRM-CAI-IOPER IN QSF-FLD(2).
           MOVE SPACES TO FRM-IIC-IOPER IN QSF-FLD(2).
           MOVE SPACES TO FRM-EXT-IOPER IN QSF-FLD(2).
           MOVE SPACES TO FRM-MSC-STATR IN QSF-FLD(2).
           MOVE SPACES TO FRM-COD-APRAR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-NUM-NAPRR IN QSF-FLD(2).
           MOVE SPACES TO FRM-COD-BANCR IN QSF-FLD(2).
           MOVE SPACES TO FRM-COD-OFICR IN QSF-FLD(2).
           MOVE SPACES TO FRM-COD-REGNR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-SGV-MNTOR IN QSF-FLD(2).
           MOVE SPACES TO FRM-IND-MNTOR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-NUM-PLZOR IN QSF-FLD(2).
           MOVE SPACES TO FRM-IND-PLZOR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-SGV-TMPRR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-SGV-TMSFR IN QSF-FLD(2).
           MOVE SPACES TO FRM-IND-TAMOR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-SGV-SPPRR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-SGV-SPSFR IN QSF-FLD(2).
           MOVE SPACES TO FRM-IND-SPRDR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-SGV-VARIR IN QSF-FLD(2).
           MOVE SPACES TO FRM-COD-MAILR IN QSF-FLD(2).
           MOVE SPACES TO FRM-COD-EJECR IN QSF-FLD(2).
           MOVE ZEROES TO FRM-NUM-ICLIR IN QSF-FLD(2).
           MOVE SPACES TO FRM-VRF-ICLIR IN QSF-FLD(2).
           MOVE SPACES TO FRM-IND-ICLIR IN QSF-FLD(2).
           MOVE SPACES TO FRM-GLS-ICLIR IN QSF-FLD(2).
           MOVE SPACES TO FRM-GLS-NOMCR IN QSF-FLD(2).

       FIN-CLR-FRM-MTX.
           EXIT.

       PRO-FLD-QUE SECTION.
       INI-PRO-FLD-QUE.
           MOVE 'P' TO MTI-IND-PAPRR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-FEC-FINIR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-HRA-HINIR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-COD-SISTR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-COD-EVENR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-CAI-IOPER-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-IIC-IOPER-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-EXT-IOPER-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-MSC-STATR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-COD-APRAR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-NUM-NAPRR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-COD-BANCR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-COD-OFICR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-COD-REGNR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-SGV-MNTOR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-IND-MNTOR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-NUM-PLZOR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-IND-PLZOR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-SGV-TMPRR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-SGV-TMSFR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-IND-TAMOR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-SGV-SPPRR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-SGV-SPSFR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-IND-SPRDR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-SGV-VARIR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-COD-MAILR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-COD-EJECR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-NUM-ICLIR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-VRF-ICLIR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-IND-ICLIR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-GLS-ICLIR-ATR IN WSS-VARI.
           MOVE 'P' TO MTI-GLS-NOMCR-ATR IN WSS-VARI.

           MOVE 'P' TO WSS-IND-PAPRR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-FEC-FINIR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-HRA-HINIR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-COD-SISTR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-COD-EVENR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-CAI-IOPER-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-IIC-IOPER-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-EXT-IOPER-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-MSC-STATR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-COD-APRAR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-NUM-NAPRR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-COD-BANCR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-COD-OFICR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-COD-REGNR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-SGV-MNTOR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-IND-MNTOR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-NUM-PLZOR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-IND-PLZOR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-SGV-TMPRR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-SGV-TMSFR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-IND-TAMOR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-SGV-SPPRR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-SGV-SPSFR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-IND-SPRDR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-SGV-VARIR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-COD-MAILR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-COD-EJECR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-NUM-ICLIR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-VRF-ICLIR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-IND-ICLIR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-GLS-ICLIR-ATR IN WSS-VARI.
           MOVE 'P' TO WSS-GLS-NOMCR-ATR IN WSS-VARI.
       FIN-PRO-FLD-QUE.
           EXIT.

       CLR-VEC-DQSF SECTION.
       INI-CLR-VEC-DQSF.
           MOVE ZEROES TO WSS-J.
       LUP-CLR-VEC-DQSF.
           ADD 1 TO WSS-J.
           IF WSS-J > WSS-JMAX
              GO TO FIN-CLR-VEC-DQSF.

           MOVE SPACES TO WSS-IND-PAPRR-V(WSS-J).
           MOVE ZEROES TO WSS-FEC-FINIR-V(WSS-J).
           MOVE ZEROES TO WSS-HRA-HINIR-V(WSS-J).
           MOVE SPACES TO WSS-COD-SISTR-V(WSS-J).
           MOVE SPACES TO WSS-COD-EVENR-V(WSS-J).
           MOVE SPACES TO WSS-CAI-IOPER-V(WSS-J).
           MOVE SPACES TO WSS-IIC-IOPER-V(WSS-J).
           MOVE SPACES TO WSS-EXT-IOPER-V(WSS-J).
           MOVE SPACES TO WSS-MSC-STATR-V(WSS-J).
           MOVE SPACES TO WSS-COD-APRAR-V(WSS-J).
           MOVE ZEROES TO WSS-NUM-NAPRR-V(WSS-J).
           MOVE SPACES TO WSS-COD-BANCR-V(WSS-J).
           MOVE SPACES TO WSS-COD-OFICR-V(WSS-J).
           MOVE SPACES TO WSS-COD-REGNR-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-MNTOR-V(WSS-J).
           MOVE SPACES TO WSS-IND-MNTOR-V(WSS-J).
           MOVE ZEROES TO WSS-NUM-PLZOR-V(WSS-J).
           MOVE SPACES TO WSS-IND-PLZOR-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-TMPRR-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-TMSFR-V(WSS-J).
           MOVE SPACES TO WSS-IND-TAMOR-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-SPPRR-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-SPSFR-V(WSS-J).
           MOVE SPACES TO WSS-IND-SPRDR-V(WSS-J).
           MOVE ZEROES TO WSS-SGV-VARIR-V(WSS-J).
           MOVE SPACES TO WSS-COD-MAILR-V(WSS-J).
           MOVE SPACES TO WSS-COD-EJECR-V(WSS-J).
           MOVE ZEROES TO WSS-NUM-ICLIR-V(WSS-J).
           MOVE SPACES TO WSS-VRF-ICLIR-V(WSS-J).
           MOVE SPACES TO WSS-IND-ICLIR-V(WSS-J).
           MOVE SPACES TO WSS-GLS-ICLIR-V(WSS-J).
           MOVE SPACES TO WSS-GLS-NOMCR-V(WSS-J).

           GO TO LUP-CLR-VEC-DQSF.
       FIN-CLR-VEC-DQSF.
           EXIT.

       CRG-INF-RSFC SECTION.
       INI-CRG-INF-RSFC.
           ADD 1 TO WSS-J.

      *    MOVE SFC-FEC-FINI IN SFC TO WSS-FEC-FINIR-V(WSS-J).
           MOVE SFC-NUM-SINI IN SFC TO WSS-NUM-SINI IN WSS-VARI.
           MOVE SFC-NUM-AINI IN SFC TO WSS-NUM-AINI IN WSS-VARI.
           MOVE SFC-NUM-MINI IN SFC TO WSS-NUM-MINI IN WSS-VARI.
           MOVE SFC-NUM-DINI IN SFC TO WSS-NUM-DINI IN WSS-VARI.
           MOVE WSS-FEC-FINI IN WSS-VARI TO WSS-FEC-FINIR-V(WSS-J).

           MOVE SFC-HRA-HINI IN SFC TO WSS-HRA-HINIR-V(WSS-J).
           MOVE SFC-COD-SIST IN SFC TO WSS-COD-SISTR-V(WSS-J).
           MOVE SFC-COD-EVEN IN SFC TO WSS-COD-EVENR-V(WSS-J).
           MOVE SFC-CAI-IOPE IN SFC TO WSS-CAI-IOPER-V(WSS-J).
           MOVE SFC-IIC-IOPE IN SFC TO WSS-IIC-IOPER-V(WSS-J).
           MOVE SFC-EXT-IOPE IN SFC TO WSS-EXT-IOPER-V(WSS-J).
           MOVE SFC-MSC-STAT IN SFC TO WSS-MSC-STATR-V(WSS-J).
           MOVE SFC-COD-APRA IN SFC TO WSS-COD-APRAR-V(WSS-J).
           MOVE SFC-NUM-NAPR IN SFC TO WSS-NUM-NAPRR-V(WSS-J).
           MOVE SFC-COD-BANC IN SFC TO WSS-COD-BANCR-V(WSS-J).
           MOVE SFC-COD-OFIC IN SFC TO WSS-COD-OFICR-V(WSS-J).
           MOVE SFC-COD-REGN IN SFC TO WSS-COD-REGNR-V(WSS-J).
           MOVE SFC-SGV-MNTO IN SFC TO WSS-SGV-MNTOR-V(WSS-J).
           MOVE SFC-IND-MNTO IN SFC TO WSS-IND-MNTOR-V(WSS-J).
           MOVE SFC-NUM-PLZO IN SFC TO WSS-NUM-PLZOR-V(WSS-J).
           MOVE SFC-IND-PLZO IN SFC TO WSS-IND-PLZOR-V(WSS-J).
           MOVE SFC-SGV-TMPR IN SFC TO WSS-SGV-TMPRR-V(WSS-J).
           MOVE SFC-SGV-TMSF IN SFC TO WSS-SGV-TMSFR-V(WSS-J).
           MOVE SFC-IND-TAMO IN SFC TO WSS-IND-TAMOR-V(WSS-J).
           MOVE SFC-SGV-SPPR IN SFC TO WSS-SGV-SPPRR-V(WSS-J).
           MOVE SFC-SGV-SPSF IN SFC TO WSS-SGV-SPSFR-V(WSS-J).
           MOVE SFC-IND-SPRD IN SFC TO WSS-IND-SPRDR-V(WSS-J).
           MOVE SFC-SGV-VARI IN SFC TO WSS-SGV-VARIR-V(WSS-J).
           MOVE SFC-COD-MAIL IN SFC TO WSS-COD-MAILR-V(WSS-J).
           MOVE SFC-COD-EJEC IN SFC TO WSS-COD-EJECR-V(WSS-J).

           MOVE 'S'                 TO WSS-IND-PAPRR-V(WSS-J).
      *PVG INI 15-ENE-2015
           MOVE WSS-IND-PAPR  IN WSS-VARI TO WSS-IND-PAPRR-V(WSS-J).
      *PVG FIN 15-ENE-2015

           MOVE SFC-CIC-ICLI IN SFC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO WSS-GLS-NOMCR-V(WSS-J)
               MOVE ZEROES              TO WSS-NUM-ICLIR-V(WSS-J)
               MOVE SPACES              TO WSS-IND-ICLIR-V(WSS-J)
               MOVE SPACES              TO WSS-GLS-ICLIR-V(WSS-J)
               MOVE SPACES              TO WSS-VRF-ICLIR-V(WSS-J)
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO WSS-GLS-NOMCR-V(WSS-J)
               MOVE DBC-NUM-ICLI IN DBC TO WSS-NUM-ICLIR-V(WSS-J)
               MOVE DBC-IND-ICLI IN DBC TO WSS-IND-ICLIR-V(WSS-J)
               MOVE DBC-GLS-ICLI IN DBC TO WSS-GLS-ICLIR-V(WSS-J)
               MOVE DBC-VRF-ICLI IN DBC TO WSS-VRF-ICLIR-V(WSS-J).
       FIN-CRG-INF-RSFC.
           EXIT.

       PRO-BUS-BNCO SECTION.
       INI-PRO-BUS-BNCO.
           MOVE SPACES TO WSS-COD-BNCO IN WSS-VARI.

           MOVE 'MC2'               TO TAB-COD-SIST.
           MOVE 'AGB'               TO TAB-COD-TTAB IN TAB.
           MOVE SFC-COD-BANC IN SFC TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES              TO WSS-COD-BNCO IN WSS-VARI
           ELSE
              MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-BNCO IN WSS-VARI.
       FIN-PRO-BUS-BNCO.
           EXIT.

       PRO-BUS-CEPL SECTION.
       INI-PRO-BUS-CEPL.
           MOVE 'N' TO WSS-IND-NXTR IN WSS-VARI.

       FIN-PRO-BUS-CEPL.
           EXIT.

       PRO-BUS-IROL SECTION.
       INI-PRO-BUS-IROL.
           MOVE 'N'    TO WSS-IND-NXTR IN WSS-VARI.
           MOVE SPACES TO WSS-GLS-NAPR IN WSS-VARI.

           MOVE 'MC2'                    TO TAB-COD-SIST.
           MOVE WSS-COD-BNCO IN WSS-VARI TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-IROL IN QSF-FLD  TO TAB-COD-CTAB IN TAB.

           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE 'S' TO WSS-IND-NXTR IN WSS-VARI
              GO TO FIN-PRO-BUS-IROL.
           IF TAB-COD-DAT3 IN TAB(1) NOT NUMERIC
              MOVE ZEROES TO WSS-NUM-NAPR IN WSS-VARI
           ELSE
              MOVE TAB-COD-DAT3 IN TAB(1) TO
                   WSS-GLS-NAPR IN WSS-VARI.
           IF SFC-NUM-NAPR IN SFC > WSS-NUM-NAPR IN WSS-VARI
              MOVE 'S' TO WSS-IND-NXTR IN WSS-VARI.
      *PVG INI 15-ENE-2015
           MOVE 'N' TO WSS-IND-NXTR IN WSS-VARI.
           IF SFC-NUM-NAPR IN SFC > WSS-NUM-NAPR IN WSS-VARI
               MOVE 'N' TO WSS-IND-PAPR IN WSS-VARI
           ELSE
               MOVE 'S' TO WSS-IND-PAPR IN WSS-VARI.
      *PVG FIN 15-ENE-2015
       FIN-PRO-BUS-IROL.
           EXIT.

      *>>>> EOF
*% END
