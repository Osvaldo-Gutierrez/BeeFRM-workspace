*% PGM_PTC = TRUE
*% IF CMT_ID_PQ
      *-----------------------------------------------------------------
      *  MODIFICACIONES:
      *  ---------------
      *  AUTOR      : BEE-CIMA-OGB
      *  FECHA      : 2018-05-17
      *  ETIQUETA   : OGB-INI 17-MAY-2018 GESTOR PRECIOS DAP 
      *  PROYECTO   : GESTOR PRECIOS DAP 
      *  CAMBIOS    : 1. CORREGIR VALIDACION CAMPO HORA
      *-----------------------------------------------------------------
*% END
*% IF PGM_PQ
*% IF WSS
      *<<<< WSS                                                         
       COPY GNSWCVRF.                                                   
       COPY GNSWVVRF.                                                   
       COPY MC2BRPTI.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTI-REQA==.        
       COPY GNSBRCIC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.        
       COPY GNSWGCIC.                                                   
       COPY GNSBRMSC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.        
                                                                        
       COPY GNSWGCPT.                                                   
       COPY MC2WXCIN.                                                   
      *PVG INI 29-JUN-2007 TRF                                          
       COPY MC2WXMCT.                                                   
      *PVG FIN 29-JUN-2007                                              
                                                                        
       01  WSS-VARI.                                                    
           03 WSS-GLS-FHIN.                                             
              05 WSS-FEC-FINI.                                          
                 07 WSS-NUM-SINI                        PIC 9(02).      
                 07 WSS-NUM-AINI                        PIC 9(02).      
                 07 WSS-NUM-MINI                        PIC 9(02).      
                 07 WSS-NUM-DINI                        PIC 9(02).      
              05 WSS-HRA-HINI.                                          
                 07 WSS-NUM-HHIN                        PIC 9(02).      
                 07 WSS-NUM-MMIN                        PIC 9(02).      
                 07 WSS-NUM-SSIN                        PIC 9(02).      
           03 WSS-GLS-FHTR.                                             
              05 WSS-FEC-FTER.                                          
                 07 WSS-NUM-STER                        PIC 9(02).      
                 07 WSS-NUM-ATER                        PIC 9(02).      
                 07 WSS-NUM-MTER                        PIC 9(02).      
                 07 WSS-NUM-DTER                        PIC 9(02).      
              05 WSS-HRA-HTER.                                          
                 07 WSS-NUM-HHTR                        PIC 9(02).      
                 07 WSS-NUM-MMTR                        PIC 9(02).      
                 07 WSS-NUM-SSTR                        PIC 9(02).      
           03 WSS-COD-CAUX.                                             
              05 WSS-COD-TOOC                           PIC X(03).      
              05 WSS-COD-AOOC                           PIC X(03).      
           03 WSS-COD-MENY        VALUE SPACES          PIC X(12).      
           03 WSS-COD-MENN        VALUE SPACES          PIC X(12).      
           03 WSS-COD-EVEN.                                             
              05 WSS-COD-SIST                           PIC X(03).      
              05 WSS-COD-EVTO                           PIC X(06).      
           03 WSS-CIC-PPTI.                                             
              05 WSS-GLS-PPTI VALUE 'CIC='              PIC X(04).      
              05 WSS-CPT-CAI                            PIC X(04).      
              05 WSS-CPT-IIC                            PIC X(08).      
           03 WSS-COD-VCAM.                                             
              05 WSS-COD-TVTI                           PIC X(01).      
              05 WSS-COD-CVTI                           PIC X(03).      
              05 WSS-COD-TCTI                           PIC X(02).      
           03 WSS-K            VALUE ZEROES             PIC 9(02).      
           03 WSS-KMAX         VALUE ZEROES             PIC 9(02).      
           03 WSS-MAX-KMAX     VALUE  99                PIC 9(02).      
           03 WSS-VEC-PLZO OCCURS 100.                                  
              05 WSS-NUM-PLZO-V                         PIC 9(05).      
                                                                        
           03 WSS-VAL-MNTO-ANT    VALUE ZEROES          PIC 9(13).      
           03 WSS-NUM-NCOL        VALUE ZEROES          PIC 9(02).      
           03 WSS-NUM-NCOL-X02    VALUE ZEROES          PIC 9(02).      
           03 WSS-NUM-NCOL-X03    VALUE ZEROES          PIC 9(02).      
           03 WSS-NUM-NCOL-X05    VALUE ZEROES          PIC 9(02).      
           03 WSS-NUM-NCOL-X06    VALUE ZEROES          PIC 9(02).      
                                                                        
           03 WSS-NUM-NFIL        VALUE ZEROES          PIC 9(02).      
           03 WSS-NUM-NFIL-X04    VALUE ZEROES          PIC 9(02).      
           03 WSS-NUM-NFIL-X07    VALUE ZEROES          PIC 9(02).      
           03 WSS-VEC-MNTO OCCURS 50.                                   
              05 WSS-CIN-MNTO      VALUE ZEROES         PIC 9(13).      
           03 WSS-MNTO             VALUE ZEROES         PIC 9(03).      
           03 WSS-VEC-PLZO OCCURS 50.                                   
              05 WSS-CIN-PLZO      VALUE ZEROES         PIC 9(05).      
           03 WSS-PLZO             VALUE ZEROES         PIC 9(03).      
           03 WSS-GLS-OPRN.
              05  WSS-COD-TCPT                          PIC X(01).
              05  WSS-COD-TSCP                          PIC X(01).
              05  WSS-GLS-FIL1    VALUE SPACES          PIC X(10).
                                                                        
      *>>>>                                                             
*% END
*% END
*% IF INI_FIO
      *<<<< INI_FIO                                                     
           IF SCR-OFRM-SRV                                              
                MOVE TSK-TERM-ALF TO CIN-COD-TERM-CIC                   
           ELSE                                                         
                MOVE EIBTRMID     TO CIN-COD-TERM-CIC.                  
      *>>>>                                                             
*% END
*% IF INI_FND_KEY
      *<<<< FND_KEY                                                     
           PERFORM KEY-ALL-CIN.                                         
           IF SCR-CCPP = 'ING'                                          
               MOVE 'I'                     TO CIN-IND-VIGE IN CIN-FLD  
               MOVE 'GNS'                   TO TAB-COD-SIST             
               MOVE 'STT'                   TO TAB-COD-TTAB IN TAB      
               MOVE CIN-IND-VIGE IN CIN-FLD TO TAB-COD-CTAB IN TAB      
               PERFORM BUS-TAB                                          
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-VIGE IN CIN-FLD.     
                                                                        
           IF SCR-CCPP = 'ING'                                          
              PERFORM VRF-CIN-ANT                                       
              IF MSG-COD-MENS NOT > SPACES                              
                 PERFORM KEY-ALL-CIN                                    
              ELSE                                                      
                 GO TO SIG-FND-KEY.                                     
      *PVG INI 29-JUN-2007 TRF                                          
           IF (SCR-OFRM-SRV AND SCR-CMND = 'CON' AND                    
               CIN-CAI-ICIN IN CIN = MCT-CAI-CINT IN MCT-VARI)          
              MOVE CIN-IIC-ICIN  IN CIN      TO QUE-COLA                
              MOVE MCT-LEN-TSMCT IN MCT-VARI TO QUE-LITM                
              MOVE +1                        TO QUE-NITM                
              MOVE QUE-GET                   TO QUE-CMND                
              PERFORM GNS-PRO-QUE                                       
              IF QUE-STAT = QUE-STAT-OKS                                
                 MOVE '00'     TO FIO-STAT                              
                 MOVE FIO-STAT TO PGM-STAT-CIN                          
                 MOVE QUE-ITEM TO MCT-GLS-PLAN-I IN MCT-VARI            
                 PERFORM CRG-TRF-CIN                                    
                 GO TO FIN-FND-KEY.                                     
      *PVG FIN 29-JUN-2007                                              
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY                                                 
           IF NOT FIO-STAT-OKS                                          
               MOVE '23' TO PGM-STAT-CIN                                
           ELSE                                                         
               MOVE '00' TO PGM-STAT-CIN.                               
           IF SCR-CMND = 'ING' AND NOT FIO-STAT-OKS                     
              MOVE 'N' TO FRM-COD-CPT1 IN CIN-FLD                       
              MOVE 'N' TO FRM-COD-CPT2 IN CIN-FLD                       
              MOVE 'N' TO FRM-COD-CPT3 IN CIN-FLD                       
              MOVE 'N' TO FRM-COD-CPT4 IN CIN-FLD                       
              GO TO FIN-FND-KEY.                                        
                                                                        
           IF SCR-CMND = 'CON'                                          
              GO TO FIN-FND-KEY.                                        
                                                                        
           IF CIN-MSC-STAT IN CIN = 'D'                                 
              MOVE 'CIN    ANLYA' TO MSG-COD-MENS                       
              GO TO SIG-FND-KEY.                                        
                                                                        
           IF CIN-MSC-STAT IN CIN = 'A'                                 
              IF SCR-CMND NOT = 'ANL'                                   
                 MOVE 'CIN    ACAYA' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
                                                                        
           IF CIN-MSC-STAT IN CIN = 'V'                                 
              IF SCR-CMND = 'ANL'                                       
                 MOVE 'CIN    ACANO' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
                                                                        
           IF  SCR-CMND = 'VRF'                                         
              IF CIN-MSC-STAT IN CIN = 'I' OR 'M'                       
                 GO TO FIN-FND-KEY                                      
              ELSE                                                      
                 MOVE 'CMN      INV' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
                                                                        
           IF  SCR-CMND = 'ACA'                                         
              IF CIN-MSC-STAT IN CIN = 'V'                              
                 GO TO FIN-FND-KEY                                      
              ELSE                                                      
                 MOVE 'CMN      INV' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
                                                                        
           IF  SCR-CMND = 'ANL'                                         
              IF CIN-MSC-STAT IN CIN = 'A'                              
                 GO TO FIN-FND-KEY                                      
              ELSE                                                      
                 MOVE 'CMN      INV' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
                                                                        
           IF  SCR-CMND = 'ELI'                                         
              IF CIN-MSC-STAT IN CIN = 'I' OR 'V'                       
                 GO TO FIN-FND-KEY                                      
              ELSE                                                      
                 MOVE 'CMN      INV' TO MSG-COD-MENS                    
                 GO TO SIG-FND-KEY.                                     
                                                                        
           GO TO FIN-FND-KEY.                                           
                                                                        
       SIG-FND-KEY.                                                     
           MOVE 'TAB'        TO MSG-COD-SIST.                           
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE '00'         TO FIO-STAT.                               
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           GO TO FIN-FND-KEY.                                           
      *>>>>                                                             
*% END
*% IF EOF
      *<<<<
       PGM-EBR-ALL SECTION.                                             
       INI-PGM-EBR-ALL.                                                 
           MOVE 'GNS' TO FIO-SIST.                                      
           MOVE FIO-EBR-ALL TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
       FIN-PGM-EBR-ALL.                                                 
           EXIT.                                                        
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF                                                         
       OBT-CIC-CIN SECTION.                                             
       INI-OBT-CIC-CIN.                                                 
           MOVE 'PPTI'  TO CIC-CAI-ICIC IN CIC.                         
           MOVE CIC-GET TO CIC-CMND.                                    
           PERFORM PRO-CIC.                                             
           IF CIC-STAT NOT = CIC-STAT-OKS                               
               MOVE CIC-MENS     TO FRM-MENS                            
               MOVE FIO-STAT-NEX TO FIO-STAT                            
           ELSE                                                         
               MOVE CIC-CAI-ICIC TO WSS-CPT-CAI                         
               MOVE CIC-IIC-ICIC TO WSS-CPT-IIC                         
               MOVE WSS-CIC-PPTI TO FRM-MEN1.                           
       FIN-OBT-CIC-CIN.                                                 
           EXIT.                                                        
                                                                        
       ELI-PTI SECTION.                                                 
       INI-ELI-PTI.                                                     
           MOVE CIN-CIC-IPTI IN CIN TO PTI-CIC-IPTI IN PTI.             
           MOVE SPACES              TO PTI-COD-TVAL IN PTI.             
           MOVE ZEROES              TO PTI-VAL-MNTO IN PTI.             
           MOVE ZEROES              TO PTI-NUM-PLZO IN PTI.             
           MOVE FIO-GET-NLS         TO FIO-CMND.                        
           PERFORM MC2-FIO-CIN.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              PTI-CIC-IPTI IN PTI = CIN-CIC-IPTI IN CIN)                
              GO TO FIN-ELI-PTI.                                        
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM MC2-FIO-PTI.                                         
           IF FIO-STAT-OKS                                              
              MOVE FIO-DEL TO FIO-CMND                                  
              PERFORM MC2-FIO-PTI                                       
              IF NOT FIO-STAT-OKS                                       
                 GO TO FIN-ELI-PTI.                                     
                                                                        
           GO TO INI-ELI-PTI.                                           
       FIN-ELI-PTI.                                                     
           EXIT.                                                        
                                                                        
       VRF-CIN-ANT SECTION.                                             
       INI-VRF-CIN-ANT.                                                 
      *PVG INI 18-MAR-2009 HABILITA CONCEPTOS DISTINTAS MONEDAS         
           GO TO FIN-VRF-CIN-ANT.                                       
      *PVG FIN 18-MAR-2009                                              
           MOVE SPACES      TO CIN-COD-EVEN IN CIN.                     
           MOVE SPACES      TO CIN-COD-VCOC IN CIN.                     
           MOVE SPACES      TO CIN-IND-TPLT IN CIN.                     
           MOVE 99999999    TO CIN-FEC-FINI IN CIN.                     
           MOVE 999999      TO CIN-HRA-HINI IN CIN.                     
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM MC2-FIO-CIN.                                         
           IF NOT ( FIO-STAT-OKS                                  AND   
                    CIN-CAI-ICIN IN CIN = CIN-CAI-ICIN IN CIN-FLD AND   
                    CIN-IIC-ICIN IN CIN = CIN-IIC-ICIN IN CIN-FLD AND   
                    CIN-COD-SIST IN CIN = CIN-COD-SIST IN CIN-FLD )     
              GO TO FIN-VRF-CIN-ANT.                                    
      *                                                                 
      *ANALIZA INCONSISTENCIA DE MONEDA CON RESPECTO A CIN ANTERIORES   
      *POR DEFINICION DADO UN CODIGO Y UN SISTEMA NO ES POSIBLE VARIAR  
      *EN EL TIEMPO EL TIPO DE MONEDA ASOCIADO A LA PLANTILLA           
           IF NOT CIN-COD-VCOC IN CIN = CIN-COD-VCOC IN CIN-FLD         
              MOVE 'VCOC  INCANT' TO MSG-COD-MENS.                      
      *                                                                 
       FIN-VRF-CIN-ANT.                                                 
           EXIT.                                                        
                                                                        
      *PVG INI 29-JUN-2007 TRF                                          
       CRG-TRF-CIN SECTION.                                             
       INI-CRG-TRF-CIN.                                                 
           MOVE MCT-COD-PLAN-I IN MCT-VARI TO CIN-CIC-ICIN IN CIN.      
           MOVE MCT-COD-SIST-I IN MCT-VARI TO CIN-COD-SIST IN CIN.      
           MOVE MCT-COD-EVEN-I IN MCT-VARI TO CIN-COD-EVEN IN CIN.      
           MOVE MCT-COD-VCOC-I IN MCT-VARI TO CIN-COD-VCOC IN CIN.      
           MOVE MCT-IND-TPLT-I IN MCT-VARI TO CIN-IND-TPLT IN CIN.      
           MOVE MCT-STP-FINI-I IN MCT-VARI TO CIN-STP-FINI IN CIN.      
           MOVE MCT-MSC-UTPT-I IN MCT-VARI TO CIN-MSC-UTPT IN CIN.      
           MOVE MCT-COD-PLAN-I IN MCT-VARI TO CIN-CIC-IPTI IN CIN.      
           MOVE MCT-COD-TINT-I IN MCT-VARI TO CIN-COD-TINT IN CIN.      
                                                                        
           MOVE CIN-STP-FINI IN CIN        TO CIN-STP-ITRN IN CIN.      
           MOVE 'I'                        TO CIN-MSC-TACC IN CIN.      
           MOVE 'A'                        TO CIN-MSC-STAT IN CIN.      
           MOVE SPACES                     TO CIN-COD-OTRN IN CIN.      
           MOVE SPACES                     TO CIN-COD-ATRN IN CIN.      
           MOVE SPACES                     TO CIN-COD-COMT IN CIN.      
           MOVE SPACES                     TO CIN-GLS-FLAG IN CIN.      
           MOVE SPACES                     TO CIN-GLS-DISP IN CIN.      
       FIN-CRG-TRF-CIN.                                                 
           EXIT.
      *PVG FIN 29-JUN-2007                                              
       COPY GNSBGCIC.                                                   
       COPY GNSBVCOD.                                                   
       COPY GNSBVMSC.                                                   
       COPY GNSBVIND.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBBTAB.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBFMSC.                                                   
       COPY GNSBGVSM.                                                   
       COPY GNSBGCPT.                                                   
       COPY MC2BFPTI.                                                   
       COPY GNSBFCIC.                                                   
       COPY GNSBPVRF.                                                   
      *>>>>                                                             
*% END
*% IF PGM_PU
*% IF WSS
      *<<<< WSS                                                         
       COPY GNSWCVRF.                                                   
       COPY GNSWVVRF.                                                   
       COPY MC2BRPTI.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTI-REQA==.        
       COPY GNSBRCIC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.        
       COPY GNSWGCIC.                                                   
       COPY GNSBRMSC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.        
                                                                        
       COPY GNSWGCPT.                                                   
       COPY MC2WXCIN.                                                   
                                                                        
       01  WSS-VARI.                                                    
           03 WSS-GLS-FHIN.                                             
              05 WSS-FEC-FINI.                                          
                 07 WSS-NUM-SINI                        PIC 9(02).      
                 07 WSS-NUM-AINI                        PIC 9(02).      
                 07 WSS-NUM-MINI                        PIC 9(02).      
                 07 WSS-NUM-DINI                        PIC 9(02).      
              05 WSS-HRA-HINI.                                          
                 07 WSS-NUM-HHIN                        PIC 9(02).      
                 07 WSS-NUM-MMIN                        PIC 9(02).      
                 07 WSS-NUM-SSIN                        PIC 9(02).      
           03 WSS-GLS-FHTR.                                             
              05 WSS-FEC-FTER.                                          
                 07 WSS-NUM-STER                        PIC 9(02).      
                 07 WSS-NUM-ATER                        PIC 9(02).      
                 07 WSS-NUM-MTER                        PIC 9(02).      
                 07 WSS-NUM-DTER                        PIC 9(02).      
              05 WSS-HRA-HTER.                                          
                 07 WSS-NUM-HHTR                        PIC 9(02).      
                 07 WSS-NUM-MMTR                        PIC 9(02).      
                 07 WSS-NUM-SSTR                        PIC 9(02).      
           03 WSS-COD-CAUX.                                             
              05 WSS-COD-TOOC                           PIC X(03).      
              05 WSS-COD-AOOC                           PIC X(03).      
           03 WSS-COD-MENY        VALUE SPACES          PIC X(12).      
           03 WSS-COD-MENN        VALUE SPACES          PIC X(12).      
           03 WSS-COD-EVEN.                                             
              05 WSS-COD-SIST                           PIC X(03).      
              05 WSS-COD-EVTO                           PIC X(06).      
           03 WSS-CIC-PPTI.                                             
              05 WSS-GLS-PPTI VALUE 'CIC='              PIC X(04).      
              05 WSS-CPT-CAI                            PIC X(04).      
              05 WSS-CPT-IIC                            PIC X(08).      
           03 WSS-COD-VCAM.                                             
              05 WSS-COD-TVTI                           PIC X(01).      
              05 WSS-COD-CVTI                           PIC X(03).      
              05 WSS-COD-TCTI                           PIC X(02).      
           03 WSS-COD-CTAB.                                             
              05 WSS-COD-CTA1     VALUE SPACES          PIC X(04).      
              05 WSS-COD-CTA2     VALUE SPACES          PIC X(08).      
           03 WSS-VAL-TASA        VALUE ZEROES          PIC S9(04)V9(4).
           03 WSS-VAL-PBPZ        VALUE ZEROES          PIC S9(04)V9(4).
           03 WSS-VAL-PBMT        VALUE ZEROES          PIC S9(04)V9(4).
           03 WSS-VAL-MNTO-MAX    VALUE 9999999999999   PIC 9(13).      
           03 WSS-NUM-PLZO-MAX    VALUE 99999           PIC 9(05).      
           03 WSS-VAL-MNTO-R      VALUE ZEROES          PIC 9(13).      
           03 WSS-NUM-PLZO-R      VALUE ZEROES          PIC 9(05).      
           03 WSS-SGV-TPBT         VALUE ZEROES         PIC S9(04)V9(4).
           03 WSS-SGV-TAPB         VALUE ZEROES         PIC S9(04)V9(4).
           03 WSS-SGV-TAMB         VALUE ZEROES         PIC S9(04)V9(4).
           03 WSS-SGV-TPST         VALUE ZEROES         PIC S9(04)V9(4).
           03 WSS-SGV-TAPS         VALUE ZEROES         PIC S9(04)V9(4).
           03 WSS-SGV-TAMS         VALUE ZEROES         PIC S9(04)V9(4).
           03 WSS-MEN2.                                                 
              05 WSS-GLS-MNTO      VALUE 'MONTO : '     PIC X(08).      
              05 WSS-VAL-MNTO      VALUE ZEROES         PIC 9(13).      
              05 WSS-GLS-FILL      VALUE SPACES         PIC X(02).      
              05 WSS-GLS-PLZO      VALUE 'PLAZO : '     PIC X(08).      
              05 WSS-NUM-PLZO      VALUE ZEROES         PIC 9(05).      
                                                                        
           03 WSS-COD-TINT-INT.                                         
              05 WSS-MSC-BCTI-INT                       PIC X(01).      
              05 WSS-MSC-PBTI-INT                       PIC X(01).      
              05 WSS-MSC-BPBT-INT                       PIC X(01).      
              05 WSS-MSC-SPBT-INT                       PIC X(01).      
              05 WSS-COD-CVTI-INT                       PIC X(03).      
              05 WSS-MSC-TFPR-INT                       PIC X(01).      
              05 WSS-NUM-PREP-INT                       PIC 9(03).      
              05 WSS-MSC-UTPR-INT                       PIC X(01).      
                                                                        
           03 WSS-COD-TINT-SVC.                                         
              05 WSS-MSC-BCTI-SVC  VALUE 'I'            PIC X(01).      
              05 WSS-COD-CVTI-SVC                       PIC X(03).      
              05 WSS-MSC-PBTI-SVC                       PIC X(01).      
              05 WSS-MSC-BPBT-SVC  VALUE ' '            PIC X(01).      
              05 WSS-COD-VCOC-SVC                       PIC X(06).      
                                                                        
           03 WSS-VEC-MNTO OCCURS 50.                                   
              05 WSS-CIN-MNTO      VALUE ZEROES         PIC 9(13).      
           03 WSS-MNTO             VALUE ZEROES         PIC 9(03).      
           03 WSS-VEC-PLZO OCCURS 50.                                   
              05 WSS-CIN-PLZO      VALUE ZEROES         PIC 9(05).      
           03 WSS-PLZO             VALUE ZEROES         PIC 9(03).      
           03 WSS-BKP-PTI          VALUE SPACES         PIC X(90).      
                                                                        
           03 WSS-GLS-OPRN.
              05  WSS-COD-TCPT                          PIC X(01).
              05  WSS-COD-TSCP                          PIC X(01).
              05  WSS-GLS-FIL1    VALUE SPACES          PIC X(10).
      *>>>>                                                             
*% END
*% END
*% IF INI_CMN_MOD
      *<<<< INI_CMN_MOD                                                 
           IF CIN-IND-VIGE IN CIN-FLD = 'A'                             
               MOVE 'S' TO SCR-IERR                                     
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'CINACA NOMOD' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-MOD.                                       
                                                                        
           IF CIN-IND-VIGE IN CIN-FLD = 'D'                             
               MOVE 'S' TO SCR-IERR                                     
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'CINANL NOMOD' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-MOD.                                       
                                                                        
           MOVE 'I' TO CIN-IND-VIGE IN CIN-FLD.                         
      *>>>>                                                             
*% END    
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD                                                 
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
           MOVE FIO-STAT TO PGM-STAT-CIN.                               
      *PVG INI 07-SEP-2004 PRECIOS                                      
           IF SCR-OFRM-SRV                                              
              PERFORM ELI-ALL-PTI                                       
              IF MSG-COD-MENS > SPACES                                  
                 MOVE 'S'            TO SCR-IERR                        
                 MOVE 'TAB'          TO MSG-COD-SIST                    
                 MOVE 'ELIALLPTIERR' TO MSG-COD-MENS                    
                 PERFORM GET-MSG                                        
                 MOVE MSG-GLS-DESC   TO FRM-MENS                        
                 GO TO FIN-CMN-MOD.                                     
      *PVG FIN 07-SEP-2004 PRECIOS                                      
           MOVE PGM-STAT-CIN TO FIO-STAT .                              
                                                                        
           MOVE CIN-CAI-IPTI IN CIN TO CIN-CAI-IPTI-TS.                 
           MOVE CIN-IIC-IPTI IN CIN TO CIN-IIC-IPTI-TS.                 
           MOVE CIN-NOM-TS-CICCIN   TO QUE-COLA.                        
           MOVE CIN-LEN-TS-CICCIN   TO QUE-LITM.                        
           MOVE CIN-ITEM-CICCIN     TO QUE-ITEM.                        
           MOVE QUE-PUT        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
                                                                        
                                                                        
           MOVE 'TAB'               TO FIO-SIST.                        
           MOVE 'DPL'               TO TAB-COD-TTAB IN TAB.             
           MOVE CIN-CIC-IPTI IN CIN TO TAB-COD-CTAB IN TAB.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
           MOVE FRM-COD-CIN1 IN CIN-FLD TO TAB-GLS-DESC IN TAB.         
           MOVE FRM-COD-CIN2 IN CIN-FLD TO TAB-GLS-DATA IN TAB.         
           PERFORM GET-FHOY.                                            
           MOVE HOY-FHOY                 TO TAB-FEC-FTRN IN TAB.        
           MOVE HOY-HHOY                 TO TAB-HRA-HRTR IN TAB.        
           MOVE SCR-OTRN                 TO TAB-COD-OTRN IN TAB.        
           MOVE SCR-USER                 TO TAB-COD-ATRN IN TAB.        
                                                                        
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-MOD.                                       
                                                                        
      *>>>>                                                             
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING                                                 
           PERFORM OBT-CIC-CIN.                                         
           IF CIC-STAT NOT = CIC-STAT-OKS                               
              GO TO FIN-CMN-ING.                                        
           MOVE CIC-CAI-ICIC IN CIC TO CIN-CAI-IPTI IN CIN.             
           MOVE CIC-IIC-ICIC IN CIC TO CIN-IIC-IPTI IN CIN.             
           MOVE CIC-CAI-ICIC IN CIC TO CIN-CAI-IPTI IN CIN-FLD.         
           MOVE CIC-IIC-ICIC IN CIC TO CIN-IIC-IPTI IN CIN-FLD.         
           MOVE 'TAB'                   TO FIO-SIST.                    
           MOVE 'DPL'                   TO TAB-COD-TTAB IN TAB.         
           MOVE CIN-CIC-IPTI IN CIN     TO TAB-COD-CTAB IN TAB.         
           MOVE FRM-COD-CIN1 IN CIN-FLD TO TAB-GLS-DESC IN TAB.         
           MOVE FRM-COD-CIN2 IN CIN-FLD TO TAB-GLS-DATA IN TAB.         
           MOVE 'I'                     TO TAB-MSC-TACC IN TAB.         
           MOVE 'I'                     TO TAB-MSC-STAT IN TAB.         
           MOVE 'S'                     TO TAB-IND-VIGE IN TAB.         
           MOVE SPACES                  TO TAB-COD-OTRN IN TAB.         
           MOVE 'MC2PUCIN'              TO TAB-COD-ATRN IN TAB.         
           MOVE WSS-COD-CTAB IN WSS-VARI TO TAB-GLS-DCOR IN TAB.        
           MOVE WSS-COD-CTA1 IN WSS-VARI TO TAB-GLS-ABRV IN TAB.        
           PERFORM GET-FHOY.                                            
           MOVE HOY-FHOY                 TO TAB-FEC-FTRN IN TAB.        
           MOVE HOY-HHOY                 TO TAB-HRA-HRTR IN TAB.        
           MOVE SCR-OTRN                 TO TAB-COD-OTRN IN TAB.        
           MOVE SCR-USER                 TO TAB-COD-ATRN IN TAB.        
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM GNS-FIO-TAB.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'TAB'               TO MSG-COD-SIST                  
              MOVE 'DPL    NOGRB'      TO MSG-COD-MENS                  
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC        TO FRM-MENS.                     
      *>>>>                                                             
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING                                                 
           IF NOT (FIO-STAT-OKS AND SCR-OFRM-SRV)                       
                 GO TO FIN-CMN-ING.                                     
                                                                        
           MOVE CIN-CAI-IPTI IN CIN TO CIN-CAI-IPTI-TS.                 
           MOVE CIN-IIC-IPTI IN CIN TO CIN-IIC-IPTI-TS.                 
           MOVE CIN-NOM-TS-CICCIN   TO QUE-COLA                         
           MOVE CIN-LEN-TS-CICCIN   TO QUE-LITM.                        
           MOVE CIN-ITEM-CICCIN     TO QUE-ITEM.                        
           MOVE QUE-PUT        TO QUE-CMND.                             
           PERFORM GNS-PRO-QUE.                                         
                                                                        
      *>>>>                                                             
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC                                                 
           IF SCR-CMND = 'VRF' AND                                      
              CIN-IND-VIGE IN CIN-FLD NOT = 'I'                         
               MOVE 'S' TO SCR-IERR                                     
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'CINNOI NOVRF' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-ACC.                                       
                                                                        
           IF SCR-CMND = 'ACA' AND                                      
              CIN-IND-VIGE IN CIN-FLD NOT = 'V'                         
               MOVE 'S' TO SCR-IERR                                     
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'CINNOV NOACA' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-ACC.                                       
                                                                        
           IF SCR-CMND = 'ANL' AND                                      
              CIN-IND-VIGE IN CIN-FLD NOT = 'A'                         
               MOVE 'S' TO SCR-IERR                                     
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'CINNOA NOANL' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-ACC.                                       
                                                                        
           IF SCR-CMND = 'VRF'                                          
               PERFORM PRO-CMN-VRF                                      
               IF MSG-COD-MENS > SPACES                                 
      *            MOVE 'S' TO SCR-IERR                                 
      *            MOVE 'VRFNOT    ' TO MSG-COD-MENS                    
      *            MOVE 'GNS' TO MSG-COD-SIST                           
      *            PERFORM GET-MSG                                      
      *            MOVE MSG-GLS-DESC TO FRM-MEN1                        
                  GO TO FIN-CMN-ACC.                                    
                                                                        
      *>>>>                                                             
*% END
*% IF CMN_ACC_RET
      *<<<< CMN_ACC_RET                                                 
           IF SCR-CMND = 'VRF'                                          
               MOVE 'V' TO CIN-IND-VIGE IN CIN                          
               MOVE 'VRFYES    ' TO WSS-COD-MENY                        
               MOVE 'VRFNOT    ' TO WSS-COD-MENN                        
           ELSE                                                         
           IF SCR-CMND = 'ACA'                                          
               MOVE 'A' TO CIN-IND-VIGE IN CIN                          
               MOVE 'ACAYES    ' TO WSS-COD-MENY                        
               MOVE 'ACANOT    ' TO WSS-COD-MENN                        
           ELSE                                                         
           IF SCR-CMND = 'ANL'                                          
               MOVE 'D' TO CIN-IND-VIGE IN CIN                          
               MOVE 'ANLYES    ' TO WSS-COD-MENY                        
               MOVE 'ANLNOT    ' TO WSS-COD-MENN.                       
      *>>>>                                                             
      *<<<< CMN_ACC                                                     
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM MC2-FIO-CIN.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S' TO SCR-IERR                                     
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE WSS-COD-MENN TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
           ELSE                                                         
               MOVE WSS-COD-MENY  TO MSG-COD-MENS                       
               MOVE 'GNS' TO MSG-COD-SIST                               
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MEN1.                           
      *>>>>                                                             
*% END
*% IF INI_CMN_ELI
      *<<<< INI_CMN_ELI                                                 
           IF CIN-IND-VIGE IN CIN-FLD = 'A'                             
               MOVE 'S' TO SCR-IERR                                     
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'CINACA NOELI' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-ELI.                                       
                                                                        
           IF CIN-IND-VIGE IN CIN-FLD = 'D'                             
               MOVE 'S' TO SCR-IERR                                     
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'CINANL NOELI' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               GO TO FIN-CMN-ELI.                                       
      *>>>>                                                             
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI                                                 
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-CMN-ELI.                                       
                                                                        
           MOVE FIO-STAT TO PGM-STAT-CIN.                               
           PERFORM ELI-ALL-PTI.                                         
           MOVE PGM-STAT-CIN TO FIO-STAT.                               
           IF MSG-COD-MENS > SPACES                                     
              MOVE 'S'            TO SCR-IERR                           
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'ELIALLPTIERR' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              GO TO FIN-CMN-ELI.                                        
      *>>>>                                                             
*% END
*% IF EOF_PU
      *<<<< EOF                                                         
       OBT-CIC-CIN SECTION.                                             
       INI-OBT-CIC-CIN.                                                 
           MOVE 'PPTI'  TO CIC-CAI-ICIC IN CIC.                         
           MOVE CIC-GET TO CIC-CMND.                                    
           PERFORM PRO-CIC.                                             
           IF CIC-STAT NOT = CIC-STAT-OKS                               
               MOVE CIC-MENS     TO FRM-MENS                            
               MOVE FIO-STAT-NEX TO FIO-STAT                            
           ELSE                                                         
               MOVE CIC-CAI-ICIC TO WSS-CPT-CAI                         
               MOVE CIC-IIC-ICIC TO WSS-CPT-IIC                         
               MOVE WSS-CIC-PPTI TO FRM-MEN1.                           
       FIN-OBT-CIC-CIN.                                                 
           EXIT.                                                        
                                                                        
       PRO-CMN-VRF SECTION.                                             
       INI-PRO-CMN-VRF.                                                 
           MOVE CIN-CAI-IPTI IN CIN-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE CIN-IIC-IPTI IN CIN-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE 'X01'                   TO PTI-COD-TVAL IN PTI.         
           MOVE ZEROES                  TO PTI-VAL-MNTO IN PTI.         
           MOVE ZEROES                  TO PTI-NUM-PLZO IN PTI.         
           MOVE FIO-GET-NLS TO FIO-CMND.                                
       LUP-PRO-CMN-VRF.                                                 
           PERFORM MC2-FIO-PTI.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              PTI-CAI-IPTI IN PTI = CIN-CAI-IPTI IN CIN-FLD AND         
              PTI-IIC-IPTI IN PTI = CIN-IIC-IPTI IN CIN-FLD AND         
              PTI-COD-TVAL IN PTI = 'X01')                              
               GO TO FIN-PRO-CMN-VRF.                                   
                                                                        
      *CARGA VALORES DE MONTOS Y PLAZOS                                 
           PERFORM CRG-VAL-MTPZ.                                        
           IF PTI-SGV-VPTI IN PTI NOT > ZEROES                          
              MOVE FIO-GET-NXT TO FIO-CMND                              
              GO TO LUP-PRO-CMN-VRF.                                    
                                                                        
           MOVE PTI TO WSS-BKP-PTI.                                     
                                                                        
           MOVE PTI-SGV-VPTI IN PTI TO WSS-VAL-TASA IN WSS-VARI.        
                                                                        
           MOVE PTI-VAL-MNTO IN PTI TO WSS-VAL-MNTO-R.                  
           MOVE PTI-NUM-PLZO IN PTI TO WSS-NUM-PLZO-R.                  
                                                                        
           MOVE ZEROES TO WSS-SGV-TPBT.                                 
           MOVE ZEROES TO WSS-SGV-TAPB.                                 
           MOVE ZEROES TO WSS-SGV-TAMB.                                 
           MOVE ZEROES TO WSS-SGV-TAPS.                                 
           MOVE ZEROES TO WSS-SGV-TAMS.                                 
                                                                        
           PERFORM OBT-PBT.                                             
           PERFORM OBT-APB.                                             
           PERFORM OBT-AMB.                                             
           PERFORM OBT-APS.                                             
           PERFORM OBT-AMS.                                             
                                                                        
           IF WSS-SGV-TAPB NOT = ZEROES AND                             
              WSS-SGV-TAMB NOT = ZEROES                                 
               MOVE 'PTIINVADIBAJ' TO MSG-COD-MENS                      
               GO TO MSG-PRO-CMN-VRF.                                   
                                                                        
           IF WSS-SGV-TAPS NOT = ZEROES AND                             
              WSS-SGV-TAMS NOT = ZEROES                                 
               MOVE 'PTIINVADISOB' TO MSG-COD-MENS                      
               GO TO MSG-PRO-CMN-VRF.                                   
                                                                        
           COMPUTE WSS-VAL-PBPZ = WSS-SGV-TPBT + WSS-SGV-TAPB.          
           COMPUTE WSS-VAL-PBMT = WSS-SGV-TPBT + WSS-SGV-TAMB.          
                                                                        
           IF WSS-VAL-TASA < WSS-VAL-PBPZ AND                           
              WSS-VAL-PBPZ > ZEROES                                     
               MOVE 'PTI<PBPZ' TO MSG-COD-MENS                          
               GO TO MSG-PRO-CMN-VRF.                                   
                                                                        
           IF WSS-VAL-TASA < WSS-VAL-PBMT AND                           
              WSS-VAL-PBMT > ZEROES                                     
               MOVE 'PTI<PBMT' TO MSG-COD-MENS                          
               GO TO MSG-PRO-CMN-VRF.                                   
                                                                        
           MOVE CIN-CAI-IPTI IN CIN-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE CIN-IIC-IPTI IN CIN-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE 'X01'               TO PTI-COD-TVAL IN PTI.             
           MOVE WSS-VAL-MNTO-R      TO PTI-VAL-MNTO IN PTI.             
           MOVE WSS-NUM-PLZO-R      TO PTI-NUM-PLZO IN PTI.             
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM MC2-FIO-PTI.                                         
           IF NOT (FIO-STAT-OKS AND                                     
              PTI-CAI-IPTI IN PTI = CIN-CAI-IPTI IN CIN-FLD AND         
              PTI-IIC-IPTI IN PTI = CIN-IIC-IPTI IN CIN-FLD AND         
              PTI-COD-TVAL IN PTI = 'X01')                              
               GO TO FIN-PRO-CMN-VRF.                                   
                                                                        
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-PRO-CMN-VRF.                                       
                                                                        
       MSG-PRO-CMN-VRF.                                                 
           MOVE 'TAB' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE WSS-VAL-MNTO-R TO WSS-VAL-MNTO.                         
           MOVE WSS-NUM-PLZO-R TO WSS-NUM-PLZO.                         
           MOVE WSS-MEN2 TO FRM-MEN2.                                   
           MOVE 'S' TO SCR-IERR.                                        
           MOVE '00' TO FIO-STAT.                                       
           MOVE SCR-STAT-CON TO SCR-STAT.                               
           GO TO FIN-PRO-CMN-VRF.                                       
       FIN-PRO-CMN-VRF.                                                 
           IF MSG-COD-MENS > SPACES                                     
              GO TO EXT-PRO-CMN-VRF.                                    
           PERFORM ING-VAL-PTI.                                         
                                                                        
       EXT-PRO-CMN-VRF.                                                 
           EXIT.                                                        
                                                                        
       OBT-PBT SECTION.                                                 
       INI-OBT-PBT.                                                     
           MOVE CIN-CAI-IPTI IN CIN-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE CIN-IIC-IPTI IN CIN-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE 'X02'                   TO PTI-COD-TVAL IN PTI.         
           MOVE WSS-VAL-MNTO-MAX        TO PTI-VAL-MNTO IN PTI.         
           MOVE WSS-NUM-PLZO-R          TO PTI-NUM-PLZO IN PTI.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM MC2-FIO-PTI.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-OBT-PBT.                                       
                                                                        
           MOVE PTI-SGV-VPTI IN PTI TO WSS-SGV-TPBT.                    
                                                                        
       FIN-OBT-PBT.                                                     
           EXIT.                                                        
                                                                        
       OBT-APB SECTION.                                                 
       INI-OBT-APB.                                                     
           MOVE CIN-CAI-IPTI IN CIN-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE CIN-IIC-IPTI IN CIN-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE 'X03'                   TO PTI-COD-TVAL IN PTI.         
           MOVE WSS-VAL-MNTO-MAX        TO PTI-VAL-MNTO IN PTI.         
           MOVE WSS-NUM-PLZO-R          TO PTI-NUM-PLZO IN PTI.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM MC2-FIO-PTI.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-OBT-APB.                                       
                                                                        
           MOVE PTI-SGV-VPTI IN PTI TO WSS-SGV-TAPB.                    
                                                                        
       FIN-OBT-APB.                                                     
           EXIT.                                                        
                                                                        
       OBT-AMB SECTION.                                                 
       INI-OBT-AMB.                                                     
           MOVE CIN-CAI-IPTI IN CIN-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE CIN-IIC-IPTI IN CIN-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE 'X04'                   TO PTI-COD-TVAL IN PTI.         
           MOVE WSS-VAL-MNTO-R          TO PTI-VAL-MNTO IN PTI.         
           MOVE WSS-NUM-PLZO-MAX        TO PTI-NUM-PLZO IN PTI.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM MC2-FIO-PTI.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-OBT-AMB.                                       
                                                                        
           MOVE PTI-SGV-VPTI IN PTI TO WSS-SGV-TAMB.                    
                                                                        
       FIN-OBT-AMB.                                                     
           EXIT.                                                        
                                                                        
       OBT-APS SECTION.                                                 
       INI-OBT-APS.                                                     
           MOVE CIN-CAI-IPTI IN CIN-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE CIN-IIC-IPTI IN CIN-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE 'X06'                   TO PTI-COD-TVAL IN PTI.         
           MOVE WSS-VAL-MNTO-MAX        TO PTI-VAL-MNTO IN PTI.         
           MOVE WSS-NUM-PLZO-R          TO PTI-NUM-PLZO IN PTI.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM MC2-FIO-PTI.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-OBT-APS.                                       
                                                                        
           MOVE PTI-SGV-VPTI IN PTI TO WSS-SGV-TAPS.                    
                                                                        
       FIN-OBT-APS.                                                     
           EXIT.                                                        
                                                                        
       OBT-AMS SECTION.                                                 
       INI-OBT-AMS.                                                     
           MOVE CIN-CAI-IPTI IN CIN-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE CIN-IIC-IPTI IN CIN-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE 'X07'                   TO PTI-COD-TVAL IN PTI.         
           MOVE WSS-VAL-MNTO-R          TO PTI-VAL-MNTO IN PTI.         
           MOVE WSS-NUM-PLZO-MAX        TO PTI-NUM-PLZO IN PTI.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM MC2-FIO-PTI.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-OBT-AMS.                                       
                                                                        
           MOVE PTI-SGV-VPTI IN PTI TO WSS-SGV-TAMS.                    
                                                                        
       FIN-OBT-AMS.                                                     
           EXIT.                                                        
                                                                        
      *PVG INI 07-SEP-2004                                              
       ELI-ALL-PTI SECTION.                                             
       INI-ELI-ALL-PTI.                                                 
           MOVE CIN-CIC-IPTI IN CIN TO PTI-CIC-IPTI IN PTI.             
           MOVE SPACES              TO PTI-COD-TVAL IN PTI.             
           MOVE ZEROES              TO PTI-VAL-MNTO IN PTI.             
           MOVE ZEROES              TO PTI-NUM-PLZO IN PTI.             
           MOVE FIO-GET-NLS         TO FIO-CMND.                        
       LUP-ELI-ALL-PTI.                                                 
           PERFORM MC2-FIO-PTI.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    PTI-CIC-IPTI IN PTI = CIN-CIC-IPTI IN CIN )         
              MOVE '00' TO FIO-STAT                                     
              GO TO FIN-ELI-ALL-PTI.                                    
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM MC2-FIO-PTI.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'GNS'          TO MSG-COD-SIST                       
              MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              GO TO FIN-ELI-ALL-PTI.                                    
                                                                        
           MOVE FIO-DEL TO FIO-CMND.                                    
           PERFORM MC2-FIO-PTI.                                         
           IF NOT FIO-STAT-OKS                                          
              MOVE 'TAB'          TO MSG-COD-SIST                       
              MOVE 'ERRDEL   PTI' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              GO TO FIN-ELI-ALL-PTI.                                    
                                                                        
           GO TO INI-ELI-ALL-PTI.                                       
       FIN-ELI-ALL-PTI.                                                 
           EXIT.                                                        
      *PVG FIN 07-SEP-2004                                              
                                                                        
       CRG-VAL-MTPZ SECTION.                                            
       INI-CRG-VAL-MTPZ.                                                
           MOVE ZEROES TO WSS-MNTO.                                     
       LUP-CRG-VAL-MNTO.                                                
           ADD 1 TO WSS-MNTO.                                           
           IF WSS-CIN-MNTO(WSS-MNTO) NOT > ZEROES                       
              MOVE PTI-VAL-MNTO IN PTI TO WSS-CIN-MNTO(WSS-MNTO)        
              GO TO CNT-CRG-VAL-MTPZ.                                   
           IF WSS-CIN-MNTO(WSS-MNTO) = PTI-VAL-MNTO IN PTI              
              GO TO CNT-CRG-VAL-MTPZ.                                   
           GO TO LUP-CRG-VAL-MNTO.                                      
       CNT-CRG-VAL-MTPZ.                                                
           MOVE ZEROES TO WSS-PLZO.                                     
       LUP-CRG-VAL-PLZO.                                                
           ADD 1 TO WSS-PLZO.                                           
           IF WSS-CIN-PLZO(WSS-PLZO) NOT > ZEROES                       
              MOVE PTI-NUM-PLZO IN PTI TO WSS-CIN-PLZO(WSS-PLZO)        
              GO TO FIN-CRG-VAL-MTPZ.                                   
           IF WSS-CIN-PLZO(WSS-PLZO) = PTI-NUM-PLZO IN PTI              
              GO TO FIN-CRG-VAL-MTPZ.                                   
           GO TO LUP-CRG-VAL-PLZO.                                      
       FIN-CRG-VAL-MTPZ.                                                
           EXIT.                                                        
                                                                        
       ING-VAL-PTI SECTION.                                             
       INI-ING-VAL-PTI.                                                 
           MOVE 1      TO WSS-MNTO.                                     
           PERFORM LEE-VEC-PLZO VARYING WSS-MNTO FROM 1 BY 1 UNTIL      
             WSS-MNTO > 50 OR (WSS-CIN-MNTO(WSS-MNTO) NOT > ZEROES)     
           MOVE ZEROES TO WSS-MNTO.                                     
       FIN-ING-VAL-PTI.                                                 
           EXIT.                                                        
                                                                        
       LEE-VEC-PLZO SECTION.                                            
       INI-LEE-VEC-PLZO.                                                
           MOVE 1      TO WSS-PLZO.                                     
           PERFORM PUT-PTI-ADIC VARYING WSS-PLZO FROM 1 BY 1 UNTIL      
             WSS-PLZO > 50 OR (WSS-CIN-PLZO(WSS-PLZO) NOT > ZEROES)     
           MOVE ZEROES TO WSS-PLZO.                                     
       FIN-LEE-VEC-PLZO.                                                
           EXIT.                                                        
                                                                        
       PUT-PTI-ADIC SECTION.                                            
       INI-PUT-PTI-ADIC.                                                
           MOVE CIN-CAI-IPTI IN CIN-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE CIN-IIC-IPTI IN CIN-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE 'X01'                   TO PTI-COD-TVAL IN PTI.         
           MOVE WSS-CIN-MNTO(WSS-MNTO)  TO PTI-VAL-MNTO IN PTI.         
           MOVE WSS-CIN-PLZO(WSS-PLZO)  TO PTI-NUM-PLZO IN PTI.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM MC2-FIO-PTI.                                         
           IF FIO-STAT-OKS                                              
              GO TO FIN-PUT-PTI-ADIC.                                   
                                                                        
           MOVE WSS-BKP-PTI TO PTI.                                     
           MOVE CIN-CAI-IPTI IN CIN-FLD TO PTI-CAI-IPTI IN PTI.         
           MOVE CIN-IIC-IPTI IN CIN-FLD TO PTI-IIC-IPTI IN PTI.         
           MOVE 'X01'                   TO PTI-COD-TVAL IN PTI.         
           MOVE WSS-CIN-MNTO(WSS-MNTO)  TO PTI-VAL-MNTO IN PTI.         
           MOVE WSS-CIN-PLZO(WSS-PLZO)  TO PTI-NUM-PLZO IN PTI.         
           MOVE ZEROES                  TO PTI-SGV-VPTI IN PTI.         
           MOVE FIO-PUT TO FIO-CMND.                                    
           PERFORM MC2-FIO-PTI.                                         
       FIN-PUT-PTI-ADIC.                                                
           EXIT.                                                        
                                                                        

       COPY GNSBGCIC.                                                   
       COPY GNSBVCOD.                                                   
       COPY GNSBVMSC.                                                   
       COPY GNSBVIND.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBBTAB.                                                   
       COPY GNSBBMSC.                                                   
       COPY GNSBFMSC.                                                   
       COPY GNSBGVSM.                                                   
       COPY GNSBGCPT.                                                   
       COPY MC2BFPTI.                                                   
       COPY GNSBFCIC.                                                   
       COPY GNSBPVRF.                                                   
      *>>>>
*% END
