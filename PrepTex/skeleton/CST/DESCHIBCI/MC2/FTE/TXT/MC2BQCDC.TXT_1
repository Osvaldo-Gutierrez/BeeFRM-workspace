*%! Codigo adicional para archivo                                       
*% IF INI_DBC_NUM_ICLI
      *<<<< INI_DBC_NUM_ICLI                                            
           IF DBC-NUM-ICLI IN CDC-FLD NOT > ZEROES                      
                PERFORM ERR-GLS                                         
                GO TO FIN-VAL-DBC-NUM-ICLI.                             
      *>>>>                                                             
*% END
*% IF FIN_DBC_VRF_ICLI
      *<<<< FIN_DBC_VRF_ICLI
           IF MSG-COD-MENS > SPACES
              GO TO FIN-VAL-DBC-VRF-ICLI.
           MOVE DBC-NUM-ICLI IN CDC-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN CDC-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN CDC-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY.
           MOVE FIO-GET-KEY             TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              MOVE 'SGC'        TO MSG-COD-SIST
              MOVE 'CLI    NEX' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
           ELSE
              MOVE DBC-IND-TICL IN DBC TO WSS-IND-TICL IN WSS-VARI
              MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM SGC-FIO-DCP
              IF NOT FIO-STAT-OKS OR DCP-FEC-FNAC IN DCP NOT > ZEROES
                 MOVE 19                  TO DCP-NUM-SNAC IN DCP
                 MOVE 00                  TO DCP-NUM-ANAC IN DCP
                 MOVE 01                  TO DCP-NUM-MNAC IN DCP
                 MOVE 01                  TO DCP-NUM-DNAC IN DCP.
              MOVE DCP-NUM-SNAC IN DCP TO WSS-NUM-SNAC IN WSS-VARI.
              MOVE DCP-NUM-ANAC IN DCP TO WSS-NUM-ANAC IN WSS-VARI.
              MOVE DCP-NUM-MNAC IN DCP TO WSS-NUM-MNAC IN WSS-VARI.
              MOVE DCP-NUM-DNAC IN DCP TO WSS-NUM-DNAC IN WSS-VARI.
      *>>>>
*% END
*% IF INI_FRM_FEC_FCUR
      *<<<< INI_FRM_FEC_FCUR                                    
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-CHOY-N TO FEC-CHOY.                         
           IF FRM-FEC-FCUR IN CDC-FLD  NOT > ZEROES             
              PERFORM GET-FHOY                                  
              MOVE HOY-DHOY TO FRM-NUM-DCUR IN CDC-FLD          
              MOVE HOY-MHOY TO FRM-NUM-MCUR IN CDC-FLD          
              MOVE HOY-SHOY TO FRM-NUM-SCUR IN CDC-FLD          
              MOVE HOY-AHOY TO FRM-NUM-ACUR IN CDC-FLD          
              GO TO FIN-VAL-FRM-FEC-FCUR.                       
      *>>>>                                                     
*% END
*% IF FRM_COD_MGDM
      *<<<< FRM_COD_MGDM
           MOVE 'MC2'                   TO TAB-COD-SIST.                
           MOVE 'GDM'                   TO TAB-COD-TTAB IN TAB.         
           MOVE FRM-COD-MGDM IN CDC-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
      *>>>>                                                             
*% END
*% IF FRM_COD_TCNL
      *<<<< FRM_COD_TCNL                                                
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'CNL'                   TO TAB-COD-TTAB IN TAB.         
           MOVE FRM-COD-TCNL IN CDC-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
      *PVG INI 04-FEB-2015
           IF MSG-COD-MENS > SPACES
              GO TO FIN-VAL-FRM-COD-TCNL.
           PERFORM PRO-COD-TCNL.
      *PVG FIN 04-FEB-2015
      *>>>>                                                             
*% END
*% IF FRM_COD_VCOC
      *<<<< FRM_COD_VCOC                                                
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.         
           MOVE FRM-COD-VCOC IN CDC-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           MOVE FRM-COD-VCOC IN CDC-FLD TO WSS-COD-VCOC IN WSS-VARI.
      *>>>>                                                             
*% END
*% IF FRM_COD_TOOC
      *<<<< FRM_COD_TOOC                                                
           MOVE SPACES TO WSS-COD-SIST IN WSS-VARI.
           MOVE 'TAB'                   TO TAB-COD-SIST.                
           MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB.         
           MOVE FRM-COD-TOOC IN CDC-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT = 'COD    NEX' AND                       
              FRM-COD-TOOC IN CDC-FLD > SPACES                          
               MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-DAT1                 
           ELSE                                                         
               MOVE SPACES              TO WSS-GLS-DAT1.                
           IF WSS-COD-SIST IN WSS-VARI NOT > SPACES                          
              MOVE 'SISTIO   NEX'        TO MSG-COD-MENS                
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC   TO FRM-MENS                           
              MOVE FRM-SUAR-MAL   TO FRM-SUAR                           
           ELSE                                                         
              IF WSS-COD-SIST IN WSS-VARI = 'COL'                          
                 MOVE 'CRE' TO WSS-COD-SIST IN WSS-VARI.                   
      *>>>>                                                             
*% END
*% IF FIN_FRM_COD_AOOC
      *<<<< FIN_FRM_COD_AOOC                                            
           PERFORM PRO-VAL-RPOC.
           IF MSG-COD-MENS > SPACES
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-AOOC.
      *>>>>                                                             
*% END
*% IF FRM_IND_MNTO
      *<<<< FRM_IND_MNTO
      *PVG INI 05-OCT-2015
      *    IF FRM-IND-MNTO IN CDC-FLD = 'B' OR 'L'
      *       GO TO FIN-VAL-FRM-IND-MNTO.
           IF FRM-IND-MNTO IN CDC-FLD = WSS-CT-B OR WSS-CT-L OR WSS-CT-C
              GO TO EXT-VAL-FRM-IND-MNTO.
      *PVG FIN 05-OCT-2015
           MOVE 'TAB'          TO MSG-COD-SIST.
           MOVE 'INDMNTO  INV' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC   TO FRM-MENS.
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.
           GO TO FIN-VAL-FRM-IND-MNTO.
      *PVG INI 05-OCT-2015
       EXT-VAL-FRM-IND-MNTO.
           MOVE WSS-CT-N TO WSS-CTA-IND-MODO IN CDC-VARI.
           IF FRM-IND-MNTO IN CDC-FLD = WSS-CT-C
              MOVE WSS-CT-S TO WSS-CTA-IND-MODO IN CDC-VARI.
      *PVG FIN 05-OCT-2015
      *>>>>
*% END
*% IF INI_FRM_FEC_FVEN
      *<<<< INI_FRM_FEC_FVEN                                    
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-CHOY-N TO FEC-CHOY.                        
      *>>>>                                                     
*% END
*% IF FIN_FRM_FEC_FVEN
      *<<<< FIN_FRM_FEC_FVEN
           MOVE FRM-NUM-DCUR IN CDC-FLD TO WSS-NUM-DCUR IN WSS-VARI.
           MOVE FRM-NUM-MCUR IN CDC-FLD TO WSS-NUM-MCUR IN WSS-VARI.
           MOVE FRM-NUM-SCUR IN CDC-FLD TO WSS-NUM-SCUR IN WSS-VARI.
           MOVE FRM-NUM-ACUR IN CDC-FLD TO WSS-NUM-ACUR IN WSS-VARI.
           MOVE FRM-NUM-DVEN IN CDC-FLD TO WSS-NUM-DVEN IN WSS-VARI.
           MOVE FRM-NUM-MVEN IN CDC-FLD TO WSS-NUM-MVEN IN WSS-VARI.
           MOVE FRM-NUM-SVEN IN CDC-FLD TO WSS-NUM-SVEN IN WSS-VARI.
           MOVE FRM-NUM-AVEN IN CDC-FLD TO WSS-NUM-AVEN IN WSS-VARI.

           IF WSS-FEC-FVEN IN WSS-VARI < WSS-FEC-FCUR IN WSS-VARI
              MOVE 'TAB'          TO MSG-COD-SIST
              MOVE 'FCURVEN  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-FEC-FVEN.
      *>>>>
*% END
*% IF FRM_IND_UTSV
      *<<<< FRM_IND_UTSV
           MOVE 'TAB'                   TO MSC-COD-SIST.                
           MOVE 'IPER'                  TO MSC-COD-TMSC IN MSC.         
           MOVE FRM-IND-UTSV IN CDC-FLD TO MSC-COD-CMSC IN MSC.         
           PERFORM VAL-IND.                                             
      *>>>>
*% END
*% IF FRM_NUM_MNP1
      *<<<< FRM_NUM_MNP1
            IF FRM-NUM-MNP1 IN CDC-FLD > 12
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'NUMMNP   INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-MNP1.
      *>>>>
*% END
*% IF FRM_NUM_MNP2
      *<<<< FRM_NUM_MNP2
            IF FRM-NUM-MNP2 IN CDC-FLD > ZEROES
            IF FRM-NUM-MNP2 IN CDC-FLD > 12 OR
               FRM-NUM-MNP2 IN CDC-FLD = FRM-NUM-MNP1 IN CDC-FLD
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'NUMMNP   INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-MNP2.
      *>>>>
*% END
*% IF FRM_NUM_MNP3
      *<<<< FRM_NUM_MNP3
            IF FRM-NUM-MNP3 IN CDC-FLD > ZEROES
            IF FRM-NUM-MNP3 IN CDC-FLD > 12 OR
               FRM-NUM-MNP3 IN CDC-FLD = FRM-NUM-MNP2 IN CDC-FLD OR
               FRM-NUM-MNP3 IN CDC-FLD = FRM-NUM-MNP1 IN CDC-FLD
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'NUMMNP   INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-MNP3.
      *>>>>
*% END
*% IF FRM_NUM_MNP4
      *<<<< FRM_NUM_MNP4
            IF FRM-NUM-MNP4 IN CDC-FLD > ZEROES
            IF FRM-NUM-MNP4 IN CDC-FLD > 12 OR
               FRM-NUM-MNP4 IN CDC-FLD = FRM-NUM-MNP3 IN CDC-FLD OR
               FRM-NUM-MNP4 IN CDC-FLD = FRM-NUM-MNP2 IN CDC-FLD OR
               FRM-NUM-MNP4 IN CDC-FLD = FRM-NUM-MNP1 IN CDC-FLD
               MOVE 'MC2'          TO MSG-COD-SIST
               MOVE 'NUMMNP   INV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-FRM-NUM-MNP4.
      *>>>>
*% END
*% IF FRM_COD_MIMP
      *<<<< FRM_COD_MIMP
      *MHM-INI 08-JUN-2018 TASA INTERES INFORMADO
      *VALIDA MODO OPERA CON TASA INFORMADA
           MOVE SPACES              TO WSS-IND-TINF IN WSS-VARI.
           MOVE 'MC2'               TO TAB-COD-SIST FIO-SIST.
           MOVE 'OTI'               TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-MGDM IN CDC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S'
              MOVE TAB-GLS-DAT2 TO WSS-COD-TINT-I IN WSS-VARI
              MOVE FRM-VAL-IMPI IN CDC-FLD TO WSS-SGV-TASA-I
              MOVE 'S' TO WSS-IND-TINF IN WSS-VARI.

           IF WSS-IND-TINF IN WSS-VARI = 'S' AND
              FRM-VAL-IMPI IN CDC-FLD  NOT > ZEROES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'CODIMPI  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-MIMP.

           IF WSS-IND-TINF IN WSS-VARI = 'S' AND
              FRM-COD-MIMP IN CDC-FLD > SPACES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'CODMCPO  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-MIMP.

           IF WSS-IND-TINF IN WSS-VARI = 'S'
              GO TO FIN-VAL-FRM-COD-MIMP.

      *MHM-FIN 08-JUN-2018 TASA INTERES INFORMADO

           IF FRM-COD-MIMP IN CDC-FLD NOT > SPACES AND
              FRM-VAL-IMPI IN CDC-FLD NOT > ZEROES
              GO TO FIN-VAL-FRM-COD-MIMP.

           IF FRM-COD-MIMP IN CDC-FLD > SPACES AND
              FRM-VAL-IMPI IN CDC-FLD NOT > ZEROES
      *PVG INI 04-FEB-2015
              AND FRM-MSC-TCVE IN CDC-FLD NOT > SPACES
      *PVG FIN 04-FEB-2015
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'CODMCPO  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-MIMP.

           IF FRM-COD-MIMP IN CDC-FLD NOT > SPACES AND
              FRM-VAL-IMPI IN CDC-FLD > ZEROES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'CODMCPO  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-MIMP.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-MIMP IN CDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF FRM_COD_MCPO
      *<<<< FRM_COD_MCPO
           IF FRM-COD-MCPO IN CDC-FLD NOT > SPACES AND
              FRM-VAL-CPOI IN CDC-FLD NOT > ZEROES
              GO TO FIN-VAL-FRM-COD-MCPO.

           IF FRM-COD-MCPO IN CDC-FLD > SPACES AND
              FRM-VAL-CPOI IN CDC-FLD NOT > ZEROES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'CODMCPO  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-MCPO.

           IF FRM-COD-MCPO IN CDC-FLD NOT > SPACES AND
              FRM-VAL-CPOI IN CDC-FLD > ZEROES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'CODMCPO  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-MCPO.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR'                   TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-MCPO IN CDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS > SPACES
              GO TO FIN-VAL-FRM-COD-MCPO.
           IF NOT (TAB-COD-CTAB IN TAB = WSS-COD-PESO IN WSS-VARI OR
                   TAB-COD-CTAB IN TAB = WSS-COD-UEFE IN WSS-VARI)
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'CODMCPO NHAB' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-MCPO.
      *>>>>
*% END
*% IF FRM_MSC_TCVE
      *<<<< FRM_MSC_TCVE
           IF FRM-MSC-TCVE IN CDC-FLD NOT > SPACES AND
              FRM-VAL-BALI IN CDC-FLD NOT > ZEROES
              GO TO FIN-VAL-FRM-MSC-TCVE.

      *PVG INI 04-FEB-2015
           IF FRM-MSC-TCVE IN CDC-FLD > SPACES AND
              FRM-COD-MIMP IN CDC-FLD > SPACES
              GO TO EXT-VAL-FRM-MSC-TIMP.
           IF FRM-VAL-BALI IN CDC-FLD > ZEROES
              GO TO EXT-VAL-FRM-MSC-TIMP.
      *PVG FIN 04-FEB-2015
           IF FRM-MSC-TCVE IN CDC-FLD > SPACES AND
              FRM-VAL-BALI IN CDC-FLD NOT > ZEROES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'MSCTCVE  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-MSC-TCVE.

           IF FRM-MSC-TCVE IN CDC-FLD NOT > SPACES AND
              FRM-VAL-BALI IN CDC-FLD > ZEROES
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'MSCTCVE  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              GO TO FIN-VAL-FRM-MSC-TCVE.
      *VAL-COD Valida codigo de tabla
           MOVE 'COL' TO TAB-COD-SIST.
           MOVE 'CVC ' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-MSC-TCVE IN CDC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *PVG INI 04-FEB-2015
           GO TO FIN-VAL-FRM-MSC-TCVE.
       EXT-VAL-FRM-MSC-TIMP.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'COL'  TO MSC-COD-SIST.
           MOVE 'TIMP' TO MSC-COD-TMSC IN MSC.
           MOVE FRM-MSC-TCVE IN CDC-FLD  TO WSS-CDC-TIMP IN WSS-VARI.
           MOVE WSS-CDC-TIMP IN WSS-VARI TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
      *PVG FIN 04-FEB-2015
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_CDC
      *<<<< FIN_VAL_CON_KEY_CDC
      *PVG INI 05-OCT-2015
           IF WSS-CTA-IND-MODO IN CDC-VARI NOT = WSS-CT-S
      *PVG FIN 05-OCT-2015
           IF FRM-VAL-MOPE IN CDC-FLD < WSS-POC-VAL-CMIN
              MOVE 'S' TO FRM-UCUR
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'MOPE < CMIN ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE FRM-IND-ERRO   TO FRM-VAL-MOPE-LEN IN CDC-FLD
              GO TO FIN-VAL-CON-KEY-CDC.

           IF FRM-VAL-MOPE IN CDC-FLD > WSS-POC-VAL-CMAX
              MOVE 'S' TO FRM-UCUR
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'MOPE > CMAX ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE FRM-IND-ERRO   TO FRM-VAL-MOPE-LEN IN CDC-FLD
              GO TO FIN-VAL-CON-KEY-CDC.

           IF FRM-NUM-VIGU IN CDC-FLD < WSS-POC-NUM-VMIN
              MOVE 'S' TO FRM-UCUR
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'VIGU < VMIN ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE FRM-IND-ERRO   TO FRM-NUM-VIGU-LEN IN CDC-FLD
              GO TO FIN-VAL-CON-KEY-CDC.

           IF FRM-NUM-VIGU IN CDC-FLD > WSS-POC-NUM-VMAX
              MOVE 'S' TO FRM-UCUR
              MOVE 'MC2'          TO MSG-COD-SIST
              MOVE 'VIGU > VMAX ' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR
              MOVE FRM-IND-ERRO   TO FRM-NUM-VIGU-LEN IN CDC-FLD
              GO TO FIN-VAL-CON-KEY-CDC.
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< EOF_BQ
       PRO-VAL-RPOC SECTION.
       INI-PRO-VAL-RPOC.
           MOVE SPACES                  TO MSG-COD-MENS.
           MOVE FRM-COD-VCOC IN CDC-FLD TO POC-COD-VCOC IN POC.
           MOVE FRM-COD-TOOC IN CDC-FLD TO POC-COD-TOOC IN POC.
           MOVE FRM-COD-AOOC IN CDC-FLD TO POC-COD-AOOC IN POC.
           MOVE ZEROES                  TO POC-NUM-IPOC IN POC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-POC.
           IF NOT FIO-STAT-OKS
              MOVE 'COL'        TO MSG-COD-SIST
              MOVE 'POC    NEX' TO MSG-COD-MENS
              GO TO FIN-PRO-VAL-RPOC.

           MOVE ZEROES      TO WSS-POC-VAL-CMIN.
           IF POC-VAL-CMIN IN POC > ZEROES
              MOVE POC-VAL-CMIN IN POC TO WSS-POC-VAL-CMIN.

           MOVE 99999999999 TO WSS-POC-VAL-CMAX.
           IF POC-VAL-CMAX IN POC > ZEROES
              MOVE POC-VAL-CMAX IN POC TO WSS-POC-VAL-CMAX.

           MOVE ZEROES      TO WSS-POC-NUM-VMIN.
           IF POC-NUM-VMIN IN POC > ZEROES
              MOVE POC-NUM-VMIN IN POC TO WSS-POC-NUM-VMIN.

           MOVE 999         TO WSS-POC-NUM-VMAX.
           IF POC-NUM-VMAX IN POC > ZEROES
              MOVE POC-NUM-VMAX IN POC TO WSS-POC-NUM-VMAX.
           
           IF POC-IND-AFER IN POC > SPACES
              MOVE POC-IND-AFER IN POC TO WSS-IND-AFER IN WSS-VARI
           ELSE
              MOVE 'N'                 TO WSS-IND-AFER IN WSS-VARI.
           
           IF POC-COD-TDOC IN POC > SPACES
              MOVE  POC-COD-TDOC IN POC TO WSS-COD-TDOC IN WSS-VARI
           ELSE
              MOVE 'PAG'                TO WSS-COD-TDOC IN WSS-VARI.
              
       FIN-PRO-VAL-RPOC.
           EXIT.
      *PVG INI 04-FEB-2015
       PRO-COD-TCNL SECTION.
       INI-PRO-COD-TCNL.
           MOVE SPACES TO WSS-COD-TCNL IN WSS-VARI.
           IF FRM-COD-TCNL IN CDC-FLD = WSS-COD-COFI IN WSS-VARI
              GO TO FIN-PRO-COD-TCNL.
           MOVE 'MC2'                   TO TAB-COD-SIST FIO-SIST.
           MOVE 'CTR'                   TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-TCNL IN CDC-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S')
              GO TO FIN-PRO-COD-TCNL.
           IF TAB-CIC-CTAB IN TAB > SPACES
              MOVE TAB-CIC-CTAB IN TAB TO WSS-COD-TCNL IN WSS-VARI.
       FIN-PRO-COD-TCNL.
           EXIT.
      *PVG FIN 04-FEB-2015
      *>>>>
*% END
