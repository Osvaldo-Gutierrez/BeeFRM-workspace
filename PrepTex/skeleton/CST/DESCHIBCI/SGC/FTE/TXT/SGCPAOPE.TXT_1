*%! Codigo adicional para archivo
*% PGM_PTC = TRUE
*% IF PGM_PER
*%     LARGO_TOTAL_COMMAREA = 1062
*% END
*% NO_HDR_CST = TRUE
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY SGCBRRCO.
       COPY SGCBRRCD.
*% IF PGM_BCI
      *DAD ini  20-AGO-1993
       COPY SGCBRCTL.
      *DAD fin  20-AGO-1993
*% END
       COPY GNSWGSTR.
       COPY GNSWGCPT.
       01  WSS-VARI.
           03  WSS-FRCO              VALUE 0      PIC 9(01).
               88  WSS-HAY-RCO-FRM   VALUE 1.
           03  WSS-RRCO              VALUE 0      PIC 9(01).
               88  WSS-HAY-RCO-REG   VALUE 1.
           03  WSS-SRCO              VALUE 0      PIC 9(01).
               88  WSS-MISMO-RCO     VALUE 0.
               88  WSS-OTRO-RCO      VALUE 1.
           03  WSS-HAY               VALUE 1      PIC 9(01).
           03  WSS-OTRO              VALUE 1      PIC 9(01).
           03  WSS-HAY-OPE           VALUE 0      PIC 9(01).
*% IF PGM_PER
      *AMP-INI  28-MAR-1994 NO DEBE ACEPTAR INGRESO DE TCR
           03  WSS-CIC-CTAB.
               05  WSS-CIC-TCR                    PIC X(03).
               05  WSS-CIC-AUX                    PIC X(03).
               05  FILLER                         PIC X(06).
      *AMP-FIN  28-MAR-1994 NO DEBE ACEPTAR INGRESO DE TCR
*% END
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
*% IF PGM_BCI
      *DAD ini  20-AGO-1993
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CTL-REQA==.
      *DAD fin  20-AGO-1993
*% END
      *>>>>
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *ISP ENGANCHE
       COPY SGCWGENG.
      *>>>>
*% END
*%! RVM: 01-04-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-RCO-REQA==.
*% END
*% IF PGM_VMS
      *<<<< PGM_VMS
           01 SCR-IND-MRCO                         PIC X(01).
*% ELSE
           02 SCR-IND-MRCO                         PIC X(01).
      *>>>>
*% END
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
      *ISP ENGANCHE
       COPY SGCWGPMP.
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
      *ISP ENGANCHE
      * 200 BYTES PARA ENGANCHE
           02 FILLER                      PIC X(2220).
      *     02 FILLER                      PIC X(2020).
      *>>>>
*% END
*% IF INI_FIO AND PGM_VMS
      *<<<< INI_FIO AND PGM_VMS

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-USR.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-USR.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-RCD.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-RCO.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCO.

      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *ISP ENGANCHE
           MOVE +2220 TO SCR-TCMA.
           IF SCR-DESDE-CMN
*%! RVM: 01-04-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
      *<<<< PGM_DTC
               MOVE SPACES TO SCR-DBC-REQA
               MOVE SPACES TO SCR-RCO-REQA
      *>>>>
*% END
      * MARCA  QUE INGRESO POR 'O'PE
               MOVE 'O'    TO SCR-IND-OOD
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FTER-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FTER-CIC.
       FIN-INI-FIO.
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CCPP = 'ING'
               GO TO CON-FND-KEY.
           IF DBC-NUM-ICLI IN OPE-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN OPE-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN OPE-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN OPE-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE SPACES TO RCO-CAI-ICLI IN OPE-FLD
                   MOVE SPACES TO RCO-IIC-ICLI IN OPE-FLD
                   MOVE SPACES TO DBC-GLS-NOMC IN OPE-FLD
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE

                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN OPE-FLD

                   PERFORM BUS-RCO-OPE
           ELSE
           IF DBC-GLS-NOMC IN OPE-FLD > SPACES
      *NOM-CLI Busca Cliente por medio del Nombre

               MOVE DBC-GLS-NOMC IN OPE-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE ZEROES TO DBC-NUM-ICLI IN OPE-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN OPE-FLD
                   MOVE SPACES TO DBC-IND-ICLI IN OPE-FLD
*% IF PGM_ARG
                   MOVE ZEROES TO DBC-GLS-ICLI IN OPE-FLD
*% ELSE
                   MOVE SPACES TO DBC-GLS-ICLI IN OPE-FLD
*% END
                   MOVE SPACES TO RCO-CAI-ICLI IN OPE-FLD
                   MOVE SPACES TO RCO-IIC-ICLI IN OPE-FLD
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE

                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN OPE-FLD

                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN OPE-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN OPE-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN OPE-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN OPE-FLD
                   PERFORM BUS-RCO-OPE.
       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
           IF WSS-HAY-OPE = 1
               GO TO FIN-FND-KEY.
      *ALD
           IF SCR-CCPP = 'ING'
               GO TO FIN-FND-KEY.
      *
           MOVE OPE-CAI-IOPE IN OPE TO RCO-CAI-IOPE IN RCO.
           MOVE OPE-IIC-IOPE IN OPE TO RCO-IIC-IOPE IN RCO.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
      *         MOVE 'SGC'          TO MSG-COD-SIST
      *         MOVE 'OPE    NORCO' TO MSG-COD-MENS
      *         PERFORM GET-MSG
      *         MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO REC-OPE-STAT.

*% IF NOT PGM_PER
      *
      * ISP:  2-FEB-1993 FIO-GET-NLS PARA COMPATIBILIDAD VSAM
      *                 ANTIGUO FIO-GET-KEY + FIO-GET-NXT ==>> ERROR
           MOVE OPE-CAI-IOPE IN OPE TO RCO-CAI-IOPE IN RCO.
           MOVE OPE-IIC-IOPE IN OPE TO RCO-IIC-IOPE IN RCO.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
      * ISP:  2-FEB-1993 FIO-GET-NLS PARA COMPATIBILIDAD VSAM
*% END

      *ALD
      *         MOVE SCR-STAT-CON TO SCR-STAT
      *         GO TO FIN-FND-KEY.
*%! RVM: 31-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
           MOVE ADR-RCO-REQA TO SCR-RCO-REQA.
*% END
           PERFORM GET-NXT-RCO.
           IF MSG-COD-MENS = 'OPE    MUCLI'
               MOVE 'M'          TO SCR-IND-MRCO
               MOVE 'M'          TO DBC-IND-ICLI IN OPE-FLD
               MOVE MSG-GLS-DESC TO DBC-GLS-NOMC IN DBC
               MOVE SPACES       TO MSG-COD-SIST
               MOVE SPACES       TO MSG-COD-MENS
               GO TO REC-OPE-STAT.
            PERFORM PUT-RCO-OPE.
       KEY-BUS-DBC.
           MOVE RCO-CIC-ICLI IN RCO TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
*%! RVM: 31-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA
*% END
               MOVE '00'         TO PGM-STAT-DBC
               PERFORM PUT-DBC-OPE

               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN OPE-FLD

           ELSE
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'RCO    NOCLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
       REC-OPE-STAT.
           MOVE PGM-STAT-OPE TO FIO-STAT.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE SPACES TO RCO.
      *>>>>
*% END
*% IF CMN_ING OR CMN_MOD
      *<<<< CMN_ING OR CMN_MOD
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN IN HOY-VARI TO OPE-STP-ITRN IN OPE.
           PERFORM RET-HDR-OPE.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO  FIN-CMN-ING.
*% IF PGM_PER
      *AMP-INI  29-MAR-1994 DEBE COLOCAR EL BIN CORRESPONDIENTE A LA CBK
           IF OPE-COD-AOPR IN OPE-FLD NOT > SPACES
              MOVE SPACES TO OPE-COD-AOPR IN OPE-FLD.
           MOVE 'TAB'        TO TAB-COD-SIST FIO-SIST.
           MOVE 'AUX'        TO TAB-COD-TTAB IN TAB.
           MOVE OPE-COD-TOPR IN OPE-FLD TO OPE-COD-TOPR IN OPE.
           MOVE OPE-COD-AOPR IN OPE-FLD TO OPE-COD-AOPR IN OPE.
           MOVE OPE-COD-COPR IN OPE     TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI.
           IF WSS-CIC-TCR IN WSS-VARI = 'TCR'
               IF WSS-CIC-AUX IN WSS-VARI = 'EMP'
                   MOVE '4557' TO OPE-CAI-ICAR IN OPE
               ELSE
                   MOVE '4506' TO OPE-CAI-ICAR IN OPE
           ELSE
               MOVE SPACES TO OPE-CAI-ICAR IN OPE.
      *AMP-FIN  29-MAR-1994
*% END
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO  FIN-CMN-ING.
           PERFORM PUT-RCO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
*% IF NOT PGM_BCI
               PERFORM SGC-FIO-OPE.
*% ELSE
               PERFORM SGC-FIO-OPE
      *DAD ini  20-AGO-1993
               GO TO ENG-FIN-CMN-ING.

           IF DBC-IND-ICLI IN OPE-FLD NOT = 'M'
               MOVE RCO-CAI-ICLI IN OPE-FLD TO RCD-CAI-ICLI IN RCD
               MOVE RCO-IIC-ICLI IN OPE-FLD TO RCD-IIC-ICLI IN RCD
               MOVE RCO-NUM-DIRE IN OPE-FLD TO RCD-NUM-DIRE IN RCD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCD
               IF NOT FIO-STAT-OKS
                  MOVE FIO-MENS TO FRM-MENS
                   GO TO ENG-FIN-CMN-ING.

           MOVE OPE-CAI-IOPE IN OPE-FLD TO CTL-NUM-SIS IN CTL.
           MOVE OPE-IIC-IOPE IN OPE-FLD TO CTL-COD-CRR IN CTL.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           MOVE 'CTL-COP'       TO FIO-AKEY.
           PERFORM SGC-FIO-CTL.
           IF NOT FIO-STAT-OKS
      *DAD ini  13-SEP-1993
               IF FIO-STAT = '23'
                   IF FRM-MEN2 NOT > SPACES
                       MOVE 'SGC'        TO MSG-COD-SIST
                       MOVE 'CTL    NEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN2
                       MOVE '00'         TO FIO-STAT
                       GO TO ENG-FIN-CMN-ING
                   ELSE
                       MOVE '00' TO FIO-STAT
                       GO TO ENG-FIN-CMN-ING
               ELSE
                   MOVE FIO-MENS TO FRM-MENS
                   MOVE '00'     TO FIO-STAT
      *DAD fin  13-SEP-1993
                   GO TO ENG-FIN-CMN-ING.

           MOVE RCD-MSC-TDIR IN RCD TO CTL-TIP-DIR IN CTL.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-CTL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-RCO
               GO TO ENG-FIN-CMN-ING.
       ENG-FIN-CMN-ING.
      *DAD fin  20-AGO-1993
*% END
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *ISP ENGANCHE
           IF DBC-IND-ICLI IN OPE-FLD = 'M'
               MOVE OPE-CAI-IOPE IN OPE TO SCR-CAI-IOPE
               MOVE OPE-IIC-IOPE IN OPE TO SCR-IIC-IOPE
               MOVE 'S'    TO SCR-IND-ENG IN SCR-VEC-ENG(WSS-IDX-IRCO)
               MOVE 'S'    TO SCR-IND-FST IN SCR-VEC-FST(WSS-IDX-IRCO)
               PERFORM EGR-FPEN-CIC.
      *>>>>
*% END
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO  FIN-CMN-MOD.
           PERFORM GET-UPD-RCO.
           PERFORM RET-HDR-RCO.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO  FIN-CMN-MOD.
           PERFORM MOD-RCO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
*% IF NOT PGM_BCI
               PERFORM SGC-FIO-OPE.
*% ELSE
               PERFORM SGC-FIO-OPE
      *DAD ini  20-AGO-1993
               GO TO FIN-CMN-MOD.

           MOVE RCO-CAI-ICLI IN OPE-FLD TO RCD-CAI-ICLI IN RCD.
           MOVE RCO-IIC-ICLI IN OPE-FLD TO RCD-IIC-ICLI IN RCD.
           MOVE RCO-NUM-DIRE IN OPE-FLD TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           MOVE OPE-CAI-IOPE IN OPE-FLD TO CTL-NUM-SIS IN CTL.
           MOVE OPE-IIC-IOPE IN OPE-FLD TO CTL-COD-CRR IN CTL.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           MOVE 'CTL-COP'       TO FIO-AKEY.
           PERFORM SGC-FIO-CTL.
           IF NOT FIO-STAT-OKS
      *DAD ini  13-SEP-1993
               IF FIO-STAT = '23'
                   IF FRM-MEN2 NOT > SPACES
                       MOVE 'SGC'        TO MSG-COD-SIST
                       MOVE 'CTL    NEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN2
                       MOVE '00'         TO FIO-STAT
                       GO TO FIN-CMN-MOD
                   ELSE
                       MOVE '00' TO FIO-STAT
                       GO TO FIN-CMN-MOD
               ELSE
                   MOVE FIO-MENS TO FRM-MENS
                   MOVE '00'     TO FIO-STAT
      *DAD fin  13-SEP-1993
                   GO TO FIN-CMN-MOD.

           MOVE RCD-MSC-TDIR IN RCD TO CTL-TIP-DIR IN CTL.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-CTL.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-RCO
               GO TO FIN-CMN-MOD.
      *DAD fin  20-AGO-1993
*% END
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
      *     PERFORM GET-UPD-RCO.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO  FIN-CMN-ELI.
           PERFORM DEL-RCO.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS    TO FRM-MENS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-OPE.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-IND-MRCO = 'M'
               MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN OPE-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN OPE-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN OPE-FLD
               MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN OPE-FLD
               MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN OPE-FLD
               MOVE FRM-CPIM-AEY TO RCO-NUM-DIRE-ATR IN OPE-FLD.
*% IF PGM_PER
      *AMP  28-MAR-1994 NO DEBE DEJAR MODIFICAR TIO NI AUX PARA TCR
           IF SCR-CCPP = 'MOD'
               MOVE 'TAB'               TO TAB-COD-SIST FIO-SIST
               MOVE 'TIO'               TO TAB-COD-TTAB IN TAB
               MOVE SPACES              TO WSS-CIC-CTAB IN WSS-VARI
               MOVE OPE-COD-TOPR IN OPE-FLD TO WSS-CIC-TCR IN WSS-VARI
               MOVE WSS-CIC-CTAB        TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-CTAB IN WSS-VARI
               IF WSS-CIC-TCR IN WSS-VARI = 'TCR'
                   MOVE FRM-CPIM-AEY TO OPE-COD-TOPR-ATR IN OPE-FLD
                   MOVE FRM-CPIM-AEY TO OPE-COD-AOPR-ATR IN OPE-FLD
                   MOVE            0 TO OPE-COD-TOPR-LEN IN OPE-FLD
                   MOVE           -1 TO OPE-COD-OFOP-LEN IN OPE-FLD.
*% END
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       RET-HDR-RCO SECTION.
       INI-RET-HDR-RCO.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RCO-FEC-FTRN IN RCO.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RCO-HRA-HRTR IN RCO.
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           MOVE SCR-OTRN TO RCO-COD-OTRN IN RCO.
      *    Autor Transaccion
           MOVE SCR-USER TO RCO-COD-ATRN IN RCO.
      *>>>>
*% END
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO RCO-MSC-TACC IN RCO
               MOVE 'I' TO RCO-MSC-STAT IN RCO
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO RCO-MSC-TACC IN RCO
               MOVE 'M' TO RCO-MSC-STAT IN RCO.
       FIN-RET-HDR-RCO.
           EXIT.

       BUS-RCO-OPE SECTION.
       INI-BUS-RCO-OPE.
           MOVE SPACES              TO RCO-KEY-IRCO.
           MOVE DBC-CAI-ICLI IN DBC TO RCO-CAI-ICLI IN RCO.
           MOVE DBC-IIC-ICLI IN DBC TO RCO-IIC-ICLI IN RCO.
           MOVE DBC-CAI-ICLI IN DBC TO RCO-CAI-ICLI IN OPE-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO RCO-IIC-ICLI IN OPE-FLD.
           MOVE OPE-CAI-IOPE IN OPE-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE OPE-IIC-IOPE IN OPE-FLD TO RCO-IIC-IOPE IN RCO.

           IF RCO-CAI-IOPE IN RCO NOT < SPACES AND
              RCO-IIC-IOPE IN RCO > ZEROES
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCO
               IF FIO-STAT-OKS
                   MOVE 1 TO WSS-HAY-OPE
                   GO TO FIN-BUS-RCO-OPE
               ELSE
                   IF SCR-CCPP = 'MOD' OR 'ELI' OR 'ACC'
                       MOVE 'SGC'          TO MSG-COD-SIST
                       MOVE 'CLI    NORCO' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE  0           TO WSS-HAY-OPE
                       MOVE '00'         TO FIO-STAT
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-BUS-RCO-OPE.

           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS AND
              RCO-CAI-ICLI IN RCO = RCO-CAI-ICLI IN OPE-FLD AND
              RCO-IIC-ICLI IN RCO = RCO-IIC-ICLI IN OPE-FLD
               MOVE RCO-CAI-IOPE IN RCO TO OPE-CAI-IOPE IN OPE
               MOVE RCO-IIC-IOPE IN RCO TO OPE-IIC-IOPE IN OPE
               MOVE RCO-CAI-IOPE IN RCO TO OPE-CAI-IOPE IN OPE-FLD
               MOVE RCO-IIC-IOPE IN RCO TO OPE-IIC-IOPE IN OPE-FLD
               MOVE      1       TO WSS-HAY-OPE
           ELSE
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'CLI    NORCO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE      0       TO WSS-HAY-OPE
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-RCO-OPE.
           EXIT.

       GET-NXT-RCO SECTION.
       INI-GET-NXT-RCO.
           MOVE SPACES         TO MSG-COD-SIST.
           MOVE SPACES         TO MSG-COD-MENS.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE FIO-GET-NXT    TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS AND
              OPE-CAI-IOPE IN OPE = RCO-CAI-IOPE IN RCO AND
              OPE-IIC-IOPE IN OPE = RCO-IIC-IOPE IN RCO
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'OPE    MUCLI' TO MSG-COD-MENS
               PERFORM GET-MSG
           ELSE
*%! RVM: 31-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
               MOVE SCR-RCO-REQA TO ADR-RCO-REQA
*% END
*% IF PGM_ARG
               MOVE OPE-CAI-IOPE IN OPE TO RCO-CAI-IOPE IN RCO
               MOVE OPE-IIC-IOPE IN OPE TO RCO-IIC-IOPE IN RCO
               MOVE 'RCO-KEY-IOPE' TO FIO-AKEY
               MOVE FIO-GET-NLS TO FIO-CMND
               PERFORM SGC-FIO-RCO
*% ELSE
               MOVE FIO-KDEF-S   TO FIO-KDEF
               MOVE FIO-GET-KEY  TO FIO-CMND
               PERFORM SGC-FIO-RCO
*% END
               MOVE '00'         TO PGM-STAT-RCO.
       FIN-GET-NXT-RCO.
           EXIT.

       GET-UPD-RCO SECTION.
       INI-GET-UPD-RCO.
           IF DBC-IND-ICLI IN OPE-FLD = 'M'
               GO TO FIN-GET-UPD-RCO.
           IF RCO-CAI-ICLI IN OPE-FLD > SPACES OR
              RCO-IIC-ICLI IN OPE-FLD > ZEROES
               MOVE WSS-HAY TO WSS-FRCO.
           MOVE OPE-CAI-IOPE IN OPE-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE OPE-IIC-IOPE IN OPE-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE 'RCO-KEY-IOPE'  TO FIO-AKEY.
*% IF PGM_PER
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
*% ELSE
      * ISP:  2-FEB-1993 FIO-GET-KEY ( LLAVE ALT ) +
      *                  FIO-GET-KEY-UPD ( LLAVE PRINCIPAL )
      *       PARA COMPATIBILDAD VSAM
           MOVE FIO-GET-KEY     TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-RCO
*% END
               MOVE WSS-HAY TO WSS-RRCO
               IF WSS-HAY-RCO-FRM AND
                  ( RCO-CAI-ICLI IN OPE-FLD NOT = RCO-CAI-ICLI IN RCO OR
                    RCO-IIC-ICLI IN OPE-FLD NOT = RCO-IIC-ICLI IN RCO )
                    MOVE WSS-OTRO TO WSS-SRCO.
       FIN-GET-UPD-RCO.
           EXIT.

       PUT-RCO SECTION.
       INI-PUT-RCO.
           IF DBC-IND-ICLI IN OPE-FLD = 'M'
               GO TO FIN-PUT-RCO.
           IF RCO-CAI-ICLI IN OPE-FLD > SPACES OR
              RCO-IIC-ICLI IN OPE-FLD > ZEROES
                PERFORM KEY-RCO-OPE
                PERFORM RET-RCO-OPE
                MOVE OPE-STP-ITRN IN OPE TO RCO-STP-ITRN IN RCO
                MOVE SPACES TO RCO-GLS-FLAG
                               RCO-GLS-DISP
                PERFORM RET-HDR-RCO
*% IF PGM_PER
      *AMP-INI  29-MAR-1994 DEBE COLOCAR EL BIN CORRESPONDIENTE DE TCR
                MOVE OPE-CAI-ICAR IN OPE TO RCO-GLS-DISP IN RCO
                MOVE OPE-COD-STAT IN OPE TO RCO-COD-STAT IN RCO
      *AMP-FIN  29-MAR-1994 ACEPTAR INGRESO DE TCR (EXCEPTO DE MPR)
*% END
                MOVE FIO-PUT TO FIO-CMND
                PERFORM SGC-FIO-RCO.
       FIN-PUT-RCO.
           EXIT.

       MOD-RCO SECTION.
       INI-MOD-RCO.
           IF DBC-IND-ICLI IN OPE-FLD = 'M'
               GO TO FIN-MOD-RCO.

      *     PERFORM KEY-RCO-OPE.
      *     MOVE FIO-GET-KEY-UPD TO FIO-CMND.
      *     PERFORM SGC-FIO-RCO.
      *     IF FIO-STAT-OKS
      *         PERFORM RET-RCO-OPE
      *         MOVE OPE-STP-ITRN IN OPE TO RCO-STP-ITRN IN RCO
      *         MOVE FIO-MOD TO FIO-CMND
      *         PERFORM SGC-FIO-RCO.

           IF NOT WSS-HAY-RCO-REG
               IF WSS-HAY-RCO-FRM
                   PERFORM PUT-RCO
                   GO TO FIN-MOD-RCO
               ELSE
                   GO TO FIN-MOD-RCO.

           IF WSS-MISMO-RCO
               PERFORM RET-RCO-OPE
               MOVE OPE-STP-ITRN IN OPE TO RCO-STP-ITRN IN RCO
               PERFORM RET-HDR-RCO
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-RCO
               GO TO FIN-MOD-RCO.

      *DAD ini  15-FEB-1993
           IF NOT WSS-MISMO-RCO
               PERFORM KEY-RCO-OPE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-RCO
               IF FIO-STAT-OKS
                   PERFORM RET-RCO-OPE
                   MOVE OPE-STP-ITRN IN OPE TO RCO-STP-ITRN IN RCO
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM SGC-FIO-RCO.

      *     MOVE FIO-DEL TO FIO-CMND.
      *     PERFORM SGC-FIO-RCO.
      *     IF NOT FIO-STAT-OKS
      *         GO TO FIN-MOD-RCO.
      *     IF WSS-HAY-RCO-FRM
      *         PERFORM PUT-RCO.
      *DAD fin  15-FEB-1993
       FIN-MOD-RCO.
           EXIT.

       DEL-RCO SECTION.
       INI-DEL-RCO.
           MOVE OPE-CAI-IOPE IN OPE-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE OPE-IIC-IOPE IN OPE-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
      * ISP:  2-FEB-1993 FIO-GET-KEY ( LLAVE ALT ) +
      *                  FIO-GET-KEY-UPD ( LLAVE PRINCIPAL )
      *       PARA COMPATIBILDAD VSAM
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-RCO
               MOVE FIO-DEL TO FIO-CMND
               PERFORM SGC-FIO-RCO
               IF FIO-STAT-OKS
                   GO TO INI-DEL-RCO
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE '00' TO FIO-STAT
               GO TO FIN-DEL-RCO.
       FIN-DEL-RCO.
           EXIT.

       COPY SGCBFDBC.
       COPY SGCBFRCO.
       COPY SGCBFRCD.
*% IF  PGM_BCI
      *DAD ini  20-AGO-1993
       COPY SGCBFCTL.
      *DAD fin  20-AGO-1993
*% END
       COPY TABBVUSR.
       COPY SGCBGCLI.
       COPY GNSBGSTR.
       COPY GNSBGCPT.
*% IF NOT PGM_VMS
       COPY GNSBEGLS.
*% FRM = "OPE"
*% INCLUDE '[CST.DES.SGC.FTE.TXT]SGCMPOPE.TXT'
      *
      *>>>>
*% END
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
*% IF NOT PGM_PER
      *DAD ini  13-SEP-1993
       PRO-FLD-OPE SECTION.
       INI-PRO-FLD-OPE.
           PERFORM PRO-OPE-OPE.
           PERFORM PRO-RCO-OPE.
           PERFORM PRO-DBC-OPE.
       FIN-PRO-FLD-OPE.
           EXIT.

       PRO-OPE-OPE SECTION.
       INI-PRO-OPE-OPE.
           MOVE FRM-CPIM-AEY TO OPE-COD-TOPR-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-OFOP-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-EJOP-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-IND-MCLI-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-VCOP-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-AOPR-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-FEC-FIOP-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-STAT-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-FEC-FTOP-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-MOTT-ATR IN OPE-FLD.
           MOVE FRM-CPIM-AEY TO OPE-FEC-FROP-ATR IN OPE-FLD.
       FIN-PRO-OPE-OPE.
           EXIT.

       PRO-RCO-OPE SECTION.
       INI-PRO-RCO-OPE.
           MOVE FRM-CPIM-AEY TO RCO-NUM-DIRE-ATR IN OPE-FLD.
       FIN-PRO-RCO-OPE.
           EXIT.

       PRO-DBC-OPE SECTION.
       INI-PRO-DBC-OPE.
       FIN-PRO-DBC-OPE.
           EXIT.
      *DAD fin  13-SEP-1993
*% END
       RET-RCO-OPE SECTION.
       INI-RET-RCO-OPE.
      *<<<< INI_RET_RCO_OPE
           MOVE OPE-COD-TOPR IN OPE-FLD TO RCO-COD-TOPR IN RCO.
           MOVE OPE-COD-AOPR IN OPE-FLD TO RCO-COD-AOPR IN RCO.
      *>>>>
           MOVE RCO-NUM-DIRE IN OPE-FLD TO RCO-NUM-DIRE IN RCO.
      *<<<< FIN_RET_RCO_OPE
           MOVE  100           TO RCO-VAL-PRCO IN RCO.

           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'RCO'          TO TAB-CIC-TTAB IN TAB.
           MOVE 'DIR'          TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE SPACES         TO MSG-COD-MENS.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CICRCO NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               GO TO FIN-RET-RCO-OPE.
           MOVE TAB-COD-CTAB IN TAB TO RCO-COD-RCOP IN RCO.
      *>>>>
       FIN-RET-RCO-OPE.
           EXIT.
      *>>>>
*% END
*% IF EOF_PU OR (EOF AND PGM_VMS)
      *<<<< EOF_PU OR (EOF AND PGM_VMS)
       RET-HDR-OPE SECTION.
       INI-RET-HDR-OPE.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO OPE-FEC-FTRN IN OPE.
      *    Hora Transaccion
           MOVE HOY-HHOY TO OPE-HRA-HRTR IN OPE.
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           MOVE SCR-OTRN TO OPE-COD-OTRN IN OPE.
      *    Autor Transaccion
           MOVE SCR-USER TO OPE-COD-ATRN IN OPE.
      *>>>>
*% END
*% IF PGM_PER
           IF SCR-CCPP = 'ING'
*% ELSE
      *DAD ini  23-MAR-1993
           IF SCR-CCPP = 'ING' OR
              SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-ING
*% END
               MOVE 'I' TO OPE-MSC-TACC IN OPE
               MOVE 'I' TO OPE-MSC-STAT IN OPE
           ELSE
*% IF PGM_PER
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO OPE-MSC-TACC IN OPE
               MOVE 'M' TO OPE-MSC-STAT IN OPE.
*% ELSE
           IF SCR-CCPP = 'MOD' OR
              SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD
               MOVE 'M' TO OPE-MSC-TACC IN OPE
               MOVE 'M' TO OPE-MSC-STAT IN OPE.

           IF OPE-COD-STAT IN OPE = 'ELI'
               MOVE 'D' TO OPE-MSC-STAT IN OPE.
      *DAD fin  23-MAR-1993
*% END
       FIN-RET-HDR-OPE.
           EXIT.
      *>>>>
*% END
*% IF FIN_HBL_IKY
           MOVE '1' TO FRM-CPIM-AEY.
*% END
*% IF FIN_HBL_KEY AND PGM_PQ
           MOVE '1' TO FRM-CPIM-AEY.
*% END
