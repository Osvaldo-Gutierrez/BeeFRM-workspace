*%! Codigo adicional
*% IF FIN_FST_KEY_CCA
      *<<<< FIN_FST_KEY_CCA
           MOVE -1 TO CAC-COD-CPTO-LEN IN CCA-FLD.
      *>>>>
*% END
*% IF INI_CAC_FEC_FINI
      *<<<< INI_CAC_FEC_FINI
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           IF CAC-FEC-FINI IN CCA-FLD NOT > ZEROES
               MOVE '01011950' TO FEC-FECH.

           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF CAC_COD_CPTO
      *<<<< CAC_COD_CPTO
           IF CAC-COD-CPTO IN CCA-FLD NOT > SPACES
              MOVE SPACES TO CAC-COD-CPTO IN CCA-FLD
              GO TO FIN-VAL-CAC-COD-CPTO.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'PSC'                   TO TAB-COD-TTAB IN TAB.
           MOVE CAC-COD-CPTO IN CCA-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
               MOVE SPACES       TO FRM-GLS-CPTO IN CCA-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CPTO IN CCA-FLD.
      *>>>>
*% END
*% IF CAC_IND_VIGE
      *<<<< CAC_IND_VIGE
           IF CAC-IND-VIGE IN CCA-FLD NOT > SPACES
              GO TO FIN-VAL-CAC-IND-VIGE.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VIG'                   TO TAB-COD-TTAB IN TAB.
           MOVE CAC-IND-VIGE IN CCA-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
               MOVE SPACES       TO FRM-GLS-VGTE IN CCA-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-VGTE IN CCA-FLD.
      *>>>>
*% END
*% IF DBC_NUM_ICLI
      *<<<< DBC_NUM_ICLI 
           IF DBC-NUM-ICLI IN CCA-FLD NOT > ZEROES      
               MOVE SPACES TO SCR-CAI-ICLI IN SCR-VARI  
               MOVE SPACES TO SCR-IIC-ICLI IN SCR-VARI. 
      *>>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI 
           IF DBC-NUM-ICLI IN CCA-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN CCA-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN CCA-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN CCA-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF NOT FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE SPACES       TO FRM-GLS-NOMC IN CCA-FLD
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-GLS-ICLI
               ELSE               
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-GLS-NOMC IN CCA-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI
                   MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI.
      *>>>>
*% END
*% IF EOF_BQ
      *<<<< FIN_BQ
      *>>>>
*% END
