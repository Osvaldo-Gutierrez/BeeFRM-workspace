*%! Codigo adicional BM
*% IF FIN_PUT_ALL_VOE
      *<<<< FIN_PUT_ALL_VOE
      *Busca glosa de comuna o pais en tabla 
      *     IF RCD-COD-LUGA IN VOE-FLD > SPACES
      *         MOVE RCD-COD-LUGA IN VOE-FLD TO WSS-COD-LUGA
      *>>>>
*% END
*% IF FIN_PUT_DBC_VOE
      *<<<< FIN_PUT_DBC_VOE
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN VOE-FLD.
      *>>>>
*% END
*% IF FIN_KEY_DBC_VOE
      *<<<< FIN_KEY_DBC_VOE
      *>>>>
*% END
*% IF RCD_COD_LUGA
      *<<<< RCD_COD_LUGA
      * valida codigo de lugar, va a tabla y mueve a frm-gls-luga
      *>>>>
*% END
*% IF INI_RET_VOE_VOE
           PERFORM CALCULAR-PROMEDIOS.
                                                                        
           IF SCR-CCPP = 'MOD'                                          
              MOVE VOE-COD-EEFR IN VOE TO VOE-COD-EEFR IN VOE-FLD       
              MOVE VOE-NUM-DEFR IN VOE TO VOE-NUM-DEFR IN VOE-FLD       
              MOVE VOE-NUM-MEFR IN VOE TO VOE-NUM-MEFR IN VOE-FLD       
              MOVE VOE-NUM-SEFR IN VOE TO VOE-NUM-SEFR IN VOE-FLD       
              MOVE VOE-NUM-AEFR IN VOE TO VOE-NUM-AEFR IN VOE-FLD.      
                                                                        
*% END      
*% IF INI_VAL_CON_KEY_VOE
      *<<<< INI_VAL_CON_KEY_VOE
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-VOE.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_VOE
      *<<<< FIN_VAL_CON_KEY_VOE
           IF VOE-CAI-IFOL IN VOE-FLD NOT > SPACES AND
              VOE-IIC-IFOL IN VOE-FLD NOT > SPACES AND
              DBC-NUM-ICLI IN VOE-FLD NOT > ZEROES
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONKEY'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-VOE.
      *>>>>
*% END
*% IF VAL_CON_FLD_VOE
      *<<<< INI-VAL-CON-FLD-VOE

           IF (VOE-NUM-DECC IN VOE-FLD = 0 AND
               VOE-VAL-DECC IN VOE-FLD > 0) OR    
              (VOE-NUM-DECC IN VOE-FLD > 0 AND
               VOE-VAL-DECC IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-DECC-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 

           IF (VOE-NUM-DDCC IN VOE-FLD = 0 AND
               VOE-VAL-DDCC IN VOE-FLD > 0) OR    
              (VOE-NUM-DDCC IN VOE-FLD > 0 AND
               VOE-VAL-DDCC IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-DDCC-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 

           IF (VOE-NUM-CGCC IN VOE-FLD = 0 AND
               VOE-VAL-CGCC IN VOE-FLD > 0) OR    
              (VOE-NUM-CGCC IN VOE-FLD > 0 AND
               VOE-VAL-CGCC IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-CGCC-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 

           IF (VOE-NUM-TRFN IN VOE-FLD = 0 AND
               VOE-VAL-TRFN IN VOE-FLD > 0) OR    
              (VOE-NUM-TRFN IN VOE-FLD > 0 AND
               VOE-VAL-TRFN IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-TRFN-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 

           IF (VOE-NUM-TDEX IN VOE-FLD = 0 AND
               VOE-VAL-TDEX IN VOE-FLD > 0) OR    
              (VOE-NUM-TDEX IN VOE-FLD > 0 AND
               VOE-VAL-TDEX IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-TDEX-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 

           IF (VOE-NUM-THEX IN VOE-FLD = 0 AND
               VOE-VAL-THEX IN VOE-FLD > 0) OR    
              (VOE-NUM-THEX IN VOE-FLD > 0 AND
               VOE-VAL-THEX IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-THEX-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 

           IF (VOE-NUM-DCAH IN VOE-FLD = 0 AND
               VOE-VAL-DCAH IN VOE-FLD > 0) OR    
              (VOE-NUM-DCAH IN VOE-FLD > 0 AND
               VOE-VAL-DCAH IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-DCAH-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 

           IF (VOE-NUM-DAPL IN VOE-FLD = 0 AND
               VOE-VAL-DAPL IN VOE-FLD > 0) OR    
              (VOE-NUM-DAPL IN VOE-FLD > 0 AND
               VOE-VAL-DAPL IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-DAPL-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 

           IF (VOE-NUM-FOMU IN VOE-FLD = 0 AND
               VOE-VAL-FOMU IN VOE-FLD > 0) OR    
              (VOE-NUM-FOMU IN VOE-FLD > 0 AND
               VOE-VAL-FOMU IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-FOMU-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 
    
           IF (VOE-NUM-CASE IN VOE-FLD = 0 AND
               VOE-VAL-CASE IN VOE-FLD > 0) OR    
              (VOE-NUM-CASE IN VOE-FLD > 0 AND
               VOE-VAL-CASE IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-CASE-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 
     
           IF (VOE-NUM-CODI IN VOE-FLD = 0 AND
               VOE-VAL-CODI IN VOE-FLD > 0) OR    
              (VOE-NUM-CODI IN VOE-FLD > 0 AND
               VOE-VAL-CODI IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-CODI-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 
    
           IF (VOE-NUM-VEDI IN VOE-FLD = 0 AND
               VOE-VAL-VEDI IN VOE-FLD > 0) OR    
              (VOE-NUM-VEDI IN VOE-FLD > 0 AND
               VOE-VAL-VEDI IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-VEDI-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 
    
           IF (VOE-NUM-OOPE IN VOE-FLD = 0 AND
               VOE-VAL-OOPE IN VOE-FLD > 0) OR    
              (VOE-NUM-OOPE IN VOE-FLD > 0 AND
               VOE-VAL-OOPE IN VOE-FLD = 0)     
              MOVE -1   TO VOE-NUM-OOPE-LEN
              MOVE 'S'  TO WSS-HAY-ERR-CONS. 

           IF WSS-HAY-ERR-CONS = 'S'                                    
              MOVE 'SGC'          TO MSG-COD-SIST                       
              MOVE 'VOEFLDDIVCER' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              MOVE 'S'  TO FRM-UCUR                                     
              GO TO FIN-VAL-CON-FLD-VOE.                                
                                                                        
           IF VOE-NUM-DECC IN VOE-FLD = 0 AND                           
              VOE-NUM-DDCC IN VOE-FLD = 0 AND                           
              VOE-NUM-CGCC IN VOE-FLD = 0 AND                           
              VOE-NUM-TRFN IN VOE-FLD = 0 AND                           
              VOE-NUM-TDEX IN VOE-FLD = 0 AND                           
              VOE-NUM-THEX IN VOE-FLD = 0 AND                           
              VOE-NUM-DCAH IN VOE-FLD = 0 AND                           
              VOE-NUM-DAPL IN VOE-FLD = 0 AND                           
              VOE-NUM-FOMU IN VOE-FLD = 0 AND                           
              VOE-NUM-CASE IN VOE-FLD = 0 AND                           
              VOE-NUM-CODI IN VOE-FLD = 0 AND                           
              VOE-NUM-VEDI IN VOE-FLD = 0 AND                           
              VOE-NUM-OOPE IN VOE-FLD = 0                               
              MOVE 'SGC'          TO MSG-COD-SIST                       
              MOVE 'VOEFLDMIN   ' TO MSG-COD-MENS                       
              PERFORM GET-MSG                                           
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
              GO TO FIN-VAL-CON-FLD-VOE.                                

           PERFORM CALCULAR-PROMEDIOS.

           MOVE VOE-COD-EEFR IN VOE TO VOE-COD-EEFR IN VOE-FLD          
           MOVE VOE-NUM-DEFR IN VOE TO VOE-NUM-DEFR IN VOE-FLD          
           MOVE VOE-NUM-MEFR IN VOE TO VOE-NUM-MEFR IN VOE-FLD          
           MOVE VOE-NUM-SEFR IN VOE TO VOE-NUM-SEFR IN VOE-FLD          
           MOVE VOE-NUM-AEFR IN VOE TO VOE-NUM-AEFR IN VOE-FLD.         
                                                                        
      *>>>>                                                             
           IF SCR-CCPP = 'ING'                                          
              PERFORM GET-FHOY                                          
              MOVE SCR-USER   TO VOE-COD-EEFR IN VOE-FLD                
              MOVE HOY-DHOY   TO VOE-NUM-DEFR IN VOE-FLD                
              MOVE HOY-MHOY   TO VOE-NUM-MEFR IN VOE-FLD                
              MOVE HOY-SHOY   TO VOE-NUM-SEFR IN VOE-FLD                
              MOVE HOY-AHOY   TO VOE-NUM-AEFR IN VOE-FLD.               

*% END
*% IF EOF
      *<<<< EOF
      *>>>>
*% END
