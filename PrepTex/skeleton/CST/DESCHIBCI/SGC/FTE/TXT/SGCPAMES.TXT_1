*%! Codigo adicional para archivo
*% RA1 = "DBC"
*% RA2 = "MES"
*% NRA = 2
*% FRM = "MES"
*% INCLUDE 'PFSALLALL'
*% GNSTCA = 1628
*% IF WSS_DTC
      *<<<<
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EDS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% IF WSS_IBM
      *<<<<
       COPY GNSWGSTR.
       COPY GNSWGCPT.
       COPY SGCBRDBC.
       COPY SGCBRDCE.
       COPY SGCBREDS.
       COPY TABBRUSR.
       COPY TABBRCOM.
       01  WSS-VARI.
           03  WSS-IND-BSGE         VALUE 0      PIC 9(01).
           03  WSS-CIC-ICLI                      PIC X(12).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE SPACES TO MES.
           MOVE ZEROES TO MES-FEC-FMES IN MES.
           MOVE ZEROES TO MES-FEC-FLEG IN MES.
           MOVE ZEROES TO MES-FEC-FPUB IN MES.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF SCR-CCPP = 'ING'
               GO TO CON-FND-KEY.
           PERFORM KEY-ALL-MES.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV-MDS
               IF MSG-COD-MENS = 'MESSI'
                   PERFORM SCR-CLRA-MES
                   MOVE MES-CIC-ICLI IN MES TO EDS-CIC-ICLI IN EDS
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM SGC-FIO-EDS
                   MOVE FIO-STAT TO PGM-STAT-EDS
                   IF NOT FIO-STAT-OKS
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'MES    NOEDS' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN2
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       PERFORM PUT-EDS
                       GO TO FIN-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF5
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'MES    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'MES    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.

           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-MES
                   PERFORM PUT-EDS
                   PERFORM BUS-MES
                   IF NOT FIO-STAT-OKS
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'EDS    NOMES' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN2
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       GO TO FIN-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'EDS    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'EDS    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.
       CON-FND-KEY.
           IF DBC-NUM-ICLI IN MES-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN MES-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN MES-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN MES-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE 'IDC' TO SCR-KEY-IDBC
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM GET-CLI

               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN MES-FLD

               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE '00' TO PGM-STAT-DBC
                   PERFORM COM-CIC-EDS
                   IF FIO-STAT = FIO-STAT-NEX
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                       MOVE DBC-CAI-ICLI IN DBC TO
                            MES-CAI-ICLI IN MES-FLD
                       MOVE DBC-IIC-ICLI IN DBC TO
                            MES-IIC-ICLI IN MES-FLD
           ELSE
           IF DBC-GLS-NOMC IN MES-FLD > SPACES
               MOVE SPACES TO DBC-GLS-NOMC IN DBC
      *NOM-CLI Busca Cliente por medio del Nombre

               MOVE DBC-GLS-NOMC IN MES-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE 'NOM' TO SCR-KEY-IDBC
               MOVE FIO-GET-NLS-ALT TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE '00' TO PGM-STAT-DBC
                   PERFORM COM-CIC-EDS
                   IF FIO-STAT = FIO-STAT-NEX
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE ADR-DBC-REQA TO SCR-DBC-REQA

                       MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                       PERFORM CPT-BLKS
                       MOVE CPT-STRN TO DBC-GLS-NOMC IN MES-FLD

                       MOVE DBC-NUM-ICLI IN DBC TO
                            DBC-NUM-ICLI IN MES-FLD
                       MOVE DBC-VRF-ICLI IN DBC TO
                            DBC-VRF-ICLI IN MES-FLD
                       MOVE DBC-IND-ICLI IN DBC TO
                            DBC-IND-ICLI IN MES-FLD
                       MOVE DBC-GLS-ICLI IN DBC TO
                            DBC-GLS-ICLI IN MES-FLD
                       MOVE DBC-CAI-ICLI IN DBC TO
                            MES-CAI-ICLI IN MES-FLD
                       MOVE DBC-IIC-ICLI IN DBC TO
                            MES-IIC-ICLI IN MES-FLD.
      *>>>>
*% END
*% IF FND_KEY
      *<<<<
           MOVE FIO-GET-KEY TO FIO-CMND.
           IF MES-FEC-FINF IN MES NOT > ZEROES
               MOVE '99999999' TO MES-FEC-FINF IN MES
               MOVE 1 TO WSS-IND-BSGE IN WSS-VARI
               MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-MES.
           IF FIO-STAT-OKS AND
              MES-CAI-ICLI IN MES = MES-CAI-ICLI IN MES-FLD AND
              MES-IIC-ICLI IN MES = MES-IIC-ICLI IN MES-FLD
               MOVE '00' TO PGM-STAT-MES
               MOVE ADR-MES-REQA TO SCR-MES-REQA
               GO TO FIN-FND-KEY.
           MOVE '23' TO FIO-STAT.
           MOVE FIO-STAT TO PGM-STAT-MES.
           IF SCR-CCPP = 'ACT' AND WSS-IND-BSGE IN WSS-VARI = 1
               MOVE FIO-STAT-NEX TO FIO-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI TO MES-NUM-DTRN IN MES.
           MOVE HOY-MHOY IN HOY-VARI TO MES-NUM-MTRN IN MES.
           MOVE HOY-AHOY IN HOY-VARI TO MES-NUM-ATRN IN MES.
           MOVE HOY-SHOY IN HOY-VARI TO MES-NUM-STRN IN MES.
           MOVE HOY-HHOY IN HOY-VARI TO MES-HRA-HRTR IN MES.
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
      *>>>>
*% END
*% IF PFS_SCR_MOD AND PGM_PQ
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-MES
               PERFORM VAL-NUM-FLD-MES.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           PERFORM GNS-CLR-RQA.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
           MOVE MES-CIC-ICLI IN MES TO EDS-CIC-ICLI IN EDS.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
           MOVE MES-CIC-ICLI IN MES TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        EDS
      *        Comunicar que no se pudo actualizar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
           PERFORM RET-ALL-MES.
           ADD 1 TO EDS-NUM-TMES IN EDS.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
           IF MES-FEC-FMES IN MES > DCE-FEC-FUME IN DCE
               MOVE MES-FEC-FMES IN MES TO DCE-FEC-FUME IN DCE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-DCE
               IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-CMN-ING.
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           MOVE MES-CIC-ICLI IN MES TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        MES
      *        Comunicar que no se pudo actualizar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.
           PERFORM RET-ALL-MES.
           IF MES-FEC-FMES IN MES > DCE-FEC-FUME IN DCE
               MOVE MES-FEC-FMES IN MES TO DCE-FEC-FUME IN DCE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-DCE
               IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
                   MOVE FIO-MENS TO FRM-MENS
                   PERFORM BCK-OUT
                   GO TO FIN-CMN-MOD.
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
           MOVE MES-CIC-ICLI IN MES TO EDS-CIC-ICLI IN EDS.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        MES
      *        Comunicar que no se pudo actualizar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           PERFORM RET-ALL-MES.
           SUBTRACT 1 FROM EDS-NUM-TMES IN EDS.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF EOF_IBM
      *<<<< EOF_IBM
       LEE-NXT-PRV-MDS SECTION.
       INI-LEE-NXT-PRV-MDS.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-MES-REQA > SPACES
               PERFORM LEE-NXT-PRV-MES
           ELSE
               MOVE 'MESNO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-MDS.
           EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
       LUP-LEE-NXT-PRV-DBC.
           IF SCR-KEY-IDBC = 'NOM'
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
           ELSE
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS AND DBC-IND-TICL NOT = 'E'
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-DBC
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-DBC.
           MOVE DBC-CIC-ICLI IN DBC TO EDS-CIC-ICLI IN EDS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           MOVE FIO-STAT TO PGM-STAT-EDS.
           IF NOT FIO-STAT-OKS
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-DBC
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-DBC.
           MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
           MOVE 'DBCSI' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.

       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           MOVE 'NOM' TO SCR-KEY-IDBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-NXT-PRV-NOM.
           MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS AND DBC-IND-TICL NOT = 'E'
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-NOM
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-NOM.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-NOM.
           MOVE DBC-CIC-ICLI IN DBC TO EDS-CIC-ICLI IN EDS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           MOVE FIO-STAT TO PGM-STAT-EDS.
           IF NOT FIO-STAT-OKS
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-NOM
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-NOM.
           MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
           MOVE 'DBCSI' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.

       LEE-NXT-PRV-MES SECTION.
       INI-LEE-NXT-PRV-MES.
           MOVE SCR-MES-REQA TO ADR-MES-REQA.
           MOVE ADR-VKEY IN ADR-MES-REQA TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-MES.
           IF FIO-STAT-OKS AND
              MES-CIC-ICLI IN MES = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-MES
               MOVE '00' TO PGM-STAT-DBC
               MOVE ADR-MES-REQA TO SCR-MES-REQA
               MOVE 'MESSI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-MES.
           MOVE 'MESNO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-MES.
           EXIT.

       BUS-MES SECTION.
       INI-BUS-MES.
           MOVE SPACES              TO MES-KEY-IMES IN MES.
           MOVE DBC-CAI-ICLI IN DBC TO MES-CAI-ICLI IN MES.
           MOVE DBC-IIC-ICLI IN DBC TO MES-IIC-ICLI IN MES.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE '99999999'  TO MES-FEC-FINF IN MES
               MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-MES.
           IF FIO-STAT-OKS AND
              MES-CIC-ICLI IN MES = DBC-CIC-ICLI IN DBC
               MOVE '00' TO PGM-STAT-MES
               MOVE ADR-MES-REQA TO SCR-MES-REQA
               GO TO FIN-BUS-MES.
           MOVE FIO-STAT-NEX TO FIO-STAT.
           MOVE SPACES TO SCR-MES-REQA.
       FIN-BUS-MES.
           EXIT.


       PUT-EDS SECTION.
       INI-PUT-EDS.
           IF EDS-IND-TESC IN EDS > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'TES' TO TAB-COD-TTAB IN TAB
               MOVE EDS-IND-TESC IN EDS TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-TESC IN MES-FLD.
       FIN-PUT-EDS.
           EXIT.

       COM-CIC-EDS SECTION.
       INI-COM-CIC-EDS.
           MOVE DBC-CIC-ICLI IN DBC TO EDS-CIC-ICLI IN EDS.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           MOVE FIO-STAT TO PGM-STAT-EDS.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'MESNEXIEDS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE FIO-STAT-NEX TO FIO-STAT.
           MOVE EDS-NUM-TMES IN EDS TO EDS-NUM-TMES IN MES-FLD.
           IF EDS-IND-TESC IN EDS > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'TES' TO TAB-COD-TTAB IN TAB
               MOVE EDS-IND-TESC IN EDS TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TESC IN MES-FLD.
       FIN-COM-CIC-EDS.
               EXIT.

       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM SGC-FIO-EDS.
           IF FIO-STAT-OKS
      *        Para informar que el backout se realizo con exito
               MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.

       COPY SGCBFDBC.
       COPY SGCBFDCE.
       COPY SGCBFEDS.
       COPY TABBFUSR.
       COPY GNSBBMSC.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBVTDU.
       COPY SGCBGCLI.
       COPY GNSBGSTR.
       COPY GNSBGCPT.
      *>>>>
*% END
