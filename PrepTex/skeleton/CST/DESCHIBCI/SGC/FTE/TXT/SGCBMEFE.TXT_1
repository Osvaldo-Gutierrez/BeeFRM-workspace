*%! Codigo adicional para archivo
*% IF NOT PGM_PER
*% IF INI_PUT_EFE_EFE
      *<<<< INI_PUT_EFE_EFE
           IF PGM-STAT-EFE-NUL
               GO TO FIN-PUT-EFE-EFE.
           IF NOT PGM-STAT-EFE-OKS
               PERFORM CLR-EFE-EFE
               PERFORM CLR-FRM-EFE
               GO TO FIN-PUT-EFE-EFE.
      *>>>>
*% END
*% END
*% IF FIN_PUT_DBC_EFE
      *<<<< FIN_PUT_DBC_EFE
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN EFE-FLD.
      *>>>>
*% END
*% IF FIN_PUT_EFE_EFE 
      *<<<< FIN_PUT_EFE_EFE 
       CAL-FRM-VAL-TACT.
           ADD EFE-VAL-ACIR IN EFE-FLD
               EFE-VAL-AFIJ IN EFE-FLD
               EFE-VAL-OACT IN EFE-FLD
               GIVING FRM-VAL-TACT IN EFE-FLD.

       CAL-FRM-VAL-TPAS.
           ADD EFE-VAL-PCIR IN EFE-FLD
               EFE-VAL-PLPZ IN EFE-FLD
               EFE-SGV-PATR IN EFE-FLD
               EFE-SGV-UTIL IN EFE-FLD
               GIVING FRM-VAL-TPAS IN EFE-FLD.
       CAL-FRM-SGV-LCOR.
           IF EFE-VAL-PCIR IN EFE-FLD > ZEROES
               DIVIDE EFE-VAL-ACIR IN EFE-FLD BY 
                      EFE-VAL-PCIR IN EFE-FLD
                      GIVING FRM-SGV-LCOR IN EFE-FLD ROUNDED
           ELSE
               IF EFE-VAL-ACIR IN EFE-FLD > ZEROES
                   MOVE 9999999,99 TO FRM-SGV-LCOR IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-LCOR IN EFE-FLD.
       CAL-FRM-SGV-LEVE.
           ADD EFE-VAL-PCIR IN EFE-FLD
               EFE-VAL-PLPZ IN EFE-FLD
               GIVING WSS-VAL-PCPL IN WSS-VARI.
           ADD EFE-SGV-PATR IN EFE-FLD
               EFE-SGV-UTIL IN EFE-FLD
               GIVING WSS-SGV-PAUT IN WSS-VARI.
           IF WSS-SGV-PAUT IN WSS-VARI NOT = ZEROES
               DIVIDE WSS-VAL-PCPL IN WSS-VARI BY 
                      WSS-SGV-PAUT IN WSS-VARI 
                      GIVING FRM-SGV-LEVE IN EFE-FLD ROUNDED
           ELSE
               IF WSS-VAL-PCPL IN WSS-VARI > ZEROES
                   MOVE 9999999,99 TO FRM-SGV-LEVE IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-LEVE IN EFE-FLD.
       CAL-FRM-SGV-RVEN.
           IF EFE-VAL-VENP IN EFE-FLD > ZEROES
               MULTIPLY EFE-SGV-UTIL IN EFE-FLD BY 100
                    GIVING WSS-SGV-PATR IN WSS-VARI
               DIVIDE WSS-SGV-PATR IN WSS-VARI BY 
                      EFE-VAL-VENP IN EFE-FLD
                      GIVING FRM-SGV-RVEN IN EFE-FLD ROUNDED
           ELSE
               IF EFE-SGV-UTIL IN EFE-FLD NOT = ZEROES
                   MOVE 9999999,99 TO FRM-SGV-RVEN IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-RVEN IN EFE-FLD.
       CAL-FRM-SGV-RPAT.
           IF EFE-SGV-PATR IN EFE-FLD NOT =  ZEROES
               MULTIPLY EFE-SGV-UTIL IN EFE-FLD BY 100
                    GIVING WSS-SGV-PATR IN WSS-VARI
               DIVIDE WSS-SGV-PATR IN WSS-VARI BY 
                      EFE-SGV-PATR IN EFE-FLD 
                      GIVING FRM-SGV-RPAT IN EFE-FLD ROUNDED
           ELSE
               IF EFE-SGV-UTIL IN EFE-FLD NOT = ZEROES
                   MOVE 9999999,99 TO FRM-SGV-RPAT IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-RPAT IN EFE-FLD.
      *>>>>
*% END
*% IF INI_EFE_FEC_FEFE
      *<<<< INI_EFE_FEC_FEFE
           IF SCR-CCPP = 'ING'
               MOVE FEC-FBLK-N TO FEC-FBLK
           ELSE
               MOVE FEC-FBLK-S TO FEC-FBLK.
      *>>>>
*% END
*% IF VAL_CON_FLD_EFE
      *<<<< VAL_CON_FLD_EFE
           ADD EFE-VAL-ACIR IN EFE-FLD
               EFE-VAL-AFIJ IN EFE-FLD
               EFE-VAL-OACT IN EFE-FLD
               GIVING WSS-VAL-TACT.
           IF FRM-VAL-TACT IN EFE-FLD NOT = WSS-VAL-TACT
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTACTERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-EFE.
           ADD EFE-VAL-PCIR IN EFE-FLD
               EFE-VAL-PLPZ IN EFE-FLD
               EFE-SGV-PATR IN EFE-FLD
               EFE-SGV-UTIL IN EFE-FLD
               GIVING WSS-VAL-TPAS.
           IF FRM-VAL-TPAS IN EFE-FLD NOT = WSS-VAL-TPAS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTPASERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-EFE.
           IF FRM-VAL-TPAS IN EFE-FLD NOT = FRM-VAL-TACT IN EFE-FLD 
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTPASTACTN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-EFE.

           IF EFE-VAL-PCIR IN EFE-FLD > ZEROES
               DIVIDE EFE-VAL-ACIR IN EFE-FLD BY 
                      EFE-VAL-PCIR IN EFE-FLD
                      GIVING FRM-SGV-LCOR IN EFE-FLD ROUNDED
           ELSE
               IF EFE-VAL-ACIR IN EFE-FLD > ZEROES
                   MOVE 9999999,99 TO FRM-SGV-LCOR IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-LCOR IN EFE-FLD.


           ADD EFE-VAL-PCIR IN EFE-FLD
               EFE-VAL-PLPZ IN EFE-FLD
               GIVING WSS-VAL-PCPL IN WSS-VARI.
           ADD EFE-SGV-PATR IN EFE-FLD
               EFE-SGV-UTIL IN EFE-FLD
               GIVING WSS-SGV-PAUT IN WSS-VARI.
           IF WSS-SGV-PAUT IN WSS-VARI NOT = ZEROES
               DIVIDE WSS-VAL-PCPL IN WSS-VARI BY 
                      WSS-SGV-PAUT IN WSS-VARI 
                      GIVING FRM-SGV-LEVE IN EFE-FLD ROUNDED
           ELSE
               IF WSS-VAL-PCPL IN WSS-VARI > ZEROES
                   MOVE 9999999,99 TO FRM-SGV-LEVE IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-LEVE IN EFE-FLD.


           IF EFE-VAL-VENP IN EFE-FLD > ZEROES
               MULTIPLY EFE-SGV-UTIL IN EFE-FLD BY 100
                    GIVING WSS-SGV-PATR IN WSS-VARI
               DIVIDE WSS-SGV-PATR IN WSS-VARI BY 
                      EFE-VAL-VENP IN EFE-FLD
                      GIVING FRM-SGV-RVEN IN EFE-FLD ROUNDED
           ELSE
               IF EFE-SGV-UTIL IN EFE-FLD NOT = ZEROES
                   MOVE 9999999,99 TO FRM-SGV-RVEN IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-RVEN IN EFE-FLD.

           IF EFE-SGV-PATR IN EFE-FLD NOT =  ZEROES
               MULTIPLY EFE-SGV-UTIL IN EFE-FLD BY 100
                    GIVING WSS-SGV-PATR IN WSS-VARI
               DIVIDE WSS-SGV-PATR IN WSS-VARI BY 
                      EFE-SGV-PATR IN EFE-FLD 
                      GIVING FRM-SGV-RPAT IN EFE-FLD ROUNDED
           ELSE
               IF EFE-SGV-UTIL IN EFE-FLD NOT = ZEROES
                   MOVE 9999999,99 TO FRM-SGV-RPAT IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-RPAT IN EFE-FLD.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_EFE
      *<<<< INI_VAL_CON_KEY_EFE
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-EFE.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_EFE
      *<<<< FIN_VAL_CON_KEY_EFE
           IF DBC-NUM-ICLI IN EFE-FLD NOT > ZEROES AND
              DBC-GLS-NOMC IN EFE-FLD NOT > SPACES
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-EFE.
      *>>>>
*% END
*% IF PGM_BQ
*% IF INI_KEY_DCC_EFE
      *<<<< INI_KEY_DCC_EFE
      * RGD-INI 04-08-2009 "ORIGEN RENTA"
           MOVE EFE-CIC-ICLI IN EFE TO DCC-CIC-ICLI IN DCC.
      * RGD-FIN 04-08-2009 
      *>>>>
*% END
*% END
*% IF FIN_PUT_DCC_EFE
      *<<<< FIN-PUT-DCC-EFE
      * RGD-INI 04-08-2009 "ORIGEN RENTA"
      *BUS-TAB busca glosa de codigo en tabla                        
           IF DCC-COD-BDIR IN EFE-FLD > SPACES
               MOVE 'SGC'                   TO TAB-COD-SIST
               MOVE 'BDR'                   TO TAB-COD-TTAB IN TAB
               MOVE DCC-COD-BDIR IN EFE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB.
      * RGD-FIN 04-08-2009
      *>>>>
*% END
*% IF DCC_COD_BDIR
      *<<<< DCC_COD_BDIR
      * RGD-INI 04-08-2009 "ORIGEN RENTA"
      *VAL-COD Valida codigo de tabla                                 
           IF SCR-COD-BDIR = DCC-COD-BDIR IN EFE-FLD AND
              DCC-COD-BDIR IN EFE-FLD NOT = SPACES
               GO TO FIN-VAL-DCC-COD-BDIR.                                   
           MOVE 'SGC'                   TO TAB-COD-SIST.
           MOVE 'BDR '                  TO TAB-COD-TTAB IN TAB.
           MOVE DCC-COD-BDIR IN EFE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      * RGD-FIN 04-08-2009
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       CLR-FRM-EFE SECTION.
       INI-CLR-FRM-EFE.
           MOVE ZEROES TO FRM-VAL-TACT IN EFE-FLD.
           MOVE ZEROES TO FRM-VAL-TPAS IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LCOR IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LEVE IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RVEN IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RPAT IN EFE-FLD.
       FIN-CLR-FRM-EFE.
           EXIT.
      *>>>>
*% END     
