*%! CMA_USR = TRUE
*% HDR_CST    = TRUE
*% NO_HDR_CST = FALSE
*% PGM_PTC    = TRUE
*%! GNSTCA_ORIG = 3000
*%! GNSTCA = 3000
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI                                                
           03 SCR-NUM-PANT               PIC 9(0010).                   
           03 SCR-QEC-FLD                PIC X(1100).                   
           03 SCR-CIC-ICLI.                                             
              05 SCR-CAI-ICLI            PIC X(04).                     
              05 SCR-IIC-ICLI            PIC X(08).                     
      *>>>>
*% END
*% IF WSS_DTC                                                               
      *<<<< WSS_DTC                                                     
       COPY GNSWGCPT.                                                   
       COPY SGCBRIPC.                                                   
       COPY SGCBRDBC.                                                   
       COPY SGCBRRPR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IPC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RPR-REQA==.        
                                                                        
                                                                        
       01 WSS-VARI.                                                     
           03 WSS-IND-EBRZ                 PIC X(01).                   
           03 WSS-KEY-IIPC                 PIC X(15).                   
           03 WSS-FND-INFO                 PIC X(01).                   
           03 WSS-EXI-RBRZ                 PIC X(01).                   
           03 WSS-ULT-INFO                 PIC X(01).                   
           03 WSS-CIC-IFOL                 PIC X(12).                   
           03 WSS-FIO-STAT                 PIC X(02).                   
           03 WSS-FIO-STT1                 PIC 9(01).                   
           03 WSS-FEC-DSPL.                                             
              05 WSS-DIA-DSPL              PIC 99.                      
              05 WSS-MES-DSPL              PIC 99.                      
              05 WSS-SIG-DSPL              PIC 99.                      
              05 WSS-ANO-DSPL              PIC 99.                      
      *>>>>
*% END
*% IF FND_KEY
      *<<<<                             
           IF SCR-CMND = 'ING'                                          
              PERFORM FND-BRZ-LAST                                      
              GO TO CON-FND-KEY.                                        
           IF BRZ-NUM-IBRZ IN BRZ NOT > ZEROES                          
              PERFORM FND-BRZ-LAST.                                     
       CON-FND-KEY.                                                     
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY                                                 
           IF SCR-CMND = 'ING'                                          
              PERFORM GET-FHOY                                          
              MOVE HOY-SHOY        TO WSS-SIG-DSPL IN WSS-VARI          
              MOVE HOY-AHOY        TO WSS-ANO-DSPL IN WSS-VARI          
              MOVE HOY-MHOY        TO WSS-MES-DSPL IN WSS-VARI          
              MOVE HOY-DHOY        TO WSS-DIA-DSPL IN WSS-VARI          
              MOVE WSS-FEC-DSPL IN WSS-VARI                             
                                   TO FRM-FEC-FEFR IN BRZ-FLD           
              MOVE SCR-USER        TO BRZ-COD-EEFR IN BRZ-FLD.          
      *>>>>
*% END
*% IF EOF_IBM
      *<<<< EOF            
       FND-IPC-IFOL SECTION.                                            
       INI-FND-IPC-IFOL.                                                
           MOVE BRZ-CAI-IFOL IN BRZ-FLD   TO IPC-CAI-IFOL IN IPC.       
           MOVE BRZ-IIC-IFOL IN BRZ-FLD   TO IPC-IIC-IFOL IN IPC.       
           MOVE SPACES                    TO IPC-COD-TDOC IN IPC.       
           MOVE FIO-GET-NLS               TO FIO-CMND.                  
       LUP-FND-IPC-IFOL.                                                
           PERFORM SGC-FIO-IPC.                                         
           IF NOT ( FIO-STAT-OKS  AND                                   
                    BRZ-CAI-IFOL IN BRZ-FLD = IPC-CAI-IFOL IN IPC  AND  
                    BRZ-IIC-IFOL IN BRZ-FLD = IPC-IIC-IFOL IN IPC )     
              GO TO FIN-FND-IPC-IFOL.                                   
                                                                        
           MOVE IPC-KEY-IREG IN IPC   TO WSS-KEY-IIPC IN WSS-VARI.      
                                                                        
           PERFORM UPD-IPC-TDOC.                                        
           IF NOT FIO-STAT-OKS                                          
              GO TO LEE-SIG-IFOL.                                       
                                                                        
           MOVE WSS-KEY-IIPC IN WSS-VARI TO IPC-KEY-IIPC IN IPC.        
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM SGC-FIO-IPC.                                         
                                                                        
       LEE-SIG-IFOL.                                                    
           MOVE FIO-GET-NXT              TO FIO-CMND.                   
           GO TO LUP-FND-IPC-IFOL.                                      
       FIN-FND-IPC-IFOL.                                                
           EXIT.                                                        
                                                                        
       UPD-IPC-TDOC SECTION.                                            
       INI-UPD-IPC-TDOC.                                                
           MOVE WSS-KEY-IIPC IN WSS-VARI TO IPC-KEY-IIPC IN IPC.        
           MOVE FIO-GET-KEY-UPD          TO FIO-CMND.                   
           PERFORM SGC-FIO-IPC.                                         
           IF NOT FIO-STAT-OKS                                          
              GO TO FIN-UPD-IPC-TDOC.                                   
           IF SCR-CMND = 'ING'                                          
              MOVE 'S'                   TO IPC-IND-CBRZ IN IPC         
           ELSE                                                         
              IF SCR-CMND = 'ELI'                                       
                 PERFORM BUS-BRZ                                        
                 IF WSS-IND-EBRZ IN WSS-VARI = SPACES                   
                    MOVE 'N'             TO IPC-IND-CBRZ IN IPC.        
                                                                        
           MOVE FIO-MOD                  TO FIO-CMND.                   
           PERFORM SGC-FIO-IPC.                                         
       FIN-UPD-IPC-TDOC.                                                
           EXIT.                                                        
                                                                        
       FND-BRZ-LAST SECTION.                                            
       INI-FND-BRZ-LAST.                                                
           MOVE 'N'                        TO WSS-FND-INFO.             
           MOVE BRZ-CAI-IFOL IN BRZ-FLD    TO BRZ-CAI-IFOL IN BRZ.      
           MOVE BRZ-IIC-IFOL IN BRZ-FLD    TO BRZ-IIC-IFOL IN BRZ.      
           MOVE 999                        TO BRZ-NUM-IBRZ IN BRZ.      
           MOVE FIO-GET-LEQ                TO FIO-CMND.                 
           PERFORM SGC-FIO-BRZ.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    BRZ-CAI-IFOL IN BRZ = BRZ-CAI-IFOL IN BRZ-FLD AND   
                    BRZ-IIC-IFOL IN BRZ = BRZ-IIC-IFOL IN BRZ-FLD )     
              PERFORM KEY-ALL-BRZ                                       
              MOVE ZEROES TO BRZ-NUM-IBRZ IN BRZ.                       
           IF SCR-CMND = 'ING'                                          
              ADD 1 TO BRZ-NUM-IBRZ IN BRZ                              
              MOVE BRZ-NUM-IBRZ IN BRZ TO BRZ-NUM-IBRZ IN BRZ-FLD       
           ELSE                                                         
              MOVE BRZ-NUM-IBRZ IN BRZ TO BRZ-NUM-IBRZ IN BRZ-FLD.      
       FIN-FND-BRZ-LAST.                                                
           EXIT.                                                        
                                                                        
       BUS-BRZ SECTION.                                                 
       INI-BUS-BRZ.                                                     
           MOVE SPACES TO WSS-IND-EBRZ IN WSS-VARI.                     
           MOVE BRZ-CAI-IFOL IN BRZ-FLD TO BRZ-CAI-IFOL IN BRZ.         
           MOVE BRZ-IIC-IFOL IN BRZ-FLD TO BRZ-IIC-IFOL IN BRZ.         
           MOVE ZEROES TO BRZ-NUM-IBRZ IN BRZ.                          
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM SGC-FIO-BRZ.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    BRZ-CAI-IFOL IN BRZ = BRZ-CAI-IFOL IN BRZ-FLD AND   
                    BRZ-IIC-IFOL IN BRZ = BRZ-IIC-IFOL IN BRZ-FLD )     
                    MOVE SPACES TO WSS-IND-EBRZ IN WSS-VARI             
           ELSE                                                         
                    MOVE 'S'    TO WSS-IND-EBRZ IN WSS-VARI.            
       FIN-BUS-BRZ.                                                     
           EXIT.                                                        
                                                                        
                                                                        
       COPY SGCBFIPC.                                                   
       COPY SGCBFDBC.                                                   
       COPY SGCBFRPR.                                                   
       COPY GNSBGCPT.                                                   
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.                                                   
       COPY GNSBEGLS.                                                   
       COPY GNSBBTAB.                                                   
      *>>>>                                                             
*% END
*% IF FIN_CMN_ING
      *<<<<                                               
           IF FIO-STAT-OKS                                              
              MOVE FIO-STAT     TO PGM-STAT-BRZ                         
              PERFORM FND-IPC-IFOL                                      
              MOVE PGM-STAT-BRZ TO FIO-STAT.                            
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<<                                                
           IF FIO-STAT-OKS                                              
              MOVE FIO-STAT     TO PGM-STAT-BRZ                         
              PERFORM FND-IPC-IFOL                                      
              MOVE PGM-STAT-BRZ TO FIO-STAT.                            
      *>>>>
*% END
