*%! Codigo adicional BM
*% IF SETTAG AND PGM_BU
      *<<<< SETTAG
      ***************************************************************
      *MANTENCION: CAMBIO FECHA HABIL
      *RESPONSABLE: AFRI
      *FECHA: NOV-2011.
      *ETIQUETA: *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL
      *CAMBIOS: SE DEJA SIN VALIDACION DE DIA HABIL CAMPO
      *         FECHA DE FALLECIMIENTO
      **************************************************************
      *>>>>
*% END
*% IF FIN_PUT_DBC_DAP
      *<<<< FIN_PUT_DBC_DAP
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NOMC IN DAP-FLD.
      *>>>>
*% END
*% IF INI_RET_DAP_DAP
           IF SCR-CCPP = 'MOD'
              MOVE DAP-COD-EEFR IN DAP TO DAP-COD-EEFR IN DAP-FLD
              MOVE DAP-NUM-DEFR IN DAP TO DAP-NUM-DEFR IN DAP-FLD
              MOVE DAP-NUM-MEFR IN DAP TO DAP-NUM-MEFR IN DAP-FLD
              MOVE DAP-NUM-SEFR IN DAP TO DAP-NUM-SEFR IN DAP-FLD
              MOVE DAP-NUM-AEFR IN DAP TO DAP-NUM-AEFR IN DAP-FLD.

*% END      
*% IF INI_VAL_CON_KEY_DAP
      *<<<< INI_VAL_CON_KEY_DAP
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-DAP.
      *>>>>
*% END
*% IF FIN_UNP_DAP_DAP
      *<<<< FIN_UNP_DAP_DAP
           MOVE FRM-CPIM-AEY TO DAP-IND-FAEX-ATR IN DAP-FLD.
      *>>>>
*% END
*% IF INI_DAP_FEC_FFAL
      *<<<< INI_DAP_FEC_FFAL 
      *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
      *AFRI-FIN 16-NOV-2011 CAMBIO FECHA HABIL      
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_DAP
      *<<<< FIN_VAL_CON_KEY_DAP
           IF DAP-CAI-IFOL IN DAP-FLD NOT > SPACES AND
              DAP-IIC-IFOL IN DAP-FLD NOT > SPACES AND
              DBC-NUM-ICLI IN DAP-FLD NOT > ZEROES
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONKEY'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-DAP.
      *>>>>
*% END
*% IF DAP_IND_PEXP
      *<<<< DAP_IND_PEXP
           MOVE 'SGC'                   TO TAB-COD-SIST.               
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB.        
           MOVE DAP-IND-PEXP IN DAP-FLD TO TAB-COD-CTAB IN TAB.        
           PERFORM VAL-COD.                                     
      *>>>> 
*% END
*% IF DAP_IND_FAEX
      *<<<< DAP_IND_FAEX
           MOVE 'SGC'                   TO TAB-COD-SIST.               
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB.        
           MOVE DAP-IND-FAEX IN DAP-FLD TO TAB-COD-CTAB IN TAB.        
           PERFORM VAL-COD.                                            
      *>>>> 
*% END
*% IF DAP_IND_TM2M
      *<<<< DAP_IND_TM2M
           IF DAP-IND-TM2M IN DAP-FLD NOT > SPACES                     
              GO TO  FIN-VAL-DAP-IND-TM2M.                             
           IF DAP-IND-TM2M IN DAP-FLD > SPACES AND                     
              (DAP-IND-T2A3 IN DAP-FLD > SPACES OR                     
               DAP-IND-T3A5 IN DAP-FLD > SPACES OR                     
               DAP-IND-TM5M IN DAP-FLD > SPACES)                       
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'TRMSOLUNO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-TM2M.                             
           IF DAP-IND-TM2M IN DAP-FLD NOT = 'X'                        
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'CMPSOLX' TO MSG-COD-MENS                          
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-TM2M.                             
      *>>>> 
*% END
*% IF DAP_IND_T2A3
      *<<<< DAP_IND_T2A3
           IF DAP-IND-T2A3 IN DAP-FLD NOT > SPACES                     
              GO TO  FIN-VAL-DAP-IND-T2A3.                             
           IF DAP-IND-T2A3 IN DAP-FLD > SPACES AND                     
              (DAP-IND-TM2M IN DAP-FLD > SPACES OR                     
               DAP-IND-T3A5 IN DAP-FLD > SPACES OR                     
               DAP-IND-TM5M IN DAP-FLD > SPACES)                       
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'TRMSOLUNO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-T2A3.                             
           IF DAP-IND-T2A3 IN DAP-FLD NOT = 'X'                        
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'CMPSOLX' TO MSG-COD-MENS                          
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-T2A3.                             
      *>>>> 
*% END
*% IF DAP_IND_T3A5
      *<<<< DAP_IND_T3A5
           IF DAP-IND-T3A5 IN DAP-FLD NOT > SPACES                     
              GO TO  FIN-VAL-DAP-IND-T3A5.                             
           IF DAP-IND-T3A5 IN DAP-FLD > SPACES AND                     
              (DAP-IND-TM2M IN DAP-FLD > SPACES OR                     
               DAP-IND-T2A3 IN DAP-FLD > SPACES OR                     
               DAP-IND-TM5M IN DAP-FLD > SPACES)                       
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'TRMSOLUNO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-T3A5.                             
           IF DAP-IND-T3A5 IN DAP-FLD NOT = 'X'                        
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'CMPSOLX' TO MSG-COD-MENS                          
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-T3A5.                             
      *>>>> 
*% END
*% IF DAP_IND_TM5M
      *<<<< DAP_IND_TM5M
           IF DAP-IND-TM5M IN DAP-FLD NOT > SPACES                     
              GO TO  FIN-VAL-DAP-IND-TM5M.                             
           IF DAP-IND-TM5M IN DAP-FLD > SPACES AND                     
              (DAP-IND-TM2M IN DAP-FLD > SPACES OR                     
               DAP-IND-T2A3 IN DAP-FLD > SPACES OR                     
               DAP-IND-T3A5 IN DAP-FLD > SPACES)                       
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'TRMSOLUNO'  TO MSG-COD-MENS                       
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-TM5M.                             
           IF DAP-IND-TM5M IN DAP-FLD NOT = 'X'                        
               MOVE 'SGC'        TO MSG-COD-SIST                       
               MOVE 'CMPSOLX' TO MSG-COD-MENS                          
               PERFORM GET-MSG                                         
               MOVE FRM-SUAR-MAL TO FRM-SUAR                           
               MOVE MSG-GLS-DESC TO FRM-MENS                           
               GO TO FIN-VAL-DAP-IND-TM5M.                             
      *>>>> 
*% END
*% IF DAP_GLS_TM2M
      *<<<< DAP_GLS_TM2M
           IF DAP-IND-TM2M IN DAP-FLD = 'X'
              MOVE SPACES TO DAP-IND-T2A3 IN DAP-FLD
              MOVE SPACES TO DAP-IND-T3A5 IN DAP-FLD
              MOVE SPACES TO DAP-IND-TM5M IN DAP-FLD
              MOVE SPACES TO DAP-IND-T2A3 IN DAP
              MOVE SPACES TO DAP-IND-T3A5 IN DAP
              MOVE SPACES TO DAP-IND-TM5M IN DAP
           ELSE
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DAP-IND-TM2M.
      *>>>> 
*% END
*% IF DAP_GLS_T2A3
      *<<<< DAP_GLS_T2A3
           IF DAP-IND-T2A3 IN DAP-FLD = 'X'
              MOVE SPACES TO DAP-IND-TM2M IN DAP-FLD
              MOVE SPACES TO DAP-IND-T3A5 IN DAP-FLD
              MOVE SPACES TO DAP-IND-TM5M IN DAP-FLD
              MOVE SPACES TO DAP-IND-TM2M IN DAP
              MOVE SPACES TO DAP-IND-T3A5 IN DAP
              MOVE SPACES TO DAP-IND-TM5M IN DAP
           ELSE
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DAP-IND-T2A3.
      *>>>> 
*% END
*% IF DAP_GLS_T3A5
      *<<<< DAP_GLS_T3A5
           IF DAP-IND-T3A5 IN DAP-FLD = 'X'
              MOVE SPACES TO DAP-IND-TM2M IN DAP-FLD
              MOVE SPACES TO DAP-IND-T2A3 IN DAP-FLD
              MOVE SPACES TO DAP-IND-TM5M IN DAP-FLD
              MOVE SPACES TO DAP-IND-TM2M IN DAP
              MOVE SPACES TO DAP-IND-T2A3 IN DAP
              MOVE SPACES TO DAP-IND-TM5M IN DAP
           ELSE
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-DAP-IND-T3A5.
      *>>>> 
*% END
*% IF DAP_GLS_TM5M
      *<<<< DAP_GLS_TM5M
           IF DAP-IND-TM5M IN DAP-FLD = 'X'
              MOVE SPACES TO DAP-IND-TM2M IN DAP-FLD
              MOVE SPACES TO DAP-IND-T2A3 IN DAP-FLD
              MOVE SPACES TO DAP-IND-T3A5 IN DAP-FLD
              MOVE SPACES TO DAP-IND-TM2M IN DAP
              MOVE SPACES TO DAP-IND-T2A3 IN DAP
              MOVE SPACES TO DAP-IND-T3A5 IN DAP
           ELSE
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-IND-GLS-TM5M.
           IF DAP-IND-TM2M IN DAP-FLD = 'X' OR
              DAP-IND-T2A3 IN DAP-FLD = 'X' OR
              DAP-IND-T3A5 IN DAP-FLD = 'X' OR
              DAP-IND-TM5M IN DAP-FLD = 'X'
              CONTINUE
           ELSE
              MOVE 'SGC'          TO MSG-COD-SIST 
              MOVE 'ELEJIR TRAMO' TO MSG-COD-MENS 
              PERFORM GET-MSG                   
              MOVE MSG-GLS-DESC TO FRM-MENS     
              MOVE FRM-SUAR-MAL TO FRM-SUAR     
              GO TO FIN-VAL-IND-GLS-TM2M.
      *>>>> 
*% END
*% IF FIN_PUT_ALL_DAP
      *<<<< FIN_PUT_ALL_DAP
      *     PONEMOS LA DESCRIPCION DE PARENTEZCO
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
      *>>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI
           IF DBC-NUM-ICLI IN DAP-FLD > ZEROES
              MOVE DBC-NUM-ICLI IN DAP-FLD TO DBC-NUM-ICLI IN DBC
              MOVE DBC-IND-ICLI IN DAP-FLD TO DBC-IND-ICLI IN DBC
              MOVE DBC-GLS-ICLI IN DAP-FLD TO DBC-GLS-ICLI IN DBC
              MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF NOT FIO-STAT-OKS
                  MOVE 'SGC'        TO MSG-COD-SIST
                  MOVE 'CLI    NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO FRM-GLS-NOMC IN DAP-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-GLS-ICLI
              ELSE
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN  TO FRM-GLS-NOMC IN DAP-FLD
                  MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI
                  MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI.
      *>>>>
*% END
