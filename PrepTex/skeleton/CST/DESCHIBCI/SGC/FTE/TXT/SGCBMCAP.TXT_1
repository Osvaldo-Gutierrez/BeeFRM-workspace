*%! Codigo adicional para archivo
*% IF INI_FRM_GLS_IAPO
        *<<<<
        *VAL-GLS para IDC valida glosa ( extension ) de identificador     
           MOVE FRM-GLS-IAPO IN CAP-FLD(FRM-IFLD) TO IDC-GLS-RUTV.      
           PERFORM VAL-GLS.                                             
           MOVE IDC-GLS-RUTV TO FRM-GLS-IAPO IN CAP-FLD(FRM-IFLD).      
           GO TO FIN-VAL-FRM-GLS-IAPO.
        *>>>>
*% END 
*% IF INI_VAL_FLD_CAP
   *<<<<<INI_VAL_FLD_CAP
           PERFORM VAL-FRM-GLS-IPOD.                                    
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR       
                MOVE -1 TO FRM-GLS-IPOD-LEN IN CAP-FLD                  
                GO TO FIN-VAL-FLD-CAP.                                  
           PERFORM VAL-EDP-FEC-FINF.                                    
           IF FRM-SUAR =  FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR       
                MOVE -1 TO EDP-FEC-FINF-LEN IN CAP-FLD                  
                GO TO FIN-VAL-FLD-CAP.                                  
           PERFORM VAL-FRM-GLS-NAPO                                     
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5             
                OR FRM-SUAR = FRM-SUAR-MAL                              
                OR FRM-SUAR = FRM-SUAR-CLR.                             
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                SUBTRACT 1 FROM FRM-IFLD                                
                MOVE -1 TO FRM-GLS-NAPO-LEN IN CAP-FLD(FRM-IFLD)        
                GO TO FIN-VAL-FLD-CAP.                                  
           PERFORM VAL-FRM-NUM-APAR                                     
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5             
                OR FRM-SUAR = FRM-SUAR-MAL                              
                OR FRM-SUAR = FRM-SUAR-CLR.                             
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                SUBTRACT 1 FROM FRM-IFLD                                
                MOVE -1 TO FRM-NUM-APAR-LEN IN CAP-FLD(FRM-IFLD)        
                GO TO FIN-VAL-FLD-CAP.                                  
           PERFORM VAL-FRM-COD-CLAP                                     
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5             
                OR FRM-SUAR = FRM-SUAR-MAL                              
                OR FRM-SUAR = FRM-SUAR-CLR.                             
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                SUBTRACT 1 FROM FRM-IFLD                                
                MOVE -1 TO FRM-COD-CLAP-LEN IN CAP-FLD(FRM-IFLD)        
                GO TO FIN-VAL-FLD-CAP.                                  
           PERFORM VAL-FRM-NUM-IAPO                                     
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5             
                OR FRM-SUAR = FRM-SUAR-MAL                              
                OR FRM-SUAR = FRM-SUAR-CLR.                             
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                SUBTRACT 1 FROM FRM-IFLD                                
                MOVE -1 TO FRM-NUM-IAPO-LEN IN CAP-FLD(FRM-IFLD)        
                GO TO FIN-VAL-FLD-CAP.                                  
           PERFORM VAL-FRM-VRF-IAPO                                     
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5             
                OR FRM-SUAR = FRM-SUAR-MAL                              
                OR FRM-SUAR = FRM-SUAR-CLR.                             
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                SUBTRACT 1 FROM FRM-IFLD                                
                MOVE -1 TO FRM-VRF-IAPO-LEN IN CAP-FLD(FRM-IFLD)        
                GO TO FIN-VAL-FLD-CAP.                                  
           PERFORM VAL-FRM-IND-IAPO                                     
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5             
                OR FRM-SUAR = FRM-SUAR-MAL                              
                OR FRM-SUAR = FRM-SUAR-CLR.                             
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                SUBTRACT 1 FROM FRM-IFLD                                
                MOVE -1 TO FRM-IND-IAPO-LEN IN CAP-FLD(FRM-IFLD)        
                GO TO FIN-VAL-FLD-CAP.                                  
           PERFORM VAL-FRM-GLS-IAPO                                     
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5             
                OR FRM-SUAR = FRM-SUAR-MAL                              
                OR FRM-SUAR = FRM-SUAR-CLR.                             
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                SUBTRACT 1 FROM FRM-IFLD                                
                MOVE -1 TO FRM-GLS-IAPO-LEN IN CAP-FLD(FRM-IFLD)        
                GO TO FIN-VAL-FLD-CAP.                                  
           PERFORM VAL-FRM-GLS-CONE                                     
            VARYING FRM-IFLD FROM 1 BY 1 UNTIL FRM-IFLD > 5             
                OR FRM-SUAR = FRM-SUAR-MAL                              
                OR FRM-SUAR = FRM-SUAR-CLR.                             
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                SUBTRACT 1 FROM FRM-IFLD                                
                MOVE -1 TO FRM-GLS-CONE-LEN IN CAP-FLD(FRM-IFLD)        
                GO TO FIN-VAL-FLD-CAP.                                  
           GO TO FIN-VAL-FLD-CAP. 
   *>>>>>
*% END
*% IF FIN_PUT_ALL_CAP
      *<<<< FIN_PUT_ALL_CAP
           PERFORM SET-QUE.
           MOVE QUE-MOD TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               PERFORM SET-QUE
               MOVE QUE-PUT TO QUE-CMND
               PERFORM GNS-PRO-QUE.
           MOVE ADP-CAI-IMDT IN CAP-FLD TO CCM-CAI-IMDT IN CCM.
           MOVE ADP-IIC-IMDT IN CAP-FLD TO CCM-IIC-IMDT IN CCM.
           MOVE 'P'                     TO CCM-IND-TINF IN CCM.
           MOVE ADP-NUM-IEDP IN CAP-FLD TO CCM-NUM-IEDP IN CCM.
           MOVE ADP-COD-IPOD IN CAP-FLD TO CCM-COD-IPOD IN CCM.
           MOVE ZEROES                  TO CCM-NUM-IGRP IN CCM.
           MOVE ZEROES                  TO CCM-NUM-ICCM IN CCM.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-CCM.
           IF FIO-STAT-OKS AND
              ADP-CAI-IMDT IN CAP-FLD = CCM-CAI-IMDT IN CCM AND
              ADP-IIC-IMDT IN CAP-FLD = CCM-IIC-IMDT IN CCM AND
              CCM-IND-TINF IN CCM     = 'P'  AND
              ADP-NUM-IEDP IN CAP-FLD = CCM-NUM-IEDP IN CCM AND
              ADP-COD-IPOD IN CAP-FLD = CCM-COD-IPOD IN CCM
               MOVE 'S' TO WSS-IND-RSTR IN WSS-VARI
           ELSE
               MOVE 'N' TO WSS-IND-RSTR IN WSS-VARI.
           MOVE ADP-CAI-IMDT IN CAP-FLD TO WSS-CAI-IMDT.
           MOVE ADP-IIC-IMDT IN CAP-FLD TO WSS-IIC-IMDT.
           MOVE ADP-NUM-IEDP IN CAP-FLD TO WSS-NUM-IEDP.
           MOVE ADP-COD-IPOD IN CAP-FLD TO WSS-IND-PODE.
           MOVE 'SGC'                   TO RCE-COD-SIST IN RCE.
           MOVE 'CFP'                   TO RCE-COD-ENTI IN RCE.
           MOVE WSS-GLS-IENT            TO RCE-GLS-IENT IN RCE.
           MOVE 'RCE-KEY-IENT' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-RCE.
           MOVE RCE-GLS-IENT TO WSS-GLS-IENT.
           IF     FIO-STAT-OKS
              AND RCE-COD-SIST = 'SGC'
              AND RCE-COD-ENTI = 'CFP'
              AND WSS-CAI-IMDT = ADP-CAI-IMDT IN CAP-FLD
              AND WSS-IIC-IMDT = ADP-IIC-IMDT IN CAP-FLD
              AND WSS-NUM-IEDP = ADP-NUM-IEDP IN CAP-FLD
              AND WSS-IND-PODE = ADP-COD-IPOD IN CAP-FLD
                  MOVE 'S' TO WSS-IND-CMTR IN WSS-VARI
              ELSE
                  MOVE 'N' TO WSS-IND-CMTR IN WSS-VARI.
           MOVE 'SGC'          TO MSG-COD-SIST.
           MOVE 'EDPRSTCMT'    TO WSS-GLS-MENS IN WSS-VARI.
           MOVE WSS-COD-MENS IN WSS-VARI TO MSG-COD-MENS.
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC TO FRM-MEN2.
      *>>>>
*% END
*% IF FIN_CLR_EDP_CAP
      *<<<< FIN_CLR_EDP_CAP
           MOVE SPACES TO EDP-FEC-FINF IN CAP-FLD.                      
      *>>>>
*% END
*% IF FIN_PRO_IKY_CAP
      *<<<< FIN_PRO_IKY_CAP
           MOVE FRM-CPIM-AEY TO FRM-COD-IPOD-ATR IN CAP-FLD.            
      *>>>>
*% END
*% IF FIN_PUT_DBC_CAP
      *<<<< FIN_PUT_DBC_CAP
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN CAP-FLD.
      *>>>>
*% END
*% IF FRM_COD_IPOD
      *<<<< FRM_COD_IPOD
           IF FRM-COD-IPOD IN CAP-FLD NOT > SPACES
               MOVE  SPACES TO ADP-COD-IPOD IN CAP-FLD
               GO TO FIN-VAL-FRM-COD-IPOD.
           MOVE FRM-COD-IPOD IN CAP-FLD TO WSS-COD-IPOD IN WSS-VARI.
           IF WSS-GLS-IPO2 NOT > SPACES
               IF ( WSS-GLS-IPO1 NOT < '0' AND WSS-GLS-IPO1 NOT > '9' )
                  OR
                  ( WSS-GLS-IPO1 NOT < 'A' AND WSS-GLS-IPO1 NOT > 'Z' )
                   MOVE SPACES TO FRM-GLS-IPOD IN CAP-FLD
                   MOVE FRM-COD-IPOD IN CAP-FLD TO ADP-COD-IPOD
                                                     IN CAP-FLD
                   GO TO FIN-VAL-FRM-COD-IPOD.
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'FAC' TO TAB-COD-TTAB IN TAB.
           MOVE FRM-COD-IPOD IN CAP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-IPOD IN CAP-FLD
           ELSE
               GO TO FIN-VAL-FRM-COD-IPOD.
      *>>>>
*% END
*% IF INI_FRM_IND_IAPO
      *<<<< INI_FRM_IND_IAPO
      *VAL-IDC Valida identificador                                     
           MOVE FRM-IND-IAPO IN CAP-FLD(FRM-IFLD) TO IDC-IND-RUTV.      
           PERFORM VAL-IDC.                                             
           MOVE IDC-IND-RUTV TO FRM-IND-IAPO IN CAP-FLD(FRM-IFLD).      
           GO TO FIN-VAL-FRM-IND-IAPO.
*% END
*% IF INI_FRM_VRF_IAPO
      *<<<< INI_FRM_VRF_IAPO
      *VAL-RUT Valida Rut para campo IDC                                
           MOVE IDC-ZERO-S TO IDC-ZERO.                                 
           MOVE FRM-NUM-IAPO IN CAP-FLD(FRM-IFLD) TO IDC-NUM-RUTV.      
           MOVE FRM-VRF-IAPO IN CAP-FLD(FRM-IFLD) TO IDC-VRF-RUTV.      
           PERFORM VAL-RUT.                                             
           GO TO FIN-VAL-FRM-VRF-IAPO.
*% END
*% IF INI_VAL_CON_KEY_CAP
      *<<<< INI_VAL_CON_KEY_CAP
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-CAP.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_CAP
      *<<<< FIN_VAL_CON_KEY_CAP
           IF NOT ( DBC-GLS-NOMC IN CAP-FLD     > SPACES     OR
                    DBC-NUM-ICLI IN CAP-FLD     > ZEROES )
                MOVE 'GNS' TO MSG-COD-SIST
                MOVE 'VALCONKEY' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CON-KEY-CAP.
      *>>>>
*% END
