*%! Codigo adicional PA   
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% IF SETTAG
*% END
*% IF WSS
      *<<<< WSS
       COPY GNSWGCPT.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY SGCBRRPR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RPR-REQA==.
       COPY SGCBRDAP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DAP-REQA==.
       COPY SGCBRDAE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DAE-REQA==.
*% END
*% IF WSS AND PGM_PU
      *<<<< WSS       
       01 WSS-VARI.
           03 WSS-IND-EFSE        VALUE SPACES          PIC X(01).
           03 WSS-IND-EDAP        VALUE SPACES          PIC X(01).
           03 WSS-IND-EDAE        VALUE SPACES          PIC X(01).
           03 WSS-NUM-TPOR        VALUE ZEROES          PIC 9(03).
           03 WSS-NUM-PORC        VALUE ZEROES          PIC 9(03).       
      *>>>>
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 SCR-CIC-ICLI.
              05 SCR-CAI-ICLI                 PIC X(04).
              05 SCR-IIC-ICLI                 PIC X(08).

      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF FSE-IIC-IFOL IN FSE-FLD > ZEROES
               PERFORM OBT-FOL
           ELSE
           IF DBC-NUM-ICLI IN FSE-FLD > ZEROES
               PERFORM OBT-CLI-FOL.

           IF MSG-COD-MENS > SPACES
               GO TO FIN-FND-KEY.

           MOVE RPR-CAI-IFOL TO FSE-CAI-IFOL IN FSE.
           MOVE RPR-IIC-IFOL TO FSE-IIC-IFOL IN FSE.
           MOVE RPR-CAI-IFOL TO FSE-CAI-IFOL IN FSE-FLD.
           MOVE RPR-IIC-IFOL TO FSE-IIC-IFOL IN FSE-FLD.
           
           IF FSE-NUM-IFOL IN FSE-FLD NOT > ZEROES                      
               PERFORM BUS-COR-FSE. 

       CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF FIO-STAT-OKS AND
              RPR-IND-ESTA IN RPR = 'A' AND
             (SCR-CMND = 'ELI' OR SCR-CMND = 'MOD')
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'FOLRPRYAACA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT  
               MOVE PGM-STAT-FSE TO FIO-STAT
               GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_HBL_IKY
      *<<<< FIN_HBL_IKY
           IF SCR-CMND  = 'ING'
              MOVE FRM-CPIM-AEY TO FSE-NUM-IFOL-ATR IN FSE-FLD.
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE 'S' TO WSS-IND-EFSE IN WSS-VARI.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF FIO-STAT-OKS
               PERFORM BUS-FSE-DAP.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF FIO-STAT-OKS
               PERFORM BUS-FSE-FSE.

           IF WSS-IND-EFSE IN WSS-VARI = 'S'
              GO TO FIN-CMN-ELI
           ELSE
              PERFORM BUS-FSE-DAP.
      *>>>>
*% END
*% IF EOF
      *<<<<
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
       COPY SGCBFDBC.
       COPY SGCBFDAP.
       COPY SGCBFDAE.       
       COPY SGCBFRPR.

       OBT-FOL SECTION.
       INI-OBT-FOL.
           MOVE FSE-CAI-IFOL IN FSE-FLD TO RPR-CAI-IFOL IN RPR.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO RPR-IIC-IFOL IN RPR.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RPR.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'FOLRPRNODISP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-OBT-FOL.
           MOVE RPR-CIC-ICLI IN RPR TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-OBT-FOL.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN FSE-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN FSE-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN FSE-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN FSE-FLD.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NOMC IN FSE-FLD.
       FIN-OBT-FOL.
           EXIT.

       OBT-CLI-FOL SECTION.
       INI-OBT-CLI-FOL.
           MOVE SCR-CIC-ICLI       TO RPR-CIC-ICLI IN RPR.
           MOVE '99999999'         TO RPR-FEC-FRPR IN RPR.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           MOVE 'RPR-AKY-IRPR' TO FIO-AKEY.
           PERFORM SGC-FIO-RPR.
       LUP-LEE-RPR.
           IF NOT (FIO-STAT-OKS AND
               RPR-CIC-ICLI IN RPR = SCR-CIC-ICLI)
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'FOLRPRNODISP' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-OBT-CLI-FOL.

       FIN-OBT-CLI-FOL.
           EXIT.
*% END
*% IF EOF_PQ
      *<<<<
       BUS-COR-FSE SECTION.                                             
       INI-BUS-COR-FSE.                                                 
           MOVE FSE-CAI-IFOL IN FSE-FLD TO FSE-CAI-IFOL IN FSE.         
           MOVE FSE-IIC-IFOL IN FSE-FLD TO FSE-IIC-IFOL IN FSE.         
           MOVE 999                     TO FSE-NUM-IFOL IN FSE.         
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM SGC-FIO-FSE.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    FSE-CAI-IFOL IN FSE-FLD = FSE-CAI-IFOL IN FSE AND   
                    FSE-IIC-IFOL IN FSE-FLD = FSE-IIC-IFOL IN FSE )     
               PERFORM KEY-ALL-FSE
               MOVE ZEROES TO FSE-NUM-IFOL IN FSE.                      
           IF SCR-CCPP = 'ING'                                          
               ADD 1 TO FSE-NUM-IFOL IN FSE                             
               MOVE FSE-NUM-IFOL IN FSE TO FSE-NUM-IFOL IN FSE-FLD      
           ELSE                                                         
               MOVE FSE-NUM-IFOL IN FSE TO FSE-NUM-IFOL IN FSE-FLD.     
       FIN-BUS-COR-FSE.                                                 
           EXIT. 
*% END
*% IF EOF_PU
      *<<<<
       COPY GNSBEGLS.      
      
       BUS-FSE-DAP SECTION.
       INI-BUS-FSE-DAP.
           MOVE FSE-CAI-IFOL IN FSE-FLD TO DAP-CAI-IFOL IN DAP.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO DAP-IIC-IFOL IN DAP.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DAP.
           IF NOT FIO-STAT-OKS
               PERFORM BUS-FSE-DAE.

           IF DAP-IND-FAEX IN DAP =  'N'
               MOVE 'S' TO DAP-IND-FAEX IN DAP
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-DAP.

           IF DAP-IND-FAEX IN DAP =  'S' AND
              WSS-IND-EFSE IN WSS-VARI = 'N'
               MOVE 'N' TO DAP-IND-FAEX IN DAP
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-DAP.

       FIN-BUS-FSE-DAP.
           EXIT.

       BUS-FSE-DAE SECTION.
       INI-BUS-FSE-DAE.
           MOVE FSE-CAI-IFOL IN FSE-FLD TO DAE-CAI-IFOL IN DAE.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO DAE-IIC-IFOL IN DAE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DAE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-BUS-FSE-DAE.

           IF DAE-IND-ESEX IN DAE =  'N'
               MOVE 'S' TO DAE-IND-ESEX IN DAE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-DAE.

           IF DAE-IND-ESEX IN DAE =  'S' AND
              WSS-IND-EFSE IN WSS-VARI = 'N'
               MOVE 'N' TO DAE-IND-ESEX IN DAE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-DAE.

       FIN-BUS-FSE-DAE.
           EXIT.

       BUS-FSE-FSE SECTION.
       INI-BUS-FSE-FSE.
           MOVE 'N' TO WSS-IND-EFSE IN WSS-VARI.
           MOVE FSE-CAI-IFOL IN FSE-FLD TO FSE-CAI-IFOL IN FSE.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO FSE-IIC-IFOL IN FSE.
           MOVE ZEROES                  TO FSE-NUM-IFOL IN FSE.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-FSE-FSE.
           PERFORM SGC-FIO-FSE.
           IF NOT (FIO-STAT-OKS AND
               FSE-CAI-IFOL IN FSE-FLD = FSE-CAI-IFOL IN FSE AND
               FSE-IIC-IFOL IN FSE-FLD = FSE-IIC-IFOL IN FSE)
               GO TO FIN-BUS-FSE-FSE.

           MOVE 'S' TO WSS-IND-EFSE IN WSS-VARI.

       NXT-BUS-FSE-FSE.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-BUS-FSE-FSE.
       FIN-BUS-FSE-FSE.
           EXIT.
      *>>>>
*% END
