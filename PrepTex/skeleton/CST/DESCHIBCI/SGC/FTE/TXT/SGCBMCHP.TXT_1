*%! Codigo adicional para archivo
*% IF INI_SCR_PGM
      *<<<<< INI_SCR_PGM
      *JSS-PRF TODAVIA NO SE COMO QUEDARIA EL SCR-PGM 
             GO TO  FIN-SCR-PGM.
      *>>>> 
*% END
*% IF INI_CMD_MOD
      GO TO SIG-CMD-MOD.
*% END
*% IF PGM_BU AND FIN_DBC_VRF_ICLI
      *<<<< PGM_BU AND FIN_DBC_VRF_ICLI
      *VAL-RUT Valida Rut para campo IDC                                
            MOVE IDC-ZERO-S TO IDC-ZERO.                                 
            MOVE DBC-NUM-ICLI IN CHP-FLD TO IDC-NUM-RUTV.                
            MOVE DBC-VRF-ICLI IN CHP-FLD TO IDC-VRF-RUTV.                
            PERFORM VAL-RUT.                                             
      *>>>>>
*% END           
*% IF INI_PUT_DBC_CHP
      *<<<< INI_PUT_DBC_CHP
            MOVE '00' TO PGM-STAT-DBC.
      *>>>>
*% END
*% IF INI_PUT_OPE_CHP
      *<<<< INI_PUT_OPE_CHP
            MOVE '00' TO PGM-STAT-OPE.
      *>>>>
*% END
*% IF FIN_PUT_OPE_CHP
      *<<<< FIN_PUT_OPE_CHP
            IF OPE-IND-MCLI IN CHP-FLD > SPACES
                MOVE 'S' TO FRM-IND-MCLI IN CHP-FLD
            ELSE
                MOVE 'N' TO FRM-IND-MCLI IN CHP-FLD.
      *>>>>
*% END
*% IF FIN_VAL_CON_IKY_CHP
      *<<<< FIN_VAL_CON_IKY_CHP
           IF NOT ( CHP-IIC-ICCT IN CHP-FLD > ZEROES AND
                    CHP-FEC-FCHP IN CHP-FLD > ZEROES AND
                    CHP-NUM-ICHP IN CHP-FLD > ZEROES )
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONIKY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_CHP
      *<<<< FIN_VAL_CON_KEY_CHP
           IF NOT ( ( ( CHP-IIC-ICCT IN CHP-FLD     > ZEROES  AND
                        CHP-NUM-ICHP IN CHP-FLD     > ZEROES  AND
                        CHP-FEC-FCHP IN CHP-FLD     > ZEROES ) OR
                      ( CHP-IIC-ICCT IN CHP-FLD     > ZEROES  AND
                        CHP-NUM-ICHP IN CHP-FLD     > ZEROES  AND
                        CHP-FEC-FCHP IN CHP-FLD NOT > ZEROES ) OR
                      ( CHP-IIC-ICCT IN CHP-FLD     > ZEROES  AND
                        CHP-NUM-ICHP IN CHP-FLD NOT > ZEROES  AND
                        CHP-FEC-FCHP IN CHP-FLD NOT > ZEROES ) ) )
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-CHP.
      *>>>>
*% END
*% IF CHP_IIC_ICCT
      *<<<< CHP_IIC_ICCT
           MOVE CHP-CAI-ICCT IN CHP-FLD TO RCO-CAI-IOPE IN RCO.
           MOVE CHP-IIC-ICCT IN CHP-FLD TO RCO-IIC-IOPE IN RCO.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT ( FIO-STAT-OKS AND
                    RCO-CAI-IOPE IN RCO = CHP-CAI-ICCT IN CHP-FLD AND
                    RCO-IIC-IOPE IN RCO = CHP-IIC-ICCT IN CHP-FLD )
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'OPE    NORCO' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CHP-IIC-ICCT.

            MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM SGC-FIO-OPE.
            IF NOT FIO-STAT-OKS
                MOVE 'SGC'        TO MSG-COD-SIST
                MOVE 'OPE    NEX' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CHP-IIC-ICCT.

            MOVE '00' TO PGM-STAT-OPE.
            PERFORM PUT-OPE-CHP.
            MOVE RCO-CIC-ICLI IN RCO TO DBC-CIC-ICLI IN DBC.
            MOVE FIO-GET-KEY TO FIO-CMND.
            PERFORM SGC-FIO-DBC.
            IF FIO-STAT-OKS
                PERFORM PUT-DBC
            ELSE
                MOVE 'SGC'        TO MSG-COD-SIST
                MOVE 'CLI    NEX' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                GO TO FIN-VAL-CHP-IIC-ICCT.
      *>>>>
*% END
*% IF INI_CHP_FEC_FACL
      *<<<< INI_CHP_FEC_FACL
           IF SCR-CMND NOT = 'ACL'
               GO TO FIN-VAL-CHP-FEC-FACL.
      *>>>>
*% END
*% IF CHP_FEC_FACL
      *<<<< CHP_FEC_FACL
      *CMP-FEC Comparar Fechas
           MOVE CHP-FEC-FCHP IN CHP-FLD TO FEC-FEC1.
           MOVE CHP-FEC-FACL IN CHP-FLD TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SGC'         TO MSG-COD-SIST
               MOVE 'FECFCHPFACL' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF CHP_FEC_FCHP
      *<<<< CHP_FEC_FCHP
           IF CHP-FEC-FCHP IN CHP-FLD NOT > ZEROES
               GO TO FIN-VAL-CHP-FEC-FCHP.
      *CMP-FEC Comparar Fechas
           MOVE OPE-NUM-DIOP IN OPE     TO FEC-DEC1.
           MOVE OPE-NUM-MIOP IN OPE     TO FEC-MEC1.
           MOVE OPE-NUM-SIOP IN OPE     TO FEC-SEC1.
           MOVE OPE-NUM-AIOP IN OPE     TO FEC-AEC1.
           MOVE CHP-FEC-FCHP IN CHP-FLD TO FEC-FEC2.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-CMP-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'SGC'         TO MSG-COD-SIST
               MOVE 'FECFIOPFCHP' TO MSG-COD-MENS IN MSG
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FIN_RET_OPE_CHP
      *<<<< FIN_RET_OPE_CHP
           MOVE OPE-COD-OFOP IN CHP-FLD TO CHP-COD-OFIC IN CHP.
           MOVE OPE-COD-VCOP IN CHP-FLD TO CHP-COD-VCMC IN CHP.
      *>>>>
*% END
*% IF CHP_IND_EBOL
      *<<<< CHP_IND_EBOL
           IF CHP-IND-EBOL IN CHP-FLD NOT > SPACES AND 
              (SCR-CCPP = 'ING' OR 
              (SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-ING))
               MOVE 'S' TO CHP-IND-EBOL IN CHP-FLD.
      *>>>>
*% END
*% IF CHP_COD_TDOC
      *<<<< CHP_COD_TDOC
           IF OPE-COD-TOPR IN CHP-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'TIO'                   TO TAB-COD-TTAB IN TAB
               MOVE OPE-COD-TOPR IN CHP-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               IF TAB-COD-DAT3(1) > SPACES AND
                  TAB-COD-DAT3(1) NOT = CHP-COD-TDOC IN CHP-FLD
                   MOVE 'SGC'          TO MSG-COD-SIST
                   MOVE 'CODTOPRTDOCI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CHP-COD-TDOC.
      *>>>>
*% END
*% IF VAL_CON_FLD_CHP
      *<<<< VAL_CON_FLD_CHP
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'DOC'                   TO TAB-COD-TTAB IN TAB.
           MOVE CHP-COD-TDOC IN CHP-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF TAB-COD-DAT1 (1) > SPACES
               MOVE TAB-COD-DAT1 (1) TO DOC-COD-DAT1
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'MTP'                   TO TAB-COD-TTAB IN TAB
               MOVE CHP-COD-MOTP IN CHP-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               PERFORM BUS-MTP VARYING WSS-I FROM 1 BY 1
                               UNTIL WSS-I > 10 OR
                                     DOC-COD-DAT1 = TAB-COD-DAT1 (WSS-I)
               IF WSS-I > 10
                   MOVE 'SGC'          TO MSG-COD-SIST
                   MOVE 'CODTDOCMOTPI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-CON-FLD-CHP.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       BUS-MTP SECTION.
       INI-BUS-MTP.
       FIN-BUS-MTP.
           EXIT.
      *>>>>
*% END
