*%! Codigo adicional para archivo SGCBMRPR
*% FRM = 'RPR'
*% REG = 'RPR'
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% IF FIN_PUT_RPR_RPR
      *BUS-TAB busca glosa de codigo en tabla
           IF RPR-IND-ESTA IN RPR-FLD > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'EST ' TO TAB-COD-TTAB IN TAB
               MOVE RPR-IND-ESTA IN RPR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ESTA IN RPR-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ESTA IN RPR-FLD.
      *<<<<
      *BUS-TAB busca glosa de codigo en tabla
           IF RPR-COD-TFRM IN RPR-FLD > SPACES
               MOVE 'SGC' TO TAB-COD-SIST
               MOVE 'DRE ' TO TAB-COD-TTAB IN TAB
               MOVE RPR-COD-TFRM IN RPR-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-LDOC IN RPR-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-LDOC IN RPR-FLD.
      *VAL-OFI Valida codigo de Oficina en TABLAS
           IF RPR-COD-OREC IN RPR-FLD NOT > SPACES
              MOVE SPACES TO RPR-COD-OREC IN RPR-FLD.
           MOVE RPR-COD-OREC IN RPR-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-LREC IN RPR-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-LREC IN RPR-FLD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_RPR
      *<<<<
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NOMC IN RPR-FLD.
      *>>>>
*% END
*% IF FIN_RPR_COD_TFRM
      *VAL-COD Valida codigo de tabla
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'DRE ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-COD-TFRM IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *<<<<
           IF MSG-COD-MENS = 'COD    NEX' OR
              RPR-COD-TFRM IN RPR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-LDOC IN RPR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-LDOC IN RPR-FLD.
      *>>>>
*% END
*% IF INI_RPR_IND_ESTA
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'EST ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-IND-ESTA IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              RPR-IND-ESTA IN RPR-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-ESTA IN RPR-FLD
           ELSE
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-ESTA IN RPR-FLD.
      *>>>>
*% END
*% IF FIN_RPR_COD_EJEC
      *<<<<
           MOVE USR-COD-OFUS IN USR TO RPR-COD-OREC IN RPR-FLD.
      *>>>>
*% END
*% IF INI_RPR_COD_OREC
      *<<<<
           IF RPR-COD-OREC IN RPR-FLD NOT > SPACES
              MOVE SPACES TO RPR-COD-OREC IN RPR-FLD.
      *VAL-OFI Valida codigo de Oficina en TABLAS
           MOVE RPR-COD-OREC IN RPR-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS = 'COD    NEX'
               MOVE SPACES TO FRM-GLS-LREC IN RPR-FLD
           ELSE
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-LREC IN RPR-FLD.
      *>>>>
*% END
*% IF RPR_IND_DC01
      * INI RGD 01/10/2008
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-IND-DC01 IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
      * FIN RGD 01/10/2008
*% END
*% IF RPR_IND_DC02
      * INI RGD 01/10/2008
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-IND-DC02 IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
      * FIN RGD 01/10/2008
*% END
*% IF RPR_IND_DC03
      * INI RGD 01/10/2008
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-IND-DC03 IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
      * FIN RGD 01/10/2008
*% END
*% IF RPR_IND_DC04
      * INI RGD 01/10/2008
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-IND-DC04 IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
      * FIN RGD 01/10/2008
*% END
*% IF RPR_IND_DC05
      * INI RGD 01/10/2008
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-IND-DC05 IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
      * FIN RGD 01/10/2008
*% END
*% IF RPR_IND_DC06
      * INI RGD 01/10/2008
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-IND-DC06 IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
      * FIN RGD 01/10/2008
*% END
*% IF RPR_IND_DC07
      * INI RGD 01/10/2008
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-IND-DC07 IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
      * FIN RGD 01/10/2008
*% END
*% IF RPR_IND_DC08
      * INI RGD 01/10/2008
      *<<<<
      *VAL-COD Valida codigo de tabla
           MOVE 'GNS' TO TAB-COD-SIST.
           MOVE 'SON ' TO TAB-COD-TTAB IN TAB.
           MOVE RPR-IND-DC08 IN RPR-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
      * FIN RGD 01/10/2008
*% END
*% IF DBC_GLS_ICLI
      * INI RGD 01/10/2008
      *<<<<
           IF DBC-NUM-ICLI IN RPR-FLD > ZEROES
              MOVE DBC-NUM-ICLI IN RPR-FLD TO DBC-NUM-ICLI IN DBC
              MOVE DBC-IND-ICLI IN RPR-FLD TO DBC-IND-ICLI IN DBC
              MOVE DBC-GLS-ICLI IN RPR-FLD TO DBC-GLS-ICLI IN DBC
              MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF NOT FIO-STAT-OKS
                  MOVE 'SGC'        TO MSG-COD-SIST
                  MOVE 'CLI    NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO FRM-GLS-NOMC IN RPR-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-GLS-ICLI
              ELSE
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                  PERFORM CPT-BLKS
                  MOVE CPT-STRN  TO FRM-GLS-NOMC IN RPR-FLD.
      *>>>>
      * FIN RGD 01/10/2008
*% END
