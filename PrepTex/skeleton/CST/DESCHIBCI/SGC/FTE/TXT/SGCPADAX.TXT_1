*%! Codigo adicional para archivo SGCPARCO.
*% NO_HDR_CST = FALSE
*% PGM_PTC = TRUE
*%! Codigo adicional para programa
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI                                                
           03 SCR-CIC-ICLI.                                             
              05 SCR-CAI-ICLI                 PIC X(04).                
              05 SCR-IIC-ICLI                 PIC X(08).                
      *>>>>                                                             
*% END
*% IF WSS
      *<<<< WSS                                                         
       COPY SGCBRRPR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RPR-REQA==.        
       COPY SGCBRIPC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IPC-REQA==.        
       COPY SGCBRDBC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
                                                                        
       COPY GNSWGSTR.                                                   
       COPY GNSWGCPT.                                                   
       COPY TABWGLOC.                                                   
                                                                        
       01  WSS-VARI.                                                    
           03 WSS-CIC-ICLI              PIC X(12).                      
           03 WSS-KEY-IIPC              PIC X(15).                      
           03 WSS-CIC-TIPO.                                             
              05 WSS-CAI-TIPO           PIC X(04).                      
              05 WSS-IIC-TIPO           PIC X(08).                      
      *>>>>                                                             
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY                                                 
           IF SCR-CMND = 'ING'                                          
               PERFORM GET-FHOY                                         
               MOVE HOY-DHOY TO DAP-NUM-DEFR IN DAX-FLD                 
               MOVE HOY-MHOY TO DAP-NUM-MEFR IN DAX-FLD                 
               MOVE HOY-SHOY TO DAP-NUM-SEFR IN DAX-FLD                 
               MOVE HOY-AHOY TO DAP-NUM-AEFR IN DAX-FLD                 
               MOVE SCR-USER TO DAP-COD-EEFR IN DAX-FLD.                
      *>>>>                                                             
*% END
*% IF CMN_ING
      *<<<< CMN_ING                                                     
                                                                        
      *    Usuario que Ingresa                                          
           MOVE SCR-USER TO DAP-COD-EEFR IN DAP.                        
      *    Fecha Transaccion                                            
           MOVE HOY-FHOY TO DAP-FEC-FEFR IN DAP.                        
      *>>>>                                                             
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING                                                 
           MOVE FIO-STAT TO PGM-STAT-DAP.                               
           PERFORM ACT-IPC.                                             
           MOVE PGM-STAT-DAP TO FIO-STAT.                               
      *>>>>                                                             
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI                                                 
           MOVE FIO-STAT TO PGM-STAT-DAP.                               
           PERFORM ACT-IPC.                                             
           MOVE PGM-STAT-DAP TO FIO-STAT.                               
      *>>>>                                                             
*% END
*% IF FND_KEY
      *<<<< FND_KEY                                                     
           IF DAP-IIC-IFOL IN DAX-FLD > ZEROES                          
               PERFORM OBT-FOL                                          
           ELSE                                                         
           IF DBC-NUM-ICLI IN DAX-FLD > ZEROES                          
               PERFORM OBT-CLI-FOL.                                     
                                                                        
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-FND-KEY.                                       
                                                                        
           MOVE RPR-CAI-IFOL TO DAP-CAI-IFOL IN DAP.                    
           MOVE RPR-IIC-IFOL TO DAP-IIC-IFOL IN DAP.                    
           MOVE RPR-CAI-IFOL TO DAP-CAI-IFOL IN DAX-FLD.                
           MOVE RPR-IIC-IFOL TO DAP-IIC-IFOL IN DAX-FLD.                
                                                                        
       CON-FND-KEY.                                                     
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY                                                 
           IF FIO-STAT-OKS AND                                          
              RPR-IND-ESTA IN RPR = 'A' AND                             
             (SCR-CMND = 'ELI' OR SCR-CMND = 'MOD')                     
               MOVE 'SGC' TO MSG-COD-SIST                               
               MOVE 'FOLRPRYAACA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE '00' TO FIO-STAT                                    
               MOVE SCR-STAT-CON TO SCR-STAT                            
               MOVE PGM-STAT-DAP TO FIO-STAT                            
               GO TO FIN-FND-KEY.                                       
                                                                        
           IF FIO-STAT-OKS AND                                          
              RPR-IND-ESTA IN RPR NOT = 'A' AND                         
              SCR-CMND = 'MRA'                                          
               MOVE 'SGC' TO MSG-COD-SIST                               
               MOVE 'FOLRPRNOACA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE '00' TO FIO-STAT                                    
               MOVE SCR-STAT-CON TO SCR-STAT                            
               MOVE PGM-STAT-DAP TO FIO-STAT                            
               GO TO FIN-FND-KEY.                                       
                                                                        
      *>>>>                                                             
*% END
*% IF EOF
      *<<<< EOF                                                         
       OBT-FOL SECTION.                                                 
       INI-OBT-FOL.                                                     
           MOVE DAP-CAI-IFOL IN DAX-FLD TO RPR-CAI-IFOL IN RPR.         
           MOVE DAP-IIC-IFOL IN DAX-FLD TO RPR-IIC-IFOL IN RPR.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-RPR.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'SGC'          TO MSG-COD-SIST                      
               MOVE 'FOLRPRNODISP' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-OBT-FOL.                                       
           MOVE RPR-CIC-ICLI IN RPR TO DBC-CIC-ICLI IN DBC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-OBT-FOL.                                       
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN DAX-FLD.         
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN DAX-FLD.         
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN DAX-FLD.         
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN DAX-FLD.         
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                        
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-NOMC IN DAX-FLD.                    
       FIN-OBT-FOL.                                                     
           EXIT.                                                        
                                                                        
       OBT-CLI-FOL SECTION.                                             
       INI-OBT-CLI-FOL.                                                 
           MOVE SCR-CIC-ICLI       TO RPR-CIC-ICLI IN RPR.              
           MOVE '99999999'         TO RPR-FEC-FRPR IN RPR.              
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           MOVE 'RPR-AKY-IRPR' TO FIO-AKEY.                             
           PERFORM SGC-FIO-RPR.                                         
       LUP-LEE-RPR.                                                     
           IF NOT (FIO-STAT-OKS AND                                     
               RPR-CIC-ICLI IN RPR = SCR-CIC-ICLI)                      
               MOVE 'SGC'          TO MSG-COD-SIST                      
               MOVE 'FOLRPRNODISP' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-OBT-CLI-FOL.                                   
                                                                        
       FIN-OBT-CLI-FOL.                                                 
           EXIT.                                                        
                                                                        
       ACT-IPC SECTION.                                                 
       INI-ACT-IPC.                                                     
           MOVE DAP-CAI-IFOL IN DAX-FLD TO IPC-CAI-IFOL IN IPC.         
           MOVE DAP-IIC-IFOL IN DAX-FLD TO IPC-IIC-IFOL IN IPC.         
           MOVE SPACES                  TO IPC-COD-TDOC IN IPC.         
           MOVE FIO-GET-NLS   TO FIO-CMND.                              
       LUP-ACT-IPC.                                                     
           PERFORM SGC-FIO-IPC.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               DAP-CAI-IFOL IN DAX-FLD = IPC-CAI-IFOL IN IPC AND        
               DAP-IIC-IFOL IN DAX-FLD = IPC-IIC-IFOL IN IPC)           
                GO TO FIN-ACT-IPC.                                      
                                                                        
           MOVE IPC-KEY-IIPC IN IPC TO WSS-KEY-IIPC IN WSS-VARI.        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM SGC-FIO-IPC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO NXT-ACT-IPC.                                       
                                                                        
           IF SCR-CMND = 'ING'                                          
               MOVE 'S' TO IPC-IND-CDAX IN IPC                          
           ELSE                                                         
           IF SCR-CMND = 'ELI'                                          
               MOVE 'N' TO IPC-IND-CDAX IN IPC.                         
                                                                        
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM SGC-FIO-IPC.                                         
                                                                        
           MOVE WSS-KEY-IIPC IN WSS-VARI TO IPC-KEY-IIPC IN IPC.        
           MOVE FIO-GET-NLS   TO FIO-CMND.                              
           PERFORM SGC-FIO-IPC.                                         
                                                                        
       NXT-ACT-IPC.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-ACT-IPC.                                           
                                                                        
       FIN-ACT-IPC.                                                     
           EXIT.                                                        
                                                                        
LFZ****COPY GNSBEGLS.                                                   
       COPY GNSBGSTR.                                                   
       COPY GNSBGCPT.                                                   
       COPY SGCBFDBC.                                                   
       COPY SGCBFRPR.                                                   
       COPY SGCBFIPC.                                                   
       COPY SGCBGCLI.                                                   
       COPY GNSBBTAB.                                                   
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.                                                   
       COPY TABBBLOC.                                                   
       COPY TABBVLOC.                                                   
      *>>>>                                                             
*% END
