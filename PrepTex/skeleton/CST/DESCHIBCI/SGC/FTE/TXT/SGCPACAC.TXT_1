*%! Codigo adicional para archivo
*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = FALSE
*% NO_HDR_CST = FALSE
*% LARGO_TOTAL_COMMAREA = 3000
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% LARGO_MI_COMMAREA = 0
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03 SCR-CIC-ICLI.
              05  SCR-CAI-ICLI                         PIC X(04).
              05  SCR-IIC-ICLI                         PIC X(08).
      *    Indicador Protege Campos Monto y Moneda
           03 SCR-IND-PMTM                             PIC X(01).
      *    Indicador Protege Campo Porcentaje
           03 SCR-IND-PPCT                             PIC X(01).
      *    Indicador Protege Campo Descripcion
           03 SCR-IND-PDES                             PIC X(01).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       01 WSS-VARI.
          03 WSS-GLS-DAT1.
             05 WSS-COD-DAT1                           PIC X(01).
             05 WSS-COD-DAT2                           PIC X(01).
             05 WSS-COD-DAT3                           PIC X(01).
             05 WSS-COD-DAT4                           PIC X(01).
             05 WSS-COD-DAT5                           PIC X(01).
             05 WSS-COD-DAT6                           PIC X(01).
             05 WSS-COD-DAT7                           PIC X(01).
             05 WSS-GLS-FILL                           PIC X(03).
          03 WSS-CIC-CTAB                              PIC X(12).
          03 WSS-STP-FINI.
             05 WSS-FEC-FINI.
                07 WSS-NUM-SINI                        PIC 9(02).
                07 WSS-NUM-AINI                        PIC 9(02).
                07 WSS-NUM-MINI                        PIC 9(02).
                07 WSS-NUM-DINI                        PIC 9(02).
             05 WSS-HRA-HINI                           PIC 9(06).
          03 WSS-STP-FTER.
             05 WSS-FEC-FTER.
                07 WSS-NUM-STER                        PIC 9(02).
                07 WSS-NUM-ATER                        PIC 9(02).
                07 WSS-NUM-MTER                        PIC 9(02).
                07 WSS-NUM-DTER                        PIC 9(02).
             05 WSS-HRA-HTER                           PIC 9(06).
*% IF PGM_PQ
          03 WSS-CIC-CPTO                              PIC X(12).
          03 WSS-CIC-CLSF   VALUE 'FATCACLSF   '       PIC X(12).
          03 WSS-CIC-PNAT   VALUE 'FATCAPNAT   '       PIC X(12).
          03 WSS-CIC-PJRD   VALUE 'FATCAPJRD   '       PIC X(12).
          03 WSS-CIC-PJRD1  VALUE 'FATCAPJRD1  '       PIC X(12).
*% END

       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
*% IF INI_FIO AND PGM_PQ
      *<<<< INI_FIO
           PERFORM GET-FHOY.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF SCR-CMND NOT = 'ING'
               GO TO CNT-FND-KEY.
           MOVE CAC-COD-CPTO IN CAC-FLD TO CAC-COD-CPTO IN CAC.
           MOVE SCR-CIC-ICLI            TO CAC-CIC-ICLI IN CAC.
           MOVE 99999999                TO CAC-FEC-FINI IN CAC.
           MOVE 999999                  TO CAC-HRA-HINI IN CAC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-CAC.
           IF NOT (FIO-STAT-OKS AND
                   CAC-COD-CPTO IN CAC = CAC-COD-CPTO IN CAC-FLD AND
                   CAC-CIC-ICLI IN CAC = SCR-CIC-ICLI)
               MOVE '23'     TO FIO-STAT
               MOVE FIO-STAT TO PGM-STAT-CAC
               GO TO FIN-FND-KEY.

           IF CAC-IND-VIGE IN CAC = 'S'
               MOVE 'CAC    VIG' TO MSG-COD-MENS
               GO TO SIG-FND-KEY.

           MOVE CAC-NUM-SINI IN CAC-FLD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE CAC-NUM-AINI IN CAC-FLD TO WSS-NUM-AINI IN WSS-VARI.
           MOVE CAC-NUM-MINI IN CAC-FLD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE CAC-NUM-DINI IN CAC-FLD TO WSS-NUM-DINI IN WSS-VARI.
           MOVE CAC-HRA-HINI IN CAC-FLD TO WSS-HRA-HINI IN WSS-VARI.

           IF WSS-STP-FINI IN WSS-VARI NOT > CAC-STP-FTER IN CAC
               MOVE 'FINI<CACFTER' TO MSG-COD-MENS
               GO TO SIG-FND-KEY.

           MOVE '23' TO FIO-STAT
           MOVE FIO-STAT TO PGM-STAT-CAC
           GO TO FIN-FND-KEY.

       CNT-FND-KEY.
           PERFORM KEY-ALL-CAC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-CAC.
           IF NOT (FIO-STAT-OKS AND
                   CAC-COD-CPTO IN CAC = CAC-COD-CPTO IN CAC-FLD AND
                   CAC-CIC-ICLI IN CAC = SCR-CIC-ICLI)
              MOVE '23' TO FIO-STAT
              MOVE FIO-STAT TO PGM-STAT-CAC
              GO TO FIN-FND-KEY.

           MOVE CAC-STP-ITRN IN CAC TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-CAC.
           GO TO CNT-FND-KEY-OK.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CNT-FND-KEY-OK.
           IF SCR-CMND = 'ANL' AND CAC-IND-VIGE IN CAC = 'N'
               MOVE 'CAC    YAANL' TO MSG-COD-MENS
               GO TO SIG-FND-KEY.
           IF SCR-CMND = 'MOD' AND CAC-IND-VIGE IN CAC = 'N'
               MOVE 'CAC    YAANL' TO MSG-COD-MENS
               GO TO SIG-FND-KEY.

           GO TO FIN-FND-KEY.
       SIG-FND-KEY.
           MOVE 'TAB'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00'         TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-IND-PMTM IN SCR-VARI = 'S'
               MOVE FRM-CPIM-AEY TO CAC-VAL-MNTO-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-COD-MONE-ATR IN CAC-FLD.
           IF SCR-IND-PPCT IN SCR-VARI = 'S'
               MOVE FRM-CPIM-AEY TO CAC-VAL-PORC-ATR IN CAC-FLD.
           IF SCR-IND-PDES IN SCR-VARI = 'S'
               MOVE FRM-CPIM-AEY TO CAC-GLS-DESC-ATR IN CAC-FLD.
           IF SCR-CMND = 'ANL'
               MOVE HOY-SHOY     TO CAC-NUM-STER     IN CAC-FLD
               MOVE HOY-AHOY     TO CAC-NUM-ATER     IN CAC-FLD
               MOVE HOY-MHOY     TO CAC-NUM-MTER     IN CAC-FLD
               MOVE HOY-DHOY     TO CAC-NUM-DTER     IN CAC-FLD
               MOVE HOY-HHOY     TO CAC-HRA-HTER     IN CAC-FLD
               MOVE 'N'          TO CAC-IND-VIGE     IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-COD-COD1-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-COD-COD2-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-COD-COD3-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-COD-COD4-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-VAL-MNTO-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-COD-MONE-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-VAL-PORC-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-GLS-DESC-ATR IN CAC-FLD.

           IF SCR-CMND = 'ING'
               MOVE FRM-CPIM-AEY TO CAC-FEC-FTER-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-HRA-HTER-ATR IN CAC-FLD
               MOVE 'S'          TO CAC-IND-VIGE     IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-IND-VIGE-ATR IN CAC-FLD.
           IF SCR-CMND = 'MOD'
               MOVE FRM-CPIM-AEY TO CAC-FEC-FTER-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-HRA-HTER-ATR IN CAC-FLD
               MOVE FRM-CPIM-AEY TO CAC-IND-VIGE-ATR IN CAC-FLD.

      *    MOVE FRM-CPIM-AEY TO FRM-COD-CD12-ATR IN CAC-FLD.
      *    MOVE FRM-CPIM-AEY TO FRM-COD-CD34-ATR IN CAC-FLD.
      *    MOVE FRM-CPIM-AEY TO FRM-GLS-DES1-ATR IN CAC-FLD.
      *    MOVE FRM-CPIM-AEY TO FRM-GLS-DES2-ATR IN CAC-FLD.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       COPY GNSBGVSM.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY SGCBFDBC.
*% END
