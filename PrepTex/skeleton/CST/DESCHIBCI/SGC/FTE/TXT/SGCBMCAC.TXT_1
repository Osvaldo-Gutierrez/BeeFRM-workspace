*%! Codigo adicional para archivo
*% IF FIN_FST_FLD_CAC
      *<<<<
           IF SCR-CMND = 'ING' OR 'MOD'
               MOVE FRM-RST-PCUR TO CAC-FEC-FTER-LEN IN CAC-FLD
               MOVE FRM-POS-CURS TO CAC-GLS-DESC-LEN IN CAC-FLD.
      *>>>>
*% END
*% IF FIN_PUT_CAC_CAC
      *<<<< FIN_PUT_CAC_CAC
           IF CAC-COD-CPTO IN CAC-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'PSC'                   TO TAB-COD-TTAB IN TAB
               MOVE CAC-COD-CPTO IN CAC-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-CIC-CTAB IN TAB     TO WSS-CIC-CPTO IN WSS-VARI
               MOVE TAB-GLS-DESC IN TAB     TO FRM-GLS-CPTO IN CAC-FLD
           ELSE
               MOVE SPACES                  TO FRM-GLS-CPTO IN CAC-FLD.

           MOVE CAC-CIC-ICLI IN CAC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
           ELSE
               MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN CAC-FLD
               MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN CAC-FLD
               MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN CAC-FLD
               MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN CAC-FLD.

           IF CAC-COD-MONE IN CAC-FLD > SPACES
              MOVE 'VLR '                  TO TAB-COD-TTAB IN TAB
              MOVE CAC-COD-MONE IN CAC-FLD TO TAB-COD-CTAB IN TAB
              PERFORM BUS-TAB
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-MONE IN CAC-FLD
           ELSE
              MOVE SPACES              TO FRM-GLS-MONE IN CAC-FLD.


           IF WSS-CIC-CPTO IN WSS-VARI = WSS-CIC-CLSF IN WSS-VARI
              MOVE CAC-COD-COD1 IN CAC TO CAC-COD-COD1 IN CAC-FLD
              MOVE CAC-COD-COD2 IN CAC TO CAC-COD-COD2 IN CAC-FLD
              MOVE SPACES              TO FRM-COD-CD12 IN CAC-FLD.

           IF WSS-CIC-CPTO IN WSS-VARI = WSS-CIC-PNAT IN WSS-VARI
              MOVE CAC-COD-COD1 IN CAC TO CAC-COD-COD1 IN CAC-FLD
              MOVE CAC-COD-COD2 IN CAC TO CAC-COD-COD2 IN CAC-FLD
              MOVE SPACES              TO FRM-COD-CD12 IN CAC-FLD
              MOVE CAC-COD-COD3 IN CAC TO CAC-COD-COD3 IN CAC-FLD
              MOVE CAC-COD-COD4 IN CAC TO CAC-COD-COD4 IN CAC-FLD
              MOVE SPACES              TO FRM-COD-CD34 IN CAC-FLD
              MOVE CAC-GLS-DES1 IN CAC TO FRM-GLS-DES1 IN CAC-FLD
              MOVE CAC-GLS-DES2 IN CAC TO FRM-GLS-DES2 IN CAC-FLD
              MOVE SPACES              TO CAC-GLS-DESC IN CAC-FLD.

           IF WSS-CIC-CPTO IN WSS-VARI = WSS-CIC-PJRD IN WSS-VARI
              MOVE CAC-COD-COD1 IN CAC TO CAC-COD-COD1 IN CAC-FLD
              MOVE CAC-COD-COD2 IN CAC TO CAC-COD-COD2 IN CAC-FLD
              MOVE SPACES              TO FRM-COD-CD12 IN CAC-FLD
              MOVE SPACES              TO CAC-COD-COD3 IN CAC-FLD
              MOVE SPACES              TO CAC-COD-COD4 IN CAC-FLD
              MOVE CAC-COD-CD34 IN CAC TO FRM-COD-CD34 IN CAC-FLD
              MOVE CAC-GLS-DES1 IN CAC TO FRM-GLS-DES1 IN CAC-FLD
              MOVE CAC-GLS-DES2 IN CAC TO FRM-GLS-DES2 IN CAC-FLD
              MOVE SPACES              TO CAC-GLS-DESC IN CAC-FLD.

           IF WSS-CIC-CPTO IN WSS-VARI = WSS-CIC-PJRD1 IN WSS-VARI
              MOVE CAC-COD-COD1 IN CAC TO CAC-COD-COD1 IN CAC-FLD
              MOVE CAC-COD-COD2 IN CAC TO CAC-COD-COD2 IN CAC-FLD
              MOVE SPACES              TO FRM-COD-CD12 IN CAC-FLD
              MOVE SPACES              TO CAC-COD-COD3 IN CAC-FLD
              MOVE SPACES              TO CAC-COD-COD4 IN CAC-FLD
              MOVE CAC-COD-CD34 IN CAC TO FRM-COD-CD34 IN CAC-FLD
              MOVE SPACES              TO FRM-GLS-DES1 IN CAC-FLD
              MOVE SPACES              TO FRM-GLS-DES2 IN CAC-FLD
              MOVE CAC-GLS-DESC IN CAC TO CAC-GLS-DESC IN CAC-FLD.
      *>>>>
*% END
*% IF CAC_COD_CPTO
      *<<<< CAC_COD_CPTO
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'PSC'                   TO TAB-COD-TTAB IN TAB.
           MOVE CAC-COD-CPTO IN CAC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
               MOVE SPACES       TO FRM-GLS-CPTO IN CAC-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAC-COD-CPTO
           ELSE
               MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-DAT1 IN WSS-VARI
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-CPTO IN CAC-FLD.

           IF WSS-COD-DAT2 IN WSS-VARI NOT = 'S'
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CPTO   NOVLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAC-COD-CPTO.

           MOVE WSS-COD-DAT3 IN WSS-VARI TO SCR-IND-PMTM IN SCR-VARI.
           MOVE WSS-COD-DAT4 IN WSS-VARI TO SCR-IND-PPCT IN SCR-VARI.
           MOVE WSS-COD-DAT5 IN WSS-VARI TO SCR-IND-PDES IN SCR-VARI.
      *>>>>
*% END
*% IF CAC_IND_VIGE
      *<<<< CAC_IND_VIGE
      *PVG INI 02-JUN-2014
           IF SCR-OFRM-SRV AND SCR-CMND = 'ANL'
              MOVE 'N' TO CAC-IND-VIGE IN CAC-FLD
              GO TO FIN-VAL-CAC-IND-VIGE.
      *PVG FIN 02-JUN-2014
           IF SCR-CMND = 'ANL' AND CAC-IND-VIGE IN CAC-FLD NOT = 'N'
              MOVE 'TAB'        TO MSG-COD-SIST
              MOVE 'CACVIGENVL' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CAC-IND-VIGE.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VIG'                   TO TAB-COD-TTAB IN TAB.
           MOVE CAC-IND-VIGE IN CAC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      *>>>>
*% END
*% IF FIN_KEY_DBC_CAC
*% IF PGM_BQ
      *<<<< FIN_KEY_DBC_CAC
*% END
*% IF PGM_BU
      *<<<< FIN_KEY_CAC_CAC
*% END
           MOVE SCR-CIC-ICLI            TO CAC-CIC-ICLI IN CAC.
      *>>>>
*% END
*% IF FIN_RET_CAC_CAC
      *PVG INI 02-JUN-2014
           IF (CAC-COD-COD1 IN CAC-FLD NOT > SPACES AND
               CAC-COD-COD2 IN CAC-FLD NOT > SPACES AND
               FRM-COD-CD12 IN CAC-FLD > SPACES)
              MOVE FRM-COD-CD12 IN CAC-FLD TO CAC-COD-CD12 IN CAC.
           IF (CAC-COD-COD3 IN CAC-FLD NOT > SPACES AND
               CAC-COD-COD4 IN CAC-FLD NOT > SPACES AND
               FRM-COD-CD34 IN CAC-FLD > SPACES)
              MOVE FRM-COD-CD34 IN CAC-FLD TO CAC-COD-CD34 IN CAC.
           IF (CAC-GLS-DESC IN CAC-FLD NOT > SPACES AND
               FRM-GLS-DES1 IN CAC-FLD > SPACES)
              MOVE FRM-GLS-DES1 IN CAC-FLD TO CAC-GLS-DES1 IN CAC.
           IF (CAC-GLS-DESC IN CAC-FLD NOT > SPACES AND
               FRM-GLS-DES2 IN CAC-FLD > SPACES)
              MOVE FRM-GLS-DES2 IN CAC-FLD TO CAC-GLS-DES2 IN CAC.
      *PVG FIN 02-JUN-2014
*% END
*% IF CAC_COD_MON1
      *<<<< CAC_COD_MON1
           IF CAC-COD-MON1 IN CAC-FLD NOT > SPACES AND
              CAC-VAL-MTO1 IN CAC-FLD > ZEROES
               PERFORM ERR-GLS
               GO TO FIN-VAL-CAC-COD-MON1.

           IF CAC-COD-MON1 IN CAC-FLD > SPACES AND
              CAC-VAL-MTO1 IN CAC-FLD NOT > ZEROES
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'MON    NOVLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CAC-COD-MON1.

      *VAL-COD Valida codigo de tabla
           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR '                  TO TAB-COD-TTAB IN TAB.
           MOVE CAC-COD-MON1 IN CAC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-VCOC IN ROC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-MON1 IN CAC-FLD.
      *>>>>
*% END
*% IF INI_DBC_NUM_ICLI
      *<<<< INI_DBC_NUM_ICLI
           IF DBC-NUM-ICLI IN CAC-FLD NOT > ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-DBC-NUM-ICLI.
      *>>>>
*% END
*% IF INI_CAC_HRA_HINI
           IF CAC-HRA-HINI IN CAC-FLD NOT > ZEROES
              MOVE HOY-HHOY IN HOY-VARI TO CAC-HRA-HINI IN CAC-FLD.
*% END
*% IF INI_CAC_HRA_HTER
           IF CAC-HRA-HTER IN CAC-FLD NOT > ZEROES
              MOVE ZEROES TO CAC-HRA-HTER IN CAC-FLD.
*% END
*% IF FIN_CAC_COD_MONE

           IF CAC-VAL-MNTO IN CAC-FLD > ZEROES AND
              CAC-COD-MONE IN CAC-FLD NOT > SPACES
              MOVE 'SGC'          TO MSG-COD-SIST
              MOVE 'CODMONE  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CAC-COD-MONE.

           IF CAC-VAL-MNTO IN CAC-FLD NOT > ZEROES AND
              CAC-COD-MONE IN CAC-FLD > SPACES
              MOVE 'SGC'          TO MSG-COD-SIST
              MOVE 'CODMONE  INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CAC-COD-MONE.

           IF CAC-COD-MONE IN CAC-FLD NOT > SPACES
              GO TO FIN-VAL-CAC-COD-MONE.

           MOVE 'TAB'                   TO TAB-COD-SIST.
           MOVE 'VLR '                  TO TAB-COD-TTAB IN TAB.
           MOVE CAC-COD-MONE IN CAC-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG'
              MOVE SPACES       TO FRM-GLS-MONE IN CAC-FLD
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
           ELSE
              MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-MONE IN CAC-FLD.
*% END
*% IF FIN_FRM_COD_CD12
      *<<<<
           IF (FRM-COD-CD12 IN CAC-FLD > SPACES AND
              (CAC-COD-COD1 IN CAC-FLD > SPACES OR
               CAC-COD-COD2 IN CAC-FLD > SPACES))
              MOVE 'SGC'          TO MSG-COD-SIST
              MOVE 'CD12     INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-CD12.
      *>>>>
*% END
*% IF FIN_FRM_COD_CD34
      *<<<<
           IF (FRM-COD-CD34 IN CAC-FLD > SPACES AND
              (CAC-COD-COD3 IN CAC-FLD > SPACES OR
               CAC-COD-COD4 IN CAC-FLD > SPACES))
              MOVE 'SGC'          TO MSG-COD-SIST
              MOVE 'CD34     INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-FRM-COD-CD34.
      *>>>>
*% END
*% IF FIN_CAC_GLS_DESC
      *<<<<
           IF (CAC-GLS-DESC IN CAC-FLD > SPACES AND
              (FRM-GLS-DES1 IN CAC-FLD > SPACES OR
               FRM-GLS-DES2 IN CAC-FLD > SPACES))
              MOVE 'SGC'          TO MSG-COD-SIST
              MOVE 'DESC     INV' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
              GO TO FIN-VAL-CAC-GLS-DESC.
      *>>>>
*% END
*% IF INI_CAC_FEC_FINI
      *<<<< INI_CAC_FEC_FINI
           IF CAC-FEC-FINI IN CAC-FLD NOT > ZEROES
              MOVE HOY-DHOY IN HOY-VARI TO CAC-NUM-DINI IN CAC-FLD
              MOVE HOY-MHOY IN HOY-VARI TO CAC-NUM-MINI IN CAC-FLD
              MOVE HOY-SHOY IN HOY-VARI TO CAC-NUM-SINI IN CAC-FLD
              MOVE HOY-AHOY IN HOY-VARI TO CAC-NUM-AINI IN CAC-FLD
              GO TO FIN-VAL-CAC-FEC-FINI.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF INI_CAC_FEC_FTER
      *<<<< INI_CAC_FEC_FTER
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-N TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
      *>>>>
*% END
*% IF CAC_FEC_FTER
      *<<<< CAC_FEC_FTER
           IF CAC-FEC-FTER IN CAC-FLD NOT > ZEROES
               GO TO FIN-VAL-CAC-FEC-FTER.

           MOVE CAC-NUM-SINI IN CAC-FLD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE CAC-NUM-AINI IN CAC-FLD TO WSS-NUM-AINI IN WSS-VARI.
           MOVE CAC-NUM-MINI IN CAC-FLD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE CAC-NUM-DINI IN CAC-FLD TO WSS-NUM-DINI IN WSS-VARI.
           MOVE CAC-HRA-HINI IN CAC-FLD TO WSS-HRA-HINI IN WSS-VARI.

           MOVE CAC-NUM-STER IN CAC-FLD TO WSS-NUM-STER IN WSS-VARI.
           MOVE CAC-NUM-ATER IN CAC-FLD TO WSS-NUM-ATER IN WSS-VARI.
           MOVE CAC-NUM-MTER IN CAC-FLD TO WSS-NUM-MTER IN WSS-VARI.
           MOVE CAC-NUM-DTER IN CAC-FLD TO WSS-NUM-DTER IN WSS-VARI.
           MOVE CAC-HRA-HTER IN CAC-FLD TO WSS-HRA-HTER IN WSS-VARI.

           IF WSS-STP-FTER IN WSS-VARI NOT > WSS-STP-FINI IN WSS-VARI
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'FTER<=FINI'   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-CAC-FEC-FTER.
      *>>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI
           IF DBC-NUM-ICLI IN CAC-FLD > ZEROES
               MOVE DBC-NUM-ICLI IN CAC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN CAC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN CAC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                  MOVE DBC-CIC-ICLI IN DBC TO SCR-CIC-ICLI
               ELSE
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'CLI    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-GLS-ICLI.
      *>>>>
*% END
