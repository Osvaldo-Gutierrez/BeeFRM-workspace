*%! Codigo adicional para archivon
*% IF PGM_BU
*% IF SETTAG
      *-----------------------------------------------------------
      * VALIDA INGRESO DE DATOS PARA PAE
      * PERSONA DE ALTA EXPOSICI(N PUBLICA
      *------------------------------------------------------------
      *---------------- M O D I F I C A C I O N E S ---------------
      *FECHA       RESPONSABLE            DESCRIPCI(N
      *19-MAR-2009 VVERGARA  PARA EL CODIGO DE PARENTESCO
      *                    "EL MISMO", SI EL INVOLUCRADO NO ES EL
      *                    TITULAR, VALIDA QUE SE HAYAN INGRESADO
      *                    SUS NOMBRES Y APELLIDOS, SINO, LOS DEJA
      *                    EN BLANCO.
      *------------------------------------------------------------
      *MANTENCION: CAMBIO FECHA HABIL
      *RESPONSABLE: AFRI
      *FECHA: NOV-2011.
      *ETIQUETA: *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL
      *CAMBIOS: SE DEJA SIN VALIDACION DE DIA HABIL CAMPO
      *         FECHA CONTRATO PERSONA PAE
      **************************************************************
*% END
*% IF INI_RET_PAE_PAE
           IF SCR-CCPP = 'MOD'                                          
              MOVE PAE-COD-EEFR IN PAE TO PAE-COD-EEFR IN PAE-FLD       
              MOVE PAE-NUM-DEFR IN PAE TO PAE-NUM-DEFR IN PAE-FLD       
              MOVE PAE-NUM-MEFR IN PAE TO PAE-NUM-MEFR IN PAE-FLD       
              MOVE PAE-NUM-SEFR IN PAE TO PAE-NUM-SEFR IN PAE-FLD       
              MOVE PAE-NUM-AEFR IN PAE TO PAE-NUM-AEFR IN PAE-FLD.  
*% END
*% IF INI_PAE_GLS_AMAT
      *VVO-INI 19-MAR-2009 -> CODIGO "EL MISMO" = 'M'
           IF WSS-GLS-DAT1 IN WSS-VARI = 'M'
                GO TO FIN-VAL-PAE-GLS-AMAT.
      *VVO-FIN 19-MAR-2009
*% END
*% IF INI_PAE_GLS_NOMB
      *VVO-INI 19-MAR-2009 -> CODIGO "EL MISMO" = 'M'
           IF WSS-GLS-DAT1 IN WSS-VARI = 'M'
                GO TO FIN-VAL-PAE-GLS-NOMB.
      *VVO-FIN 19-MAR-2009
*% END
*% IF INI_PAE_GLS_APAT
      *<<<< PAE_COD_PTZC
      *VVO-INI 19-MAR-2009 -> CODIGO "EL MISMO" = 'M'
           MOVE SPACES TO WSS-GLS-DAT1 IN WSS-VARI.
           MOVE 'SGC'                   TO TAB-COD-SIST.
           MOVE 'PZC'                   TO TAB-COD-TTAB IN TAB.
           MOVE PAE-COD-PTZC IN PAE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF MSG-COD-MENS NOT > SPACES
               MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-DAT1 IN WSS-VARI.
           IF WSS-GLS-DAT1 IN WSS-VARI = 'M'
                GO TO FIN-VAL-PAE-GLS-APAT.
      *VVO-FIN 19-MAR-2009
      *>>>> 
*% END
*% IF PAE_COD_PTZC
      *<<<< PAE_COD_PTZC
           MOVE 'SGC'                   TO TAB-COD-SIST.                
           MOVE 'PZC'                   TO TAB-COD-TTAB IN TAB.         
           MOVE PAE-COD-PTZC IN PAE-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT > SPACES                                 
               MOVE TAB-GLS-DESC TO FRM-GLS-PTZC IN PAE-FLD             
               MOVE TAB-GLS-DAT1 IN TAB TO WSS-GLS-DAT1 IN WSS-VARI

           ELSE                                                         
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-PAE-COD-PTZC.                              

      *VVO-INI 19-MAR-2009 -> CODIGO "EL MISMO" = 'M'
           IF WSS-GLS-DAT1 IN WSS-VARI = 'M'
              MOVE SPACES TO PAE-GLS-APAT IN PAE-FLD
              MOVE SPACES TO PAE-GLS-AMAT IN PAE-FLD
              MOVE SPACES TO PAE-GLS-NOMB IN PAE-FLD.
      *VVO-FIN 19-MAR-2009
      *>>>>   
*% END
*% IF PAE_COD_ORGN
      *<<<< PAE_COD_ORGN                                                
           MOVE 'SGC'                   TO TAB-COD-SIST.                
*% IF PGM_BU
      *PVC-INI 28-FEB-2016 - Clientes PEP en Punta
      *    MOVE 'OAE'                   TO TAB-COD-TTAB IN TAB.         
      *    MOVE PAE-COD-ORGN IN PAE-FLD TO TAB-COD-CTAB IN TAB.         
           MOVE WSS-CT-IPU              TO TAB-CIC-TTAB IN TAB.
           MOVE PAE-COD-ORGN IN PAE-FLD TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL'          TO FIO-AKEY.
      *    PERFORM VAL-COD.
           MOVE TAB-COD-SIST TO FIO-SIST.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COD    NEX' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
           ELSE
               MOVE SPACES TO MSG-COD-MENS.
      *PVC-FIN 28-FEB-2016 - Clientes PEP en Punta

*% END
           IF MSG-COD-MENS NOT > SPACES                                 
               MOVE TAB-GLS-DESC TO FRM-GLS-ORGN IN PAE-FLD             
           ELSE                                                         
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-PAE-COD-ORGN.                              
      *>>>>   
*% END
*% IF PAE_MSC_STAT
      *PVC-INI 28-FEB-2016 - Clientes PEP en Punta
      *<<<< PAE_MSC_STAT                                                
           MOVE 'SGC'                   TO TAB-COD-SIST.                
           MOVE 'ESP'                   TO TAB-COD-TTAB IN TAB.         
           MOVE PAE-MSC-STAT IN PAE-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT > SPACES                                 
               MOVE TAB-GLS-DESC TO FRM-GLS-STAT IN PAE-FLD             
           ELSE                                                         
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-PAE-MSC-STAT.                              
      *>>>>   
      *PVC-FIN 28-FEB-2016 - Clientes PEP en Punta
*% END
*% IF INI_PAE_FEC_FCTR
      *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL                              
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
      *AFRI-FIN 16-NOV-2011 CAMBIO FECHA HABIL
*% END
*% END
*% IF PGM_BQ
*% IF FIN_PUT_ALL_PAE
      *<<<< FIN_PUT_ALL_PAE                                             
      *     PONEMOS LA DESCRIPCION DE PARENTEZCO                        
           MOVE 'SGC'                   TO TAB-COD-SIST.                
           MOVE 'PZC'                   TO TAB-COD-TTAB IN TAB.         
           MOVE PAE-COD-PTZC IN PAE-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT > SPACES                                 
               MOVE TAB-GLS-DESC TO FRM-GLS-PTZC IN PAE-FLD             
           ELSE                                                         
               MOVE 'SIN DESCRIPCION' TO FRM-GLS-PTZC IN PAE-FLD.       
                                                                        
      *     PONEMOS LA DESCRIPCION DE ORGANISMO DE ALTA EXPOSICION      
           MOVE 'SGC'                   TO TAB-COD-SIST.                
      *PVC-INI 28-FEB-2016 - Clientes PEP en Punta
      *    MOVE 'OAE'                   TO TAB-COD-TTAB IN TAB.
      *    MOVE PAE-COD-ORGN IN PAE-FLD TO TAB-COD-CTAB IN TAB.
           MOVE WSS-CT-IPU              TO TAB-CIC-TTAB IN TAB.
           MOVE PAE-COD-ORGN IN PAE-FLD TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL'          TO FIO-AKEY.
      *    PERFORM VAL-COD.
           MOVE TAB-COD-SIST TO FIO-SIST.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'COD    NEX' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
           ELSE
               MOVE SPACES TO MSG-COD-MENS.
      *PVC-FIN 28-FEB-2016 - Clientes PEP en Punta

           IF MSG-COD-MENS NOT > SPACES                                 
               MOVE TAB-GLS-DESC TO FRM-GLS-ORGN IN PAE-FLD             
           ELSE                                                         
               MOVE 'SIN DESCRIPCION' TO FRM-GLS-ORGN IN PAE-FLD.       

      *PVC-INI 28-FEB-2016 - Clientes PEP en Punta
      *     PONEMOS LA DESCRIPCION DEL ESTADO                        
           MOVE 'SGC'                   TO TAB-COD-SIST.                
           MOVE 'ESP'                   TO TAB-COD-TTAB IN TAB.         
           MOVE PAE-MSC-STAT IN PAE-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF MSG-COD-MENS NOT > SPACES                                 
               MOVE TAB-GLS-DESC TO FRM-GLS-STAT IN PAE-FLD             
           ELSE                                                         
               MOVE 'SIN DESCRIPCION' TO FRM-GLS-STAT IN PAE-FLD.       
      *PVC-FIN 28-FEB-2016 - Clientes PEP en Punta
      *>>>>  
*% END
*% IF FIN_PUT_DBC_PAE
      *<<<< FIN_PUT_DBC_PAE                                             
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                        
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-NOMC IN PAE-FLD.                    
      *>>>> 
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI                                                
           IF DBC-NUM-ICLI IN PAE-FLD > ZEROES                          
              MOVE DBC-NUM-ICLI IN PAE-FLD TO DBC-NUM-ICLI IN DBC       
              MOVE DBC-IND-ICLI IN PAE-FLD TO DBC-IND-ICLI IN DBC       
              MOVE DBC-GLS-ICLI IN PAE-FLD TO DBC-GLS-ICLI IN DBC       
              MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY                          
              MOVE FIO-GET-KEY TO FIO-CMND                              
              PERFORM SGC-FIO-DBC                                       
              IF NOT FIO-STAT-OKS                                       
                  MOVE 'SGC'        TO MSG-COD-SIST                     
                  MOVE 'CLI    NEX' TO MSG-COD-MENS                     
                  PERFORM GET-MSG                                       
                  MOVE SPACES       TO FRM-GLS-NOMC IN PAE-FLD          
                  MOVE MSG-GLS-DESC TO FRM-MENS                         
                  MOVE FRM-SUAR-MAL TO FRM-SUAR                         
                  GO TO FIN-VAL-DBC-GLS-ICLI                            
              ELSE                                                      
                  MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN                  
                  PERFORM CPT-BLKS                                      
                  MOVE CPT-STRN  TO FRM-GLS-NOMC IN PAE-FLD             
                  MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI              
                  MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI.             
      *>>>> 
*% END
*% IF INI_VAL_CON_KEY_PAE
      *<<<< INI_VAL_CON_KEY_PAE                                         
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               GO TO FIN-VAL-CON-KEY-PAE.                               
      *>>>>   
*% END
*% IF FIN_VAL_CON_KEY_PAE 
      *<<<< FIN_VAL_CON_KEY_PAE                                         
           IF PAE-CAI-IFOL IN PAE-FLD NOT > SPACES AND                  
              PAE-IIC-IFOL IN PAE-FLD NOT > SPACES AND                  
              DBC-NUM-ICLI IN PAE-FLD NOT > ZEROES                      
      *GET-MSG Busca mensaje en tabla                                   
               MOVE 'GNS' TO MSG-COD-SIST                               
               MOVE 'VALCONKEY'  TO MSG-COD-MENS                        
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-KEY-PAE.                               
      *>>>>   
*% END
*% END
