*%! CMA_USR = TRUE
*% HDR_CST    = TRUE
*% NO_HDR_CST = FALSE
*% PGM_PTC    = TRUE
*% GNSTCA_ORIG = 3000
*% GNSTCA = 3000
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY SGCBRRPR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RPR-REQA==.
       COPY GNSWGCPT.
       01  WSS-VARI.
           03 WSS-FND-INFO                   PIC X VALUE SPACE.
           03 GV       VALUE 'RIBOT'         PIC X(5).
      *>>>>
*% END
*% IF FIN_PGM_STAT
      *<<<< FIN_PGM_STAT
           03 PGM-CMMA.
              05 PGM-CMMA-CHR OCCURS 3000 PIC X(01).
      *>>>>
*% END
*% IF SYS_SCOD
      *<<<< SYS_SCOD
           MOVE +3000 TO SCR-TCMA.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF IPC-IIC-IFOL IN IPC-FLD = ZEROS
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN IPC-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN IPC-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN IPC-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS NOT > SPACES
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN IPC-FLD

                   MOVE DBC-CIC-ICLI IN DBC TO RPR-CIC-ICLI IN RPR

                   MOVE '00' TO PGM-STAT-DBC

                   PERFORM GET-RPR-CLI

               ELSE
                   MOVE MSG-GLS-DESC TO FRM-MENS IPC-GLS-MENS
                   MOVE 'S' TO SCR-IERR.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF FIO-STAT-OKS
              AND
              DBC-GLS-NOMC IN IPC-FLD = SPACES
              PERFORM GET-RPR-FOL.

           IF WSS-FND-INFO IN WSS-VARI = 'S'
               SET PGM-STAT-DBC-OKS TO TRUE
               SET PGM-STAT-RPR-OKS TO TRUE
           ELSE
              MOVE 'SGC'          TO MSG-COD-SIST
              MOVE 'FOLRPRNODISP' TO MSG-COD-MENS
              PERFORM GET-MSG.
      *>>>>
*% END
*% IF EOF_IBM
      *<<<< EOF
       COPY GNSBGCPT.
       COPY GNSBBTAB.
       COPY GNSBVTAB.
       COPY GNSBVCOD.
       COPY SGCBGCLI.
       COPY SGCBFDBC.
       COPY SGCBFRPR.

       GET-RPR-CLI SECTION.
       INI-GET-RPR-CLI.
           MOVE 'N'                       TO WSS-FND-INFO IN WSS-VARI.
           MOVE '99999999'                TO RPR-FEC-FRPR IN RPR.
           MOVE FIO-GET-LEQ               TO FIO-CMND.
       LUP-FND-RPR-LAST.
           MOVE 'RPR-AKY-IRPR'            TO FIO-AKEY.
           PERFORM SGC-FIO-RPR.
           IF NOT FIO-STAT-OKS OR FIO-STAT-EOF
              GO TO FIN-GET-RPR-CLI.
           IF RPR-CIC-ICLI IN RPR NOT = DBC-CIC-ICLI IN DBC
              GO TO FIN-GET-RPR-CLI
           ELSE
                 MOVE 'S'                 TO WSS-FND-INFO IN WSS-VARI
                 MOVE RPR-CAI-IFOL IN RPR TO IPC-CAI-IFOL IN IPC-FLD
                 MOVE RPR-IIC-IFOL IN RPR TO IPC-IIC-IFOL IN IPC-FLD
                 GO TO FIN-GET-RPR-CLI.
           MOVE FIO-GET-PRV            TO FIO-CMND.
           GO TO LUP-FND-RPR-LAST.
       FIN-GET-RPR-CLI.
           EXIT.

       GET-RPR-FOL SECTION.
       INI-GET-RPR-FOL.

           MOVE 'N'                       TO WSS-FND-INFO IN WSS-VARI.
           MOVE IPC-CIC-IFOL IN IPC       TO RPR-CIC-IFOL IN RPR
           MOVE SPACES                    TO FIO-AKEY.
           MOVE FIO-GET-KEY               TO FIO-CMND.
           PERFORM SGC-FIO-RPR.
           IF NOT FIO-STAT-OKS
              MOVE 'SGC'          TO MSG-COD-SIST
              MOVE 'FOLRPRNODISP' TO MSG-COD-MENS
              PERFORM GET-MSG

              MOVE MSG-GLS-DESC   TO FRM-MENS
              MOVE FRM-SUAR-MAL   TO FRM-SUAR

           ELSE

              PERFORM GET-DBC-CLI.


       FIN-GET-RPR-FOL.
           EXIT.

       GET-DBC-CLI SECTION.
       INI-GET-DBC-CLI.
           MOVE RPR-CIC-ICLI IN RPR TO DBC-CIC-ICLI IN DBC
           MOVE SPACES      TO FIO-AKEY
           MOVE FIO-GET-KEY TO FIO-CMND
           PERFORM SGC-FIO-DBC
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE SPACES       TO DBC-GLS-NOMC IN IPC-FLD
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
            ELSE
               MOVE 'S'                    TO WSS-FND-INFO IN WSS-VARI
               PERFORM CPT-STR-NOMC.

       FIN-GET-DBC-CLI.
           EXIT.


       CPT-STR-NOMC SECTION.
       INI-CPT-STR-NOMC.
            MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
            PERFORM CPT-BLKS.
            MOVE CPT-STRN  TO DBC-GLS-NOMC IN IPC-FLD.
       FIN-CPT-STR-NOMC.
            EXIT.
      *>>>>
*% END
