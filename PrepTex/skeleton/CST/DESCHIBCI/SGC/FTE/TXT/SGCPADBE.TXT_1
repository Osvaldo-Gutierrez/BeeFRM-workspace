*%! Codigo adicional
*% NO_TIENE_TIMESTAMP = TRUE
*% NO_HDR_CST = TRUE
*% PGM_PTC = TRUE
*% IF PGM_ARG
*% INCLUDE 'GNSSRC:MANEJO_VSI.SRC'
*% FRM = "DBE"
*% PADRE = "DBC"
*% KEY_PADRE = "DBC-GLS-NOMC"
*% LARGO_KEY_PADRE = 75
*% FIO_PADRE = "SGC-FIO-DBC"
*% SIST_PADRE = "SGC"
*% KEY_BROWSE_PADRE = "DBC-GLS-NOMC"
*% ORG_PADRE_VSI = TRUE
*% INICIALIZAR_VARIABLES = FALSE
*%
*% ACEPTE_PF7 = TRUE
*% ACEPTE_PF8 = TRUE
*% COLAR_ENT = TRUE
*%
*% INCLUDE 'PFSCONENT.SRC'
*% END
*%! ISP: LO SIGUIENTES 2 LABELS PTX DEBEN ESTAR ANTES QUE INCLUDE "PFSALLF78"
*%!      PARA QUE FUNCIONEN, DE OTRA FORMA PFSALLF78 LOS INHIBE
*% IF PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC
      *<<<< PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC
*% IF PGM_DOS OR PGM_MVS
      *<<<< PGM_DOS OR PGM_MVS
      *DAD ini  05-JUN-1992 / 13-MAY-1992
*% IF PGM_PER
      *AMP: BAJO COMANDO MDA Y IDA PERMITE SOLO TECLAS <ENTER> Y <PF11>.
           OR (( SCR-CMND = WSS-CMND-DBE-MDA OR WSS-CMND-DBE-IDA ) AND
*% ELSE
      *ISP: BAJO COMANDO ICD Y CCL PERMITE SOLO TECLAS <ENTER> Y <PF11>.
           OR (( SCR-CMND = WSS-CMND-DBE-ICD OR WSS-CMND-DBE-CCL ) AND
*% END
      *DAD fin  05-JUN-1992
                NOT ( FRM-FFLD = FRM-FFLD-RET OR
                      FRM-FFLD = FRM-FFLD-PF11   ))
      *DAD fin  13-MAY-1992
      *>>>>
*% END
      *>>>>
*% END
*% IF PFS_SCR_GCNF
      *<<<< PFS_SCR_GCNF
*% IF PGM_DOS OR PGM_MVS
      *<<<< PGM_DOS OR PGM_MVS
      *DAD ini  05-JUN-1992 / 13-MAY-1992
*% IF PGM_PER
      *AMP: BAJO COMANDO MDA Y IDA PERMITE SOLO TECLAS <ENTER> Y <PF11>..
           OR (( SCR-CMND = WSS-CMND-DBE-MDA OR WSS-CMND-DBE-IDA ) AND
*% ELSE
      *ISP: BAJO COMANDO ICD Y CCL PERMITE SOLO TECLAS <ENTER> Y <PF11>..
           OR (( SCR-CMND = WSS-CMND-DBE-ICD OR WSS-CMND-DBE-CCL ) AND
*% END
      *DAD fin  05-JUN-1992
                NOT ( FRM-FFLD = FRM-FFLD-RET  OR
                      FRM-FFLD = FRM-FFLD-PF11 OR
                      FRM-FFLD = FRM-FFLD-PF12    ))
      *DAD fin  13-MAY-1992
      *>>>>
*% END
      *>>>>
*% END
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
*% RA1 = "DBC"
*% FRM = "DBE"
*% NRA = 1
*% TCA = 843
*% INCLUDE "PFSALLF78"
*% END
*% IF FIN_SCR_VARI
      *LRH ini 18-MAY-1994
           02 SCR-OFI-USP                         PIC X(03).
      *LRH fin 18-MAY-1994
      *LRH ini 24-OCT-1994
           02 SCR-DBC                             PIC X(241).
           02 SCR-GLS-NOMC                        PIC X(75).
           02 SCR-COD-EJEC                        PIC X(12).
           02 SCR-COD-OFIC                        PIC X(03).

      *LRH fin 24-OCT-1994
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
*% IF PGM_CHI
      *LRH ini 18-MAY-1994
       COPY SGCBRDCC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
      *LRH fin 18-MAY-1994
*% END
*% IF PGM_CHI OR PGM_ARG
      *ALD/21-JUL-1988
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RBS-REQA==.
*% END
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
*% IF PGM_PU
      *ADA-INI JSS 26-FEB-2001
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EFE-REQA==.
      *ADA-FIN JSS 26-FEB-2001
       01 WSS-COD-TERM                                PIC X(04)
*% END
      *>>>>
*% END
*% IF MI_COMMAREA AND PGM_PER
      *<<<< MI_COMMAREA AND PGM_PER
           03 SCR-CIC-ICLI.
              05 SCR-CAI-ICLI                           PIC X(04).
              05 SCR-IIC-ICLI                           PIC 9(08).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
*% IF PGM_PU
      *AFRI-INI 18-DIC-2014 CAMBIO LARGO TELEFONO
      *AFRI-INI/31072013    LARGO NUMERO TELEFONO
      *COPY SGCWGTEL.
      *AFRI-FIN/31072013    LARGO NUMERO TELEFONO
       COPY SGCWGFON.
       01 WCC-VARI.
          03 WCC-D                  VALUE 'D'        PIC X(01).
          03 WCC-E                  VALUE 'E'        PIC X(01).
          03 WCC-ING                VALUE 'ING'      PIC X(03).
          03 WCC-MOD                VALUE 'MOD'      PIC X(03).
      *AFRI-FIN 18-DIC-2014 CAMBIO LARGO TELEFONO
       COPY SGCMXW01.
*% END
       COPY SGCWGDIR.
*% IF PGM_PQ
       01  WSS-MENS VALUE SPACES.
           03 WSS-MSG-COD-SIST                   PIC X(03).
           03 WSS-MSG-COD-MENS                   PIC X(12).
           03 WSS-MSG-GLS-DESC                   PIC X(40).
           03 WSS-MSG-GLS-DATA                   PIC X(45).
*% END
*% IF PGM_CHI OR PGM_ARG
      *ALD/21-JUL-1988
       COPY SGCBRRBS.
*% END
       01  WSS-CMND-DBP.
*% IF PGM_PU
           03  WSS-CMND-DBE-ING               VALUE 'ING'   PIC X(03).
*% END
*% IF PGM_ARG
           03  WSS-CMND-DBE-MNC               VALUE 'MRZ'   PIC X(03).
*% ELSE
           03  WSS-CMND-DBE-MNC               VALUE 'MNC'   PIC X(03).
*% END
           03  WSS-CMND-DBE-MDA               VALUE 'MDA'   PIC X(03).
           03  WSS-CMND-DBE-IDA               VALUE 'IDA'   PIC X(03).
           03  WSS-CMND-DBE-ICD               VALUE 'ICD'   PIC X(03).
           03  WSS-CMND-DBE-CCL               VALUE 'CCL'   PIC X(03).
           03  WSS-CMND-DBE-MIC               VALUE 'MIC'   PIC X(03).
           03  WSS-CMND-DBE-INC               VALUE 'INC'   PIC X(03).
           03  WSS-CMND-DBE-MNJ               VALUE 'MNJ'   PIC X(03).
           03  WSS-CMND-DBE-EAP               VALUE 'EAP'   PIC X(03).
           03  WSS-CMND-DBE-VRF               VALUE 'VRF'   PIC X(03).
      *LRH ini 20-ABR-1994
           03  WSS-CMND-DBE-MVA               VALUE 'MVA'   PIC X(03).
      *LRH fin 20-ABR-1994
       COPY SGCBRREC.
       COPY SGCBRDCE.
       COPY SGCBRDCP.
       COPY SGCBRRCD.
       COPY GNSBRCIC.
       COPY TABBRPAI.
*%! IF PGM_PER
       COPY TABWGLOC.
*%! END
*% IF NOT PGM_PER
      *<<<< NOT PGM_PER
       COPY GNSWGFEC.
       COPY GNSWGHOY.
      *>>>>
*% END
*% IF PGM_PU
      *ADA-INI JSS 26-FEB-2001
       COPY SGCBREFE.
      *ADA-FIN JSS 26-FEB-2001
*% END
       COPY GNSWGCIC.
       COPY GNSWGSTR.
       COPY GNSWGCPT.
       COPY SGCWVPPU.
*% IF PGM_BCI
      *LRH ini 24-OCT-1994
       COPY SGCBRLOG.
      *LRH fin 24-OCT-1994
       01  WSS-VARI.
           03 WSS-STR-NOMC.
              05 WSS-STR-NOM1                           PIC X(40).
              05 WSS-STR-NOM2                           PIC X(40).
      *RJZ INI 29-DEC-1994 15:21:46
           03 SCR-IND-TICL                              PIC X(01).
           03 SCR-DCE                                   PIC X(158).
           03 SCR-COD-TSOC                              PIC X(02).
      *RJZ FIN  4-JAN-1995 12:01:28
           03 WSS-COD-CTCA.
              05 WSS-COD-TREC                           PIC X(02).
*% IF PGM_PER
              05 WSS-COD-AREC                           PIC X(03).
*% ELSE
      *DAD ini  26-JUL-1993
              05 WSS-COD-AREC                           PIC X(05).
           03 WSS-NUM-MRUT            VALUE 50000000    PIC 9(08).
      *DAD fin  26-JUL-1993
      *DAD ini  09-FEB-1994
           03 WSS-COD-TBAN                              PIC X(03).
              88 VAL-TBAN             VALUES ARE 'I', 'B', 'G', 'A'.
      *DAD fin  09-FEB-1994
*% END
      *DAD ini  09-FEB-1994
      *     03 WSS-COD-LUGA.
      *        05 WSS-COD-COMU                           PIC X(04).
      *        05 WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
      *           07 WSS-IND-PAIS                        PIC X(01).
      *           07 WSS-COD-PAIS                        PIC X(03).
      *DAD fin  09-FEB-1994
           03 WSS-COD-TUSR                              PIC X(05).
           03 WSS-SIND.
              05 I                                      PIC 9(03).
      *DAD ini  05-JUN-1992
           03 WSS-IND                                   PIC 9(02).
           03 WSS-IND-STAT                              PIC X(01).
           03 WSS-GLS-FONO.
              05 WSS-NUM-FONO         OCCURS 12         PIC X(01).
      *DAD fin  05-JUN-1992
      *DAD ini  13-MAY-1992
           03 WSS-CIC-TICL                              PIC X(02).
*% IF PGM_PU
           03 WSS-OFIC                                 PIC X(03).
*% END
           03 WSS-COD-OFIC                              PIC X(03).
           03 WSS-COD-EJEC                              PIC X(12).
*% END
*% IF PGM_BCI
      *<<<< PGM_BCI
           COPY USPC113.
      *>>>>
*% END
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% IF PGM_INI
      *<<<< PGM_INI
      *DAD ini  13-MAY-1992
      *     SE PREGUNTA POR CONSTANTES, PUES EN ESTE PUNTO NO ESTAN
      *     INICIALIZADAS VARIABLES FRM-FFLD
            MOVE DFHCOMMAREA(1:EIBCALEN) TO SCR-VARI.
       *DAD ini  05-JUN-1992
*% IF PGM_PER
      *AMP: BAJO COMANDO MDA Y IDA PERMITE SOLO TECLAS <ENTER> Y <PF11>
           IF SCR-CMND = WSS-CMND-DBE-MDA OR WSS-CMND-DBE-IDA
*% ELSE
      *ISP: BAJO COMANDO ICD Y CCL PERMITE SOLO TECLAS <ENTER> Y <PF11>
           IF SCR-CMND = WSS-CMND-DBE-ICD OR WSS-CMND-DBE-CCL
*% END
      *DAD fin  05-JUN-1992
               IF NOT ( EIBAID = '1' OR 'A' OR '#' OR '.' )
                   MOVE ' ' TO EIBAID.
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% IF INI_FIO AND PGM_VMS
      *<<<< INI_FIO AND PGM_VMS

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'GNS'        TO FIO-SIST.
           PERFORM GNS-FIO-CIC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM GNS-FIO-CIC.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM GNS-FIO-TAB.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM GNS-FIO-TAB.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-OFI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-OFI.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'TAB'        TO FIO-SIST.
           PERFORM TAB-FIO-USR.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM TAB-FIO-USR.
*% IF PGM_CHI OR PGM_ARG

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-RBS.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RBS.

*% END
           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-REC.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-REC.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-DCP.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-DCE.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.

           MOVE FIO-ACCS-UPD TO FIO-ACCS.
           MOVE FIO-ACC      TO FIO-CMND.
           MOVE 'SGC'        TO FIO-SIST.
           PERFORM SGC-FIO-RCD.
           MOVE FIO-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.

      *>>>>
*% END
*% IF INI_FIO AND PGM_DTC AND PGM_V31
      *<<<< INI_FIO AND PGM_DTC AND PGM_V31
*% IF PGM_PU
           IF SCR-OFRM-SRV
              MOVE EIBTRMID TO WSS-COD-TERM
           ELSE
              MOVE SCR-OTRN TO WSS-COD-TERM.
*% END
      *DAD ini  07-JUN-1991
           PERFORM GNS-HDL-VSM.
      *DAD fin  07-JUN-1991
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-DBE
                   GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'SGC'          TO MSG-COD-SIST
                       MOVE 'DBE    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC'          TO MSG-COD-SIST
                       MOVE 'DBE    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.
*% END
           IF DBC-NUM-ICLI IN DBE-FLD = ZEROES
               PERFORM BUS-CLI-EMP
               IF NOT FIO-STAT-OKS
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE DBC-KEY-IDBC IN DBC TO DCE-KEY-IDCE IN DCE
                   MOVE DBC-KEY-IDBC IN DBC TO RCD-KEY-IRCD IN RCD
                   MOVE 01                  TO RCD-NUM-DIRE IN RCD
                   GO TO CON-FND-KEY.

           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
           MOVE 'IDC' TO SCR-KEY-IDBC.
*% END
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
               IF NOT ( DBC-IND-TICL IN DBC = 'E' )
                   MOVE 'TAB'        TO MSG-COD-SIST
                   MOVE 'CLI    PER' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FIO-STAT-NEX TO FIO-STAT
               ELSE
                   MOVE DBC-KEY-IDBC IN DBC TO DCE-KEY-IDCE IN DCE
                   MOVE DBC-KEY-IDBC IN DBC TO RCD-KEY-IRCD IN RCD
                   MOVE 01                  TO RCD-NUM-DIRE IN RCD.
           IF NOT FIO-STAT-OKS
               GO TO CON-FND-KEY.

           MOVE DBC-KEY-IDBC IN DBC TO DCE-KEY-IDCE IN DCE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               GO TO NO-DCE-ENC.

      *VAL-COD Valida codigo de tabla
           MOVE 'SGC' TO TAB-COD-SIST.
           MOVE 'BAN ' TO TAB-COD-TTAB IN TAB.
           MOVE DCE-COD-TBAN IN DCE TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           IF NOT FIO-STAT-OKS
                MOVE 'SGC'        TO MSG-COD-SIST
                MOVE 'TBAN   NEX' TO MSG-COD-MENS
                PERFORM GET-MSG
                MOVE MSG-GLS-DESC TO FRM-MENS
                MOVE FIO-STAT-NEX TO FIO-STAT
                GO TO FIN-FND-KEY.

      *MNSFIF SCR-HDR-MRCA = 'BCS'  AND
      *MNSF   ( SCR-CMND     = 'MOD'  OR
      *MNSF     SCR-CMND     = 'ELI' ) AND
      *MNSF   TAB-CIC-CTAB IN TAB NOT = 'PBM'
      *MNSF       MOVE 'SGC' TO            MSG-COD-SIST
      *MNSF       MOVE MSG-COD-SIST TO WSS-MSG-COD-SIST
      *MNSF
      *MNSF       MOVE 'TBANNPPBMBCS'   TO MSG-COD-MENS
      *MNSF       MOVE MSG-COD-MENS TO WSS-MSG-COD-MENS
      *MNSF
      *MNSF       PERFORM GET-MSG
      *MNSF
      *MNSF       MOVE MSG-GLS-DESC TO WSS-MSG-GLS-DESC
      *MNSF       MOVE MSG-GLS-DATA TO WSS-MSG-GLS-DATA
      *MNSF       MOVE WSS-MENS     TO FRM-MENS
      *MNSF
      *MNSF       MOVE FIO-STAT-NEX TO FIO-STAT
      *MNSF       GO TO FIN-FND-KEY.

           IF SCR-OFRM-SRV AND
              SCR-CMND = 'CON'
                MOVE 'CON'  TO CMMA-RCD-COD-CMND
                MOVE DBC-NUM-ICLI IN DBE-FLD TO CMMA-RCD-NUM-ICLI
                MOVE DBC-IND-ICLI IN DBE-FLD TO CMMA-RCD-IND-ICLI
                MOVE DBC-GLS-ICLI IN DBE-FLD TO CMMA-RCD-GLS-ICLI
                MOVE TSK-TERM-ALF            TO CMMA-RCD-GLS-COLA-TERM
                MOVE SCR-LIDD                TO CMMA-RCD-LIDD
                MOVE SCR-QIDD                TO CMMA-RCD-QIDD

                MOVE 'SGCPPDIR'              TO SYS-PROG
                MOVE CMMA-RCD-TCMA           TO SYS-TCMA
                MOVE CMMA-RCD                TO SYS-CMMA
                MOVE SYS-LINK                TO SYS-CMND
                PERFORM GNS-PRO-SYS.

       NO-DCE-ENC.


           GO TO CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_KEY_CMND
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           GO TO CON-FND-KEY.
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
       CON-FND-KEY.
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
      *OJO
           MOVE DBC-KEY-IDBC IN DBC TO DCE-KEY-IDCE IN DCE.
           MOVE DBC-KEY-IDBC IN DBC TO RCD-KEY-IRCD IN RCD.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE 01 TO RCD-NUM-DIRE IN RCD.

           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE '00' TO PGM-STAT-DBC.
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
      *<<<< PGM_DTC
           MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
      *>>>>
*% END
      *    Se guarda en Common Area la fecha de la ultima modificacion
*% IF PGM_DOS OR PGM_MVS
      *<<<< PGM_DOS OR PGM_MVS
           MOVE DBC-STP-ITRN IN DBC TO SCR-UMOD.
      * INI JCT 24-JUN-2008 SGC:VALIDA CAMBIO BANCA CUENTAS ESPECIALES
           IF SCR-CMND     = 'MVA'
              PERFORM VAL-COD-EJEC
              IF MSG-COD-MENS > SPACES
                 GO TO FIN-FND-KEY.
      * FIN JCT 24-JUN-2008

      *>>>>
*% END
*% IF PGM_CHI
      *LRH ini 18-MAY-1994
           MOVE DBC-CIC-ICLI IN DBC TO DCC-CIC-ICLI IN DCC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCC.
           MOVE FIO-STAT TO PGM-STAT-DCC.
      *LRH fin 18-MAY-1994
*% END
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           MOVE FIO-STAT TO PGM-STAT-DCE.
           IF FIO-STAT-OKS
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-RCD
               MOVE FIO-STAT TO PGM-STAT-RCD
               IF FIO-STAT-OKS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE
                   'ERROR : Existe cliente en DBC, DCE pero no en RCD'
                                                           TO FRM-MENS
           ELSE
               MOVE 'ERROR : Existe cliente en DBC pero no en DCE'
                    TO FRM-MENS.
           MOVE '00'         TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *>>>>
*% END
*% IF INI_HBL_IKY
      *<<<< INI_HBL_IKY
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
      *>>>>
*% END
*% IF FIN_HBL_IKY
       *<<<< FIN_HBL_IKY
           MOVE '1' TO FRM-CPIM-AEY.
       *>>>>
*% END
*% IF FIN_HBL_KEY AND PGM_PQ
      *<<<< FIN_HBL_KEY
           MOVE '1' TO FRM-CPIM-AEY.
*% END
*% IF INI_HBL_KEY AND PGM_PQ
      *<<<< INI_HBL_KEY
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
      *>>>>
*% END
*% IF PUT_SCR AND PGM_CHI
      *LRH ini 24-OCT-1994
           MOVE DBC                 TO SCR-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO SCR-GLS-NOMC IN SCR-VARI.
           MOVE DBC-COD-EJEC IN DBC TO SCR-COD-EJEC IN SCR-VARI.
           MOVE DBC-COD-OFIC IN DBC TO SCR-COD-OFIC IN SCR-VARI.
      *RJZ 29-DEC-1994 15:18:36
           MOVE DBC-IND-TICL IN DBC TO SCR-IND-TICL IN WSS-VARI.
      *LRH fin 24-OCT-1994
*% END
*% IF FIN_HBL_FLD
*% IF PGM_BCI OR PGM_ARG
      *<<<< FIN_HBL_FLD
      *LRH ini 18-MAY-1994
*% IF PGM_PQ
          IF SCR-OFRM-SRV
              MOVE SPACES TO SCR-OFI-USP IN SCR-VARI
              GO TO CIC-HBL-FLD.
*% END
           COPY USPC143.
           MOVE USP-COD-OFICINA TO SCR-OFI-USP IN SCR-VARI.
       CIC-HBL-FLD.
      *LRH fin 18-MAY-1994
      *DAD ini  13-MAY-1992
           MOVE 'SGC'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'DBCDCOR  DBE' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
                    TAB-MSC-STAT IN TAB = 'S' )
               MOVE FRM-CPIM-AEY TO DBC-NUM-DCOR-ATR IN DBE-FLD
               MOVE ZEROES       TO DBC-NUM-DCOR     IN DBE-FLD
               MOVE 'N'          TO FRM-IND-VERS     IN DBE-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-DCOR IN DBE-FLD
               MOVE 'S'                 TO FRM-IND-VERS IN DBE-FLD
               IF  SCR-CCPP = 'ING' OR
                 ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-ING )
*% IF PGM_ARG
                   MOVE FRM-CPIM-AEY TO DBC-NUM-DCOR-ATR IN DBE-FLD
*% END
                   MOVE 01 TO DBC-NUM-DCOR IN DBE-FLD.
*% END
*% IF PGM_PER
           IF SCR-CMND = WSS-CMND-DBE-ICD
               PERFORM BUS-SCR-USER
               MOVE 'CA'                     TO DBC-COD-TICL IN DBE-FLD
               MOVE WSS-COD-OFIC IN WSS-VARI TO DBC-COD-OFIC IN DBE-FLD
               MOVE WSS-COD-EJEC IN WSS-VARI TO DBC-COD-EJEC IN DBE-FLD
               MOVE FRM-CPIM-AEY TO DBC-COD-TICL-ATR IN DBE-FLD.
*% ELSE
           IF SCR-CMND = WSS-CMND-DBE-ICD
               PERFORM SET-FRM-ICD.
*% END
      *DAD ini  05-JUN-1992
      *     IF SCR-CMND = WSS-CMND-DBE-CCL
      *DAD fin  05-JUN-1992
           IF SCR-CMND = WSS-CMND-DBE-ICD
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CMNDICDFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *DAD fin  13-MAY-1992

           IF SCR-CMND = WSS-CMND-DBE-MIC OR WSS-CMND-DBE-MNC OR
              WSS-CMND-DBE-INC OR DBC-IND-ICLI IN DBE-FLD = 'A'
               PERFORM PRO-KEY-DBE
               PERFORM PRO-FLD-DBE.

           IF SCR-CMND = WSS-CMND-DBE-MIC
               PERFORM UNP-IKY-DBE
               MOVE 0  TO DBC-GLS-NOMC-LEN IN DBE-FLD
*% IF PGM_ARG
               MOVE -1 TO DBC-GLS-ICLI-LEN IN DBE-FLD.
*% ELSE
               MOVE -1 TO DBC-NUM-ICLI-LEN IN DBE-FLD.
*% END

           IF SCR-CMND = WSS-CMND-DBE-MNC
               PERFORM UNP-MKY-DBE.

           IF SCR-CMND = WSS-CMND-DBE-INC OR
              DBC-IND-ICLI IN DBE-FLD = 'A'
               PERFORM UNP-MKY-DBE
               MOVE FRM-CPIM-UBY TO DBC-COD-OFIC-ATR IN DBE-FLD
               MOVE FRM-CPIM-UBY TO DBC-COD-TICL-ATR IN DBE-FLD
      *DAD ini  07-JUN-1991
               MOVE FRM-CPIM-UBY TO DCE-GLS-NFAN-ATR IN DBE-FLD
      *DAD fin  07-JUN-1991
               IF DBC-COD-TICL IN DBE-FLD NOT > SPACES
                   MOVE 'NC' TO DBC-COD-TICL IN DBE-FLD.
*% IF NOT PGM_PER
      *DAD ini  10-FEB-1993   (requerimiento DAP)
           IF SCR-CMND NOT = WSS-CMND-DBE-ICD
      *DAD fin  10-FEB-1993
*% END
           IF   SCR-CCPP = 'MOD' OR
              ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD )
               PERFORM PRO-MKY-DBE
               MOVE 0  TO DBC-GLS-NOMC-LEN IN DBE-FLD
               MOVE -1 TO DCE-GLS-NFAN-LEN IN DBE-FLD.

*% IF PGM_CHI OR PGM_ARG
      *DAD ini  05-JUN-1992
           IF SCR-CMND = WSS-CMND-DBE-MNJ
               PERFORM PRO-KEY-DBE
               PERFORM PRO-FLD-DBE
               MOVE FRM-CPIM-UBY TO DCE-COD-TSOC-ATR IN DBE-FLD
               MOVE 0            TO DCE-GLS-NFAN-LEN IN DBE-FLD
               MOVE -1           TO DCE-COD-TSOC-LEN IN DBE-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO DCE-COD-TSOC-ATR IN DBE-FLD.
*% END

           IF SCR-CMND = WSS-CMND-DBE-CCL
               MOVE 'CL'         TO DBC-COD-TICL     IN DBE-FLD
               MOVE FRM-CPIM-AEY TO DBC-COD-TICL-ATR IN DBE-FLD.
      *DAD fin  05-JUN-1992
*% IF PGM_ARG
      *RDA INI 10-02-94
           IF  SCR-CCPP = 'ING' OR
               (SCR-CMND = 'ACT' AND SCR-ACTU = SCR-ACTU-ING )
               MOVE FRM-CPIM-UBY TO DCE-COD-TSOC-ATR IN DBE-FLD
               MOVE FRM-CPIM-AEY TO DBC-NUM-DCOR-ATR IN DBE-FLD.
      *RDA FIN 10-02-94
*% END

*% IF PGM_BCI
      *LRH ini 20-ABR-1994
           IF DCE-COD-TBAN IN DBE-FLD > SPACES AND
              SCR-CMND NOT = WSS-CMND-DBE-MVA
               MOVE FRM-CPIM-AEY TO DCE-COD-TBAN-ATR IN DBE-FLD.
      *LRH ini 18-MAY-1994
           IF DCC-COD-RCHZ IN DBE-FLD > SPACES AND
              SCR-CMND NOT = WSS-CMND-DBE-MVA
               MOVE FRM-CPIM-AEY TO DCC-COD-RCHZ-ATR IN DBE-FLD.
      *LRH fin 18-MAY-1994
      *LRH ini 17-NOV-1994
           IF DBC-COD-EJEC IN DBE-FLD > SPACES AND
              SCR-CMND NOT = WSS-CMND-DBE-MVA
               MOVE FRM-CPIM-AEY TO DBC-COD-EJEC-ATR IN DBE-FLD.
           IF DBC-COD-OFIC IN DBE-FLD > SPACES AND
              SCR-CMND NOT = WSS-CMND-DBE-MVA
               MOVE FRM-CPIM-AEY TO DBC-COD-OFIC-ATR IN DBE-FLD.
      *LRH fin 17-NOV-1994
           IF SCR-CMND = WSS-CMND-DBE-MVA
               PERFORM PRO-KEY-DBE
               PERFORM PRO-FLD-DBE
               MOVE FRM-CPIM-UBY TO DCE-COD-TBAN-ATR IN DBE-FLD
      *LRH ini 18-MAY-1994
               MOVE FRM-CPIM-UBY TO DCC-COD-RCHZ-ATR IN DBE-FLD
      *LRH fin 18-MAY-1994
      *LRH ini 17-NOV-1994
               MOVE FRM-CPIM-UBY TO DBC-COD-EJEC-ATR IN DBE-FLD
               MOVE FRM-CPIM-UBY TO DBC-COD-OFIC-ATR IN DBE-FLD
      *LRH fin 17-NOV-1994
               MOVE 0            TO DBC-GLS-NOMC-LEN IN DBE-FLD
               MOVE -1           TO DCC-COD-RCHZ-LEN IN DBE-FLD.
      *LRH fin 20-ABR-1994
*% END
      *>>>>
*% END
*% IF CMN_MOD_RET
*% IF PGM_BCI OR PGM_ARG
      *<<<< CMN_MOD_RET
      *DAD ini  13-MAY-1992
           IF FRM-IND-VERS IN DBE-FLD = 'N'
               MOVE DBC-NUM-DCOR IN DBC TO DBC-NUM-DCOR IN DBE-FLD.
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
*% IF PGM_DOS OR PGM_MVS
      *<<<< PGM_DOS OR PGM_MVS
      *    Compara codigo ult. modificacion con el que tiene en la COMMON AREA
           IF DBC-STP-ITRN IN DBC NOT = SCR-UMOD
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'UPD    SIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *>>>>
*% END
      *    PERFORM KEY-DCE-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
      *RJZ INI  4-JAN-1995 11:06:48
           IF SCR-CMND='MNJ'
              MOVE DCE-COD-TSOC IN DCE TO SCR-COD-TSOC IN WSS-VARI
              MOVE DCE    TO   SCR-DCE.
      *RJZ FIN   4-JAN-1995 11:06:59

           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC
      *        Comunicar que no se pudo actualizar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           PERFORM RET-DCE-DBE.
      *    PERFORM KEY-RCD-DBE.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE 01 TO RCD-NUM-DIRE IN RCD.

           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC y DCE
      *        Comunicar que no se pudo actualizar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           PERFORM RET-RCD-DBE.
           PERFORM RET-HDR-DBC.
*% IF PGM_BCI
      *LRH ini 24-OCT-1994
           PERFORM VERIFICA-CAMBIOS.
           IF FRM-MENS > SPACES
               GO TO FIN-CMN-MOD.
      *LRH fin 24-OCT-1994
*% END
      *>>>>
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           MOVE DBC-STP-ITRN IN DBC TO DCE-STP-ITRN IN DCE.
           PERFORM RET-HDR-DCE.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.

           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *RJZ INI 17-JAN-1995 19:30:11
           IF SCR-CMND='MNJ'
              PERFORM GRABA-LOGDCE.
      *RJZ FIN 17-JAN-1995 19:30:18

           MOVE DBC-STP-ITRN IN DBC TO RCD-STP-ITRN IN RCD.
           PERFORM RET-HDR-RCD.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
*% IF PGM_CHI
      *LRH ini 18-MAY-1994
           MOVE DBC-CAI-ICLI IN DBE-FLD TO DCC-CAI-ICLI IN DCC.
           MOVE DBC-IIC-ICLI IN DBE-FLD TO DCC-IIC-ICLI IN DCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCC.
           IF FIO-STAT-OKS
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               MOVE FIO-PUT TO FIO-CMND.
           PERFORM RET-DCC-DBE.
           PERFORM RET-HDR-DCC.
      *LRH ini 10-OCT-1994
           PERFORM LIMPIA-CAMPOS-DCC.
      *LRH fin 10-OCT-1994
           PERFORM SGC-FIO-DCC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
           IF SCR-OFRM-SRV
              PERFORM ELI-DIR-PTC.
      *LRH fin 18-MAY-1994
*% END
*% END
*% IF INI_PRO_CONF
      *<<<< INI_PRO_CONF
      *DAD ini  13-MAY-1992
      *DAD ini  05-JUN-1992
      *     IF SCR-CMND = WSS-CMND-DBE-CCL
      *DAD fin  05-JUN-1992
           IF SCR-CMND = WSS-CMND-DBE-ICD
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CMNDICDCNF' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *DAD fin  13-MAY-1992
      *>>>>
*% END
*% IF INI_CMN_ING
      *<<<< INI_CMN_ING
           MOVE DBC-NUM-ICLI IN DBE-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN DBE-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN DBE-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'DBCIDCYAEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ING.
           MOVE SPACES TO DBC.
           MOVE ZEROES TO DBC-STP-ITRN IN DBC.
           MOVE ZEROES TO DBC-NUM-DCOR IN DBC.
*% IF PGM_CHI OR PGM_ARG
           MOVE ZEROES TO DBC-FEC-FA85 IN DBC.
      *ALD-BCI-INI
      *    MOVE ZEROES TO DBC-FEC-FUPI IN DBC.
           MOVE SPACES TO DBC-COD-SETO IN DBC.
           MOVE SPACES TO DBC-PDO-SETO IN DBC.
      *ALD-BCI-FIN
*% END
*% IF PGM_CHI
      *LRH ini 21-NOV-1994
           IF SCR-CMND = 'ING' OR 'ACT'
               PERFORM GET-FHOY
               MOVE HOY-FHOY TO DBC-FEC-FSCL IN DBC.
      *LRH fin 21-NOV-1994
*% ELSE
           MOVE ZEROES TO DBC-FEC-FSCL IN DBC.
*% END
           MOVE ZEROES TO DBC-NUM-TDIR IN DBC.
           MOVE ZEROES TO DBC-NUM-TCMT IN DBC.
*% IF PGM_CHI
      *LRH ini 21-NOV-1994
           IF SCR-CMND = 'ING' OR 'ACT'
               PERFORM GET-FHOY
               MOVE HOY-FHOY TO DBC-FEC-FIOP IN DBC.
      *LRH fin 21-NOV-1994
           MOVE ZEROES TO DBC-FEC-FTOP IN DBC.
*% END
*% IF PGM_ARG
           MOVE ZEROES TO DBC-FEC-FIOP IN DBC.
           MOVE ZEROES TO DBC-FEC-FTOP IN DBC.
*% END
           MOVE ZEROES TO DBC-NUM-OFTN IN DBC.
           MOVE ZEROES TO DBC-FEC-FINP IN DBC.
           MOVE SPACES TO RCD.
           MOVE ZEROES TO RCD-NUM-DIRE IN RCD.
           MOVE ZEROES TO RCD-STP-ITRN IN RCD.
           MOVE ZEROES TO RCD-FEC-FVRF IN RCD.
           MOVE SPACES TO DCE.
           MOVE ZEROES TO DCE-STP-ITRN IN DCE.
           MOVE ZEROES TO DCE-FEC-FCTT IN DCE.
           MOVE ZEROES TO DCE-FEC-FUME IN DCE.
           MOVE ZEROES TO DCE-FEC-FCAD IN DCE.
      *>>>>
*% END
*% IF CMN_ING
      *<<<< CMN_ING
           PERFORM RET-HDR-DBC.
           MOVE 1                    TO DBC-NUM-TDIR IN DBC.
           MOVE 'D'                  TO RCD-MSC-TDIR IN RCD.
           MOVE 'C'                  TO RCD-MSC-SDIR IN RCD.
           MOVE 'E'                  TO DBC-IND-TICL IN DBC.
           MOVE ZEROES               TO DBC-NUM-TCMT IN DBC.
      *GET-CIC Obtener CIC
*% IF NOT PGM_PER
           MOVE SPACES TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE CIC-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
*% ELSE
           IF SCR-IIC-ICLI NOT > ZEROES
               MOVE SPACES TO CIC-CAI-ICIC IN CIC
               MOVE CIC-GET TO CIC-CMND
               PERFORM PRO-CIC
               IF CIC-STAT NOT = CIC-STAT-OKS
                   MOVE CIC-MENS TO FRM-MENS
                   GO TO FIN-CMN-ING
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE SCR-CIC-ICLI TO CIC-CIC-ICIC.
*% END
           MOVE CIC-CIC-ICIC TO DBC-CIC-ICLI IN DBC.
      *ALD
      *    MOVE DBC-IDC-ICLI IN DBC TO DBC-CIC-ICLI IN DBC.
      *>>>>
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

      *    PERFORM KEY-DCE-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE DBC-STP-ITRN IN DBC TO DCE-STP-ITRN IN DCE.
           PERFORM RET-HDR-DCE.
*% IF PGM_ARG
           MOVE DCE-COD-TSOC IN DBE-FLD TO DCE-COD-TSOC IN DCE.

*% END
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *    PERFORM KEY-RCD-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE 01                  TO RCD-NUM-DIRE IN RCD.
           MOVE DBC-STP-ITRN IN DBC TO RCD-STP-ITRN IN RCD.
           PERFORM RET-HDR-RCD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
*% IF PGM_CHI OR PGM_ARG
      *ALD/21-JUL-1988
           MOVE DBC-NUM-ICLI IN DBC TO RBS-NUM-RUTS IN RBS.
           MOVE DBC-VRF-ICLI IN DBC TO RBS-VRF-RUTS IN RBS.
           MOVE 'RBS-GLS-ICLS'  TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           IF NOT FIO-STAT-OKS
               MOVE '00' TO FIO-STAT
      *DAD ini  13-MAY-1992
               GO TO EXT-CMN-ING.
      *DAD fin  13-MAY-1992

      * ISP:  2-FEB-1993 FIO-GET-KEY ( LLAVE ALT ) +
      *                  FIO-GET-KEY-UPD ( LLAVE PRINCIPAL )
      *       PARA COMPATIBILDAD VSAM
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           MOVE DBC-STP-ITRN IN DBC TO RBS-STP-ITRN IN RBS.
           MOVE DBC-CIC-ICLI IN DBC TO RBS-CIC-ICLI IN RBS.
           PERFORM RET-HDR-RBS.
           MOVE FIO-MOD        TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           IF NOT FIO-STAT-OKS
               MOVE '00' TO FIO-STAT
      *DAD ini  13-MAY-1992
               GO TO EXT-CMN-ING.
      *DAD fin  13-MAY-1992
*% END
      *DAD ini  13-MAY-1992
      *PTC-INI:   20-NOV-2002 14:43:53
           IF SCR-OFRM-SRV
                MOVE PTC-DBC-TYPE TO QUE-TYPE
                MOVE TSK-TERM-ALF TO QUE-TERM
                MOVE PTC-DBC-LENG TO QUE-LITM
                MOVE QUE-PUT      TO QUE-CMND
                MOVE DBC-NUM-ICLI IN DBC TO PTC-DBC-DBC-NUM-ICLI
                MOVE DBC-VRF-ICLI IN DBC TO PTC-DBC-DBC-VRF-ICLI
                MOVE DBC-IND-ICLI IN DBC TO PTC-DBC-DBC-IND-ICLI
                MOVE DBC-GLS-ICLI IN DBC TO PTC-DBC-DBC-GLS-ICLI
                MOVE PTC-DBC-ITEM TO QUE-ITEM
                PERFORM GNS-PRO-QUE.
      *PTC-FIN:    20-NOV-2002 14:44:01
       EXT-CMN-ING.
      *DAD ini  05-JUN-1992
      *     IF SCR-CMND = WSS-CMND-DBE-CCL
      *DAD fin  05-JUN-1992
           IF SCR-CMND = WSS-CMND-DBE-ICD
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CMNDICDING' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *DAD fin  13-MAY-1992
      *
*% IF PGM_CHI
      *LRH ini 18-MAY-1994
           MOVE DBC-CIC-ICLI IN DBC TO DCC-CIC-ICLI IN DCC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM RET-DCC-DBE.
           PERFORM RET-HDR-DCC.
      *LRH ini 10-OCT-1994
           PERFORM LIMPIA-CAMPOS-DCC.
           IF SCR-HDR-MRCA = 'BCS'
               MOVE 'S' TO DCC-IND-MBCS IN DCC.
      *LRH fin 10-OCT-1994
           PERFORM SGC-FIO-DCC.
           IF NOT FIO-STAT-OKS
               MOVE '00' TO FIO-STAT
               GO TO EXT-CMN-ING.
      *LRH fin 18-MAY-1994

*% END
*% IF PGM_PU
           IF SCR-OFRM-SRV
              PERFORM ELI-DIR-PTC.
*% END
      *>>>>
*% END
*% IF CMN_ELI
      *<<<< CMN_ELI
*% IF PGM_DOS OR PGM_MVS
      *<<<< PGM_DOS OR PGM_MVS
      *    Compara codigo ult. modificacion con el que tiene en la COMMON AREA
           IF DBC-STP-ITRN IN DBC NOT = SCR-UMOD
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'UPD    SIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
      *>>>>
*% END
      *    PERFORM KEY-DCE-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC
      *        Comunicar que no se pudo eliminar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

      *    PERFORM KEY-RCD-DBE.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE 01 TO RCD-NUM-DIRE IN RCD.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC y DCE
      *        Comunicar que no se pudo eliminar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF FIN_CMN_ELI
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
      *>>>>
*% END
*% IF INI_CMN_ACC
      *<<<< INI_CMN_ACC
*% IF PGM_BCI
      *LRH ini 20-ABR-1994
           IF SCR-CMND = WSS-CMND-DBE-MVA
               MOVE DBC-CAI-ICLI IN DBE-FLD TO DCE-CAI-ICLI IN DCE
               MOVE DBC-IIC-ICLI IN DBE-FLD TO DCE-IIC-ICLI IN DCE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-DCE
               PERFORM RET-DCE-DBE
               PERFORM RET-HDR-DCE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-DCE
      *LRH ini 18-MAY-1994
               MOVE DBC-CAI-ICLI IN DBE-FLD TO DCC-CAI-ICLI IN DCC
               MOVE DBC-IIC-ICLI IN DBE-FLD TO DCC-IIC-ICLI IN DCC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-DCC
               IF FIO-STAT-OKS
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM RET-DCC-DBE
                   PERFORM RET-HDR-DCC
      *LRH ini 10-OCT-1994
                   PERFORM LIMPIA-CAMPOS-DCC
      *LRH fin 10-OCT-1994
                   PERFORM SGC-FIO-DCC
      *LRH ini 17-NOV-1994
      *             GO TO FIN-CMN-ACC
      *LRH fin 17-NOV-1994
               ELSE
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM RET-DCC-DBE
                   PERFORM RET-HDR-DCC
      *LRH ini 10-OCT-1994
                   PERFORM LIMPIA-CAMPOS-DCC
      *LRH fin 10-OCT-1994
                   PERFORM SGC-FIO-DCC
      *LRH ini 17-NOV-1994
      *             GO TO FIN-CMN-ACC
      *LRH fin 17-NOV-1994
      *LRH fin 18-MAY-1994
           ELSE
      *LRH fin 20-ABR-1994
*% END
           IF SCR-CMND = WSS-CMND-DBE-MIC
               PERFORM KEY-DBC-DBE
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'DBCIDCYAEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   NEXT SENTENCE
           ELSE
               IF SCR-CMND = WSS-CMND-DBE-EAP
                   PERFORM CMB-EMP-PRS
      *RJZ 29-DEC-1994 14:54:04
                   PERFORM GRABA-LOG
                   GO TO FIN-CMN-ACC.
      *>>>>
*% END
*% IF CMN_ACC
      *<<<< CMN_ACC
           PERFORM RET-HDR-DBC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE 'MODYES    ' TO MSG-COD-MENS
           ELSE
               MOVE 'MODNOT    ' TO MSG-COD-MENS.
           MOVE 'GNS' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
*% IF PGM_BCI
      *LRH ini 24-OCT-1994
           PERFORM VERIFICA-CAMBIOS.
           IF FRM-MENS > SPACES
               GO TO FIN-CMN-ACC.
      *LRH fin 24-OCT-1994
*% END
*% IF PGM_CHI OR PGM_ARG
      *DAD ini  29-SEP-1993
           IF SCR-CMND = WSS-CMND-DBE-MIC
               MOVE DBC-CIC-ICLI IN DBC TO RBS-CIC-ICLI IN RBS
               MOVE 'RBS-CIC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-RBS
               IF NOT FIO-STAT-OKS
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE DBC-STP-ITRN IN DBC TO RBS-STP-ITRN IN RBS
                   MOVE DBC-NUM-ICLI IN DBC TO RBS-NUM-RUTS IN RBS
                   MOVE DBC-VRF-ICLI IN DBC TO RBS-VRF-RUTS IN RBS
                   PERFORM RET-HDR-RBS
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM SGC-FIO-RBS
                   IF NOT FIO-STAT-OKS
                       MOVE '00' TO FIO-STAT.
      *DAD fin  29-SEP-1993
*% END
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
*% END
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
      *JSS
           IF SCR-FFLD-PF8 OR SCR-FFLD-PF7
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                       PERFORM SCR-TRL
               ELSE
                       PERFORM DESSCRTRL
                       GO TO FIN-SCR-ACC.
      *JSS
*% END
      *>>>>
*% END
*% IF PFS_SCR_ACT
      *<<<< PFS_SCR_ACT
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
      *JSS
           IF SCR-FFLD-PF8 OR SCR-FFLD-PF7
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                       PERFORM SCR-TRL
               ELSE
                       PERFORM DESSCRTRL
                       GO TO FIN-SCR-ACT.
      *JSS
*% END
      *>>>>
*% END
*% IF PFS_SCR_MOD
      *<<<< PFS_SCR_MOD
*% IF PGM_PU
       CONT-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
*% END
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC AND PGM_PQ
      *JSS
           IF SCR-FFLD-PF8 OR SCR-FFLD-PF7
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                       PERFORM SCR-TRL
               ELSE
                       PERFORM DESSCRTRL
                       GO TO FIN-SCR-MOD.
      *JSS
*% END
      *>>>>
*% END
*% IF PFS_SCR_ELI
      *<<<< PFS_SCR_ELI
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
      *JSS
           IF SCR-FFLD-PF8 OR SCR-FFLD-PF7
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                       PERFORM SCR-TRL
               ELSE
                       PERFORM DESSCRTRL
                       GO TO FIN-SCR-ELI.
      *JSS
*% END
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
*% IF PGM_ARG
       COLAR-ENTIDAD SECTION.
       INI-COLAR-ENTIDAD.
           IF DBC-IND-TICL IN DBC NOT = 'E'
              MOVE 'S' TO WSS-PFS-COLAR
           ELSE
              MOVE 'N' TO WSS-PFS-COLAR.
       FIN-COLAR-ENTIDAD.
           EXIT.
      * INIT-VARI SECTION.
      * INI-INIT-VARI.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM SGC-FIO-DBC.
      * FIN-INIT-VARI.
      *     EXIT.
*% END
       PRO-FLD-DBE SECTION.
       INI-PRO-FLD-DBE.
           PERFORM PRO-DBC-DBE.
           PERFORM PRO-DCE-DBE.
           PERFORM PRO-RCD-DBE.
       FIN-PRO-FLD-DBE.
           EXIT.
       PRO-DBC-DBE SECTION.
       INI-PRO-DBC-DBE.
*% IF PGM_PER
           MOVE FRM-CPIM-AEY TO DBC-IND-RESI-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-NUM-RMER-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-MEMP-ATR IN DBE-FLD.
*% END
           MOVE FRM-CPIM-AEY TO DBC-NUM-DCOR-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-COD-TICL-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-COD-EJEC-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-COD-OFIC-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-OOFI-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-COD-ODSE-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-COD-ACTI-ATR IN DBE-FLD.
*% IF PGM_ARG
      *ini rda-cst 08-11-93
           MOVE FRM-CPIM-AEY TO DBC-COD-CATE-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-AINF-ATR IN DBE-FLD.
      *fin rda-cst 08-11-93
      *ini rda-cst 14-02-94
           MOVE FRM-CPIM-AEY TO DBC-MSC-SCLI-ATR IN DBE-FLD.
      *fin rda-cst 14-02-94
*% END
       FIN-PRO-DBC-DBE.
           EXIT.
       PRO-DCE-DBE SECTION.
       INI-PRO-DCE-DBE.
           MOVE FRM-CPIM-AEY TO DCE-GLS-NFAN-ATR IN DBE-FLD.
*% IF PGM_CHI OR PGM_ARG
           MOVE FRM-CPIM-AEY TO DCE-COD-TBAN-ATR IN DBE-FLD.
*% END
*% IF PGM_PER
           MOVE FRM-CPIM-AEY TO DCE-FEC-FCTT-ATR IN DBE-FLD.
*% END
           MOVE FRM-CPIM-AEY TO DCE-COD-TSOC-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DCE-IND-CATE-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DCE-IND-CMOS-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO DCE-IND-TEMP-ATR IN DBE-FLD.
*% IF PGM_CHI
      *DAD ini  18-FEB-1994
           MOVE FRM-CPIM-AEY TO DCE-COD-TPLN-ATR IN DBE-FLD.
      *DAD fin  18-FEB-1994
*% END
       FIN-PRO-DCE-DBE.
           EXIT.
       PRO-RCD-DBE SECTION.
       INI-PRO-RCD-DBE.
           MOVE FRM-CPIM-AEY TO RCD-GLS-DIRE-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO RCD-COD-LUGA-ATR IN DBE-FLD.
           MOVE FRM-CPIM-AEY TO RCD-GLS-FONO-ATR IN DBE-FLD.
       FIN-PRO-RCD-DBE.
           EXIT.
      * INI JCT 24-JUN-2008 SGC:VALIDA CAMBIO BANCA CUENTAS ESPECIALES
       VAL-COD-EJEC SECTION.
       INI-VAL-COD-EJEC.
           MOVE 'EJC '        TO USR-COD-TTAB IN USR.
           MOVE DBC-COD-EJEC IN DBC     TO USR-COD-USER IN USR.
           PERFORM VAL-TDU.
           IF MSG-COD-MENS > SPACES
              MOVE MSG-GLS-DESC TO FRM-MENS
              MOVE FRM-SUAR-MAL TO FRM-SUAR
      * INI JCT 01-10-2009 SGC:NRO.BEE 2849 ---------------
              MOVE SPACES       TO MSG-GLS-DESC
                                   FRM-SUAR-MAL
                                   MSG-COD-MENS
                                   FRM-MENS
                                   FRM-SUAR
      * INI JCT 01-10-2009
              GO TO FIN-VAL-COD-EJEC.
           IF USR-COD-OFUS IN USR = '248'
              MOVE 'SGC'     TO TAB-COD-SIST
              MOVE 'UCE'     TO TAB-COD-TTAB IN TAB
              MOVE SCR-USER  TO TAB-COD-CTAB IN TAB
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM BUS-TAB
              IF NOT (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = 'S' AND
                      MSG-COD-MENS = SPACES)
                 MOVE 'SGC'        TO MSG-COD-SIST
                 MOVE 'USRCCEEINV' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
                 MOVE FIO-STAT-NEX TO FIO-STAT
                 GO TO FIN-VAL-COD-EJEC.
       FIN-VAL-COD-EJEC.
           EXIT.
      * FIN JCT 24-JUN-2008
      *>>>>
*% END
*% IF EOF_PU OR (EOF AND PGM_VMS)
      *<<<< EOF_PU OR (EOF AND PGM_VMS)
       RET-HDR-DCE SECTION.
       INI-RET-HDR-DCE.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DCE-FEC-FTRN IN DCE.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DCE-HRA-HRTR IN DCE.
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO DCE-COD-OTRN IN DCE
           ELSE
           MOVE SCR-OTRN TO DCE-COD-OTRN IN DCE.
      *    Autor Transaccion
           MOVE SCR-USER TO DCE-COD-ATRN IN DCE.
      *>>>>
*% END
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DCE-MSC-TACC IN DCE
               MOVE 'I' TO DCE-MSC-STAT IN DCE
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DCE-MSC-TACC IN DCE
               MOVE 'M' TO DCE-MSC-STAT IN DCE.
       FIN-RET-HDR-DCE.
           EXIT.
*% IF PGM_CHI
      *LRH ini 18-MAY-1994
       RET-HDR-DCC SECTION.
       INI-RET-HDR-DCC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DCC-FEC-FTRN IN DCC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DCC-HRA-HRTR IN DCC.
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO DCC-COD-OTRN IN DCC
           ELSE
           MOVE SCR-OTRN TO DCC-COD-OTRN IN DCC.
      *    Autor Transaccion
           MOVE SCR-USER TO DCC-COD-ATRN IN DCC.
      *>>>>
*% END
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DCC-MSC-TACC IN DCC
               MOVE 'I' TO DCC-MSC-STAT IN DCC
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DCC-MSC-TACC IN DCC
               MOVE 'M' TO DCC-MSC-STAT IN DCC.
       FIN-RET-HDR-DCC.
           EXIT.
      *LRH fin 18-MAY-1994
*% END
       RET-HDR-RCD SECTION.
       INI-RET-HDR-RCD.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RCD-FEC-FTRN IN RCD.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RCD-HRA-HRTR IN RCD.
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO RCD-COD-OTRN IN RCD
           ELSE
           MOVE SCR-OTRN TO RCD-COD-OTRN IN RCD.
      *    Autor Transaccion
           MOVE SCR-USER TO RCD-COD-ATRN IN RCD.
      *>>>>
*% END
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO RCD-MSC-TACC IN RCD
               MOVE 'I' TO RCD-MSC-STAT IN RCD
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO RCD-MSC-TACC IN RCD
               MOVE 'M' TO RCD-MSC-STAT IN RCD.
       FIN-RET-HDR-RCD.
           EXIT.
       RET-HDR-DCP SECTION.
       INI-RET-HDR-DCP.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DCP-FEC-FTRN IN DCP.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DCP-HRA-HRTR IN DCP.
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO DCP-COD-OTRN IN DCP
           ELSE
           MOVE SCR-OTRN TO DCP-COD-OTRN IN DCP.
      *    Autor Transaccion
           MOVE SCR-USER TO DCP-COD-ATRN IN DCP.
      *>>>>
*% END
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DCP-MSC-TACC IN DCP
               MOVE 'I' TO DCP-MSC-STAT IN DCP
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DCP-MSC-TACC IN DCP
               MOVE 'M' TO DCP-MSC-STAT IN DCP.
       FIN-RET-HDR-DCP.
           EXIT.
*% IF PGM_CHI OR PGM_ARG
       RET-HDR-RBS SECTION.
       INI-RET-HDR-RBS.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RBS-FEC-FTRN IN RBS.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RBS-HRA-HRTR IN RBS.
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO RBS-COD-OTRN IN RBS
           ELSE
           MOVE SCR-OTRN TO RBS-COD-OTRN IN RBS.
      *    Autor Transaccion
           MOVE SCR-USER TO RBS-COD-ATRN IN RBS.
      *>>>>
*% END
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO RBS-MSC-TACC IN RBS
               MOVE 'I' TO RBS-MSC-STAT IN RBS
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO RBS-MSC-TACC IN RBS
               MOVE 'M' TO RBS-MSC-STAT IN RBS.
       FIN-RET-HDR-RBS.
           EXIT.

*% END
       RET-HDR-DBC SECTION.
       INI-RET-HDR-DBC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DBC-FEC-FTRN IN DBC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DBC-HRA-HRTR IN DBC.
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO DBC-COD-OTRN IN DBC
           ELSE
           MOVE SCR-OTRN TO DBC-COD-OTRN IN DBC.
      *    Autor Transaccion
           MOVE SCR-USER TO DBC-COD-ATRN IN DBC.
      *>>>>
*% END
*% IF PGM_PER
           IF SCR-CMND = WSS-CMND-DBE-VRF
               MOVE 'M' TO DBC-MSC-TACC IN DBC
               MOVE 'V' TO DBC-MSC-STAT IN DBC
           ELSE
*% END
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DBC-MSC-TACC IN DBC
               MOVE 'I' TO DBC-MSC-STAT IN DBC
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DBC-MSC-TACC IN DBC
               MOVE 'M' TO DBC-MSC-STAT IN DBC.
       FIN-RET-HDR-DBC.
           EXIT.
*% IF NOT PGM_VMS
      *<<<< NOT PGM_VMS
       VAL-IKY-DBE SECTION.
       INI-VAL-IKY-DBE.
           PERFORM VAL-DBC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-CAI-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IIC-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IND-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-NUM-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-VRF-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.
       FIN-VAL-IKY-DBE.
           EXIT.
       VAL-DBC-CAI-ICLI SECTION.
       INI-VAL-DBC-CAI-ICLI.
       FIN-VAL-DBC-CAI-ICLI.
           EXIT.
       VAL-DBC-IIC-ICLI SECTION.
       INI-VAL-DBC-IIC-ICLI.
       FIN-VAL-DBC-IIC-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN DBE-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN DBE-FLD.
*%! ESTO ES UNA INCOMPATIBILIDAD A NIVEL DE GENESIS, PUES OBLIGA AL PROGRAMADOR
*%! A ESCRIBIR CODIGO GENERICO DEPENDIENDO DEL PAIS
*% IF NOT PGM_ARG
*% IF PGM_PER
      *<<<< PGM_PER
           IF SCR-CMND = WSS-CMND-DBE-MIC
               MOVE IDC-BLCO-N TO IDC-BLCO.
           MOVE IDC-TCLI-EMP TO IDC-TCLI.
      *>>>>
*% END
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN DBE-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN DBE-FLD.
*% END
       FIN-VAL-DBC-IND-ICLI.
           EXIT.
       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
*%! ESTO ES UNA INCOMPATIBILIDAD A NIVEL DE GENESIS, PUES OBLIGA AL PROGRAMADOR
*%! A ESCRIBIR CODIGO GENERICO DEPENDIENDO DEL PAIS
*% IF PGM_ARG
           IF DBC-GLS-ICLI IN DBE-FLD NOT > ZEROES
              MOVE ZEROES TO DBC-GLS-ICLI IN DBE-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-GLS-ICLI IN DBE-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-GLS-ICLI IN DBE-FLD.
*% ELSE
           IF DBC-GLS-ICLI IN DBE-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-ICLI IN DBE-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN DBE-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN DBE-FLD.
*% END
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.
       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.
       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN DBE-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN DBE-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN DBE-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN DBE-FLD TO IDC-VRF-RUTV.
*% IF PGM_PER
           PERFORM VAL-RUT.
           MOVE IDC-NUM-RUTV TO DBC-NUM-ICLI IN DBE-FLD.
           MOVE IDC-VRF-RUTV TO DBC-VRF-ICLI IN DBE-FLD.
*% ELSE
      *<<<< INI_DBC_VRF_ICLI
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' OR
                                           'PV' OR 'CA' ) AND
              DBC-VRF-ICLI IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DBC-VRF-ICLI.
      *DAD fin  13-MAY-1992
      *>>>>
           PERFORM VAL-RUT.
*% END
      *<<<< DBC_VRF_ICLI
           IF SCR-CMND = WSS-CMND-DBE-MIC AND SCR-INST = SCR-INST-GFL
               PERFORM KEY-DBC-DBE
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'DBCIDCYAEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
      *>>>>
*% END
       CMB-EMP-PRS SECTION.
       INI-CMB-EMP-PRS.
           PERFORM KEY-DBC-DBE.
      * ISP : LEE POR RUT Y ACTUALIZA POR CIC ==> ERROR VSAM
      *       EL CIC ESTA EN LA PANTALLA
      *     MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'    TO MSG-COD-SIST
               MOVE 'REGNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMB-EMP-PRS.
*% IF PGM_DOS OR PGM_MVS
      *<<<< PGM_DOS OR PGM_MVS
           IF DBC-STP-ITRN IN DBC NOT = SCR-UMOD
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'UPD    SIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMB-EMP-PRS.
      *>>>>
*% END
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMB-EMP-PRS.
           PERFORM LLN-REG-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE DBC-STP-ITRN IN DBC TO DCP-STP-ITRN IN DCP.
           PERFORM RET-HDR-DCP.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-EMP-PRS.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-EMP-PRS.
      *>>>>
      *ADA-INI JSS 26-FEB-2001
       EFE-CMB-EMP-PRS.
           MOVE DBC-CIC-ICLI IN DBC TO EFE-CIC-ICLI IN EFE.
           MOVE SPACES              TO EFE-FEC-FEFE IN EFE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF NOT (FIO-STAT-OKS AND
              EFE-CIC-ICLI IN EFE = DBC-CIC-ICLI IN DBC)
               GO TO CON-CMB-EMP-PRS.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'EFENOGKUPD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-EMP-PRS.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'      TO MSG-COD-SIST
               MOVE 'EFENODEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-EMP-PRS.
           GO TO EFE-CMB-EMP-PRS.
       CON-CMB-EMP-PRS.
      *ADA-FIN JSS 26-FEB-2001
           PERFORM RET-HDR-DBC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'           TO MSG-COD-SIST
               MOVE 'UPD    ERRDBC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-CMB-EMP-PRS.
           EXIT.
       ELI-DIR-PTC SECTION.
       INICIO-ELI-DIR-PTC.
      *RRM-INI 22-NOV-2002
           MOVE NAD-TNAD-COLA TO QUE-COLA.
           MOVE NAD-TNAD-LITM TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               GO TO FIN-ELI-DIR-PTC.

           MOVE 1            TO QUE-NITM.
           MOVE TS-NDEL-LENG TO QUE-LITM.
           MOVE TS-NDEL-TYPE TO QUE-TYPE.
           MOVE QUE-GET      TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE QUE-ITEM TO TS-NDEL-ITEM
              IF TS-NDEL-ITEM = 'S'
                 MOVE QUE-DEL TO QUE-CMND
                 PERFORM GNS-PRO-QUE
                 GO TO FIN-ELI-DIR-PTC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
              MOVE ZEROES TO DBC-NUM-TDIR IN DBC
              MOVE FIO-MOD TO FIO-CMND
              PERFORM SGC-FIO-DBC.
      *RRM-FIN 22-NOV-2002
       INI-ELI-DIR-PTC.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE ZEROES TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF FIO-STAT-OKS AND
              DBC-CIC-ICLI IN DBC = RCD-CIC-ICLI IN RCD
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM SGC-FIO-RCD
              IF FIO-STAT-OKS
                 MOVE FIO-DEL TO FIO-CMND
                 PERFORM SGC-FIO-RCD
                 IF FIO-STAT-OKS
                    GO TO INI-ELI-DIR-PTC.
       FIN-ELI-DIR-PTC.
           EXIT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
*% IF PGM_BCI
      *LRH ini 24-OCT-1994
       VERIFICA-CAMBIOS SECTION.
       INI-VERIFICA-CAMBIOS.
           IF SCR-GLS-NOMC IN SCR-VARI NOT = DBC-GLS-NOMC IN DBE-FLD OR
              SCR-COD-EJEC IN SCR-VARI NOT = DBC-COD-EJEC IN DBE-FLD OR
              SCR-COD-OFIC IN SCR-VARI NOT = DBC-COD-OFIC IN DBE-FLD
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO LOG-NUM-DMOD IN LOG
               MOVE HOY-MHOY TO LOG-NUM-MMOD IN LOG
               MOVE HOY-SHOY TO LOG-NUM-SMOD IN LOG
               MOVE HOY-AHOY TO LOG-NUM-AMOD IN LOG
               MOVE HOY-HHHY TO LOG-NUM-HHMO IN LOG
               MOVE HOY-MMHY TO LOG-NUM-MHMO IN LOG
               MOVE HOY-SSHY TO LOG-NUM-SHMO IN LOG
      *JPA Ini 03-NOV-1994
               MOVE EIBTRMID TO LOG-COD-NTER IN LOG
      *JPA Fin 03-NOV-1994
               MOVE SCR-CMND TO LOG-GLS-CMND IN LOG
               MOVE 'DBC'    TO LOG-GLS-RGTR IN LOG
               MOVE 'DBE'    TO LOG-GLS-PANT IN LOG
               MOVE SPACES   TO LOG-GLS-DISP IN LOG
               MOVE SCR-DBC  TO LOG-GLS-RANT IN LOG
               MOVE DBC      TO LOG-GLS-RNVO IN LOG
               MOVE FIO-OUT  TO FIO-CMND
               PERFORM SGC-FIO-LOG
               IF NOT FIO-STAT-OKS
                   MOVE 'NOLOGOPEN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM SGC-FIO-LOG
                   IF NOT FIO-STAT-OKS
                       MOVE 'NOLOGGRAB' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       MOVE FIO-CLO TO FIO-CMND
                       PERFORM SGC-FIO-LOG
                       IF NOT FIO-STAT-OKS
                           MOVE 'NOLOGCLOSE' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-VERIFICA-CAMBIOS.
           EXIT.
      *LRH fin 24-OCT-1994
*% END
*% IF NOT PGM_PER
       SET-FRM-ICD SECTION.
       INI-SET-FRM-ICD.
           MOVE FRM-CPIM-AEY TO DBC-COD-TICL-ATR IN DBE-FLD.
           PERFORM UNP-MKY-DBE.
           MOVE -1 TO DBC-GLS-NOMC-LEN IN DBE-FLD.
           PERFORM BUS-SCR-USER.
           IF DBC-COD-TICL IN DBE-FLD NOT > SPACES
                MOVE 'CA' TO DBC-COD-TICL IN DBE-FLD.

           IF DBC-COD-OFIC IN DBE-FLD NOT > SPACES
                MOVE WSS-COD-OFIC TO DBC-COD-OFIC IN DBE-FLD.

           IF DBC-COD-EJEC IN DBE-FLD NOT > SPACES
                MOVE WSS-COD-EJEC TO DBC-COD-EJEC IN DBE-FLD.

           MOVE 'SGC'                   TO FIO-SIST.
           MOVE 'TCL'                   TO TAB-COD-TTAB.
           MOVE DBC-COD-TICL IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TICL.
           IF NOT
               ( WSS-CIC-TICL = 'CA' OR 'CL' OR 'EE' OR 'CO' )
                  MOVE 'CA' TO DBC-COD-TICL IN DBE-FLD.
       FIN-SET-FRM-ICD.
           EXIT.
*% END
      *DAD ini  13-MAY-1992
       BUS-SCR-USER SECTION.
       INI-BUS-SCR-USER.
*% IF PGM_BCI
      *<<<< PGM_BCI
      *LRH ini 18-MAY-1994
      *     COPY USPC143.
      *     MOVE USP-COD-OFICINA TO WSS-COD-OFIC IN WSS-VARI
      *                             OFI-COD-OFIC IN OFI.
           MOVE SCR-OFI-USP IN SCR-VARI TO WSS-COD-OFIC IN WSS-VARI
                                           OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-COD-JFOF IN OFI TO WSS-COD-EJEC IN WSS-VARI.
      *>>>>
*% END
       FIN-BUS-SCR-USER.
           EXIT.
      *DAD fin  13-MAY-1992
       LLN-REG-DBE SECTION.
       INI-LLN-REG-DBE.
           MOVE SPACES                       TO DCP.
           MOVE ZEROES                       TO DCP-STP-ITRN IN DCP.
           MOVE ZEROES                       TO DCP-FEC-FNAC IN DCP.
           MOVE 'P'                          TO DBC-IND-TICL IN DBC.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI         TO DBC-NUM-DTRN IN DBC.
           MOVE HOY-MHOY IN HOY-VARI         TO DBC-NUM-MTRN IN DBC.
           MOVE HOY-AHOY IN HOY-VARI         TO DBC-NUM-ATRN IN DBC.
           MOVE HOY-SHOY IN HOY-VARI         TO DBC-NUM-STRN IN DBC.
           MOVE HOY-HHOY IN HOY-VARI         TO DBC-HRA-HRTR IN DBC.
           MOVE DBC-GLS-NOMC IN DBE-FLD      TO STR-GLS-GSTR.
           MOVE SPACES                       TO STR-IND-DELI.
           PERFORM STR-UNS.
           MOVE STR-GLS-FUNS IN STR-VARI (1) TO DBC-GLS-APAT IN DBC.
           MOVE STR-GLS-FUNS IN STR-VARI (2) TO DBC-GLS-AMAT IN DBC.
           MOVE STR-GLS-FUNS IN STR-VARI (3) TO WSS-STR-NOM1.
           MOVE STR-GLS-FUNS IN STR-VARI (4) TO WSS-STR-NOM2.
           MOVE WSS-STR-NOMC                 TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN                     TO DBC-GLS-NOMB IN DBC.
       FIN-LLN-REG-DBE.
           EXIT.
       BUS-CLI-EMP SECTION.
       INI-BUS-CLI-EMP.
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
           MOVE 'NOM' TO SCR-KEY-IDBC.
*% END
           MOVE FIO-GET-NLS-ALT TO FIO-CMND.
       LUP-BUS-CLI-EMP.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE SPACES TO FIO-AKEY.
           IF FIO-STAT-OKS AND DBC-IND-TICL IN DBC NOT = 'E'
               MOVE FIO-GET-NXT-ALT TO FIO-CMND
               GO TO LUP-BUS-CLI-EMP.
       FIN-BUS-CLI-EMP.
           EXIT.
       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
      *         Para informar que el backout se realizo con exito
                MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.
      *>>>>
*% END
*% IF EOF AND PGM_DTC AND PGM_V31
      *<<<< EOF AND PGM_DTC AND PGM_V31
      *DAD ini  07-JUN-1991
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *DAD fin  07-JUN-1991
      *>>>>
*% END
*% IF EOF_PU
      *ADA-INI JSS 26-FEB-2001
       COPY SGCBFEFE.
      *ADA-FIN JSS 26-FEB-2001
*% END
*% IF EOF
      *<<<< EOF
*%! RVM: 27-03-92 VSI NO MANEJA PFS DEPENDIENTES DE DTC
*% IF PGM_DTC
       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.
       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
       LUP-LEE-NXT-PRV-DBC.
           IF SCR-KEY-IDBC = 'NOM'
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
           ELSE
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS AND DBC-IND-TICL NOT = 'E'
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-DBC
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.
       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           MOVE 'NOM' TO SCR-KEY-IDBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-NXT-PRV-NOM.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS AND DBC-IND-TICL NOT = 'E'
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-NOM
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-NOM.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.
*% IF PGM_CHI
      *LRH ini 10-OCT-1994
       LIMPIA-CAMPOS-DCC SECTION.
       INI-LIMPIA-CAMPOS-DCC.
           IF DCC-NUM-TCHP IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-TCHP.
           IF DCC-NUM-TCHA IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-TCHA.
           IF DCC-IND-PBOL NOT > SPACES
              MOVE SPACES TO DCC-IND-PBOL.
           IF DCC-NUM-UPBC IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-UPBC.
           IF DCC-IND-UTBC NOT > SPACES
              MOVE SPACES TO DCC-IND-UTBC.
           IF DCC-FEC-FIBC IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-FEC-FIBC.
           IF DCC-NUM-TDPH IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-TDPH.
           IF DCC-NUM-TDAH IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-TDAH.
       FIN-LIMPIA-CAMPOS-DCC.
           EXIT.
      *LRH fin 10-OCT-1994
*% END
*% END
*% IF PGM_CHI OR PGM_ARG
      *ALD/21-JUL-1988
       COPY SGCBFRBS.
*% END
*% IF PGM_CHI
      *LRH ini 18-MAY-1994
       COPY SGCBFDCC.
      *LRH fin 18-MAY-1994
*% END
       COPY SGCBFREC.
       COPY SGCBFDCE.
       COPY SGCBFDCP.
       COPY SGCBFRCD.
       COPY TABBVUSR.
      *LRH ini 24-OCT-1994
       COPY SGCBFLOG.
      *LRH fin 24-OCT-1994
*% IF PGM_PU
      *AFRI-INI 18-DIC-2014 CAMBIO LARGO TELEFONO
      *AFRI-INI/31072013    LARGO NUMERO TELEFONO
      *COPY SGCBGTEL.
      *AFRI-FIN/31072013    LARGO NUMERO TELEFONO
       COPY SGCBGFON.
      *AFRI-FIN 18-DIC-2014 CAMBIO LARGO TELEFONO
*% END

*% IF NOT PGM_PER
      *<<<< NOT PGM_PER
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *>>>>
*% END
       COPY GNSBGCIC.
       COPY GNSBFCIC.
*% IF NOT PGM_ARG
       COPY GNSBEGLS.
*% END
       COPY GNSBGPPU.
       COPY GNSBGSTR.
       COPY GNSBGCPT.
       COPY SGCBGPPU.
       COPY SGCBGRCU.
       COPY SGCBGDOM.
*%! IF PGM_PER
       COPY TABBBLOC.
       COPY TABBVLOC.
*%! END
      *RJZ  29-DEC-1994 14:57:35
       GRABA-LOG SECTION.
       INI-GRABA-LOG.
               IF SCR-IND-TICL IN WSS-VARI = DBC-IND-TICL IN DBC
                  GO TO FIN-GRABA-LOG
               PERFORM GET-FHOY.
               MOVE HOY-DHOY TO LOG-NUM-DMOD IN LOG.
               MOVE HOY-MHOY TO LOG-NUM-MMOD IN LOG.
               MOVE HOY-SHOY TO LOG-NUM-SMOD IN LOG.
               MOVE HOY-AHOY TO LOG-NUM-AMOD IN LOG.
               MOVE HOY-HHHY TO LOG-NUM-HHMO IN LOG.
               MOVE HOY-MMHY TO LOG-NUM-MHMO IN LOG.
               MOVE HOY-SSHY TO LOG-NUM-SHMO IN LOG.
      *JPA Ini 03-NOV-1994
               MOVE EIBTRMID TO LOG-COD-NTER IN LOG.
      *JPA Fin 03-NOV-1994
               MOVE 'EAP' TO LOG-GLS-CMND IN LOG.
               MOVE 'DBC'    TO LOG-GLS-RGTR IN LOG.
               MOVE 'DBE'    TO LOG-GLS-PANT IN LOG.
               MOVE SPACES   TO LOG-GLS-DISP IN LOG.
               MOVE SCR-DBC  TO LOG-GLS-RANT IN LOG.
               MOVE DBC      TO LOG-GLS-RNVO IN LOG.
               MOVE FIO-OUT  TO FIO-CMND.
               PERFORM SGC-FIO-LOG.
               IF NOT FIO-STAT-OKS
                  MOVE 'NOLOGOPEN' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM SGC-FIO-LOG
                   IF NOT FIO-STAT-OKS
                       MOVE 'NOLOGGRAB' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       MOVE FIO-CLO TO FIO-CMND
                       PERFORM SGC-FIO-LOG
                       IF NOT FIO-STAT-OKS
                           MOVE 'NOLOGCLOSE' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-GRABA-LOG.
           EXIT.

      *RJZ  INI 4-JAN-1995 10:17:15
       GRABA-LOGDCE SECTION.
       INI-GRABA-LOGDCE.
           IF SCR-COD-TSOC IN WSS-VARI =DCE-COD-TSOC IN DCE
              GO TO FIN-GRABA-LOGDCE
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO LOG-NUM-DMOD IN LOG.
           MOVE HOY-MHOY TO LOG-NUM-MMOD IN LOG.
           MOVE HOY-SHOY TO LOG-NUM-SMOD IN LOG.
           MOVE HOY-AHOY TO LOG-NUM-AMOD IN LOG.
           MOVE HOY-HHHY TO LOG-NUM-HHMO IN LOG.
           MOVE HOY-MMHY TO LOG-NUM-MHMO IN LOG.
           MOVE HOY-SSHY TO LOG-NUM-SHMO IN LOG.
      *JPA Ini 03-NOV-1994
           MOVE EIBTRMID TO LOG-COD-NTER IN LOG.
      *JPA Fin 03-NOV-1994
           MOVE 'MNJ'    TO LOG-GLS-CMND IN LOG.
           MOVE 'DCE'    TO LOG-GLS-RGTR IN LOG.
           MOVE 'DBE'    TO LOG-GLS-PANT IN LOG.
           MOVE SPACES   TO LOG-GLS-DISP IN LOG.
           MOVE SCR-DCE  TO LOG-GLS-RANT IN LOG.
           MOVE DCE      TO LOG-GLS-RNVO IN LOG.
           MOVE FIO-OUT  TO FIO-CMND.
           PERFORM SGC-FIO-LOG.
           IF NOT FIO-STAT-OKS
              MOVE 'NOLOGOPEN' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
              MOVE FIO-PUT TO FIO-CMND
              PERFORM SGC-FIO-LOG
              IF NOT FIO-STAT-OKS
                 MOVE 'NOLOGGRAB' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
              ELSE
                 MOVE FIO-CLO TO FIO-CMND
                 PERFORM SGC-FIO-LOG
                 IF NOT FIO-STAT-OKS
                    MOVE 'NOLOGCLOSE' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-GRABA-LOGDCE.
           EXIT.
      *>>>>
*% END
*% IF CMT_ID AND PGM_PU
      *<<<<
      *================================================================
      *MODIFICACION : VALIDACION LARGO NUMERO DE TELEFONO
      *FECHA        : JUL-2013
      *AUTOR        : AFRI-BEE
      *ETIQUETA     : *AFRI-INI/31072013    LARGO NUMERO TELEFONO
      *================================================================
      * MANTENCION: CAMBIO LARGO NUMERO TELEFONO EVEREST PORTAL
      * AUTOR: AFRI-CGC
      * FECHA: DICIEMBRE 2014
      * ETIQUETA: *AFRI-INI 18-DIC-2014 CAMBIO LARGO TELEFONO
      *--------------------------------------------------------------
      *---------------------------------------------------------------*
      * MODIFICACION:
      * Proyecto: Nueva Banca MicroEmpresarios
      * Autor:    Marco Pena Silva
      * Objetivo: Agregar Nueva Banca MicroEmpresarios (PMV)
      * Etiqueta: * MPS-INI Nueva Banca MicroEmpresarios 05/08/2015
      *---------------------------------------------------------------*
      * MANTENCION: PORTABILIDAD
      * AUTOR: BEE-NGA
      * FECHA: AGOSTO 2016
      * ETIQUETA:*NGA-INI 19-08-2016 PORTABILIDAD
      *--------------------------------------------------------------
      *>>>>
*% END
*% IF PGM_POS_RCK AND PGM_PU
      *<<<<
           MOVE TSK-TERM-ALF TO NAD-TNAD-TERM.
      *>>>>
*% END
*% IF INI_SCR_MOD AND PGM_PU
      *<<<<
           GO TO CONT-SCR-MOD.
      *>>>>
*% END
*% IF PGM_POS_EDB AND PGM_PU
      *<<<<
           MOVE TSK-TERM-ALF TO NAD-TNAD-TERM.
      *>>>>
*% END
*% IF FIN_SCR_TRL AND PGM_PQ
      *<<<<
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
