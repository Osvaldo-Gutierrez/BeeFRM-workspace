*%! Codigo adicional BM
*% IF INI_PUT_DAE_DAE
      *<<<< INI_PUT_DAE_DAE
              MOVE DAE-GLS-NMPP IN DAE(1) TO FRM-GLS-NMP1 IN DAE-FLD
              MOVE DAE-SGV-PRCM IN DAE(1) TO FRM-SGV-PRP1 IN DAE-FLD.              

              MOVE DAE-GLS-NMPP IN DAE(2) TO FRM-GLS-NMP2 IN DAE-FLD
              MOVE DAE-SGV-PRCM IN DAE(2) TO FRM-SGV-PRP2 IN DAE-FLD.              

              MOVE DAE-GLS-NMPP IN DAE(3) TO FRM-GLS-NMP3 IN DAE-FLD
              MOVE DAE-SGV-PRCM IN DAE(3) TO FRM-SGV-PRP3 IN DAE-FLD.              


              MOVE DAE-GLS-NMPC IN DAE(1) TO FRM-GLS-NMC1 IN DAE-FLD
              MOVE DAE-SGV-PRVN IN DAE(1) TO FRM-SGV-PRC1 IN DAE-FLD.          

              MOVE DAE-GLS-NMPC IN DAE(2) TO FRM-GLS-NMC2 IN DAE-FLD
              MOVE DAE-SGV-PRVN IN DAE(2) TO FRM-SGV-PRC2 IN DAE-FLD.          

              MOVE DAE-GLS-NMPC IN DAE(3) TO FRM-GLS-NMC3 IN DAE-FLD
              MOVE DAE-SGV-PRVN IN DAE(3) TO FRM-SGV-PRC3 IN DAE-FLD.          
      *>>>>
*% END
*% IF FIN_PUT_DBC_DAE
      *<<<< FIN_PUT_DBC_DAE
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NOMC IN DAE-FLD.
      *>>>>
*% END
*% IF FIN_RET_DAE_DAE
      *<<<< FIN_RET_DAE_DAE

              MOVE FRM-GLS-NMP1 IN DAE-FLD TO DAE-GLS-NMPP IN DAE(1)
              MOVE FRM-SGV-PRP1 IN DAE-FLD TO DAE-SGV-PRCM IN DAE(1).
                


              MOVE FRM-GLS-NMP2 IN DAE-FLD TO DAE-GLS-NMPP IN DAE(2)
              MOVE FRM-SGV-PRP2 IN DAE-FLD TO DAE-SGV-PRCM IN DAE(2).


              MOVE FRM-GLS-NMP3 IN DAE-FLD TO DAE-GLS-NMPP IN DAE(3)
              MOVE FRM-SGV-PRP3 IN DAE-FLD TO DAE-SGV-PRCM IN DAE(3).


              MOVE FRM-GLS-NMC1 IN DAE-FLD TO DAE-GLS-NMPC IN DAE(1)
              MOVE FRM-SGV-PRC1 IN DAE-FLD TO DAE-SGV-PRVN IN DAE(1).
           

              MOVE FRM-GLS-NMC2 IN DAE-FLD TO DAE-GLS-NMPC IN DAE(2)
              MOVE FRM-SGV-PRC2 IN DAE-FLD TO DAE-SGV-PRVN IN DAE(2).
           

              MOVE FRM-GLS-NMC3 IN DAE-FLD TO DAE-GLS-NMPC IN DAE(3)
              MOVE FRM-SGV-PRC3 IN DAE-FLD TO DAE-SGV-PRVN IN DAE(3).
      *>>>>
*% END      
*% IF INI_VAL_CON_KEY_DAE
      *<<<< INI_VAL_CON_KEY_DAE
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-DAE.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_DAE
      *<<<< FIN_VAL_CON_KEY_DAE
           IF DAE-CAI-IFOL IN DAE-FLD NOT > SPACES AND
              DAE-IIC-IFOL IN DAE-FLD NOT > SPACES AND
              DBC-NUM-ICLI IN DAE-FLD NOT > ZEROES
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'VALCONKEY'  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-DAE.
      *>>>>
*% END
*% IF DAE_IND_FECU
      *<<<< DAE_IND_FECU
           IF DAE-IND-FECU IN DAE-FLD NOT > SPACES
               GO TO FIN-VAL-DAE-IND-FECU.

           MOVE 'SGC'                   TO TAB-COD-SIST.        
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB. 
           MOVE DAE-IND-FECU IN DAE-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.      
      *>>>>
*% END
*% IF DAE_IND_BU2A
      *<<<< DAE_IND_BU2A
           IF DAE-IND-BU2A IN DAE-FLD NOT > SPACES
               GO TO FIN-VAL-DAE-IND-BU2A.

           MOVE 'SGC'                   TO TAB-COD-SIST.        
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB. 
           MOVE DAE-IND-BU2A IN DAE-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.      
      *>>>>
*% END
*% IF DAE_IND_UIVA
      *<<<< DAE_IND_UIVA
           IF DAE-IND-UIVA IN DAE-FLD NOT > SPACES
               GO TO FIN-VAL-DAE-IND-UIVA.

           MOVE 'SGC'                   TO TAB-COD-SIST.        
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB. 
           MOVE DAE-IND-UIVA IN DAE-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.      
      *>>>>
*% END
*% IF DAE_IND_UDIR
      *<<<< DAE_IND_UDIR
           IF DAE-IND-UDIR IN DAE-FLD NOT > SPACES
               GO TO FIN-VAL-DAE-IND-UDIR.

           MOVE 'SGC'                   TO TAB-COD-SIST.        
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB. 
           MOVE DAE-IND-UDIR IN DAE-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.      
      *>>>>
*% END
*% IF DAE_IND_ESEX
      *<<<< DAE_IND_ESEX
           IF DAE-IND-ESEX IN DAE-FLD NOT > SPACES
               GO TO FIN-VAL-DAE-IND-ESEX.

           MOVE 'SGC'                   TO TAB-COD-SIST.        
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB. 
           MOVE DAE-IND-ESEX IN DAE-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.      
      *>>>>
*% END
*% IF DAE_IND_FCAJ
      *<<<< DAE_IND_FCAJ
           IF DAE-IND-FCAJ IN DAE-FLD NOT > SPACES
               GO TO FIN-VAL-DAE-IND-FCAJ.

           MOVE 'SGC'                   TO TAB-COD-SIST.        
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB. 
           MOVE DAE-IND-FCAJ IN DAE-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.      
      *>>>>
*% END
*% IF DAE_IND_DACT
      *<<<< DAE_IND_DACT
           IF DAE-IND-DACT IN DAE-FLD NOT > SPACES
               GO TO FIN-VAL-DAE-IND-DACT.

           MOVE 'SGC'                   TO TAB-COD-SIST.        
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB. 
           MOVE DAE-IND-DACT IN DAE-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.      
      *>>>>
*% END
*% IF DAE_IND_DPAS
      *<<<< DAE_IND_DPAS
           IF DAE-IND-DPAS IN DAE-FLD NOT > SPACES
               GO TO FIN-VAL-DAE-IND-DPAS.

           MOVE 'SGC'                   TO TAB-COD-SIST.        
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB. 
           MOVE DAE-IND-DPAS IN DAE-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.      
      *>>>>
*% END
*% IF DAE_IND_FLCR
      *<<<< DAE_IND_FLCR
           IF DAE-IND-FLCR IN DAE-FLD NOT > SPACES
               GO TO FIN-VAL-DAE-IND-FLCR.

           MOVE 'SGC'                   TO TAB-COD-SIST.        
           MOVE 'SON'                   TO TAB-COD-TTAB IN TAB. 
           MOVE DAE-IND-FLCR IN DAE-FLD TO TAB-COD-CTAB IN TAB. 
           PERFORM VAL-COD.      
      *>>>>
*% END
*% IF VAL_CON_FLD_DAE
      *<<<< INI-VAL-CON-FLD-DAE
           IF DAE-GLS-TGEC IN DAE-FLD NOT > ZEROS
              MOVE -1   TO DAE-GLS-TGEC-LEN IN DAE-FLD
              GO TO ERR-VAL-CON-FLD-DAE.

           IF DAE-GLS-NECE IN DAE-FLD NOT > SPACES 
              MOVE -1   TO DAE-GLS-NECE-LEN IN DAE-FLD
              GO TO ERR-VAL-CON-FLD-DAE.

           IF DAE-FEC-FESC IN DAE-FLD NOT > ZEROES
              MOVE -1   TO DAE-FEC-FESC-LEN IN DAE-FLD
              GO TO ERR-VAL-CON-FLD-DAE.

********* Valida que solo se ingrese 1 tramo, seleccionar X
           IF DAE-IND-TM2M IN DAE-FLD > SPACES
              ADD 1 TO WSS-NUM-TRVM
              IF DAE-IND-TM2M IN DAE-FLD NOT = 'X'
                 MOVE -1   TO DAE-IND-TM2M-LEN IN DAE-FLD
                 GO TO ER2-VAL-CON-FLD-DAE.
              
           IF DAE-IND-T2A3 IN DAE-FLD > SPACES
              ADD 1 TO WSS-NUM-TRVM
              IF DAE-IND-T2A3 IN DAE-FLD NOT = 'X'
                 MOVE -1   TO DAE-IND-T2A3-LEN IN DAE-FLD
                 GO TO ER2-VAL-CON-FLD-DAE.
              
           IF DAE-IND-T3A5 IN DAE-FLD > SPACES
              ADD 1 TO WSS-NUM-TRVM
              IF DAE-IND-T3A5 IN DAE-FLD NOT = 'X'
                 MOVE -1   TO DAE-IND-T3A5-LEN IN DAE-FLD
                 GO TO ER2-VAL-CON-FLD-DAE.
              
           IF DAE-IND-TM5M IN DAE-FLD > SPACES
              ADD 1 TO WSS-NUM-TRVM
              IF DAE-IND-TM5M IN DAE-FLD NOT = 'X'
                 MOVE -1   TO DAE-IND-TM5M-LEN IN DAE-FLD
                 GO TO ER2-VAL-CON-FLD-DAE.
              
           IF WSS-NUM-TRVM IN WSS-VARI = ZEROS
              MOVE -1   TO DAE-IND-TM2M-LEN IN DAE-FLD
              GO TO ERR-VAL-CON-FLD-DAE
           ELSE              
           IF WSS-NUM-TRVM IN WSS-VARI > 1
              MOVE -1   TO DAE-IND-TM2M-LEN IN DAE-FLD
              GO TO ER1-VAL-CON-FLD-DAE.


********** Valida PROVEEDORES
           IF FRM-GLS-NMP1 IN DAE-FLD     > SPACES AND
              FRM-SGV-PRP1 IN DAE-FLD NOT > ZEROS
              MOVE -1  TO FRM-SGV-PRP1-LEN IN DAE-FLD
              GO TO ER4-VAL-CON-FLD-DAE
           ELSE
           IF FRM-SGV-PRP1 IN DAE-FLD     > ZEROS AND
              FRM-GLS-NMP1 IN DAE-FLD NOT > SPACES
              MOVE -1  TO FRM-GLS-NMP1-LEN IN DAE-FLD 
              GO TO ER4-VAL-CON-FLD-DAE.

           IF FRM-GLS-NMP2 IN DAE-FLD     > SPACES AND
              FRM-SGV-PRP2 IN DAE-FLD NOT > ZEROS
              MOVE -1  TO FRM-SGV-PRP2-LEN IN DAE-FLD
              GO TO ER4-VAL-CON-FLD-DAE
           ELSE
           IF FRM-SGV-PRP2 IN DAE-FLD     > ZEROS AND
              FRM-GLS-NMP2 IN DAE-FLD NOT > SPACES
              MOVE -1  TO FRM-GLS-NMP2-LEN IN DAE-FLD 
              GO TO ER4-VAL-CON-FLD-DAE.

           IF FRM-GLS-NMP3 IN DAE-FLD     > SPACES AND
              FRM-SGV-PRP3 IN DAE-FLD NOT > ZEROS
              MOVE -1  TO FRM-SGV-PRP3-LEN IN DAE-FLD
              GO TO ER4-VAL-CON-FLD-DAE
           ELSE
           IF FRM-SGV-PRP3 IN DAE-FLD     > ZEROS AND
              FRM-GLS-NMP3 IN DAE-FLD NOT > SPACES
              MOVE -1  TO FRM-GLS-NMP3-LEN IN DAE-FLD 
              GO TO ER4-VAL-CON-FLD-DAE.


********** Valida CLIENTES
           IF FRM-GLS-NMC1 IN DAE-FLD     > SPACES AND
              FRM-SGV-PRC1 IN DAE-FLD NOT > ZEROS
              MOVE -1  TO FRM-SGV-PRC1-LEN IN DAE-FLD
              GO TO ER4-VAL-CON-FLD-DAE
           ELSE
           IF FRM-SGV-PRC1 IN DAE-FLD     > ZEROS AND
              FRM-GLS-NMC1 IN DAE-FLD NOT > SPACES
              MOVE -1  TO FRM-GLS-NMC1-LEN IN DAE-FLD 
              GO TO ER4-VAL-CON-FLD-DAE.

           IF FRM-GLS-NMC2 IN DAE-FLD     > SPACES AND
              FRM-SGV-PRC2 IN DAE-FLD NOT > ZEROS
              MOVE -1  TO FRM-SGV-PRC2-LEN IN DAE-FLD
              GO TO ER4-VAL-CON-FLD-DAE
           ELSE
           IF FRM-SGV-PRC2 IN DAE-FLD     > ZEROS AND
              FRM-GLS-NMC2 IN DAE-FLD NOT > SPACES
              MOVE -1  TO FRM-GLS-NMC2-LEN IN DAE-FLD 
              GO TO ER4-VAL-CON-FLD-DAE.

           IF FRM-GLS-NMC3 IN DAE-FLD     > SPACES AND
              FRM-SGV-PRC3 IN DAE-FLD NOT > ZEROS
              MOVE -1  TO FRM-SGV-PRC3-LEN IN DAE-FLD
              GO TO ER4-VAL-CON-FLD-DAE
           ELSE
           IF FRM-SGV-PRC3 IN DAE-FLD     > ZEROS AND
              FRM-GLS-NMC3 IN DAE-FLD NOT > SPACES
              MOVE -1  TO FRM-GLS-NMC3-LEN IN DAE-FLD 
              GO TO ER4-VAL-CON-FLD-DAE.


           GO TO FIN-VAL-CON-FLD-DAE.

       ERR-VAL-CON-FLD-DAE.
           MOVE 'SGC'          TO MSG-COD-SIST
           MOVE 'GLS    BLK  ' TO MSG-COD-MENS              
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC TO FRM-MENS
           MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE '1'          TO FRM-UCUR.
           GO TO FIN-VAL-CON-FLD-DAE.

       ER1-VAL-CON-FLD-DAE.
           MOVE 'SGC'          TO MSG-COD-SIST
           MOVE 'TRMSOLUNO   ' TO MSG-COD-MENS              
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC   TO FRM-MENS
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.
           MOVE '1'            TO FRM-UCUR.
           GO TO FIN-VAL-CON-FLD-DAE.              
              
       ER2-VAL-CON-FLD-DAE.
           MOVE 'SGC'          TO MSG-COD-SIST
           MOVE 'CMPSOLX     ' TO MSG-COD-MENS              
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC   TO FRM-MENS
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.
           MOVE '1'            TO FRM-UCUR.
           GO TO FIN-VAL-CON-FLD-DAE.              
   
       ER4-VAL-CON-FLD-DAE.
           MOVE 'SGC'          TO MSG-COD-SIST
           MOVE 'CMPOBLIN%   ' TO MSG-COD-MENS              
           PERFORM GET-MSG
           MOVE MSG-GLS-DESC   TO FRM-MENS
           MOVE FRM-SUAR-MAL   TO FRM-SUAR.
           MOVE '1'            TO FRM-UCUR.
           GO TO FIN-VAL-CON-FLD-DAE.              
      *>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI
           IF DBC-NUM-ICLI IN DAE-FLD > ZEROES
              MOVE DBC-NUM-ICLI IN DAE-FLD TO DBC-NUM-ICLI IN DBC
              MOVE DBC-IND-ICLI IN DAE-FLD TO DBC-IND-ICLI IN DBC
              MOVE DBC-GLS-ICLI IN DAE-FLD TO DBC-GLS-ICLI IN DBC
              MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
              MOVE FIO-GET-KEY TO FIO-CMND
              PERFORM SGC-FIO-DBC
              IF NOT FIO-STAT-OKS
                  MOVE 'SGC'        TO MSG-COD-SIST
                  MOVE 'CLI    NEX' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE SPACES       TO FRM-GLS-NOMC IN DAE-FLD
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-DBC-GLS-ICLI
              ELSE
                 IF DBC-IND-TICL IN DBC NOT = 'E'
                    MOVE 'SGC'        TO MSG-COD-SIST 
                    MOVE 'CLI    PER' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE SPACES       TO FRM-GLS-NOMC IN DAE-FLD
                    MOVE MSG-GLS-DESC TO FRM-MENS
                    MOVE FRM-SUAR-MAL TO FRM-SUAR
                    MOVE FIO-STAT-NEX TO FIO-STAT
                    GO TO FIN-VAL-DBC-GLS-ICLI
                 ELSE
                    MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                    PERFORM CPT-BLKS
                    MOVE CPT-STRN TO FRM-GLS-NOMC IN DAE-FLD
                    MOVE DBC-CAI-ICLI IN DBC TO SCR-CAI-ICLI
                    MOVE DBC-IIC-ICLI IN DBC TO SCR-IIC-ICLI.
      *>>>>
*% END
