*%! Codigo adicional para archivo
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02  SCR-DBC-REQA==.
      *>>>>
*% END
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING ==01  ADR-REQA== BY ==02 SCR-EDP-REQA==.
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-REC-DSC-REQA==.
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-REC-ASC-REQA==.
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY SGCBRREC.
       COPY SGCBRDBC.
       COPY TABBRUSR.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       01  WSS-VARI.
           03  WSS-ICOR                          VALUE 0 PIC 9(01).
               88 NO-ASIGNE-CORRELATIVO          VALUE 0.
           03  WSS-IMAX                          VALUE 5 PIC 9(01).
           03  WSS-CIC-ICLI                              PIC X(12).
      *>>>>
*% END
*% CMA_USR = TRUE
*% IF CMA
      *<<<< CMA
           02 FILLER                      PIC X(3000).
      *>>>>
*% END
*% IF INI_FIO
      *<<<< INI_FIO
           MOVE +3000 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-DBC-REQA
               MOVE SPACES TO SCR-EDP-REQA.
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7
               PERFORM VAL-NUM-KEY-CAR
               PERFORM VAL-NUM-FLD-CAR
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   MOVE SPACES TO SCR-DBC-REQA
                   MOVE SPACES TO SCR-EDP-REQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-CAR
               PERFORM VAL-NUM-FLD-CAR
               PERFORM SCRL-TAB-REC
               PERFORM SCR-TRL
           ELSE
               MOVE SPACES TO SCR-DBC-REQA
               MOVE SPACES TO SCR-EDP-REQA.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 )
               IF SCR-CCPP = 'ING'
                   PERFORM BUS-CIC-CLI
                   IF NOT FIO-STAT-OKS
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       PERFORM BUS-COR-EDP
               ELSE
                   IF EDP-NUM-IEDP IN CAR-FLD NOT > ZEROES
                       PERFORM BUS-CIC-CLI
                       IF NOT FIO-STAT-OKS
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY
                       ELSE
                           PERFORM BUS-COR-EDP
                   ELSE
                       PERFORM BUS-CIC-CLI
                       IF NOT FIO-STAT-OKS
                           MOVE MSG-GLS-DESC TO FRM-MENS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   IF MSG-COD-MENS = 'EDPSI'
                       PERFORM SCR-CLRA-CAR
                       PERFORM PUT-DBC
                       GO TO CON-FND-KEY
                   ELSE
                       PERFORM SCR-CLRA-CAR
                       PERFORM PUT-DBC
                       PERFORM BUS-EDP
                       GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   MOVE SPACES TO SCR-EDP-REQA
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'CAR    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'CAR    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF SCR-CCPP = 'ACT' AND NOT FIO-STAT-OKS
               IF NO-ASIGNE-CORRELATIVO
                   MOVE FIO-STAT-NEX TO FIO-STAT.
       CON-FND-KEY.
           IF FIO-STAT-OKS
               MOVE ADR-EDP-REQA TO SCR-EDP-REQA
               MOVE EDP-CIC-IMDT IN EDP TO REC-CIC-IREL IN REC
               MOVE EDP-NUM-IEDP IN EDP TO EDP-NUM-IEDP IN CAR-FLD
               PERFORM PUT-TAB
               PERFORM KEY-ALL-CAR
               IF NOT FIO-STAT-OKS
                   MOVE '00' TO FIO-STAT.
      *>>>>
*% END
*% IF PFS_GET_CON OR PFS_SCR_GKEY
      *<<<< PFS_GET_CON OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.
      *>>>>
*% END
*% IF EOF_IBM
      *<<<< EOF_IBM
       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-EDP-REQA > SPACES
               PERFORM LEE-NXT-PRV-EDP
           ELSE
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.
       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
       LUP-LEE-NXT-PRV-DBC.
           MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-DBC.
           MOVE DBC-CIC-ICLI IN DBC TO EDP-CIC-IMDT IN EDP.
           MOVE 'F' TO EDP-IND-TINF IN EDP.
           MOVE ZEROES TO EDP-NUM-IEDP IN EDP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           IF FIO-STAT-OKS AND
              DBC-CIC-ICLI IN DBC = EDP-CIC-IMDT IN EDP AND
              EDP-IND-TINF IN EDP = 'F'
               MOVE '00' TO PGM-STAT-EDP
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA
               MOVE 'DBCSI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-DBC.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
               GO TO LUP-LEE-NXT-PRV-DBC
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-LEE-NXT-PRV-DBC.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.
       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-NXT-PRV-NOM.
           MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DBCNO' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-NOM.
           MOVE DBC-CIC-ICLI IN DBC TO EDP-CIC-IMDT IN EDP.
           MOVE 'F' TO EDP-IND-TINF IN EDP.
           MOVE ZEROES TO EDP-NUM-IEDP IN EDP.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           IF FIO-STAT-OKS AND
              DBC-CIC-ICLI IN DBC = EDP-CIC-IMDT IN EDP AND
              EDP-IND-TINF IN EDP = 'F'
               MOVE '00' TO PGM-STAT-EDP
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA
               MOVE 'DBCSI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-NOM.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
               GO TO LUP-LEE-NXT-PRV-NOM
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.
       LEE-NXT-PRV-EDP SECTION.
       INI-LEE-NXT-PRV-EDP.
           MOVE SCR-EDP-REQA TO ADR-EDP-REQA.
           MOVE ADR-VKEY IN ADR-EDP-REQA TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
       LUP-NXT-PRV-EDP.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           IF FIO-STAT-OKS AND
              EDP-CIC-IMDT IN EDP = WSS-CIC-ICLI IN WSS-VARI
               IF EDP-IND-TINF IN EDP = 'F'
                   MOVE '00' TO PGM-STAT-EDP
                   MOVE ADR-EDP-REQA TO SCR-EDP-REQA
                   MOVE 'EDPSI' TO MSG-COD-MENS
                   GO TO FIN-LEE-NXT-PRV-EDP
               ELSE
                   GO TO LUP-NXT-PRV-EDP.
           MOVE 'EDPNO' TO MSG-COD-MENS.
           MOVE SPACES TO SCR-EDP-REQA.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV-EDP.
           EXIT.
       BUS-EDP SECTION.
       INI-BUS-EDP.
           MOVE SPACES              TO EDP-KEY-IEDP IN EDP.
           MOVE DBC-CAI-ICLI IN DBC TO EDP-CAI-IMDT IN EDP.
           MOVE DBC-IIC-ICLI IN DBC TO EDP-IIC-IMDT IN EDP.
           MOVE 'F'                 TO EDP-IND-TINF IN EDP.
           MOVE ZEROES              TO EDP-NUM-IEDP IN EDP.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE 99  TO EDP-NUM-IEDP IN EDP
               MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           IF FIO-STAT-OKS AND
              EDP-CIC-IMDT IN EDP = DBC-CIC-ICLI IN DBC AND
              EDP-IND-TINF IN EDP = 'F'
               MOVE '00' TO PGM-STAT-EDP
               MOVE ADR-EDP-REQA TO SCR-EDP-REQA
               GO TO FIN-BUS-EDP.
           MOVE SPACES TO SCR-EDP-REQA.
           MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-EDP.
           EXIT.
       PUT-DBC SECTION.
       INI-PUT-DBC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN CAR-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN CAR-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN CAR-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN CAR-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN CAR-FLD.
           MOVE DBC-CAI-ICLI IN DBC TO EDP-CAI-IMDT IN CAR-FLD.
           MOVE DBC-IIC-ICLI IN DBC TO EDP-IIC-IMDT IN CAR-FLD.
       FIN-PUT-DBC.
           EXIT.
       BUS-COR-EDP SECTION.
       INI-BUS-COR-EDP.
           MOVE 0 TO EDP-NUM-IEDP IN CAR-FLD.
           MOVE EDP-CAI-IMDT IN CAR-FLD TO EDP-CAI-IMDT IN EDP.
           MOVE EDP-IIC-IMDT IN CAR-FLD TO EDP-IIC-IMDT IN EDP.
           MOVE 'F' TO EDP-IND-TINF IN EDP.
           MOVE 99 TO EDP-NUM-IEDP IN EDP.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-EDP.
           IF FIO-STAT-OKS AND
              EDP-CAI-IMDT IN CAR-FLD = EDP-CAI-IMDT IN EDP AND
              EDP-IIC-IMDT IN CAR-FLD = EDP-IIC-IMDT IN EDP AND
              EDP-IND-TINF IN EDP = 'F'
               MOVE EDP-NUM-IEDP IN EDP TO EDP-NUM-IEDP IN CAR-FLD.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO EDP-NUM-IEDP IN CAR-FLD.
           MOVE 1 TO WSS-ICOR.
       FIN-BUS-COR-EDP.
           EXIT.
       BUS-CIC-CLI SECTION.
       INI-BUS-CIC-CLI.
           IF DBC-NUM-ICLI IN CAR-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN CAR-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN CAR-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN CAR-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM GET-CLI
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO DBC-GLS-NOMC IN CAR-FLD
               IF MSG-COD-MENS > SPACES
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-BUS-CIC-CLI
               ELSE
                   MOVE '00' TO PGM-STAT-DBC
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   MOVE DBC-CAI-ICLI IN DBC TO EDP-CAI-IMDT IN CAR-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO EDP-IIC-IMDT IN CAR-FLD
           ELSE
           IF DBC-GLS-NOMC IN CAR-FLD > SPACES
               MOVE SPACES TO DBC-GLS-NOMC IN DBC
      *NOM-CLI Busca Cliente por medio del Nombre
*% IF PGM_PQ
      *        UNSTRING DBC-GLS-NOMC IN CAR-FLD DELIMITED BY '/' INTO
      *                                 DBC-GLS-APAT IN DBC
      *                                 DBC-GLS-AMAT IN DBC
      *                                 DBC-GLS-NOMB IN DBC
*% END
               MOVE DBC-GLS-NOMC IN CAR-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS-ALT TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   GO TO FIN-BUS-CIC-CLI
               ELSE
                   MOVE '00' TO PGM-STAT-DBC
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN CAR-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN CAR-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN CAR-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN CAR-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN CAR-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO EDP-CAI-IMDT IN CAR-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO EDP-IIC-IMDT IN CAR-FLD.
           MOVE 'F' TO EDP-IND-TINF IN EDP.
       FIN-BUS-CIC-CLI.
           EXIT.
       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE 0 TO FRM-IFLD.
           MOVE SPACES TO SCR-REC-DSC-REQA.
           MOVE SPACES TO SCR-REC-ASC-REQA.
           MOVE 'REC-CIC-IREL' TO FIO-AKEY.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-PRI.
           PERFORM SGC-FIO-REC.
           IF NOT FIO-STAT-OKS OR
              EDP-CIC-IMDT IN EDP NOT = REC-CIC-IREL IN REC
               MOVE FIO-STAT-NEX TO FIO-STAT
               GO TO FIN-PUT-TAB.
           IF EDP-NUM-IEDP IN EDP NOT = REC-NUM-TREC IN REC OR
              REC-COD-TREC IN REC NOT = REC-COD-APOD IN REC-VARI
               MOVE 'REC-CIC-IREL' TO FIO-AKEY
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-PRI.
           MOVE ADR-REC-REQA TO SCR-REC-DSC-REQA.
       LUP-PUT-TAB.
           MOVE ADR-REC-REQA TO SCR-REC-ASC-REQA.
           ADD 1  TO FRM-IFLD.
           PERFORM PUT-TAB-REC.
           IF FRM-IFLD NOT < WSS-IMAX
               PERFORM BUS-MAS-REC
               IF FIO-STAT-OKS
                   MOVE 'APO    SIG' TO MSG-COD-MENS
                   MOVE 'COL'        TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-PUT-TAB
               ELSE
                   MOVE 'CLI    N+REC' TO MSG-COD-MENS
                   MOVE 'COL'        TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-PUT-TAB.
       NXT-PUT-TAB.
           MOVE 'REC-CIC-IREL' TO FIO-AKEY
           MOVE FIO-GET-NXT TO FIO-CMND
           PERFORM SGC-FIO-REC
           IF FIO-STAT-OKS AND
               EDP-CIC-IMDT IN EDP = REC-CIC-IREL IN REC AND
               REC-COD-TREC IN REC = REC-COD-APOD IN REC-VARI
                IF EDP-NUM-IEDP IN EDP = REC-NUM-TREC IN REC
                    GO TO LUP-PUT-TAB
                ELSE
                    GO TO NXT-PUT-TAB.
           MOVE '00' TO FIO-STAT.
       FIN-PUT-TAB.
           EXIT.
       SCRL-TAB-REC SECTION.
       INI-SCRL-TAB-REC.
           MOVE SPACES TO MSG-COD-MENS.
           IF FRM-FFLD = FRM-FFLD-PF6
               IF FRM-NUM-IAPO IN CAR-FLD(WSS-IMAX) > ZEROES
                   PERFORM KEY-ALL-CAR
                   PERFORM PUT-TAB-ASC
                   PERFORM BUS-MAS-REC-ASC
                   PERFORM KEY-ALL-CAR
                   IF FIO-STAT-OKS
                       MOVE 'APO    SIG' TO MSG-COD-MENS
                   ELSE
                       MOVE 'CLI    N+REC' TO MSG-COD-MENS
               ELSE
                   MOVE 'CLI    N+REC' TO MSG-COD-MENS
           ELSE
               IF FRM-NUM-IAPO IN CAR-FLD(1) > ZEROES
                   PERFORM KEY-ALL-CAR
                   PERFORM PUT-TAB-DSC
                   PERFORM BUS-MAS-REC-DSC
                   PERFORM KEY-ALL-CAR
                   IF FIO-STAT-OKS
                       MOVE 'APO    ANT' TO MSG-COD-MENS
                   ELSE
*% IF PGM_PQ
                       MOVE 'CLI    N-REC' TO MSG-COD-MENS
*% END
*% IF PGM_PU
                       MOVE 'CLI    N+REC' TO MSG-COD-MENS
*% END
               ELSE
                   MOVE 'CLI    N-REC' TO MSG-COD-MENS.
           IF MSG-COD-MENS > SPACES
               MOVE 'COL'        TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1.
       FIN-SCRL-TAB-REC.
           EXIT.
       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SCR-REC-ASC-REQA TO ADR-REC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
       LUP-PUT-TAB-ASC.
           MOVE 'REC-CIC-IREL' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CAI-IREL IN REC = EDP-CAI-IMDT IN CAR-FLD AND
              REC-IIC-IREL IN REC = EDP-IIC-IMDT IN CAR-FLD AND
              REC-COD-TREC IN REC = REC-COD-APOD IN REC-VARI
               IF EDP-NUM-IEDP IN CAR-FLD NOT = REC-NUM-TREC IN REC
                   GO TO LUP-PUT-TAB-ASC
               ELSE
               MOVE ADR-REC-REQA TO SCR-REC-ASC-REQA
               IF FRM-IFLD = 0
                   MOVE ADR-REC-REQA TO SCR-REC-DSC-REQA
                   PERFORM CLR-TAB-REC VARYING FRM-IFLD FROM 1 BY 1
                                       UNTIL FRM-IFLD > WSS-IMAX
                   MOVE 1 TO FRM-IFLD
                   PERFORM PUT-TAB-REC
               ELSE
                   ADD 1 TO FRM-IFLD
                   PERFORM PUT-TAB-REC
           ELSE
               IF FRM-IFLD = 0
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CLI    N+REC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           EXIT.
       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SCR-REC-DSC-REQA TO ADR-REC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
       LUP-PUT-TAB-DSC.
           MOVE 'REC-CIC-IREL' TO FIO-AKEY.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CAI-IREL IN REC = EDP-CAI-IMDT IN CAR-FLD AND
              REC-IIC-IREL IN REC = EDP-IIC-IMDT IN CAR-FLD AND
              REC-COD-TREC IN REC = REC-COD-APOD IN REC-VARI
               IF EDP-NUM-IEDP IN CAR-FLD NOT = REC-NUM-TREC IN REC
                   GO TO LUP-PUT-TAB-DSC
               ELSE
               MOVE ADR-REC-REQA TO SCR-REC-DSC-REQA
               IF FRM-IFLD = 0
                   MOVE ADR-REC-REQA TO SCR-REC-ASC-REQA
                   PERFORM CLR-TAB-REC VARYING FRM-IFLD FROM 1 BY 1
                                       UNTIL FRM-IFLD > WSS-IMAX
                   MOVE WSS-IMAX TO FRM-IFLD
                   PERFORM PUT-TAB-REC
               ELSE
                   SUBTRACT 1 FROM FRM-IFLD
                   PERFORM PUT-TAB-REC
           ELSE
               IF FRM-IFLD = 0
                   MOVE 'COL'          TO MSG-COD-SIST
                   MOVE 'CLI    N-REC' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN1
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.
           EXIT.
       PUT-TAB-REC SECTION.
       INI-PUT-TAB-REC.
           MOVE REC-CIC-ICLI IN REC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN TO FRM-GLS-NAPO IN CAR-FLD(FRM-IFLD)
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-IAPO IN
                                         CAR-FLD(FRM-IFLD)
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-IAPO IN
                                         CAR-FLD(FRM-IFLD)
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-IAPO IN
                                         CAR-FLD(FRM-IFLD)
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-IAPO IN
                                         CAR-FLD(FRM-IFLD).
           MOVE REC-IND-VIGE IN REC TO FRM-IND-VIGE IN
                                    CAR-FLD(FRM-IFLD).
           MOVE REC-NUM-DINI IN REC TO FRM-NUM-DINI IN
                                    CAR-FLD(FRM-IFLD).
           MOVE REC-NUM-MINI IN REC TO FRM-NUM-MINI IN
                                    CAR-FLD(FRM-IFLD).
           MOVE REC-NUM-SINI IN REC TO FRM-NUM-SINI IN
                                    CAR-FLD(FRM-IFLD).
           MOVE REC-NUM-AINI IN REC TO FRM-NUM-AINI IN
                                    CAR-FLD(FRM-IFLD).
           MOVE REC-NUM-DTER IN REC TO FRM-NUM-DTER IN
                                    CAR-FLD(FRM-IFLD).
           MOVE REC-NUM-MTER IN REC TO FRM-NUM-MTER IN
                                    CAR-FLD(FRM-IFLD).
           MOVE REC-NUM-STER IN REC TO FRM-NUM-STER IN
                                    CAR-FLD(FRM-IFLD).
           MOVE REC-NUM-ATER IN REC TO FRM-NUM-ATER IN
                                    CAR-FLD(FRM-IFLD).
           MOVE REC-COD-TREC IN REC TO REC-COD-TREC IN REC-VARI.
           IF REC-COD-AREC IN REC NOT > SPACES
               MOVE SPACES TO FRM-GLS-AREC IN CAR-FLD(FRM-IFLD)
               GO TO FIN-PUT-TAB-REC.
      *    MOVE REC-COD-AREC IN REC TO REC-COD-AREC IN REC-VARI.
      *    MOVE 'SGC' TO TAB-COD-SIST.
      *    MOVE 'REC' TO TAB-COD-TTAB IN TAB.
      *    MOVE REC-COD-CTCA IN REC-VARI TO TAB-COD-CTAB IN TAB.
      *    PERFORM BUS-TAB.
      *    MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-AREC IN
      *                             CAR-FLD(FRM-IFLD).
           MOVE REC-COD-AREC IN REC TO FRM-GLS-AREC IN
                                    CAR-FLD(FRM-IFLD).
       FIN-PUT-TAB-REC.
           EXIT.
*% IF PGM_PU

       CLR-TAB-REC SECTION.
       INI-CLR-TAB-REC.
           MOVE SPACES TO FRM-GLS-NAPO IN CAR-FLD(FRM-IFLD).
           MOVE ZEROES TO FRM-NUM-IAPO IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-VRF-IAPO IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-IND-IAPO IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-IAPO IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-IND-VIGE IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-FEC-FINI IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-FEC-FTER IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-AREC IN CAR-FLD(FRM-IFLD)
           MOVE SPACES TO FRM-GLS-AREC IN CAR-FLD(FRM-IFLD).
       FIN-CLR-TAB-REC.
           EXIT.
       BUS-MAS-REC-ASC.
*% END
*% IF PGM_PQ
       BUS-MAS-REC-ASC SECTION.
*% END
       INI-BUS-MAS-REC-ASC.
           MOVE SCR-REC-ASC-REQA TO ADR-REC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
       LUP-BUS-MAS-REC-ASC.
           MOVE 'REC-CIC-IREL' TO FIO-AKEY.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CAI-IREL IN REC = EDP-CAI-IMDT IN CAR-FLD AND
              REC-IIC-IREL IN REC = EDP-IIC-IMDT IN CAR-FLD AND
              REC-COD-TREC IN REC = REC-COD-APOD IN REC-VARI
               IF EDP-NUM-IEDP IN CAR-FLD NOT = REC-NUM-TREC IN REC
                   GO TO LUP-BUS-MAS-REC-ASC
               ELSE
                   GO TO FIN-BUS-MAS-REC-ASC.
           MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-MAS-REC-ASC.
           EXIT.
*% IF PGM_PQ
       BUS-MAS-REC-DSC SECTION.
*% END
*% IF PGM_PU
       BUS-MAS-REC-DSC.
*% END
       INI-BUS-MAS-REC-DSC.
           MOVE SCR-REC-DSC-REQA TO ADR-REC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
       LUP-BUS-MAS-REC-DSC.
           MOVE 'REC-CIC-IREL' TO FIO-AKEY.
           MOVE FIO-GET-PRV TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CAI-IREL IN REC = EDP-CAI-IMDT IN CAR-FLD AND
              REC-IIC-IREL IN REC = EDP-IIC-IMDT IN CAR-FLD AND
              REC-COD-TREC IN REC = REC-COD-APOD IN REC-VARI
               IF EDP-NUM-IEDP IN CAR-FLD NOT = REC-NUM-TREC IN REC
                   GO TO LUP-BUS-MAS-REC-DSC
               ELSE
                   GO TO FIN-BUS-MAS-REC-DSC.
           MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-MAS-REC-DSC.
           EXIT.
*% IF PGM_PQ
       CLR-TAB-REC SECTION.
       INI-CLR-TAB-REC.
           MOVE SPACES TO FRM-GLS-NAPO IN CAR-FLD(FRM-IFLD).
           MOVE ZEROES TO FRM-NUM-IAPO IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-VRF-IAPO IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-IND-IAPO IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-IAPO IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-IND-VIGE IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-FEC-FINI IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-FEC-FTER IN CAR-FLD(FRM-IFLD).
           MOVE SPACES TO FRM-GLS-AREC IN CAR-FLD(FRM-IFLD)
           MOVE SPACES TO FRM-GLS-AREC IN CAR-FLD(FRM-IFLD).
       FIN-CLR-TAB-REC.
           EXIT.
*% END
       BUS-MAS-REC SECTION.
       INI-BUS-MAS-REC.
           MOVE FIO-GET-NXT TO FIO-CMND.
       LUP-BUS-MAS-REC.
           MOVE 'REC-CIC-IREL' TO FIO-AKEY.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
               EDP-CIC-IMDT IN EDP = REC-CIC-IREL IN REC AND
               REC-COD-TREC IN REC = REC-COD-APOD IN REC-VARI
                IF EDP-NUM-IEDP IN EDP NOT = REC-NUM-TREC IN REC
                    MOVE FIO-GET-NXT TO FIO-CMND
                    GO TO LUP-BUS-MAS-REC
                ELSE
                    GO TO FIN-BUS-MAS-REC.
           MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-MAS-REC.
           EXIT.
       COPY SGCBFDBC.
       COPY SGCBFREC.
       COPY GNSBVTAB.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBEGLS.
       COPY SGCBGCLI.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY TABBFUSR.
       COPY TABBVOFI.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY GNSBVCOD.
      *>>>>
*% END
