*%! Codigo adicional para SGCVEH
*% NO_TIENE_TIMESTAMP = FALSE
*% NO_HDR_CST = FALSE
*% FMT_CHI = TRUE
*% GEN_BCI = TRUE
*% PGM_PTC = TRUE
*% IF SETTAG
*% VSNPQ = "06.02.24.1"
*% VSNPU = "06.02.24.1"
*% FNCPQ = "CMC-CONVENIO"
*% FNCPU = "CMC-CONVENIO"
*% END
*%! Codigo adicional para archivo
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI                                                
           03 SCR-CIC-ICLI.                                             
              05 SCR-CAI-ICLI                 PIC X(04).                
              05 SCR-IIC-ICLI                 PIC X(08).                
      *>>>>                                                             
*% END
*% IF WSS                                                         
      *<<<< WSS                                                         
       COPY SGCBRRPR.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RPR-REQA==.        
       COPY SGCBRIPC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IPC-REQA==.        
       COPY SGCBRDBC.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.        
                                                                        
       COPY GNSWGSTR.                                                   
       COPY GNSWGCPT.                                                   
       COPY TABWGLOC.                                                   
                                                                        
       01  WSS-VARI.                                                    
           03 WSS-CIC-ICLI              PIC X(12).                      
           03 WSS-KEY-IIPC              PIC X(15).                      
           03 WSS-CIC-TIPO.                                             
              05 WSS-CAI-TIPO           PIC X(04).                      
              05 WSS-IIC-TIPO           PIC X(08).                      
                                                                        
           03 WSS-MARCA-MODELO.                                         
              05 WSS-VEH-MARC           PIC X(02).                     
              05 WSS-VEH-MODE           PIC X(03).                      
*% IF PGM_PU
           03 WSS-IND-EVEH              PIC X(01).
      *>>>>                                                             
*% END
*% END
*% IF CMN_ING
      *<<<< CMN_ING                                                     
                                                                        
      *    Usuario que Ingresa                                          
           MOVE SCR-USER TO VEH-COD-EEFR IN VEH.                        
      *    Fecha Transaccion                                            
           MOVE HOY-FHOY TO VEH-FEC-FEFR IN VEH.                        
      *>>>>                                                             
*% END
*% IF FIN_CMN_ING
      *<<<< FIN_CMN_ING                                                 
           MOVE FIO-STAT TO PGM-STAT-VEH.                               
           PERFORM ACT-IPC.                                             
           MOVE PGM-STAT-VEH TO FIO-STAT.                               
      *>>>>                                                             
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY                                                 
           IF SCR-CMND = 'ING'                                          
               PERFORM GET-FHOY                                         
               MOVE HOY-DHOY TO VEH-NUM-DEFR IN VEH-FLD                 
               MOVE HOY-MHOY TO VEH-NUM-MEFR IN VEH-FLD                 
               MOVE HOY-SHOY TO VEH-NUM-SEFR IN VEH-FLD                 
               MOVE HOY-AHOY TO VEH-NUM-AEFR IN VEH-FLD                 
               MOVE SCR-USER TO VEH-COD-EEFR IN VEH-FLD.                
      *>>>>                                                             
*% END
*% IF FND_KEY
           IF VEH-IIC-IFOL IN VEH-FLD > ZEROES                          
               PERFORM OBT-FOL                                          
           ELSE                                                         
           IF DBC-NUM-ICLI IN VEH-FLD > ZEROES                          
               PERFORM OBT-CLI-FOL.                                     
                                                                        
           IF MSG-COD-MENS > SPACES                                     
               GO TO FIN-FND-KEY.                                       
                                                                        
           MOVE RPR-CAI-IFOL TO VEH-CAI-IFOL IN VEH.                    
           MOVE RPR-IIC-IFOL TO VEH-IIC-IFOL IN VEH.                    
           MOVE RPR-CAI-IFOL TO VEH-CAI-IFOL IN VEH-FLD.                
           MOVE RPR-IIC-IFOL TO VEH-IIC-IFOL IN VEH-FLD.                
           IF SCR-CCPP = 'ING'                                          
               PERFORM BUS-COR-VEH                                      
               GO TO CON-FND-KEY.                                       
           IF VEH-NUM-IVEH IN VEH-FLD NOT > ZEROES                      
               PERFORM BUS-COR-VEH.                                     
       CON-FND-KEY.                                                     
      *>>>> 
*% END
*% IF PGM_PU AND FIN_CMN_ELI
      *<<<< FIN_CMN_ELI                                                 
           MOVE FIO-STAT TO PGM-STAT-VEH.                               
           PERFORM ACT-IPC.                                             
           MOVE PGM-STAT-VEH TO FIO-STAT.                               
      *>>>>                                                             
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY                                                 
           IF FIO-STAT-OKS AND                                          
              RPR-IND-ESTA IN RPR = 'A' AND                             
             (SCR-CMND = 'ELI' OR SCR-CMND = 'MOD')                     
               MOVE 'SGC' TO MSG-COD-SIST                               
               MOVE 'FOLRPRYAACA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE '00' TO FIO-STAT                                    
               MOVE SCR-STAT-CON TO SCR-STAT                            
               MOVE PGM-STAT-VEH TO FIO-STAT                            
               GO TO FIN-FND-KEY.                                       
                                                                        
           IF FIO-STAT-OKS AND                                          
              RPR-IND-ESTA IN RPR NOT = 'A' AND                         
              SCR-CMND = 'MRA'                                          
               MOVE 'SGC' TO MSG-COD-SIST                               
               MOVE 'FOLRPRNOACA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE '00' TO FIO-STAT                                    
               MOVE SCR-STAT-CON TO SCR-STAT                            
               MOVE PGM-STAT-VEH TO FIO-STAT                            
               GO TO FIN-FND-KEY.                                       
      *>>>>                                                             

*% END
*% IF EOF
      *<<<< EOF                                                         
       OBT-FOL SECTION.                                                 
       INI-OBT-FOL.                                                     
           MOVE VEH-CAI-IFOL IN VEH-FLD TO RPR-CAI-IFOL IN RPR.         
           MOVE VEH-IIC-IFOL IN VEH-FLD TO RPR-IIC-IFOL IN RPR.         
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-RPR.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'SGC'          TO MSG-COD-SIST                      
               MOVE 'FOLRPRNODISP' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-OBT-FOL.                                       
           MOVE RPR-CIC-ICLI IN RPR TO DBC-CIC-ICLI IN DBC.             
           MOVE FIO-GET-KEY TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO FIN-OBT-FOL.                                       
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN VEH-FLD.         
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN VEH-FLD.         
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN VEH-FLD.         
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN VEH-FLD.         
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.                        
           PERFORM CPT-BLKS.                                            
           MOVE CPT-STRN TO FRM-GLS-NOMC IN VEH-FLD.                    
       FIN-OBT-FOL.                                                     
           EXIT.                                                        
                                                                        
       OBT-CLI-FOL SECTION.                                             
       INI-OBT-CLI-FOL.                                                 
           MOVE SCR-CIC-ICLI       TO RPR-CIC-ICLI IN RPR.              
           MOVE '99999999'         TO RPR-FEC-FRPR IN RPR.              
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           MOVE 'RPR-AKY-IRPR' TO FIO-AKEY.                             
           PERFORM SGC-FIO-RPR.                                         
       LUP-LEE-RPR.                                                     
           IF NOT (FIO-STAT-OKS AND                                     
               RPR-CIC-ICLI IN RPR = SCR-CIC-ICLI)                      
               MOVE 'SGC'          TO MSG-COD-SIST                      
               MOVE 'FOLRPRNODISP' TO MSG-COD-MENS                      
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-OBT-CLI-FOL.                                   
                                                                        
       FIN-OBT-CLI-FOL.                                                 
           EXIT.                                                        
                                                                        
       BUS-COR-VEH SECTION.                                             
       INI-BUS-COR-VEH.                                                 
           MOVE 999 TO VEH-NUM-IVEH IN VEH.                             
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM SGC-FIO-VEH.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    VEH-CAI-IFOL IN VEH-FLD = VEH-CAI-IFOL IN VEH AND   
                    VEH-IIC-IFOL IN VEH-FLD = VEH-IIC-IFOL IN VEH )     
               PERFORM KEY-ALL-VEH                                      
               MOVE ZEROES TO VEH-NUM-IVEH IN VEH.                      
                                                                        
           IF SCR-CCPP = 'ING' OR 'ACT'                                 
               ADD 1 TO VEH-NUM-IVEH IN VEH                             
               MOVE VEH-NUM-IVEH IN VEH TO VEH-NUM-IVEH IN VEH-FLD.     
       FIN-BUS-COR-VEH.                                                 
           EXIT.                                                        
                                                                        
       ACT-IPC SECTION.                                                 
       INI-ACT-IPC.                                                     
           MOVE VEH-CAI-IFOL IN VEH-FLD TO IPC-CAI-IFOL IN IPC.         
           MOVE VEH-IIC-IFOL IN VEH-FLD TO IPC-IIC-IFOL IN IPC.         
           MOVE SPACES                  TO IPC-COD-TDOC IN IPC.         
           MOVE FIO-GET-NLS   TO FIO-CMND.                              
       LUP-ACT-IPC.                                                     
           PERFORM SGC-FIO-IPC.                                         
           IF NOT (FIO-STAT-OKS AND                                     
               VEH-CAI-IFOL IN VEH-FLD = IPC-CAI-IFOL IN IPC AND        
               VEH-IIC-IFOL IN VEH-FLD = IPC-IIC-IFOL IN IPC)           
                GO TO FIN-ACT-IPC.                                      
                                                                        
           MOVE IPC-KEY-IIPC IN IPC TO WSS-KEY-IIPC IN WSS-VARI.        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM SGC-FIO-IPC.                                         
           IF NOT FIO-STAT-OKS                                          
               GO TO NXT-ACT-IPC.                                       
                                                                        
           IF SCR-CMND = 'ING'                                          
               MOVE 'S' TO IPC-IND-CVEH IN IPC                          
           ELSE                                                         
           IF SCR-CMND = 'ELI'                                         
*% IF PGM_PU          
               PERFORM BUS-VEH                                          
               IF WSS-IND-EVEH IN WSS-VARI = SPACES        
*% END             
                  MOVE 'N' TO IPC-IND-CVEH IN IPC.                         
                                                                        
           MOVE FIO-MOD TO FIO-CMND.                                    
           PERFORM SGC-FIO-IPC.                                         
                                                                        
           MOVE WSS-KEY-IIPC IN WSS-VARI TO IPC-KEY-IIPC IN IPC.        
           MOVE FIO-GET-NLS   TO FIO-CMND.                              
           PERFORM SGC-FIO-IPC.                                         
                                                                        
       NXT-ACT-IPC.                                                     
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-ACT-IPC.                                           
                                                                        
       FIN-ACT-IPC.                                                     
           EXIT.                                                        

*% IF PGM_PU
       BUS-VEH SECTION.                                                 
       INI-BUS-VEH.                                                     
           MOVE SPACES TO WSS-IND-EVEH IN WSS-VARI.                     
           MOVE VEH-CAI-IFOL IN VEH-FLD TO VEH-CAI-IFOL IN VEH.         
           MOVE VEH-IIC-IFOL IN VEH-FLD TO VEH-IIC-IFOL IN VEH.         
           MOVE ZEROES TO VEH-NUM-IVEH IN VEH.                          
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM SGC-FIO-VEH.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              VEH-CAI-IFOL IN VEH = VEH-CAI-IFOL IN VEH-FLD AND         
              VEH-IIC-IFOL IN VEH = VEH-IIC-IFOL IN VEH-FLD )           
               MOVE SPACES TO WSS-IND-EVEH IN WSS-VARI                  
           ELSE                                                         
               MOVE 'S' TO WSS-IND-EVEH IN WSS-VARI.                    
       FIN-BUS-VEH.                                                     
           EXIT.                                                        
*% END 
                                                                        
       COPY GNSBGSTR.                                                   
       COPY GNSBGCPT.                                                   
       COPY SGCBFDBC.                                                   
       COPY SGCBFRPR.                                                   
       COPY SGCBFIPC.                                                   
       COPY SGCBGCLI.                                                   
       COPY GNSBBTAB.                                                   
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.                                                   
       COPY TABBBLOC.                                                   
       COPY TABBVLOC.                                                   
      *>>>>                                                             
*% END
*% IF EOF AND PGM_PQ
      *<<<<  EOF AND PGM_PQ
       COPY GNSBEGLS.                                                 
      *>>>>  
*% END

