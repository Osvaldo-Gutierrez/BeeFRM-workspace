*%! Codigo adicional para archivo                                       
*% PGM_PTC = TRUE
*% LARGO_TOTAL_COMMAREA = 3000
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
           03  SCR-DBC-CIC-ICLI                     PIC X(012).
           03  SCR-TXO-KEY-ITXO.
               05  SCR-TXO-CIC-ICLI                 PIC X(012).
               05  SCR-TXO-CIC-IOPE.
                   07  SCR-TXO-CAI-IOPE             PIC X(004).
                   07  SCR-TXO-IIC-IOPE             PIC X(008).
               05  SCR-TXO-FEC-FINI                 PIC 9(008).
               05  SCR-TXO-COD-CPTO                 PIC X(012).
               05  SCR-TXO-NUM-ITXO                 PIC 9(003).
           03  SCR-GLS-DAT1.
               05  SCR-IND-IOPE                     PIC X(01).
               05  SCR-IND-CASO                     PIC X(01).
               05  SCR-IND-NASO                     PIC X(01).
               05  SCR-IND-VASO                     PIC X(01).
               05  SCR-GLS-ADIC                     PIC X(06).
           03  SCR-CIC-CPTO                         PIC X(12).
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
       COPY SGCBRDBC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGCPT.                                                   
       01  WSS-VARI.
           03  WSS-FEC-FINI.
               05  WSS-NUM-SINI                        PIC 9(002).
               05  WSS-NUM-AINI                        PIC 9(002).
               05  WSS-NUM-MINI                        PIC 9(002).
               05  WSS-NUM-DINI                        PIC 9(002).
           03  WSS-GLS-ASOC.
               05  WSS-COD-TASO                            PIC X(003).
               05  WSS-GLS-FASO                            PIC X(009).
           03  WSS-GLS-DESC.
               05  WSS-GLS-DES1                            PIC X(040).
               05  WSS-GLS-DES2                            PIC X(040).
*% IF PGM_PQ
           03  WSS-COD-SETO                                PIC X(005).
           03  WSS-GLS-PERM.
               05  WSS-NUM-PERM-ALF                        PIC X(002).
               05  WSS-NUM-PERM REDEFINES WSS-NUM-PERM-ALF PIC 9(002).
               05  WSS-IND-PERM                            PIC X(001).
           03  WSS-FEC-FING.
               05  WSS-NUM-SING                            PIC 9(002).
               05  WSS-NUM-AING                            PIC 9(002).
               05  WSS-NUM-MING                            PIC 9(002).
               05  WSS-NUM-DING                            PIC 9(002).
           03  WSS-CIC-CING.
               05  WSS-CAI-CING                            PIC X(004).
               05  WSS-IIC-CING                            PIC X(008).
           03  WSS-FEC-FMIN.
               05  WSS-NUM-SMIN                            PIC 9(002).
               05  WSS-NUM-AMIN                            PIC 9(002).
               05  WSS-NUM-MMIN                            PIC 9(002).
               05  WSS-NUM-DMIN                            PIC 9(002).
*% END
*% IF PGM_PU
           03  WSS-VAL-ASOC                            PIC S9(11).
           03  WSS-FEC-FTER.
               05  WSS-NUM-STER                        PIC 9(002).
               05  WSS-NUM-ATER                        PIC 9(002).
               05  WSS-NUM-MTER                        PIC 9(002).
               05  WSS-NUM-DTER                        PIC 9(002).
*% END
      *>>>>
*% END
*% IF PFS_SCR_ACC
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM VAL-NUM-KEY-TXO
               PERFORM VAL-NUM-FLD-TXO
               PERFORM SCRL-TAB-TXO
               PERFORM SCR-TRL.
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           MOVE SCR-DBC-CIC-ICLI TO TXO-CIC-ICLI IN TXO.           
      *CONSULTA SEGMENTO CLIENTE
           IF TXO-COD-CPTO IN TXO-FLD = 'SGM' AND
              SCR-CMND = 'CON'
              PERFORM BUS-SGM-DBC
              GO TO FIN-FND-KEY.

           IF SCR-CCPP = 'ING'                                          
              PERFORM BUS-COR-TXO
              GO TO CON-FND-KEY.                                       
           IF TXO-NUM-ITXO IN TXO NOT > ZEROES                          
              PERFORM BUS-COR-TXO.                                     
       CON-FND-KEY.                                                     
      *>>>>
*% END
*% IF PUT_SCR
      *<<<< PUT_SCR
           IF PGM-STAT-TXO-OKS                                          
               MOVE TXO-KEY-ITXO IN TXO TO SCR-TXO-KEY-ITXO.            
      *>>>>
*% END
*% IF PFS_GET_CON
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF7 )                           
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 )                           
      *>>>>
*% END
*% IF EOF_PQ
      *<<<< EOF_PQ
       COPY GNSBPFEC.
       COPY SGCBFDBC.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBBTAB.
       COPY GNSBGCPT.

       BUS-COR-TXO SECTION.                                             
       INI-BUS-COR-TXO.                                                 
           MOVE TXO-NUM-SINI IN TXO-FLD TO WSS-NUM-SINI IN WSS-VARI.
           MOVE TXO-NUM-AINI IN TXO-FLD TO WSS-NUM-AINI IN WSS-VARI.
           MOVE TXO-NUM-MINI IN TXO-FLD TO WSS-NUM-MINI IN WSS-VARI.
           MOVE TXO-NUM-DINI IN TXO-FLD TO WSS-NUM-DINI IN WSS-VARI.

           MOVE 999         TO TXO-NUM-ITXO IN TXO.                     
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM SGC-FIO-TXO.                                         
           MOVE FIO-STAT TO PGM-STAT-TXO.                               
           IF SCR-CMND = 'CON'                                          
              IF NOT ( FIO-STAT-OKS AND                                 
                 SCR-DBC-CIC-ICLI         = TXO-CIC-ICLI IN TXO AND
                 TXO-CAI-IOPE IN TXO-FLD  = TXO-CAI-IOPE IN TXO AND     
                 TXO-IIC-IOPE IN TXO-FLD  = TXO-IIC-IOPE IN TXO AND     
                 TXO-COD-CPTO IN TXO-FLD  = TXO-COD-CPTO IN TXO )       
                 PERFORM KEY-ALL-TXO
                 MOVE ZEROES TO TXO-NUM-ITXO IN TXO                     
              ELSE                                                      
                 MOVE FIO-END-BRW TO FIO-CMND                           
                 PERFORM SGC-FIO-TXO                                    
           ELSE                                                         
           IF NOT ( FIO-STAT-OKS AND                                    
              SCR-DBC-CIC-ICLI         = TXO-CIC-ICLI IN TXO AND
              TXO-CAI-IOPE IN TXO-FLD  = TXO-CAI-IOPE IN TXO AND     
              TXO-IIC-IOPE IN TXO-FLD  = TXO-IIC-IOPE IN TXO AND     
              WSS-FEC-FINI IN WSS-VARI = TXO-FEC-FINI IN TXO AND 
              TXO-COD-CPTO IN TXO-FLD  = TXO-COD-CPTO IN TXO )          
              PERFORM KEY-ALL-TXO                                       
              MOVE ZEROES TO TXO-NUM-ITXO IN TXO.                       
                                                                        
           IF SCR-CCPP = 'ING'
               ADD 1                    TO TXO-NUM-ITXO IN TXO          
               MOVE TXO-NUM-ITXO IN TXO TO TXO-NUM-ITXO IN TXO-FLD.
       FIN-BUS-COR-TXO.                                                 
           EXIT.                                                        
                                                                        
       SCRL-TAB-TXO SECTION.                                            
       INI-SCRL-TAB-TXO.                                                
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF5                   
               PERFORM SCRL-TAB-TXO-PF7                                 
               GO TO FIN-SCRL-TAB-TXO.                                  
           IF FRM-FFLD = FRM-FFLD-PF8  OR FRM-FFLD-PF6                  
               PERFORM SCRL-TAB-TXO-PF8                                 
               GO TO FIN-SCRL-TAB-TXO.                                  
       FIN-SCRL-TAB-TXO.                                                
           EXIT.                                                        
                                                                        
       SCRL-TAB-TXO-PF7 SECTION.                                        
       INI-SCRL-TAB-TXO-PF7.                                            
           MOVE SCR-TXO-KEY-ITXO TO TXO-KEY-ITXO IN TXO.                
           MOVE FIO-GET-LEQ TO FIO-CMND.                                
           PERFORM SGC-FIO-TXO.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    TXO-KEY-ITXO IN TXO = SCR-TXO-KEY-ITXO)             
               MOVE 'TABCURRNEX' TO MSG-COD-MENS                        
               GO TO MSG-SCRL-TAB-TXO-PF7.                              
       PRV-SCRL-TAB-TXO-PF8.                                            
           MOVE FIO-GET-PRV TO FIO-CMND.                                
           PERFORM SGC-FIO-TXO.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    TXO-CIC-ICLI IN TXO = SCR-TXO-CIC-ICLI AND
                    TXO-CIC-IOPE IN TXO = SCR-TXO-CIC-IOPE AND     
                    TXO-FEC-FINI IN TXO = SCR-TXO-FEC-FINI AND 
                    TXO-COD-CPTO IN TXO = SCR-TXO-COD-CPTO )          
               MOVE 'TAB    NOPRV' TO MSG-COD-MENS                      
               GO TO MSG-SCRL-TAB-TXO-PF7.                              
           MOVE FIO-STAT TO PGM-STAT-TXO.                               
           PERFORM SCR-CLRA-TXO.                                        
           PERFORM LEE-DBC-TXO.
           PERFORM PUT-SCR.                                             
           GO TO FIN-SCRL-TAB-TXO-PF7.                                  
       MSG-SCRL-TAB-TXO-PF7.                                            
           MOVE 'TAB' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MEN2.                               
       FIN-SCRL-TAB-TXO-PF7.                                            
           EXIT.                                                        
                                                                        
       SCRL-TAB-TXO-PF8 SECTION.                                        
       INI-SCRL-TAB-TXO-PF8.                                            
           MOVE SCR-TXO-KEY-ITXO TO TXO-KEY-ITXO IN TXO.                
           MOVE FIO-GET-NLS TO FIO-CMND.                                
           PERFORM SGC-FIO-TXO.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    TXO-KEY-ITXO IN TXO = SCR-TXO-KEY-ITXO)             
               MOVE 'TABCURRNEX' TO MSG-COD-MENS                        
               GO TO MSG-SCRL-TAB-TXO-PF8.                              
       NXT-SCRL-TAB-TXO-PF8.                                            
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           PERFORM SGC-FIO-TXO.                                         
           IF NOT ( FIO-STAT-OKS AND                                    
                    TXO-CIC-ICLI IN TXO = SCR-TXO-CIC-ICLI AND
                    TXO-CIC-IOPE IN TXO = SCR-TXO-CIC-IOPE AND     
                    TXO-FEC-FINI IN TXO = SCR-TXO-FEC-FINI AND 
                    TXO-COD-CPTO IN TXO = SCR-TXO-COD-CPTO )          
               MOVE 'TAB    NONXT' TO MSG-COD-MENS                      
               GO TO MSG-SCRL-TAB-TXO-PF8.                              
           MOVE FIO-STAT TO PGM-STAT-TXO.                               
           PERFORM SCR-CLRA-TXO.                                        
           PERFORM LEE-DBC-TXO.
           PERFORM PUT-SCR.                                             
           GO TO FIN-SCRL-TAB-TXO-PF8.                                  
       MSG-SCRL-TAB-TXO-PF8.                                            
           MOVE 'TAB' TO MSG-COD-SIST.                                  
           PERFORM GET-MSG.                                             
           MOVE MSG-GLS-DESC TO FRM-MEN2.                               
       FIN-SCRL-TAB-TXO-PF8.                                            
           EXIT.                                                        

       LEE-DBC-TXO SECTION.
       INI-LEE-DBC-TXO.
           MOVE TXO-CIC-ICLI IN TXO TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF NOT FIO-STAT-OKS                                     
               MOVE 'SGC'        TO MSG-COD-SIST               
               MOVE 'CLI    NEX' TO MSG-COD-MENS               
               GO TO FIN-LEE-DBC-TXO.
           MOVE DBC-CIC-ICLI IN DBC TO SCR-TXO-CIC-ICLI.
           MOVE DBC-CIC-ICLI IN DBC TO SCR-DBC-CIC-ICLI.
           MOVE DBC-CIC-ICLI IN DBC TO TXO-CIC-ICLI IN TXO.           
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.                                     
           MOVE CPT-STRN TO FRM-GLS-NOMC IN TXO-FLD.            
       FIN-LEE-DBC-TXO.
           EXIT.

       BUS-SGM-DBC SECTION.
       INI-BUS-SGM-DBC.
           MOVE ZEROES TO TXO-STP-ITRN IN TXO.
           MOVE 'I' TO TXO-MSC-TACC IN TXO.
           MOVE 'S' TO TXO-MSC-STAT IN TXO.
           MOVE SPACES TO TXO-COD-OTRN IN TXO.
           MOVE 'SGCPQTXO    ' TO TXO-COD-ATRN IN TXO.
           MOVE WSS-COD-SETO IN WSS-VARI TO TXO-COD-ASOC IN TXO.
           MOVE ZEROES                   TO TXO-NUM-ASOC IN TXO.
           MOVE ZEROES                   TO TXO-SGV-ASOC IN TXO.
           MOVE SPACES                   TO TXO-COD-VCOC IN TXO.
           MOVE SPACES                   TO TXO-COD-EVNT IN TXO.
           MOVE ZEROES                   TO TXO-FEC-FTER IN TXO.
           MOVE SPACES                   TO TXO-GLS-ADIC IN TXO.

           MOVE 'TAB'                    TO TAB-COD-SIST.
           MOVE 'SGM'                    TO TAB-COD-TTAB IN TAB.
           MOVE WSS-COD-SETO IN WSS-VARI TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB      TO FRM-GLS-ASOC IN TXO-FLD.
           MOVE TAB-GLS-ABRV IN TAB      TO TXO-COD-ADC5 IN TXO.
           MOVE '00' TO FIO-STAT PGM-STAT-TXO.
       FIN-BUS-SGM-DBC.
           EXIT.
      *>>>>
*% END
*% IF EOF_PU
      *<<<< EOF_PU
       COPY SGCBFDBC.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
      *>>>>
*% END      
