*%! CMA_USR = TRUE
*% HDR_CST    = TRUE
*% NO_HDR_CST = FALSE
*% PGM_PTC    = FALSE
*%! GNSTCA_ORIG = 3000
*%! GNSTCA = 3000
*% IF WSS
      *<<<< WSS
       COPY TABBRUSR.
       COPY GNSWGSTR.
       COPY GNSWGCPT.
       COPY SGCBRPDI.
       01  WSS-VARI.
           03 WSS-IMAX               VALUE 15          PIC 9(02).
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
      *>>>>
*% END
*% IF FND_KEY
      *<<<< FND_KEY
           IF DBC-NUM-ICLI IN PDI-FLD NOT = ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN PDI-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN PDI-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN PDI-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE SPACES TO DBC-GLS-NOMC IN PDI-FLD
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE '00' TO PGM-STAT-DBC
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC
                   GO TO CON-FND-KEY
           ELSE
           IF DBC-GLS-NOMC IN PDI-FLD > SPACES
               MOVE DBC-GLS-NOMC IN PDI-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC

               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               MOVE FIO-GET-NLS    TO FIO-CMND
               PERFORM GET-CLI
               IF MSG-COD-MENS > SPACES
                   MOVE ZEROES TO DBC-NUM-ICLI IN PDI-FLD
                   MOVE SPACES TO DBC-VRF-ICLI IN PDI-FLD
                   MOVE SPACES TO DBC-IND-ICLI IN PDI-FLD
                   MOVE SPACES TO DBC-GLS-ICLI IN PDI-FLD
                   MOVE FIO-STAT-NEX TO FIO-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-FND-KEY
               ELSE
                   MOVE '00' TO PGM-STAT-DBC
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO DBC-GLS-NOMC IN DBC
                   GO TO CON-FND-KEY.
      *>>>>
*% END
*% IF FIN_FND_KEY
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.
       CON-FND-KEY.
           MOVE ZEROES TO FRM-IFLD.
           PERFORM PUT-PDI.
           MOVE '00' TO FIO-STAT.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       PGM-EBR-ALL SECTION.
       INI-PGM-EBR-ALL.
           MOVE FIO-EBR-ALL TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       FIN-PGM-EBR-ALL.
           EXIT.

       PUT-PDI SECTION.
       INI-PUT-PDI.
           MOVE SPACES TO PDI.
           MOVE PDI-NUM-DINF IN PDI-FLD TO PDI-NUM-DINF IN PDI.
           MOVE PDI-NUM-MINF IN PDI-FLD TO PDI-NUM-MINF IN PDI.
           MOVE PDI-NUM-SINF IN PDI-FLD TO PDI-NUM-SINF IN PDI.
           MOVE PDI-NUM-AINF IN PDI-FLD TO PDI-NUM-AINF IN PDI.
           MOVE DBC-CIC-ICLI IN DBC     TO PDI-CIC-ICLI IN PDI.
           MOVE FIO-GET-NLS TO FIO-CMND.
       CIC-PUT-PDI.
           PERFORM SGC-FIO-PDI.
           IF NOT ( FIO-STAT-OKS AND
                    PDI-NUM-DINF IN PDI = PDI-NUM-DINF IN PDI AND
                    PDI-NUM-MINF IN PDI = PDI-NUM-MINF IN PDI AND
                    PDI-NUM-SINF IN PDI = PDI-NUM-SINF IN PDI AND
                    PDI-NUM-AINF IN PDI = PDI-NUM-AINF IN PDI AND
                    PDI-CIC-ICLI IN PDI = DBC-CIC-ICLI IN DBC )
                      GO TO FIN-PUT-PDI.

           ADD  1  TO FRM-IFLD.
           IF FRM-IFLD > WSS-IMAX
                 GO TO FIN-PUT-PDI.

           MOVE PDI-COD-GRPO IN PDI TO
                FRM-COD-GRPO IN PDI-FLD(FRM-IFLD).
           MOVE PDI-COD-VCAM IN PDI TO
                FRM-COD-VCAM IN PDI-FLD(FRM-IFLD).
           MOVE PDI-NUM-SLDO IN PDI TO
                FRM-NUM-SLDO IN PDI-FLD(FRM-IFLD).
           MOVE PDI-NUM-SPES IN PDI TO
                FRM-NUM-SPES IN PDI-FLD(FRM-IFLD).

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO CIC-PUT-PDI.

       FIN-PUT-PDI.
           EXIT.

       COPY TABBFUSR.
       COPY SGCBFPDI.
       COPY TABBBUSR.
       COPY GNSBVTAB.
       COPY TABBVUSR.
       COPY GNSBVCOD.
       COPY SGCBGCLI.
       COPY GNSBGSTR.
       COPY GNSBGCPT.
       COPY GNSBEGLS.
       COPY GNSBGVSM.
      *>>>>
*% END
