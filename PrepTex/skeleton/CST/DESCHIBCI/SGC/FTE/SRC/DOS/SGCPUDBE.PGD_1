       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   SGCPUDBE.
       AUTHOR.       CONSIST.
       DATE-WRITTEN. 08-May-19 11:38 AM.

      * NOMBRE PROGRAMA                   SGCPUDBE
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      SGCDBC
      * PANTALLA                          SGCDBE
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *<<<<
      *================================================================
      *MODIFICACION : VALIDACION LARGO NUMERO DE TELEFONO
      *FECHA        : JUL-2013
      *AUTOR        : AFRI-BEE
      *ETIQUETA     : *AFRI-INI/31072013    LARGO NUMERO TELEFONO
      *================================================================
      * MANTENCION: CAMBIO LARGO NUMERO TELEFONO EVEREST PORTAL
      * AUTOR: AFRI-CGC
      * FECHA: DICIEMBRE 2014
      * ETIQUETA: *AFRI-INI 18-DIC-2014 CAMBIO LARGO TELEFONO
      *--------------------------------------------------------------
      *---------------------------------------------------------------*
      * MODIFICACION:
      * Proyecto: Nueva Banca MicroEmpresarios
      * Autor:    Marco Pena Silva
      * Objetivo: Agregar Nueva Banca MicroEmpresarios (PMV)
      * Etiqueta: * MPS-INI Nueva Banca MicroEmpresarios 05/08/2015
      *---------------------------------------------------------------*
      * MANTENCION: PORTABILIDAD
      * AUTOR: BEE-NGA
      * FECHA: AGOSTO 2016
      * ETIQUETA:*NGA-INI 19-08-2016 PORTABILIDAD
      *--------------------------------------------------------------
      *>>>>

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-SGCPUDBE-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$SGCPUDBE$ SKL=$08.07.21$ VSN=${vsnpu}$        
      -    'GEN=$08-May-19 11:38 AM$ FNC=${fncpu}$/>'.    
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-DBC-REQA==.
           02 SCR-KEY-IDBC                     PIC X(03).
      *>>>>
      *LRH ini 18-MAY-1994
           02 SCR-OFI-USP                         PIC X(03).
      *LRH fin 18-MAY-1994
      *LRH ini 24-OCT-1994
           02 SCR-DBC                             PIC X(241).
           02 SCR-GLS-NOMC                        PIC X(75).
           02 SCR-COD-EJEC                        PIC X(12).
           02 SCR-COD-OFIC                        PIC X(03).

      *LRH fin 24-OCT-1994
       COPY SGCWIDBE.
       COPY SGCBRDBC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<< WSS
      *AFRI-INI 18-DIC-2014 CAMBIO LARGO TELEFONO
      *AFRI-INI/31072013    LARGO NUMERO TELEFONO
      *COPY SGCWGTEL.
      *AFRI-FIN/31072013    LARGO NUMERO TELEFONO
       COPY SGCWGFON.
       01 WCC-VARI.
          03 WCC-D                  VALUE 'D'        PIC X(01).
          03 WCC-E                  VALUE 'E'        PIC X(01).
          03 WCC-ING                VALUE 'ING'      PIC X(03).
          03 WCC-MOD                VALUE 'MOD'      PIC X(03).
      *AFRI-FIN 18-DIC-2014 CAMBIO LARGO TELEFONO
       COPY SGCMXW01.
       COPY SGCWGDIR.
      *ALD/21-JUL-1988
       COPY SGCBRRBS.
       01  WSS-CMND-DBP.
           03  WSS-CMND-DBE-ING               VALUE 'ING'   PIC X(03).
           03  WSS-CMND-DBE-MNC               VALUE 'MNC'   PIC X(03).
           03  WSS-CMND-DBE-MDA               VALUE 'MDA'   PIC X(03).
           03  WSS-CMND-DBE-IDA               VALUE 'IDA'   PIC X(03).
           03  WSS-CMND-DBE-ICD               VALUE 'ICD'   PIC X(03).
           03  WSS-CMND-DBE-CCL               VALUE 'CCL'   PIC X(03).
           03  WSS-CMND-DBE-MIC               VALUE 'MIC'   PIC X(03).
           03  WSS-CMND-DBE-INC               VALUE 'INC'   PIC X(03).
           03  WSS-CMND-DBE-MNJ               VALUE 'MNJ'   PIC X(03).
           03  WSS-CMND-DBE-EAP               VALUE 'EAP'   PIC X(03).
           03  WSS-CMND-DBE-VRF               VALUE 'VRF'   PIC X(03).
      *LRH ini 20-ABR-1994
           03  WSS-CMND-DBE-MVA               VALUE 'MVA'   PIC X(03).
      *LRH fin 20-ABR-1994
       COPY SGCBRREC.
       COPY SGCBRDCE.
       COPY SGCBRDCP.
       COPY SGCBRRCD.
       COPY GNSBRCIC.
       COPY TABBRPAI.
       COPY TABWGLOC.
      *<<<< NOT PGM_PER
       COPY GNSWGFEC.
       COPY GNSWGHOY.
      *>>>>
      *ADA-INI JSS 26-FEB-2001
       COPY SGCBREFE.
      *ADA-FIN JSS 26-FEB-2001
       COPY GNSWGCIC.
       COPY GNSWGSTR.
       COPY GNSWGCPT.
       COPY SGCWVPPU.
      *LRH ini 24-OCT-1994
       COPY SGCBRLOG.
      *LRH fin 24-OCT-1994
       01  WSS-VARI.
           03 WSS-STR-NOMC.
              05 WSS-STR-NOM1                           PIC X(40).
              05 WSS-STR-NOM2                           PIC X(40).
      *RJZ INI 29-DEC-1994 15:21:46
           03 SCR-IND-TICL                              PIC X(01).
           03 SCR-DCE                                   PIC X(158).
           03 SCR-COD-TSOC                              PIC X(02).
      *RJZ FIN  4-JAN-1995 12:01:28
           03 WSS-COD-CTCA.
              05 WSS-COD-TREC                           PIC X(02).
      *DAD ini  26-JUL-1993
              05 WSS-COD-AREC                           PIC X(05).
           03 WSS-NUM-MRUT            VALUE 50000000    PIC 9(08).
      *DAD fin  26-JUL-1993
      *DAD ini  09-FEB-1994
           03 WSS-COD-TBAN                              PIC X(03).
              88 VAL-TBAN             VALUES ARE 'I', 'B', 'G', 'A'.
      *DAD fin  09-FEB-1994
      *DAD ini  09-FEB-1994
      *     03 WSS-COD-LUGA.
      *        05 WSS-COD-COMU                           PIC X(04).
      *        05 WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
      *           07 WSS-IND-PAIS                        PIC X(01).
      *           07 WSS-COD-PAIS                        PIC X(03).
      *DAD fin  09-FEB-1994
           03 WSS-COD-TUSR                              PIC X(05).
           03 WSS-SIND.
              05 I                                      PIC 9(03).
      *DAD ini  05-JUN-1992
           03 WSS-IND                                   PIC 9(02).
           03 WSS-IND-STAT                              PIC X(01).
           03 WSS-GLS-FONO.
              05 WSS-NUM-FONO         OCCURS 12         PIC X(01).
      *DAD fin  05-JUN-1992
      *DAD ini  13-MAY-1992
           03 WSS-CIC-TICL                              PIC X(02).
           03 WSS-OFIC                                 PIC X(03).
           03 WSS-COD-OFIC                              PIC X(03).
           03 WSS-COD-EJEC                              PIC X(12).
      *<<<< PGM_BCI
           COPY USPC113.
      *>>>>
      *DAD fin  13-MAY-1992
      *>>>>
      *<<<< WSS_DTC
      *LRH ini 18-MAY-1994
       COPY SGCBRDCC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
      *LRH fin 18-MAY-1994
      *ALD/21-JUL-1988
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RBS-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
      *ADA-INI JSS 26-FEB-2001
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EFE-REQA==.
      *ADA-FIN JSS 26-FEB-2001
       01 WSS-COD-TERM                                PIC X(04)
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
              05 PGM-STAT-DCE.
                 88 PGM-STAT-DCE-NUL    VALUE '  '.
                 07 PGM-STT1-DCE        VALUE '2' PIC X(01).
                    88 PGM-STAT-DCE-OKS VALUE '0'.
                 07 PGM-STT2-DCE        VALUE '3' PIC X(01).
              05 PGM-STAT-RCD.
                 88 PGM-STAT-RCD-NUL    VALUE '  '.
                 07 PGM-STT1-RCD        VALUE '2' PIC X(01).
                    88 PGM-STAT-RCD-OKS VALUE '0'.
                 07 PGM-STT2-RCD        VALUE '3' PIC X(01).
              05 PGM-STAT-DCC.
                 88 PGM-STAT-DCC-NUL    VALUE '  '.
                 07 PGM-STT1-DCC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DCC-OKS VALUE '0'.
                 07 PGM-STT2-DCC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
      *<<<< CMA
           02 FILLER                      PIC X(843).
      *>>>>
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
      *<<<< PGM_INI
      *DAD ini  13-MAY-1992
      *     SE PREGUNTA POR CONSTANTES, PUES EN ESTE PUNTO NO ESTAN
      *     INICIALIZADAS VARIABLES FRM-FFLD
            MOVE DFHCOMMAREA(1:EIBCALEN) TO SCR-VARI.
       *DAD ini  05-JUN-1992
      *ISP: BAJO COMANDO ICD Y CCL PERMITE SOLO TECLAS <ENTER> Y <PF11>
           IF SCR-CMND = WSS-CMND-DBE-ICD OR WSS-CMND-DBE-CCL
      *DAD fin  05-JUN-1992
               IF NOT ( EIBAID = '1' OR 'A' OR '#' OR '.' )
                   MOVE ' ' TO EIBAID.
      *DAD fin  13-MAY-1992
      *>>>>
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO DBE-FLD.
           MOVE LOW-VALUES TO DBE-EDT.
      *<<<<
           MOVE TSK-TERM-ALF TO NAD-TNAD-TERM.
      *>>>>
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +843 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'SGCPUDBE' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO
           MOVE +843 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-DBC-REQA.
      *>>>>
      *<<<< INI_FIO AND PGM_DTC AND PGM_V31
           IF SCR-OFRM-SRV
              MOVE EIBTRMID TO WSS-COD-TERM
           ELSE
              MOVE SCR-OTRN TO WSS-COD-TERM.
      *DAD ini  07-JUN-1991
           PERFORM GNS-HDL-VSM.
      *DAD fin  07-JUN-1991
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-DBE.
           PERFORM EDT-KEY-DBE.
           PERFORM EDT-FLD-DBE.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
      *<<<<
           GO TO CONT-SCR-MOD.
      *>>>>
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD-PF7 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-DBE
               PERFORM VAL-NUM-FLD-DBE.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL

               ELSE
                   MOVE SPACES TO SCR-DBC-REQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           MOVE SPACES TO SCR-DBC-REQA.
      *>>>>
      *<<<< PFS_SCR_MOD
       CONT-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
      *>>>>
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-DBE
               PERFORM EDT-KEY-DBE
               PERFORM EDT-FLD-DBE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-DBE
               PERFORM EDT-KEY-DBE
           ELSE
               PERFORM CLR-FLD-DBE
               PERFORM EDT-FLD-DBE.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO DBE-FLD.
           MOVE LOW-VALUES TO DBE-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
           PERFORM KEY-ALL-DBE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
      *<<<< CMN_MOD_RET
      *DAD ini  13-MAY-1992
           IF FRM-IND-VERS IN DBE-FLD = 'N'
               MOVE DBC-NUM-DCOR IN DBC TO DBC-NUM-DCOR IN DBE-FLD.
      *DAD fin  13-MAY-1992
      *>>>>
           PERFORM RET-ALL-DBE.
      *<<<< CMN_MOD
      *<<<< PGM_DOS OR PGM_MVS
      *    Compara codigo ult. modificacion con el que tiene en la COMMON AREA
           IF DBC-STP-ITRN IN DBC NOT = SCR-UMOD
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'UPD    SIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-MOD.
      *>>>>
      *    PERFORM KEY-DCE-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
      *RJZ INI  4-JAN-1995 11:06:48
           IF SCR-CMND='MNJ'
              MOVE DCE-COD-TSOC IN DCE TO SCR-COD-TSOC IN WSS-VARI
              MOVE DCE    TO   SCR-DCE.
      *RJZ FIN   4-JAN-1995 11:06:59

           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC
      *        Comunicar que no se pudo actualizar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           PERFORM RET-DCE-DBE.
      *    PERFORM KEY-RCD-DBE.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE 01 TO RCD-NUM-DIRE IN RCD.

           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC y DCE
      *        Comunicar que no se pudo actualizar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           PERFORM RET-RCD-DBE.
           PERFORM RET-HDR-DBC.
      *LRH ini 24-OCT-1994
           PERFORM VERIFICA-CAMBIOS.
           IF FRM-MENS > SPACES
               GO TO FIN-CMN-MOD.
      *LRH fin 24-OCT-1994
      *>>>>
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
      *<<<< FIN_CMN_MOD
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-MOD.

           MOVE DBC-STP-ITRN IN DBC TO DCE-STP-ITRN IN DCE.
           PERFORM RET-HDR-DCE.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.

           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *RJZ INI 17-JAN-1995 19:30:11
           IF SCR-CMND='MNJ'
              PERFORM GRABA-LOGDCE.
      *RJZ FIN 17-JAN-1995 19:30:18

           MOVE DBC-STP-ITRN IN DBC TO RCD-STP-ITRN IN RCD.
           PERFORM RET-HDR-RCD.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
      *LRH ini 18-MAY-1994
           MOVE DBC-CAI-ICLI IN DBE-FLD TO DCC-CAI-ICLI IN DCC.
           MOVE DBC-IIC-ICLI IN DBE-FLD TO DCC-IIC-ICLI IN DCC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCC.
           IF FIO-STAT-OKS
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               MOVE FIO-PUT TO FIO-CMND.
           PERFORM RET-DCC-DBE.
           PERFORM RET-HDR-DCC.
      *LRH ini 10-OCT-1994
           PERFORM LIMPIA-CAMPOS-DCC.
      *LRH fin 10-OCT-1994
           PERFORM SGC-FIO-DCC.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la modificacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-MOD.
           IF SCR-OFRM-SRV
              PERFORM ELI-DIR-PTC.
      *LRH fin 18-MAY-1994
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO DBC.
      *<<<< INI_CMN_ING
           MOVE DBC-NUM-ICLI IN DBE-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN DBE-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN DBE-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'DBCIDCYAEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ING.
           MOVE SPACES TO DBC.
           MOVE ZEROES TO DBC-STP-ITRN IN DBC.
           MOVE ZEROES TO DBC-NUM-DCOR IN DBC.
           MOVE ZEROES TO DBC-FEC-FA85 IN DBC.
      *ALD-BCI-INI
      *    MOVE ZEROES TO DBC-FEC-FUPI IN DBC.
           MOVE SPACES TO DBC-COD-SETO IN DBC.
           MOVE SPACES TO DBC-PDO-SETO IN DBC.
      *ALD-BCI-FIN
      *LRH ini 21-NOV-1994
           IF SCR-CMND = 'ING' OR 'ACT'
               PERFORM GET-FHOY
               MOVE HOY-FHOY TO DBC-FEC-FSCL IN DBC.
      *LRH fin 21-NOV-1994
           MOVE ZEROES TO DBC-NUM-TDIR IN DBC.
           MOVE ZEROES TO DBC-NUM-TCMT IN DBC.
      *LRH ini 21-NOV-1994
           IF SCR-CMND = 'ING' OR 'ACT'
               PERFORM GET-FHOY
               MOVE HOY-FHOY TO DBC-FEC-FIOP IN DBC.
      *LRH fin 21-NOV-1994
           MOVE ZEROES TO DBC-FEC-FTOP IN DBC.
           MOVE ZEROES TO DBC-NUM-OFTN IN DBC.
           MOVE ZEROES TO DBC-FEC-FINP IN DBC.
           MOVE SPACES TO RCD.
           MOVE ZEROES TO RCD-NUM-DIRE IN RCD.
           MOVE ZEROES TO RCD-STP-ITRN IN RCD.
           MOVE ZEROES TO RCD-FEC-FVRF IN RCD.
           MOVE SPACES TO DCE.
           MOVE ZEROES TO DCE-STP-ITRN IN DCE.
           MOVE ZEROES TO DCE-FEC-FCTT IN DCE.
           MOVE ZEROES TO DCE-FEC-FUME IN DCE.
           MOVE ZEROES TO DCE-FEC-FCAD IN DCE.
      *>>>>
           PERFORM RET-ALL-DBE.
      *<<<< CMN_ING
           PERFORM RET-HDR-DBC.
           MOVE 1                    TO DBC-NUM-TDIR IN DBC.
           MOVE 'D'                  TO RCD-MSC-TDIR IN RCD.
           MOVE 'C'                  TO RCD-MSC-SDIR IN RCD.
           MOVE 'E'                  TO DBC-IND-TICL IN DBC.
           MOVE ZEROES               TO DBC-NUM-TCMT IN DBC.
      *GET-CIC Obtener CIC
           MOVE SPACES TO CIC-CAI-ICIC IN CIC.
           MOVE CIC-GET TO CIC-CMND.
           PERFORM PRO-CIC.
           IF CIC-STAT NOT = CIC-STAT-OKS
               MOVE CIC-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.
           MOVE CIC-CIC-ICIC TO DBC-CIC-ICLI IN DBC.
      *ALD
      *    MOVE DBC-IDC-ICLI IN DBC TO DBC-CIC-ICLI IN DBC.
      *>>>>
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
      *<<<< FIN_CMN_ING
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ING.

      *    PERFORM KEY-DCE-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE DBC-STP-ITRN IN DBC TO DCE-STP-ITRN IN DCE.
           PERFORM RET-HDR-DCE.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *    PERFORM KEY-RCD-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE 01                  TO RCD-NUM-DIRE IN RCD.
           MOVE DBC-STP-ITRN IN DBC TO RCD-STP-ITRN IN RCD.
           PERFORM RET-HDR-RCD.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en el ingreso : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ING.
      *ALD/21-JUL-1988
           MOVE DBC-NUM-ICLI IN DBC TO RBS-NUM-RUTS IN RBS.
           MOVE DBC-VRF-ICLI IN DBC TO RBS-VRF-RUTS IN RBS.
           MOVE 'RBS-GLS-ICLS'  TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           IF NOT FIO-STAT-OKS
               MOVE '00' TO FIO-STAT
      *DAD ini  13-MAY-1992
               GO TO EXT-CMN-ING.
      *DAD fin  13-MAY-1992

      * ISP:  2-FEB-1993 FIO-GET-KEY ( LLAVE ALT ) +
      *                  FIO-GET-KEY-UPD ( LLAVE PRINCIPAL )
      *       PARA COMPATIBILDAD VSAM
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           MOVE DBC-STP-ITRN IN DBC TO RBS-STP-ITRN IN RBS.
           MOVE DBC-CIC-ICLI IN DBC TO RBS-CIC-ICLI IN RBS.
           PERFORM RET-HDR-RBS.
           MOVE FIO-MOD        TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           IF NOT FIO-STAT-OKS
               MOVE '00' TO FIO-STAT
      *DAD ini  13-MAY-1992
               GO TO EXT-CMN-ING.
      *DAD fin  13-MAY-1992
      *DAD ini  13-MAY-1992
      *PTC-INI:   20-NOV-2002 14:43:53
           IF SCR-OFRM-SRV
                MOVE PTC-DBC-TYPE TO QUE-TYPE
                MOVE TSK-TERM-ALF TO QUE-TERM
                MOVE PTC-DBC-LENG TO QUE-LITM
                MOVE QUE-PUT      TO QUE-CMND
                MOVE DBC-NUM-ICLI IN DBC TO PTC-DBC-DBC-NUM-ICLI
                MOVE DBC-VRF-ICLI IN DBC TO PTC-DBC-DBC-VRF-ICLI
                MOVE DBC-IND-ICLI IN DBC TO PTC-DBC-DBC-IND-ICLI
                MOVE DBC-GLS-ICLI IN DBC TO PTC-DBC-DBC-GLS-ICLI
                MOVE PTC-DBC-ITEM TO QUE-ITEM
                PERFORM GNS-PRO-QUE.
      *PTC-FIN:    20-NOV-2002 14:44:01
       EXT-CMN-ING.
      *DAD ini  05-JUN-1992
      *     IF SCR-CMND = WSS-CMND-DBE-CCL
      *DAD fin  05-JUN-1992
           IF SCR-CMND = WSS-CMND-DBE-ICD
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CMNDICDING' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *DAD fin  13-MAY-1992
      *
      *LRH ini 18-MAY-1994
           MOVE DBC-CIC-ICLI IN DBC TO DCC-CIC-ICLI IN DCC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM RET-DCC-DBE.
           PERFORM RET-HDR-DCC.
      *LRH ini 10-OCT-1994
           PERFORM LIMPIA-CAMPOS-DCC.
           IF SCR-HDR-MRCA = 'BCS'
               MOVE 'S' TO DCC-IND-MBCS IN DCC.
      *LRH fin 10-OCT-1994
           PERFORM SGC-FIO-DCC.
           IF NOT FIO-STAT-OKS
               MOVE '00' TO FIO-STAT
               GO TO EXT-CMN-ING.
      *LRH fin 18-MAY-1994

           IF SCR-OFRM-SRV
              PERFORM ELI-DIR-PTC.
      *>>>>
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
      *<<<< INI_CMN_ACC
      *LRH ini 20-ABR-1994
           IF SCR-CMND = WSS-CMND-DBE-MVA
               MOVE DBC-CAI-ICLI IN DBE-FLD TO DCE-CAI-ICLI IN DCE
               MOVE DBC-IIC-ICLI IN DBE-FLD TO DCE-IIC-ICLI IN DCE
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-DCE
               PERFORM RET-DCE-DBE
               PERFORM RET-HDR-DCE
               MOVE FIO-MOD TO FIO-CMND
               PERFORM SGC-FIO-DCE
      *LRH ini 18-MAY-1994
               MOVE DBC-CAI-ICLI IN DBE-FLD TO DCC-CAI-ICLI IN DCC
               MOVE DBC-IIC-ICLI IN DBE-FLD TO DCC-IIC-ICLI IN DCC
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-DCC
               IF FIO-STAT-OKS
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM RET-DCC-DBE
                   PERFORM RET-HDR-DCC
      *LRH ini 10-OCT-1994
                   PERFORM LIMPIA-CAMPOS-DCC
      *LRH fin 10-OCT-1994
                   PERFORM SGC-FIO-DCC
      *LRH ini 17-NOV-1994
      *             GO TO FIN-CMN-ACC
      *LRH fin 17-NOV-1994
               ELSE
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM RET-DCC-DBE
                   PERFORM RET-HDR-DCC
      *LRH ini 10-OCT-1994
                   PERFORM LIMPIA-CAMPOS-DCC
      *LRH fin 10-OCT-1994
                   PERFORM SGC-FIO-DCC
      *LRH ini 17-NOV-1994
      *             GO TO FIN-CMN-ACC
      *LRH fin 17-NOV-1994
      *LRH fin 18-MAY-1994
           ELSE
      *LRH fin 20-ABR-1994
           IF SCR-CMND = WSS-CMND-DBE-MIC
               PERFORM KEY-DBC-DBE
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'DBCIDCYAEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
                   NEXT SENTENCE
           ELSE
               IF SCR-CMND = WSS-CMND-DBE-EAP
                   PERFORM CMB-EMP-PRS
      *RJZ 29-DEC-1994 14:54:04
                   PERFORM GRABA-LOG
                   GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM KEY-ALL-DBE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-DBE.
      *<<<< CMN_ACC
           PERFORM RET-HDR-DBC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE 'MODYES    ' TO MSG-COD-MENS
           ELSE
               MOVE 'MODNOT    ' TO MSG-COD-MENS.
           MOVE 'GNS' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
      *LRH ini 24-OCT-1994
           PERFORM VERIFICA-CAMBIOS.
           IF FRM-MENS > SPACES
               GO TO FIN-CMN-ACC.
      *LRH fin 24-OCT-1994
      *DAD ini  29-SEP-1993
           IF SCR-CMND = WSS-CMND-DBE-MIC
               MOVE DBC-CIC-ICLI IN DBC TO RBS-CIC-ICLI IN RBS
               MOVE 'RBS-CIC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-UPD TO FIO-CMND
               PERFORM SGC-FIO-RBS
               IF NOT FIO-STAT-OKS
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-CMN-ACC
               ELSE
                   MOVE DBC-STP-ITRN IN DBC TO RBS-STP-ITRN IN RBS
                   MOVE DBC-NUM-ICLI IN DBC TO RBS-NUM-RUTS IN RBS
                   MOVE DBC-VRF-ICLI IN DBC TO RBS-VRF-RUTS IN RBS
                   PERFORM RET-HDR-RBS
                   MOVE FIO-MOD TO FIO-CMND
                   PERFORM SGC-FIO-RBS
                   IF NOT FIO-STAT-OKS
                       MOVE '00' TO FIO-STAT.
      *DAD fin  29-SEP-1993
      *>>>>
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-DBE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
      *<<<< CMN_ELI
      *<<<< PGM_DOS OR PGM_MVS
      *    Compara codigo ult. modificacion con el que tiene en la COMMON AREA
           IF DBC-STP-ITRN IN DBC NOT = SCR-UMOD
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'UPD    SIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
      *>>>>
      *    PERFORM KEY-DCE-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC
      *        Comunicar que no se pudo eliminar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.

      *    PERFORM KEY-RCD-DBE.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE 01 TO RCD-NUM-DIRE IN RCD.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Como la transaccion Termina no es necesario hacer UNLOCK de
      *        DBC y DCE
      *        Comunicar que no se pudo eliminar con mensaje pertinente
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
      *>>>>
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
      *<<<< FIN_CMN_ELI
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : informar
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.

           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
      *        Error inconsistencia en la eliminacion : hacer LOGTB e informar
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMN-ELI.
      *>>>>
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-DBE.
       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE DBE-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO DBE-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC
      *<<<< PGM_DOS OR PGM_MVS
      *DAD ini  05-JUN-1992 / 13-MAY-1992
      *ISP: BAJO COMANDO ICD Y CCL PERMITE SOLO TECLAS <ENTER> Y <PF11>.
           OR (( SCR-CMND = WSS-CMND-DBE-ICD OR WSS-CMND-DBE-CCL ) AND
      *DAD fin  05-JUN-1992
                NOT ( FRM-FFLD = FRM-FFLD-RET OR
                      FRM-FFLD = FRM-FFLD-PF11   ))
      *DAD fin  13-MAY-1992
      *>>>>
      *>>>>
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF8 OR
                            FRM-FFLD = FRM-FFLD-PF7 ) )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-DBE
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO DBE-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-DBE.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-DBE
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-DBE.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-DBE
               PERFORM EDT-FLD-DBE
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-DBE.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-DBE.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-DBE.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-DBE.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-DBE.
           PERFORM EDT-FLD-DBE.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC
      *<<<< PGM_DOS OR PGM_MVS
      *DAD ini  05-JUN-1992 / 13-MAY-1992
      *ISP: BAJO COMANDO ICD Y CCL PERMITE SOLO TECLAS <ENTER> Y <PF11>.
           OR (( SCR-CMND = WSS-CMND-DBE-ICD OR WSS-CMND-DBE-CCL ) AND
      *DAD fin  05-JUN-1992
                NOT ( FRM-FFLD = FRM-FFLD-RET OR
                      FRM-FFLD = FRM-FFLD-PF11   ))
      *DAD fin  13-MAY-1992
      *>>>>
      *>>>>
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBE-GLS-MEN2
               MOVE SCR-PRMT     TO DBE-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO DBE-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-DBE
               PERFORM VAL-NUM-FLD-DBE.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GIKY OR PFS_SCR_GKEY OR PFS_GET_CON OR PFS_SCR_GFLD OR PFS_GET_ACC
      *<<<< PGM_DOS OR PGM_MVS
      *DAD ini  05-JUN-1992 / 13-MAY-1992
      *ISP: BAJO COMANDO ICD Y CCL PERMITE SOLO TECLAS <ENTER> Y <PF11>.
           OR (( SCR-CMND = WSS-CMND-DBE-ICD OR WSS-CMND-DBE-CCL ) AND
      *DAD fin  05-JUN-1992
                NOT ( FRM-FFLD = FRM-FFLD-RET OR
                      FRM-FFLD = FRM-FFLD-PF11   ))
      *DAD fin  13-MAY-1992
      *>>>>
      *>>>>
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
      *<<<< PFS_GET_CON OR PFS_GET_ACC OR PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBE-GLS-MEN2
               MOVE SCR-PRMT     TO DBE-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO DBE-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO DBE-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *<<<< INI_HBL_IKY
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
      *>>>>
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE DBE-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO DBE-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-DBE

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO DBE-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO DBE-GLS-MENS.
           PERFORM PRO-FLD-DBE.
           PERFORM PRO-MKY-DBE.
           PERFORM UNP-IKY-DBE.
           PERFORM FST-KEY-DBE.
       *<<<< FIN_HBL_IKY
           MOVE '1' TO FRM-CPIM-AEY.
       *>>>>
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE DBE-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO DBE-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO DBE-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO DBE-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-DBE.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-DBE.
           PERFORM FST-KEY-DBE.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM UNP-MKY-DBE.
           PERFORM UNP-FLD-DBE.
           PERFORM FST-FLD-DBE.
      *<<<< FIN_HBL_FLD
      *LRH ini 18-MAY-1994
           COPY USPC143.
           MOVE USP-COD-OFICINA TO SCR-OFI-USP IN SCR-VARI.
       CIC-HBL-FLD.
      *LRH fin 18-MAY-1994
      *DAD ini  13-MAY-1992
           MOVE 'SGC'          TO FIO-SIST.
           MOVE 'VSN'          TO TAB-COD-TTAB IN TAB.
           MOVE 'DBCDCOR  DBE' TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT ( FIO-STAT-OKS AND
                    TAB-MSC-STAT IN TAB = 'S' )
               MOVE FRM-CPIM-AEY TO DBC-NUM-DCOR-ATR IN DBE-FLD
               MOVE ZEROES       TO DBC-NUM-DCOR     IN DBE-FLD
               MOVE 'N'          TO FRM-IND-VERS     IN DBE-FLD
           ELSE
               MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-DCOR IN DBE-FLD
               MOVE 'S'                 TO FRM-IND-VERS IN DBE-FLD
               IF  SCR-CCPP = 'ING' OR
                 ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-ING )
                   MOVE 01 TO DBC-NUM-DCOR IN DBE-FLD.
           IF SCR-CMND = WSS-CMND-DBE-ICD
               PERFORM SET-FRM-ICD.
      *DAD ini  05-JUN-1992
      *     IF SCR-CMND = WSS-CMND-DBE-CCL
      *DAD fin  05-JUN-1992
           IF SCR-CMND = WSS-CMND-DBE-ICD
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CMNDICDFLD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *DAD fin  13-MAY-1992

           IF SCR-CMND = WSS-CMND-DBE-MIC OR WSS-CMND-DBE-MNC OR
              WSS-CMND-DBE-INC OR DBC-IND-ICLI IN DBE-FLD = 'A'
               PERFORM PRO-KEY-DBE
               PERFORM PRO-FLD-DBE.

           IF SCR-CMND = WSS-CMND-DBE-MIC
               PERFORM UNP-IKY-DBE
               MOVE 0  TO DBC-GLS-NOMC-LEN IN DBE-FLD
               MOVE -1 TO DBC-NUM-ICLI-LEN IN DBE-FLD.

           IF SCR-CMND = WSS-CMND-DBE-MNC
               PERFORM UNP-MKY-DBE.

           IF SCR-CMND = WSS-CMND-DBE-INC OR
              DBC-IND-ICLI IN DBE-FLD = 'A'
               PERFORM UNP-MKY-DBE
               MOVE FRM-CPIM-UBY TO DBC-COD-OFIC-ATR IN DBE-FLD
               MOVE FRM-CPIM-UBY TO DBC-COD-TICL-ATR IN DBE-FLD
      *DAD ini  07-JUN-1991
               MOVE FRM-CPIM-UBY TO DCE-GLS-NFAN-ATR IN DBE-FLD
      *DAD fin  07-JUN-1991
               IF DBC-COD-TICL IN DBE-FLD NOT > SPACES
                   MOVE 'NC' TO DBC-COD-TICL IN DBE-FLD.
      *DAD ini  10-FEB-1993   (requerimiento DAP)
           IF SCR-CMND NOT = WSS-CMND-DBE-ICD
      *DAD fin  10-FEB-1993
           IF   SCR-CCPP = 'MOD' OR
              ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD )
               PERFORM PRO-MKY-DBE
               MOVE 0  TO DBC-GLS-NOMC-LEN IN DBE-FLD
               MOVE -1 TO DCE-GLS-NFAN-LEN IN DBE-FLD.

      *DAD ini  05-JUN-1992
           IF SCR-CMND = WSS-CMND-DBE-MNJ
               PERFORM PRO-KEY-DBE
               PERFORM PRO-FLD-DBE
               MOVE FRM-CPIM-UBY TO DCE-COD-TSOC-ATR IN DBE-FLD
               MOVE 0            TO DCE-GLS-NFAN-LEN IN DBE-FLD
               MOVE -1           TO DCE-COD-TSOC-LEN IN DBE-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO DCE-COD-TSOC-ATR IN DBE-FLD.

           IF SCR-CMND = WSS-CMND-DBE-CCL
               MOVE 'CL'         TO DBC-COD-TICL     IN DBE-FLD
               MOVE FRM-CPIM-AEY TO DBC-COD-TICL-ATR IN DBE-FLD.
      *DAD fin  05-JUN-1992

      *LRH ini 20-ABR-1994
           IF DCE-COD-TBAN IN DBE-FLD > SPACES AND
              SCR-CMND NOT = WSS-CMND-DBE-MVA
               MOVE FRM-CPIM-AEY TO DCE-COD-TBAN-ATR IN DBE-FLD.
      *LRH ini 18-MAY-1994
           IF DCC-COD-RCHZ IN DBE-FLD > SPACES AND
              SCR-CMND NOT = WSS-CMND-DBE-MVA
               MOVE FRM-CPIM-AEY TO DCC-COD-RCHZ-ATR IN DBE-FLD.
      *LRH fin 18-MAY-1994
      *LRH ini 17-NOV-1994
           IF DBC-COD-EJEC IN DBE-FLD > SPACES AND
              SCR-CMND NOT = WSS-CMND-DBE-MVA
               MOVE FRM-CPIM-AEY TO DBC-COD-EJEC-ATR IN DBE-FLD.
           IF DBC-COD-OFIC IN DBE-FLD > SPACES AND
              SCR-CMND NOT = WSS-CMND-DBE-MVA
               MOVE FRM-CPIM-AEY TO DBC-COD-OFIC-ATR IN DBE-FLD.
      *LRH fin 17-NOV-1994
           IF SCR-CMND = WSS-CMND-DBE-MVA
               PERFORM PRO-KEY-DBE
               PERFORM PRO-FLD-DBE
               MOVE FRM-CPIM-UBY TO DCE-COD-TBAN-ATR IN DBE-FLD
      *LRH ini 18-MAY-1994
               MOVE FRM-CPIM-UBY TO DCC-COD-RCHZ-ATR IN DBE-FLD
      *LRH fin 18-MAY-1994
      *LRH ini 17-NOV-1994
               MOVE FRM-CPIM-UBY TO DBC-COD-EJEC-ATR IN DBE-FLD
               MOVE FRM-CPIM-UBY TO DBC-COD-OFIC-ATR IN DBE-FLD
      *LRH fin 17-NOV-1994
               MOVE 0            TO DBC-GLS-NOMC-LEN IN DBE-FLD
               MOVE -1           TO DCC-COD-RCHZ-LEN IN DBE-FLD.
      *LRH fin 20-ABR-1994
      *>>>>
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO DBE-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-DBE.
           PERFORM PRO-FLD-DBE.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      * PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-DBE
               PERFORM EDT-FLD-DBE
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-DBE
               PERFORM EDT-FLD-DBE
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-DBE.
           PERFORM EDT-FLD-DBE.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *<<<< INI_PRO_CONF
      *DAD ini  13-MAY-1992
      *DAD ini  05-JUN-1992
      *     IF SCR-CMND = WSS-CMND-DBE-CCL
      *DAD fin  05-JUN-1992
           IF SCR-CMND = WSS-CMND-DBE-ICD
               MOVE 'DAP'        TO MSG-COD-SIST
               MOVE 'CMNDICDCNF' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS.
      *DAD fin  13-MAY-1992
      *>>>>
      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-DBE.
           PERFORM PRO-FLD-DBE.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-DBE
               PERFORM EDT-FLD-DBE.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
      *<<<< PFS_SCR_GCNF
      *<<<< PGM_DOS OR PGM_MVS
      *DAD ini  05-JUN-1992 / 13-MAY-1992
      *ISP: BAJO COMANDO ICD Y CCL PERMITE SOLO TECLAS <ENTER> Y <PF11>..
           OR (( SCR-CMND = WSS-CMND-DBE-ICD OR WSS-CMND-DBE-CCL ) AND
      *DAD fin  05-JUN-1992
                NOT ( FRM-FFLD = FRM-FFLD-RET  OR
                      FRM-FFLD = FRM-FFLD-PF11 OR
                      FRM-FFLD = FRM-FFLD-PF12    ))
      *DAD fin  13-MAY-1992
      *>>>>
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO DBE-GLS-MEN2
               MOVE SCR-CONF     TO DBE-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO DBE-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-DBE
               PERFORM VAL-NUM-FLD-DBE
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-DBE
                   PERFORM VAL-NUM-FLD-DBE
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.


       COPY SGCBUDBE.
       COPY GNSBVNUM.
       COPY SGCBFDBC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBBMSC.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVTDU.
       COPY TABBFUSR.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.
      *>>>>
      *<<<< EOF
      *LRH ini 24-OCT-1994
       VERIFICA-CAMBIOS SECTION.
       INI-VERIFICA-CAMBIOS.
           IF SCR-GLS-NOMC IN SCR-VARI NOT = DBC-GLS-NOMC IN DBE-FLD OR
              SCR-COD-EJEC IN SCR-VARI NOT = DBC-COD-EJEC IN DBE-FLD OR
              SCR-COD-OFIC IN SCR-VARI NOT = DBC-COD-OFIC IN DBE-FLD
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO LOG-NUM-DMOD IN LOG
               MOVE HOY-MHOY TO LOG-NUM-MMOD IN LOG
               MOVE HOY-SHOY TO LOG-NUM-SMOD IN LOG
               MOVE HOY-AHOY TO LOG-NUM-AMOD IN LOG
               MOVE HOY-HHHY TO LOG-NUM-HHMO IN LOG
               MOVE HOY-MMHY TO LOG-NUM-MHMO IN LOG
               MOVE HOY-SSHY TO LOG-NUM-SHMO IN LOG
      *JPA Ini 03-NOV-1994
               MOVE EIBTRMID TO LOG-COD-NTER IN LOG
      *JPA Fin 03-NOV-1994
               MOVE SCR-CMND TO LOG-GLS-CMND IN LOG
               MOVE 'DBC'    TO LOG-GLS-RGTR IN LOG
               MOVE 'DBE'    TO LOG-GLS-PANT IN LOG
               MOVE SPACES   TO LOG-GLS-DISP IN LOG
               MOVE SCR-DBC  TO LOG-GLS-RANT IN LOG
               MOVE DBC      TO LOG-GLS-RNVO IN LOG
               MOVE FIO-OUT  TO FIO-CMND
               PERFORM SGC-FIO-LOG
               IF NOT FIO-STAT-OKS
                   MOVE 'NOLOGOPEN' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM SGC-FIO-LOG
                   IF NOT FIO-STAT-OKS
                       MOVE 'NOLOGGRAB' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       MOVE FIO-CLO TO FIO-CMND
                       PERFORM SGC-FIO-LOG
                       IF NOT FIO-STAT-OKS
                           MOVE 'NOLOGCLOSE' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-VERIFICA-CAMBIOS.
           EXIT.
      *LRH fin 24-OCT-1994
       SET-FRM-ICD SECTION.
       INI-SET-FRM-ICD.
           MOVE FRM-CPIM-AEY TO DBC-COD-TICL-ATR IN DBE-FLD.
           PERFORM UNP-MKY-DBE.
           MOVE -1 TO DBC-GLS-NOMC-LEN IN DBE-FLD.
           PERFORM BUS-SCR-USER.
           IF DBC-COD-TICL IN DBE-FLD NOT > SPACES
                MOVE 'CA' TO DBC-COD-TICL IN DBE-FLD.

           IF DBC-COD-OFIC IN DBE-FLD NOT > SPACES
                MOVE WSS-COD-OFIC TO DBC-COD-OFIC IN DBE-FLD.

           IF DBC-COD-EJEC IN DBE-FLD NOT > SPACES
                MOVE WSS-COD-EJEC TO DBC-COD-EJEC IN DBE-FLD.

           MOVE 'SGC'                   TO FIO-SIST.
           MOVE 'TCL'                   TO TAB-COD-TTAB.
           MOVE DBC-COD-TICL IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
           MOVE TAB-CIC-CTAB IN TAB TO WSS-CIC-TICL.
           IF NOT
               ( WSS-CIC-TICL = 'CA' OR 'CL' OR 'EE' OR 'CO' )
                  MOVE 'CA' TO DBC-COD-TICL IN DBE-FLD.
       FIN-SET-FRM-ICD.
           EXIT.
      *DAD ini  13-MAY-1992
       BUS-SCR-USER SECTION.
       INI-BUS-SCR-USER.
      *<<<< PGM_BCI
      *LRH ini 18-MAY-1994
      *     COPY USPC143.
      *     MOVE USP-COD-OFICINA TO WSS-COD-OFIC IN WSS-VARI
      *                             OFI-COD-OFIC IN OFI.
           MOVE SCR-OFI-USP IN SCR-VARI TO WSS-COD-OFIC IN WSS-VARI
                                           OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-COD-JFOF IN OFI TO WSS-COD-EJEC IN WSS-VARI.
      *>>>>
       FIN-BUS-SCR-USER.
           EXIT.
      *DAD fin  13-MAY-1992
       LLN-REG-DBE SECTION.
       INI-LLN-REG-DBE.
           MOVE SPACES                       TO DCP.
           MOVE ZEROES                       TO DCP-STP-ITRN IN DCP.
           MOVE ZEROES                       TO DCP-FEC-FNAC IN DCP.
           MOVE 'P'                          TO DBC-IND-TICL IN DBC.
           PERFORM GET-FHOY.
           MOVE HOY-DHOY IN HOY-VARI         TO DBC-NUM-DTRN IN DBC.
           MOVE HOY-MHOY IN HOY-VARI         TO DBC-NUM-MTRN IN DBC.
           MOVE HOY-AHOY IN HOY-VARI         TO DBC-NUM-ATRN IN DBC.
           MOVE HOY-SHOY IN HOY-VARI         TO DBC-NUM-STRN IN DBC.
           MOVE HOY-HHOY IN HOY-VARI         TO DBC-HRA-HRTR IN DBC.
           MOVE DBC-GLS-NOMC IN DBE-FLD      TO STR-GLS-GSTR.
           MOVE SPACES                       TO STR-IND-DELI.
           PERFORM STR-UNS.
           MOVE STR-GLS-FUNS IN STR-VARI (1) TO DBC-GLS-APAT IN DBC.
           MOVE STR-GLS-FUNS IN STR-VARI (2) TO DBC-GLS-AMAT IN DBC.
           MOVE STR-GLS-FUNS IN STR-VARI (3) TO WSS-STR-NOM1.
           MOVE STR-GLS-FUNS IN STR-VARI (4) TO WSS-STR-NOM2.
           MOVE WSS-STR-NOMC                 TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN                     TO DBC-GLS-NOMB IN DBC.
       FIN-LLN-REG-DBE.
           EXIT.
       BUS-CLI-EMP SECTION.
       INI-BUS-CLI-EMP.
           MOVE 'NOM' TO SCR-KEY-IDBC.
           MOVE FIO-GET-NLS-ALT TO FIO-CMND.
       LUP-BUS-CLI-EMP.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE SPACES TO FIO-AKEY.
           IF FIO-STAT-OKS AND DBC-IND-TICL IN DBC NOT = 'E'
               MOVE FIO-GET-NXT-ALT TO FIO-CMND
               GO TO LUP-BUS-CLI-EMP.
       FIN-BUS-CLI-EMP.
           EXIT.
       BCK-OUT SECTION.
       INI-BCK-OUT.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
      *         Para informar que el backout se realizo con exito
                MOVE '49' TO FIO-STAT.
       FIN-BCK-OUT.
           EXIT.
      *>>>>
      *<<<< EOF AND PGM_DTC AND PGM_V31
      *DAD ini  07-JUN-1991
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *DAD fin  07-JUN-1991
      *>>>>
      *<<<< EOF
       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.
       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
       LUP-LEE-NXT-PRV-DBC.
           IF SCR-KEY-IDBC = 'NOM'
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
           ELSE
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS AND DBC-IND-TICL NOT = 'E'
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-DBC
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.
       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           MOVE 'NOM' TO SCR-KEY-IDBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-LEE-NXT-PRV-NOM.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS AND DBC-IND-TICL NOT = 'E'
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-PRV TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-NOM
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-LEE-NXT-PRV-NOM.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.
      *LRH ini 10-OCT-1994
       LIMPIA-CAMPOS-DCC SECTION.
       INI-LIMPIA-CAMPOS-DCC.
           IF DCC-NUM-TCHP IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-TCHP.
           IF DCC-NUM-TCHA IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-TCHA.
           IF DCC-IND-PBOL NOT > SPACES
              MOVE SPACES TO DCC-IND-PBOL.
           IF DCC-NUM-UPBC IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-UPBC.
           IF DCC-IND-UTBC NOT > SPACES
              MOVE SPACES TO DCC-IND-UTBC.
           IF DCC-FEC-FIBC IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-FEC-FIBC.
           IF DCC-NUM-TDPH IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-TDPH.
           IF DCC-NUM-TDAH IN DCC IS NOT NUMERIC
               MOVE ZEROES TO DCC-NUM-TDAH.
       FIN-LIMPIA-CAMPOS-DCC.
           EXIT.
      *LRH fin 10-OCT-1994
      *ALD/21-JUL-1988
       COPY SGCBFRBS.
      *LRH ini 18-MAY-1994
       COPY SGCBFDCC.
      *LRH fin 18-MAY-1994
       COPY SGCBFREC.
       COPY SGCBFDCE.
       COPY SGCBFDCP.
       COPY SGCBFRCD.
       COPY TABBVUSR.
      *LRH ini 24-OCT-1994
       COPY SGCBFLOG.
      *LRH fin 24-OCT-1994
      *AFRI-INI 18-DIC-2014 CAMBIO LARGO TELEFONO
      *AFRI-INI/31072013    LARGO NUMERO TELEFONO
      *COPY SGCBGTEL.
      *AFRI-FIN/31072013    LARGO NUMERO TELEFONO
       COPY SGCBGFON.
      *AFRI-FIN 18-DIC-2014 CAMBIO LARGO TELEFONO

      *<<<< NOT PGM_PER
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *>>>>
       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY GNSBEGLS.
       COPY GNSBGPPU.
       COPY GNSBGSTR.
       COPY GNSBGCPT.
       COPY SGCBGPPU.
       COPY SGCBGRCU.
       COPY SGCBGDOM.
       COPY TABBBLOC.
       COPY TABBVLOC.
      *RJZ  29-DEC-1994 14:57:35
       GRABA-LOG SECTION.
       INI-GRABA-LOG.
               IF SCR-IND-TICL IN WSS-VARI = DBC-IND-TICL IN DBC
                  GO TO FIN-GRABA-LOG
               PERFORM GET-FHOY.
               MOVE HOY-DHOY TO LOG-NUM-DMOD IN LOG.
               MOVE HOY-MHOY TO LOG-NUM-MMOD IN LOG.
               MOVE HOY-SHOY TO LOG-NUM-SMOD IN LOG.
               MOVE HOY-AHOY TO LOG-NUM-AMOD IN LOG.
               MOVE HOY-HHHY TO LOG-NUM-HHMO IN LOG.
               MOVE HOY-MMHY TO LOG-NUM-MHMO IN LOG.
               MOVE HOY-SSHY TO LOG-NUM-SHMO IN LOG.
      *JPA Ini 03-NOV-1994
               MOVE EIBTRMID TO LOG-COD-NTER IN LOG.
      *JPA Fin 03-NOV-1994
               MOVE 'EAP' TO LOG-GLS-CMND IN LOG.
               MOVE 'DBC'    TO LOG-GLS-RGTR IN LOG.
               MOVE 'DBE'    TO LOG-GLS-PANT IN LOG.
               MOVE SPACES   TO LOG-GLS-DISP IN LOG.
               MOVE SCR-DBC  TO LOG-GLS-RANT IN LOG.
               MOVE DBC      TO LOG-GLS-RNVO IN LOG.
               MOVE FIO-OUT  TO FIO-CMND.
               PERFORM SGC-FIO-LOG.
               IF NOT FIO-STAT-OKS
                  MOVE 'NOLOGOPEN' TO MSG-COD-MENS
                  PERFORM GET-MSG
                  MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE FIO-PUT TO FIO-CMND
                   PERFORM SGC-FIO-LOG
                   IF NOT FIO-STAT-OKS
                       MOVE 'NOLOGGRAB' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       MOVE FIO-CLO TO FIO-CMND
                       PERFORM SGC-FIO-LOG
                       IF NOT FIO-STAT-OKS
                           MOVE 'NOLOGCLOSE' TO MSG-COD-MENS
                           PERFORM GET-MSG
                           MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-GRABA-LOG.
           EXIT.

      *RJZ  INI 4-JAN-1995 10:17:15
       GRABA-LOGDCE SECTION.
       INI-GRABA-LOGDCE.
           IF SCR-COD-TSOC IN WSS-VARI =DCE-COD-TSOC IN DCE
              GO TO FIN-GRABA-LOGDCE
           PERFORM GET-FHOY.
           MOVE HOY-DHOY TO LOG-NUM-DMOD IN LOG.
           MOVE HOY-MHOY TO LOG-NUM-MMOD IN LOG.
           MOVE HOY-SHOY TO LOG-NUM-SMOD IN LOG.
           MOVE HOY-AHOY TO LOG-NUM-AMOD IN LOG.
           MOVE HOY-HHHY TO LOG-NUM-HHMO IN LOG.
           MOVE HOY-MMHY TO LOG-NUM-MHMO IN LOG.
           MOVE HOY-SSHY TO LOG-NUM-SHMO IN LOG.
      *JPA Ini 03-NOV-1994
           MOVE EIBTRMID TO LOG-COD-NTER IN LOG.
      *JPA Fin 03-NOV-1994
           MOVE 'MNJ'    TO LOG-GLS-CMND IN LOG.
           MOVE 'DCE'    TO LOG-GLS-RGTR IN LOG.
           MOVE 'DBE'    TO LOG-GLS-PANT IN LOG.
           MOVE SPACES   TO LOG-GLS-DISP IN LOG.
           MOVE SCR-DCE  TO LOG-GLS-RANT IN LOG.
           MOVE DCE      TO LOG-GLS-RNVO IN LOG.
           MOVE FIO-OUT  TO FIO-CMND.
           PERFORM SGC-FIO-LOG.
           IF NOT FIO-STAT-OKS
              MOVE 'NOLOGOPEN' TO MSG-COD-MENS
              PERFORM GET-MSG
              MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
              MOVE FIO-PUT TO FIO-CMND
              PERFORM SGC-FIO-LOG
              IF NOT FIO-STAT-OKS
                 MOVE 'NOLOGGRAB' TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO FRM-MENS
              ELSE
                 MOVE FIO-CLO TO FIO-CMND
                 PERFORM SGC-FIO-LOG
                 IF NOT FIO-STAT-OKS
                    MOVE 'NOLOGCLOSE' TO MSG-COD-MENS
                    PERFORM GET-MSG
                    MOVE MSG-GLS-DESC TO FRM-MENS.
       FIN-GRABA-LOGDCE.
           EXIT.
      *>>>>
      *<<<< EOF_PU OR (EOF AND PGM_VMS)
       RET-HDR-DCE SECTION.
       INI-RET-HDR-DCE.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DCE-FEC-FTRN IN DCE.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DCE-HRA-HRTR IN DCE.
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO DCE-COD-OTRN IN DCE
           ELSE
           MOVE SCR-OTRN TO DCE-COD-OTRN IN DCE.
      *    Autor Transaccion
           MOVE SCR-USER TO DCE-COD-ATRN IN DCE.
      *>>>>
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DCE-MSC-TACC IN DCE
               MOVE 'I' TO DCE-MSC-STAT IN DCE
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DCE-MSC-TACC IN DCE
               MOVE 'M' TO DCE-MSC-STAT IN DCE.
       FIN-RET-HDR-DCE.
           EXIT.
      *LRH ini 18-MAY-1994
       RET-HDR-DCC SECTION.
       INI-RET-HDR-DCC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DCC-FEC-FTRN IN DCC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DCC-HRA-HRTR IN DCC.
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO DCC-COD-OTRN IN DCC
           ELSE
           MOVE SCR-OTRN TO DCC-COD-OTRN IN DCC.
      *    Autor Transaccion
           MOVE SCR-USER TO DCC-COD-ATRN IN DCC.
      *>>>>
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DCC-MSC-TACC IN DCC
               MOVE 'I' TO DCC-MSC-STAT IN DCC
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DCC-MSC-TACC IN DCC
               MOVE 'M' TO DCC-MSC-STAT IN DCC.
       FIN-RET-HDR-DCC.
           EXIT.
      *LRH fin 18-MAY-1994
       RET-HDR-RCD SECTION.
       INI-RET-HDR-RCD.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RCD-FEC-FTRN IN RCD.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RCD-HRA-HRTR IN RCD.
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO RCD-COD-OTRN IN RCD
           ELSE
           MOVE SCR-OTRN TO RCD-COD-OTRN IN RCD.
      *    Autor Transaccion
           MOVE SCR-USER TO RCD-COD-ATRN IN RCD.
      *>>>>
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO RCD-MSC-TACC IN RCD
               MOVE 'I' TO RCD-MSC-STAT IN RCD
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO RCD-MSC-TACC IN RCD
               MOVE 'M' TO RCD-MSC-STAT IN RCD.
       FIN-RET-HDR-RCD.
           EXIT.
       RET-HDR-DCP SECTION.
       INI-RET-HDR-DCP.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DCP-FEC-FTRN IN DCP.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DCP-HRA-HRTR IN DCP.
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO DCP-COD-OTRN IN DCP
           ELSE
           MOVE SCR-OTRN TO DCP-COD-OTRN IN DCP.
      *    Autor Transaccion
           MOVE SCR-USER TO DCP-COD-ATRN IN DCP.
      *>>>>
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DCP-MSC-TACC IN DCP
               MOVE 'I' TO DCP-MSC-STAT IN DCP
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DCP-MSC-TACC IN DCP
               MOVE 'M' TO DCP-MSC-STAT IN DCP.
       FIN-RET-HDR-DCP.
           EXIT.
       RET-HDR-RBS SECTION.
       INI-RET-HDR-RBS.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO RBS-FEC-FTRN IN RBS.
      *    Hora Transaccion
           MOVE HOY-HHOY TO RBS-HRA-HRTR IN RBS.
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO RBS-COD-OTRN IN RBS
           ELSE
           MOVE SCR-OTRN TO RBS-COD-OTRN IN RBS.
      *    Autor Transaccion
           MOVE SCR-USER TO RBS-COD-ATRN IN RBS.
      *>>>>
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO RBS-MSC-TACC IN RBS
               MOVE 'I' TO RBS-MSC-STAT IN RBS
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO RBS-MSC-TACC IN RBS
               MOVE 'M' TO RBS-MSC-STAT IN RBS.
       FIN-RET-HDR-RBS.
           EXIT.

       RET-HDR-DBC SECTION.
       INI-RET-HDR-DBC.
           PERFORM GET-FHOY.
      *    Fecha Transaccion
           MOVE HOY-FHOY TO DBC-FEC-FTRN IN DBC.
      *    Hora Transaccion
           MOVE HOY-HHOY TO DBC-HRA-HRTR IN DBC.
      *<<<< NOT PGM_VMS
      *    Codigo Origen transaccion
           IF SCR-OFRM-SRV
              MOVE WSS-COD-TERM TO DBC-COD-OTRN IN DBC
           ELSE
           MOVE SCR-OTRN TO DBC-COD-OTRN IN DBC.
      *    Autor Transaccion
           MOVE SCR-USER TO DBC-COD-ATRN IN DBC.
      *>>>>
           IF SCR-CCPP = 'ING'
               MOVE 'I' TO DBC-MSC-TACC IN DBC
               MOVE 'I' TO DBC-MSC-STAT IN DBC
           ELSE
           IF SCR-CCPP = 'MOD'
               MOVE 'M' TO DBC-MSC-TACC IN DBC
               MOVE 'M' TO DBC-MSC-STAT IN DBC.
       FIN-RET-HDR-DBC.
           EXIT.
      *<<<< NOT PGM_VMS
       VAL-IKY-DBE SECTION.
       INI-VAL-IKY-DBE.
           PERFORM VAL-DBC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-CAI-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IIC-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-IND-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-GLS-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-NUM-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.

           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE -1 TO DBC-VRF-ICLI-LEN IN DBE-FLD
                GO TO FIN-VAL-IKY-DBE.
       FIN-VAL-IKY-DBE.
           EXIT.
       VAL-DBC-CAI-ICLI SECTION.
       INI-VAL-DBC-CAI-ICLI.
       FIN-VAL-DBC-CAI-ICLI.
           EXIT.
       VAL-DBC-IIC-ICLI SECTION.
       INI-VAL-DBC-IIC-ICLI.
       FIN-VAL-DBC-IIC-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN DBE-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN DBE-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN DBE-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN DBE-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.
       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN DBE-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-ICLI IN DBE-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN DBE-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN DBE-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.
       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.
       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN DBE-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN DBE-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN DBE-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN DBE-FLD TO IDC-VRF-RUTV.
      *<<<< INI_DBC_VRF_ICLI
      *DAD ini  13-MAY-1992
           IF ( WSS-CIC-TICL IN WSS-VARI = 'CL' OR 'EE' OR 'CO' OR
                                           'PV' OR 'CA' ) AND
              DBC-VRF-ICLI IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-DBC-VRF-ICLI.
      *DAD fin  13-MAY-1992
      *>>>>
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI
           IF SCR-CMND = WSS-CMND-DBE-MIC AND SCR-INST = SCR-INST-GFL
               PERFORM KEY-DBC-DBE
               MOVE 'DBC-IDC-ICLI' TO FIO-AKEY
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   MOVE 'SGC'        TO MSG-COD-SIST
                   MOVE 'DBCIDCYAEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBC-VRF-ICLI.
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
      *>>>>
       CMB-EMP-PRS SECTION.
       INI-CMB-EMP-PRS.
           PERFORM KEY-DBC-DBE.
      * ISP : LEE POR RUT Y ACTUALIZA POR CIC ==> ERROR VSAM
      *       EL CIC ESTA EN LA PANTALLA
      *     MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'GNS'    TO MSG-COD-SIST
               MOVE 'REGNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMB-EMP-PRS.
      *<<<< PGM_DOS OR PGM_MVS
           IF DBC-STP-ITRN IN DBC NOT = SCR-UMOD
               MOVE 'GNS'          TO MSG-COD-SIST
               MOVE 'UPD    SIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMB-EMP-PRS.
      *>>>>
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMB-EMP-PRS.
           PERFORM LLN-REG-DBE.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE DBC-STP-ITRN IN DBC TO DCP-STP-ITRN IN DCP.
           PERFORM RET-HDR-DCP.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-EMP-PRS.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-EMP-PRS.
      *>>>>
      *ADA-INI JSS 26-FEB-2001
       EFE-CMB-EMP-PRS.
           MOVE DBC-CIC-ICLI IN DBC TO EFE-CIC-ICLI IN EFE.
           MOVE SPACES              TO EFE-FEC-FEFE IN EFE.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF NOT (FIO-STAT-OKS AND
              EFE-CIC-ICLI IN EFE = DBC-CIC-ICLI IN DBC)
               GO TO CON-CMB-EMP-PRS.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'EFENOGKUPD' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-EMP-PRS.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'      TO MSG-COD-SIST
               MOVE 'EFENODEL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM BCK-OUT
               GO TO FIN-CMB-EMP-PRS.
           GO TO EFE-CMB-EMP-PRS.
       CON-CMB-EMP-PRS.
      *ADA-FIN JSS 26-FEB-2001
           PERFORM RET-HDR-DBC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'           TO MSG-COD-SIST
               MOVE 'UPD    ERRDBC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM BCK-OUT.
       FIN-CMB-EMP-PRS.
           EXIT.
       ELI-DIR-PTC SECTION.
       INICIO-ELI-DIR-PTC.
      *RRM-INI 22-NOV-2002
           MOVE NAD-TNAD-COLA TO QUE-COLA.
           MOVE NAD-TNAD-LITM TO QUE-LITM.
           MOVE 1 TO QUE-NITM.
           MOVE QUE-GET TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
               GO TO FIN-ELI-DIR-PTC.

           MOVE 1            TO QUE-NITM.
           MOVE TS-NDEL-LENG TO QUE-LITM.
           MOVE TS-NDEL-TYPE TO QUE-TYPE.
           MOVE QUE-GET      TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT = QUE-STAT-OKS
              MOVE QUE-ITEM TO TS-NDEL-ITEM
              IF TS-NDEL-ITEM = 'S'
                 MOVE QUE-DEL TO QUE-CMND
                 PERFORM GNS-PRO-QUE
                 GO TO FIN-ELI-DIR-PTC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
              MOVE ZEROES TO DBC-NUM-TDIR IN DBC
              MOVE FIO-MOD TO FIO-CMND
              PERFORM SGC-FIO-DBC.
      *RRM-FIN 22-NOV-2002
       INI-ELI-DIR-PTC.
           MOVE DBC-CIC-ICLI IN DBC TO RCD-CIC-ICLI IN RCD.
           MOVE ZEROES TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF FIO-STAT-OKS AND
              DBC-CIC-ICLI IN DBC = RCD-CIC-ICLI IN RCD
              MOVE FIO-GET-KEY-UPD TO FIO-CMND
              PERFORM SGC-FIO-RCD
              IF FIO-STAT-OKS
                 MOVE FIO-DEL TO FIO-CMND
                 PERFORM SGC-FIO-RCD
                 IF FIO-STAT-OKS
                    GO TO INI-ELI-DIR-PTC.
       FIN-ELI-DIR-PTC.
           EXIT.
      *>>>>
      *ADA-INI JSS 26-FEB-2001
       COPY SGCBFEFE.
      *ADA-FIN JSS 26-FEB-2001
