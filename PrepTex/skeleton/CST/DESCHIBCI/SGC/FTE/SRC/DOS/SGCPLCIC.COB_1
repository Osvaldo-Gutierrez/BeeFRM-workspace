       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      SGCPLCIC.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    17-APR-89 20:30 PM.
      * Programa Listador de Reporte CI1 con Sort.
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *MVS SELECT GNSSRT         ASSIGN TO        DA-S-SORTWK1.
           SELECT GNSSRT         ASSIGN TO SYS001-DA-3330-S-SORTWK1.
      *DOS SELECT RPTCI1         ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPTCI1         ASSIGN TO        UT-S-RPTCI1.
           SELECT RPTCI1         ASSIGN TO SYS011-UR-1403-S.
       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       SD  GNSSRT.
       COPY SGCRRCI1.
       FD  RPTCI1 LABEL RECORDS OMITTED
           REPORT IS RPT-CI1
           .
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY SGCBRDBC.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGIFD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY SGCRWCI1.
      *<<<< RW
       COPY SGCRWCI2.
      *>>>>
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT                   VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS            VALUE ' '.
              88 PGM-STAT-SRT-MAL            VALUE 'M'.
           03 PGM-SOKS                       VALUE ' ' PIC X(01).
           03 PGM-SMAL                       VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY GNSWGCPT.
       COPY SGCWGCCT.
       COPY SGCWGMRL.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY GNSWGMES.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY SGCBRRCD.
       COPY SGCBROPE.
       COPY SGCBRRCO.
       COPY SGCBRAEP.
       COPY SGCBREFE.
       COPY SGCBRDSF.
       COPY SGCBRCHP.
       COPY SGCBRPHI.
       COPY GNSBRCMT.
       COPY GNSBRRCE.
       COPY TABBRCAM.
       COPY TABBROFI.
       01  WSS-VARI.
           03 WSS-IDC-ICLI.
              05 WSS-NUM-ICLI                    PIC X(08).
              05 WSS-IND-ICLI                    PIC X(01).
              05 WSS-GLS-ICLI                    PIC X(03).
           03 WSS-VAL-TPAS                       PIC 9(11).
           03 WSS-GLS-IENT.
              05 WSS-KEY-FINF.
                 07 WSS-KEY-SINF                 PIC 9(02).
                 07 WSS-KEY-AINF                 PIC 9(02).
                 07 WSS-KEY-MINF                 PIC 9(02).
                 07 WSS-KEY-DINF                 PIC 9(02).
              05 WSS-KEY-OFIP                    PIC X(03).
              05 WSS-KEY-ICLI                    PIC X(12).
              05 FILLER      VALUE SPACES        PIC X(07).
           03 WSS-COD-OFIP                       PIC X(03).
           03 WSS-FEC-FDSF.
              05 FILLER                          PIC X(02).
              05 WSS-NUM-MDSF                    PIC 9(02).
              05 WSS-NUM-SDSF                    PIC 9(02).
              05 WSS-NUM-ADSF                    PIC 9(02).
           03 WSS-FEC-FINF.
              05 WSS-NUM-DINF                    PIC 9(02).
              05 WSS-NUM-MINF                    PIC 9(02).
              05 WSS-NUM-SINF                    PIC 9(02).
              05 WSS-NUM-AINF                    PIC 9(02).
           03 WSS-FEC-FSOL.
              05 WSS-NUM-DSOL                    PIC 9(02).
              05 WSS-NUM-MSOL                    PIC 9(02).
              05 WSS-NUM-SSOL                    PIC 9(02).
              05 WSS-NUM-ASOL                    PIC 9(02).
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AEP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EFE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DSF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CHP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PHI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CMT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
      *>>>>
       REPORT SECTION.
      *--------------
       COPY SGCRFCI1.
           .
       COPY SGCRTCI1.
      *<<<< RT
       COPY SGCRTCI2.
      *>>>>
       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       END DECLARATIVES.
       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'SGCPLCIC' TO FIO-PROG.
           PERFORM BUS-FSIS.
           SORT GNSSRT
       COPY SGCRSCI1.
           INPUT  PROCEDURE IS INP-SRT
           OUTPUT PROCEDURE IS OUT-SRT.
       FIN-MAIN.
           PERFORM GNS-PRO-END.
       INP-SRT SECTION.
      *---------------
       INI-INP-SRT.
      *<<<< INI_INP
           DISPLAY 'Captura de Parametros'.
           DISPLAY 'Oficina : '.
           ACCEPT  WSS-COD-OFIP IN WSS-VARI.
           DISPLAY WSS-COD-OFIP IN WSS-VARI.
           DISPLAY 'Fecha de Informe ( DDMMSSAA ) : '.
           ACCEPT  WSS-FEC-FINF IN WSS-VARI.
           DISPLAY WSS-FEC-FINF IN WSS-VARI.
           DISPLAY 'Fecha de solicitud de Informe ( DDMMSSAA ) : '.
           ACCEPT  WSS-FEC-FSOL IN WSS-VARI.
           DISPLAY WSS-FEC-FSOL IN WSS-VARI.
           DISPLAY 'Ingrese IDC de Cliente : '.
           ACCEPT  WSS-IDC-ICLI IN WSS-VARI.
           DISPLAY WSS-IDC-ICLI IN WSS-VARI.
           DISPLAY 'Fin Captura de Parametros'.
           DISPLAY 'Inicio validacion de Parametros'.
           MOVE WSS-COD-OFIP IN WSS-VARI TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFII IN WSS-CI2
           ELSE
               DISPLAY MSG-GLS-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'COM' TO TAB-COD-TTAB IN TAB.
           MOVE OFI-COD-COMU TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-LUGA IN WSS-CI1.
           MOVE WSS-FEC-FINF IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE WSS-NUM-DINF IN WSS-VARI TO WSS-NUM-DINF IN WSS-CI1.
           MOVE MES-DMES     IN MES-VARI(WSS-NUM-MINF IN WSS-VARI)
                                         TO WSS-GLS-MINF IN WSS-CI1.
           MOVE WSS-NUM-SINF IN WSS-VARI TO WSS-NUM-SINF IN WSS-CI1.
           MOVE WSS-NUM-AINF IN WSS-VARI TO WSS-NUM-AINF IN WSS-CI1.
           MOVE WSS-FEC-FSOL IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE WSS-NUM-DSOL IN WSS-VARI TO WSS-NUM-DSOL IN WSS-CI1.
           MOVE WSS-NUM-MSOL IN WSS-VARI TO WSS-NUM-MSOL IN WSS-CI1.
           MOVE WSS-NUM-SSOL IN WSS-VARI TO WSS-NUM-SSOL IN WSS-CI1.
           MOVE WSS-NUM-ASOL IN WSS-VARI TO WSS-NUM-ASOL IN WSS-CI1.
           DISPLAY 'Fin validacion de Parametros'.
      *>>>>
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       FST-INP-SRT.
      *<<<< INI_FST_INP
           MOVE WSS-IDC-ICLI IN WSS-VARI TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               GO TO LUP-INP-SRT
           ELSE
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY WSS-IDC-ICLI IN WSS-VARI
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
              GO TO FIN-INP-SRT.
      *<<<< LUP_INP
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *>>>>
       MOV-INP-SRT.
       COPY SGCRMCI1.
           RELEASE SRT.
       NXT-INP-SRT.
      *<<<< INI_NXT_INP
           GO TO FIN-INP-SRT.
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           GO TO LUP-INP-SRT.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       OUT-SRT SECTION.
      *---------------
       INI-OUT-SRT.
           IF PGM-STAT-SRT-MAL
               GO TO EXT-OUT-SRT.
           OPEN OUTPUT RPTCI1.
           CALL 'GNSPLHDR' USING RPT-VARI.
           INITIATE RPT-CI1.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
      *<<<< FST_OUT
           PERFORM BUS-WSS-GLS-MSG.
           GENERATE DL-HCI1.
      *>>>>
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           IF DBC-COD-ACTI IN SRT > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'ACT'               TO TAB-COD-TTAB
               MOVE DBC-COD-ACTI IN SRT TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC TO WSS-GLS-ACTI IN WSS-CI1
           ELSE
               MOVE SPACES TO WSS-GLS-ACTI IN WSS-CI1.
           IF DBC-COD-OFIC IN SRT > SPACES
               MOVE DBC-COD-OFIC IN SRT TO OFI-COD-OFIC
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC TO WSS-GLS-OFIC IN WSS-CI1
           ELSE
               MOVE SPACES TO WSS-GLS-OFIC IN WSS-CI1.
           MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           PERFORM BUS-DOM.
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE '*' TO RCD-GLS-DIRE.
           MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           MOVE DBC-COD-OFIC IN SRT TO DBC-COD-OFIC IN DBC.
           PERFORM BUS-OLD-CCT.
           IF MSG-COD-MENS NOT > SPACES
               IF OPE-COD-MOTT IN OPE > SPACES
                   MOVE 'TAB'               TO TAB-COD-SIST
                   MOVE 'MTO'               TO TAB-COD-TTAB
                   MOVE OPE-COD-MOTT IN OPE TO TAB-COD-CTAB
                   PERFORM BUS-TAB
                   MOVE TAB-GLS-DCOR IN TAB TO WSS-GLS-MOTT IN WSS-CI1
               ELSE
                   MOVE SPACES TO WSS-GLS-MOTT IN WSS-CI1
           ELSE
               MOVE SPACES TO WSS-GLS-MOTT IN WSS-CI1
               MOVE ZEROES TO OPE.
           IF DBC-IND-TICL IN SRT = 'P'
               PERFORM BUS-AEP
           ELSE
               PERFORM BUS-EFE.
      *>>>>
       GEN-OUT-SRT.
           GENERATE DL-CI1.
      *<<<< FIN_GEN_OUT
           GENERATE DL-CI2.
      *>>>>
       NXT-OUT-SRT.
           RETURN GNSSRT AT END
                GO TO FIN-OUT-SRT.
           GO TO LUP-OUT-SRT.
       FIN-OUT-SRT.
           TERMINATE RPT-CI1.
           CLOSE RPTCI1.
       EXT-OUT-SRT.
           EXIT.
       COPY SGCBFDBC.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGEND.
      *<<<< EOF
       BUS-AEP SECTION.
       INI-BUS-AEP.
           MOVE DBC-CIC-ICLI IN SRT TO AEP-CIC-ICLI IN AEP.
           MOVE '99999999'  TO AEP-FEC-FAEP IN AEP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-AEP.
           IF FIO-STAT-OKS  AND
              DBC-CIC-ICLI IN SRT = AEP-CIC-ICLI IN AEP
               MOVE AEP-NUM-DAEP IN AEP TO WSS-NUM-DESB IN WSS-CI1
               MOVE AEP-NUM-MAEP IN AEP TO WSS-NUM-MESB IN WSS-CI1
               MOVE AEP-NUM-SAEP IN AEP TO WSS-NUM-SESB IN WSS-CI1
               MOVE AEP-NUM-AAEP IN AEP TO WSS-NUM-AESB IN WSS-CI1
               MOVE 'SGC'               TO MSC-COD-SIST
               MOVE 'ESBL'              TO MSC-COD-TMSC
               MOVE 'S'                 TO MSC-COD-CMSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-ESOB IN WSS-CI1
               ADD  AEP-VAL-DPZO IN AEP
                    AEP-VAL-ACBO IN AEP
                    AEP-VAL-BIRA IN AEP
                    AEP-VAL-VEHI IN AEP
                    AEP-VAL-ASOC IN AEP
                    AEP-VAL-OACT IN AEP
                                    GIVING WSS-VAL-TACT IN WSS-CI1
               ADD  AEP-VAL-DBYC IN AEP
                    AEP-VAL-DHIP IN AEP
                    AEP-VAL-OPAS IN AEP
                                    GIVING WSS-VAL-TPAS IN WSS-CI1
               SUBTRACT WSS-VAL-TPAS IN WSS-CI1 FROM
                        WSS-VAL-TACT IN WSS-CI1
                                    GIVING WSS-VAL-PATR IN WSS-CI1
               MOVE ZEROES           TO EFE-SGV-UTIL IN EFE
           ELSE
               MOVE 'E SITUACION'  TO WSS-GLS-ESOB IN WSS-CI1.
       FIN-BUS-AEP.
           EXIT.
       BUS-EFE SECTION.
       INI-BUS-EFE.
           MOVE DBC-CIC-ICLI IN SRT TO EFE-CIC-ICLI IN EFE.
           MOVE '99999999'  TO EFE-FEC-FEFE IN EFE.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF FIO-STAT-OKS  AND
              DBC-CIC-ICLI IN SRT = EFE-CIC-ICLI IN EFE
               MOVE EFE-NUM-DEFE IN EFE TO WSS-NUM-DESB IN WSS-CI1
               MOVE EFE-NUM-MEFE IN EFE TO WSS-NUM-MESB IN WSS-CI1
               MOVE EFE-NUM-SEFE IN EFE TO WSS-NUM-SESB IN WSS-CI1
               MOVE EFE-NUM-AEFE IN EFE TO WSS-NUM-AESB IN WSS-CI1
               MOVE 'SGC'               TO MSC-COD-SIST
               MOVE 'ESBL'              TO MSC-COD-TMSC
               MOVE EFE-IND-ESBL IN EFE TO MSC-COD-CMSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR IN MSC TO WSS-GLS-ESOB IN WSS-CI1
               ADD  EFE-VAL-ACIR IN EFE
                    EFE-VAL-AFIJ IN EFE
                    EFE-VAL-OACT IN EFE
                                    GIVING WSS-VAL-TACT IN WSS-CI1
               ADD  EFE-VAL-PCIR IN EFE
                    EFE-VAL-PLPZ IN EFE
                    EFE-SGV-PATR IN EFE
                                    GIVING WSS-VAL-TPAS IN WSS-CI1
               MOVE EFE-SGV-PATR IN EFE TO WSS-VAL-PATR IN WSS-CI1
           ELSE
               MOVE 'BALANCE'    TO WSS-GLS-ESOB IN WSS-CI1.
       FIN-BUS-EFE.
           EXIT.
       BUS-WSS-GLS-MSG SECTION.
       INI-BUS-WSS-GLS-MSG.
           MOVE SPACES TO WSS-GLS-IENT IN WSS-VARI.
           MOVE WSS-NUM-DINF IN WSS-VARI TO WSS-KEY-DINF IN WSS-VARI.
           MOVE WSS-NUM-MINF IN WSS-VARI TO WSS-KEY-MINF IN WSS-VARI.
           MOVE WSS-NUM-SINF IN WSS-VARI TO WSS-KEY-SINF IN WSS-VARI.
           MOVE WSS-NUM-AINF IN WSS-VARI TO WSS-KEY-AINF IN WSS-VARI.
           MOVE WSS-COD-OFIP IN WSS-VARI TO WSS-KEY-OFIP IN WSS-VARI.
           MOVE DBC-CIC-ICLI IN SRT      TO WSS-KEY-ICLI IN WSS-VARI.
           MOVE 'SGC'                    TO RCE-COD-SIST IN RCE.
           MOVE 'CIC'                    TO RCE-COD-ENTI IN RCE.
           MOVE WSS-GLS-IENT IN WSS-VARI TO RCE-GLS-IENT IN RCE.
           MOVE SPACES                   TO RCE-COD-SENT IN RCE.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'RCE-KEY-IENT' TO FIO-AKEY.
           PERFORM GNS-FIO-RCE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE RCE-CIC-IENT IN RCE TO CMT-CIC-IENT IN CMT.
           MOVE SPACES              TO CMT-FEC-FCMT IN CMT.
           MOVE ZEROES              TO CMT-NUM-ICMT IN CMT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT )
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE CMT-GLS-REFE IN CMT TO WSS-GLS-REF1 IN WSS-CI1.
           MOVE CMT-GLS-FILL IN CMT TO WSS-GLS-REF2 IN WSS-CI1.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT )
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE CMT-GLS-CMTR IN CMT(1) TO WSS-GLS-DEST IN WSS-CI1.
           IF CMT-GLS-CMTR IN CMT(2) NOT > SPACES 
               MOVE DBC-CIC-ICLI IN SRT TO MRL-CIC-ICLI IN MRL
               PERFORM CAL-MRL
               IF NOT FIO-STAT-OKS
                   MOVE 'NO DEFINIDA' TO WSS-GLS-MORA IN WSS-CI2
               ELSE
                   IF MRL-IND-PROT IN MRL = 'S'
                       MOVE 'REGISTRA PROTESTO(S) SIN ACLARAR'
                                  TO WSS-GLS-MORA IN WSS-CI2
                   ELSE
                       MOVE 'CUMPLE ' TO WSS-GLS-MORA IN WSS-CI2
           ELSE
               MOVE CMT-GLS-CMTR IN CMT(2) TO WSS-GLS-MORA IN WSS-CI2.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT )
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE CMT-GLS-CMTR IN CMT(1) TO WSS-GLS-OBS1 IN WSS-CI2.
           MOVE CMT-GLS-CMTR IN CMT(2) TO WSS-GLS-OBS2 IN WSS-CI2.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT )
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE CMT-GLS-CMTR IN CMT(1) TO WSS-GLS-OBS3 IN WSS-CI2.
           MOVE CMT-GLS-CMTR IN CMT(2) TO WSS-GLS-OBS4 IN WSS-CI2.
       FIN-BUS-WSS-GLS-MSG.
           EXIT.
       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY SGCBFRCD.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       COPY SGCBFEFE.
       COPY SGCBFAEP.
       COPY SGCBFDSF.
       COPY SGCBFCHP.
       COPY SGCBFPHI.
       COPY GNSBFCMT.
       COPY GNSBFRCE.
       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBGCPT.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY SGCBGCLI.
       COPY SGCBGDOM.
       COPY SGCBGCCT.
       COPY SGCBGMRL.
