000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.    SGCPGES1.
000300*              PROGRAM CONVERTED BY
000400*              COBOL CONVERSION AID PO 5785-ABJ
000500*              CONVERSION DATE 01/19/98 15:59:12.
000600*AUTHOR.        G URETA Q.
000700*DATE-WRITTEN.  24 ABR 1990.
000800*DATE-COMPILED. 22.04.98.
000900
001000*********************************************************
001100*                                                       *
001200* OBJETIVO :   CARGAR LAS OPERACIONES DESDE ARCHIVO     *
001300*              DE MOVTOS. HACIA LA TABLA RCO DEL        *
001400*              SISTEMA GENERAL DE CLIENTES.             *
001500*                                                       *
001600* ARCHIVOS :   MOVRCO : MOVTOS. GENERADOS POR PAREO     *
001700*              RCO    : TABLA RELACION CLTE-OPERACION   *
001800*              TIO    : TABLA TIO                       *
001900*              AUX    : TABLA AUX                       *
002000*********************************************************
002100
002200 ENVIRONMENT DIVISION.
002300 CONFIGURATION SECTION.
002400 SPECIAL-NAMES.
002500               DECIMAL-POINT IS COMMA
002600               C01 IS CANAL-1.
002700
002800 INPUT-OUTPUT SECTION.
002900 FILE-CONTROL.
003000     SELECT MOVRCO   ASSIGN TO MOVRCO
003100                     ORGANIZATION  IS INDEXED
003200                     ACCESS MODE   IS DYNAMIC
003300                     RECORD KEY    IS MRC-CLAVE
003400                     FILE STATUS   IS FS-MOVRCO.
003500
003600 EJECT
003700 DATA DIVISION.
003800 FILE SECTION.
003900 FD  MOVRCO
004000
004100                             .
004200
004300     COPY GESRMRC.
004400
004500/
004600 WORKING-STORAGE SECTION.
004700 01  LCP-TIME-OF-DAY-68            PIC 9(6).
004800 01  LCP-TIME-OF-DAY-74.
004900     05  LCP-TIME-74               PIC 9(6).
005000     05  FILLER                    PIC 9(2).
005100
005200 01  PARAM-ENT.
005300     02 FILLER-ENT           PIC X(07).
005400     02 FECHA-ENT            PIC 9(08).
005500
005600 01  VARIABLES.
005700     03 WS-ERROR             PIC X(02).
005800     03 WS-ERROR-SRI         PIC X(02).
005900     03 WS-EXITO-TIO         PIC X(02).
006000     03 WS-EXITO-AUX         PIC X(02).
006100     03 WS-EXITO-RCO         PIC X(02).
006200     03 FS-MOVRCO            PIC X(02) VALUE '00'.
006300     03 W-CONT-MOVRCO-LEI    PIC 9(08) VALUE ZEROES.
006400     03 W-CONT-MOVRCO-REC    PIC 9(08) VALUE ZEROES.
006500     03 W-CONT-MOVRCO-CON    PIC 9(08) VALUE ZEROES.
006600     03 W-CONT-MOVRCO-CRE    PIC 9(08) VALUE ZEROES.
006700     03 W-CONT-MOVRCO-ELI    PIC 9(08) VALUE ZEROES.
006800     03 W-CONT-MOVRCO-ACT    PIC 9(08) VALUE ZEROES.
006900     03 W-CONT-MOVRCO-DES    PIC 9(08) VALUE ZEROES.
007000     03 W-CONT-MOVRCO-MOD    PIC 9(08) VALUE ZEROES.
007100     03 W-CONT-TIO-LEI       PIC 9(08) VALUE ZEROES.
007200     03 W-CONT-AUX-LEI       PIC 9(08) VALUE ZEROES.
007300     03 W-CONT-RCO-CREADAS   PIC 9(08) VALUE ZEROES.
007400     03 W-CONT-RCO-REGRABA   PIC 9(08) VALUE ZEROES.
007500     03 W-CONT-MOVRCO-REG    PIC 9(08) VALUE ZEROES.
007600     03 W-CONT-ERC           PIC 9(08) VALUE ZEROES.
007700     03 W-CONT-RPC           PIC 9(08) VALUE ZEROES.
007800     03 W-CONT-NER           PIC 9(08) VALUE ZEROES.
007900     03 W-CONT-NEA           PIC 9(08) VALUE ZEROES.
008000     03 W-CONT-NET           PIC 9(08) VALUE ZEROES.
008100     03 W-CONT-SRI           PIC 9(08) VALUE ZEROES.
008200     03 WR-FECHA-HOY.
008300        05 WR-AA-HOY         PIC X(02).
008400        05 WR-MM-HOY         PIC X(02).
008500        05 WR-DD-HOY         PIC X(02).
008600     03 WR-FECHA-HOY-D.
008700        05 WR-DD-HOY-D       PIC X(02).
008800        05 FILLER            PIC X  VALUE '/'.
008900        05 WR-MM-HOY-D       PIC X(02).
009000        05 FILLER            PIC X  VALUE '/'.
009100        05 WR-AA-HOY-D       PIC X(02).
009200     03 WS-FECHA.
009300        05 WS-FEC-SS         PIC 9(02).
009400        05 WS-FEC-AA         PIC 9(02).
009500        05 WS-FEC-MM         PIC 9(02).
009600        05 WS-FEC-DD         PIC 9(02).
009700     03 WS-FECHA-INV.
009800        05 WS-FEC-DD-INV     PIC 9(02).
009900        05 WS-FEC-MM-INV     PIC 9(02).
010000        05 WS-FEC-SS-INV     PIC 9(02).
010100        05 WS-FEC-AA-INV     PIC 9(02).
010200     03 WK-HORA              PIC 9(06).
010300/
010400*-------------------------------------------------------------*
010500*    DEFINICION DE AREAS PARA RUTINA CALENDAR.                *
010600*-------------------------------------------------------------*
010700 01  RTNWCALE.
010800     05 CALEAREA-FUNCION         PIC X(06).
010900     05 CALEAREA-FECHA-1         PIC X(08).
011000     05 R1-CALEAREA-FECHA-1      REDEFINES CALEAREA-FECHA-1.
011100        10 CALEAREA-FECHA-1-D    PIC 9(02).
011200        10 CALEAREA-FECHA-1-M    PIC 9(02).
011300        10 CALEAREA-FECHA-1-A    PIC 9(04).
011400        10 R1-CALEAREA-FECHA-1-A REDEFINES CALEAREA-FECHA-1-A.
011500           15 CALEAREA-FECHA-1-AM PIC 9(02).
011600           15 CALEAREA-FECHA-1-AA PIC 9(02).
011700     05 CALEAREA-FECHA-2         PIC X(08).
011800     05 R1-CALEAREA-FECHA-2      REDEFINES CALEAREA-FECHA-2.
011900        10 CALEAREA-FECHA-2-D    PIC 9(02).
012000        10 CALEAREA-FECHA-2-M    PIC 9(02).
012100        10 CALEAREA-FECHA-2-A    PIC 9(04).
012200        10 R1-CALEAREA-FECHA-2-A REDEFINES CALEAREA-FECHA-2-A.
012300           15 CALEAREA-FECHA-2-AM PIC 9(02).
012400           15 CALEAREA-FECHA-2-AA PIC 9(02).
012500     05 CALEAREA-NUM-DIA         PIC S9(8).
012600     05 CALEAREA-TIP-DIA         PIC X(01).
012700     05 CALEAREA-INI-DIA         PIC X(02).
012800     05 CALEAREA-COD-RET         PIC 9(02).
012900/
013000*------------------------------------------------------------*
013100*                    UIB                                     *
013200*------------------------------------------------------------*
013300
013400 01  UIB.
013500     03  FILLER                  PIC X(32) VALUE 'SGCPGES1'.
013600
013700*------------------------------------------------------------*
013800*                  REQUEST AREA                              *
013900*------------------------------------------------------------*
014000 01  REQ-AREA-RCO00.
014100     03  RCO-COMMAND             PIC X(5).
014200     03  RCO-TABLE               PIC X(3)  VALUE 'RCO'.
014300     03  RCO-KEY                 PIC X(5)  VALUE 'RCO00'.
014400     03  RCO-RET-COD             PIC X(2)  VALUE SPACES.
014500     03  RCO-INT-RC              PIC X(1).
014600     03  RCO-DB-ID               PIC S9(4) COMP VALUE +362.
014700     03  RCO-REC-ID              PIC X(7).
014800     03  FILLER                  PIC X(25).
014900     03  RCO-CONT-MAX            PIC S9(4) COMP.
015000     03  RCO-CONT-IO             PIC S9(4) COMP.
015100     03  FILLER                  PIC X(22).
015200     03  RCO-VALUE.
015300         05 RCO-CIC-ICLI         PIC X(12).
015400         05 RCO-CIC-OPE          PIC X(12).
015500*
015600 01  REQ-AREA-RCO01.
015700     03  RC1-COMMAND             PIC X(5).
015800     03  RC1-TABLE               PIC X(3)  VALUE 'RCO'.
015900     03  RC1-KEY                 PIC X(5)  VALUE 'RCO01'.
016000     03  RC1-RET-COD             PIC X(2)  VALUE SPACES.
016100     03  RC1-INT-RC              PIC X(1).
016200     03  RC1-DB-ID               PIC S9(4) COMP VALUE +362.
016300     03  RC1-REC-ID              PIC X(7).
016400     03  FILLER                  PIC X(25).
016500     03  RC1-CONT-MAX            PIC S9(4) COMP.
016600     03  RC1-CONT-IO             PIC S9(4) COMP.
016700     03  FILLER                  PIC X(22).
016800     03  RC1-VALUE.
016900         05 RC1-CIC-OPE          PIC X(12).
017000*
017100 01  REQ-AREA-TAB.
017200     02 REQ-COMAN-TAB        PIC X(05).
017300     02 REQ-TBLNM-TAB        PIC X(03)  VALUE 'TAB'.
017400     02 REQ-KEYNM-TAB        PIC X(05)  VALUE 'TAB00'.
017500     02 REQ-RTNCD-TAB        PIC X(02)  VALUE SPACES.
017600     02 REQ-INRCD-TAB        PIC X(01).
017700     02 REQ-DBIDE-TAB        PIC S9(4)  COMP VALUE +150.
017800     02 REQ-TBLID-TAB        PIC X(07).
017900     02 FILLER               PIC X(25).
018000     02 REQ-CTMAX-TAB        PIC S9(4)  COMP.
018100     02 REQ-IOCNT-TAB        PIC S9(4)  COMP.
018200     02 FILLER               PIC X(22).
018300     02 REQ-KYVAL-TAB.
018400        03 REQ-COD-TTAB      PIC X(03).
018500        03 REQ-COD-CTAB.
018600           05 REQ-COD-CTAB-1    PIC X(03).
018700           05 REQ-COD-CTAB-2    PIC X(03).
018800           05 REQ-COD-CTAB-3    PIC X(06).
018900*
019000 EJECT
019100*------------------------------------------------------------*
019200*    REGISTRO DE "RELACION CLIENTE OPERACION"
019300*------------------------------------------------------------*
019400 01  WA-RCO.
019500*    COPYDD OPE-R-RCO.OPE-E-RCO00(PROD),1,D
      *                             EQUIVALENTE AL REGISTRO RCO
           02  OPE-E-RCO00.
      *                             RELACION CLIENTE OPERACION
               03  RCO.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RCO-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  RCO-KEY-IREG.
      *                             IDENTIFICACION RELACION CLIENTE OPER
                       05  RCO-KEY-IRCO.
      *                             COD. INT. COMP. CLIENTE
                       06  RCO-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RCO-CAI-ICLI.
                       08  RCO-COD-TCLI
                                    PICTURE X(1).
                       08  RCO-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RCO-IIC-ICLI
                                    PICTURE X(8).
      *                             IDENTIFICACION OPERACION RELACION
                       06  RCO-KEY-IOPE.
      *                             COD. INT. COMP. OPERACION
                       07  RCO-CIC-IOPE.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  RCO-CAI-IOPE.
                       09  RCO-COD-TOPE
                                    PICTURE X(1).
                       09  RCO-COD-COPE
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  RCO-IIC-IOPE.
                       09  RCO-COD-OOPE.
                       10  RCO-COD-SOPE
                                    PICTURE X(2).
                       10  RCO-IND-SOPE
                                    PICTURE X(1).
                       09  RCO-GLS-NOPE
                                    PICTURE X(5).
      *                             TIME STAMP TRANSACCION
                       05  RCO-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RCO-FEC-FTRN.
                       07  RCO-NUM-STRN
                                    PICTURE 9(2).
                       07  RCO-NUM-ATRN
                                    PICTURE 9(2).
                       07  RCO-NUM-MTRN
                                    PICTURE 9(2).
                       07  RCO-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RCO-HRA-HRTR.
                       07  RCO-NUM-HHTR
                                    PICTURE 9(2).
                       07  RCO-NUM-MMTR
                                    PICTURE 9(2).
                       07  RCO-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  RCO-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RCO-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  RCO-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RCO-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RCO-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  RCO-COD-ATRN PICTURE X(12).
      *                             CODIGO STATUS
                   04  RCO-COD-STAT PICTURE X(3).
      *                             COD RELACION CLIENTE OPERACION
                   04  RCO-COD-RCOP PICTURE X(3).
      *                             NUMERO DE DIRECCION
                   04  RCO-NUM-DIRE PICTURE 9(2).
      *                             PORCENTAJE RELACION
                   04  RCO-VAL-PRCO PICTURE 9(3)V9(6)
                                        COMPUTATIONAL.
      *                             CODIGO CLASE OPERACION
                   04  RCO-COD-COPR.
      *                             CODIGO TIPO OPERACION
                       05  RCO-COD-TOPR
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       05  RCO-COD-AOPR
                                    PICTURE X(3).
      *                             FECHA INICIO DE LA RELACION
                   04  OPE-FEC-INI-REL.
      *                             ANO INICIO DE LA RELACION
                       05  OPE-FA-INI-REL
                                    PICTURE X(4).
      *                             MES INICIO DE LA RELACION
                       05  OPE-FM-INI-REL
                                    PICTURE X(2).
      *                             DIA INICIO DE LA RELACION
                       05  OPE-FD-INI-REL
                                    PICTURE X(2).
      *                             FECHA TERMINO DE LA RELACION
                   04  OPE-FEC-TER-REL.
      *                             ANO TERMINO DE LA RELACION
                       05  OPE-FA-TER-REL
                                    PICTURE X(4).
      *                             MES TERMINO DE LA RELACION
                       05  OPE-FM-TER-REL
                                    PICTURE X(2).
      *                             DIA TERMINO DE LA RELACION
                       05  OPE-FD-TER-REL
                                    PICTURE X(2).
                   04  FILLER-1     PICTURE X(20).
019600*Y2K COPY OPERRCOO.
019700*
019800 01  REG-TAB.
019900*    COPYDD TAB-R-TAB.TAB-E-TAB00(PROD),02,D
      *                             EQUIVALENTE AL REGISTRO TAB
           02  TAB-E-TAB00.
      *                             REGISTRO GENERICO DE TABLAS
               04  TAB.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   06  TAB-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   06  TAB-KEY-IREG.
      *                             KEY     TIPO + CODIGO ( LLAVE PRIMAR
                       08  TAB-COD-TABL.
      *                             CODIGO TIPO TABLA
                       10  TAB-COD-TTAB
                                    PICTURE X(3).
      *                             CODIGO TABLA
                       10  TAB-COD-CTAB
                                    PICTURE X(12).
      *                             TIME STAMP TRANSACCION
                       08  TAB-STP-ITRN.
      *                             FECHA TRANSACCION
                       10  TAB-FEC-FTRN.
                       12  TAB-NUM-STRN
                                    PICTURE 9(2).
                       12  TAB-NUM-ATRN
                                    PICTURE 9(2).
                       12  TAB-NUM-MTRN
                                    PICTURE 9(2).
                       12  TAB-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       10  TAB-HRA-HRTR.
                       12  TAB-NUM-HHTR
                                    PICTURE 9(2).
                       12  TAB-NUM-MMTR
                                    PICTURE 9(2).
                       12  TAB-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   06  TAB-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   06  TAB-MSC-STAT PICTURE X(1).
      *                             INDICADOR VIGENCIA
                   06  TAB-IND-VIGE
                             REDEFINES TAB-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   06  TAB-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       08  TAB-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       08  TAB-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   06  TAB-COD-ATRN PICTURE X(12).
      *                             KEY TIPO + CODIGO ( INTERNO COMPUTAC
                   06  TAB-CIC-TABL.
      *                             CODIGO TIPO TABLA
                       08  TAB-CIC-TTAB
                                    PICTURE X(3).
      *                             CODIGO TABLA
                       08  TAB-CIC-CTAB
                                    PICTURE X(12).
      *                             CODIGO EXTERNO
                   06  TAB-EXT-TABL.
      *                             CODIGO TIPO TABLA
                       08  TAB-EXT-TTAB
                                    PICTURE X(3).
      *                             CODIGO TABLA
                       08  TAB-EXT-CTAB
                                    PICTURE X(5).
      *                             DESCRIPCION CORTA
                   06  TAB-GLS-DCOR PICTURE X(12).
      *                             ABREVIACION DESCRIPCION
                   06  TAB-GLS-ABRV PICTURE X(5).
      *                             DESCRIPCION DEL CODIGO
                   06  TAB-GLS-DESC PICTURE X(40).
      *                             DATOS ANEXOS
                   06  TAB-GLS-DATA PICTURE X(60).
      *                             CLAVE SOUNDEX
                   06  TAB-SNX-TABL.
                       08  TAB-SNX-TTAB
                                    PICTURE X(3).
                       08  TAB-SNX-CTAB
                                    PICTURE X(3).
               04  TAB-REDEF REDEFINES TAB
                                    PICTURE X(194).
020000*Y2K COPY TABRTABT.
020100
020200 EJECT
020300*------------------------------------------------------------*
020400*                     ELEMENT LIST                           *
020500*------------------------------------------------------------*
020600
020700 01  ELEM-LIST-RCO.
020800     05    ELEM-1                PIC X(5) VALUE 'RCO00'.
020900     05    ELEM-SEC              PIC X(1).
021000     05    FILLER                PIC X(5) VALUE SPACES.
021100
021200 01  ELM-LIS-TAB.
021300     03 ELEM-TAB             PIC X(05)  VALUE 'TAB00'.
021400     03 ELSE-TAB             PIC X(01).
021500     03 FILLER               PIC X(05)  VALUE SPACES.
021600
021700 EJECT
021800 PROCEDURE DIVISION.
021900*-------------------
022000     ENTRY 'DBMSCBL'.
022100 A-CONTROL SECTION.
022200     PERFORM B-INICIAR.
022300     PERFORM C-PROCESAR.
022400     PERFORM D-TERMINAR.
022500 AZ-FIN-PROG.
022600     GOBACK.
022700
022800 B-INICIAR SECTION.
022900 BA-ABRIR-ARCH.
023000*    OPEN I-O MOVRCO.
023000     OPEN INPUT MOVRCO.
023100     IF FS-MOVRCO NOT = ZEROS AND FS-MOVRCO NOT = 97 AND
023100        FS-MOVRCO NOT = 35
023200        DISPLAY '**************************************'
023300        DISPLAY 'SGCPGES1. ERROR EN APERTURA DE ARCHIVO '
023400        DISPLAY 'SGCPGES1. FILE STATUS :' FS-MOVRCO
023500        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
023600        DISPLAY '**************************************'
023700        MOVE 100                         TO RETURN-CODE
023800        MOVE 'SI'                        TO WS-ERROR
023900        GO TO BZ-FIN-SECCION.
024000
024100 BB-OBTENER-FECHA-HORA.
024200
024300     ACCEPT PARAM-ENT.
024400     IF FECHA-ENT IS NOT NUMERIC
024500        DISPLAY 'SECTION : B-INICIAR'
024600        DISPLAY 'PARRAFO : BB-OBTENER-FECHA-HORA'
024700        DISPLAY 'FECHA-ENT :' FECHA-ENT
024800        DISPLAY '*****************************************'
024900        DISPLAY 'SGCPGES1. FECHA PARAMETRO NO NUMERICA    '
025000        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
025100        DISPLAY '*****************************************'
025200        MOVE 'SI'                        TO WS-ERROR
025300        MOVE 100                         TO RETURN-CODE
025400        GO TO BZ-FIN-SECCION.
025500
025600     IF FECHA-ENT = ZEROES
025700        DISPLAY 'SECTION : B-INICIAR'
025800        DISPLAY 'PARRAFO : BB-OBTENER-FECHA-HORA'
025900        DISPLAY 'FECHA-ENT :' FECHA-ENT
026000        DISPLAY '*****************************************'
026100        DISPLAY 'SGCPGES1. FECHA PARAMETRO = ZEROS        '
026200        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
026300        DISPLAY '*****************************************'
026400        MOVE 'SI'                        TO WS-ERROR
026500        MOVE 100                         TO RETURN-CODE
026600        GO TO BZ-FIN-SECCION.
026700
026800     MOVE 'CARGAR'                       TO CALEAREA-FUNCION.
026900     MOVE ALL '0'                        TO CALEAREA-FECHA-1.
027000     CALL 'RTNUCALE' USING RTNWCALE.
027100     IF CALEAREA-FUNCION = 'CANCEL'
027200        DISPLAY 'SECTION : B-INICIAR'
027300        DISPLAY 'PARRAFO : BB-OBTENER-FECHA-HORA'
027400        DISPLAY 'FECHA-ENT :' FECHA-ENT
027500        DISPLAY '*****************************************'
027600        DISPLAY 'SGCPGES1. ERROR EN CARGA RUTINA FECHA    '
027700        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
027800        DISPLAY '*****************************************'
027900        MOVE 'SI'                        TO WS-ERROR
028000        MOVE 100                         TO RETURN-CODE
028100        GO TO BZ-FIN-SECCION
028200     ELSE
028300        MOVE 'INFO'                      TO CALEAREA-FUNCION
028400        MOVE FECHA-ENT                   TO WS-FECHA-INV
028500        MOVE WS-FEC-SS-INV               TO CALEAREA-FECHA-1-AM
028600        MOVE WS-FEC-AA-INV               TO CALEAREA-FECHA-1-AA
028700        MOVE WS-FEC-MM-INV               TO CALEAREA-FECHA-1-M
028800        MOVE WS-FEC-DD-INV               TO CALEAREA-FECHA-1-D
028900        CALL 'RTNUCALE' USING RTNWCALE
029000        IF CALEAREA-COD-RET = 0
029100           IF CALEAREA-TIP-DIA = 'F'
029200              DISPLAY 'SECTION : B-INICIAR'
029300              DISPLAY 'PARRAFO : BB-OBTENER-FECHA-HORA'
029400              DISPLAY '*****************************************'
029500              DISPLAY 'SGCPGES1. ERROR DIA FESTIVO '
029600              DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
029700              DISPLAY '*****************************************'
029800              MOVE 'SI'                  TO WS-ERROR
029900              MOVE 100                   TO RETURN-CODE
030000              GO TO BZ-FIN-SECCION
030100           ELSE
030200              DISPLAY '** OK. DIA HABIL **'
030300        ELSE
030400           DISPLAY 'SECTION : B-INICIAR'
030500           DISPLAY 'PARRAFO : BB-OBTENER-FECHA-HORA'
030600           DISPLAY '*****************************************'
030700           DISPLAY 'SGCPGES1. ERROR EN CHEQUEO FECHA'
030800           DISPLAY 'SGCPGES1. FECHA = ' FECHA-ENT
030900           DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
031000           DISPLAY '*****************************************'
031100           MOVE 'SI'                     TO WS-ERROR
031200           MOVE 100                      TO RETURN-CODE
031300           GO TO BZ-FIN-SECCION.
031400*
031500     MOVE FECHA-ENT                      TO WS-FECHA-INV.
031600     MOVE WS-FEC-SS-INV                  TO WS-FEC-SS.
031700     MOVE WS-FEC-AA-INV                  TO WS-FEC-AA.
031800     MOVE WS-FEC-MM-INV                  TO WS-FEC-MM.
031900     MOVE WS-FEC-DD-INV                  TO WS-FEC-DD.
032000     ACCEPT LCP-TIME-OF-DAY-74 FROM TIME
032100     MOVE LCP-TIME-74 TO LCP-TIME-OF-DAY-68
032200     MOVE  LCP-TIME-OF-DAY-68 TO WK-HORA.
032300
032400 BC-LEER-REG-MOVRCO.
           IF FS-MOVRCO = 35
033000        DISPLAY ' '
033100        DISPLAY '***********************************'
033200        DISPLAY '           PGM. SGCPGES1            '
033300        DISPLAY '           ------------            '
033400        DISPLAY 'NO HAY REGISTROS PARA ACTUALIZACION'
033500        DISPLAY 'PROCESO TERMINADO NORMALMENTE'
033600        DISPLAY '***********************************'
033700        MOVE 'XX'                      TO WS-ERROR
              GO TO BZ-FIN-SECCION
           END-IF.
032500     READ MOVRCO NEXT.
032600     IF FS-MOVRCO = '00'
032700        ADD  1                           TO W-CONT-MOVRCO-LEI
032800     ELSE
032900       IF FS-MOVRCO = '10'
033000          DISPLAY ' '
033100          DISPLAY '***********************************'
033200          DISPLAY '           PGM. SGCPGES1            '
033300          DISPLAY '           ------------            '
033400          DISPLAY 'NO HAY REGISTROS PARA ACTUALIZACION'
033500          DISPLAY 'PROCESO TERMINADO NORMALMENTE'
033600          DISPLAY '***********************************'
033700          MOVE 'XX'                      TO WS-ERROR
033800        ELSE
033900           DISPLAY '**************************************'
034000           DISPLAY 'SGCPGES1. ERROR EN LEER NEXT MOVRCO    '
034100           DISPLAY 'SGCPGES1. FILE STATUS : ' FS-MOVRCO
034200           DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
034300           DISPLAY '**************************************'
034400           MOVE 'SI'                     TO WS-ERROR
034500           MOVE 100                      TO RETURN-CODE
034600           GO TO CZ-FIN-SECCION.
034700
034800 BZ-FIN-SECCION.
034900     EXIT.
035000
035100/
035200 C-PROCESAR SECTION.
035300 CA-LOOP-PRINC.
035400     IF WS-ERROR = 'SI'
035500        GO TO CA-FIN-SECCION.
035600     PERFORM CB-ACTUAL-RCO UNTIL FS-MOVRCO NOT = '00'
035700                             OR  WS-ERROR = 'SI'.
035800 CA-FIN-SECCION.
035900     EXIT.
036000
036100 CB-ACTUAL-RCO SECTION.
036200
036300     IF MRC-COD-EST-ACT = 'RPC' OR MRC-FEC-FTRN NOT = WS-FECHA
036400        ADD   1                          TO W-CONT-MOVRCO-REC
036500        GO TO CC-LEE-OTRO-MOVTO.
036600
036700     ADD    1                            TO W-CONT-MOVRCO-CON.
036800
036900*>>MOVIMIENTO DE CREACION
037000     IF MRC-COD-OPER = 'C'
037100        ADD   1                          TO W-CONT-MOVRCO-CRE
037200        PERFORM CDA-LEER-RCO00
037300        IF RCO-RET-COD = SPACES
037400           ADD   1                       TO W-CONT-ERC
037500           MOVE 'ERC'                    TO MRC-COD-EST-ACT
037600           PERFORM CE-REGRABAR-MOVRCO
037700        ELSE
037800           PERFORM CI-BUSCAR-TIO
037900           IF WS-EXITO-TIO = 'SI'
038000              PERFORM CJ-BUSCAR-AUX
038100              IF WS-EXITO-AUX = 'SI'
038200                 MOVE MRC-CIC-ICLI       TO RCO-CIC-ICLI IN WA-RCO
038300                 MOVE MRC-CIC-IOPE       TO RCO-CIC-IOPE IN WA-RCO
038400                 MOVE MRC-FEC-FTRN       TO RCO-FEC-FTRN IN WA-RCO
038500                 MOVE MRC-HRA-HTRN       TO RCO-HRA-HRTR IN WA-RCO
038600                 MOVE 'I'                TO RCO-MSC-TACC IN WA-RCO
038700                 MOVE 'A'                TO RCO-MSC-STAT IN WA-RCO
038800                 MOVE 'B'                TO RCO-MSC-TTRN IN WA-RCO
038900                 MOVE '   '              TO RCO-COD-TTRN IN WA-RCO
039000                 MOVE 'SGCPGES1    '     TO RCO-COD-ATRN IN WA-RCO
039100                 MOVE 'VIG'              TO RCO-COD-STAT IN WA-RCO
039200                 MOVE MRC-COD-RCOP       TO RCO-COD-RCOP IN WA-RCO
039300                 MOVE MRC-NUM-DIRE       TO RCO-NUM-DIRE IN WA-RCO
039400                 MOVE MRC-VAL-PRCO       TO RCO-VAL-PRCO IN WA-RCO
039500                 MOVE MRC-COD-TOPR       TO RCO-COD-TOPR IN WA-RCO
039600                 MOVE MRC-COD-AOPR       TO RCO-COD-AOPR IN WA-RCO
039700                 MOVE MRC-FEC-INI-REL    TO
039800                                         OPE-FEC-INI-REL IN WA-RCO
039900                 MOVE MRC-FEC-TER-REL    TO
040000                                         OPE-FEC-TER-REL IN WA-RCO
040100                 PERFORM CG-GRABAR-RCO
040200                 MOVE 'RPC'              TO MRC-COD-EST-ACT
040300                 ADD 1                   TO W-CONT-RPC
040400                 PERFORM CE-REGRABAR-MOVRCO
040500              ELSE
040600                 ADD 1                   TO W-CONT-NEA
040700                 MOVE 'NEA'              TO MRC-COD-EST-ACT
040800                 PERFORM CE-REGRABAR-MOVRCO
040900           ELSE
041000              ADD 1                      TO W-CONT-NET
041100              MOVE 'NET'                 TO MRC-COD-EST-ACT
041200              PERFORM CE-REGRABAR-MOVRCO.
041300
041400*>>MOVIMIENTO DE ELIMINACION
041500     IF MRC-COD-OPER = 'E'
041600        ADD  1                           TO W-CONT-MOVRCO-ELI
041700        IF MRC-CIC-ICLI = ZEROES OR SPACES
041800           PERFORM CBB-ELIM-POR-RCO01
041900        ELSE
042000           PERFORM CBA-ELIM-POR-RCO00.
042100
042200*>>MOVIMIENTO DE DESACTIVACION
042300     IF MRC-COD-OPER = 'D'
042400        ADD  1                           TO W-CONT-MOVRCO-DES
042500        PERFORM CDB-LEER-RCO01
042600        IF RC1-RET-COD = SPACES
042700           MOVE 'NO'                     TO WS-ERROR-SRI
042800           PERFORM CBD-CREA-MOVTO-DES UNTIL
042900                                  RC1-RET-COD NOT = SPACES OR
043000                                  RCO-CIC-IOPE NOT = MRC-CIC-IOPE
043100           PERFORM CL-RELES-RCO01
043200           IF WS-ERROR-SRI = 'NO'
043300              ADD  1                     TO W-CONT-RPC
043400              MOVE 'RPC'                 TO MRC-COD-EST-ACT
043500              PERFORM CE-REGRABAR-MOVRCO
043600           ELSE
043700              ADD  1                     TO W-CONT-SRI
043800              MOVE 'SRI'                 TO MRC-COD-EST-ACT
043900              PERFORM CE-REGRABAR-MOVRCO
044000        ELSE
044100           ADD  1                        TO W-CONT-NER
044200           MOVE 'NER'                    TO MRC-COD-EST-ACT
044300           PERFORM CE-REGRABAR-MOVRCO.
044400
044500*>>MOVIMIENTO DE ACTIVACION
044600     IF MRC-COD-OPER = 'A'
044700        ADD   1                          TO W-CONT-MOVRCO-ACT
044800        PERFORM CDB-LEER-RCO01
044900        IF RC1-RET-COD = SPACES
045000           MOVE 'NO'                     TO WS-ERROR-SRI
045100           PERFORM CBE-CREA-MOVTO-ACT UNTIL
045200                                  RC1-RET-COD NOT = SPACES OR
045300                                  RCO-CIC-IOPE NOT = MRC-CIC-IOPE
045400           PERFORM CL-RELES-RCO01
045500           IF WS-ERROR-SRI = 'NO'
045600              ADD   1                    TO W-CONT-RPC
045700              MOVE 'RPC'                 TO MRC-COD-EST-ACT
045800              PERFORM CE-REGRABAR-MOVRCO
045900           ELSE
046000              ADD   1                    TO W-CONT-SRI
046100              MOVE 'SRI'                 TO MRC-COD-EST-ACT
046200              PERFORM CE-REGRABAR-MOVRCO
046300        ELSE
046400           ADD 1                         TO W-CONT-NER
046500           MOVE 'NER'                    TO MRC-COD-EST-ACT
046600           PERFORM CE-REGRABAR-MOVRCO.
046700
046800*>>MOVIMIENTO DE MODIFICACION
046900     IF MRC-COD-OPER = 'M'
047000        ADD   1                          TO W-CONT-MOVRCO-MOD
047100        IF MRC-CIC-ICLI = ZEROES OR SPACES
047200           PERFORM CBH-MODI-POR-RCO01
047300        ELSE
047400           PERFORM CBG-MODI-POR-RCO00.
047500
047600*>LEE OTRO MOVIMIENTO
047700     GO TO CC-LEE-OTRO-MOVTO.
047800
047900 CBA-ELIM-POR-RCO00.
048000     PERFORM CDC-LEER-RCO00
048100     IF RCO-RET-COD = SPACES
048200        MOVE 'NO'                        TO WS-ERROR-SRI
048300        PERFORM CBF-CREA-MOVTO-ELI
048400        IF WS-ERROR-SRI = 'NO'
048500           ADD  1                        TO W-CONT-RPC
048600           MOVE 'RPC'                    TO MRC-COD-EST-ACT
048700           PERFORM CE-REGRABAR-MOVRCO
048800        ELSE
048900           ADD  1                        TO W-CONT-SRI
049000           MOVE 'SRI'                    TO MRC-COD-EST-ACT
049100           PERFORM CE-REGRABAR-MOVRCO
049200     ELSE
049300        ADD   1                          TO W-CONT-NER
049400        MOVE 'NER'                       TO MRC-COD-EST-ACT
049500        PERFORM CE-REGRABAR-MOVRCO.
049600
049700 CBB-ELIM-POR-RCO01.
049800     PERFORM CDB-LEER-RCO01
049900     IF RC1-RET-COD = SPACES
050000        MOVE 'NO'                        TO WS-ERROR-SRI
050100        PERFORM CBC-CREA-MOVTO-ELI UNTIL
050200                               RC1-RET-COD NOT = SPACES OR
050300                               RCO-CIC-IOPE NOT = MRC-CIC-IOPE
050400        PERFORM CL-RELES-RCO01
050500        IF WS-ERROR-SRI = 'NO'
050600           ADD  1                        TO W-CONT-RPC
050700           MOVE 'RPC'                    TO MRC-COD-EST-ACT
050800           PERFORM CE-REGRABAR-MOVRCO
050900        ELSE
051000           ADD  1                        TO W-CONT-SRI
051100           MOVE 'SRI'                    TO MRC-COD-EST-ACT
051200           PERFORM CE-REGRABAR-MOVRCO
051300     ELSE
051400        ADD  1                           TO W-CONT-NER
051500        MOVE 'NER'                       TO MRC-COD-EST-ACT
051600        PERFORM CE-REGRABAR-MOVRCO.
051700
051800 CBC-CREA-MOVTO-ELI.
051900     IF RCO-COD-STAT NOT = 'ELI'
052000        MOVE MRC-FEC-FTRN                TO RCO-FEC-FTRN IN WA-RCO
052100        MOVE MRC-HRA-HTRN                TO RCO-HRA-HRTR IN WA-RCO
052200        MOVE 'E'                         TO RCO-MSC-TACC IN WA-RCO
052300        MOVE 'E'                         TO RCO-MSC-STAT IN WA-RCO
052400        MOVE 'B'                         TO RCO-MSC-TTRN IN WA-RCO
052500        MOVE '   '                       TO RCO-COD-TTRN IN WA-RCO
052600        MOVE 'SGCPGES1    '              TO RCO-COD-ATRN IN WA-RCO
052700        MOVE 'ELI'                       TO RCO-COD-STAT IN WA-RCO
052800        MOVE MRC-COD-RCOP                TO RCO-COD-RCOP IN WA-RCO
052900        MOVE MRC-VAL-PRCO                TO RCO-VAL-PRCO IN WA-RCO
053000        MOVE MRC-FEC-TER-REL             TO
053100                                         OPE-FEC-TER-REL IN WA-RCO
053200        PERFORM CF-REGRABAR-RCO
053300     ELSE
053400         PERFORM CL-RELES-RCO01
053500         MOVE 'SI'                       TO WS-ERROR-SRI.
053600     PERFORM CH-LEER-SIG-RCO.
053700
053800 CBD-CREA-MOVTO-DES.
053900     IF RCO-COD-STAT NOT = 'DES'
054000        MOVE MRC-FEC-FTRN                TO RCO-FEC-FTRN IN WA-RCO
054100        MOVE MRC-HRA-HTRN                TO RCO-HRA-HRTR IN WA-RCO
054200        MOVE 'M'                         TO RCO-MSC-TACC IN WA-RCO
054300        MOVE 'D'                         TO RCO-MSC-STAT IN WA-RCO
054400        MOVE 'B'                         TO RCO-MSC-TTRN IN WA-RCO
054500        MOVE '   '                       TO RCO-COD-TTRN IN WA-RCO
054600        MOVE 'SGCPGES1    '              TO RCO-COD-ATRN IN WA-RCO
054700        MOVE 'DES'                       TO RCO-COD-STAT IN WA-RCO
054800        PERFORM CF-REGRABAR-RCO
054900     ELSE
055000         PERFORM CL-RELES-RCO01
055100         MOVE 'SI'                       TO WS-ERROR-SRI.
055200     PERFORM CH-LEER-SIG-RCO.
055300
055400 CBE-CREA-MOVTO-ACT.
055500     IF RCO-COD-STAT = 'DES' OR 'ELI'
055600        MOVE MRC-FEC-FTRN                TO RCO-FEC-FTRN IN WA-RCO
055700        MOVE MRC-HRA-HTRN                TO RCO-HRA-HRTR IN WA-RCO
055800        MOVE 'M'                         TO RCO-MSC-TACC IN WA-RCO
055900        MOVE 'A'                         TO RCO-MSC-STAT IN WA-RCO
056000        MOVE 'B'                         TO RCO-MSC-TTRN IN WA-RCO
056100        MOVE '   '                       TO RCO-COD-TTRN IN WA-RCO
056200        MOVE 'SGCPGES1    '              TO RCO-COD-ATRN IN WA-RCO
056300        MOVE 'VIG'                       TO RCO-COD-STAT IN WA-RCO
056400        PERFORM CF-REGRABAR-RCO
056500     ELSE
056600         PERFORM CL-RELES-RCO01
056700         MOVE 'SI'                       TO WS-ERROR-SRI.
056800     PERFORM CH-LEER-SIG-RCO.
056900
057000 CBF-CREA-MOVTO-ELI.
057100     IF RCO-COD-STAT NOT = 'ELI'
057200        MOVE MRC-FEC-FTRN                TO RCO-FEC-FTRN IN WA-RCO
057300        MOVE MRC-HRA-HTRN                TO RCO-HRA-HRTR IN WA-RCO
057400        MOVE 'E'                         TO RCO-MSC-TACC IN WA-RCO
057500        MOVE 'E'                         TO RCO-MSC-STAT IN WA-RCO
057600        MOVE 'B'                         TO RCO-MSC-TTRN IN WA-RCO
057700        MOVE '   '                       TO RCO-COD-TTRN IN WA-RCO
057800        MOVE 'SGCPGES1    '              TO RCO-COD-ATRN IN WA-RCO
057900        MOVE 'ELI'                       TO RCO-COD-STAT IN WA-RCO
058000        MOVE MRC-COD-RCOP                TO RCO-COD-RCOP IN WA-RCO
058100        MOVE MRC-VAL-PRCO                TO RCO-VAL-PRCO IN WA-RCO
058200        MOVE MRC-FEC-TER-REL             TO
058300                                         OPE-FEC-TER-REL IN WA-RCO
058400        PERFORM CF1-REGRABAR-RCO
058500     ELSE
058600         PERFORM CK-RELES-RCO00
058700         MOVE 'SI'                       TO WS-ERROR-SRI.
058800
058900 CBG-MODI-POR-RCO00.
059000     PERFORM CDC-LEER-RCO00
059100     IF RCO-RET-COD = SPACES
059200        MOVE 'NO'                        TO WS-ERROR-SRI
059300        PERFORM CBI-CREA-MOVTO-MOD
059400        IF WS-ERROR-SRI = 'NO'
059500           ADD   1                       TO W-CONT-RPC
059600           MOVE 'RPC'                    TO MRC-COD-EST-ACT
059700           PERFORM CE-REGRABAR-MOVRCO
059800        ELSE
059900           ADD   1                       TO W-CONT-SRI
060000           MOVE 'SRI'                    TO MRC-COD-EST-ACT
060100           PERFORM CE-REGRABAR-MOVRCO
060200     ELSE
060300        ADD  1                           TO W-CONT-NER
060400        MOVE 'NER'                       TO MRC-COD-EST-ACT
060500        PERFORM CE-REGRABAR-MOVRCO.
060600
060700 CBH-MODI-POR-RCO01.
060800     PERFORM CDB-LEER-RCO01
060900     IF RC1-RET-COD = SPACES
061000        MOVE 'NO'                        TO WS-ERROR-SRI
061100        PERFORM CBJ-CREA-MOVTO-MOD UNTIL
061200                               RC1-RET-COD NOT = SPACES OR
061300                               RCO-CIC-IOPE NOT = MRC-CIC-IOPE
061400        PERFORM CL-RELES-RCO01
061500        IF WS-ERROR-SRI = 'NO'
061600           ADD   1                       TO W-CONT-RPC
061700           MOVE 'RPC'                    TO MRC-COD-EST-ACT
061800           PERFORM CE-REGRABAR-MOVRCO
061900        ELSE
062000           ADD   1                       TO W-CONT-SRI
062100           MOVE 'SRI'                    TO MRC-COD-EST-ACT
062200           PERFORM CE-REGRABAR-MOVRCO
062300     ELSE
062400        ADD   1                          TO W-CONT-NER
062500        MOVE 'NER'                       TO MRC-COD-EST-ACT
062600        PERFORM CE-REGRABAR-MOVRCO.
062700
062800 CBI-CREA-MOVTO-MOD.
062900     IF RCO-COD-STAT = 'VIG'
063000        MOVE MRC-FEC-FTRN                TO RCO-FEC-FTRN IN WA-RCO
063100        MOVE MRC-HRA-HTRN                TO RCO-HRA-HRTR IN WA-RCO
063200        MOVE 'SGCPGES1    '              TO RCO-COD-ATRN IN WA-RCO
063300        MOVE MRC-NUM-DIRE                TO RCO-NUM-DIRE IN WA-RCO
063400        MOVE MRC-VAL-PRCO                TO RCO-VAL-PRCO IN WA-RCO
063500        MOVE MRC-COD-TOPR                TO RCO-COD-TOPR IN WA-RCO
063600        MOVE MRC-COD-AOPR                TO RCO-COD-AOPR IN WA-RCO
063700        PERFORM CF1-REGRABAR-RCO
063800     ELSE
063900         PERFORM CK-RELES-RCO00
064000         MOVE 'SI'                       TO WS-ERROR-SRI.
064100
064200 CBJ-CREA-MOVTO-MOD.
064300     IF RCO-COD-STAT NOT = 'VIG'
064400        MOVE MRC-FEC-FTRN                TO RCO-FEC-FTRN IN WA-RCO
064500        MOVE MRC-HRA-HTRN                TO RCO-HRA-HRTR IN WA-RCO
064600        MOVE 'SGCPGES1    '              TO RCO-COD-ATRN IN WA-RCO
064700        MOVE MRC-NUM-DIRE                TO RCO-NUM-DIRE IN WA-RCO
064800        MOVE MRC-VAL-PRCO                TO RCO-VAL-PRCO IN WA-RCO
064900        MOVE MRC-COD-TOPR                TO RCO-COD-TOPR IN WA-RCO
065000        MOVE MRC-COD-AOPR                TO RCO-COD-AOPR IN WA-RCO
065100        PERFORM CF-REGRABAR-RCO
065200     ELSE
065300         PERFORM CL-RELES-RCO01
065400         MOVE 'SI'                       TO WS-ERROR-SRI.
065500     PERFORM CH-LEER-SIG-RCO.
065600
065700 CC-LEE-OTRO-MOVTO.
065800     READ MOVRCO NEXT.
065900     IF FS-MOVRCO = '00'
066000        ADD  1                           TO W-CONT-MOVRCO-LEI
066100     ELSE
066200       IF FS-MOVRCO = '10'
066300          NEXT SENTENCE
066400        ELSE
066500           DISPLAY '**************************************'
066600           DISPLAY 'SGCPGES1. ERROR EN LEER NEXT MOVRCO    '
066700           DISPLAY 'SGCPGES1. FILE STATUS : ' FS-MOVRCO
066800           DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
066900           DISPLAY '**************************************'
067000           MOVE 'SI'                     TO WS-ERROR
067100           MOVE 100                      TO RETURN-CODE
067200           GO TO CZ-FIN-SECCION.
067300
067400     GO TO CZ-FIN-SECCION.
067500
067600 CDA-LEER-RCO00.
067700     MOVE MRC-CIC-ICLI                   TO RCO-CIC-ICLI
067800                                         IN REQ-AREA-RCO00.
067900     MOVE MRC-CIC-IOPE                   TO RCO-CIC-OPE
068000                                         IN REQ-AREA-RCO00.
068100     MOVE 'REDKY'                        TO RCO-COMMAND.
068200     MOVE 'RCO'                          TO RCO-TABLE.
068300     MOVE 'RCO00'                        TO RCO-KEY.
068400     MOVE '  '                           TO RCO-RET-COD.
068500     MOVE +362                           TO RCO-DB-ID.
068600     MOVE 'RCO00'                        TO ELEM-1.
068700     CALL 'DBNTRY'  USING UIB
068800                          REQ-AREA-RCO00
068900                          WA-RCO
069000                          ELEM-LIST-RCO.
069100     IF RCO-RET-COD = SPACES OR '14'
069200        NEXT SENTENCE
069300     ELSE
069400        DISPLAY '**************************************'
069500        DISPLAY 'SGCPGES1. ERROR AL REDKY  TABLA RCO  '
069600        DISPLAY 'SGCPGES1. CODIGO RETORNO : ' RCO-RET-COD
069700        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
069800        DISPLAY '**************************************'
069900        MOVE 'SI'                        TO WS-ERROR
070000        MOVE 100                         TO RETURN-CODE
070100        GO TO CZ-FIN-SECCION.
070200
070300 CDB-LEER-RCO01.
070400     MOVE MRC-CIC-IOPE                   TO RC1-CIC-OPE.
070500     MOVE 'RDUKY'                        TO RC1-COMMAND.
070600     MOVE 'RCO'                          TO RC1-TABLE.
070700     MOVE 'RCO01'                        TO RC1-KEY.
070800     MOVE '  '                           TO RC1-RET-COD.
070900     MOVE +362                           TO RC1-DB-ID.
071000     MOVE 'RCO00'                        TO ELEM-1.
071100     CALL 'DBNTRY'  USING UIB
071200                          REQ-AREA-RCO01
071300                          WA-RCO
071400                          ELEM-LIST-RCO.
071500     IF RC1-RET-COD = SPACES
071600        NEXT SENTENCE
071700     ELSE
071800        IF RC1-RET-COD = '14'
071900           DISPLAY 'MRC-CIC-IOPE :' MRC-CIC-IOPE
072000        ELSE
072100           DISPLAY '**************************************'
072200           DISPLAY 'SGCPGES1. ERROR AL RDUKY  TABLA RCO  '
072300           DISPLAY 'SGCPGES1. CODIGO RETORNO : ' RC1-RET-COD
072400           DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
072500           DISPLAY '**************************************'
072600           MOVE 'SI'                     TO WS-ERROR
072700           MOVE 100                      TO RETURN-CODE
072800           GO TO CZ-FIN-SECCION.
072900
073000 CDC-LEER-RCO00.
073100     MOVE MRC-CIC-ICLI                   TO RCO-CIC-ICLI
073200                                         IN REQ-AREA-RCO00.
073300     MOVE MRC-CIC-IOPE                   TO RCO-CIC-OPE
073400                                         IN REQ-AREA-RCO00.
073500     MOVE 'RDUKY'                        TO RCO-COMMAND.
073600     MOVE 'RCO'                          TO RCO-TABLE.
073700     MOVE 'RCO00'                        TO RCO-KEY.
073800     MOVE '  '                           TO RCO-RET-COD.
073900     MOVE +362                           TO RCO-DB-ID.
074000     MOVE 'RCO00'                        TO ELEM-1.
074100     CALL 'DBNTRY'  USING UIB
074200                          REQ-AREA-RCO00
074300                          WA-RCO
074400                          ELEM-LIST-RCO.
074500     IF RCO-RET-COD = SPACES
074600        NEXT SENTENCE
074700     ELSE
074800        IF RCO-RET-COD = '14'
074900           DISPLAY 'MRC-CIC-ICLI :'  MRC-CIC-ICLI '  '
075000                   'MRC-CIC-IOPE :'  MRC-CIC-IOPE '  '
075100        ELSE
075200           DISPLAY '**************************************'
075300           DISPLAY 'SGCPGES1. ERROR AL RDUKY  TABLA RCO  '
075400           DISPLAY 'SGCPGES1. CODIGO RETORNO : ' RCO-RET-COD
075500           DISPLAY 'SGCPGES1.   PROGRAMA CANCELADO'
075600           DISPLAY '**************************************'
075700           MOVE 'SI'                     TO WS-ERROR
075800           MOVE 100                      TO RETURN-CODE
075900           GO TO CZ-FIN-SECCION.
076000
076100 CE-REGRABAR-MOVRCO.
076200     REWRITE GESRMRC INVALID KEY
076300             DISPLAY '***************************************'
076400             DISPLAY 'SGCPGES1.  NO PUEDE REGRABAR MOVRCO: '
076500             DISPLAY 'SGCPGES1. ' GESRMRC
076600             DISPLAY ' '
076700             MOVE 'SI'                   TO WS-ERROR
076800             MOVE 100                    TO RETURN-CODE
076900             GO TO CZ-FIN-SECCION.
077000     ADD 1                               TO W-CONT-MOVRCO-REG.
077100
077200 CF-REGRABAR-RCO.
077300     MOVE 'UPDAT'                        TO RC1-COMMAND.
077400     MOVE 'RCO'                          TO RC1-TABLE.
077500     MOVE 'RCO01'                        TO RC1-KEY.
077600     MOVE '  '                           TO RC1-RET-COD.
077700     MOVE +362                           TO RC1-DB-ID.
077800     MOVE 'RCO00'                        TO ELEM-1.
077900     CALL 'DBNTRY'  USING UIB
078000                          REQ-AREA-RCO01
078100                          WA-RCO
078200                          ELEM-LIST-RCO.
078300
078400     IF RC1-RET-COD NOT = SPACES
078500        DISPLAY '**************************************'
078600        DISPLAY 'RELACION CLIENTE : ' RCO-CIC-ICLI IN WA-RCO
078700        DISPLAY '         OPERAC. : ' RCO-CIC-IOPE IN WA-RCO
078800        DISPLAY 'SGCPGES1. ERROR EN REGRABAR TABLA RCO  '
078900        DISPLAY 'SGCPGES1. CODIGO RETORNO : ' RC1-RET-COD
079000        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
079100        DISPLAY '**************************************'
079200        MOVE 'SI'                        TO WS-ERROR
079300        MOVE 100                         TO RETURN-CODE
079400        GO TO CZ-FIN-SECCION.
079500     ADD   1                             TO W-CONT-RCO-REGRABA.
079600
079700 CF1-REGRABAR-RCO.
079800     MOVE 'UPDAT'                       TO RCO-COMMAND.
079900     MOVE 'RCO'                         TO RCO-TABLE.
080000     MOVE 'RCO00'                       TO RCO-KEY.
080100     MOVE '  '                          TO RCO-RET-COD.
080200     MOVE +362                          TO RCO-DB-ID.
080300     MOVE 'RCO00'                       TO ELEM-1.
080400     CALL 'DBNTRY'  USING UIB
080500                          REQ-AREA-RCO00
080600                          WA-RCO
080700                          ELEM-LIST-RCO.
080800
080900     IF RCO-RET-COD NOT = SPACES
081000        DISPLAY '**************************************'
081100        DISPLAY 'RELACION CLIENTE : ' RCO-CIC-ICLI IN WA-RCO
081200        DISPLAY '         OPERAC. : ' RCO-CIC-IOPE IN WA-RCO
081300        DISPLAY 'SGCPGES1. ERROR EN REGRABAR TABLA RCO  '
081400        DISPLAY 'SGCPGES1. CODIGO RETORNO : ' RCO-RET-COD
081500        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
081600        DISPLAY '**************************************'
081700        MOVE 'SI'                        TO WS-ERROR
081800        MOVE 100                         TO RETURN-CODE
081900        GO TO CZ-FIN-SECCION.
082000     ADD   1                             TO W-CONT-RCO-REGRABA.
082100
082200 CG-GRABAR-RCO.
082300     MOVE 'ADDIT'                        TO RCO-COMMAND.
082400     MOVE 'RCO'                          TO RCO-TABLE.
082500     MOVE 'RCO00'                        TO RCO-KEY.
082600     MOVE '  '                           TO RCO-RET-COD.
082700     MOVE +362                           TO RCO-DB-ID.
082800     MOVE 'RCO00'                        TO ELEM-1.
082900     CALL 'DBNTRY'  USING UIB
083000                          REQ-AREA-RCO00
083100                          WA-RCO
083200                          ELEM-LIST-RCO.
083300
083400     IF RCO-RET-COD NOT = SPACES AND RCO-RET-COD NOT = '10'
083500        DISPLAY '**************************************'
083600        DISPLAY 'SGCPGES1. ERROR AL GRABAR TABLA RCO  '
083700        DISPLAY 'SGCPGES1. CODIGO RETORNO : ' RCO-RET-COD
083800        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
083900        DISPLAY '**************************************'
084000        MOVE 'SI'                        TO WS-ERROR
084100        MOVE 100                         TO RETURN-CODE
084200        GO TO CZ-FIN-SECCION
084300     ELSE
084400        IF RCO-RET-COD = '10'
084500           DISPLAY 'RELACION CLIENTE : ' RCO-CIC-ICLI IN WA-RCO
084600           DISPLAY '         OPERAC. : ' RCO-CIC-IOPE IN WA-RCO
084700           DISPLAY 'YA EXISTE EN TABLA RCO'
084800           DISPLAY ' '
084900        ELSE
085000           ADD    1                      TO  W-CONT-RCO-CREADAS.
085100
085200 CH-LEER-SIG-RCO.
085300     MOVE 'RDUNX'                        TO RC1-COMMAND.
085400     MOVE 'RCO'                          TO RC1-TABLE.
085500     MOVE 'RCO01'                        TO RC1-KEY.
085600     MOVE '  '                           TO RC1-RET-COD.
085700     MOVE +362                           TO RC1-DB-ID.
085800     MOVE 'RCO00'                        TO ELEM-1.
085900     CALL 'DBNTRY'  USING UIB
086000                          REQ-AREA-RCO01
086100                          WA-RCO
086200                          ELEM-LIST-RCO.
086300     IF RC1-RET-COD = '  ' OR '14'
086400        NEXT SENTENCE
086500     ELSE
086600        DISPLAY '**************************************'
086700        DISPLAY 'SGCPGES1. ERROR AL RDUNX  TABLA RCO  '
086800        DISPLAY 'SGCPGES1. CODIGO RETORNO : ' RC1-RET-COD
086900        DISPLAY 'SGCPGES1.   PROGRAMA CANCELADO'
087000        DISPLAY '**************************************'
087100        MOVE 'SI'                        TO WS-ERROR
087200        MOVE 100                         TO RETURN-CODE
087300        GO TO CZ-FIN-SECCION.
087400
087500 CI-BUSCAR-TIO.
087600*--------------
087700     MOVE 'REDKY'                        TO REQ-COMAN-TAB.
087800     MOVE 'TIO'                          TO REQ-COD-TTAB.
087900     MOVE SPACES                         TO REQ-COD-CTAB.
088000     MOVE MRC-COD-TOPR                   TO REQ-COD-CTAB.
088100     CALL 'DBNTRY' USING UIB REQ-AREA-TAB REG-TAB ELM-LIS-TAB.
088200     IF REQ-RTNCD-TAB NOT = SPACES AND REQ-RTNCD-TAB NOT = '14'
088300        DISPLAY '**************************************'
088400        DISPLAY 'SGCPGES1. ERROR EN LEER KEY TABLA TIO  '
088500        DISPLAY 'SGCPGES1. COD. RETORNO ' REQ-RTNCD-TAB
088600        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
088700        DISPLAY '**************************************'
088800        MOVE 'SI'                        TO WS-ERROR
088900        MOVE 100                         TO RETURN-CODE
089000        GO TO CZ-FIN-SECCION
089100     ELSE
089200        IF REQ-RTNCD-TAB = '14'
089300           MOVE 'NO'                     TO WS-EXITO-TIO
089400        ELSE
089500           ADD   1                       TO W-CONT-TIO-LEI
089600           MOVE 'SI'                     TO WS-EXITO-TIO.
089700
089800 CJ-BUSCAR-AUX.
089900*--------------
090000     MOVE 'REDKY'                        TO REQ-COMAN-TAB.
090100     MOVE 'AUX'                          TO REQ-COD-TTAB.
090200     MOVE SPACES                         TO REQ-COD-CTAB.
090300     MOVE MRC-COD-TOPR                   TO REQ-COD-CTAB-1.
090400     MOVE MRC-COD-AOPR                   TO REQ-COD-CTAB-2.
090500     CALL 'DBNTRY' USING UIB REQ-AREA-TAB REG-TAB ELM-LIS-TAB.
090600     IF REQ-RTNCD-TAB NOT = SPACES AND REQ-RTNCD-TAB NOT = '14'
090700        DISPLAY '**************************************'
090800        DISPLAY 'SGCPGES1. ERROR EN LEER KEY TABLA AUX  '
090900        DISPLAY 'SGCPGES1. COD. RETORNO ' REQ-RTNCD-TAB
091000        DISPLAY 'SGCPGES1. PROGRAMA CANCELADO'
091100        DISPLAY '**************************************'
091200        MOVE 'SI'                        TO WS-ERROR
091300        MOVE 100                         TO RETURN-CODE
091400        GO TO CZ-FIN-SECCION
091500     ELSE
091600        IF REQ-RTNCD-TAB = '14'
091700           MOVE 'NO'                     TO WS-EXITO-AUX
091800        ELSE
091900           ADD  1                        TO W-CONT-AUX-LEI
092000           MOVE 'SI'                     TO WS-EXITO-AUX.
092100
092200 CK-RELES-RCO00.
092300     MOVE 'RELES'                        TO RCO-COMMAND.
092400     MOVE 'RCO'                          TO RCO-TABLE.
092500     MOVE 'RCO00'                        TO RCO-KEY.
092600     MOVE '  '                           TO RCO-RET-COD.
092700     MOVE +362                           TO RCO-DB-ID.
092800     MOVE 'RCO00'                        TO ELEM-1.
092900     CALL 'DBNTRY'  USING UIB
093000                          REQ-AREA-RCO00
093100                          WA-RCO
093200                          ELEM-LIST-RCO.
093300
093400 CL-RELES-RCO01.
093500     MOVE 'RELES'                        TO RC1-COMMAND.
093600     MOVE 'RCO'                          TO RC1-TABLE.
093700     MOVE 'RCO01'                        TO RC1-KEY.
093800     MOVE '  '                           TO RC1-RET-COD.
093900     MOVE +362                           TO RC1-DB-ID.
094000     MOVE 'RCO00'                        TO ELEM-1.
094100     CALL 'DBNTRY'  USING UIB
094200                          REQ-AREA-RCO01
094300                          WA-RCO
094400                          ELEM-LIST-RCO.
094500 CZ-FIN-SECCION.
094600     EXIT.
094700/
094800 D-TERMINAR SECTION.
094900 DA-ESTADISTICAS.
095000     ACCEPT WR-FECHA-HOY FROM DATE
095100     MOVE WR-DD-HOY                      TO WR-DD-HOY-D
095200     MOVE WR-MM-HOY                      TO WR-MM-HOY-D
095300     MOVE WR-AA-HOY                      TO WR-AA-HOY-D
095400     DISPLAY ' '
095500     DISPLAY ' '
095600     DISPLAY 'ESTADISTICA DE PROCESO PROGRAMA SGCPGES1 FECHA '
095700             WR-FECHA-HOY-D
095800     DISPLAY
095900         '-------------------------------------------------------'
096000     DISPLAY '         ACTUALIZADOR TABLA RCO 362'
096100     DISPLAY ' '
096200     DISPLAY 'REG.MOVRCO LEIDOS.............: ' W-CONT-MOVRCO-LEI
096300     DISPLAY 'REG.MOVRCO RECHAZADOS.........: ' W-CONT-MOVRCO-REC
096400     DISPLAY 'REG.MOVRCO CONSIDERADOS.......: ' W-CONT-MOVRCO-CON
096500     DISPLAY '    CREACIONES................: ' W-CONT-MOVRCO-CRE
096600     DISPLAY '    ELIMINACIONES.............: ' W-CONT-MOVRCO-ELI
096700     DISPLAY '    ACTIVACIONES..............: ' W-CONT-MOVRCO-ACT
096800     DISPLAY '    DESACTIVACIONES...........: ' W-CONT-MOVRCO-DES
096900     DISPLAY '    MODIFICACIONES............: ' W-CONT-MOVRCO-MOD
097000     DISPLAY 'REG.LEIDOS    TABLA TIO.......: ' W-CONT-TIO-LEI
097100     DISPLAY 'REG.LEIDOS    TABLA AUX.......: ' W-CONT-AUX-LEI
097200     DISPLAY 'REG.CREADOS   TABLA RCO.......: ' W-CONT-RCO-CREADAS
097300     DISPLAY 'REG.REGRABAD. TABLA RCO.......: ' W-CONT-RCO-REGRABA
097400     DISPLAY 'REG.REGRABAD. MOVRCO..........: ' W-CONT-MOVRCO-REG
097500     DISPLAY '    ERC.......................: ' W-CONT-ERC
097600     DISPLAY '    RPC.......................: ' W-CONT-RPC
097700     DISPLAY '    NEA.......................: ' W-CONT-NEA
097800     DISPLAY '    NET.......................: ' W-CONT-NET
097900     DISPLAY '    NER.......................: ' W-CONT-NER
098000     DISPLAY '    SRI.......................: ' W-CONT-SRI
098100     DISPLAY ' '
098200     DISPLAY ' '
098300     DISPLAY 'TARJETAS DE PARAMETROS'
098400     DISPLAY '----------------------'
098500     DISPLAY ' '
098600     DISPLAY 'WS-FECHA :' WS-FECHA
098700     DISPLAY ' '
098800     DISPLAY ' '.
098900
099000 DB-CIERRA-ARCHS.
099100     CLOSE MOVRCO.
099200     IF WS-ERROR = 'SI'
099300        DISPLAY ' '
099400        DISPLAY ' '
099500        DISPLAY '********************************************'
099600        DISPLAY '********************************************'
099700        DISPLAY '******* TERMINO ERRONEO DE PROCESO *********'
099800        DISPLAY '********************************************'
099900        DISPLAY '********************************************'
100000     ELSE
100100        DISPLAY '  '
100200        DISPLAY '  '
100300        DISPLAY '******PROCESO TERMINO EN FORMA NORMAL ******'
100400        DISPLAY '  '.
100500
100600 DZ-FIN-SECCION.
100700     EXIT.
100800
100900 ZZ-PSLM.
101000     GOBACK.
101100 END PROGRAM SGCPGES1.

