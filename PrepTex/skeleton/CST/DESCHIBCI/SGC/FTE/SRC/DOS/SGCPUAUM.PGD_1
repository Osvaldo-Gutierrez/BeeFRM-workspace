       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   SGCPUAUM.
       AUTHOR.       BEE-TEAM.
       DATE-WRITTEN. 08-May-19 11:35 AM.

      * NOMBRE PROGRAMA                   SGCPUAUM
      * VERSION PGM                       3.1
      * VERSION SKL                       08.07.21
      * OPCION                            UPD
      * ARCHIVO BASE                      SGCDBC
      * PANTALLA                          SGCAUM
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *<<<<
      *--------------------------------------------------------------   
      *  MODIFICACIONES:
      *  ---------------
      *
      *  AUTOR      : AFRI (MAE-ALD)
      *  FECHA      : 29 ABRIL 2013
      *  PROYECTO   : MOVILIDADES FASE III (COLOCACIONES)
      *  ETIQUETA   : AFRI-INI/29-ABR-2013 MOVILIDADES III
      *  CAMBIOS    : SE INCORPORA GRABACION DE TICKET (GNS-ITK)
      *--------------------------------------------------------------   
      *>>>>

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.

       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-SGCPUAUM-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$SGCPUAUM$ SKL=$08.07.21$ VSN=${vsnpu}$        
      -    'GEN=$08-May-19 11:35 AM$ FNC=${fncpu}$/>'.    
       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI                                                
           03 SCR-CIC-ICLI.
              05  SCR-CAI-ICLI                         PIC X(04).
              05  SCR-IIC-ICLI                         PIC X(08).
      *    TIPO CAMBIO
           03 WSS-COD-CAMB.                                             
              05 WSS-IND-VEJE       VALUE  SPACES  PIC X(01).           
              05 WSS-IND-VOFI       VALUE  SPACES  PIC X(01).           
              05 WSS-IND-VBAN       VALUE  SPACES  PIC X(01).           

      *AFRI-INI/29-ABR-2013 MOVILIDADES III
      *    PARAMETROS CAMBIO
           03 WSS-GLS-PARA                             PIC X(80).
           03 WSS-IIC-IREG                             PIC 9(08).

      *CONSTANTES
       01 WCC-VARI.
           03 WCC-M                 VALUE 'M'        PIC X(01).
           03 WCC-CF3               VALUE 'CF3'      PIC X(03).

           03 WCC-S                 VALUE 'S'        PIC X(01).
           03 WCC-I                 VALUE 'I'        PIC X(01).

           03 WCC-PGM               VALUE 'SGCPUAUM' PIC X(08).
           03 WCC-SIST              VALUE 'COL'      PIC X(03).
           03 WCC-ARCH              VALUE 'COLAUM'   PIC X(06).

           03 WCC-1                 VALUE 1        PIC 9(01).

           03 WSS-COD-ETAPA     VALUE '00000000001'  PIC X(11).
           03 WSS-UNO-CERO      VALUE '0'            PIC X(01).
           03 WSS-DOS-CERO      VALUE '00'           PIC X(02).
           03 WSS-GLS-TPOK  VALUE 'TICKET PROCESADO OK' PIC X(19).
      *AFRI-INI/MOVII/SOP-AFRI/JUL-2013
           03 WSS-CON-OCOL          VALUE  '365'   PIC X(03).
           03 WSS-CON-PCOL          VALUE  'Y'     PIC X(01).
           03 WSS-CON-S             VALUE  'S'     PIC X(01).
           03 WSS-CON-P             VALUE  'P'     PIC X(01).
           03 WSS-CON-E             VALUE  'E'     PIC X(01).
           03 WSS-CON-CCTE          VALUE  'CCT'   PIC X(03).
           03 WSS-CON-M100          VALUE  'M100'  PIC X(04).
           03 WSS-CON-PRGM          VALUE  'SGCPUAUM' PIC X(08).           
      *AFRI-FIN/MOVII/SOP-AFRI/JUL-2013


      *AFRI-FIN/29-ABR-2013 MOVILIDADES III

      *>>>>                                                             
       COPY SGCWIAUM.
       COPY SGCBRDBC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *AFRI-INI/29-ABR-2013 MOVILIDADES III
       COPY GNSBRITK.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITK-REQA==.
       COPY GNSBRPTK.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTK-REQA==.
       COPY GNSBRRTK.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RTK-REQA==.
       COPY GNSBRCIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGCIC.
      *AFRI-FIN/29-ABR-2013 MOVILIDADES III

      *<<<< WSS
       COPY GNSWGCPT.
       COPY GNSWGSTR.

       COPY SGCBRDCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY SGCBRDCE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
       COPY SGCBRDCC.
       COPY SGCBRRCO.
       COPY SGCBROPE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.        
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.        
       COPY SGCWGEJE.
       COPY SGCWGSUC.
       COPY SGCWGBAN.
       COPY SGCWGMOV.
       COPY GNSWGHOY.

      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(300).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO AUM-FLD.
           MOVE LOW-VALUES TO AUM-EDT.
           MOVE +300 TO SCR-TCMA.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'SGCPUAUM' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM STP-EXIT.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-AUM.
           PERFORM EDT-KEY-AUM.
           PERFORM EDT-FLD-AUM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
               PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
               PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM XCT-PRGP.
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
               GO TO MSG-SCR-MOD.
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MEN1 NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MEN1
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
           PERFORM DESSCRTRL.
           IF ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8  OR
                           FRM-FFLD-PF5 OR FRM-FFLD-PF6 ) AND
              SCR-ACTU = SCR-ACTU-MOD
               PERFORM XCT-PRGP.
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 OR
                         FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM XCT-PRGP.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-AUM
               PERFORM EDT-KEY-AUM
               PERFORM EDT-FLD-AUM
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-AUM
               PERFORM EDT-KEY-AUM
           ELSE
               PERFORM CLR-FLD-AUM
               PERFORM EDT-FLD-AUM.
           PERFORM STP-EXIT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       XCT-PRGP SECTION.
       INI-XCT-PRGP.
           MOVE SCR-INST-BRW TO SCR-INST.
           PERFORM STP-EXIT.
           MOVE FRM-FFLD   TO SCR-FFLD.
      *
           MOVE SCR-PROG     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
           PERFORM XCT-ERR.
       FIN-XCT-PRGP.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO AUM-FLD.
           MOVE LOW-VALUES TO AUM-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.

       CMN-MOD SECTION.
       INI-CMN-MOD.
      *    INVOCACION RUTINA
           IF SCR-CMND = 'VRF' OR 'ACT'
               PERFORM COM-VAL-MOV
               MOVE '00' TO FIO-STAT
               GO TO FIN-CMN-MOD.
           PERFORM KEY-ALL-AUM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS AND
              DBC-STP-ITRN IN DBC NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO FIN-CMN-MOD.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-ALL-AUM.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       FIN-CMN-MOD.
           EXIT.

       CMN-ING SECTION.
       INI-CMN-ING.
           MOVE SPACES TO DBC.
           PERFORM RET-ALL-AUM.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       FIN-CMN-ING.
           EXIT.

       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM KEY-ALL-AUM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS AND
              DBC-STP-ITRN IN DBC NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ACC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-AUM.
       FIN-CMN-ACC.
           EXIT.

       CMN-ELI SECTION.
       INI-CMN-ELI.
           PERFORM KEY-ALL-AUM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS AND
              DBC-STP-ITRN IN DBC NOT = SCR-UMOD
               MOVE FIO-ULK-REC TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM SGC-FIO-DBC
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'GNSACCSSIMUL' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-CMN-ELI.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       FIN-CMN-ELI.
           EXIT.

       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-AUM.
       FIN-CMN-PGM.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE AUM-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO AUM-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-AUM
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO AUM-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-AUM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-AUM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-AUM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-AUM
               PERFORM EDT-FLD-AUM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-AUM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-AUM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-AUM.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-FLD-AUM.
       ERR-SCR-GFLD.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-AUM.
           PERFORM EDT-FLD-AUM.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.

       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO AUM-GLS-MEN2
               MOVE SCR-PRMT     TO AUM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO AUM-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-CONF > SPACES )
               PERFORM VAL-NUM-KEY-AUM
               PERFORM VAL-NUM-FLD-AUM.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO AUM-GLS-MEN2
               MOVE SCR-PRMT     TO AUM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO AUM-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO AUM-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE AUM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO AUM-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-AUM

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO AUM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO AUM-GLS-MENS.
           PERFORM PRO-FLD-AUM.
           PERFORM PRO-MKY-AUM.
           PERFORM UNP-IKY-AUM.
           PERFORM FST-KEY-AUM.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE AUM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO AUM-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO AUM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO AUM-GLS-MENS.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-FLD-AUM.
           MOVE '1' TO FRM-CPIM-AEY.
           PERFORM UNP-KEY-AUM.
           PERFORM FST-KEY-AUM.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM UNP-MKY-AUM.
           PERFORM UNP-FLD-AUM.
           PERFORM FST-FLD-AUM.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO AUM-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-AUM.
           PERFORM PRO-FLD-AUM.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      * PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-AUM
               PERFORM EDT-FLD-AUM
               PERFORM SCR-PUTA
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-AUM
               PERFORM EDT-FLD-AUM
               PERFORM SCR-PUTA
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-AUM.
           PERFORM EDT-FLD-AUM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

       PRO-CONF SECTION.
       INI-PRO-CONF.
      *PTC-INI
           IF SCR-OFRM-SRV AND
              SCR-CONF NOT > SPACES
                MOVE SPACES TO FRM-MENS.
      *PTC-FIN
           IF FRM-MENS NOT > SPACES
               IF SCR-CONF NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-CONF TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-CONF TO FRM-MEN1.
           PERFORM PRO-KEY-AUM.
           PERFORM PRO-FLD-AUM.
           PERFORM FST-MSG.
           PERFORM SCR-MSSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-AUM
               PERFORM EDT-FLD-AUM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.

       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO AUM-GLS-MEN2
               MOVE SCR-CONF     TO AUM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO AUM-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-AUM
               PERFORM VAL-NUM-FLD-AUM
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM VAL-NUM-KEY-AUM
                   PERFORM VAL-NUM-FLD-AUM
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.


       COPY SGCBUAUM.
       COPY GNSBVNUM.
       COPY SGCBFDBC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVTDU.
       COPY TABBFUSR.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *<<<< EOF 
      *
       COPY SGCBFDCP.
       COPY SGCBFDCE.
      *
       COPY GNSBBTAB.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY SGCBFDCC.
       COPY SGCBFRCO.
       COPY SGCBFOPE.
       COPY SGCBGEJE.
       COPY SGCBGSUC.
       COPY SGCBGBAN.
       COPY SGCBGMOV.
       COPY GNSBGHOY.
       COPY GNSBEGLS.
      *AFRI-INI/29-ABR-2013 MOVILIDADES III
       COPY GNSBFITK.
       COPY GNSBFPTK.
       COPY GNSBFRTK.
       COPY GNSBFCIC.
       COPY GNSBGCIC.
      *AFRI-FIN/29-ABR-2013 MOVILIDADES III
      *>>>>                                                             
       VAL-REG-AUM SECTION.                                             
       INI-VAL-REG-AUM.                                                 


      *    VALIDO CLIENTE
           MOVE DBC-NUM-ICLI IN AUM-FLD TO MOV-NUM-ICLI IN MOV-INP.
           PERFORM BUS-REG-DBC.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-VAL-REG-AUM.

           PERFORM VAL-CLI-PER.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-VAL-REG-AUM.

           PERFORM BUS-COD-JOF.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-VAL-REG-AUM.

           PERFORM BUS-REG-BAN.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-VAL-REG-AUM.

           MOVE DBC-COD-OFIC IN DBC     TO WSS-COD-OFIO IN SUC-INP.
           MOVE FRM-COD-OFID IN AUM-FLD TO WSS-COD-OFID IN SUC-INP.
           MOVE DBC-COD-EJEC IN DBC     TO WSS-COD-EJEO IN EJE-INP.
           MOVE FRM-COD-EJED IN AUM-FLD TO WSS-COD-EJED IN EJE-INP.
           MOVE WSS-COD-TBAN IN BAN-OUT TO WSS-COD-TBAO IN BAN-INP.
           MOVE FRM-COD-TBAD IN AUM-FLD TO WSS-COD-TBAD IN BAN-INP.
           MOVE WSS-COD-TPLN IN BAN-OUT TO WSS-COD-PLAO IN BAN-INP.
           MOVE FRM-COD-TPLD IN AUM-FLD TO WSS-COD-PLAD IN BAN-INP.


      *    VALIDA SI CLIENTE ES DE CUENTAS ESPECIALES
           PERFORM  VAL-CLI-CESP.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-VAL-REG-AUM.

      *    VALIDA SI CLIENTE ES TITULAR CTA CTE
           PERFORM  BUS-REG-RCO.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-VAL-REG-AUM.


      *    SI HAY CAMBIO DE EJECUTIVO, LO VALIDA
           IF WSS-IND-VEJE = 'S'
               PERFORM VAL-MOV-EJE
               IF WSS-IND-ERRO = 'S'
                   GO TO FIN-VAL-REG-AUM.

      *    SI HAY CAMBIO DE BANCA, LO VALIDA
           IF WSS-IND-VBAN = 'S'
               PERFORM VAL-MOV-BAN
               IF WSS-IND-ERRO = 'S'
                   GO TO FIN-VAL-REG-AUM.

      *    SI HAY CAMBIO DE SUCURSAL, LO VALIDA
           IF WSS-IND-VOFI = 'S'
               PERFORM VAL-MOV-SUC
               IF WSS-IND-ERRO = 'S'
                   GO TO FIN-VAL-REG-AUM.

       FIN-VAL-REG-AUM.                                                 
           EXIT.                                                        
      *----------------------------------------------------------------
      *----------------------------------------------------------------
       BUS-COD-JOF SECTION.                                             
       INI-BUS-COD-JOF.                                                 
                                                                        
           MOVE SPACES                  TO WSS-COD-JOFO IN EJE-INP.
           MOVE SPACES                  TO WSS-COD-JOFD IN EJE-INP.

           MOVE DBC-COD-OFIC IN DBC     TO WSS-COD-OFIC.
           PERFORM BUS-TBL-OFI.
           IF WSS-IND-ERRO NOT = 'S'
               MOVE WSS-COD-JFOF        TO WSS-COD-JOFO IN EJE-INP
           ELSE
               GO TO FIN-BUS-COD-JOF.

           IF WSS-IND-VOFI NOT = 'S'
               MOVE WSS-COD-JFOF        TO WSS-COD-JOFD IN EJE-INP.

           IF WSS-IND-VOFI = 'S'
               MOVE FRM-COD-OFID IN AUM-FLD TO WSS-COD-OFIC
               PERFORM BUS-TBL-OFI
               IF WSS-IND-ERRO NOT = 'S'
                   MOVE WSS-COD-JFOF    TO WSS-COD-JOFD IN EJE-INP
               ELSE
                   GO TO FIN-BUS-COD-JOF.

       FIN-BUS-COD-JOF.                                                 
           EXIT.                                                        
      *----------------------------------------------------------------
      *----------------------------------------------------------------
       COM-VAL-MOV SECTION.                                             
       INI-COM-VAL-MOV.                                                 
                                                                        
           MOVE WSS-COD-CAMB TO WSS-COD-TCAM IN MOV-OUT.
           PERFORM BUS-TBL-VSN.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-COM-VAL-MOV.                                   

           PERFORM VAL-REG-AUM.
           IF WSS-IND-ERRO = 'S'
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE WSS-COD-ERRO   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE 'S'            TO SCR-IERR
               GO TO FIN-COM-VAL-MOV.


           IF SCR-CMND = 'VRF'
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'VALCLIOK'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-COM-VAL-MOV.


      *    SI ES COMANDO 'ACT' ACTUALIZA REGISTRO
           PERFORM UPD-REG-MOV.
           IF WSS-IND-ERRO = 'S'
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE WSS-COD-ERRO   TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE 'S'            TO SCR-IERR
               GO TO FIN-COM-VAL-MOV
           ELSE
      *AFRI-INI/29-ABR-2013 MOVILIDADES III
               PERFORM GRB-REG-ITK
      *AFRI-FIN/29-ABR-2013 MOVILIDADES III
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'MOVCLIOK'     TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               GO TO FIN-COM-VAL-MOV.



       FIN-COM-VAL-MOV.                                                 
           EXIT.                                                        
      *----------------------------------------------------------------
      *----------------------------------------------------------------
       UPD-REG-MOV SECTION.                                             
       INI-UPD-REG-MOV.                                                 
                                                                        
           MOVE SPACES TO WSS-IND-ERRO.
           MOVE SPACES TO WSS-COD-ERRO.
           PERFORM GET-FHOY.

      *    BUSCO CLIENTE DBC                                            
           MOVE SPACES                  TO DBC-IDC-ICLI IN DBC.
           MOVE DBC-NUM-ICLI IN AUM-FLD TO DBC-NUM-ICLI IN DBC.         
           MOVE 'DBC-IDC-ICLI'          TO FIO-AKEY.
           MOVE FIO-GET-KEY             TO FIO-CMND.                    
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M019' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-MOV.                                   

           PERFORM CHK-PNT.
      *    ACTUALIZA DCP/DCE
           IF WSS-IND-VBAN = 'S'
               PERFORM UPD-REG-BAN
               IF WSS-IND-ERRO = 'S'
                   GO TO FIN-UPD-REG-MOV.

      *    SI HAY CAMBIO DE OFICINA ACTUALIZA OPE
           IF WSS-IND-VOFI = 'S' OR
              WSS-IND-VEJE = 'S'
               PERFORM VAL-REG-RCO
               IF WSS-IND-ERRO = 'S'
                   GO TO FIN-UPD-REG-MOV.

      *AFRI-INI/MOVII/SOP-AFRI/JUL-2013
      *    SI HAY CAMBIO DE OFICINA NO COLABORADOR A
      *    COLABORADOR SE ACTUALIZA A PLAN COLABORADOR
           IF WSS-IND-VOFI = WSS-CON-S AND
              DBC-COD-OFIC IN AUM-FLD NOT = WSS-CON-OCOL AND
              FRM-COD-OFID IN AUM-FLD = WSS-CON-OCOL
               PERFORM UPD-REG-PLN
               IF WSS-IND-ERRO = WSS-CON-S
                   GO TO FIN-UPD-REG-MOV.
      *AFRI-FIN/MOVII/SOP-AFRI/JUL-2013
                                                                        
      *    ACTUALIZA DBC
           PERFORM UPD-REG-DBC.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-UPD-REG-MOV.
                                                                        

       FIN-UPD-REG-MOV.                                                 
           EXIT.                                                        
      *----------------------------------------------------------------
      *----------------------------------------------------------------
      *AFRI-INI/MOVII/SOP-AFRI/JUL-2013
       UPD-REG-PLN SECTION.
       INI-UPD-REG-PLN.

           MOVE SPACES TO WSS-IND-ERRO.

           IF DBC-IND-TICL IN DBC = WSS-CON-P
               PERFORM UPD-REG-DCP-PLN
               GO TO FIN-UPD-REG-PLN.

           IF DBC-IND-TICL IN DBC = WSS-CON-E
               PERFORM UPD-REG-DCE-PLN
               GO TO FIN-UPD-REG-PLN.

       FIN-UPD-REG-PLN.
           EXIT.
      *-------------------------------------------------------------
      *-------------------------------------------------------------
       UPD-REG-DCE-PLN SECTION.
       INI-UPD-REG-DCE-PLN.


           MOVE SPACES              TO WSS-IND-ERRO.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE WSS-CON-S       TO WSS-IND-ERRO
               MOVE WSS-CON-M100    TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-DCE-PLN.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           MOVE FIO-MOD TO FIO-CMND.
           IF NOT FIO-STAT-OKS
               MOVE WSS-CON-S       TO WSS-IND-ERRO
               MOVE WSS-CON-M100    TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-DCE-PLN.

           MOVE WSS-CON-PCOL        TO DCE-COD-TPLN IN DCE.

           MOVE WSS-CON-PRGM        TO DCE-COD-ATRN IN DCE.
           MOVE HOY-FHOY            TO DCE-FEC-FTRN IN DCE.
           MOVE HOY-HHOY            TO DCE-HRA-HRTR IN DCE.
                                                                        
           PERFORM SGC-FIO-DCE.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE WSS-CON-S       TO WSS-IND-ERRO
               MOVE WSS-CON-M100    TO WSS-COD-ERRO
               PERFORM GRB-VERR
               PERFORM BCK-OUT
               GO TO FIN-UPD-REG-DCE-PLN.                  


       FIN-UPD-REG-DCE-PLN.
           EXIT.
      *-------------------------------------------------------------
      *-------------------------------------------------------------
       UPD-REG-DCP-PLN SECTION.
       INI-UPD-REG-DCP-PLN.

           MOVE SPACES              TO WSS-IND-ERRO.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE WSS-CON-S       TO WSS-IND-ERRO
               MOVE WSS-CON-M100    TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-DCP-PLN.

           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           MOVE FIO-MOD TO FIO-CMND.
           IF NOT FIO-STAT-OKS
               MOVE WSS-CON-S       TO WSS-IND-ERRO
               MOVE WSS-CON-M100    TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-DCP-PLN.

           MOVE WSS-CON-PCOL        TO DCP-COD-TPLN IN DCP.

           MOVE WSS-CON-PRGM        TO DCP-COD-ATRN IN DCP.
           MOVE HOY-FHOY            TO DCP-FEC-FTRN IN DCP.
           MOVE HOY-HHOY            TO DCP-HRA-HRTR IN DCP.
                                                                        
           PERFORM SGC-FIO-DCP.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE WSS-CON-S       TO WSS-IND-ERRO
               MOVE WSS-CON-M100    TO WSS-COD-ERRO
               PERFORM GRB-VERR
               PERFORM BCK-OUT
               GO TO FIN-UPD-REG-DCP-PLN.    


       FIN-UPD-REG-DCP-PLN.
           EXIT.
      *-------------------------------------------------------------
      *-------------------------------------------------------------           
      *AFRI-FIN/MOVII/SOP-AFRI/JUL-2013
      
       UPD-REG-BAN SECTION.                                             
       INI-UPD-REG-BAN.                                                 
                                                                        
           MOVE SPACES TO WSS-IND-ERRO.                                 
                                                                        
           IF DBC-IND-TICL IN DBC = 'P'
               PERFORM UPD-REG-DCP
               GO TO FIN-UPD-REG-BAN.

           IF DBC-IND-TICL IN DBC = 'E'
               PERFORM UPD-REG-DCE
               GO TO FIN-UPD-REG-BAN.
                                                                        

       FIN-UPD-REG-BAN.                                                 
           EXIT.                                                        
      *-------------------------------------------------------------
      *-------------------------------------------------------------
       UPD-REG-DBC SECTION.                                             
       INI-UPD-REG-DBC.                                                 
                                                                        
           MOVE SPACES          TO WSS-IND-ERRO.                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM SGC-FIO-DBC.                                         
           MOVE FIO-MOD         TO FIO-CMND.                            
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M100' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-DBC.                                   
                                                                        
      *    ACTUALIZA EJECUTIVO
           IF WSS-IND-VEJE  = 'S'
               MOVE FRM-COD-EJED IN AUM-FLD TO DBC-COD-EJEC IN DBC.

      *    ACTUALIZA OFICINA
           IF WSS-IND-VOFI  = 'S'
               MOVE FRM-COD-OFID IN AUM-FLD TO DBC-COD-OFIC IN DBC.

           MOVE 'SGCPUAUM'         TO DBC-COD-ATRN IN DBC.
           MOVE HOY-FHOY           TO DBC-FEC-FTRN IN DBC.
           MOVE HOY-HHOY           TO DBC-HRA-HRTR IN DBC.
                                                                        
           PERFORM SGC-FIO-DBC.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M100' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               PERFORM BCK-OUT
               GO TO FIN-UPD-REG-DBC.                                   

                                                                        

       FIN-UPD-REG-DBC.                                                 
           EXIT.                                                        
      *-------------------------------------------------------------
      *-------------------------------------------------------------
       UPD-REG-DCE SECTION.                                             
       INI-UPD-REG-DCE.                                                 
                                                                        
                                                                        
           MOVE SPACES              TO WSS-IND-ERRO.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M100' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-DCE.
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM SGC-FIO-DCE.                                         
           MOVE FIO-MOD TO FIO-CMND.                                    
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M100' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-DCE.                                   
                                                                        
           MOVE FRM-COD-TBAD IN AUM-FLD TO DCE-COD-TBAN IN DCE.
      *AFRI-INI/MOVII/SOP-AFRI/JUL-2013
      *    MOVE FRM-COD-TPLD IN AUM-FLD TO DCE-COD-TPLN IN DCE.
           IF (DBC-COD-OFIC IN AUM-FLD NOT = WSS-CON-OCOL AND
               FRM-COD-OFID IN AUM-FLD = WSS-CON-OCOL)
              MOVE WSS-CON-PCOL        TO DCE-COD-TPLN IN DCE.
      *AFRI-FIN/MOVII/SOP-AFRI/JUL-2013

           MOVE 'SGCPUAUM'          TO DCE-COD-ATRN IN DCE.
           MOVE HOY-FHOY            TO DCE-FEC-FTRN IN DCE.
           MOVE HOY-HHOY            TO DCE-HRA-HRTR IN DCE.
                                                                        
           PERFORM SGC-FIO-DCE.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M100' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               PERFORM BCK-OUT
               GO TO FIN-UPD-REG-DCE.                                   

                                                                        

       FIN-UPD-REG-DCE.                                                 
           EXIT.                                                        
      *-------------------------------------------------------------
      *-------------------------------------------------------------
       UPD-REG-DCP SECTION.                                             
       INI-UPD-REG-DCP.                                                 
                                                                        
                                                                        
           MOVE SPACES              TO WSS-IND-ERRO.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY         TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M100' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-DCP.
                                                                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM SGC-FIO-DCP.                                         
           MOVE FIO-MOD TO FIO-CMND.                                    
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M100' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-DCP.                                   
                                                                        
           MOVE FRM-COD-TBAD IN AUM-FLD TO DCP-COD-TBAN IN DCP.
      *AFRI-INI/MOVII/SOP-AFRI/JUL-2013
      *    MOVE FRM-COD-TPLD IN AUM-FLD TO DCP-COD-TPLN IN DCP.
           IF (DBC-COD-OFIC IN AUM-FLD NOT = WSS-CON-OCOL AND
               FRM-COD-OFID IN AUM-FLD = WSS-CON-OCOL)
              MOVE WSS-CON-PCOL        TO DCE-COD-TPLN IN DCE.
      *AFRI-FIN/MOVII/SOP-AFRI/JUL-2013           

           MOVE 'SGCPGAMV'          TO DCP-COD-ATRN IN DCP.
           MOVE HOY-FHOY            TO DCP-FEC-FTRN IN DCP.
           MOVE HOY-HHOY            TO DCP-HRA-HRTR IN DCP.
                                                                        
           PERFORM SGC-FIO-DCP.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M100' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               PERFORM BCK-OUT
               GO TO FIN-UPD-REG-DCP.                                   


       FIN-UPD-REG-DCP.                                                 
           EXIT.                                                        
      *----------------------------------------------------------------
      *----------------------------------------------------------------
       VAL-REG-RCO SECTION.                                             
       INI-VAL-REG-RCO.                                                 

           MOVE SPACES       TO WSS-IND-ERRO.

      *    ENTRO A VMV                                                  
           MOVE DBC-CIC-ICLI IN DBC TO RCO-CIC-ICLI IN RCO.             
           MOVE SPACES              TO RCO-CIC-IOPE IN RCO.             
           MOVE FIO-GET-NLS  TO FIO-CMND.                               
                                                                        
       LUP-VAL-REG-RCO.                                                 
           PERFORM SGC-FIO-RCO.                                         
           IF NOT FIO-STAT-OKS OR                                       
              DBC-CIC-ICLI IN DBC NOT = RCO-CIC-ICLI IN RCO             
               GO TO FIN-VAL-REG-RCO.                                   


           IF RCO-COD-STAT IN RCO NOT = 'VIG' OR
              RCO-COD-RCOP IN RCO NOT = 'TIT'
               GO TO NXT-VAL-REG-RCO.

           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.             
           MOVE FIO-GET-KEY  TO FIO-CMND.                               
           PERFORM SGC-FIO-OPE.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M047' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               PERFORM BCK-OUT
               GO TO FIN-VAL-REG-RCO.                                   

      *AFRI-INI/MOVII/SOP-AFRI/JUL-2013
           IF OPE-COD-TOPR IN OPE NOT = WSS-CON-CCTE
               GO TO NXT-VAL-REG-RCO.
      *AFRI-FIN/MOVII/SOP-AFRI/JUL-2013
                                                                        
      *    VALIDA QUE OFICINA DE ORIGEN SEA LA DE OPERACION
           IF WSS-IND-VOFI  = 'S' AND
              OPE-COD-OFOP IN OPE NOT = DBC-COD-OFIC IN DBC
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M047' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               PERFORM BCK-OUT
               GO TO FIN-VAL-REG-RCO.                                   
                                                                        
      *    VALIDA QUE EJECUTIVO ORIGEN SEA EL DE OPERACION
           IF WSS-IND-VEJE  = 'S' AND
              OPE-COD-EJOP IN OPE NOT = DBC-COD-EJEC IN DBC
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M047' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               PERFORM BCK-OUT
               GO TO FIN-VAL-REG-RCO.                                   
                                                                        
      *    ACTUALIZA REGISTRO OPE
           PERFORM UPD-REG-OPE.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-VAL-REG-RCO.
                                                                        
       NXT-VAL-REG-RCO.                                                 
           MOVE FIO-GET-NXT TO FIO-CMND.                                
           GO TO LUP-VAL-REG-RCO.                                       
                                                                        
       FIN-VAL-REG-RCO.                                                 
           EXIT.                                                        
      *-------------------------------------------------------------
      *-------------------------------------------------------------
       UPD-REG-OPE SECTION.                                             
       INI-UPD-REG-OPE.                                                 
                                                                        
           MOVE SPACES          TO WSS-IND-ERRO.                        
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.                            
           PERFORM SGC-FIO-OPE.                                         
           MOVE FIO-MOD         TO FIO-CMND.                            
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M047' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               GO TO FIN-UPD-REG-OPE.                                   
                                                                        
           IF WSS-IND-VOFI  = 'S'
               MOVE FRM-COD-OFID IN AUM-FLD TO OPE-COD-OFOP IN OPE.

           IF WSS-IND-VEJE  = 'S'
               MOVE FRM-COD-EJED IN AUM-FLD TO OPE-COD-EJOP IN OPE.


           MOVE 'SGCPUAUM'          TO OPE-COD-ATRN IN OPE.
           MOVE HOY-FHOY            TO OPE-FEC-FTRN IN OPE.
           MOVE HOY-HHOY            TO OPE-HRA-HRTR IN OPE.
                                                                        
           PERFORM SGC-FIO-OPE.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE 'S'    TO WSS-IND-ERRO
               MOVE 'M100' TO WSS-COD-ERRO
               PERFORM GRB-VERR
               PERFORM BCK-OUT
               GO TO FIN-UPD-REG-OPE.                                   

       FIN-UPD-REG-OPE.                                                 
           EXIT.                                                        
      *----------------------------------------------------------------
      *----------------------------------------------------------------
       CHK-PNT SECTION.                                                 
       INI-CHK-PNT.                                                     
           MOVE FIO-CHK-PNT TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
       FIN-CHK-PNT.                                                     
           EXIT.                                                        
      *-------------------------------------------------------------
      *-------------------------------------------------------------
       BCK-OUT SECTION.                                                 
       INI-BCK-OUT.                                                     
           MOVE FIO-BCK-OUT TO FIO-CMND.                                
           PERFORM SGC-FIO-DBC.                                         
       FIN-BCK-OUT.                                                     
           EXIT.                                                        
      *-------------------------------------------------------------
      *-------------------------------------------------------------
      *AFRI-INI/29-ABR-2013 MOVILIDADES III
       GRB-REG-ITK SECTION.                                             
       INI-GRB-REG-ITK.                                                 

           MOVE SPACES                  TO WSS-GLS-PARA.
           MOVE WSS-COD-CAMB            TO WSS-GLS-PARA(1:3).
           MOVE FRM-COD-MOVI IN AUM-FLD TO WSS-GLS-PARA(4:3).
           MOVE DBC-COD-OFIC IN AUM-FLD TO WSS-GLS-PARA(7:3).
           MOVE FRM-COD-OFID IN AUM-FLD TO WSS-GLS-PARA(10:3).
           MOVE DBC-COD-EJEC IN AUM-FLD TO WSS-GLS-PARA(13:12).
           MOVE FRM-COD-EJED IN AUM-FLD TO WSS-GLS-PARA(25:12).
           MOVE FRM-COD-TBAN IN AUM-FLD TO WSS-GLS-PARA(37:3).
           MOVE FRM-COD-TBAD IN AUM-FLD TO WSS-GLS-PARA(40:3).
           MOVE FRM-COD-TPLN IN AUM-FLD TO WSS-GLS-PARA(43:1).
           MOVE FRM-COD-TPLD IN AUM-FLD TO WSS-GLS-PARA(44:1).

      *    BUSCA LLAVE REGISTRO
           PERFORM BUS-CIC-REG.
           IF WSS-IND-ERRO = 'S'
               GO TO FIN-GRB-REG-ITK.

           MOVE SPACES                    TO  ITK-GLS-FLAG IN ITK.      
           MOVE WCC-M                     TO  ITK-COD-TITK IN ITK.      
           MOVE WCC-CF3                   TO  ITK-COD-CITK IN ITK.      
           MOVE WSS-IIC-IREG              TO  ITK-IIC-IITK IN ITK.      
           MOVE HOY-FHOY                  TO  ITK-FEC-FTRN IN ITK.      
           MOVE HOY-HHOY                  TO  ITK-HRA-HRTR IN ITK.      
           MOVE WCC-I                     TO  ITK-MSC-TACC IN ITK.      
           MOVE WCC-I                     TO  ITK-MSC-STAT IN ITK.      
           MOVE SPACES                    TO  ITK-COD-OTRN IN ITK.      
           MOVE WCC-PGM                   TO  ITK-COD-ATRN IN ITK.      
           MOVE SPACES                    TO  ITK-COD-FILL IN ITK.      
           MOVE WCC-SIST                  TO  ITK-COD-SIST IN ITK.      
           MOVE WCC-ARCH                  TO  ITK-COD-TPRO IN ITK.      
           MOVE DBC-IDC-ICLI IN DBC       TO  ITK-COD-ENTI IN ITK.      
           MOVE HOY-FHOY                  TO  ITK-FEC-FPRO IN ITK.      
           MOVE HOY-HHOY                  TO  ITK-HRA-HRPR IN ITK.      
           MOVE WCC-1                     TO  ITK-NUM-UNIC IN ITK.      
           MOVE WCC-1                     TO  ITK-VAL-OITE IN ITK.      
           MOVE WCC-1                     TO  ITK-VAL-TITE IN ITK.      
           MOVE WCC-1                     TO  ITK-VAL-TPRO IN ITK.      
           MOVE WSS-COD-ETAPA             TO  ITK-COD-ETAP IN ITK.      
           MOVE WSS-UNO-CERO              TO  ITK-IND-RESP IN ITK.      
           MOVE WSS-DOS-CERO              TO  ITK-COD-RESP IN ITK.      
           MOVE WSS-GLS-TPOK              TO  ITK-GLS-RESP IN ITK.      
           MOVE HOY-FHOY                  TO  ITK-FEC-FGRA IN ITK.      
           MOVE HOY-HHOY                  TO  ITK-HRA-HRGR IN ITK.      
           MOVE ZEROES                    TO  ITK-FEC-FINI IN ITK.      
           MOVE ZEROES                    TO  ITK-HRA-HRIN IN ITK.      
           MOVE ZEROES                    TO  ITK-FEC-FTER IN ITK.      
           MOVE ZEROES                    TO  ITK-HRA-HRTE IN ITK.      
           MOVE SPACES                    TO  ITK-GLS-DISP IN ITK.      

                                                                        
           MOVE FIO-PUT      TO FIO-CMND.                               
           PERFORM GNS-FIO-ITK.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE WCC-S                 TO WSS-IND-ERRO               
               PERFORM BCK-OUT
               GO TO FIN-GRB-REG-ITK.                                   

      *--------------------------

           MOVE SPACES                    TO  PTK-GLS-FLAG IN PTK.      
           MOVE ITK-CIC-IITK IN ITK       TO  PTK-CIC-IITK IN PTK.      
           MOVE ZEROES                    TO  PTK-NUM-SECU IN PTK.      
           MOVE WCC-1                     TO  PTK-NUM-CORP IN PTK.      
           MOVE HOY-FHOY                  TO  PTK-FEC-FTRN IN PTK.      
           MOVE HOY-HHOY                  TO  PTK-HRA-HRTR IN PTK.      
           MOVE WCC-I                     TO  PTK-MSC-TACC IN PTK.      
           MOVE SPACES                    TO  PTK-MSC-STAT IN PTK.      
           MOVE SPACES                    TO  PTK-COD-OTRN IN PTK.      
           MOVE ITK-COD-ATRN IN ITK       TO  PTK-COD-ATRN IN PTK.      

           MOVE WSS-GLS-PARA              TO  PTK-GLS-PARA IN PTK.      
           MOVE SPACES                    TO  PTK-GLS-DISP IN PTK.      

           MOVE FIO-PUT      TO FIO-CMND.                               
           PERFORM GNS-FIO-PTK.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE WCC-S                 TO WSS-IND-ERRO               
               PERFORM BCK-OUT
               GO TO FIN-GRB-REG-ITK.                                   

      *--------------------------
           MOVE SPACES                    TO  RTK-GLS-FLAG IN RTK.      
           MOVE ITK-CIC-IITK IN ITK       TO  RTK-CIC-IITK IN RTK.      
           MOVE ZEROES                    TO  RTK-NUM-SECT IN RTK.      
           MOVE ITK-COD-ENTI IN ITK       TO  RTK-COD-ENTT IN RTK.      
           MOVE WCC-1                     TO  RTK-NUM-CORT IN RTK.      
           MOVE ITK-COD-SIST IN ITK       TO  RTK-COD-SIST IN RTK.      
           MOVE ITK-COD-TPRO IN ITK       TO  RTK-COD-TPRO IN RTK.      
           MOVE ZEROES                    TO  RTK-NUM-SECU IN RTK.      
           MOVE ITK-COD-ENTI IN ITK       TO  RTK-COD-ENTI IN RTK.      
           MOVE ITK-FEC-FPRO IN ITK       TO  RTK-FEC-FPRO IN RTK.      
           MOVE ITK-HRA-HRPR IN ITK       TO  RTK-HRA-HRPR IN RTK.      
           MOVE WCC-1                     TO  RTK-NUM-CORR IN RTK.      
           MOVE ITK-STP-ITRN IN ITK       TO  RTK-STP-ITRN IN RTK.      
           MOVE SPACES                    TO  RTK-MSC-TACC IN RTK.      
           MOVE SPACES                    TO  RTK-MSC-STAT IN RTK.      
           MOVE SPACES                    TO  RTK-COD-OTRN IN RTK.      
           MOVE WCC-PGM                   TO  RTK-COD-ATRN IN RTK.      
           MOVE SPACES                    TO  RTK-GLS-FRES IN RTK.      
           MOVE ITK-GLS-RESP IN ITK       TO  RTK-GLS-RESP IN RTK.      
           MOVE SPACES                    TO  RTK-IND-RESP IN RTK.      
           MOVE SPACES                    TO  RTK-COD-RESP IN RTK.      
           MOVE SPACES                    TO  RTK-GLS-MENJ IN RTK.      
           MOVE ZEROES                    TO  RTK-FEC-FINI IN RTK.      
           MOVE ZEROES                    TO  RTK-HRA-HRIN IN RTK.      
           MOVE ZEROES                    TO  RTK-FEC-FTER IN RTK.      
           MOVE ZEROES                    TO  RTK-HRA-HRTE IN RTK.      
           MOVE SPACES                    TO  RTK-GLS-DISP IN RTK.      

           MOVE FIO-PUT      TO FIO-CMND.                               
           PERFORM GNS-FIO-RTK.                                         
           IF NOT FIO-STAT-OKS                                          
               MOVE WCC-S                 TO WSS-IND-ERRO               
               PERFORM BCK-OUT
               GO TO FIN-GRB-REG-ITK.                                   

       FIN-GRB-REG-ITK.                                                 
           EXIT.                                                        
      *----------------------------------------------------------------
      *----------------------------------------------------------------
       BUS-CIC-REG SECTION.                                             
       INI-BUS-CIC-REG.                                                 

           MOVE ZEROES                    TO WSS-IIC-IREG.
           MOVE SPACES                    TO WSS-IND-ERRO.
           MOVE WCC-M                     TO CIC-COD-TCIC IN CIC.       
           MOVE WCC-CF3                   TO CIC-COD-CCIC IN CIC.       
           MOVE CIC-GET                   TO CIC-CMND.                  
           PERFORM PRO-CIC.                                             
           IF CIC-STAT NOT = CIC-STAT-OKS                               
               MOVE 'S'    TO WSS-IND-ERRO
               PERFORM BCK-OUT
               GO TO FIN-BUS-CIC-REG                                    
           ELSE
               MOVE CIC-IIC-ICIC IN CIC TO WSS-IIC-IREG.



       FIN-BUS-CIC-REG.                                                 
           EXIT.                                                        
      *----------------------------------------------------------------
      *----------------------------------------------------------------
      *AFRI-FIN/29-ABR-2013 MOVILIDADES III

