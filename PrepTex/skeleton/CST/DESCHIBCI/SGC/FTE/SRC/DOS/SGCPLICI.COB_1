       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      SGCPLICI.
       AUTHOR.          CONSIST.
       DATE-WRITTEN.    23-Jan-90 10:24 AM.

      * Programa Listador de Reporte  sin Sort.

       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
      *DOS SELECT RPT       ASSIGN TO SYS011-UR-1403-S.
      *MVS SELECT RPT       ASSIGN TO        UT-S-RPT.
           SELECT RPT       ASSIGN TO SYS011-UR-1403-S.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       FD  RPT LABEL RECORD OMITTED
           REPORT IS RPT-
           .

       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY SGCBRDBC.
       COPY DIIRR.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGIFD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGRPT.
       COPY GNSBRTAB.
       COPY GNSBRMSG.
       COPY DIIRW.
      *<<<< RW
       COPY SGCRWHII.
      *>>>>
       COPY GNSWGSYS.
       01  PGM-STAT.
           03 PGM-STAT-SRT            VALUE ' ' PIC X(01).
              88 PGM-STAT-SRT-OKS     VALUE ' '.
              88 PGM-STAT-SRT-MAL     VALUE 'M'.
           03 PGM-SOKS                VALUE ' ' PIC X(01).
           03 PGM-SMAL                VALUE 'M' PIC X(01).
      *<<<< WSS
       COPY GNSWGCPT.
       COPY SGCWGCCT.
       COPY SGCWGMRL.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSBRTAB.
       COPY GNSBRRCE.
       COPY GNSBRCMT.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY SGCBRRCD.
       COPY SGCBROPE.
       COPY SGCBRRCO.
       COPY SGCBRAEP.
       COPY SGCBREFE.
       COPY SGCBRDSF.
       COPY SGCBRCHP.
       COPY SGCBRPHI.
       COPY TABBRCAM.
       COPY TABBROFI.
       COPY GNSWGMES.
       01  WSS-VARI.
           03 WSS-IDC-ICLI.
              05 WSS-NUM-ICLI                    PIC X(08).
              05 WSS-IND-ICLI                    PIC X(01).
              05 WSS-GLS-ICLI                    PIC X(03).
           03 WSS-VAL-TPAS                       PIC 9(11).
           03 WSS-GLS-IENT.
              05 WSS-KEY-FINF.
                 07 WSS-KEY-SINF                 PIC 9(02).
                 07 WSS-KEY-AINF                 PIC 9(02).
                 07 WSS-KEY-MINF                 PIC 9(02).
                 07 WSS-KEY-DINF                 PIC 9(02). 
              05 WSS-KEY-OFIP                    PIC X(03).
              05 WSS-KEY-ICLI                    PIC X(12).
              05 FILLER      VALUE SPACES        PIC X(07).
           03 WSS-COD-OFIP                       PIC X(03).
           03 WSS-FEC-FDSF.
              05 FILLER                          PIC X(02).
              05 WSS-NUM-MDSF                    PIC 9(02).
              05 WSS-NUM-SDSF                    PIC 9(02).
              05 WSS-NUM-ADSF                    PIC 9(02).
           03 WSS-FEC-FINF.
              05 WSS-NUM-DINF                    PIC X(02).
              05 WSS-NUM-MINF                    PIC 9(02).
              05 WSS-NUM-SINF                    PIC 9(02).
              05 WSS-NUM-AINF                    PIC 9(02).
           03 WSS-FEC-FCAM.
              05 WSS-NUM-SCAM                    PIC 9(02).
              05 WSS-NUM-ACAM                    PIC 9(02).
              05 WSS-NUM-MCAM                    PIC 9(02).
              05 WSS-NUM-DCAM                    PIC 9(02).
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AEP-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EFE-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DSF-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CHP-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PHI-REQA==. 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CMT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCE-REQA==.
      *>>>>

       REPORT SECTION.
      *--------------
       COPY DIIRF.
           .
       COPY DIIRT.
      *<<<< RT
       COPY SGCRTHII.
      *>>>>

       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       END DECLARATIVES.

       MAIN SECTION.
      *------------
       INI-MAIN.
       COPY GNSBGEDB.
           MOVE 'SGCPLICI' TO FIO-PROG.
           PERFORM BUS-FSIS.
       INI-INP-SRT.
      *<<<< INI_INP
           DISPLAY 'Captura de Parametros'.

           DISPLAY 'Oficina : '.
           ACCEPT  WSS-COD-OFIP IN WSS-VARI.
           DISPLAY WSS-COD-OFIP IN WSS-VARI.
           DISPLAY 'Fecha de Informe ( DDMMSSAA ) : '.
           ACCEPT  WSS-FEC-FINF IN WSS-VARI.
           DISPLAY WSS-FEC-FINF IN WSS-VARI.
           DISPLAY 'Ingrese IDC de Cliente : '. 
           ACCEPT  WSS-IDC-ICLI IN WSS-VARI.
           DISPLAY WSS-IDC-ICLI IN WSS-VARI.

           DISPLAY 'Fin Captura de Parametros'.
           DISPLAY 'Inicio validacion de Parametros'.

           MOVE WSS-COD-OFIP IN WSS-VARI TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS = 'COD    NEX'
               DISPLAY MSG-GLS-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
           MOVE 'TAB'        TO TAB-COD-SIST.
           MOVE 'COM'        TO TAB-COD-TTAB IN TAB.
           MOVE OFI-COD-COMU TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-LUGA IN WSS-HII.

           MOVE WSS-FEC-FINF IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-N   TO FEC-FBLK.
           MOVE FEC-CHOY-LE  TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY FEC-MENS
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE WSS-NUM-DINF IN WSS-VARI TO WSS-NUM-DINF IN WSS-HII
                                            WSS-NUM-DCAM IN WSS-VARI.
           MOVE MES-DMES IN MES-VARI(WSS-NUM-MINF IN WSS-VARI)
                                         TO WSS-GLS-MINF IN WSS-HII.
           MOVE WSS-NUM-MINF IN WSS-VARI TO WSS-NUM-MCAM IN WSS-VARI.
           MOVE WSS-NUM-SINF IN WSS-VARI TO WSS-NUM-SINF IN WSS-HII
                                            WSS-NUM-SCAM IN WSS-VARI.
           MOVE WSS-NUM-AINF IN WSS-VARI TO WSS-NUM-AINF IN WSS-HII
                                            WSS-NUM-ACAM IN WSS-VARI.

           DISPLAY 'Fin validacion de Parametros'.

      * Obtiene Codigo Valor de Cambio Mediante CIC de Dolar Americano
           MOVE 'TAB'          TO FIO-SIST.
           MOVE 'VLR'          TO TAB-CIC-TTAB IN TAB.
           MOVE '101301'       TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB'          TO MSG-COD-SIST
               MOVE 'CIC101301NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY MSG-GLS-DESC   TAB-CIC-CTAB
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.

           MOVE TAB-GLS-ABRV IN TAB TO WSS-GLS-VCAM IN WSS-DII.

      * Obtiene Valor de Cambio en Moneda Nacional
           MOVE WSS-FEC-FCAM IN WSS-VARI TO CAM-FEC-FCAM IN CAM(1).
           MOVE WSS-FEC-FCAM IN WSS-VARI TO CAM-FEC-FCAM IN CAM(2).
           MOVE TAB-COD-CTAB IN TAB      TO CAM-COD-VCAM IN CAM(1).
           MOVE '0999  '                 TO CAM-COD-VCAM IN CAM(2).
           MOVE FIO-GET-KEY  TO FIO-CMND.
           PERFORM TAB-FIO-CAM.
           IF FIO-STAT-OKS
               MOVE CAM-SGV-VCAM IN CAM TO WSS-SGV-VCAM IN WSS-DII
           ELSE
               DISPLAY 'NO EXISTE VALOR CAMBIO A ESTA FECHA : '
                            WSS-FEC-FINF
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *>>>>
           CALL 'GNSPLHDR' USING RPT-VARI.
           MOVE FIO-INP TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       FST-INP-SRT.
      *<<<< INI_FST_INP
           MOVE WSS-IDC-ICLI IN WSS-VARI TO DBC-IDC-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               GO TO LUP-INP-SRT
           ELSE
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CLI    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               DISPLAY WSS-IDC-ICLI IN WSS-VARI
               DISPLAY MSG-GLS-DESC IN MSG
               MOVE PGM-SMAL TO PGM-STAT-SRT
               GO TO FIN-INP-SRT.
      *>>>>
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       INI-OUT-SRT.
           OPEN OUTPUT RPT.
           INITIATE RPT-.
      *<<<< FST_OUT
           PERFORM BUS-WSS-GLS-MSG.
      *>>>>
       LUP-MAIN.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
      *<<<< LUP_INP
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBC.
      *>>>>
       MOV-INP-SRT.
       COPY DIIRM.
       LUP-OUT-SRT.
      *<<<< LUP_OUT
           GENERATE DL-HII.
      *     MOVE SPACES TO WSS-GLS-DCLB IN WSS-DII.
      *ALD
           MOVE 'BANCO DE CREDITO E INVERSIONES' TO WSS-GLS-DCLB
                                                      IN WSS-DII.
      *
      **************************************************************************
           IF DBC-COD-ACTI IN SRT > SPACES
               MOVE 'TAB'        TO TAB-COD-SIST
               MOVE 'ACT'        TO TAB-COD-TTAB
               MOVE DBC-COD-ACTI IN SRT TO TAB-COD-CTAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC TO WSS-GLS-ACTI IN WSS-DII
           ELSE
               MOVE SPACES TO WSS-GLS-ACTI IN WSS-DII.
      **************************************************************************
           MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           PERFORM BUS-DOM.  
           IF RCD-GLS-DIRE IN RCD NOT > SPACES
               MOVE '*' TO RCD-GLS-DIRE.
      **************************************************************************
           MOVE DBC-CIC-ICLI IN SRT TO DBC-CIC-ICLI IN DBC.
           MOVE SPACE               TO DBC-COD-OFIC IN DBC.
           PERFORM BUS-OLD-CCT.
           IF MSG-COD-MENS > SPACES
               MOVE ZEROS TO OPE.
      **************************************************************************
           IF DBC-IND-TICL IN SRT = 'P' 
               PERFORM BUS-AEP
           ELSE
               PERFORM BUS-EFE.
      **************************************************************************
           MOVE DBC-CIC-ICLI IN SRT TO DSF-CIC-ICLI IN DSF.
           MOVE 'DSF-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DSF.
           IF FIO-STAT-OKS
               ADD DSF-VAL-DVGN IN DSF
                   DSF-VAL-DVGX IN DSF
                   DSF-VAL-DVCN IN DSF
                   DSF-VAL-DVCX IN DSF
                   GIVING WSS-VAL-TDSF IN WSS-DII.

           MOVE 'SGC'  TO MSC-COD-SIST.
           MOVE 'FISF' TO MSC-COD-TMSC IN MSC.
           MOVE 'FDSF' TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-GLS-DATA IN MSC TO WSS-FEC-FDSF IN WSS-VARI.
           MOVE WSS-NUM-MDSF IN WSS-VARI TO WSS-NUM-MDSF IN WSS-DII.
           MOVE WSS-NUM-SDSF IN WSS-VARI TO WSS-NUM-SDSF IN WSS-DII.
           MOVE WSS-NUM-ADSF IN WSS-VARI TO WSS-NUM-ADSF IN WSS-DII.
      **************************************************************************
      *>>>>
           GENERATE DL-.
      *<<<< FIN_GEN_OUT
           GENERATE DL-FHII.
      *>>>>
       NXT-INP-SRT.
       NXT-OUT-SRT.
      *<<<< INI_NXT_INP
           GO TO FIN-INP-SRT.
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           GO TO LUP-MAIN.
       FIN-MAIN.
       FIN-INP-SRT.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
       FIN-OUT-SRT.
           TERMINATE RPT-.
           CLOSE RPT.
           PERFORM GNS-PRO-END.

       COPY SGCBFDBC.
       COPY GNSBGDTC.
       COPY GNSBGIFD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBFTAB.
       COPY GNSBFMSG.
       COPY GNSBGEND.

      *<<<< EOF
      **************************************************************************
       BUS-AEP SECTION.
       INI-BUS-AEP.
           MOVE DBC-CIC-ICLI IN SRT TO AEP-CIC-ICLI IN AEP.
           MOVE '99999999'  TO AEP-FEC-FAEP IN AEP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-AEP.
           IF FIO-STAT-OKS  AND
              DBC-CIC-ICLI IN SRT = AEP-CIC-ICLI IN AEP
               MOVE AEP-NUM-DAEP IN AEP TO WSS-NUM-DESB IN WSS-DII
               MOVE AEP-NUM-MAEP IN AEP TO WSS-NUM-MESB IN WSS-DII
               MOVE AEP-NUM-SAEP IN AEP TO WSS-NUM-SESB IN WSS-DII
               MOVE AEP-NUM-AAEP IN AEP TO WSS-NUM-AESB IN WSS-DII
               MOVE 'SGC'        TO MSC-COD-SIST
               MOVE 'ESBL'       TO MSC-COD-TMSC
               MOVE 'S'          TO MSC-COD-CMSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR TO WSS-GLS-ESOB IN WSS-DII

               ADD  AEP-VAL-DPZO IN AEP
                    AEP-VAL-ACBO IN AEP
                    AEP-VAL-BIRA IN AEP
                    AEP-VAL-VEHI IN AEP
                    AEP-VAL-ASOC IN AEP
                    AEP-VAL-OACT IN AEP
                                    GIVING WSS-VAL-TACT IN WSS-DII

               ADD  AEP-VAL-DBYC IN AEP
                    AEP-VAL-DHIP IN AEP
                    AEP-VAL-OPAS IN AEP
                                    GIVING WSS-VAL-TPAS IN WSS-VARI
               SUBTRACT WSS-VAL-TPAS IN WSS-VARI FROM
                        WSS-VAL-TACT IN WSS-DII
                                    GIVING WSS-VAL-PATR IN WSS-DII

               MOVE ZEROES TO EFE-VAL-ACIR IN EFE
               MOVE ZEROES TO WSS-VAL-OACT IN WSS-DII
               MOVE ZEROES TO EFE-VAL-PCIR IN EFE
               MOVE ZEROES TO EFE-VAL-PLPZ IN EFE
               MOVE ZEROES TO EFE-SGV-UTIL IN EFE
           ELSE
               MOVE 'SITUACION'  TO WSS-GLS-ESOB IN WSS-DII.
       FIN-BUS-AEP.
           EXIT.

       BUS-EFE SECTION.
       INI-BUS-EFE.
           MOVE DBC-CIC-ICLI IN SRT TO EFE-CIC-ICLI IN EFE.
           MOVE '99999999'  TO EFE-FEC-FEFE IN EFE.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM SGC-FIO-EFE.
           IF FIO-STAT-OKS  AND
              DBC-CIC-ICLI IN SRT = EFE-CIC-ICLI IN EFE
               MOVE EFE-NUM-DEFE IN EFE TO WSS-NUM-DESB IN WSS-DII
               MOVE EFE-NUM-MEFE IN EFE TO WSS-NUM-MESB IN WSS-DII
               MOVE EFE-NUM-SEFE IN EFE TO WSS-NUM-SESB IN WSS-DII
               MOVE EFE-NUM-AEFE IN EFE TO WSS-NUM-AESB IN WSS-DII

               MOVE 'SGC'        TO MSC-COD-SIST
               MOVE 'ESBL'       TO MSC-COD-TMSC
               MOVE EFE-IND-ESBL IN EFE TO MSC-COD-CMSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DCOR TO WSS-GLS-ESOB IN WSS-DII

               ADD  EFE-VAL-AFIJ IN EFE
                    EFE-VAL-OACT IN EFE
                                    GIVING WSS-VAL-OACT IN WSS-DII

               ADD  EFE-VAL-ACIR IN EFE
                    EFE-VAL-AFIJ IN EFE
                    EFE-VAL-OACT IN EFE
                                    GIVING WSS-VAL-TACT IN WSS-DII
               MOVE EFE-SGV-PATR IN EFE TO WSS-VAL-PATR IN WSS-DII
           ELSE
               MOVE 'BALANCE'    TO WSS-GLS-ESOB IN WSS-DII.
       FIN-BUS-EFE.
           EXIT.
      **************************************************************************
       BUS-WSS-GLS-MSG SECTION.
       INI-BUS-WSS-GLS-MSG.
           MOVE SPACES TO WSS-GLS-IENT IN WSS-VARI.
           MOVE WSS-NUM-DINF IN WSS-VARI TO WSS-KEY-DINF IN WSS-VARI.
           MOVE WSS-NUM-MINF IN WSS-VARI TO WSS-KEY-MINF IN WSS-VARI.
           MOVE WSS-NUM-SINF IN WSS-VARI TO WSS-KEY-SINF IN WSS-VARI.
           MOVE WSS-NUM-AINF IN WSS-VARI TO WSS-KEY-AINF IN WSS-VARI.
           MOVE WSS-COD-OFIP IN WSS-VARI TO WSS-KEY-OFIP IN WSS-VARI.
           MOVE DBC-CIC-ICLI IN SRT      TO WSS-KEY-ICLI IN WSS-VARI.
           MOVE 'SGC'                    TO RCE-COD-SIST IN RCE.
           MOVE 'ICI'                    TO RCE-COD-ENTI IN RCE.
           MOVE WSS-GLS-IENT IN WSS-VARI TO RCE-GLS-IENT IN RCE.
           MOVE SPACES                   TO RCE-COD-SENT IN RCE.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           MOVE 'RCE-KEY-IENT' TO FIO-AKEY.
           PERFORM GNS-FIO-RCE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE RCE-CIC-IENT IN RCE TO CMT-CIC-IENT IN CMT.
           MOVE SPACES              TO CMT-FEC-FCMT IN CMT.
           MOVE ZEROES              TO CMT-NUM-ICMT IN CMT.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT )
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE CMT-GLS-REFE IN CMT TO WSS-GLS-REF1 IN WSS-HII.
           MOVE CMT-GLS-FILL IN CMT TO WSS-GLS-DEST IN WSS-HII.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT )
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE CMT-GLS-CMTR IN CMT(1) TO WSS-GLS-DIRE IN WSS-HII.
           MOVE CMT-GLS-CMTR IN CMT(2) TO WSS-GLS-PAIS IN WSS-HII.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT )
               GO TO FIN-BUS-WSS-GLS-MSG.
           IF CMT-GLS-CMTR IN CMT(1) NOT > SPACES
               MOVE DBC-CIC-ICLI IN SRT TO MRL-CIC-ICLI IN MRL
               PERFORM CAL-MRL
               IF NOT FIO-STAT-OKS
                   MOVE 'NO DEFINIDA' TO WSS-GLS-MORA IN WSS-DII
               ELSE
                   IF MRL-IND-PROT IN MRL = 'S'
                       MOVE 'REGISTRA PROTESTO(S) SIN ACLARAR'
                                  TO WSS-GLS-MORA IN WSS-DII
                   ELSE
                       MOVE 'CUMPLE ' TO WSS-GLS-MORA IN WSS-DII
           ELSE
               MOVE CMT-GLS-CMTR IN CMT(1) TO WSS-GLS-MORA IN WSS-DII.
           MOVE CMT-GLS-CMTR IN CMT(2) TO WSS-GLS-TICR IN WSS-DII.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM GNS-FIO-CMT.
           IF NOT ( FIO-STAT-OKS AND
                    RCE-CIC-IENT IN RCE = CMT-CIC-IENT IN CMT )
               GO TO FIN-BUS-WSS-GLS-MSG.
           MOVE CMT-GLS-CMTR IN CMT(1) TO WSS-GLS-CGAR IN WSS-DII.
           MOVE CMT-GLS-CMTR IN CMT(2) TO WSS-GLS-SGAR IN WSS-DII.
       FIN-BUS-WSS-GLS-MSG.
           EXIT.
      **************************************************************************

       COPY GNSBFMSG.
       COPY GNSBFMSC.
       COPY GNSBFTAB.
       COPY GNSBFRCE.
       COPY GNSBFCMT.
       COPY SGCBFRCD.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       COPY SGCBFEFE.
       COPY SGCBFAEP.
       COPY SGCBFDSF.
       COPY SGCBFCHP.
       COPY SGCBFPHI.
       COPY TABBFCAM.
       COPY TABBFOFI.
       COPY TABBVOFI.
       COPY GNSBBMSG.
       COPY GNSBBMSC.
       COPY GNSBBTAB.
       COPY GNSBGHOY.
       COPY GNSBGFEC.
       COPY GNSBGCPT.
       COPY SGCBGCLI.
       COPY SGCBGDOM.
       COPY SGCBGCCT.
       COPY SGCBGMRL.
