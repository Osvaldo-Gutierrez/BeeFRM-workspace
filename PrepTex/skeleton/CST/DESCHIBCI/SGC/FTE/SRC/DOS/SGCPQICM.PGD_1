       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   SGCPQICM.
       AUTHOR.       CONSIST.
       DATE-WRITTEN. 08-May-19 11:40 AM.

      * NOMBRE PROGRAMA                   SGCPQICM
      * VERSION PGM                       3.1
      * VERSION SKL                       19.04.15
      * OPCION                            CON
      * ARCHIVO BASE                      SGCDCC
      * PANTALLA                          SGCICM
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250


       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-SGCPQICM-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$SGCPQICM$ SKL=$19.04.15$ VSN=${vsnpq}$        
      -    'GEN=$08-May-19 11:40 AM$ FNC=${fncpq}$/>'.    

       COPY GNSWCSCR.
       COPY GNSWVSCR.
      *<<<< FIN_SCR_VARI
      *ISP ENGANCHE :
      * MODULO PARA ENGANCHE PROGRAMA ICM - RCO. VARIABLES EN COMMAREA
      * LLAVE DE LA OPERACION, INDICADOR SI ESTA ENGANCHADO, ORIGEN,ETC
      * LAS PRIMERAS VARIABLES DE EXTENSION DE COMMAREA DE PROGRAMAS
      * ENGANCHADOS DEBEN SER LAS DEL ENGANCHE.
       COPY SGCWGENG.
      *>>>>
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-DBC-REQA==.
           02 SCR-KEY-IDBC                     PIC X(03).
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-RCO-REQA==.
           02 SCR-KEY-IRCO                     PIC X(03).
      *>>>>
       COPY SGCWIICM.

       COPY SGCBRDCC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *<<<< WSS
      *ISP ENGANCHE :
      *    TABLAS DE TRANSACCIONES, PROGRAMAS, MAPAS INVOLUCRADOS
      *    EN EL ENGANCHE
      * 'W'SS, 'I'CC, 'R'CO
       COPY SGCWGPMP.
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-REC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUX-REQA==.
      *DAD ini  22-MAY-1992
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
      *DAD fin  22-MAY-1992
      *DAD ini  20-AGO-1993
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CTL-REQA==.
      *DAD fin  20-AGO-1993
      *>>>>
      *<<<< WSS_IBM
      *ALD
       COPY GNSBRJGN.
      *DAD ini  24-ABR-1992
      * COPY SGCBRMCC.
      *DAD fin  24-ABR-1992
       COPY GNSWGBCD.
      *
      *DAD ini  02-MAY-1991
       COPY SGCBRPER.
      *DAD fin  02-MAY-1991
       COPY SGCBRDBC.
       COPY SGCBRRCD.
       COPY SGCBROPE.
       COPY SGCBRRCO.
       COPY SGCBRREC.
      *DAD ini  22-MAY-1992
       COPY SGCBRDCP.
       COPY SGCBRDCE.
      *DAD fin  22-MAY-1992
      *DAD ini  20-AGO-1993
       COPY SGCBRCTL.
      *DAD fin  20-AGO-1993
       COPY SGCWGCCT.
       COPY SGCWVPPU.
       COPY TABBRPAI.
      *DAD ini  07-MAR-1991
       COPY GNSWGSTR.
      *DAD fin  07-MAR-1991
       COPY GNSWGCPT.

       01  WSS-VARI.
           03 WSS-NRO-CCTA                       PIC 9(08).
           03 WSS-NRO-RINF                       PIC 9(08).
           03 WSS-NRO-RSUP                       PIC 9(08).
           03 WSS-NRO-RINI                       PIC 9(08).
           03 WSS-NRO-RSUI                       PIC 9(08).
           03 WSS-RNG-CCTA.
              05 WSS-FIL01                       PIC X(10).
              05 WSS-NUM-RINI                    PIC X(08).
              05 WSS-FIL02                       PIC X(02).
              05 WSS-NUM-RSUI                    PIC X(08).
              05 WSS-FIL03                       PIC X(02).
              05 WSS-NUM-RINF                    PIC X(08).
              05 WSS-FIL04                       PIC X(02).
              05 WSS-NUM-RSUP                    PIC X(08).
              05 WSS-FIL05                       PIC X(12).
           03 WSS-CTA-CCTE.
              05 WSS-NUM-CCTE                    PIC 9(07).
              05 WSS-VRF-CCTE                    PIC 9(01).
           03 WSS-COD-LUGA.
              05  WSS-COD-COMU                   PIC X(04).
              05  WSS-GLS-PAIS REDEFINES WSS-COD-COMU.
                  07  WSS-IND-PAIS                PIC X(01).
                  07  WSS-COD-PAIS                PIC X(03).
           03  WSS-IND-IEDS                       PIC X(01).
           03  WSS-IND-IBAL                       PIC X(01).
           03  WSS-FEC-FHOY.
               05  WSS-NUM-DHOY                   PIC 9(02).
               05  WSS-NUM-MHOY                   PIC 9(02).
               05  WSS-NUM-AHOY                   PIC 9(02).
           03  WSS-AUX                COMP        PIC 9(02).
           03  WSS-DIG                            PIC 9(01).
           03  WSS-AUX-DLIM.
               05  WSS-AUX-DLI1                   PIC X(01).
               05  WSS-AUX-DLI2                   PIC X(01).
           03  WSS-RUT.
               05  WSS-FILLER                     PIC 9(03).
               05  WSS-GLS-RUT.
                   07  WSS-NUM-RUT                PIC X(07).
                   07  WSS-NUM-DIG                PIC X(01).
               05  WSS-NUM-VRF                    PIC X(01).
           03  WSS-SIN-BRUT.
               05  WSS-FIL1                       PIC 9(03).
               05  WSS-GLS-SINB                   PIC X(07).
           03  WSS-BCD-RUT.
               05  WSS-NUM-BRUT                   PIC X(05).
               05  WSS-VRF-BRUT                   PIC X(01).
           03  WSS-CIC-IOPE.
               05  WSS-NUM-DIGI                   PIC X(02).
               05  WSS-IIC-IOPE                   PIC X(08).
           03  WSS-CIC-MOTC.
               05  WSS-CIC-MOT1                   PIC X(02).
               05  WSS-CIC-MOT2                   PIC X(10).
           03  WSS-CIC-ACTI.
               05  WSS-CIC-ACT1                   PIC X(02).
               05  WSS-CIC-ACT2                   PIC X(09).
      *DAD ini  05-JUN-1992 ( Codigo Incorporado a peticion RM )
      *     03  WSS-COD-OFIC                       PIC X(03).
           03 WSS-IDE-OFCT.
              05  WSS-COD-OFIC                   PIC X(03).
              05  FILLER           VALUE SPACES  PIC X(01).
              05  WSS-TIP-CCTA                   PIC X(02).
              05  FILLER           VALUE SPACES  PIC X(54).
      *DAD fin  05-JUN-1992
      *DAD ini  11-MAR-1991
           03  WSS-CIC-ICLI                       PIC X(12).
      *DAD fin  11-MAR-1991
      *DAD ini  02-MAY-1991
           03  WSS-CTA-CTE                        PIC X(08).
               88 VAL-CCTE-DOLAR   VALUES '11060000' THRU '11209999'.
      *DAD fin  02-MAY-1991
      *DAD ini  22-MAY-1992
           03  WSS-GLS-ERRO.
               05  WSS-GLS-ERR0                   PIC X(03).
               05  WSS-GLS-ERR1                   PIC X(10).
               05  WSS-GLS-ERR2                   PIC X(20).
      *DAD fin  22-MAY-1992
      ******************************************************************
      *DAD ini  23-MAR-1992
           03  WSS-COD-CCTE                       PIC X(12).
      * ---- agregado por odj desde aqui (g)
       01  W-REGISTROS-DE-TRABAJO.
           05 WR-OPE                    PIC X(150).
      *RJZ INI 25-JAN-1995 09:47:55
      **     05 WR-TIPO-CTAPRI            PIC X(02).
           05 WR-TIPO-CTAPRI            PIC X(03).
      *RJZ FIN 25-JAN-1995 09:51:34
           05 WR-CAMBIA-CTACTE          PIC X(02).
           05 WR-GLS-TCOM               PIC X(07).
           05 WR-GLS-TCOM-NUM REDEFINES WR-GLS-TCOM PIC 9(05)V9(02).
      * ---- agregado por odj hasta aqui (g)
      *DAD fin  23-MAR-1992
      ******************************************************************
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-DBC.
                 88 PGM-STAT-DBC-NUL    VALUE '  '.
                 07 PGM-STT1-DBC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DBC-OKS VALUE '0'.
                 07 PGM-STT2-DBC        VALUE '3' PIC X(01).
              05 PGM-STAT-DCC.
                 88 PGM-STAT-DCC-NUL    VALUE '  '.
                 07 PGM-STT1-DCC        VALUE '2' PIC X(01).
                    88 PGM-STAT-DCC-OKS VALUE '0'.
                 07 PGM-STT2-DCC        VALUE '3' PIC X(01).
              05 PGM-STAT-OPE.
                 88 PGM-STAT-OPE-NUL    VALUE '  '.
                 07 PGM-STT1-OPE        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPE-OKS VALUE '0'.
                 07 PGM-STT2-OPE        VALUE '3' PIC X(01).
              05 PGM-STAT-RCO.
                 88 PGM-STAT-RCO-NUL    VALUE '  '.
                 07 PGM-STT1-RCO        VALUE '2' PIC X(01).
                    88 PGM-STAT-RCO-OKS VALUE '0'.
                 07 PGM-STT2-RCO        VALUE '3' PIC X(01).
              05 PGM-STAT-RCD.
                 88 PGM-STAT-RCD-NUL    VALUE '  '.
                 07 PGM-STT1-RCD        VALUE '2' PIC X(01).
                    88 PGM-STAT-RCD-OKS VALUE '0'.
                 07 PGM-STT2-RCD        VALUE '3' PIC X(01).
              05 PGM-STAT-PER.
                 88 PGM-STAT-PER-NUL    VALUE '  '.
                 07 PGM-STT1-PER        VALUE '2' PIC X(01).
                    88 PGM-STAT-PER-OKS VALUE '0'.
                 07 PGM-STT2-PER        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
      *<<<< CMA
           02 FILLER                      PIC X(2220).
      *>>>>
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO ICM-FLD.
           MOVE LOW-VALUES TO ICM-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +2220 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'SGCPQICM' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *<<<< INI_FIO
           MOVE +2220 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               PERFORM GNS-CLR-RQA.
      *>>>>
      *<<<< INI_FIO AND PGM_DTC AND PGM_V31
      *DAD ini  02-MAY-1991
           PERFORM GNS-HDL-VSM.
      *DAD fin  02-MAY-1991
      *>>>>
      *<<<< INI_FIO
      *ISP ENGANCHE :
           IF SCR-DESDE-CMN
      * MARCA PARA RCO QUE INGRESO POR 'O'PE O IC'M'
               MOVE 'M'    TO SCR-IND-OOD
               MOVE 1      TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FTER-CIC
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               PERFORM ING-FTER-CIC.
       FIN-INI-FIO.
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-ICM.
           PERFORM EDT-KEY-ICM.
           PERFORM EDT-FLD-ICM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-MOD.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-ICM
               PERFORM VAL-NUM-FLD-ICM.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           PERFORM GNS-CLR-RQA.
      *>>>>
       MSG-SCR-MOD.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       BRW-SCR-MOD SECTION.
       INI-BRW-SCR-MOD.
       FIN-BRW-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-ICM
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-ICM
               PERFORM VAL-NUM-FLD-ICM
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
      *<<<< BRW_SCR_ACC
      *DAD ini  23-MAR-1992
      * Para recibir el Mapa en el PQ
           MOVE SCR-NMAP    TO FRM-NAME.
           MOVE SCR-NLIB    TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES   TO FRM-MENS.
           MOVE FRM-DFLD TO ICM-FLD.
      *DAD fin  23-MAR-1992
      *>>>>
       FIN-BRW-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ELI.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-ICM
               PERFORM VAL-NUM-FLD-ICM
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       BRW-SCR-ELI SECTION.
       INI-BRW-SCR-ELI.
       FIN-BRW-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF FIO-STAT-OKS
                            MOVE SCR-ACTU-MOD TO SCR-ACTU
                            PERFORM PUT-SCR
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FIO-STAT-EOF
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGEOF    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                        IF FIO-STAT = FIO-STAT-NEX
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGNEX    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                            MOVE SCR-ACTU-ING TO SCR-ACTU
      *JSS                  PERFORM CLR-FLD-ICM
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACT
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACT.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACT
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-ICM
               PERFORM VAL-NUM-FLD-ICM.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACT.
           EXIT.

       BRW-SCR-ACT SECTION.
       INI-BRW-SCR-ACT.
       FIN-BRW-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF FRM-STAT-ABT
                    MOVE SPACES TO FRM-MENS
                    PERFORM SCR-MSSG
                    PERFORM DESSCRTRL
                    GO TO FIN-SCR-PGM
                ELSE
                    MOVE SPACES TO FRM-MENS
                    PERFORM FND-KEY
                    IF FIO-STAT = FIO-STAT-NEX
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGNEX    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                    ELSE
                        MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                        PERFORM SCR-TRL
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       BRW-SCR-PGM SECTION.
       INI-BRW-SCR-PGM.
       FIN-BRW-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-ICM
               PERFORM EDT-KEY-ICM
               PERFORM EDT-FLD-ICM
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-ICM
               PERFORM EDT-KEY-ICM
           ELSE
               PERFORM CLR-FLD-ICM
               PERFORM EDT-FLD-ICM.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-ICM.
       ERR-SCR-KEY.
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO ICM-FLD.
           MOVE LOW-VALUES TO ICM-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY
           PERFORM KEY-ALL-ICM.
           MOVE FRM-GLS-NOMC IN ICM-FLD TO DBC-GLS-NOMC IN DBC.
      *<<<< PGM_DTC
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-ICM
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-GLS-NOMC IN ICM-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN ICM-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN ICM-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN ICM-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN ICM-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO DCC-CAI-ICLI IN ICM-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DCC-IIC-ICLI IN ICM-FLD
                   GO TO CON-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'SGC'          TO MSG-COD-SIST
                       MOVE 'DCC    NOPRV' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC'          TO MSG-COD-SIST
                       MOVE 'DCC    NONXT' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00'         TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                       GO TO FIN-FND-KEY.
      *DAD ini  11-MAR-1991
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               IF SCR-RCO-REQA > SPACES
                   PERFORM LEE-NXT-PRV-RCO
               ELSE
                   MOVE 'GNS'    TO MSG-COD-SIST
                   MOVE 'PFSINV' TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               IF MSG-COD-MENS > SPACES
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   GO TO FIN-FND-KEY.
      *DAD fin  11-MAR-1991
      *>>>>
           IF DBC-NUM-ICLI IN ICM-FLD > ZEROES
      *IDC-CLI Busca Cliente por medio de IdC
               MOVE DBC-NUM-ICLI IN ICM-FLD TO DBC-NUM-ICLI IN DBC
               MOVE DBC-IND-ICLI IN ICM-FLD TO DBC-IND-ICLI IN DBC
               MOVE DBC-GLS-ICLI IN ICM-FLD TO DBC-GLS-ICLI IN DBC
               MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY
               MOVE FIO-GET-KEY-ALT TO FIO-CMND
               PERFORM GET-CLI
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
      *<<<< PGM_DTC
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
      *>>>>
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-GLS-NOMC IN ICM-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO DCC-CAI-ICLI IN ICM-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DCC-IIC-ICLI IN ICM-FLD
           ELSE
           IF FRM-GLS-NOMC IN ICM-FLD > SPACES
               MOVE SPACES TO DBC-GLS-NOMC IN DBC
      *NOM-CLI Busca Cliente por medio del Nombre
      *DAD ini  07-MAR-1991
               MOVE FRM-GLS-NOMC IN ICM-FLD TO STR-GLS-GSTR
               PERFORM STR-UNS
               MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
               MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC
      *DAD fin  07-MAR-1991
               MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY
               MOVE FIO-GET-NLS-ALT TO FIO-CMND
               PERFORM GET-CLI
               MOVE FIO-STAT TO PGM-STAT-DBC
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00'         TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
      *<<<< PGM_DTC
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
      *>>>>
                   MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
                   PERFORM CPT-BLKS
                   MOVE CPT-STRN            TO FRM-GLS-NOMC IN ICM-FLD
                   MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN ICM-FLD
                   MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN ICM-FLD
                   MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN ICM-FLD
                   MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN ICM-FLD
                   MOVE DBC-CAI-ICLI IN DBC TO DCC-CAI-ICLI IN ICM-FLD
                   MOVE DBC-IIC-ICLI IN DBC TO DCC-IIC-ICLI IN ICM-FLD.
       CON-FND-KEY.
           PERFORM RET-DBC-ICM.
           PERFORM KEY-DBC-ICM.
      *>>>>
           PERFORM KEY-ALL-ICM.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCC.
           MOVE FIO-STAT TO PGM-STAT-DCC.
      *<<<< FIN_FND_KEY
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               MOVE '00' TO FIO-STAT
               GO TO CON-FIN-FND-KEY.
           IF SCR-CMND = 'ACC'
               MOVE '00' TO FIO-STAT
               GO TO FIN-FND-KEY.
           IF SCR-CMND = 'CCC'
               MOVE DCC-CAI-ICLI IN ICM-FLD TO DBC-CAI-ICLI IN DBC
               MOVE DCC-IIC-ICLI IN ICM-FLD TO DBC-IIC-ICLI IN DBC
               GO TO BUS-PRES.
       CON-FIN-FND-KEY.
           MOVE DCC-CAI-ICLI IN ICM-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DCC-IIC-ICLI IN ICM-FLD TO DBC-IIC-ICLI IN DBC.
           PERFORM BUS-OLD-CCT.
           IF (MSG-COD-MENS > SPACES AND
      *DAD ini  23-MAR-1992
               MSG-COD-MENS NOT = 'CLI    NOCCT') OR
              (MSG-COD-MENS = 'CLI    NOCCT' AND SCR-CMND NOT = 'ACC')
      *DAD fin  23-MAR-1992
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00'         TO FIO-STAT
               MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-FND-KEY.
           IF MSG-COD-MENS NOT > SPACES
               MOVE '00' TO PGM-STAT-OPE
               PERFORM BUS-RCO
      *<<<< PGM_DTC
      *DAD ini  11-MAR-1991
               MOVE ADR-RCO-REQA TO SCR-RCO-REQA
      *DAD fin  11-MAR-1991
      *>>>>
           ELSE
               PERFORM BUS-DOM
               PERFORM PUT-RCD
               MOVE SPACES                   TO OPE-COD-OFOP IN OPE
               MOVE SPACES                   TO OPE-IND-MCLI IN OPE
               MOVE SPACES                   TO OPE-CAI-IOPE IN OPE
               MOVE ZEROES                   TO OPE-IIC-IOPE IN OPE
               MOVE SPACES                   TO OPE-FEC-FIOP IN OPE
               MOVE SPACES                   TO OPE-COD-EJOP IN OPE
               MOVE SPACES                   TO OPE-COD-VCOP IN OPE
               MOVE SPACES                   TO OPE-FEC-FTOP IN OPE
               MOVE SPACES                   TO OPE-COD-MOTT IN OPE
      ******************************************************************
      *DAD ini  23-MAR-1992
      * -------- agregado por odj desde aqui (d)
               MOVE SPACES                   TO OPE-CAI-ICAR IN OPE
               MOVE SPACES                   TO OPE-IIC-ICAR IN OPE
               MOVE SPACES                   TO OPE-COD-TCOM IN OPE
      * -------- agregado por odj hasta aqui (d)
      *DAD fin  23-MAR-1992
      ******************************************************************
               MOVE WSS-COD-OFIC IN WSS-VARI TO OPE-COD-OFOP IN OPE
               MOVE '00' TO PGM-STAT-OPE.
       BUS-PRES.
           PERFORM BUS-RCP.
           PERFORM PUT-RCP.
           PERFORM RET-DBC-ICM.
           PERFORM KEY-DBC-ICM.
           MOVE '00' TO FIO-STAT.
           IF SCR-CCPP = 'ING'
               MOVE PGM-STAT-DCC TO FIO-STAT
               GO TO FIN-FND-KEY.
      *>>>>
       FIN-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
      *<<<< PUT_SCR
      *DAD ini  05-JUN-1992 / 22-MAY-1992
      *     IF SCR-CMND = 'ACC'
      *         PERFORM CHK-DBC-TICL.
      *DAD fin  05-JUN-1992 / 22-MAY-1992
      *DAD ini  23-MAR-1992 / 02-MAY-1991
           IF PGM-STAT-OPE-OKS
               MOVE OPE-IIC-IOPE IN OPE TO PER-KEY-IPER IN PER
               PERFORM SGC-FIO-PER
               MOVE FIO-STAT TO PGM-STAT-PER.
      *DAD fin  23-MAR-1992 / 02-MAY-1991
      *>>>>
           PERFORM PUT-ALL-ICM.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE ICM-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO ICM-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-ICM
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO ICM-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-ICM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-ICM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-ICM.
           PERFORM VAL-IKY-ICM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-ICM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-ICM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-ICM.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-ICM.
       ERR-SCR-GKEY.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-ICM.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-ICM
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO ICM-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-ICM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-ICM
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-ICM.
           PERFORM VAL-IKY-ICM.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-ICM.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-ICM.
       ERR-SCR-GIKY.
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-ICM.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD = FRM-FFLD-PF6 OR
                FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD = FRM-FFLD-PF8 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO ICM-GLS-MEN2
               MOVE SCR-PRMT     TO ICM-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO ICM-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO ICM-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
           IF SCR-DESDE-CMN
               MOVE ICM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO ICM-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-ICM

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO ICM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO ICM-GLS-MENS.
           PERFORM PRO-MKY-ICM.
           PERFORM PRO-AKY-ICM.
           PERFORM UNP-IKY-ICM.
           PERFORM FST-KEY-ICM.
           MOVE '1' TO FRM-CPIM-AEY.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
           IF SCR-DESDE-CMN
               MOVE ICM-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO ICM-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO ICM-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO ICM-GLS-MENS.
           PERFORM UNP-KEY-ICM.
           PERFORM FST-KEY-ICM.
           MOVE '1' TO FRM-CPIM-AEY.
      *<<<< FIN_HBL_KEY
      *DAD ini  23-MAR-1992
           PERFORM PRO-FLD-ICM.
      *DAD fin  23-MAR-1992
      *>>>>
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-ICM.
           PERFORM PRO-AKY-ICM.
           PERFORM UNP-MKY-ICM.
           PERFORM UNP-FLD-ICM.
           PERFORM FST-FLD-ICM.
      *<<<< FIN_HBL_FLD
      *DAD ini  02-MAY-1991 / 05-MAR-1991
           IF SCR-CMND = 'MEJ'
               PERFORM PRO-MKY-ICM
               PERFORM PRO-FLD-ICM
               MOVE FRM-CPIM-UBY TO OPE-COD-EJOP-ATR IN ICM-FLD
           ELSE
      *DAD fin  02-MAY-1991 / 05-MAR-1991
           IF SCR-CMND = 'ACC' OR
              SCR-CMND = 'CCC'
               MOVE '0000' TO OPE-CAI-IOPE IN ICM-FLD
               IF SCR-CMND = 'ACC'
                   MOVE FRM-CPIM-AEY TO OPE-FEC-FTOP-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO OPE-COD-MOTT-ATR IN ICM-FLD
               ELSE
                   MOVE FRM-CPIM-AEY TO RCO-NUM-DIRE-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO OPE-COD-OFOP-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO FRM-NUM-ICLP-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO FRM-IND-ICLP-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO FRM-GLS-ICLP-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO FRM-VRF-ICLP-ATR IN ICM-FLD
      *            MOVE FRM-CPIM-AEY TO FRM-GLS-NCLP-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO OPE-FEC-FIOP-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO OPE-COD-EJOP-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO FRM-IND-MCLI-ATR IN ICM-FLD
      *DAD ini  02-MAY-1991
                   MOVE FRM-CPIM-AEY TO PER-GLS-NOM1-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO PER-GLS-NOM2-ATR IN ICM-FLD
      *DAD fin  02-MAY-1991
      ******************************************************************
      *DAD ini  23-MAR-1992 PU
      *----- agregado por odj desde aqui (o)
                   MOVE FRM-CPIM-AEY TO OPE-COD-TCOM-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO OPE-IIC-ICAR-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO OPE-CAI-ICAR-ATR IN ICM-FLD
      *----- agregado por odj hasta aqui (o)
      *DAD fin  23-MAR-1992
      ******************************************************************
           ELSE
           IF SCR-CMND = 'MCC'
               PERFORM PRO-FLD-ICM
      *DAD ini  23-MAR-1992
      *         MOVE '0000'       TO OPE-CAI-IOPE     IN ICM-FLD
      *         MOVE FRM-CPIM-UBY TO OPE-CAI-IOPE-ATR IN ICM-FLD
      *         MOVE FRM-CPIM-UBY TO OPE-IIC-IOPE-ATR IN ICM-FLD
               MOVE 0            TO OPE-IIC-IOPE-LEN IN ICM-FLD
               MOVE -1           TO RCO-NUM-DIRE-LEN IN ICM-FLD
      *DAD fin  23-MAR-1992
               MOVE FRM-CPIM-UBY TO RCO-NUM-DIRE-ATR IN ICM-FLD
      *DAD ini  02-MAY-1991
               MOVE FRM-CPIM-UBY TO PER-GLS-NOM1-ATR IN ICM-FLD
               MOVE FRM-CPIM-UBY TO PER-GLS-NOM2-ATR IN ICM-FLD
      *DAD fin  02-MAY-1991
      ******************************************************************
      *DAD ini  23-MAR-1992 PU
      *----- agregado por odj desde aqui (p)
               MOVE FRM-CPIM-UBY TO OPE-COD-TCOM-ATR IN ICM-FLD
               MOVE FRM-CPIM-UBY TO OPE-IIC-ICAR-ATR IN ICM-FLD
               MOVE FRM-CPIM-UBY TO OPE-CAI-ICAR-ATR IN ICM-FLD
      *----- agregado por odj hasta aqui (p)
      *DAD fin  23-MAR-1992
      ******************************************************************
           ELSE
           IF SCR-CMND = 'INS'
               PERFORM PRO-FLD-ICM
               MOVE '0000'       TO OPE-CAI-IOPE     IN ICM-FLD
               MOVE FRM-CPIM-UBY TO OPE-CAI-IOPE-ATR IN ICM-FLD
               MOVE FRM-CPIM-UBY TO OPE-IIC-IOPE-ATR IN ICM-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO RCO-NUM-DIRE-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-COD-OFOP-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-FEC-FIOP-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-FEC-FTOP-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-CAI-IOPE-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-IIC-IOPE-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-COD-MOTT-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-COD-EJOP-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-MCLI-ATR IN ICM-FLD
      *DAD ini  02-MAY-1991
               MOVE FRM-CPIM-AEY TO PER-GLS-NOM1-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO PER-GLS-NOM2-ATR IN ICM-FLD
      *DAD fin  02-MAY-1991
      ******************************************************************
      *DAD ini  23-MAR-1992 PU
      *----- agregado por odj desde aqui (p)
               MOVE FRM-CPIM-AEY TO OPE-COD-TCOM-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-IIC-ICAR-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-CAI-ICAR-ATR IN ICM-FLD
      *----- agregado por odj hasta aqui (p)
      *DAD fin  23-MAR-1992
      ******************************************************************
      *         IF SCR-CCPP = 'MOD'
               MOVE FRM-CPIM-AEY TO FRM-NUM-ICLP-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-ICLP-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-ICLP-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO FRM-VRF-ICLP-ATR IN ICM-FLD.

      *         MOVE FRM-CPIM-AEY TO FRM-GLS-NCLP-ATR IN ICM-FLD.
      ******************************************************************
      *DAD ini  23-MAR-1992 PQ
      * ---- agregado por odj desde aqui (e)
           IF SCR-CMND = 'MEJ'
               NEXT SENTENCE
           ELSE
           IF SCR-CMND = 'ACC' OR
              SCR-CMND = 'CCC'
               IF SCR-CMND = 'ACC'
                   NEXT SENTENCE
               ELSE
                   MOVE FRM-CPIM-AEY TO OPE-COD-TCOM-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO OPE-CAI-ICAR-ATR IN ICM-FLD
                   MOVE FRM-CPIM-AEY TO OPE-IIC-ICAR-ATR IN ICM-FLD
           ELSE
           IF SCR-CMND = 'MCC'
               MOVE FRM-CPIM-UBY TO OPE-COD-TCOM-ATR IN ICM-FLD
               MOVE FRM-CPIM-UBY TO OPE-CAI-ICAR-ATR IN ICM-FLD
               MOVE FRM-CPIM-UBY TO OPE-IIC-ICAR-ATR IN ICM-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO OPE-COD-TCOM-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-CAI-ICAR-ATR IN ICM-FLD
               MOVE FRM-CPIM-AEY TO OPE-IIC-ICAR-ATR IN ICM-FLD.
      * ---- agregado por odj hasta aqui (e)
      *DAD fin  23-MAR-1992
      ******************************************************************
      *>>>>
      *<<<< FIN_HBL_FLD
      * ISP EN ESTE ENGANCHE NO ES NECESARIO PROTEGER LOS CAMPOS,
      *     PUES EL INDICADOR DE MULTIPLES ES INDEPENDIENTE A LOS
      *     DATOS DE LOS CLIENTES
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO ICM-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-ICM.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-ICM
               PERFORM EDT-FLD-ICM
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-ICM
               PERFORM EDT-FLD-ICM
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-ICM.
           PERFORM EDT-FLD-ICM.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY SGCBQICM.
       COPY GNSBVNUM.
       COPY SGCBFDCC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
       COPY GNSBGFRM.
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVTDU.
       COPY TABBFUSR.

      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       GNS-CLR-RQA SECTION.
       INI-GNS-CLR-RQA.
           MOVE SPACES TO SCR-DBC-REQA.
           MOVE SPACES TO SCR-KEY-IDBC.
           MOVE SPACES TO SCR-RCO-REQA.
           MOVE SPACES TO SCR-KEY-IRCO.
       FIN-GNS-CLR-RQA.
           EXIT.
      *>>>>
      *<<<< EOF
      ******************************************************************
      *DAD ini  05-JUN-1992 / 22-MAY-1992
       CHK-DBC-TICL SECTION.
       INI-CHK-DBC-TICL.
      * Usa DBC leido anteriormente
           IF DBC-COD-EJEC IN DBC NOT > SPACES OR
              DBC-COD-OFIC IN DBC NOT > SPACES OR
              DBC-IND-OOFI IN DBC NOT > SPACES OR
              DBC-COD-ODSE IN DBC NOT > SPACES OR
              DBC-COD-ACTI IN DBC NOT > SPACES
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'DBCTICLOBLIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-MENS TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CHK-DBC-TICL.

      * Usa RCD leido anteriormente
           IF RCD-GLS-DIRE IN RCD NOT > SPACES OR
              RCD-COD-LUGA IN RCD NOT > SPACES OR
              RCD-GLS-FONO IN RCD NOT > SPACES
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'DBCTICLOBLIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-MENS TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CHK-DBC-TICL.

           IF DBC-IND-TICL IN DBC = 'P'
               PERFORM CHK-DCP-TICL
           ELSE
               PERFORM CHK-DCE-TICL.
       FIN-CHK-DBC-TICL.
           EXIT.
      *DAD fin  05-JUN-1992 / 22-MAY-1992

      *DAD ini  05-JUN-1992 / 22-MAY-1992
       CHK-DCP-TICL SECTION.
       INI-CHK-DCP-TICL.
           MOVE DBC-CIC-ICLI IN DBC TO DCP-CIC-ICLI IN DCP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCP.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'DBCTICLOBLIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-MENS TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CHK-DCP-TICL.

           IF DCP-FEC-FNAC IN DCP NOT > ZEROES OR
              DCP-IND-SEXO IN DCP NOT > SPACES OR
              DCP-IND-ECIV IN DCP NOT > SPACES OR
              DCP-COD-PNAC IN DCP NOT > SPACES OR
              DCP-COD-TBAN IN DCP NOT > SPACES
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'DBCTICLOBLIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-MENS TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CHK-DCP-TICL.
       FIN-CHK-DCP-TICL.
           EXIT.
      *DAD fin  05-JUN-1992 / 22-MAY-1992

      *DAD ini  17-JUL-1992 / 05-JUN-1992 / 22-MAY-1992
       CHK-DCE-TICL SECTION.
       INI-CHK-DCE-TICL.
           MOVE DBC-CIC-ICLI IN DBC TO DCE-CIC-ICLI IN DCE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DCE.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'DBCTICLOBLIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-MENS TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CHK-DCE-TICL.

           IF DCE-IND-CATE IN DCE NOT > SPACES OR
              DCE-IND-CMOS IN DCE NOT > SPACES OR
              DCE-IND-TEMP IN DCE NOT > SPACES OR
              DCE-COD-TBAN IN DCE NOT > SPACES
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'DBCTICLOBLIG' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN1
               MOVE MSG-GLS-MENS TO FRM-MEN2
               MOVE FRM-SUAR-MAL TO FRM-SUAR
      *         MOVE SCR-STAT-CON TO SCR-STAT
               GO TO FIN-CHK-DCE-TICL.
       FIN-CHK-DCE-TICL.
           EXIT.
      *DAD fin  17-JUL-1992 / 05-JUN-1992 / 22-MAY-1992
      ******************************************************************
       BUS-RCO SECTION.
       INI-BUS-RCO.
           MOVE OPE-CIC-IOPE IN OPE TO RCO-CIC-IOPE IN RCO.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-BUS-RCO.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           PERFORM SGC-FIO-RCO.
           IF NOT ( FIO-STAT-OKS AND
              OPE-CIC-IOPE IN OPE = RCO-CIC-IOPE IN RCO )
               MOVE RCO-CIC-ICLI TO DBC-CIC-ICLI IN DBC
               PERFORM BUS-DOM
               PERFORM PUT-RCD
               GO TO FIN-BUS-RCO.
           IF NOT (DCC-CAI-ICLI IN ICM-FLD = RCO-CAI-ICLI IN RCO AND
              DCC-IIC-ICLI IN ICM-FLD = RCO-IIC-ICLI IN RCO )
               MOVE FIO-GET-NXT TO FIO-CMND
               GO TO LUP-BUS-RCO.
      *DAD ini  23-MAR-1992
      * Para guardar REQA del RCO con REDKY y la Llave Principal
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
      *DAD fin  23-MAR-1992
           MOVE RCO-CAI-ICLI IN RCO TO RCD-CAI-ICLI IN RCD.
           MOVE RCO-IIC-ICLI IN RCO TO RCD-IIC-ICLI IN RCD.
           MOVE RCO-NUM-DIRE IN RCO TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO RCD-GLS-DIRE IN RCD.
            PERFORM PUT-RCD.
            MOVE '00' TO PGM-STAT-RCO.
       FIN-BUS-RCO.
           EXIT.

       PUT-ACC-JGN SECTION.
       INI-PUT-ACC-JGN.
      *     MOVE 'TAB'    TO FIO-SIST.
      *     MOVE 'VLR'    TO TAB-CIC-TTAB.
      *     MOVE '0999  ' TO TAB-CIC-CTAB.
      *     MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      *     IF TAB-COD-CTAB IN TAB NOT = OPE-COD-VCOP IN ICM-FLD
      *         GO TO FIN-PUT-ACC-JGN.
      *    Codigo de Transaccion
           MOVE 9001                 TO BCD-DAT2-INT IN BCD-VARI.
           MOVE BCD-DAT2 IN BCD-VARI TO JGN-COD-TRAN IN JGN.
      *    Sucursal
           MOVE DCC-CAI-ICLI IN ICM-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DCC-IIC-ICLI IN ICM-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE OPE-COD-OFOP IN ICM-FLD TO JGN-COD-SUCU IN JGN.
      *    MOVE DBC-COD-OFIC IN DBC     TO JGN-COD-SUCU IN JGN.
      *    Filler
           MOVE SPACES TO JGN-GLS-FIL1 IN JGN.
      *    Largo de Datos
           MOVE 77     TO JGN-GLS-LDAT IN JGN.
      *    Filler
           MOVE SPACES TO JGN-GLS-FIL2 IN JGN.
      *    Fecha
           PERFORM GET-FHOY.
           MOVE HOY-AHOY      IN HOY-VARI TO WSS-NUM-AHOY  IN WSS-VARI.
           MOVE HOY-MHOY      IN HOY-VARI TO WSS-NUM-MHOY  IN WSS-VARI.
           MOVE HOY-DHOY      IN HOY-VARI TO WSS-NUM-DHOY  IN WSS-VARI.
           MOVE WSS-FEC-FHOY  IN WSS-VARI TO BCD-DAT3-EBCD IN BCD-VARI.
           MOVE BCD-DAT3-EBCD IN BCD-VARI TO BCD-DAT3-INT  IN BCD-VARI.
           MOVE BCD-DAT3      IN BCD-VARI TO JGN-FEC-FHOY  IN JGN.
      *    Rut
           MOVE DBC-NUM-ICLI IN DBC TO WSS-GLS-RUT IN WSS-VARI.
           IF DBC-VRF-ICLI IN DBC NOT = 'K'
               MOVE ZEROES              TO WSS-FILLER    IN WSS-VARI
               MOVE DBC-VRF-ICLI IN DBC TO WSS-NUM-VRF   IN WSS-VARI
               MOVE WSS-RUT IN WSS-VARI TO BCD-DAT6-EBCD IN BCD-VARI
               MOVE BCD-DAT6-EBCD IN BCD-VARI TO BCD-DAT6-INT IN
                                                        BCD-VARI
               MOVE BCD-DAT6 IN BCD-VARI TO JGN-GLS-RUT IN JGN
           ELSE
               MOVE ZEROES                   TO WSS-FIL1 IN WSS-VARI
               MOVE WSS-NUM-RUT  IN WSS-VARI TO WSS-GLS-SINB IN WSS-VARI
               MOVE WSS-SIN-BRUT IN WSS-VARI TO BCD-DAT5-EBCD IN
                                                        BCD-VARI
               MOVE BCD-DAT5-EBCD IN BCD-VARI TO BCD-DAT5-INT IN
                                                        BCD-VARI
               MOVE BCD-DAT5    IN BCD-VARI TO WSS-NUM-BRUT IN WSS-VARI
               MOVE WSS-NUM-DIG IN WSS-VARI TO WSS-DIG IN WSS-VARI
               MOVE WSS-DIG     IN WSS-VARI TO WSS-AUX IN WSS-VARI
               MULTIPLY WSS-AUX IN WSS-VARI BY 16 GIVING
                        WSS-AUX IN WSS-VARI
               ADD 11 TO WSS-AUX IN WSS-VARI
               MOVE WSS-AUX IN WSS-VARI TO WSS-AUX-DLIM IN WSS-VARI
               MOVE WSS-AUX-DLI2        TO WSS-VRF-BRUT IN WSS-VARI
               MOVE WSS-BCD-RUT IN WSS-VARI TO JGN-GLS-RUT IN JGN.
      *    Delimitador
           MOVE ZEROES TO WSS-AUX IN WSS-VARI.
           ADD 15 TO WSS-AUX IN WSS-VARI.
           MULTIPLY WSS-AUX IN WSS-VARI BY 16 GIVING
                                 WSS-AUX IN WSS-VARI.
           ADD 13 TO WSS-AUX IN WSS-VARI.
           MOVE WSS-AUX IN WSS-VARI TO WSS-AUX-DLIM IN WSS-VARI.
           MOVE WSS-AUX-DLI2        TO JGN-GLS-DLI1 IN JGN.
      *    Nombre
           MOVE FRM-GLS-NOMC IN ICM-FLD TO JGN-GLS-NOMB IN JGN.
      *    Delimitador
           MOVE WSS-AUX-DLI2 TO JGN-GLS-DLI2 IN JGN.
      *    Cuenta Corriente Apertura
           MOVE '09'                      TO WSS-NUM-DIGI IN WSS-VARI.
           MOVE OPE-IIC-IOPE  IN ICM-FLD  TO WSS-IIC-IOPE IN WSS-VARI.
           MOVE WSS-CIC-IOPE  IN WSS-VARI TO BCD-DAT5-EBCD IN BCD-VARI.
           MOVE BCD-DAT5-EBCD IN BCD-VARI TO BCD-DAT5-INT IN BCD-VARI.
           MOVE BCD-DAT5      IN BCD-VARI TO JGN-IIC-ACCT IN JGN.
      *    Delimitador
           MOVE WSS-AUX-DLI2 TO JGN-GLS-DLI3 IN JGN.
      *    Direccion
           MOVE RCD-GLS-DIRE IN ICM-FLD TO JGN-GLS-DIRE IN JGN.
      *    Delimitador
           MOVE WSS-AUX-DLI2 TO JGN-GLS-DLI4 IN JGN.
      *    Actividad
           IF DBC-COD-ACTI IN DBC > SPACES
               MOVE 'TAB'               TO TAB-COD-SIST
               MOVE 'ACT'               TO TAB-COD-TTAB IN TAB
               MOVE DBC-COD-ACTI IN DBC TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-CIC-CTAB TO WSS-CIC-ACTI IN WSS-VARI
               MOVE WSS-CIC-ACT1 TO BCD-DAT1-EBCD IN BCD-VARI
               MOVE BCD-DAT1-EBCD IN BCD-VARI TO BCD-DAT1-INT IN
                                                        BCD-VARI
               MOVE BCD-DAT1 IN BCD-VARI TO JGN-COD-ACTI IN JGN.
      *    Delimitador
           MOVE WSS-AUX-DLI2 TO JGN-GLS-DLI5 IN JGN.
      *    Filler
           MOVE SPACES TO JGN-GLS-FIL3 IN JGN.
      *    Filler
           MOVE SPACES TO JGN-GLS-FIL5 IN JGN.
      *DAD ini  08-MAR-1991
      *    PONE VALORES EN VARIABLES 'FIO' PARA QUE EN CASO DE FALLAR
      *    EL WRITE, LAS DECLARATIVAS ENTREGEN INFORMACION CORRECTA.
      *    NO SE USA FIO, PUES ARCHIVO SAM ==> CLAUSULA 'RBA'
           MOVE FIO-PUT  TO FIO-CMND.
           MOVE 'AMCCNC' TO FIO-VOID.
           MOVE JGN      TO FIO-DFLD.
           MOVE 200      TO FIO-RLEN.
      *DAD fin  08-MAR-1991
           EXEC CICS WRITE
                       DATASET('AMCCNC')
                       FROM(JGN)
                       LENGTH(200)
                       RIDFLD(JGN-COD-TRAN)
                       RBA
           END-EXEC.
       FIN-PUT-ACC-JGN.
           EXIT.

       PUT-CCC-JGN SECTION.
       INI-PUT-CCC-JGN.
      *     MOVE 'TAB'    TO FIO-SIST.
      *     MOVE 'VLR'    TO TAB-CIC-TTAB.
      *     MOVE '0999  ' TO TAB-CIC-CTAB.
      *     MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      *     IF TAB-COD-CTAB IN TAB NOT = OPE-COD-VCOP IN ICM-FLD
      *         GO TO FIN-PUT-CCC-JGN.
      *    Codigo de Transaccion
           MOVE 9003                 TO BCD-DAT2-INT IN BCD-VARI.
           MOVE BCD-DAT2 IN BCD-VARI TO JGN-COD-TRAN IN JGN.
      *    Sucursal
           MOVE DCC-CAI-ICLI IN ICM-FLD TO DBC-CAI-ICLI IN DBC.
           MOVE DCC-IIC-ICLI IN ICM-FLD TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE OPE-COD-OFOP IN ICM-FLD TO JGN-COD-SUCU IN JGN.
      *    MOVE DBC-COD-OFIC IN DBC     TO JGN-COD-SUCU IN JGN.
      *    Filler
           MOVE SPACES TO JGN-GLS-FIL1 IN JGN.
      *    Largo de Datos
           MOVE 8 TO JGN-GLS-LDAT IN JGN.
      *    Filler
           MOVE SPACES TO JGN-GLS-FIL2 IN JGN.
      *    Fecha
           PERFORM GET-FHOY.
           MOVE HOY-AHOY      IN HOY-VARI TO WSS-NUM-AHOY IN WSS-VARI.
           MOVE HOY-MHOY      IN HOY-VARI TO WSS-NUM-MHOY IN WSS-VARI.
           MOVE HOY-DHOY      IN HOY-VARI TO WSS-NUM-DHOY IN WSS-VARI.
           MOVE WSS-FEC-FHOY  IN WSS-VARI TO BCD-DAT3-EBCD IN BCD-VARI.
           MOVE BCD-DAT3-EBCD IN BCD-VARI TO BCD-DAT3-INT IN BCD-VARI.
           MOVE BCD-DAT3 IN BCD-VARI TO JGN-FEC-FHOY IN JGN.
      *    Cuenta Corriente Cierre
           MOVE '09'                     TO WSS-NUM-DIGI IN WSS-VARI.
           MOVE OPE-IIC-IOPE IN ICM-FLD  TO WSS-IIC-IOPE IN WSS-VARI.
           MOVE WSS-CIC-IOPE IN WSS-VARI TO BCD-DAT5-EBCD IN BCD-VARI.
           MOVE BCD-DAT5-EBCD IN BCD-VARI TO BCD-DAT5-INT IN BCD-VARI.
           MOVE BCD-DAT5 IN BCD-VARI TO JGN-IIC-CCCT IN JGN.
      *    Delimitador
           MOVE ZEROES TO WSS-AUX IN WSS-VARI.
           ADD 15 TO WSS-AUX IN WSS-VARI.
           MULTIPLY WSS-AUX IN WSS-VARI BY 16 GIVING
                    WSS-AUX IN WSS-VARI.
           ADD 13 TO WSS-AUX IN WSS-VARI.
           MOVE WSS-AUX IN WSS-VARI TO WSS-AUX-DLIM IN WSS-VARI.
           MOVE WSS-AUX-DLI2 TO JGN-GLS-DLI6 IN JGN.
      *    Motivo de Cierre
           IF OPE-COD-MOTT IN ICM-FLD > SPACES
               MOVE 'TAB'                   TO TAB-COD-SIST
               MOVE 'MTO'                   TO TAB-COD-TTAB IN TAB
               MOVE OPE-COD-MOTT IN ICM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-CIC-CTAB TO WSS-CIC-MOTC IN WSS-VARI
               MOVE WSS-CIC-MOT1 TO BCD-DAT1-EBCD IN BCD-VARI
               MOVE BCD-DAT1-EBCD IN BCD-VARI TO BCD-DAT1-INT IN
                                                        BCD-VARI
               MOVE BCD-DAT1 IN BCD-VARI TO JGN-COD-MOTC IN JGN.
      *    Delimitador
           MOVE WSS-AUX-DLI2 TO JGN-GLS-DLI7 IN JGN.
      *    Filler
           MOVE SPACES TO JGN-GLS-FIL4 IN JGN.
      *    Filler
           MOVE SPACES TO JGN-GLS-FIL5 IN JGN.
      *DAD ini  08-MAR-1991
      *    PONE VALORES EN VARIABLES 'FIO' PARA QUE EN CASO DE FALLAR
      *    EL WRITE, LAS DECLARATIVAS ENTREGEN INFORMACION CORRECTA.
      *    NO SE USA FIO, PUES ARCHIVO SAM ==> CLAUSULA 'RBA'
           MOVE FIO-PUT  TO FIO-CMND.
           MOVE 'AMCCNC' TO FIO-VOID.
           MOVE JGN      TO FIO-DFLD.
           MOVE 200      TO FIO-RLEN.
      *DAD fin  08-MAR-1991
           EXEC CICS WRITE
                       DATASET('AMCCNC')
                       FROM(JGN)
                       LENGTH(200)
                       RIDFLD(JGN-COD-TRAN)
                       RBA
           END-EXEC.
       FIN-PUT-CCC-JGN.
           EXIT.

      *<<<< PGM_DTC
       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
      *DAD ini  23-MAR-1992
               MOVE SPACES       TO SCR-RCO-REQA
      *DAD fin  23-MAR-1992
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.

       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-STAT TO PGM-STAT-DBC.
           IF FIO-STAT-OKS
      *DAD ini  23-MAR-1992
               MOVE SPACES       TO SCR-RCO-REQA
      *DAD fin  23-MAR-1992
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.

      *DAD ini  11-MAR-1991
       LEE-NXT-PRV-RCO SECTION.
       INI-LEE-NXT-PRV-RCO.
      * A partir del RCO en REQA se leera este RCO
           MOVE SCR-RCO-REQA TO ADR-RCO-REQA.
           MOVE FIO-KDEF-S  TO FIO-KDEF.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCO.

      * Lee DBC con el RCO leido anteriormente, guardando CIC del Client
           MOVE RCO-CIC-ICLI IN RCO TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE DBC-CIC-ICLI IN DBC TO WSS-CIC-ICLI IN WSS-VARI.
      *DAD ini  23-MAR-1992
           MOVE FIO-STAT TO PGM-STAT-DBC.
      *DAD fin  23-MAR-1992

      * Lee TAB para obtener CIC de Cta. Cte.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'AUX' TO TAB-CIC-TTAB IN TAB.
           MOVE 'CTE' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CICCTACNEX' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-RCO.
      *DPM INI  15-MAR-1995 MODIFICADO
      *DAD ini  23-MAR-1992
      *     MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CCTE IN WSS-VARI.
      *DAD fin  23-MAR-1992
      *DPM FIN  15-MAR-1995
      *DPM INI  15-MAR-1995
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAC IN CCT-VARI.
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'AUX' TO TAB-CIC-TTAB IN TAB.
           MOVE 'PRI' TO TAB-CIC-CTAB IN TAB.
           MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'SGC'        TO MSG-COD-SIST
               MOVE 'CICCTAPNEZ' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-RCO.
           MOVE TAB-COD-CTAB IN TAB TO WSS-COD-CTAP IN CCT-VARI.
      *DPM FIN  15-MAR-1995

      * A partir del RCO leido anteriormente, se leera otro RCO
       LUP-LEE-NXT-PRV-RCO.
      * Lee RCO anterior o siguiente segun PFS
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
      *DAD ini  23-MAR-1992
               MOVE SPACES TO PGM-STAT
      *DAD fin  23-MAR-1992
               MOVE 'SGC'    TO MSG-COD-SIST
               IF FRM-FFLD = FRM-FFLD-PF5
                   MOVE 'CCT    NOPRV' TO MSG-COD-MENS
                   GO TO FIN-LEE-NXT-PRV-RCO
               ELSE
                   MOVE 'CCT    NONXT' TO MSG-COD-MENS
                   GO TO FIN-LEE-NXT-PRV-RCO.

      *DAD ini  23-MAR-1992
      * Con DBC y el RCO leido anteriormente, se chequea si es el Client
           IF WSS-CIC-ICLI IN WSS-VARI NOT = RCO-CIC-ICLI IN RCO
               MOVE SPACES TO PGM-STAT
      *DAD fin  23-MAR-1992
               MOVE 'SGC'    TO MSG-COD-SIST
               IF FRM-FFLD = FRM-FFLD-PF5
                   MOVE 'CCT    NOPRV' TO MSG-COD-MENS
                   GO TO FIN-LEE-NXT-PRV-RCO
               ELSE
                   MOVE 'CCT    NONXT' TO MSG-COD-MENS
                   GO TO FIN-LEE-NXT-PRV-RCO.
           MOVE PGM-SOKS TO PGM-STAT-RCO.

      * Lee OPE con el RCO leido anteriormente, chequeando si este es Ct
           MOVE RCO-CIC-IOPE IN RCO TO OPE-CIC-IOPE IN OPE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF NOT FIO-STAT-OKS OR
      *DPM INI  15-MAR-1995 MODIFICADO
      *        OPE-COD-COPR IN OPE NOT = WSS-COD-CCTE IN WSS-VARI
      *       (OPE-COD-COPR IN OPE NOT = WSS-COD-CTAC IN CCT-VARI AND
      *       OPE-COD-COPR IN OPE NOT = WSS-COD-CTAP IN CCT-VARI)
      *DPM FIN  15-MAR-1995
      *RMV INI  02-DIC-1996 MODIFICADO
              (OPE-COD-TOPR IN OPE NOT = WSS-COD-CTAC IN CCT-VARI AND
              OPE-COD-TOPR IN OPE NOT = WSS-COD-CTAP IN CCT-VARI)
      *RMV FIN  02-DIC-1996
               GO TO LUP-LEE-NXT-PRV-RCO
           ELSE
               MOVE FIO-STAT TO PGM-STAT-OPE
               MOVE ADR-RCO-REQA TO SCR-RCO-REQA.

      * Lee RCD con el RCO leido anteriormente
           MOVE RCO-CIC-ICLI IN RCO TO RCD-CIC-ICLI IN RCD.
           MOVE RCO-NUM-DIRE IN RCO TO RCD-NUM-DIRE IN RCD.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RCD.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO RCD-GLS-DIRE IN RCD.
           MOVE PGM-SOKS TO PGM-STAT-RCD.
       FIN-LEE-NXT-PRV-RCO.
           EXIT.
      *DAD fin  11-MAR-1991
      *>>>>
       PUT-RCP SECTION.
       INI-PUT-RCP.
           IF MSG-COD-MENS > SPACES
               MOVE SPACES TO FRM-GLS-NCLP IN ICM-FLD
               MOVE ZEROES TO FRM-NUM-ICLP IN ICM-FLD
               MOVE SPACES TO FRM-VRF-ICLP IN ICM-FLD
               MOVE SPACES TO FRM-IND-ICLP IN ICM-FLD
               MOVE SPACES TO FRM-GLS-ICLP IN ICM-FLD
               GO TO FIN-PUT-RCP.
           MOVE REC-CIC-IREL IN REC TO DBC-CIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO FRM-GLS-NCLP IN ICM-FLD
               MOVE ZEROES TO FRM-NUM-ICLP IN ICM-FLD
               MOVE SPACES TO FRM-VRF-ICLP IN ICM-FLD
               MOVE SPACES TO FRM-IND-ICLP IN ICM-FLD
               MOVE SPACES TO FRM-GLS-ICLP IN ICM-FLD
               GO TO FIN-PUT-RCP.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NCLP IN ICM-FLD.
      *RJZ INI 02/02/95
      *    MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLP IN ICM-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLP-ALF IN ICM-FLD.
      *RJZ FIN 02/02/95
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLP IN ICM-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLP IN ICM-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLP IN ICM-FLD.
       FIN-PUT-RCP.
           EXIT.

       PUT-RCD SECTION.
       INI-PUT-RCD.
           MOVE RCD-GLS-DIRE IN RCD TO RCD-GLS-DIRE IN ICM-FLD.
           MOVE '00' TO PGM-STAT-RCD.
           MOVE '00' TO PGM-STAT-RCO.
           MOVE RCD-NUM-DIRE IN RCD TO RCO-NUM-DIRE IN RCO.
       FIN-PUT-RCD.
           EXIT.

       UPD-OPE SECTION.
       INI-UPD-OPE.
           PERFORM GET-FHOY.
           PERFORM RET-ALL-ICM.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           PERFORM RET-ALL-ICM.
           MOVE HOY-STP-ITRN IN HOY-VARI TO OPE-STP-ITRN IN OPE.
           MOVE 'D'                      TO OPE-MSC-STAT IN OPE.
           MOVE 'ELI'                    TO OPE-COD-STAT IN OPE.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS
               PERFORM UPD-RCO.
       FIN-UPD-OPE.
           EXIT.

       UPD-RCO SECTION.
       INI-UPD-RCO.
           MOVE OPE-CIC-IOPE IN OPE TO RCO-CIC-IOPE IN RCO.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-UPD-RCO.
           MOVE 'RCO-KEY-IOPE' TO FIO-AKEY.
           PERFORM SGC-FIO-RCO.
      *<<<< PGM_DTC
           MOVE ADR-RCO-REQA TO ADR-AUX-REQA.
      *>>>>
           IF NOT ( FIO-STAT-OKS AND
              OPE-CIC-IOPE IN OPE = RCO-CIC-IOPE IN RCO )
               MOVE '00' TO FIO-STAT
               GO TO FIN-UPD-RCO.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
      *DAD ini  10-AUG-1992
           MOVE HOY-STP-ITRN IN HOY-VARI TO RCO-STP-ITRN IN RCO.
      *DAD fin  10-AUG-1992
           MOVE 'D'                      TO RCO-MSC-STAT IN RCO.
           MOVE 'ELI'                    TO RCO-COD-STAT IN RCO.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF NOT FIO-STAT-OKS
               GO TO FIN-UPD-RCO.
      *<<<< PGM_DTC
           MOVE ADR-AUX-REQA TO ADR-RCO-REQA.
      *>>>>
           MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           GO TO LUP-UPD-RCO.
       FIN-UPD-RCO.
           EXIT.

       UPD-OPE-RCO SECTION.
       INI-UPD-OPE-RCO.
           PERFORM GET-FHOY.
           PERFORM RET-ALL-ICM.
           MOVE DCC-CAI-ICLI IN DCC TO DBC-CAI-ICLI IN DBC.
           MOVE DCC-IIC-ICLI IN DCC TO DBC-IIC-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS
               PERFORM RET-ALL-ICM
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               PERFORM INI-REG-OPE
               MOVE FIO-PUT TO FIO-CMND.
           MOVE HOY-STP-ITRN IN HOY-VARI TO OPE-STP-ITRN IN OPE.
      *DAD ini  02-MAY-1991
           IF SCR-CMND = 'ACC'
               MOVE OPE-IIC-IOPE IN ICM-FLD TO WSS-CTA-CTE IN WSS-VARI
               IF VAL-CCTE-DOLAR
                   MOVE '101301' TO OPE-COD-VCOP IN OPE
               ELSE
                   MOVE '0999  ' TO OPE-COD-VCOP IN OPE.
      *DAD fin  02-MAY-1991
           PERFORM SGC-FIO-OPE.
           IF NOT FIO-STAT-OKS
               GO TO FIN-UPD-OPE-RCO.
           MOVE OPE-CIC-IOPE IN OPE TO RCO-CIC-IOPE IN RCO.
           MOVE DCC-CAI-ICLI IN DCC TO RCO-CAI-ICLI IN RCO.
           MOVE DCC-IIC-ICLI IN DCC TO RCO-IIC-ICLI IN RCO.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-RCO.
           IF FIO-STAT-OKS
               PERFORM RET-RCO-ICM
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               PERFORM INI-REG-RCO
               MOVE FIO-PUT TO FIO-CMND.
           MOVE HOY-STP-ITRN IN HOY-VARI TO OPE-STP-ITRN IN OPE
      *DAD ini  10-AUG-1992
                                            RCO-STP-ITRN IN RCO.
      *DAD fin  10-AUG-1992
           PERFORM SGC-FIO-RCO.
       FIN-UPD-OPE-RCO.
           EXIT.

       INI-REG-OPE SECTION.
       INI-INI-REG-OPE.
           MOVE ZEROES TO OPE-FEC-FROP IN OPE.
           MOVE SPACES TO OPE-GLS-FLAG IN OPE.
           MOVE SPACES TO OPE-MSC-TACC IN OPE.
      *ALD MOVE SPACES TO OPE-MSC-STAT IN OPE.
           MOVE 'I'    TO OPE-MSC-STAT IN OPE.
           MOVE SPACES TO OPE-COD-OTRN IN OPE.
           MOVE SPACES TO OPE-COD-ATRN IN OPE.
      *ALD MOVE SPACES TO OPE-COD-STAT IN OPE.
           MOVE 'VIG'  TO OPE-COD-STAT IN OPE.
      *DPM INI  8-MAR-1995 MODIFICADO PORQUE AHORA EXISTE CTE Y CPR.
      *     MOVE 'TAB' TO FIO-SIST.
      *     MOVE 'AUX' TO TAB-CIC-TTAB IN TAB.
      *     MOVE 'CTE' TO TAB-CIC-CTAB IN TAB.
      *     MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *     MOVE FIO-GET-KEY    TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      *     IF NOT FIO-STAT-OKS
      *         MOVE SPACES TO OPE-COD-TOPR IN OPE
      *     ELSE
      *         MOVE TAB-COD-CTAB IN TAB TO OPE-COD-TOPR IN OPE.
      *DPM FIN  8-MAR-1995
      *DPM INI  8-MAR-1995
           MOVE OPE-IIC-IOPE IN ICM-FLD TO WR-TIPO-CTAPRI.
           IF OPE-CAI-IOPE IN ICM-FLD = '0000' AND
                 WR-TIPO-CTAPRI NOT < '982'
      *CUENTA PRIMA
               MOVE 'TAB' TO FIO-SIST
               MOVE 'AUX' TO TAB-CIC-TTAB IN TAB
               MOVE 'PRI' TO TAB-CIC-CTAB IN TAB
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                   MOVE SPACES TO OPE-COD-TOPR IN OPE
               ELSE
                   MOVE TAB-COD-CTAB IN TAB TO OPE-COD-TOPR IN OPE.
           IF OPE-CAI-IOPE IN ICM-FLD = '0000' AND
                 WR-TIPO-CTAPRI < '982'
      *CUENTA CORRIENTE
               MOVE 'TAB' TO FIO-SIST
               MOVE 'AUX' TO TAB-CIC-TTAB IN TAB
               MOVE 'CTE' TO TAB-CIC-CTAB IN TAB
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY
               MOVE FIO-GET-KEY    TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                  MOVE SPACES TO OPE-COD-TOPR IN OPE
               ELSE
                  MOVE TAB-COD-CTAB IN TAB TO OPE-COD-TOPR IN OPE.
      *DPM FIN  8-MAR-1995
           MOVE SPACES TO OPE-COD-AOPR IN OPE.
      *     MOVE DBC-COD-OFIC IN DBC TO OPE-COD-OFOP IN OPE.
      ******************************************************************
      *DAD ini  23-MAR-1992
      * ---- modificado por odj desde aqui (k)
      *     MOVE SPACES TO OPE-GLS-DISP IN OPE.
      * ---- modificado por odj hasta aqui (k)
      *DAD fin  23-MAR-1992
      ******************************************************************
       FIN-INI-REG-OPE.
           EXIT.

       INI-REG-RCO SECTION.
       INI-INI-REG-RCO.
           MOVE SPACES TO RCO-GLS-FLAG IN RCO.
           MOVE SPACES TO RCO-MSC-TACC IN RCO.
      *ALD MOVE SPACES TO RCO-MSC-STAT IN RCO.
           MOVE 'I'    TO RCO-MSC-STAT IN RCO.
           MOVE SPACES TO RCO-COD-OTRN IN RCO.
           MOVE SPACES TO RCO-COD-ATRN IN RCO.
      *ALD MOVE SPACES TO RCO-COD-STAT IN RCO.
           MOVE 'VIG'  TO RCO-COD-STAT IN RCO.
           MOVE SPACES TO RCO-COD-RCOP IN RCO.
      *     PERFORM BUS-DOM
      *     IF RCD-GLS-DIRE IN RCD NOT > SPACES
      *         MOVE 1 TO RCO-NUM-DIRE IN RCO
      *     ELSE
      *         MOVE RCD-NUM-DIRE IN RCD TO RCO-NUM-DIRE IN RCO.
           MOVE 100   TO RCO-VAL-PRCO IN RCO.
      *DPM INI  8-MAR-1995  MODIFICADO
      *     MOVE 'TAB' TO FIO-SIST.
      *     MOVE 'AUX' TO TAB-CIC-TTAB IN TAB.
      *     MOVE 'CTE' TO TAB-CIC-CTAB IN TAB.
      *     MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *DPM FIN  8-MAR-1995
      *DPM INI  8-MAR-1995
           IF WR-TIPO-CTAPRI < '982' AND
                   RCO-CAI-IOPE IN RCO = '0000'
               MOVE 'TAB' TO FIO-SIST
               MOVE 'AUX' TO TAB-CIC-TTAB IN TAB
               MOVE 'CTE' TO TAB-CIC-CTAB IN TAB
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY
           ELSE
           IF RCO-CAI-IOPE IN RCO = '0000'
               MOVE 'TAB' TO FIO-SIST
               MOVE 'AUX' TO TAB-CIC-TTAB IN TAB
               MOVE 'PRI' TO TAB-CIC-CTAB IN TAB
               MOVE 'TAB-CIC-TABL' TO FIO-AKEY.
      *DPM FIN  8-MAR-1995
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE SPACES TO RCO-COD-TOPR IN RCO
           ELSE
               MOVE TAB-COD-CTAB IN TAB TO RCO-COD-TOPR IN RCO.
           MOVE SPACES TO RCO-COD-AOPR IN RCO.
           MOVE SPACES TO RCO-GLS-DISP IN RCO.
       FIN-INI-REG-RCO.
           EXIT.

       UPD-REC SECTION.
       INI-UPD-REC.
           IF FRM-NUM-ICLP IN ICM-FLD NOT > ZEROES
               MOVE '00' TO FIO-STAT
               GO TO FIN-UPD-REC.
           MOVE FRM-NUM-ICLP IN ICM-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-ICLP IN ICM-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-ICLP IN ICM-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE 'DBC-IDC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           MOVE DCC-CAI-ICLI IN ICM-FLD  TO REC-CAI-ICLI IN REC.
           MOVE DCC-IIC-ICLI IN ICM-FLD  TO REC-IIC-ICLI IN REC.
           MOVE DBC-CIC-ICLI IN DBC      TO REC-CIC-IREL IN REC.
           MOVE REC-COD-PRES IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE ZEROES                   TO REC-NUM-TREC IN REC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM SGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-CAI-ICLI IN REC = DCC-CAI-ICLI IN ICM-FLD AND
              REC-IIC-ICLI IN REC = DCC-IIC-ICLI IN ICM-FLD AND
              REC-CIC-IREL IN REC = DBC-CIC-ICLI IN DBC     AND
              REC-COD-TREC IN REC = REC-COD-PRES IN REC-VARI
               GO TO FIN-UPD-REC.
           MOVE DCC-CAI-ICLI IN ICM-FLD TO REC-CAI-ICLI IN REC
           MOVE DCC-IIC-ICLI IN ICM-FLD TO REC-IIC-ICLI IN REC
           MOVE DBC-CIC-ICLI IN DBC     TO REC-CIC-IREL IN REC
           PERFORM INI-REG-REC.
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM SGC-FIO-REC.
       FIN-UPD-REC.
           EXIT.

       INI-REG-REC SECTION.
       INI-INI-REG-REC.
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN IN HOY-VARI TO REC-STP-ITRN IN REC.
           MOVE SPACES                   TO REC-GLS-FLAG IN REC.
           MOVE 1                        TO REC-NUM-TREC IN REC.
           MOVE REC-COD-PRES IN REC-VARI TO REC-COD-TREC IN REC.
           MOVE SPACES                   TO REC-MSC-TACC IN REC.
           MOVE SPACES                   TO REC-COD-OTRN IN REC.
           MOVE SPACES                   TO REC-COD-ATRN IN REC.
           MOVE 'S'                      TO REC-IND-VIGE IN REC.
           MOVE REC-FEC-FTRN IN REC      TO REC-FEC-FINI IN REC.
           MOVE ZEROES                   TO REC-FEC-FINP IN REC.
           MOVE ZEROES                   TO REC-FEC-FTER IN REC.
           MOVE ZEROES                   TO REC-FEC-FOUT IN REC.
           MOVE SPACES                   TO REC-COD-AREC IN REC.
           MOVE ZEROES                   TO REC-SGV-AREC IN REC.
           MOVE SPACES                   TO REC-COD-VCAM IN REC.
           MOVE ZEROES                   TO REC-FEC-FVAL IN REC.
           MOVE ZEROES                   TO REC-FEC-FVRF IN REC.
           MOVE SPACES                   TO REC-GLS-DISP IN REC.
       FIN-INI-REG-REC.
           EXIT.

      *DAD ini  02-MAY-1991
       PRO-DEL-PER SECTION.
       INI-PRO-DEL-PER.
           MOVE SPACES TO FRM-MENS.
           MOVE OPE-IIC-IOPE IN ICM-FLD TO PER-KEY-IPER IN PER.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-PER.
           IF FIO-STAT-OKS
               MOVE FIO-DEL TO FIO-CMND
               PERFORM SGC-FIO-PER
               IF FIO-STAT-OKS
                   MOVE 'SGC'          TO MSG-COD-SIST
                   MOVE 'PER    DELOK' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MEN2
                   GO TO FIN-PRO-DEL-PER.
           MOVE 'SGC'          TO MSG-COD-SIST.
           MOVE 'PER    DELNO' TO MSG-COD-MENS.
           PERFORM GET-MSG.
      ******************************************************************
      *DAD ini  23-MAR-1992
      * ---- modificado por odj desde aqui  (A)
      *     MOVE MSG-GLS-DESC TO FRM-MEN1.
           IF SCR-CMND NOT = 'ACC'
               MOVE MSG-GLS-DESC TO FRM-MEN2.
      * ---- modificado por odj hasta aqui  (A)
      *DAD fin  23-MAR-1992
      ******************************************************************
       FIN-PRO-DEL-PER.
           EXIT.
      *DAD fin  02-MAY-1991

      *DAD ini  02-MAY-1991
       PRO-ACT-PER SECTION.
       INI-PRO-ACT-PER.
           MOVE SPACES TO FRM-MENS.
           MOVE OPE-IIC-IOPE IN ICM-FLD TO PER-KEY-IPER IN PER.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM SGC-FIO-PER.
           IF FIO-STAT-OKS
               MOVE 'PER    MODOK' TO MSG-COD-MENS
               MOVE FIO-MOD TO FIO-CMND
           ELSE
               MOVE 'PER    PUTOK' TO MSG-COD-MENS
               MOVE FIO-PUT TO FIO-CMND.
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN IN HOY-VARI TO PER-FEC-FPER IN PER.
           MOVE '1'                      TO PER-IND-PERS IN PER.
           MOVE SPACES                   TO PER-GLS-DISP IN PER.
           PERFORM RET-PER-ICM.
           PERFORM SGC-FIO-PER.
           IF FIO-STAT-OKS
               MOVE 'SGC' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2
           ELSE
               MOVE 'SGC'          TO MSG-COD-SIST
               MOVE 'PER    ACTNO' TO MSG-COD-MENS
               PERFORM GET-MSG
      ******************************************************************
      *DAD ini  23-MAR-1992
      * ---- modificado por odj desde aqui  (A)
      *         MOVE MSG-GLS-DESC TO FRM-MEN1.
               MOVE MSG-GLS-DESC TO FRM-MEN2.
      * ---- modificado por odj hasta aqui  (A)
      *DAD fin  23-MAR-1992
      ******************************************************************
       FIN-PRO-ACT-PER.
           EXIT.
      *DAD fin  02-MAY-1991
      *>>>>
      *<<<< EOF AND PGM_DTC AND PGM_V31
      *DAD ini  02-MAY-1991
       COPY GNSBGVSM.
       COPY GNSBHVSM.
      *DAD fin  02-MAY-1991
      *>>>>
      *<<<< EOF
      * ISP INICIO SECCTIONS PARA ENGANCHE PROGRAMAS
       CMN-INS SECTION.
       INI-CMN-INS.
           PERFORM RET-ALL-ICM.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF OPE-MSC-STAT IN OPE = 'D' OR
              OPE-COD-STAT IN OPE = 'ELI'
               PERFORM PUT-CCC-JGN
           ELSE
               PERFORM PUT-ACC-JGN.
       FIN-CMN-INS.
           EXIT.

      *DAD ini  24-ABR-1992
      * PUT-ICM-MCC SECTION.
      * INI-PUT-ICM-MCC.
      *     MOVE DCC-CAI-ICLI IN ICM-FLD TO DBC-CAI-ICLI IN DBC.
      *     MOVE DCC-IIC-ICLI IN ICM-FLD TO DBC-IIC-ICLI IN DBC.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM SGC-FIO-DBC.
      **        Tipo de registro
      *     MOVE      2                  TO MCC-NUM-TREG IN MCC.
      **        Numero de cta cte
      *     MOVE OPE-IIC-IOPE IN ICM-FLD TO MCC-IIC-IOPE IN MCC.
      **        Imputacion
      *     MOVE      9                  TO MCC-NUM-IMPT IN MCC.
      **        Nombre
      *     MOVE FRM-GLS-NOMC IN ICM-FLD TO MCC-GLS-NOMC IN MCC.
      **        Direccion
      *     MOVE RCD-GLS-DIRE IN ICM-FLD TO MCC-GLS-DIRE IN MCC.
      **        Fecha apertura cta cte
      *     MOVE OPE-NUM-DIOP IN ICM-FLD TO MCC-NUM-DACC IN MCC.
      *     MOVE OPE-NUM-MIOP IN ICM-FLD TO MCC-NUM-MACC IN MCC.
      *     MOVE OPE-NUM-AIOP IN ICM-FLD TO MCC-NUM-AACC IN MCC.
      **        Espacios
      *     MOVE SPACES                  TO MCC-GLS-FILR IN MCC.
      **        codigo de actividad
      *     IF DBC-COD-ACTI IN DBC > SPACES
      *         MOVE 'TAB'               TO TAB-COD-SIST
      *         MOVE 'ACT'               TO TAB-COD-TTAB IN TAB
      *         MOVE DBC-COD-ACTI IN DBC TO TAB-COD-CTAB IN TAB
      *         PERFORM BUS-TAB
      *         MOVE TAB-CIC-CTAB TO WSS-CIC-ACTI IN WSS-VARI
      *         MOVE WSS-CIC-ACT1 TO MCC-COD-ACTI IN MCC.
      **        Espacios
      *     MOVE SPACES                   TO MCC-GLS-DISP IN MCC.
      **DAD ini  08-MAR-1991
      **    PONE VALORES EN VARIABLES 'FIO' PARA QUE EN CASO DE FALLAR
      **    EL WRITE, LAS DECLARATIVAS ENTREGEN INFORMACION CORRECTA.
      **    NO SE USA FIO, PUES ARCHIVO SAM ==> CLAUSULA 'RBA'
      *     MOVE FIO-PUT   TO FIO-CMND.
      *     MOVE 'SGCMVTO' TO FIO-VOID.
      *     MOVE MCC       TO FIO-DFLD.
      *     MOVE 80        TO FIO-RLEN.
      **DAD fin  08-MAR-1991
      *     EXEC CICS WRITE
      *                 DATASET('SGCMVTO')
      *                 FROM(MCC)
      *                 LENGTH(80)
      *                 RIDFLD(MCC-IIC-IOPE)
      *                 RBA
      *     END-EXEC.
      * FIN-PUT-ICM-MCC.
      *     EXIT.
      *DAD fin  24-ABR-1992

       ING-FTER-CIC SECTION.
       INI-ING-FTER-CIC.
           PERFORM ING-SETE.
           MOVE SCR-INST-GKY TO SCR-INST.
           PERFORM HBL-KEY.
           PERFORM SCR-CLRA-ICM.
           PERFORM EDT-KEY-ICM.
           PERFORM EDT-FLD-ICM.
           MOVE SCR-MENS-EXT TO ICM-GLS-MENS.
           MOVE SPACES TO SCR-CIC-IOPE
                          SCR-VEC-ENG
                          SCR-VEC-FST
                          SCR-INST-EXT
                          SCR-MENS-EXT.
           PERFORM SCR-INIT.
           PERFORM SCR-EXIT.
       FIN-ING-FTER-CIC.
           EXIT.

       ING-FTER-CMN SECTION.
       INI-ING-FTER-CMN.
           PERFORM ING-SETE.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-ICM.
           MOVE SCR-MENS-EXT TO ICM-GLS-MENS.
           PERFORM SCR-INIT.
       FIN-ING-FTER-CMN.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO) TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO) TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO) TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO) TO SCR-NLIB.
       FIN-ING-SETE.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3           TO FRM-PLIN.
           MOVE 19          TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP      TO FRM-NAME.
           MOVE SCR-NLIB      TO FRM-NLIB.
           MOVE ICM-FLD       TO FRM-DFLD.
           MOVE FRM-INI       TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.
      * ISP CARGA LAS TABLAS DE MODULO SGCWGWIR.
       COPY SGCBGMPT.
      *
      *>>>>
      *<<<< EOF_IBM
      *DAD ini  02-MAY-1991
       COPY SGCBFPER.
      *DAD fin  02-MAY-1991
       COPY SGCBFDBC.
       COPY SGCBFRCD.
       COPY SGCBFOPE.
       COPY SGCBFRCO.
       COPY SGCBFREC.
      *DAD ini  22-MAY-1992
       COPY SGCBFDCP.
       COPY SGCBFDCE.
      *DAD fin  22-MAY-1992
      *DAD ini  20-AGO-1993
       COPY SGCBFCTL.
      *DAD fin  20-AGO-1993
       COPY SGCBGCLI.
       COPY SGCBGDOM.
       COPY SGCBGCCT.
       COPY SGCBGRCP.
       COPY SGCBGPPU.
       COPY SGCBGRCU.
       COPY SGCBGDCM.
       COPY TABBVUSR.
       COPY GNSBEGLS.
      *DAD ini  07-MAR-1991
       COPY GNSBGSTR.
      *DAD fin  07-MAR-1991
       COPY GNSBGCPT.
       COPY GNSBGPPU.
      *>>>>
      *<<<< EOF_V31
      *DAD ini  07-MAR-1991 (el siguiente modulo display error en comand
       ERR-OPE-RCO SECTION.
       INI-ERR-OPE-RCO.
           MOVE FIO-BCK-OUT TO FIO-CMND.
           PERFORM SGC-FIO-OPE.
           IF FIO-STAT-OKS
               MOVE '99' TO FIO-STAT
               MOVE 'ERROR : TRANSACCION BACK OUT, OK' TO SYS-MENS
           ELSE
               MOVE SYS-ABOR TO SYS-CMND
               MOVE 'ERROR : TRANSACCION BACK OUT, ABORTO' TO SYS-MENS
               PERFORM GNS-PRO-SYS.
       FIN-ERR-OPE-RCO.
           EXIT.
      *DAD fin  07-MAR-1991

      *DAD ini  07-MAR-1991 (los siguientes 3 modulos son para el enganc
       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI           TO SYS-CMMA.
           MOVE SCR-TCMA           TO SYS-TCMA.
           MOVE SYS-XCTL           TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE 1 TO SCR-IPRO.
           MOVE WSS-INST-FTER-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI           TO SYS-CMMA.
           MOVE SCR-TCMA           TO SYS-TCMA.
           MOVE SYS-XCTL           TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CIC.
           EXIT.

       EGR-FTER-CMN SECTION.
       INI-EGR-FTER-CMN.
           PERFORM CRG-TBL-ENG.
           MOVE 1 TO SCR-IPRO.
           MOVE WSS-INST-FTER-CMN TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI           TO SYS-CMMA.
           MOVE SCR-TCMA           TO SYS-TCMA.
           MOVE SYS-XCTL           TO SYS-CMND.
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CMN.
           EXIT.
      *DAD fin  07-MAR-1991
      *>>>>
      *<<<< EOF_PQ
       RET-ALL-ICM SECTION.
       INI-RET-ALL-ICM.
           PERFORM KEY-ALL-ICM.
           PERFORM RET-DCC-ICM.
           PERFORM RET-DBC-ICM.
           PERFORM RET-OPE-ICM.
           PERFORM RET-RCO-ICM.
           PERFORM RET-RCD-ICM.
           PERFORM RET-PER-ICM.
       FIN-RET-ALL-ICM.
           EXIT.

       RET-DCC-ICM SECTION.
       INI-RET-DCC-ICM.
       FIN-RET-DCC-ICM.
           EXIT.

       RET-DBC-ICM SECTION.
       INI-RET-DBC-ICM.
       FIN-RET-DBC-ICM.
           EXIT.

       RET-OPE-ICM SECTION.
       INI-RET-OPE-ICM.
      *<<<< INI_RET_OPE_ICM
      *>>>>
           MOVE OPE-CAI-IOPE IN ICM-FLD TO OPE-CAI-IOPE IN OPE.
           MOVE OPE-IIC-IOPE IN ICM-FLD TO OPE-IIC-IOPE IN OPE.
           MOVE OPE-NUM-DIOP IN ICM-FLD TO OPE-NUM-DIOP IN OPE.
           MOVE OPE-NUM-MIOP IN ICM-FLD TO OPE-NUM-MIOP IN OPE.
           MOVE OPE-NUM-SIOP IN ICM-FLD TO OPE-NUM-SIOP IN OPE.
           MOVE OPE-NUM-AIOP IN ICM-FLD TO OPE-NUM-AIOP IN OPE.
           MOVE OPE-COD-OFOP IN ICM-FLD TO OPE-COD-OFOP IN OPE.
           MOVE OPE-IND-MCLI IN ICM-FLD TO OPE-IND-MCLI IN OPE.
           MOVE OPE-COD-VCOP IN ICM-FLD TO OPE-COD-VCOP IN OPE.
           MOVE OPE-COD-TCOM IN ICM-FLD TO OPE-COD-TCOM IN OPE.
           MOVE OPE-CAI-ICAR IN ICM-FLD TO OPE-CAI-ICAR IN OPE.
           MOVE OPE-IIC-ICAR IN ICM-FLD TO OPE-IIC-ICAR IN OPE.
           MOVE OPE-COD-EJOP IN ICM-FLD TO OPE-COD-EJOP IN OPE.
           MOVE OPE-NUM-DTOP IN ICM-FLD TO OPE-NUM-DTOP IN OPE.
           MOVE OPE-NUM-MTOP IN ICM-FLD TO OPE-NUM-MTOP IN OPE.
           MOVE OPE-NUM-STOP IN ICM-FLD TO OPE-NUM-STOP IN OPE.
           MOVE OPE-NUM-ATOP IN ICM-FLD TO OPE-NUM-ATOP IN OPE.
           MOVE OPE-COD-MOTT IN ICM-FLD TO OPE-COD-MOTT IN OPE.
      *<<<< FIN_RET_OPE_ICM
      *>>>>
       FIN-RET-OPE-ICM.
           EXIT.

       RET-RCO-ICM SECTION.
       INI-RET-RCO-ICM.
           MOVE RCO-NUM-DIRE IN ICM-FLD TO RCO-NUM-DIRE IN RCO.
       FIN-RET-RCO-ICM.
           EXIT.

       RET-RCD-ICM SECTION.
       INI-RET-RCD-ICM.
           MOVE RCD-GLS-DIRE IN ICM-FLD TO RCD-GLS-DIRE IN RCD.
       FIN-RET-RCD-ICM.
           EXIT.

       RET-PER-ICM SECTION.
       INI-RET-PER-ICM.
           MOVE PER-GLS-NOM1 IN ICM-FLD TO PER-GLS-NOM1 IN PER.
           MOVE PER-GLS-NOM2 IN ICM-FLD TO PER-GLS-NOM2 IN PER.
       FIN-RET-PER-ICM.
           EXIT.

       PRO-FLD-ICM SECTION.
       INI-PRO-FLD-ICM.
           MOVE FRM-CPIM-AEY TO FRM-IND-MCLI-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-IND-ICLP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-GLS-ICLP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-NUM-ICLP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VRF-ICLP-ATR IN ICM-FLD.
           PERFORM PRO-DCC-ICM.
           PERFORM PRO-DBC-ICM.
           PERFORM PRO-OPE-ICM.
           PERFORM PRO-RCO-ICM.
           PERFORM PRO-RCD-ICM.
           PERFORM PRO-PER-ICM.
       FIN-PRO-FLD-ICM.
           EXIT.

       PRO-DCC-ICM SECTION.
       INI-PRO-DCC-ICM.
       FIN-PRO-DCC-ICM.
           EXIT.

       PRO-DBC-ICM SECTION.
       INI-PRO-DBC-ICM.
       FIN-PRO-DBC-ICM.
           EXIT.

       PRO-OPE-ICM SECTION.
       INI-PRO-OPE-ICM.
      *<<<< INI_PRO_OPE_ICM
      *>>>>
           MOVE FRM-CPIM-AEY TO OPE-CAI-IOPE-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO OPE-IIC-IOPE-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO OPE-FEC-FIOP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-OFOP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-TCOM-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO OPE-CAI-ICAR-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO OPE-IIC-ICAR-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-EJOP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO OPE-FEC-FTOP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO OPE-COD-MOTT-ATR IN ICM-FLD.
      *<<<< FIN_PRO_OPE_ICM
      *>>>>
       FIN-PRO-OPE-ICM.
           EXIT.

       PRO-RCO-ICM SECTION.
       INI-PRO-RCO-ICM.
           MOVE FRM-CPIM-AEY TO RCO-NUM-DIRE-ATR IN ICM-FLD.
       FIN-PRO-RCO-ICM.
           EXIT.

       PRO-RCD-ICM SECTION.
       INI-PRO-RCD-ICM.
       FIN-PRO-RCD-ICM.
           EXIT.

       PRO-PER-ICM SECTION.
       INI-PRO-PER-ICM.
           MOVE FRM-CPIM-AEY TO PER-GLS-NOM1-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO PER-GLS-NOM2-ATR IN ICM-FLD.
       FIN-PRO-PER-ICM.
           EXIT.
      *>>>>



