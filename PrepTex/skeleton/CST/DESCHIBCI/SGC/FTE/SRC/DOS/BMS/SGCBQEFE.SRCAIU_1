      *
      * SGCBQEFE
      * Version 3.0.1 Nov-2005
      * 08-May-19 11:40 AM
      *
       SET-TAG-SGCBQEFE SECTION.
       INI-SET-TAG-SGCBQEFE.
           MOVE
           '<IDNMOD NOM=$SGCBQEFE$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$08-May-19 11:40 AM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-SGCBQEFE.
           EXIT.
           
       PUT-ALL-EFE SECTION.
       INI-PUT-ALL-EFE.
           PERFORM PUT-DBC-EFE.
           PERFORM PUT-EFE-EFE.
           PERFORM PUT-DCC-EFE.
       FIN-PUT-ALL-EFE.
           EXIT.
       
       PUT-DBC-EFE SECTION.
       INI-PUT-DBC-EFE.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-EFE.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-EFE
               GO TO FIN-PUT-DBC-EFE.
           MOVE DBC-GLS-NOMC IN DBC TO DBC-GLS-NOMC IN EFE-FLD.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN EFE-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN EFE-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN EFE-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN EFE-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
      *<<<< FIN_PUT_DBC_EFE
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN EFE-FLD.
      *>>>>
       FIN-PUT-DBC-EFE.
           EXIT.
       
       PUT-EFE-EFE SECTION.
       INI-PUT-EFE-EFE.
      *<<<< INI_PUT_EFE_EFE
           IF PGM-STAT-EFE-NUL
               GO TO FIN-PUT-EFE-EFE.
           IF NOT PGM-STAT-EFE-OKS
               PERFORM CLR-EFE-EFE
               PERFORM CLR-FRM-EFE
               GO TO FIN-PUT-EFE-EFE.
      *>>>>
           IF PGM-STAT-EFE-NUL
               GO TO FIN-PUT-EFE-EFE.
           IF NOT PGM-STAT-EFE-OKS
               PERFORM CLR-EFE-EFE
               GO TO FIN-PUT-EFE-EFE.
           MOVE EFE-CAI-ICLI IN EFE TO EFE-CAI-ICLI IN EFE-FLD.
           MOVE EFE-IIC-ICLI IN EFE TO EFE-IIC-ICLI IN EFE-FLD.
           MOVE EFE-IND-ESBL IN EFE TO EFE-IND-ESBL IN EFE-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE EFE-NUM-DEFE IN EFE TO EFE-NUM-DEFE IN EFE-FLD.
           MOVE EFE-NUM-MEFE IN EFE TO EFE-NUM-MEFE IN EFE-FLD.
           MOVE EFE-NUM-SEFE IN EFE TO EFE-NUM-SEFE IN EFE-FLD.
           MOVE EFE-NUM-AEFE IN EFE TO EFE-NUM-AEFE IN EFE-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE EFE-COD-VCEF IN EFE TO EFE-COD-VCEF IN EFE-FLD.
           MOVE EFE-VAL-ACIR IN EFE TO EFE-VAL-ACIR IN EFE-FLD.
           MOVE EFE-VAL-PCIR IN EFE TO EFE-VAL-PCIR IN EFE-FLD.
           MOVE EFE-VAL-AFIJ IN EFE TO EFE-VAL-AFIJ IN EFE-FLD.
           MOVE EFE-VAL-PLPZ IN EFE TO EFE-VAL-PLPZ IN EFE-FLD.
           MOVE EFE-VAL-OACT IN EFE TO EFE-VAL-OACT IN EFE-FLD.
           MOVE EFE-SGV-PATR IN EFE TO EFE-SGV-PATR IN EFE-FLD.
           MOVE EFE-SGV-UTIL IN EFE TO EFE-SGV-UTIL IN EFE-FLD.
           MOVE EFE-VAL-AVAL IN EFE TO EFE-VAL-AVAL IN EFE-FLD.
           MOVE EFE-SGV-LACI IN EFE TO EFE-SGV-LACI IN EFE-FLD.
           MOVE EFE-SGV-VENE IN EFE TO EFE-SGV-VENE IN EFE-FLD.
           MOVE EFE-VAL-VENP IN EFE TO EFE-VAL-VENP IN EFE-FLD.
           MOVE EFE-SGV-RESO IN EFE TO EFE-SGV-RESO IN EFE-FLD.
           MOVE EFE-SGV-GOBR IN EFE TO EFE-SGV-GOBR IN EFE-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF EFE-COD-VCEF IN EFE-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR ' TO TAB-COD-TTAB IN TAB
               MOVE EFE-COD-VCEF IN EFE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-VCEF IN EFE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-VCEF IN EFE-FLD.
      *<<<< FIN_PUT_EFE_EFE 
       CAL-FRM-VAL-TACT.
           ADD EFE-VAL-ACIR IN EFE-FLD
               EFE-VAL-AFIJ IN EFE-FLD
               EFE-VAL-OACT IN EFE-FLD
               GIVING FRM-VAL-TACT IN EFE-FLD.

       CAL-FRM-VAL-TPAS.
           ADD EFE-VAL-PCIR IN EFE-FLD
               EFE-VAL-PLPZ IN EFE-FLD
               EFE-SGV-PATR IN EFE-FLD
               EFE-SGV-UTIL IN EFE-FLD
               GIVING FRM-VAL-TPAS IN EFE-FLD.
       CAL-FRM-SGV-LCOR.
           IF EFE-VAL-PCIR IN EFE-FLD > ZEROES
               DIVIDE EFE-VAL-ACIR IN EFE-FLD BY 
                      EFE-VAL-PCIR IN EFE-FLD
                      GIVING FRM-SGV-LCOR IN EFE-FLD ROUNDED
           ELSE
               IF EFE-VAL-ACIR IN EFE-FLD > ZEROES
                   MOVE 9999999,99 TO FRM-SGV-LCOR IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-LCOR IN EFE-FLD.
       CAL-FRM-SGV-LEVE.
           ADD EFE-VAL-PCIR IN EFE-FLD
               EFE-VAL-PLPZ IN EFE-FLD
               GIVING WSS-VAL-PCPL IN WSS-VARI.
           ADD EFE-SGV-PATR IN EFE-FLD
               EFE-SGV-UTIL IN EFE-FLD
               GIVING WSS-SGV-PAUT IN WSS-VARI.
           IF WSS-SGV-PAUT IN WSS-VARI NOT = ZEROES
               DIVIDE WSS-VAL-PCPL IN WSS-VARI BY 
                      WSS-SGV-PAUT IN WSS-VARI 
                      GIVING FRM-SGV-LEVE IN EFE-FLD ROUNDED
           ELSE
               IF WSS-VAL-PCPL IN WSS-VARI > ZEROES
                   MOVE 9999999,99 TO FRM-SGV-LEVE IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-LEVE IN EFE-FLD.
       CAL-FRM-SGV-RVEN.
           IF EFE-VAL-VENP IN EFE-FLD > ZEROES
               MULTIPLY EFE-SGV-UTIL IN EFE-FLD BY 100
                    GIVING WSS-SGV-PATR IN WSS-VARI
               DIVIDE WSS-SGV-PATR IN WSS-VARI BY 
                      EFE-VAL-VENP IN EFE-FLD
                      GIVING FRM-SGV-RVEN IN EFE-FLD ROUNDED
           ELSE
               IF EFE-SGV-UTIL IN EFE-FLD NOT = ZEROES
                   MOVE 9999999,99 TO FRM-SGV-RVEN IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-RVEN IN EFE-FLD.
       CAL-FRM-SGV-RPAT.
           IF EFE-SGV-PATR IN EFE-FLD NOT =  ZEROES
               MULTIPLY EFE-SGV-UTIL IN EFE-FLD BY 100
                    GIVING WSS-SGV-PATR IN WSS-VARI
               DIVIDE WSS-SGV-PATR IN WSS-VARI BY 
                      EFE-SGV-PATR IN EFE-FLD 
                      GIVING FRM-SGV-RPAT IN EFE-FLD ROUNDED
           ELSE
               IF EFE-SGV-UTIL IN EFE-FLD NOT = ZEROES
                   MOVE 9999999,99 TO FRM-SGV-RPAT IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-RPAT IN EFE-FLD.
      *>>>>
       FIN-PUT-EFE-EFE.
           EXIT.
       
       PUT-DCC-EFE SECTION.
       INI-PUT-DCC-EFE.
           IF PGM-STAT-DCC-NUL
               GO TO FIN-PUT-DCC-EFE.
           IF NOT PGM-STAT-DCC-OKS
               PERFORM CLR-DCC-EFE
               GO TO FIN-PUT-DCC-EFE.
           MOVE DCC-COD-BDIR IN DCC TO DCC-COD-BDIR IN EFE-FLD.
      *<<<< FIN-PUT-DCC-EFE
      * RGD-INI 04-08-2009 "ORIGEN RENTA"
      *BUS-TAB busca glosa de codigo en tabla                        
           IF DCC-COD-BDIR IN EFE-FLD > SPACES
               MOVE 'SGC'                   TO TAB-COD-SIST
               MOVE 'BDR'                   TO TAB-COD-TTAB IN TAB
               MOVE DCC-COD-BDIR IN EFE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB.
      * RGD-FIN 04-08-2009
      *>>>>
       FIN-PUT-DCC-EFE.
           EXIT.
       
       KEY-ALL-EFE SECTION.
       INI-KEY-ALL-EFE.
           PERFORM KEY-DBC-EFE.
           PERFORM KEY-EFE-EFE.
           PERFORM KEY-DCC-EFE.
       FIN-KEY-ALL-EFE.
           EXIT.
       
       KEY-DBC-EFE SECTION.
       INI-KEY-DBC-EFE.
           MOVE DBC-GLS-NOMC IN EFE-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN EFE-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN EFE-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN EFE-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN EFE-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-EFE.
           EXIT.
       
       KEY-EFE-EFE SECTION.
       INI-KEY-EFE-EFE.
           MOVE EFE-CAI-ICLI IN EFE-FLD TO EFE-CAI-ICLI IN EFE.
           MOVE EFE-IIC-ICLI IN EFE-FLD TO EFE-IIC-ICLI IN EFE.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE EFE-NUM-DEFE IN EFE-FLD TO EFE-NUM-DEFE IN EFE.
           MOVE EFE-NUM-MEFE IN EFE-FLD TO EFE-NUM-MEFE IN EFE.
           MOVE EFE-NUM-SEFE IN EFE-FLD TO EFE-NUM-SEFE IN EFE.
           MOVE EFE-NUM-AEFE IN EFE-FLD TO EFE-NUM-AEFE IN EFE.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-EFE-EFE.
           EXIT.
       
       KEY-DCC-EFE SECTION.
       INI-KEY-DCC-EFE.
      *<<<< INI_KEY_DCC_EFE
      * RGD-INI 04-08-2009 "ORIGEN RENTA"
           MOVE EFE-CIC-ICLI IN EFE TO DCC-CIC-ICLI IN DCC.
      * RGD-FIN 04-08-2009 
      *>>>>
       FIN-KEY-DCC-EFE.
           EXIT.
       
       SCR-CLRA-EFE SECTION.
       INI-SCR-CLRA-EFE.
           PERFORM CLR-KEY-EFE.
           PERFORM CLR-FLD-EFE.
       FIN-SCR-CLRA-EFE.
           EXIT.
       
       CLR-KEY-EFE SECTION.
       INI-CLR-KEY-EFE.
           MOVE SPACES TO DBC-GLS-NOMC IN EFE-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN EFE-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN EFE-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN EFE-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN EFE-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO EFE-CAI-ICLI IN EFE-FLD.
           MOVE SPACES TO EFE-IIC-ICLI IN EFE-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO EFE-FEC-FEFE IN EFE-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-KEY-EFE.
           EXIT.
       
       CLR-FLD-EFE SECTION.
       INI-CLR-FLD-EFE.
           MOVE SPACES TO FRM-GLS-VCEF IN EFE-FLD.
           MOVE ZEROES TO FRM-VAL-TACT IN EFE-FLD.
           MOVE ZEROES TO FRM-VAL-TPAS IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LCOR IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LEVE IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RVEN IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RPAT IN EFE-FLD.
           PERFORM CLR-DBC-EFE.
           PERFORM CLR-EFE-EFE.
           PERFORM CLR-DCC-EFE.
       FIN-CLR-FLD-EFE.
           EXIT.
       
       CLR-DBC-EFE SECTION.
       INI-CLR-DBC-EFE.
       FIN-CLR-DBC-EFE.
           EXIT.
       
       CLR-EFE-EFE SECTION.
       INI-CLR-EFE-EFE.
           MOVE SPACES TO EFE-IND-ESBL IN EFE-FLD.
           MOVE SPACES TO EFE-COD-VCEF IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-ACIR IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-PCIR IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-AFIJ IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-PLPZ IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-OACT IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-PATR IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-UTIL IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-AVAL IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-LACI IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-VENE IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-VENP IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-RESO IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-GOBR IN EFE-FLD.
       FIN-CLR-EFE-EFE.
           EXIT.
       
       CLR-DCC-EFE SECTION.
       INI-CLR-DCC-EFE.
           MOVE SPACES TO DCC-COD-BDIR IN EFE-FLD.
       FIN-CLR-DCC-EFE.
           EXIT.
       
       FST-KEY-EFE SECTION.
       INI-FST-KEY-EFE.
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN EFE-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
       FIN-FST-KEY-EFE.
           EXIT.
       
       FST-FLD-EFE SECTION.
       INI-FST-FLD-EFE.
           MOVE -1 TO EFE-IND-ESBL-LEN IN EFE-FLD.
       FIN-FST-FLD-EFE.
           EXIT.
       
       PRO-KEY-EFE SECTION.
       INI-PRO-KEY-EFE.
           PERFORM PRO-IKY-EFE.
           PERFORM PRO-AKY-EFE.
           PERFORM PRO-MKY-EFE.
       FIN-PRO-KEY-EFE.
           EXIT.
       
       PRO-IKY-EFE SECTION.
       INI-PRO-IKY-EFE.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN EFE-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO EFE-FEC-FEFE-ATR IN EFE-FLD.
       FIN-PRO-IKY-EFE.
           EXIT.
       
       PRO-MKY-EFE SECTION.
       INI-PRO-MKY-EFE.
       FIN-PRO-MKY-EFE.
           EXIT.
       
       PRO-AKY-EFE SECTION.
       INI-PRO-AKY-EFE.
           MOVE FRM-CPIM-AEY TO DBC-GLS-NOMC-ATR IN EFE-FLD.
       FIN-PRO-AKY-EFE.
           EXIT.
       
       UNP-KEY-EFE SECTION.
       INI-UNP-KEY-EFE.
           PERFORM UNP-IKY-EFE.
           PERFORM UNP-AKY-EFE.
           PERFORM UNP-MKY-EFE.
       FIN-UNP-KEY-EFE.
           EXIT.
       
       UNP-IKY-EFE SECTION.
       INI-UNP-IKY-EFE.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN EFE-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO EFE-FEC-FEFE-ATR IN EFE-FLD.
       FIN-UNP-IKY-EFE.
           EXIT.
       
       UNP-MKY-EFE SECTION.
       INI-UNP-MKY-EFE.
       FIN-UNP-MKY-EFE.
           EXIT.
       
       UNP-AKY-EFE SECTION.
       INI-UNP-AKY-EFE.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-EFE.
           EXIT.
       
       UNP-FLD-EFE SECTION.
       INI-UNP-FLD-EFE.
           MOVE FRM-CPIM-UBY TO FRM-VAL-TACT-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VAL-TPAS-ATR IN EFE-FLD.
           PERFORM UNP-DBC-EFE.
           PERFORM UNP-EFE-EFE.
           PERFORM UNP-DCC-EFE.
       FIN-UNP-FLD-EFE.
           EXIT.
       
       UNP-DBC-EFE SECTION.
       INI-UNP-DBC-EFE.
       FIN-UNP-DBC-EFE.
           EXIT.
       
       UNP-EFE-EFE SECTION.
       INI-UNP-EFE-EFE.
           MOVE FRM-CPIM-UBY TO EFE-IND-ESBL-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-COD-VCEF-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-ACIR-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-PCIR-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-AFIJ-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-PLPZ-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-OACT-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-PATR-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-UTIL-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-AVAL-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-LACI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-VENE-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-VENP-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-RESO-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-GOBR-ATR IN EFE-FLD.
       FIN-UNP-EFE-EFE.
           EXIT.
       
       UNP-DCC-EFE SECTION.
       INI-UNP-DCC-EFE.
           MOVE FRM-CPIM-UBY TO DCC-COD-BDIR-ATR IN EFE-FLD.
       FIN-UNP-DCC-EFE.
           EXIT.
       
       VAL-KEY-EFE SECTION.
       INI-VAL-KEY-EFE.
           PERFORM VAL-IKY-EFE.
           PERFORM VAL-MKY-EFE.
           PERFORM VAL-AKY-EFE.
       FIN-VAL-KEY-EFE.
           EXIT.
       
       VAL-IKY-EFE SECTION.
       INI-VAL-IKY-EFE.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN EFE-FLD
                GO TO FIN-VAL-IKY-EFE.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN EFE-FLD
                GO TO FIN-VAL-IKY-EFE.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN EFE-FLD
                GO TO FIN-VAL-IKY-EFE.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN EFE-FLD
                GO TO FIN-VAL-IKY-EFE.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-EFE-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-CAI-ICLI-LEN IN EFE-FLD
                GO TO FIN-VAL-IKY-EFE.
           PERFORM VAL-EFE-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-IIC-ICLI-LEN IN EFE-FLD
                GO TO FIN-VAL-IKY-EFE.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-EFE-FEC-FEFE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                EFE-FEC-FEFE-LEN IN EFE-FLD
                GO TO FIN-VAL-IKY-EFE.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-IKY-EFE.
           EXIT.
       
       VAL-MKY-EFE SECTION.
       INI-VAL-MKY-EFE.
       FIN-VAL-MKY-EFE.
           EXIT.
       
       VAL-AKY-EFE SECTION.
       INI-VAL-AKY-EFE.
           PERFORM VAL-DBC-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DBC-GLS-NOMC-LEN IN EFE-FLD
                GO TO FIN-VAL-AKY-EFE.
       FIN-VAL-AKY-EFE.
           EXIT.
       
       VAL-DBC-GLS-NOMC SECTION.
       INI-VAL-DBC-GLS-NOMC.
           IF DBC-GLS-NOMC IN EFE-FLD NOT > SPACES
              MOVE SPACES TO DBC-GLS-NOMC IN EFE-FLD.
       FIN-VAL-DBC-GLS-NOMC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN EFE-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN EFE-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN EFE-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN EFE-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN EFE-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN EFE-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN EFE-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN EFE-FLD.
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN EFE-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN EFE-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN EFE-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN EFE-FLD.
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-EFE-CAI-ICLI SECTION.
       INI-VAL-EFE-CAI-ICLI.
       FIN-VAL-EFE-CAI-ICLI.
           EXIT.
       
       VAL-EFE-IIC-ICLI SECTION.
       INI-VAL-EFE-IIC-ICLI.
       FIN-VAL-EFE-IIC-ICLI.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-EFE-FEC-FEFE SECTION.
       INI-VAL-EFE-FEC-FEFE.
           IF EFE-FEC-FEFE IN EFE-FLD  NOT > ZEROES
              MOVE ZEROES TO EFE-FEC-FEFE IN EFE-FLD.
      *VAL-FEC Validar Fecha
           MOVE EFE-FEC-FEFE IN EFE-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_EFE_FEC_FEFE
           IF SCR-CCPP = 'ING'
               MOVE FEC-FBLK-N TO FEC-FBLK
           ELSE
               MOVE FEC-FBLK-S TO FEC-FBLK.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO EFE-FEC-FEFE IN EFE-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-EFE-FEC-FEFE.
       FIN-VAL-EFE-FEC-FEFE.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CON-KEY-EFE SECTION.
       INI-VAL-CON-KEY-EFE.
      *<<<< INI_VAL_CON_KEY_EFE
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-EFE.
      *>>>>
           IF     DBC-GLS-NOMC IN EFE-FLD NOT > SPACES 
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
              AND DBC-NUM-ICLI IN EFE-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN EFE-FLD NOT > SPACES
              AND DBC-IND-ICLI IN EFE-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN EFE-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
              AND EFE-CAI-ICLI IN EFE-FLD NOT > SPACES 
              AND EFE-IIC-ICLI IN EFE-FLD NOT > SPACES 
              AND EFE-FEC-FEFE IN EFE-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-EFE.
      *<<<< FIN_VAL_CON_KEY_EFE
           IF DBC-NUM-ICLI IN EFE-FLD NOT > ZEROES AND
              DBC-GLS-NOMC IN EFE-FLD NOT > SPACES
      *GET-MSG Busca mensaje en tabla
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-KEY-EFE.
      *>>>>
       FIN-VAL-CON-KEY-EFE.
           EXIT.
       
       VAL-CON-IKY-EFE SECTION.
       INI-VAL-CON-IKY-EFE.
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
           IF     DBC-NUM-ICLI IN EFE-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN EFE-FLD NOT > SPACES
              AND DBC-IND-ICLI IN EFE-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN EFE-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
              AND EFE-CAI-ICLI IN EFE-FLD NOT > SPACES 
              AND EFE-IIC-ICLI IN EFE-FLD NOT > SPACES 
              AND EFE-FEC-FEFE IN EFE-FLD NOT > ZEROES
                PERFORM ERR-KEY
                PERFORM FST-KEY-EFE.
       FIN-VAL-CON-IKY-EFE.
           EXIT.
       
       VAL-NUM-KEY-EFE SECTION.
       INI-VAL-NUM-KEY-EFE.
           PERFORM VAL-NUM-IKY-EFE.
           PERFORM VAL-NUM-MKY-EFE.
           PERFORM VAL-NUM-AKY-EFE.
       FIN-VAL-NUM-KEY-EFE.
           EXIT.
       
       VAL-NUM-IKY-EFE SECTION.
       INI-VAL-NUM-IKY-EFE.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-IKY-EFE.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-IKY-EFE.
           EXIT.
       
       VAL-NUM-MKY-EFE SECTION.
       INI-VAL-NUM-MKY-EFE.
       FIN-VAL-NUM-MKY-EFE.
           EXIT.
       
       VAL-NUM-AKY-EFE SECTION.
       INI-VAL-NUM-AKY-EFE.
       FIN-VAL-NUM-AKY-EFE.
           EXIT.
       
       VAL-NUM-FLD-EFE SECTION.
       INI-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-ACIR.
           MOVE EFE-VAL-ACIR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-ACIR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-ACIR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-PCIR.
           MOVE EFE-VAL-PCIR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-PCIR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-PCIR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-AFIJ.
           MOVE EFE-VAL-AFIJ-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-AFIJ IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-AFIJ-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-PLPZ.
           MOVE EFE-VAL-PLPZ-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-PLPZ IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-PLPZ-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-OACT.
           MOVE EFE-VAL-OACT-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-OACT IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-OACT-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-PATR.
           MOVE EFE-SGV-PATR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-PATR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-PATR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-UTIL.
           MOVE EFE-SGV-UTIL-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-UTIL IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-UTIL-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-VAL-TACT.
           MOVE FRM-VAL-TACT-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-VAL-TACT IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-TACT-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-VAL-TPAS.
           MOVE FRM-VAL-TPAS-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-VAL-TPAS IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-TPAS-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-SGV-LCOR.
           MOVE FRM-SGV-LCOR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-SGV-LCOR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-LCOR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-AVAL.
           MOVE EFE-VAL-AVAL-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-AVAL IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-AVAL-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-LACI.
           MOVE EFE-SGV-LACI-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO EFE-SGV-LACI IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-LACI-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-VENE.
           MOVE EFE-SGV-VENE-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-VENE IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-VENE-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-SGV-LEVE.
           MOVE FRM-SGV-LEVE-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-SGV-LEVE IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-LEVE-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-VENP.
           MOVE EFE-VAL-VENP-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-VENP IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-VENP-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-SGV-RVEN.
           MOVE FRM-SGV-RVEN-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-SGV-RVEN IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-RVEN-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-RESO.
           MOVE EFE-SGV-RESO-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-RESO IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-RESO-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-SGV-RPAT.
           MOVE FRM-SGV-RPAT-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-SGV-RPAT IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-RPAT-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-GOBR.
           MOVE EFE-SGV-GOBR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-GOBR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-GOBR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       FIN-VAL-NUM-FLD-EFE.
           EXIT.
       
       EDT-KEY-EFE SECTION.
       INI-EDT-KEY-EFE.
           PERFORM EDT-IKY-EFE.
           PERFORM EDT-MKY-EFE.
           PERFORM EDT-AKY-EFE.
       FIN-EDT-KEY-EFE.
           EXIT.
       
       EDT-IKY-EFE SECTION.
       INI-EDT-IKY-EFE.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN EFE-FLD
                GO TO FIN-EDT-IKY-EFE.
           MOVE DBC-NUM-ICLI IN EFE-FLD TO
                DBC-NUM-ICLI-EDT IN EFE-EDT.
           MOVE DBC-NUM-ICLI-EDT IN EFE-EDT TO
                DBC-NUM-ICLI-ALF IN EFE-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-IKY-EFE.
           EXIT.
       
       EDT-MKY-EFE SECTION.
       INI-EDT-MKY-EFE.
       FIN-EDT-MKY-EFE.
           EXIT.
       
       EDT-AKY-EFE SECTION.
       INI-EDT-AKY-EFE.
       FIN-EDT-AKY-EFE.
           EXIT.
       
       EDT-FLD-EFE SECTION.
       INI-EDT-FLD-EFE.
           IF EFE-VAL-ACIR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-ACIR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-ACIR IN EFE-FLD TO EFE-VAL-ACIR-EDT IN EFE-EDT.
           MOVE EFE-VAL-ACIR-EDT IN EFE-EDT TO 
                EFE-VAL-ACIR-ALF IN EFE-FLD.
           IF EFE-VAL-PCIR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-PCIR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-PCIR IN EFE-FLD TO EFE-VAL-PCIR-EDT IN EFE-EDT.
           MOVE EFE-VAL-PCIR-EDT IN EFE-EDT TO 
                EFE-VAL-PCIR-ALF IN EFE-FLD.
           IF EFE-VAL-AFIJ-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-AFIJ-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-AFIJ IN EFE-FLD TO EFE-VAL-AFIJ-EDT IN EFE-EDT.
           MOVE EFE-VAL-AFIJ-EDT IN EFE-EDT TO 
                EFE-VAL-AFIJ-ALF IN EFE-FLD.
           IF EFE-VAL-PLPZ-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-PLPZ-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-PLPZ IN EFE-FLD TO EFE-VAL-PLPZ-EDT IN EFE-EDT.
           MOVE EFE-VAL-PLPZ-EDT IN EFE-EDT TO 
                EFE-VAL-PLPZ-ALF IN EFE-FLD.
           IF EFE-VAL-OACT-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-OACT-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-OACT IN EFE-FLD TO EFE-VAL-OACT-EDT IN EFE-EDT.
           MOVE EFE-VAL-OACT-EDT IN EFE-EDT TO 
                EFE-VAL-OACT-ALF IN EFE-FLD.
           IF EFE-SGV-PATR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-PATR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-PATR IN EFE-FLD TO EFE-SGV-PATR-EDT IN EFE-EDT.
           MOVE EFE-SGV-PATR-EDT IN EFE-EDT TO 
                EFE-SGV-PATR-ALF IN EFE-FLD.
           IF EFE-SGV-UTIL-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-UTIL-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-UTIL IN EFE-FLD TO EFE-SGV-UTIL-EDT IN EFE-EDT.
           MOVE EFE-SGV-UTIL-EDT IN EFE-EDT TO 
                EFE-SGV-UTIL-ALF IN EFE-FLD.
           IF FRM-VAL-TACT-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-TACT-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-VAL-TACT IN EFE-FLD TO FRM-VAL-TACT-EDT IN EFE-EDT.
           MOVE FRM-VAL-TACT-EDT IN EFE-EDT TO 
                FRM-VAL-TACT-ALF IN EFE-FLD.
           IF FRM-VAL-TPAS-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-TPAS-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-VAL-TPAS IN EFE-FLD TO FRM-VAL-TPAS-EDT IN EFE-EDT.
           MOVE FRM-VAL-TPAS-EDT IN EFE-EDT TO 
                FRM-VAL-TPAS-ALF IN EFE-FLD.
           IF FRM-SGV-LCOR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-LCOR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-SGV-LCOR IN EFE-FLD TO FRM-SGV-LCOR-EDT IN EFE-EDT.
           MOVE FRM-SGV-LCOR-EDT IN EFE-EDT TO 
                FRM-SGV-LCOR-ALF IN EFE-FLD.
           IF EFE-VAL-AVAL-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-AVAL-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-AVAL IN EFE-FLD TO EFE-VAL-AVAL-EDT IN EFE-EDT.
           MOVE EFE-VAL-AVAL-EDT IN EFE-EDT TO 
                EFE-VAL-AVAL-ALF IN EFE-FLD.
           IF EFE-SGV-LACI-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-LACI-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-LACI IN EFE-FLD TO EFE-SGV-LACI-EDT IN EFE-EDT.
           MOVE EFE-SGV-LACI-EDT IN EFE-EDT TO 
                EFE-SGV-LACI-ALF IN EFE-FLD.
           IF EFE-SGV-VENE-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-VENE-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-VENE IN EFE-FLD TO EFE-SGV-VENE-EDT IN EFE-EDT.
           MOVE EFE-SGV-VENE-EDT IN EFE-EDT TO 
                EFE-SGV-VENE-ALF IN EFE-FLD.
           IF FRM-SGV-LEVE-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-LEVE-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-SGV-LEVE IN EFE-FLD TO FRM-SGV-LEVE-EDT IN EFE-EDT.
           MOVE FRM-SGV-LEVE-EDT IN EFE-EDT TO 
                FRM-SGV-LEVE-ALF IN EFE-FLD.
           IF EFE-VAL-VENP-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-VENP-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-VENP IN EFE-FLD TO EFE-VAL-VENP-EDT IN EFE-EDT.
           MOVE EFE-VAL-VENP-EDT IN EFE-EDT TO 
                EFE-VAL-VENP-ALF IN EFE-FLD.
           IF FRM-SGV-RVEN-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-RVEN-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-SGV-RVEN IN EFE-FLD TO FRM-SGV-RVEN-EDT IN EFE-EDT.
           MOVE FRM-SGV-RVEN-EDT IN EFE-EDT TO 
                FRM-SGV-RVEN-ALF IN EFE-FLD.
           IF EFE-SGV-RESO-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-RESO-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-RESO IN EFE-FLD TO EFE-SGV-RESO-EDT IN EFE-EDT.
           MOVE EFE-SGV-RESO-EDT IN EFE-EDT TO 
                EFE-SGV-RESO-ALF IN EFE-FLD.
           IF FRM-SGV-RPAT-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-RPAT-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-SGV-RPAT IN EFE-FLD TO FRM-SGV-RPAT-EDT IN EFE-EDT.
           MOVE FRM-SGV-RPAT-EDT IN EFE-EDT TO 
                FRM-SGV-RPAT-ALF IN EFE-FLD.
           IF EFE-SGV-GOBR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-GOBR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-GOBR IN EFE-FLD TO EFE-SGV-GOBR-EDT IN EFE-EDT.
           MOVE EFE-SGV-GOBR-EDT IN EFE-EDT TO 
                EFE-SGV-GOBR-ALF IN EFE-FLD.
       FIN-EDT-FLD-EFE.
           EXIT.
      *<<<< EOF
       CLR-FRM-EFE SECTION.
       INI-CLR-FRM-EFE.
           MOVE ZEROES TO FRM-VAL-TACT IN EFE-FLD.
           MOVE ZEROES TO FRM-VAL-TPAS IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LCOR IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LEVE IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RVEN IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RPAT IN EFE-FLD.
       FIN-CLR-FRM-EFE.
           EXIT.
      *>>>>
