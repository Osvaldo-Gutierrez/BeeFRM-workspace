      *
      * SGCBQICM
      * Version 3.0.1 Nov-2005
      * 08-May-19 11:40 AM
      *
       SET-TAG-SGCBQICM SECTION.
       INI-SET-TAG-SGCBQICM.
           MOVE
           '<IDNMOD NOM=$SGCBQICM$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$08-May-19 11:40 AM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-SGCBQICM.
           EXIT.
           
       PUT-ALL-ICM SECTION.
       INI-PUT-ALL-ICM.
           PERFORM PUT-DBC-ICM.
           PERFORM PUT-DCC-ICM.
           PERFORM PUT-OPE-ICM.
           PERFORM PUT-RCO-ICM.
           PERFORM PUT-RCD-ICM.
           PERFORM PUT-PER-ICM.
       FIN-PUT-ALL-ICM.
           EXIT.
       
       PUT-DBC-ICM SECTION.
       INI-PUT-DBC-ICM.
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-ICM.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-ICM
               GO TO FIN-PUT-DBC-ICM.
           MOVE DBC-IND-TICL IN DBC TO DBC-IND-TICL IN ICM-FLD.
      * IDC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE DBC-NUM-ICLI IN DBC TO DBC-NUM-ICLI IN ICM-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO DBC-VRF-ICLI IN ICM-FLD.
           MOVE DBC-IND-ICLI IN DBC TO DBC-IND-ICLI IN ICM-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO DBC-GLS-ICLI IN ICM-FLD.
      * IDC-FIN --> BMCHIBCI001210.SRCAIU 
       FIN-PUT-DBC-ICM.
           EXIT.
       
       PUT-DCC-ICM SECTION.
       INI-PUT-DCC-ICM.
           IF PGM-STAT-DCC-NUL
               GO TO FIN-PUT-DCC-ICM.
           IF NOT PGM-STAT-DCC-OKS
               PERFORM CLR-DCC-ICM
               GO TO FIN-PUT-DCC-ICM.
           MOVE DCC-CAI-ICLI IN DCC TO DCC-CAI-ICLI IN ICM-FLD.
           MOVE DCC-IIC-ICLI IN DCC TO DCC-IIC-ICLI IN ICM-FLD.
       FIN-PUT-DCC-ICM.
           EXIT.
       
       PUT-OPE-ICM SECTION.
       INI-PUT-OPE-ICM.
      *<<<< INI_PUT_OPE_ICM
      *>>>>
           IF PGM-STAT-OPE-NUL
               GO TO FIN-PUT-OPE-ICM.
           IF NOT PGM-STAT-OPE-OKS
               PERFORM CLR-OPE-ICM
               GO TO FIN-PUT-OPE-ICM.
           MOVE OPE-CAI-IOPE IN OPE TO OPE-CAI-IOPE IN ICM-FLD.
           MOVE OPE-IIC-IOPE IN OPE TO OPE-IIC-IOPE IN ICM-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE OPE-NUM-DIOP IN OPE TO OPE-NUM-DIOP IN ICM-FLD.
           MOVE OPE-NUM-MIOP IN OPE TO OPE-NUM-MIOP IN ICM-FLD.
           MOVE OPE-NUM-SIOP IN OPE TO OPE-NUM-SIOP IN ICM-FLD.
           MOVE OPE-NUM-AIOP IN OPE TO OPE-NUM-AIOP IN ICM-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE OPE-COD-OFOP IN OPE TO OPE-COD-OFOP IN ICM-FLD.
           MOVE OPE-IND-MCLI IN OPE TO OPE-IND-MCLI IN ICM-FLD.
           MOVE OPE-COD-VCOP IN OPE TO OPE-COD-VCOP IN ICM-FLD.
           MOVE OPE-COD-TCOM IN OPE TO OPE-COD-TCOM IN ICM-FLD.
           MOVE OPE-CAI-ICAR IN OPE TO OPE-CAI-ICAR IN ICM-FLD.
           MOVE OPE-IIC-ICAR IN OPE TO OPE-IIC-ICAR IN ICM-FLD.
           MOVE OPE-COD-EJOP IN OPE TO OPE-COD-EJOP IN ICM-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE OPE-NUM-DTOP IN OPE TO OPE-NUM-DTOP IN ICM-FLD.
           MOVE OPE-NUM-MTOP IN OPE TO OPE-NUM-MTOP IN ICM-FLD.
           MOVE OPE-NUM-STOP IN OPE TO OPE-NUM-STOP IN ICM-FLD.
           MOVE OPE-NUM-ATOP IN OPE TO OPE-NUM-ATOP IN ICM-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE OPE-COD-MOTT IN OPE TO OPE-COD-MOTT IN ICM-FLD.
      *BUS-OFI busca oficina en tablas
           IF OPE-COD-OFOP IN ICM-FLD > SPACES
               MOVE OPE-COD-OFOP IN ICM-FLD TO OFI-COD-OFIC IN OFI
               PERFORM BUS-OFI
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFOP IN ICM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFOP IN ICM-FLD.
      *BUS-USR busca usuario en tablas
           IF OPE-COD-EJOP IN ICM-FLD > SPACES
               MOVE OPE-COD-EJOP IN ICM-FLD TO USR-COD-USER IN USR
               PERFORM BUS-USR
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJOP IN ICM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJOP IN ICM-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF OPE-COD-MOTT IN ICM-FLD > SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'MTO ' TO TAB-COD-TTAB IN TAB
               MOVE OPE-COD-MOTT IN ICM-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DCOR IN TAB TO
                    FRM-GLS-MOTT IN ICM-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-MOTT IN ICM-FLD.
      *<<<< FIN_PUT_OPE_ICM
           IF OPE-IND-MCLI IN ICM-FLD > SPACES
               MOVE 'S' TO FRM-IND-MCLI IN ICM-FLD
           ELSE
               MOVE 'N' TO FRM-IND-MCLI IN ICM-FLD.
      ******************************************************************
      *DAD ini  23-MAR-1992
      *---- agregado por odj desde aqui (a)
           MOVE OPE-IIC-IOPE IN OPE TO FRM-GLS-IANT IN ICM-FLD.
      *DPM INI  20-MAR-1995                                             
      *     IF (OPE-COD-SOPE IN OPE = '99' AND                          
           IF (OPE-COD-OOPE IN OPE NOT < '982' AND                      
      *DPM FIN  20-MAR-1995                                             
               OPE-COD-TCOM IN OPE NOT > SPACES)
               MOVE ZEROES TO OPE-COD-TCOM IN OPE.

           IF (OPE-COD-TCOM IN OPE NOT > SPACES)
      *DAD ini  26-AUG-1992
               MOVE SPACES              TO FRM-GLS-TCOM IN ICM-FLD
      *DAD fin  26-AUG-1992
               MOVE SPACES              TO OPE-COD-TCOM IN ICM-FLD
               MOVE SPACES              TO OPE-CAI-ICAR IN ICM-FLD
               MOVE SPACES              TO OPE-IIC-ICAR IN ICM-FLD
           ELSE
               MOVE OPE-COD-TCOM IN OPE TO OPE-COD-TCOM IN ICM-FLD
               MOVE OPE-CAI-ICAR IN OPE TO OPE-CAI-ICAR IN ICM-FLD
               MOVE OPE-IIC-ICAR IN OPE TO OPE-IIC-ICAR IN ICM-FLD
      *BUS-TAB busca monto de tipo comision en TAB
               IF (OPE-COD-TCOM IN OPE NOT = '99')
                   MOVE 'TAB'                   TO TAB-COD-SIST
                   MOVE 'TIC'                   TO TAB-COD-TTAB IN TAB
                   MOVE OPE-COD-TCOM IN ICM-FLD TO TAB-COD-CTAB IN TAB
                   PERFORM BUS-TAB
                   IF MSG-COD-MENS > SPACES
      *DAD ini  26-AUG-1992
                      MOVE SPACES       TO FRM-GLS-TCOM IN ICM-FLD
      *DAD fin  26-AUG-1992
                      MOVE TAB-GLS-DESC TO FRM-MEN2
                   ELSE
      *DAD ini  26-AUG-1992
                      MOVE TAB-GLS-DESC TO FRM-GLS-TCOM IN ICM-FLD.
      *DAD fin  26-AUG-1992
      *---- agregado por odj hasta aqui (a)
      *DAD ini  23-MAR-1992
      ******************************************************************
      *>>>>
       FIN-PUT-OPE-ICM.
           EXIT.
       
       PUT-RCO-ICM SECTION.
       INI-PUT-RCO-ICM.
           IF PGM-STAT-RCO-NUL
               GO TO FIN-PUT-RCO-ICM.
           IF NOT PGM-STAT-RCO-OKS
               PERFORM CLR-RCO-ICM
               GO TO FIN-PUT-RCO-ICM.
           MOVE RCO-NUM-DIRE IN RCO TO RCO-NUM-DIRE IN ICM-FLD.
       FIN-PUT-RCO-ICM.
           EXIT.
       
       PUT-RCD-ICM SECTION.
       INI-PUT-RCD-ICM.
           IF PGM-STAT-RCD-NUL
               GO TO FIN-PUT-RCD-ICM.
           IF NOT PGM-STAT-RCD-OKS
               PERFORM CLR-RCD-ICM
               GO TO FIN-PUT-RCD-ICM.
           MOVE RCD-GLS-DIRE IN RCD TO RCD-GLS-DIRE IN ICM-FLD.
       FIN-PUT-RCD-ICM.
           EXIT.
       
       PUT-PER-ICM SECTION.
       INI-PUT-PER-ICM.
           IF PGM-STAT-PER-NUL
               GO TO FIN-PUT-PER-ICM.
           IF NOT PGM-STAT-PER-OKS
               PERFORM CLR-PER-ICM
               GO TO FIN-PUT-PER-ICM.
           MOVE PER-GLS-NOM1 IN PER TO PER-GLS-NOM1 IN ICM-FLD.
           MOVE PER-GLS-NOM2 IN PER TO PER-GLS-NOM2 IN ICM-FLD.
       FIN-PUT-PER-ICM.
           EXIT.
       
       KEY-ALL-ICM SECTION.
       INI-KEY-ALL-ICM.
           PERFORM KEY-DBC-ICM.
           PERFORM KEY-DCC-ICM.
           PERFORM KEY-OPE-ICM.
           PERFORM KEY-RCO-ICM.
           PERFORM KEY-RCD-ICM.
           PERFORM KEY-PER-ICM.
       FIN-KEY-ALL-ICM.
           EXIT.
       
       KEY-DBC-ICM SECTION.
       INI-KEY-DBC-ICM.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN ICM-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN ICM-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN ICM-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN ICM-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-ICM.
           EXIT.
       
       KEY-DCC-ICM SECTION.
       INI-KEY-DCC-ICM.
           MOVE DCC-CAI-ICLI IN ICM-FLD TO DCC-CAI-ICLI IN DCC.
           MOVE DCC-IIC-ICLI IN ICM-FLD TO DCC-IIC-ICLI IN DCC.
       FIN-KEY-DCC-ICM.
           EXIT.
       
       KEY-OPE-ICM SECTION.
       INI-KEY-OPE-ICM.
      *<<<< INI_KEY_OPE_ICM
      *>>>>
      *<<<< FIN_KEY_OPE_ICM
      *>>>>
       FIN-KEY-OPE-ICM.
           EXIT.
       
       KEY-RCO-ICM SECTION.
       INI-KEY-RCO-ICM.
       FIN-KEY-RCO-ICM.
           EXIT.
       
       KEY-RCD-ICM SECTION.
       INI-KEY-RCD-ICM.
       FIN-KEY-RCD-ICM.
           EXIT.
       
       KEY-PER-ICM SECTION.
       INI-KEY-PER-ICM.
       FIN-KEY-PER-ICM.
           EXIT.
       
       SCR-CLRA-ICM SECTION.
       INI-SCR-CLRA-ICM.
           PERFORM CLR-KEY-ICM.
           PERFORM CLR-FLD-ICM.
       FIN-SCR-CLRA-ICM.
           EXIT.
       
       CLR-KEY-ICM SECTION.
       INI-CLR-KEY-ICM.
           MOVE SPACES TO DCC-CAI-ICLI IN ICM-FLD.
           MOVE SPACES TO DCC-IIC-ICLI IN ICM-FLD.
           MOVE SPACES TO FRM-GLS-NOMC IN ICM-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN ICM-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN ICM-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN ICM-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN ICM-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-KEY-ICM.
           EXIT.
       
       CLR-FLD-ICM SECTION.
       INI-CLR-FLD-ICM.
           MOVE SPACES TO FRM-IND-MCLI IN ICM-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FRM-NUM-ICLP IN ICM-FLD.
           MOVE SPACES TO FRM-VRF-ICLP IN ICM-FLD.
           MOVE SPACES TO FRM-IND-ICLP IN ICM-FLD.
           MOVE SPACES TO FRM-GLS-ICLP IN ICM-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FRM-GLS-NCLP IN ICM-FLD.
           MOVE SPACES TO FRM-GLS-OFOP IN ICM-FLD.
           MOVE SPACES TO FRM-GLS-IANT IN ICM-FLD.
           MOVE SPACES TO FRM-GLS-TCOM IN ICM-FLD.
           MOVE SPACES TO FRM-GLS-EJOP IN ICM-FLD.
           MOVE SPACES TO FRM-GLS-MOTT IN ICM-FLD.
           PERFORM CLR-DBC-ICM.
           PERFORM CLR-DCC-ICM.
           PERFORM CLR-OPE-ICM.
           PERFORM CLR-RCO-ICM.
           PERFORM CLR-RCD-ICM.
           PERFORM CLR-PER-ICM.
       FIN-CLR-FLD-ICM.
           EXIT.
       
       CLR-DBC-ICM SECTION.
       INI-CLR-DBC-ICM.
           MOVE SPACES TO DBC-IND-TICL IN ICM-FLD.
       FIN-CLR-DBC-ICM.
           EXIT.
       
       CLR-DCC-ICM SECTION.
       INI-CLR-DCC-ICM.
       FIN-CLR-DCC-ICM.
           EXIT.
       
       CLR-OPE-ICM SECTION.
       INI-CLR-OPE-ICM.
      *<<<< INI_CLR_OPE_ICM
      *>>>>
           MOVE SPACES TO OPE-CAI-IOPE IN ICM-FLD.
           MOVE ZEROES TO OPE-IIC-IOPE IN ICM-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OPE-FEC-FIOP IN ICM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO OPE-COD-OFOP IN ICM-FLD.
           MOVE SPACES TO OPE-IND-MCLI IN ICM-FLD.
           MOVE SPACES TO OPE-COD-VCOP IN ICM-FLD.
           MOVE SPACES TO OPE-COD-TCOM IN ICM-FLD.
           MOVE SPACES TO OPE-CAI-ICAR IN ICM-FLD.
           MOVE SPACES TO OPE-IIC-ICAR IN ICM-FLD.
           MOVE SPACES TO OPE-COD-EJOP IN ICM-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO OPE-FEC-FTOP IN ICM-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO OPE-COD-MOTT IN ICM-FLD.
      *<<<< FIN_CLR_OPE_ICM
      *>>>>
       FIN-CLR-OPE-ICM.
           EXIT.
       
       CLR-RCO-ICM SECTION.
       INI-CLR-RCO-ICM.
           MOVE ZEROES TO RCO-NUM-DIRE IN ICM-FLD.
       FIN-CLR-RCO-ICM.
           EXIT.
       
       CLR-RCD-ICM SECTION.
       INI-CLR-RCD-ICM.
           MOVE SPACES TO RCD-GLS-DIRE IN ICM-FLD.
       FIN-CLR-RCD-ICM.
           EXIT.
       
       CLR-PER-ICM SECTION.
       INI-CLR-PER-ICM.
           MOVE SPACES TO PER-GLS-NOM1 IN ICM-FLD.
           MOVE SPACES TO PER-GLS-NOM2 IN ICM-FLD.
       FIN-CLR-PER-ICM.
           EXIT.
       
       FST-KEY-ICM SECTION.
       INI-FST-KEY-ICM.
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN ICM-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
       FIN-FST-KEY-ICM.
           EXIT.
       
       FST-FLD-ICM SECTION.
       INI-FST-FLD-ICM.
      *<<<< INI_FST_FLD_ICM
      ******************************************************************
      *DAD ini  23-MAR-1992
      *---- agregado por odj desde aqui (c)
           IF (SCR-CMND = 'MEJ')
               MOVE -1 TO OPE-COD-EJOP-LEN IN ICM-FLD
           ELSE
               MOVE -1 TO OPE-IIC-IOPE-LEN IN ICM-FLD.
      * ------- agregado por odj hasta aqui (c)
           GO TO FIN-FST-FLD-ICM.
      *DAD fin  23-MAR-1992
      ******************************************************************
      *>>>>
           MOVE -1 TO OPE-CAI-IOPE-LEN IN ICM-FLD.
      *<<<< FIN_FST_FLD_ICM
      *>>>>
       FIN-FST-FLD-ICM.
           EXIT.
       
       PRO-KEY-ICM SECTION.
       INI-PRO-KEY-ICM.
           MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-ATR IN ICM-FLD.
           PERFORM PRO-IKY-ICM.
           PERFORM PRO-AKY-ICM.
           PERFORM PRO-MKY-ICM.
       FIN-PRO-KEY-ICM.
           EXIT.
       
       PRO-IKY-ICM SECTION.
       INI-PRO-IKY-ICM.
      * IDC-INI --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
           MOVE FRM-CPIM-AEY TO DBC-NUM-ICLI-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO DBC-VRF-ICLI-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO DBC-IND-ICLI-ATR IN ICM-FLD.
           MOVE FRM-CPIM-AEY TO DBC-GLS-ICLI-ATR IN ICM-FLD.
      * IDC-FIN --> BMCHIBCI005.SRCAIU PRO ( KEY Y FLD )
       FIN-PRO-IKY-ICM.
           EXIT.
       
       PRO-MKY-ICM SECTION.
       INI-PRO-MKY-ICM.
       FIN-PRO-MKY-ICM.
           EXIT.
       
       PRO-AKY-ICM SECTION.
       INI-PRO-AKY-ICM.
           MOVE FRM-CPIM-AEY TO FRM-GLS-NOMC-ATR IN ICM-FLD.
       FIN-PRO-AKY-ICM.
           EXIT.
       
       UNP-KEY-ICM SECTION.
       INI-UNP-KEY-ICM.
           MOVE FRM-CPIM-UBY TO FRM-GLS-NOMC-ATR IN ICM-FLD.
           PERFORM UNP-IKY-ICM.
           PERFORM UNP-AKY-ICM.
           PERFORM UNP-MKY-ICM.
       FIN-UNP-KEY-ICM.
           EXIT.
       
       UNP-IKY-ICM SECTION.
       INI-UNP-IKY-ICM.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN ICM-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
       FIN-UNP-IKY-ICM.
           EXIT.
       
       UNP-MKY-ICM SECTION.
       INI-UNP-MKY-ICM.
       FIN-UNP-MKY-ICM.
           EXIT.
       
       UNP-AKY-ICM SECTION.
       INI-UNP-AKY-ICM.
           MOVE FRM-CPIM-UBY TO FRM-GLS-NOMC-ATR.
       FIN-UNP-AKY-ICM.
           EXIT.
       
       UNP-FLD-ICM SECTION.
       INI-UNP-FLD-ICM.
           MOVE FRM-CPIM-UBY TO FRM-IND-MCLI-ATR IN ICM-FLD.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FRM-NUM-ICLP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VRF-ICLP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-IND-ICLP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO FRM-GLS-ICLP-ATR IN ICM-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           PERFORM UNP-DBC-ICM.
           PERFORM UNP-DCC-ICM.
           PERFORM UNP-OPE-ICM.
           PERFORM UNP-RCO-ICM.
           PERFORM UNP-RCD-ICM.
           PERFORM UNP-PER-ICM.
       FIN-UNP-FLD-ICM.
           EXIT.
       
       UNP-DBC-ICM SECTION.
       INI-UNP-DBC-ICM.
       FIN-UNP-DBC-ICM.
           EXIT.
       
       UNP-DCC-ICM SECTION.
       INI-UNP-DCC-ICM.
       FIN-UNP-DCC-ICM.
           EXIT.
       
       UNP-OPE-ICM SECTION.
       INI-UNP-OPE-ICM.
      *<<<< INI_UNP_OPE_ICM
      *>>>>
           MOVE FRM-CPIM-UBY TO OPE-CAI-IOPE-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO OPE-IIC-IOPE-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO OPE-FEC-FIOP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO OPE-COD-OFOP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO OPE-COD-TCOM-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO OPE-CAI-ICAR-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO OPE-IIC-ICAR-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO OPE-COD-EJOP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO OPE-FEC-FTOP-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO OPE-COD-MOTT-ATR IN ICM-FLD.
      *<<<< FIN_UNP_OPE_ICM
      *>>>>
       FIN-UNP-OPE-ICM.
           EXIT.
       
       UNP-RCO-ICM SECTION.
       INI-UNP-RCO-ICM.
           MOVE FRM-CPIM-UBY TO RCO-NUM-DIRE-ATR IN ICM-FLD.
       FIN-UNP-RCO-ICM.
           EXIT.
       
       UNP-RCD-ICM SECTION.
       INI-UNP-RCD-ICM.
       FIN-UNP-RCD-ICM.
           EXIT.
       
       UNP-PER-ICM SECTION.
       INI-UNP-PER-ICM.
           MOVE FRM-CPIM-UBY TO PER-GLS-NOM1-ATR IN ICM-FLD.
           MOVE FRM-CPIM-UBY TO PER-GLS-NOM2-ATR IN ICM-FLD.
       FIN-UNP-PER-ICM.
           EXIT.
       
       VAL-KEY-ICM SECTION.
       INI-VAL-KEY-ICM.
           PERFORM VAL-IKY-ICM.
           PERFORM VAL-MKY-ICM.
           PERFORM VAL-AKY-ICM.
       FIN-VAL-KEY-ICM.
           EXIT.
       
       VAL-IKY-ICM SECTION.
       INI-VAL-IKY-ICM.
           PERFORM VAL-DCC-CAI-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCC-CAI-ICLI-LEN IN ICM-FLD
                GO TO FIN-VAL-IKY-ICM.
           PERFORM VAL-DCC-IIC-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCC-IIC-ICLI-LEN IN ICM-FLD
                GO TO FIN-VAL-IKY-ICM.
      * VRF-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * VRF-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
      * IDC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-DBC-IND-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-IND-ICLI-LEN IN ICM-FLD
                GO TO FIN-VAL-IKY-ICM.
           PERFORM VAL-DBC-GLS-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-GLS-ICLI-LEN IN ICM-FLD
                GO TO FIN-VAL-IKY-ICM.
           PERFORM VAL-DBC-NUM-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-NUM-ICLI-LEN IN ICM-FLD
                GO TO FIN-VAL-IKY-ICM.
           PERFORM VAL-DBC-VRF-ICLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                DBC-VRF-ICLI-LEN IN ICM-FLD
                GO TO FIN-VAL-IKY-ICM.
      * IDC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-IKY-ICM.
           EXIT.
       
       VAL-MKY-ICM SECTION.
       INI-VAL-MKY-ICM.
       FIN-VAL-MKY-ICM.
           EXIT.
       
       VAL-AKY-ICM SECTION.
       INI-VAL-AKY-ICM.
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMC-LEN IN ICM-FLD
                GO TO FIN-VAL-AKY-ICM.
       FIN-VAL-AKY-ICM.
           EXIT.
       
       VAL-DCC-CAI-ICLI SECTION.
       INI-VAL-DCC-CAI-ICLI.
      *<<<< DCC_CAI_ICLI
      *>>>>
       FIN-VAL-DCC-CAI-ICLI.
           EXIT.
       
       VAL-DCC-IIC-ICLI SECTION.
       INI-VAL-DCC-IIC-ICLI.
      *<<<< DCC_IIC_ICLI
      *>>>>
       FIN-VAL-DCC-IIC-ICLI.
           EXIT.
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
           IF FRM-GLS-NOMC IN ICM-FLD NOT > SPACES
              MOVE SPACES TO FRM-GLS-NOMC IN ICM-FLD.
      *<<<< FRM_GLS_NOMC
      *>>>>
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
      * VRF-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * VRF-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
      * IDC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION

       VAL-DBC-NUM-ICLI SECTION.
       INI-VAL-DBC-NUM-ICLI.
      *<<<< DBC_NUM_ICLI
      *>>>>
       FIN-VAL-DBC-NUM-ICLI.
           EXIT.

       VAL-DBC-VRF-ICLI SECTION.
       INI-VAL-DBC-VRF-ICLI.
           IF DBC-VRF-ICLI IN ICM-FLD NOT > SPACES
              MOVE SPACES TO DBC-VRF-ICLI IN ICM-FLD.
      *VAL-RUT Valida Rut para campo IDC
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN ICM-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN ICM-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *<<<< DBC_VRF_ICLI
      *>>>>
       FIN-VAL-DBC-VRF-ICLI.
           EXIT.
       VAL-DBC-IND-ICLI SECTION.
       INI-VAL-DBC-IND-ICLI.
           IF DBC-IND-ICLI IN ICM-FLD NOT > SPACES
              MOVE SPACES TO DBC-IND-ICLI IN ICM-FLD.
      *VAL-IDC Valida identificador
           MOVE DBC-IND-ICLI IN ICM-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN ICM-FLD.
      *<<<< DBC_IND_ICLI
      *>>>>
       FIN-VAL-DBC-IND-ICLI.
           EXIT.

       VAL-DBC-GLS-ICLI SECTION.
       INI-VAL-DBC-GLS-ICLI.
           IF DBC-GLS-ICLI IN ICM-FLD NOT > IDC-INIC-GLS 
              MOVE IDC-INIC-GLS TO DBC-GLS-ICLI IN ICM-FLD.
      *VAL-GLS para IDC valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN ICM-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN ICM-FLD.
      *<<<< DBC_GLS_ICLI
      *>>>>
       FIN-VAL-DBC-GLS-ICLI.
           EXIT.

      * IDC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CON-KEY-ICM SECTION.
       INI-VAL-CON-KEY-ICM.
      *<<<< INI_VAL_CON_KEY_ICM
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-ICM.
      *>>>>
           IF     DCC-CAI-ICLI IN ICM-FLD NOT > SPACES 
              AND DCC-IIC-ICLI IN ICM-FLD NOT > SPACES 
              AND FRM-GLS-NOMC IN ICM-FLD NOT > SPACES 
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
              AND DBC-NUM-ICLI IN ICM-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN ICM-FLD NOT > SPACES
              AND DBC-IND-ICLI IN ICM-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN ICM-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
                PERFORM ERR-KEY
                PERFORM FST-KEY-ICM.
      *<<<< FIN_VAL_CON_KEY_ICM
      *>>>>
       FIN-VAL-CON-KEY-ICM.
           EXIT.
       
       VAL-CON-IKY-ICM SECTION.
       INI-VAL-CON-IKY-ICM.
           IF     DCC-CAI-ICLI IN ICM-FLD NOT > SPACES 
              AND DCC-IIC-ICLI IN ICM-FLD NOT > SPACES 
      * IDC-INI --> BMCHIBCI009.SRCAIU VAL-CON
              AND DBC-NUM-ICLI IN ICM-FLD NOT > ZEROES
              AND DBC-VRF-ICLI IN ICM-FLD NOT > SPACES
              AND DBC-IND-ICLI IN ICM-FLD NOT > SPACES
              AND DBC-GLS-ICLI IN ICM-FLD NOT > IDC-INIC-GLS
      * IDC-FIN --> BMCHIBCI009.SRCAIU VAL-CON
                PERFORM ERR-KEY
                PERFORM FST-KEY-ICM.
       FIN-VAL-CON-IKY-ICM.
           EXIT.
       
       VAL-NUM-KEY-ICM SECTION.
       INI-VAL-NUM-KEY-ICM.
           PERFORM VAL-NUM-IKY-ICM.
           PERFORM VAL-NUM-MKY-ICM.
           PERFORM VAL-NUM-AKY-ICM.
       FIN-VAL-NUM-KEY-ICM.
           EXIT.
       
       VAL-NUM-IKY-ICM SECTION.
       INI-VAL-NUM-IKY-ICM.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN ICM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN ICM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN ICM-FLD
                GO TO FIN-VAL-NUM-IKY-ICM.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-IKY-ICM.
           EXIT.
       
       VAL-NUM-MKY-ICM SECTION.
       INI-VAL-NUM-MKY-ICM.
       FIN-VAL-NUM-MKY-ICM.
           EXIT.
       
       VAL-NUM-AKY-ICM SECTION.
       INI-VAL-NUM-AKY-ICM.
       FIN-VAL-NUM-AKY-ICM.
           EXIT.
       
       VAL-NUM-FLD-ICM SECTION.
       INI-VAL-NUM-FLD-ICM.
       VAL-NUM-OPE-IIC-IOPE.
           MOVE OPE-IIC-IOPE-ALF IN ICM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO OPE-IIC-IOPE IN ICM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO OPE-IIC-IOPE-LEN IN ICM-FLD
                GO TO FIN-VAL-NUM-FLD-ICM.
       VAL-NUM-RCO-NUM-DIRE.
           MOVE RCO-NUM-DIRE-ALF IN ICM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO RCO-NUM-DIRE IN ICM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO RCO-NUM-DIRE-LEN IN ICM-FLD
                GO TO FIN-VAL-NUM-FLD-ICM.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FRM-NUM-ICLP.
           MOVE FRM-NUM-ICLP-ALF IN ICM-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-NUM-ICLP IN ICM-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-NUM-ICLP-LEN IN ICM-FLD
                GO TO FIN-VAL-NUM-FLD-ICM.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-FLD-ICM.
           EXIT.
       
       EDT-KEY-ICM SECTION.
       INI-EDT-KEY-ICM.
           PERFORM EDT-IKY-ICM.
           PERFORM EDT-MKY-ICM.
           PERFORM EDT-AKY-ICM.
       FIN-EDT-KEY-ICM.
           EXIT.
       
       EDT-IKY-ICM SECTION.
       INI-EDT-IKY-ICM.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN ICM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN ICM-FLD
                GO TO FIN-EDT-IKY-ICM.
           MOVE DBC-NUM-ICLI IN ICM-FLD TO
                DBC-NUM-ICLI-EDT IN ICM-EDT.
           MOVE DBC-NUM-ICLI-EDT IN ICM-EDT TO
                DBC-NUM-ICLI-ALF IN ICM-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-IKY-ICM.
           EXIT.
       
       EDT-MKY-ICM SECTION.
       INI-EDT-MKY-ICM.
       FIN-EDT-MKY-ICM.
           EXIT.
       
       EDT-AKY-ICM SECTION.
       INI-EDT-AKY-ICM.
       FIN-EDT-AKY-ICM.
           EXIT.
       
       EDT-FLD-ICM SECTION.
       INI-EDT-FLD-ICM.
           IF OPE-IIC-IOPE-LEN IN ICM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO OPE-IIC-IOPE-LEN IN ICM-FLD
                GO TO FIN-EDT-FLD-ICM.
           MOVE OPE-IIC-IOPE IN ICM-FLD TO OPE-IIC-IOPE-EDT IN ICM-EDT.
           MOVE OPE-IIC-IOPE-EDT IN ICM-EDT TO 
                OPE-IIC-IOPE-ALF IN ICM-FLD.
           IF RCO-NUM-DIRE-LEN IN ICM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO RCO-NUM-DIRE-LEN IN ICM-FLD
                GO TO FIN-EDT-FLD-ICM.
           MOVE RCO-NUM-DIRE IN ICM-FLD TO RCO-NUM-DIRE-EDT IN ICM-EDT.
           MOVE RCO-NUM-DIRE-EDT IN ICM-EDT TO 
                RCO-NUM-DIRE-ALF IN ICM-FLD.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FRM-NUM-ICLP-LEN IN ICM-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-NUM-ICLP-LEN IN ICM-FLD
                GO TO FIN-EDT-FLD-ICM.
           MOVE FRM-NUM-ICLP IN ICM-FLD TO
                FRM-NUM-ICLP-EDT IN ICM-EDT.
           MOVE FRM-NUM-ICLP-EDT IN ICM-EDT TO
                FRM-NUM-ICLP-ALF IN ICM-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-FLD-ICM.
           EXIT.
      *<<<< EOF_BQ
      *>>>>
      *<<<< EOF
       VAL-SUC-CCTA SECTION.
       INI-VAL-SUC-CCTA.
      *DAD ini  05-JUN-1992 ( Codigo Incorporado a peticion RM reemplaza c/'*' )
           MOVE SPACES TO MSG-COD-MENS.
           MOVE OPE-IIC-IOPE IN ICM-FLD TO OPE-IIC-IOPE IN OPE.
           MOVE 'TAB'               TO TAB-COD-SIST  FIO-SIST.
           MOVE 'ROF'               TO TAB-COD-TTAB IN TAB.
           MOVE OPE-IIC-IOPE IN OPE TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS
               IF TAB-IND-VIGE IN TAB = 'N'
                   MOVE 'GNS'        TO MSG-COD-SIST
                   MOVE 'COD    NVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
               ELSE
                   MOVE SPACES TO MSG-COD-MENS
                                  MSG-GLS-DESC
           ELSE
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'COD    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG.

           IF MSG-COD-MENS = 'COD    NEX' OR
              TAB-COD-TTAB IN TAB NOT = 'ROF'
               MOVE 'OPENERNGCCTE' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-VAL-SUC-CCTA.
           MOVE TAB-GLS-DATA IN TAB TO WSS-IDE-OFCT IN WSS-VARI.

           MOVE OPE-IIC-IOPE IN OPE TO NUM-NUME.
           MOVE NUM-ZERO-S          TO NUM-ZERO.
           MOVE NUM-SGNO-N          TO NUM-SGNO.
           MOVE 8                   TO NUM-NENT.
           MOVE 0                   TO NUM-NDCM.
           CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.         
           IF NOT NUM-STAT-OKS
               MOVE 'OPEIICNONUM' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-VAL-SUC-CCTA.
           MOVE NUM-PENT            TO WSS-NRO-CCTA IN WSS-VARI.

           MOVE TAB-COD-CTAB IN TAB TO WSS-RNG-CCTA IN WSS-VARI.
           MOVE WSS-RNG-CCTA IN WSS-VARI TO NUM-NUME.
           MOVE NUM-ZERO-S               TO NUM-ZERO.
           MOVE NUM-SGNO-N               TO NUM-SGNO.
           MOVE 8                        TO NUM-NENT.
           MOVE 0                        TO NUM-NDCM.
           CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.         
           IF NOT NUM-STAT-OKS
               MOVE 'RNGINFNONUM' TO MSG-COD-MENS
               MOVE FRM-SUAR-MAL  TO FRM-SUAR
               GO TO FIN-VAL-SUC-CCTA.
           MOVE NUM-PENT TO WSS-NRO-RSUP IN WSS-VARI.

      *RJZ INI 27/01/94                                            
      *    IF OPE-COD-SOPE IN OPE = '99'                                
           IF OPE-COD-OOPE IN OPE NOT < '982'                           
      *RJZ INI 27/01/94                                             
               IF WSS-NRO-CCTA IN WSS-VARI NOT > WSS-NRO-RSUP AND
                  WSS-COD-OFIC IN WSS-VARI = OPE-COD-OFOP IN ICM-FLD AND
                  WSS-TIP-CCTA IN WSS-VARI = '02'
                     MOVE FRM-SUAR-OKS TO FRM-SUAR
                     GO TO FIN-VAL-SUC-CCTA
               ELSE
                   MOVE 'OPENORNGCCTE' TO MSG-COD-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR
                   GO TO FIN-VAL-SUC-CCTA.

           IF WSS-NRO-CCTA IN WSS-VARI NOT > WSS-NRO-RSUP AND
              WSS-COD-OFIC IN WSS-VARI =  OPE-COD-OFOP IN ICM-FLD AND
              WSS-TIP-CCTA IN WSS-VARI = '01'
               MOVE FRM-SUAR-OKS TO FRM-SUAR
               GO TO FIN-VAL-SUC-CCTA
           ELSE
               MOVE 'OPENORNGCCTE' TO MSG-COD-MENS
               MOVE FRM-SUAR-OKS   TO FRM-SUAR
               GO TO FIN-VAL-SUC-CCTA.
      ******************************************************************
      *     MOVE SPACES TO MSG-COD-MENS.
      *     MOVE OPE-IIC-IOPE IN ICM-FLD TO OPE-IIC-IOPE IN OPE.
      *     MOVE 'TAB'                   TO TAB-COD-SIST  FIO-SIST.
      *     MOVE 'OFI'                   TO TAB-COD-TTAB IN TAB.
      *     MOVE OPE-COD-OFOP IN ICM-FLD TO TAB-COD-CTAB IN TAB.
      *     PERFORM VAL-COD.
      *     IF MSG-COD-MENS = 'COD    NEX'
      *         MOVE 'OPENERNGCCTE' TO MSG-COD-MENS
      *         MOVE FRM-SUAR-MAL   TO FRM-SUAR
      *         GO TO FIN-VAL-SUC-CCTA.
      *     MOVE OPE-IIC-IOPE IN OPE TO NUM-NUME.
      *     MOVE NUM-ZERO-S          TO NUM-ZERO.
      *     MOVE NUM-SGNO-N          TO NUM-SGNO.
      *     MOVE 8                   TO NUM-NENT.
      *     MOVE 0                   TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.        
      *     IF NOT NUM-STAT-OKS
      *         MOVE 'OPEIICNONUM' TO MSG-COD-MENS
      *         MOVE FRM-SUAR-MAL  TO FRM-SUAR
      *         GO TO FIN-VAL-SUC-CCTA.
      *     MOVE NUM-PENT     TO WSS-NRO-CCTA IN WSS-VARI.
      *     MOVE TAB-GLS-DATA TO WSS-RNG-CCTA IN WSS-VARI.
      *     MOVE WSS-NUM-RINF IN WSS-VARI TO NUM-NUME.
      *     MOVE NUM-ZERO-S               TO NUM-ZERO.
      *     MOVE NUM-SGNO-N               TO NUM-SGNO.
      *     MOVE 8                        TO NUM-NENT.
      *     MOVE 0                        TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.        
      *     IF NOT NUM-STAT-OKS
      *         MOVE 'RNGINFNONUM' TO MSG-COD-MENS
      *         MOVE FRM-SUAR-MAL  TO FRM-SUAR
      *         GO TO FIN-VAL-SUC-CCTA.
      *     MOVE NUM-PENT TO WSS-NRO-RINF IN WSS-VARI.
      *     MOVE WSS-NUM-RINI IN WSS-VARI TO NUM-NUME.
      *     MOVE NUM-ZERO-S               TO NUM-ZERO.
      *     MOVE NUM-SGNO-N               TO NUM-SGNO.
      *     MOVE 8                        TO NUM-NENT.
      *     MOVE 0                        TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.        
      *     IF NOT NUM-STAT-OKS
      *         MOVE 'RNGINFNONUM' TO MSG-COD-MENS
      *         MOVE FRM-SUAR-MAL  TO FRM-SUAR
      *         GO TO FIN-VAL-SUC-CCTA.
      *     MOVE NUM-PENT TO WSS-NRO-RINI IN WSS-VARI.
      *     MOVE WSS-NUM-RSUP IN WSS-VARI TO NUM-NUME.
      *     MOVE NUM-ZERO-S               TO NUM-ZERO.
      *     MOVE NUM-SGNO-N               TO NUM-SGNO.
      *     MOVE 8                        TO NUM-NENT.
      *     MOVE 0                        TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.        
      *     IF NOT NUM-STAT-OKS
      *         MOVE 'RNGSUPNONUM' TO MSG-COD-MENS
      *         MOVE FRM-SUAR-MAL  TO FRM-SUAR
      *         GO TO FIN-VAL-SUC-CCTA.
      *     MOVE NUM-PENT TO WSS-NRO-RSUP IN WSS-VARI.
      *     MOVE WSS-NUM-RSUI IN WSS-VARI TO NUM-NUME.
      *     MOVE NUM-ZERO-S               TO NUM-ZERO.
      *     MOVE NUM-SGNO-N               TO NUM-SGNO.
      *     MOVE 8                        TO NUM-NENT.
      *     MOVE 0                        TO NUM-NDCM.
      *     CALL 'GNSPKNUM' USING DFHEIBLK DFHCOMMAREA NUM-VARI.        
      *     IF NOT NUM-STAT-OKS
      *         MOVE 'RNGSUPNONUM' TO MSG-COD-MENS
      *         MOVE FRM-SUAR-MAL  TO FRM-SUAR
      *         GO TO FIN-VAL-SUC-CCTA.
      *     MOVE NUM-PENT TO WSS-NRO-RSUI IN WSS-VARI.
      *     IF OPE-COD-SOPE IN OPE = '99'
      *         IF ( WSS-NRO-CCTA IN WSS-VARI NOT < WSS-NRO-RINF AND
      *              WSS-NRO-CCTA IN WSS-VARI NOT > WSS-NRO-RSUP ) OR
      *            ( WSS-NRO-RINF IN WSS-VARI = ZEROES AND
      *              WSS-NRO-RSUP IN WSS-VARI = ZEROES )
      *               MOVE FRM-SUAR-OKS TO FRM-SUAR
      *               GO TO FIN-VAL-SUC-CCTA
      *         ELSE
      *             MOVE 'OPENORNGCCTE' TO MSG-COD-MENS
      *             MOVE FRM-SUAR-MAL   TO FRM-SUAR
      *             GO TO FIN-VAL-SUC-CCTA.
      *     IF ( WSS-NRO-CCTA IN WSS-VARI NOT < WSS-NRO-RINI AND
      *          WSS-NRO-CCTA IN WSS-VARI NOT > WSS-NRO-RSUI ) OR
      *        ( WSS-NRO-RINI IN WSS-VARI = ZEROES AND
      *          WSS-NRO-RSUI IN WSS-VARI = ZEROES )
      *           MOVE FRM-SUAR-OKS TO FRM-SUAR
      *           GO TO FIN-VAL-SUC-CCTA
      *     ELSE
      *         MOVE 'OPENORNGCCTE' TO MSG-COD-MENS
      *         MOVE FRM-SUAR-OKS   TO FRM-SUAR
      *         GO TO FIN-VAL-SUC-CCTA.
      *DAD fin  05-JUN-1992
       FIN-VAL-SUC-CCTA.
           EXIT.
      *>>>>
      *<<<< EOF_IBM
      *>>>>
