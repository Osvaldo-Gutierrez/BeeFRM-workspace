      *
      * SGCBUEFE
      * Version 3.0.1 Nov-2005
      * 08-May-19 11:40 AM
      *
       SET-TAG-SGCBUEFE SECTION.
       INI-SET-TAG-SGCBUEFE.
           MOVE
           '<IDNMOD NOM=$SGCBUEFE$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$08-May-19 11:40 AM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-SGCBUEFE.
           EXIT.
           
       RET-ALL-EFE SECTION.
       INI-RET-ALL-EFE.
           PERFORM KEY-ALL-EFE.
           PERFORM RET-DBC-EFE.
           PERFORM RET-EFE-EFE.
           PERFORM RET-DCC-EFE.
       FIN-RET-ALL-EFE.
           EXIT.
       
       RET-DBC-EFE SECTION.
       INI-RET-DBC-EFE.
       FIN-RET-DBC-EFE.
           EXIT.
       
       RET-EFE-EFE SECTION.
       INI-RET-EFE-EFE.
           MOVE EFE-IND-ESBL IN EFE-FLD TO EFE-IND-ESBL IN EFE.
           MOVE EFE-COD-VCEF IN EFE-FLD TO EFE-COD-VCEF IN EFE.
           MOVE EFE-VAL-ACIR IN EFE-FLD TO EFE-VAL-ACIR IN EFE.
           MOVE EFE-VAL-PCIR IN EFE-FLD TO EFE-VAL-PCIR IN EFE.
           MOVE EFE-VAL-AFIJ IN EFE-FLD TO EFE-VAL-AFIJ IN EFE.
           MOVE EFE-VAL-PLPZ IN EFE-FLD TO EFE-VAL-PLPZ IN EFE.
           MOVE EFE-VAL-OACT IN EFE-FLD TO EFE-VAL-OACT IN EFE.
           MOVE EFE-SGV-PATR IN EFE-FLD TO EFE-SGV-PATR IN EFE.
           MOVE EFE-SGV-UTIL IN EFE-FLD TO EFE-SGV-UTIL IN EFE.
           MOVE EFE-VAL-AVAL IN EFE-FLD TO EFE-VAL-AVAL IN EFE.
           MOVE EFE-SGV-LACI IN EFE-FLD TO EFE-SGV-LACI IN EFE.
           MOVE EFE-SGV-VENE IN EFE-FLD TO EFE-SGV-VENE IN EFE.
           MOVE EFE-VAL-VENP IN EFE-FLD TO EFE-VAL-VENP IN EFE.
           MOVE EFE-SGV-RESO IN EFE-FLD TO EFE-SGV-RESO IN EFE.
           MOVE EFE-SGV-GOBR IN EFE-FLD TO EFE-SGV-GOBR IN EFE.
       FIN-RET-EFE-EFE.
           EXIT.
       
       RET-DCC-EFE SECTION.
       INI-RET-DCC-EFE.
           MOVE DCC-COD-BDIR IN EFE-FLD TO DCC-COD-BDIR IN DCC.
       FIN-RET-DCC-EFE.
           EXIT.
       
       KEY-ALL-EFE SECTION.
       INI-KEY-ALL-EFE.
           PERFORM KEY-DBC-EFE.
           PERFORM KEY-EFE-EFE.
           PERFORM KEY-DCC-EFE.
       FIN-KEY-ALL-EFE.
           EXIT.
       
       KEY-DBC-EFE SECTION.
       INI-KEY-DBC-EFE.
           MOVE DBC-GLS-NOMC IN EFE-FLD TO DBC-GLS-NOMC IN DBC.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN EFE-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN EFE-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN EFE-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN EFE-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-EFE.
           EXIT.
       
       KEY-EFE-EFE SECTION.
       INI-KEY-EFE-EFE.
           MOVE EFE-CAI-ICLI IN EFE-FLD TO EFE-CAI-ICLI IN EFE.
           MOVE EFE-IIC-ICLI IN EFE-FLD TO EFE-IIC-ICLI IN EFE.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE EFE-NUM-DEFE IN EFE-FLD TO EFE-NUM-DEFE IN EFE.
           MOVE EFE-NUM-MEFE IN EFE-FLD TO EFE-NUM-MEFE IN EFE.
           MOVE EFE-NUM-SEFE IN EFE-FLD TO EFE-NUM-SEFE IN EFE.
           MOVE EFE-NUM-AEFE IN EFE-FLD TO EFE-NUM-AEFE IN EFE.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-EFE-EFE.
           EXIT.
       
       KEY-DCC-EFE SECTION.
       INI-KEY-DCC-EFE.
       FIN-KEY-DCC-EFE.
           EXIT.
       
       SCR-CLRA-EFE SECTION.
       INI-SCR-CLRA-EFE.
           PERFORM CLR-KEY-EFE.
           PERFORM CLR-FLD-EFE.
       FIN-SCR-CLRA-EFE.
           EXIT.
       
       CLR-KEY-EFE SECTION.
       INI-CLR-KEY-EFE.
           MOVE SPACES TO DBC-GLS-NOMC IN EFE-FLD.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN EFE-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN EFE-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN EFE-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN EFE-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO EFE-CAI-ICLI IN EFE-FLD.
           MOVE SPACES TO EFE-IIC-ICLI IN EFE-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO EFE-FEC-FEFE IN EFE-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-KEY-EFE.
           EXIT.
       
       CLR-FLD-EFE SECTION.
       INI-CLR-FLD-EFE.
           MOVE SPACES TO FRM-GLS-VCEF IN EFE-FLD.
           MOVE ZEROES TO FRM-VAL-TACT IN EFE-FLD.
           MOVE ZEROES TO FRM-VAL-TPAS IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LCOR IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LEVE IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RVEN IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RPAT IN EFE-FLD.
           PERFORM CLR-DBC-EFE.
           PERFORM CLR-EFE-EFE.
           PERFORM CLR-DCC-EFE.
       FIN-CLR-FLD-EFE.
           EXIT.
       
       CLR-DBC-EFE SECTION.
       INI-CLR-DBC-EFE.
       FIN-CLR-DBC-EFE.
           EXIT.
       
       CLR-EFE-EFE SECTION.
       INI-CLR-EFE-EFE.
           MOVE SPACES TO EFE-IND-ESBL IN EFE-FLD.
           MOVE SPACES TO EFE-COD-VCEF IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-ACIR IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-PCIR IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-AFIJ IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-PLPZ IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-OACT IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-PATR IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-UTIL IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-AVAL IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-LACI IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-VENE IN EFE-FLD.
           MOVE ZEROES TO EFE-VAL-VENP IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-RESO IN EFE-FLD.
           MOVE ZEROES TO EFE-SGV-GOBR IN EFE-FLD.
       FIN-CLR-EFE-EFE.
           EXIT.
       
       CLR-DCC-EFE SECTION.
       INI-CLR-DCC-EFE.
           MOVE SPACES TO DCC-COD-BDIR IN EFE-FLD.
       FIN-CLR-DCC-EFE.
           EXIT.
       
       FST-KEY-EFE SECTION.
       INI-FST-KEY-EFE.
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN EFE-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
       FIN-FST-KEY-EFE.
           EXIT.
       
       FST-FLD-EFE SECTION.
       INI-FST-FLD-EFE.
           MOVE -1 TO EFE-IND-ESBL-LEN IN EFE-FLD.
       FIN-FST-FLD-EFE.
           EXIT.
       
       PRO-KEY-EFE SECTION.
       INI-PRO-KEY-EFE.
           PERFORM PRO-MKY-EFE.
       FIN-PRO-KEY-EFE.
           EXIT.
       
       PRO-MKY-EFE SECTION.
       INI-PRO-MKY-EFE.
       FIN-PRO-MKY-EFE.
           EXIT.
       
       PRO-FLD-EFE SECTION.
       INI-PRO-FLD-EFE.
           MOVE FRM-CPIM-AEY TO FRM-VAL-TACT-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO FRM-VAL-TPAS-ATR IN EFE-FLD.
           PERFORM PRO-DBC-EFE.
           PERFORM PRO-EFE-EFE.
           PERFORM PRO-DCC-EFE.
       FIN-PRO-FLD-EFE.
           EXIT.
       
       PRO-DBC-EFE SECTION.
       INI-PRO-DBC-EFE.
       FIN-PRO-DBC-EFE.
           EXIT.
       
       PRO-EFE-EFE SECTION.
       INI-PRO-EFE-EFE.
           MOVE FRM-CPIM-AEY TO EFE-IND-ESBL-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-COD-VCEF-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-VAL-ACIR-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-VAL-PCIR-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-VAL-AFIJ-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-VAL-PLPZ-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-VAL-OACT-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-SGV-PATR-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-SGV-UTIL-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-VAL-AVAL-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-SGV-LACI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-SGV-VENE-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-VAL-VENP-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-SGV-RESO-ATR IN EFE-FLD.
           MOVE FRM-CPIM-AEY TO EFE-SGV-GOBR-ATR IN EFE-FLD.
       FIN-PRO-EFE-EFE.
           EXIT.
       
       PRO-DCC-EFE SECTION.
       INI-PRO-DCC-EFE.
           MOVE FRM-CPIM-AEY TO DCC-COD-BDIR-ATR IN EFE-FLD.
       FIN-PRO-DCC-EFE.
           EXIT.
       
       UNP-KEY-EFE SECTION.
       INI-UNP-KEY-EFE.
           PERFORM UNP-IKY-EFE.
           PERFORM UNP-AKY-EFE.
           PERFORM UNP-MKY-EFE.
       FIN-UNP-KEY-EFE.
           EXIT.
       
       UNP-IKY-EFE SECTION.
       INI-UNP-IKY-EFE.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN EFE-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO EFE-FEC-FEFE-ATR IN EFE-FLD.
       FIN-UNP-IKY-EFE.
           EXIT.
       
       UNP-MKY-EFE SECTION.
       INI-UNP-MKY-EFE.
       FIN-UNP-MKY-EFE.
           EXIT.
       
       UNP-AKY-EFE SECTION.
       INI-UNP-AKY-EFE.
           MOVE FRM-CPIM-UBY TO DBC-GLS-NOMC-ATR.
       FIN-UNP-AKY-EFE.
           EXIT.
       
       UNP-FLD-EFE SECTION.
       INI-UNP-FLD-EFE.
           MOVE FRM-CPIM-UBY TO FRM-VAL-TACT-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO FRM-VAL-TPAS-ATR IN EFE-FLD.
           PERFORM UNP-DBC-EFE.
           PERFORM UNP-EFE-EFE.
           PERFORM UNP-DCC-EFE.
       FIN-UNP-FLD-EFE.
           EXIT.
       
       UNP-DBC-EFE SECTION.
       INI-UNP-DBC-EFE.
       FIN-UNP-DBC-EFE.
           EXIT.
       
       UNP-EFE-EFE SECTION.
       INI-UNP-EFE-EFE.
           MOVE FRM-CPIM-UBY TO EFE-IND-ESBL-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-COD-VCEF-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-ACIR-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-PCIR-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-AFIJ-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-PLPZ-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-OACT-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-PATR-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-UTIL-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-AVAL-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-LACI-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-VENE-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-VAL-VENP-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-RESO-ATR IN EFE-FLD.
           MOVE FRM-CPIM-UBY TO EFE-SGV-GOBR-ATR IN EFE-FLD.
       FIN-UNP-EFE-EFE.
           EXIT.
       
       UNP-DCC-EFE SECTION.
       INI-UNP-DCC-EFE.
           MOVE FRM-CPIM-UBY TO DCC-COD-BDIR-ATR IN EFE-FLD.
       FIN-UNP-DCC-EFE.
           EXIT.
       
       VAL-MKY-EFE SECTION.
       INI-VAL-MKY-EFE.
       FIN-VAL-MKY-EFE.
           EXIT.
       
       VAL-FLD-EFE SECTION.
       INI-VAL-FLD-EFE.
           PERFORM VAL-EFE-IND-ESBL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-IND-ESBL-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-COD-VCEF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-COD-VCEF-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-FRM-GLS-VCEF.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-VCEF-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-VAL-ACIR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-VAL-ACIR-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-VAL-PCIR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-VAL-PCIR-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-VAL-AFIJ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-VAL-AFIJ-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-VAL-PLPZ.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-VAL-PLPZ-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-VAL-OACT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-VAL-OACT-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-SGV-PATR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-SGV-PATR-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-DCC-COD-BDIR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO DCC-COD-BDIR-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-SGV-UTIL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-SGV-UTIL-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-FRM-VAL-TACT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-TACT-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-FRM-VAL-TPAS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-VAL-TPAS-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-FRM-SGV-LCOR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-SGV-LCOR-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-VAL-AVAL.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-VAL-AVAL-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-SGV-LACI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-SGV-LACI-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-SGV-VENE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-SGV-VENE-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-FRM-SGV-LEVE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-SGV-LEVE-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-VAL-VENP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-VAL-VENP-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-FRM-SGV-RVEN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-SGV-RVEN-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-SGV-RESO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-SGV-RESO-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-FRM-SGV-RPAT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-SGV-RPAT-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
           PERFORM VAL-EFE-SGV-GOBR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO EFE-SGV-GOBR-LEN IN EFE-FLD
                GO TO FIN-VAL-FLD-EFE.
       FIN-VAL-FLD-EFE.
           EXIT.
       
       VAL-EFE-IND-ESBL SECTION.
       INI-VAL-EFE-IND-ESBL.
           IF EFE-IND-ESBL IN EFE-FLD NOT > SPACES
              MOVE SPACES TO EFE-IND-ESBL IN EFE-FLD.
      *VAL-IND Valida miscelaneo de tabla
           MOVE 'SGC' TO MSC-COD-SIST.
           MOVE 'ESBL' TO MSC-COD-TMSC IN MSC.
           MOVE EFE-IND-ESBL IN EFE-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM VAL-IND.
       FIN-VAL-EFE-IND-ESBL.
           EXIT.
       
       VAL-EFE-COD-VCEF SECTION.
       INI-VAL-EFE-COD-VCEF.
           IF EFE-COD-VCEF IN EFE-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-EFE-COD-VCEF.
      *VAL-COD Valida codigo de tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR ' TO TAB-COD-TTAB IN TAB.
           MOVE EFE-COD-VCEF IN EFE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS = 'COD    NEX' OR
              EFE-COD-VCEF IN EFE-FLD NOT > SPACES
               MOVE SPACES TO FRM-GLS-VCEF IN EFE-FLD
           ELSE
               MOVE TAB-GLS-ABRV IN TAB TO
                    FRM-GLS-VCEF IN EFE-FLD.
       FIN-VAL-EFE-COD-VCEF.
           EXIT.
       
       VAL-FRM-GLS-VCEF SECTION.
       INI-VAL-FRM-GLS-VCEF.
       FIN-VAL-FRM-GLS-VCEF.
           EXIT.
       
       VAL-EFE-VAL-ACIR SECTION.
       INI-VAL-EFE-VAL-ACIR.
       FIN-VAL-EFE-VAL-ACIR.
           EXIT.
       
       VAL-EFE-VAL-PCIR SECTION.
       INI-VAL-EFE-VAL-PCIR.
       FIN-VAL-EFE-VAL-PCIR.
           EXIT.
       
       VAL-EFE-VAL-AFIJ SECTION.
       INI-VAL-EFE-VAL-AFIJ.
       FIN-VAL-EFE-VAL-AFIJ.
           EXIT.
       
       VAL-EFE-VAL-PLPZ SECTION.
       INI-VAL-EFE-VAL-PLPZ.
       FIN-VAL-EFE-VAL-PLPZ.
           EXIT.
       
       VAL-EFE-VAL-OACT SECTION.
       INI-VAL-EFE-VAL-OACT.
       FIN-VAL-EFE-VAL-OACT.
           EXIT.
       
       VAL-EFE-SGV-PATR SECTION.
       INI-VAL-EFE-SGV-PATR.
       FIN-VAL-EFE-SGV-PATR.
           EXIT.
       
       VAL-DCC-COD-BDIR SECTION.
       INI-VAL-DCC-COD-BDIR.
           IF DCC-COD-BDIR IN EFE-FLD NOT > SPACES
              MOVE SPACES TO DCC-COD-BDIR IN EFE-FLD.
      *<<<< DCC_COD_BDIR
      * RGD-INI 04-08-2009 "ORIGEN RENTA"
      *VAL-COD Valida codigo de tabla                                 
           IF SCR-COD-BDIR = DCC-COD-BDIR IN EFE-FLD AND
              DCC-COD-BDIR IN EFE-FLD NOT = SPACES
               GO TO FIN-VAL-DCC-COD-BDIR.                                   
           MOVE 'SGC'                   TO TAB-COD-SIST.
           MOVE 'BDR '                  TO TAB-COD-TTAB IN TAB.
           MOVE DCC-COD-BDIR IN EFE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
      * RGD-FIN 04-08-2009
      *>>>>
       FIN-VAL-DCC-COD-BDIR.
           EXIT.
       
       VAL-EFE-SGV-UTIL SECTION.
       INI-VAL-EFE-SGV-UTIL.
       FIN-VAL-EFE-SGV-UTIL.
           EXIT.
       
       VAL-FRM-VAL-TACT SECTION.
       INI-VAL-FRM-VAL-TACT.
       FIN-VAL-FRM-VAL-TACT.
           EXIT.
       
       VAL-FRM-VAL-TPAS SECTION.
       INI-VAL-FRM-VAL-TPAS.
       FIN-VAL-FRM-VAL-TPAS.
           EXIT.
       
       VAL-FRM-SGV-LCOR SECTION.
       INI-VAL-FRM-SGV-LCOR.
       FIN-VAL-FRM-SGV-LCOR.
           EXIT.
       
       VAL-EFE-VAL-AVAL SECTION.
       INI-VAL-EFE-VAL-AVAL.
       FIN-VAL-EFE-VAL-AVAL.
           EXIT.
       
       VAL-EFE-SGV-LACI SECTION.
       INI-VAL-EFE-SGV-LACI.
       FIN-VAL-EFE-SGV-LACI.
           EXIT.
       
       VAL-EFE-SGV-VENE SECTION.
       INI-VAL-EFE-SGV-VENE.
       FIN-VAL-EFE-SGV-VENE.
           EXIT.
       
       VAL-FRM-SGV-LEVE SECTION.
       INI-VAL-FRM-SGV-LEVE.
       FIN-VAL-FRM-SGV-LEVE.
           EXIT.
       
       VAL-EFE-VAL-VENP SECTION.
       INI-VAL-EFE-VAL-VENP.
       FIN-VAL-EFE-VAL-VENP.
           EXIT.
       
       VAL-FRM-SGV-RVEN SECTION.
       INI-VAL-FRM-SGV-RVEN.
       FIN-VAL-FRM-SGV-RVEN.
           EXIT.
       
       VAL-EFE-SGV-RESO SECTION.
       INI-VAL-EFE-SGV-RESO.
       FIN-VAL-EFE-SGV-RESO.
           EXIT.
       
       VAL-FRM-SGV-RPAT SECTION.
       INI-VAL-FRM-SGV-RPAT.
       FIN-VAL-FRM-SGV-RPAT.
           EXIT.
       
       VAL-EFE-SGV-GOBR SECTION.
       INI-VAL-EFE-SGV-GOBR.
       FIN-VAL-EFE-SGV-GOBR.
           EXIT.
       
       VAL-CON-FLD-EFE SECTION.
       INI-VAL-CON-FLD-EFE.
      *<<<< VAL_CON_FLD_EFE
           ADD EFE-VAL-ACIR IN EFE-FLD
               EFE-VAL-AFIJ IN EFE-FLD
               EFE-VAL-OACT IN EFE-FLD
               GIVING WSS-VAL-TACT.
           IF FRM-VAL-TACT IN EFE-FLD NOT = WSS-VAL-TACT
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTACTERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-EFE.
           ADD EFE-VAL-PCIR IN EFE-FLD
               EFE-VAL-PLPZ IN EFE-FLD
               EFE-SGV-PATR IN EFE-FLD
               EFE-SGV-UTIL IN EFE-FLD
               GIVING WSS-VAL-TPAS.
           IF FRM-VAL-TPAS IN EFE-FLD NOT = WSS-VAL-TPAS
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTPASERR' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-EFE.
           IF FRM-VAL-TPAS IN EFE-FLD NOT = FRM-VAL-TACT IN EFE-FLD 
               MOVE 'SGC' TO MSG-COD-SIST
               MOVE 'VALTPASTACTN' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-EFE.

           IF EFE-VAL-PCIR IN EFE-FLD > ZEROES
               DIVIDE EFE-VAL-ACIR IN EFE-FLD BY 
                      EFE-VAL-PCIR IN EFE-FLD
                      GIVING FRM-SGV-LCOR IN EFE-FLD ROUNDED
           ELSE
               IF EFE-VAL-ACIR IN EFE-FLD > ZEROES
                   MOVE 9999999,99 TO FRM-SGV-LCOR IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-LCOR IN EFE-FLD.


           ADD EFE-VAL-PCIR IN EFE-FLD
               EFE-VAL-PLPZ IN EFE-FLD
               GIVING WSS-VAL-PCPL IN WSS-VARI.
           ADD EFE-SGV-PATR IN EFE-FLD
               EFE-SGV-UTIL IN EFE-FLD
               GIVING WSS-SGV-PAUT IN WSS-VARI.
           IF WSS-SGV-PAUT IN WSS-VARI NOT = ZEROES
               DIVIDE WSS-VAL-PCPL IN WSS-VARI BY 
                      WSS-SGV-PAUT IN WSS-VARI 
                      GIVING FRM-SGV-LEVE IN EFE-FLD ROUNDED
           ELSE
               IF WSS-VAL-PCPL IN WSS-VARI > ZEROES
                   MOVE 9999999,99 TO FRM-SGV-LEVE IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-LEVE IN EFE-FLD.


           IF EFE-VAL-VENP IN EFE-FLD > ZEROES
               MULTIPLY EFE-SGV-UTIL IN EFE-FLD BY 100
                    GIVING WSS-SGV-PATR IN WSS-VARI
               DIVIDE WSS-SGV-PATR IN WSS-VARI BY 
                      EFE-VAL-VENP IN EFE-FLD
                      GIVING FRM-SGV-RVEN IN EFE-FLD ROUNDED
           ELSE
               IF EFE-SGV-UTIL IN EFE-FLD NOT = ZEROES
                   MOVE 9999999,99 TO FRM-SGV-RVEN IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-RVEN IN EFE-FLD.

           IF EFE-SGV-PATR IN EFE-FLD NOT =  ZEROES
               MULTIPLY EFE-SGV-UTIL IN EFE-FLD BY 100
                    GIVING WSS-SGV-PATR IN WSS-VARI
               DIVIDE WSS-SGV-PATR IN WSS-VARI BY 
                      EFE-SGV-PATR IN EFE-FLD 
                      GIVING FRM-SGV-RPAT IN EFE-FLD ROUNDED
           ELSE
               IF EFE-SGV-UTIL IN EFE-FLD NOT = ZEROES
                   MOVE 9999999,99 TO FRM-SGV-RPAT IN EFE-FLD
               ELSE
                   MOVE ZEROES TO FRM-SGV-RPAT IN EFE-FLD.
      *>>>>
       FIN-VAL-CON-FLD-EFE.
           EXIT.
       
       VAL-CON-EFE SECTION.
       INI-VAL-CON-EFE.
       FIN-VAL-CON-EFE.
           EXIT.
       
       VAL-NUM-KEY-EFE SECTION.
       INI-VAL-NUM-KEY-EFE.
           PERFORM VAL-NUM-IKY-EFE.
           PERFORM VAL-NUM-MKY-EFE.
           PERFORM VAL-NUM-AKY-EFE.
       FIN-VAL-NUM-KEY-EFE.
           EXIT.
       
       VAL-NUM-IKY-EFE SECTION.
       INI-VAL-NUM-IKY-EFE.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-IKY-EFE.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       FIN-VAL-NUM-IKY-EFE.
           EXIT.
       
       VAL-NUM-MKY-EFE SECTION.
       INI-VAL-NUM-MKY-EFE.
       FIN-VAL-NUM-MKY-EFE.
           EXIT.
       
       VAL-NUM-AKY-EFE SECTION.
       INI-VAL-NUM-AKY-EFE.
       FIN-VAL-NUM-AKY-EFE.
           EXIT.
       
       VAL-NUM-FLD-EFE SECTION.
       INI-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-ACIR.
           MOVE EFE-VAL-ACIR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-ACIR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-ACIR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-PCIR.
           MOVE EFE-VAL-PCIR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-PCIR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-PCIR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-AFIJ.
           MOVE EFE-VAL-AFIJ-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-AFIJ IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-AFIJ-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-PLPZ.
           MOVE EFE-VAL-PLPZ-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-PLPZ IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-PLPZ-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-OACT.
           MOVE EFE-VAL-OACT-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-OACT IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-OACT-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-PATR.
           MOVE EFE-SGV-PATR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-PATR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-PATR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-UTIL.
           MOVE EFE-SGV-UTIL-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-UTIL IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-UTIL-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-VAL-TACT.
           MOVE FRM-VAL-TACT-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-VAL-TACT IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-TACT-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-VAL-TPAS.
           MOVE FRM-VAL-TPAS-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FRM-VAL-TPAS IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-VAL-TPAS-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-SGV-LCOR.
           MOVE FRM-SGV-LCOR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-SGV-LCOR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-LCOR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-AVAL.
           MOVE EFE-VAL-AVAL-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-AVAL IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-AVAL-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-LACI.
           MOVE EFE-SGV-LACI-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO EFE-SGV-LACI IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-LACI-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-VENE.
           MOVE EFE-SGV-VENE-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-VENE IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-VENE-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-SGV-LEVE.
           MOVE FRM-SGV-LEVE-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-SGV-LEVE IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-LEVE-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-VAL-VENP.
           MOVE EFE-VAL-VENP-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 9 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO EFE-VAL-VENP IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-VAL-VENP-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-SGV-RVEN.
           MOVE FRM-SGV-RVEN-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-SGV-RVEN IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-RVEN-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-RESO.
           MOVE EFE-SGV-RESO-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-RESO IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-RESO-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-FRM-SGV-RPAT.
           MOVE FRM-SGV-RPAT-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 5 TO NUM-NENT.
           MOVE 2 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9V TO FRM-SGV-RPAT IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FRM-SGV-RPAT-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       VAL-NUM-EFE-SGV-GOBR.
           MOVE EFE-SGV-GOBR-ALF IN EFE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-S TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NS9N TO EFE-SGV-GOBR IN EFE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO EFE-SGV-GOBR-LEN IN EFE-FLD
                GO TO FIN-VAL-NUM-FLD-EFE.
       FIN-VAL-NUM-FLD-EFE.
           EXIT.
       
       EDT-KEY-EFE SECTION.
       INI-EDT-KEY-EFE.
           PERFORM EDT-IKY-EFE.
           PERFORM EDT-MKY-EFE.
           PERFORM EDT-AKY-EFE.
       FIN-EDT-KEY-EFE.
           EXIT.
       
       EDT-IKY-EFE SECTION.
       INI-EDT-IKY-EFE.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN EFE-FLD
                GO TO FIN-EDT-IKY-EFE.
           MOVE DBC-NUM-ICLI IN EFE-FLD TO
                DBC-NUM-ICLI-EDT IN EFE-EDT.
           MOVE DBC-NUM-ICLI-EDT IN EFE-EDT TO
                DBC-NUM-ICLI-ALF IN EFE-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
       FIN-EDT-IKY-EFE.
           EXIT.
       
       EDT-MKY-EFE SECTION.
       INI-EDT-MKY-EFE.
       FIN-EDT-MKY-EFE.
           EXIT.
       
       EDT-AKY-EFE SECTION.
       INI-EDT-AKY-EFE.
       FIN-EDT-AKY-EFE.
           EXIT.
       
       EDT-FLD-EFE SECTION.
       INI-EDT-FLD-EFE.
           IF EFE-VAL-ACIR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-ACIR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-ACIR IN EFE-FLD TO EFE-VAL-ACIR-EDT IN EFE-EDT.
           MOVE EFE-VAL-ACIR-EDT IN EFE-EDT TO 
                EFE-VAL-ACIR-ALF IN EFE-FLD.
           IF EFE-VAL-PCIR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-PCIR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-PCIR IN EFE-FLD TO EFE-VAL-PCIR-EDT IN EFE-EDT.
           MOVE EFE-VAL-PCIR-EDT IN EFE-EDT TO 
                EFE-VAL-PCIR-ALF IN EFE-FLD.
           IF EFE-VAL-AFIJ-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-AFIJ-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-AFIJ IN EFE-FLD TO EFE-VAL-AFIJ-EDT IN EFE-EDT.
           MOVE EFE-VAL-AFIJ-EDT IN EFE-EDT TO 
                EFE-VAL-AFIJ-ALF IN EFE-FLD.
           IF EFE-VAL-PLPZ-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-PLPZ-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-PLPZ IN EFE-FLD TO EFE-VAL-PLPZ-EDT IN EFE-EDT.
           MOVE EFE-VAL-PLPZ-EDT IN EFE-EDT TO 
                EFE-VAL-PLPZ-ALF IN EFE-FLD.
           IF EFE-VAL-OACT-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-OACT-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-OACT IN EFE-FLD TO EFE-VAL-OACT-EDT IN EFE-EDT.
           MOVE EFE-VAL-OACT-EDT IN EFE-EDT TO 
                EFE-VAL-OACT-ALF IN EFE-FLD.
           IF EFE-SGV-PATR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-PATR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-PATR IN EFE-FLD TO EFE-SGV-PATR-EDT IN EFE-EDT.
           MOVE EFE-SGV-PATR-EDT IN EFE-EDT TO 
                EFE-SGV-PATR-ALF IN EFE-FLD.
           IF EFE-SGV-UTIL-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-UTIL-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-UTIL IN EFE-FLD TO EFE-SGV-UTIL-EDT IN EFE-EDT.
           MOVE EFE-SGV-UTIL-EDT IN EFE-EDT TO 
                EFE-SGV-UTIL-ALF IN EFE-FLD.
           IF FRM-VAL-TACT-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-TACT-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-VAL-TACT IN EFE-FLD TO FRM-VAL-TACT-EDT IN EFE-EDT.
           MOVE FRM-VAL-TACT-EDT IN EFE-EDT TO 
                FRM-VAL-TACT-ALF IN EFE-FLD.
           IF FRM-VAL-TPAS-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-VAL-TPAS-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-VAL-TPAS IN EFE-FLD TO FRM-VAL-TPAS-EDT IN EFE-EDT.
           MOVE FRM-VAL-TPAS-EDT IN EFE-EDT TO 
                FRM-VAL-TPAS-ALF IN EFE-FLD.
           IF FRM-SGV-LCOR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-LCOR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-SGV-LCOR IN EFE-FLD TO FRM-SGV-LCOR-EDT IN EFE-EDT.
           MOVE FRM-SGV-LCOR-EDT IN EFE-EDT TO 
                FRM-SGV-LCOR-ALF IN EFE-FLD.
           IF EFE-VAL-AVAL-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-AVAL-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-AVAL IN EFE-FLD TO EFE-VAL-AVAL-EDT IN EFE-EDT.
           MOVE EFE-VAL-AVAL-EDT IN EFE-EDT TO 
                EFE-VAL-AVAL-ALF IN EFE-FLD.
           IF EFE-SGV-LACI-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-LACI-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-LACI IN EFE-FLD TO EFE-SGV-LACI-EDT IN EFE-EDT.
           MOVE EFE-SGV-LACI-EDT IN EFE-EDT TO 
                EFE-SGV-LACI-ALF IN EFE-FLD.
           IF EFE-SGV-VENE-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-VENE-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-VENE IN EFE-FLD TO EFE-SGV-VENE-EDT IN EFE-EDT.
           MOVE EFE-SGV-VENE-EDT IN EFE-EDT TO 
                EFE-SGV-VENE-ALF IN EFE-FLD.
           IF FRM-SGV-LEVE-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-LEVE-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-SGV-LEVE IN EFE-FLD TO FRM-SGV-LEVE-EDT IN EFE-EDT.
           MOVE FRM-SGV-LEVE-EDT IN EFE-EDT TO 
                FRM-SGV-LEVE-ALF IN EFE-FLD.
           IF EFE-VAL-VENP-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-VAL-VENP-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-VAL-VENP IN EFE-FLD TO EFE-VAL-VENP-EDT IN EFE-EDT.
           MOVE EFE-VAL-VENP-EDT IN EFE-EDT TO 
                EFE-VAL-VENP-ALF IN EFE-FLD.
           IF FRM-SGV-RVEN-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-RVEN-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-SGV-RVEN IN EFE-FLD TO FRM-SGV-RVEN-EDT IN EFE-EDT.
           MOVE FRM-SGV-RVEN-EDT IN EFE-EDT TO 
                FRM-SGV-RVEN-ALF IN EFE-FLD.
           IF EFE-SGV-RESO-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-RESO-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-RESO IN EFE-FLD TO EFE-SGV-RESO-EDT IN EFE-EDT.
           MOVE EFE-SGV-RESO-EDT IN EFE-EDT TO 
                EFE-SGV-RESO-ALF IN EFE-FLD.
           IF FRM-SGV-RPAT-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FRM-SGV-RPAT-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE FRM-SGV-RPAT IN EFE-FLD TO FRM-SGV-RPAT-EDT IN EFE-EDT.
           MOVE FRM-SGV-RPAT-EDT IN EFE-EDT TO 
                FRM-SGV-RPAT-ALF IN EFE-FLD.
           IF EFE-SGV-GOBR-LEN IN EFE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO EFE-SGV-GOBR-LEN IN EFE-FLD
                GO TO FIN-EDT-FLD-EFE.
           MOVE EFE-SGV-GOBR IN EFE-FLD TO EFE-SGV-GOBR-EDT IN EFE-EDT.
           MOVE EFE-SGV-GOBR-EDT IN EFE-EDT TO 
                EFE-SGV-GOBR-ALF IN EFE-FLD.
       FIN-EDT-FLD-EFE.
           EXIT.
      *<<<< EOF
       CLR-FRM-EFE SECTION.
       INI-CLR-FRM-EFE.
           MOVE ZEROES TO FRM-VAL-TACT IN EFE-FLD.
           MOVE ZEROES TO FRM-VAL-TPAS IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LCOR IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-LEVE IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RVEN IN EFE-FLD.
           MOVE ZEROES TO FRM-SGV-RPAT IN EFE-FLD.
       FIN-CLR-FRM-EFE.
           EXIT.
      *>>>>
