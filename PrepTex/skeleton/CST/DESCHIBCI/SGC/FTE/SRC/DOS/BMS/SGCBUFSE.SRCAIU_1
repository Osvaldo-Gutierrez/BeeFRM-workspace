      *
      * SGCBUFSE
      * Version 3.0.1 Nov-2005
      * 17-Jul-14 06:03 PM
      *
      *<<<< SETTAG
      **************************************************************
      *MANTENCION: CAMBIO FECHA HABIL
      *RESPONSABLE: AFRI
      *FECHA: NOV-2011.
      *ETIQUETA: *AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL
      *CAMBIOS: SE DEJA SIN VALIDACION DE DIA HABIL CAMPO
      *         FECHA DE SERVICIO
      **************************************************************
      *>>>>
       SET-TAG-SGCBUFSE SECTION.
       INI-SET-TAG-SGCBUFSE.
           MOVE
           '<IDNMOD NOM=$SGCBUFSE$ VSN=${VSNBU}$ VGM=$3.0.1$
      -    'GEN=$17-Jul-14 06:03 PM$ FNC=${FNCBU}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-SGCBUFSE.
           EXIT.
           
       RET-ALL-FSE SECTION.
       INI-RET-ALL-FSE.
           PERFORM KEY-ALL-FSE.
           PERFORM RET-DBC-FSE.
           PERFORM RET-FSE-FSE.
       FIN-RET-ALL-FSE.
           EXIT.
       
       RET-DBC-FSE SECTION.
       INI-RET-DBC-FSE.
       FIN-RET-DBC-FSE.
           EXIT.
       
       RET-FSE-FSE SECTION.
       INI-RET-FSE-FSE.
           MOVE FSE-GLS-APFS IN FSE-FLD TO FSE-GLS-APFS IN FSE.
           MOVE FSE-GLS-AMFS IN FSE-FLD TO FSE-GLS-AMFS IN FSE.
           MOVE FSE-GLS-NMFS IN FSE-FLD TO FSE-GLS-NMFS IN FSE.
           MOVE FSE-COD-PTZC IN FSE-FLD TO FSE-COD-PTZC IN FSE.
           MOVE FSE-COD-ORGN IN FSE-FLD TO FSE-COD-ORGN IN FSE.
           MOVE FSE-NUM-PORC IN FSE-FLD TO FSE-NUM-PORC IN FSE.
           MOVE FSE-COD-CRGO IN FSE-FLD TO FSE-COD-CRGO IN FSE.
      * FEC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE FSE-NUM-DSER IN FSE-FLD TO FSE-NUM-DSER IN FSE.
           MOVE FSE-NUM-MSER IN FSE-FLD TO FSE-NUM-MSER IN FSE.
           MOVE FSE-NUM-SSER IN FSE-FLD TO FSE-NUM-SSER IN FSE.
           MOVE FSE-NUM-ASER IN FSE-FLD TO FSE-NUM-ASER IN FSE.
      * FEC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-RET-FSE-FSE.
           EXIT.
       
       KEY-ALL-FSE SECTION.
       INI-KEY-ALL-FSE.
           PERFORM KEY-DBC-FSE.
           PERFORM KEY-FSE-FSE.
       FIN-KEY-ALL-FSE.
           EXIT.
       
       KEY-DBC-FSE SECTION.
       INI-KEY-DBC-FSE.
      * IDC-INI --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
           MOVE DBC-NUM-ICLI IN FSE-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE DBC-VRF-ICLI IN FSE-FLD TO DBC-VRF-ICLI IN DBC.
           MOVE DBC-IND-ICLI IN FSE-FLD TO DBC-IND-ICLI IN DBC.
           MOVE DBC-GLS-ICLI IN FSE-FLD TO DBC-GLS-ICLI IN DBC.
      * IDC-FIN --> BMCHIBCI002210.SRCAIU RET-ALL Y KEY-ALL
       FIN-KEY-DBC-FSE.
           EXIT.
       
       KEY-FSE-FSE SECTION.
       INI-KEY-FSE-FSE.
           MOVE FSE-CAI-IFOL IN FSE-FLD TO FSE-CAI-IFOL IN FSE.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO FSE-IIC-IFOL IN FSE.
           MOVE FSE-NUM-IFOL IN FSE-FLD TO FSE-NUM-IFOL IN FSE.
       FIN-KEY-FSE-FSE.
           EXIT.
       
       SCR-CLRA-FSE SECTION.
       INI-SCR-CLRA-FSE.
           PERFORM CLR-KEY-FSE.
           PERFORM CLR-FLD-FSE.
       FIN-SCR-CLRA-FSE.
           EXIT.
       
       CLR-KEY-FSE SECTION.
       INI-CLR-KEY-FSE.
      * IDC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO DBC-NUM-ICLI IN FSE-FLD.
           MOVE SPACES TO DBC-VRF-ICLI IN FSE-FLD.
           MOVE SPACES TO DBC-IND-ICLI IN FSE-FLD.
           MOVE SPACES TO DBC-GLS-ICLI IN FSE-FLD.
      * IDC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE SPACES TO FSE-CAI-IFOL IN FSE-FLD.
           MOVE ZEROES TO FSE-IIC-IFOL IN FSE-FLD.
           MOVE ZEROES TO FSE-NUM-IFOL IN FSE-FLD.
       FIN-CLR-KEY-FSE.
           EXIT.
       
       CLR-FLD-FSE SECTION.
       INI-CLR-FLD-FSE.
           MOVE SPACES TO FRM-GLS-NOMC IN FSE-FLD.
           MOVE SPACES TO FRM-GLS-PTZC IN FSE-FLD.
           MOVE SPACES TO FRM-GLS-ORGN IN FSE-FLD.
           MOVE SPACES TO FRM-GLS-CRGO IN FSE-FLD.
           PERFORM CLR-DBC-FSE.
           PERFORM CLR-FSE-FSE.
       FIN-CLR-FLD-FSE.
           EXIT.
       
       CLR-DBC-FSE SECTION.
       INI-CLR-DBC-FSE.
       FIN-CLR-DBC-FSE.
           EXIT.
       
       CLR-FSE-FSE SECTION.
       INI-CLR-FSE-FSE.
           MOVE SPACES TO FSE-GLS-APFS IN FSE-FLD.
           MOVE SPACES TO FSE-GLS-AMFS IN FSE-FLD.
           MOVE SPACES TO FSE-GLS-NMFS IN FSE-FLD.
           MOVE SPACES TO FSE-COD-PTZC IN FSE-FLD.
           MOVE SPACES TO FSE-COD-ORGN IN FSE-FLD.
           MOVE ZEROES TO FSE-NUM-PORC IN FSE-FLD.
           MOVE SPACES TO FSE-COD-CRGO IN FSE-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO FSE-FEC-FSER IN FSE-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
       FIN-CLR-FSE-FSE.
           EXIT.
       
       FST-KEY-FSE SECTION.
       INI-FST-KEY-FSE.
           MOVE FRM-POS-CURS TO DBC-NUM-ICLI-LEN IN FSE-FLD.
      * VRF-FIN --> BMCHIBCI004.SRCAIU ( FST-KEY Y FST-FLD )
       FIN-FST-KEY-FSE.
           EXIT.
       
       FST-FLD-FSE SECTION.
       INI-FST-FLD-FSE.
           MOVE -1 TO FSE-GLS-APFS-LEN IN FSE-FLD.
       FIN-FST-FLD-FSE.
           EXIT.
       
       PRO-KEY-FSE SECTION.
       INI-PRO-KEY-FSE.
           PERFORM PRO-MKY-FSE.
       FIN-PRO-KEY-FSE.
           EXIT.
       
       PRO-MKY-FSE SECTION.
       INI-PRO-MKY-FSE.
       FIN-PRO-MKY-FSE.
           EXIT.
       
       PRO-FLD-FSE SECTION.
       INI-PRO-FLD-FSE.
           PERFORM PRO-DBC-FSE.
           PERFORM PRO-FSE-FSE.
       FIN-PRO-FLD-FSE.
           EXIT.
       
       PRO-DBC-FSE SECTION.
       INI-PRO-DBC-FSE.
       FIN-PRO-DBC-FSE.
           EXIT.
       
       PRO-FSE-FSE SECTION.
       INI-PRO-FSE-FSE.
           MOVE FRM-CPIM-AEY TO FSE-GLS-APFS-ATR IN FSE-FLD.
           MOVE FRM-CPIM-AEY TO FSE-GLS-AMFS-ATR IN FSE-FLD.
           MOVE FRM-CPIM-AEY TO FSE-GLS-NMFS-ATR IN FSE-FLD.
           MOVE FRM-CPIM-AEY TO FSE-COD-PTZC-ATR IN FSE-FLD.
           MOVE FRM-CPIM-AEY TO FSE-COD-ORGN-ATR IN FSE-FLD.
           MOVE FRM-CPIM-AEY TO FSE-NUM-PORC-ATR IN FSE-FLD.
           MOVE FRM-CPIM-AEY TO FSE-COD-CRGO-ATR IN FSE-FLD.
           MOVE FRM-CPIM-AEY TO FSE-FEC-FSER-ATR IN FSE-FLD.
       FIN-PRO-FSE-FSE.
           EXIT.
       
       UNP-KEY-FSE SECTION.
       INI-UNP-KEY-FSE.
           PERFORM UNP-IKY-FSE.
           PERFORM UNP-AKY-FSE.
           PERFORM UNP-MKY-FSE.
       FIN-UNP-KEY-FSE.
           EXIT.
       
       UNP-IKY-FSE SECTION.
       INI-UNP-IKY-FSE.
      * IDC-INI --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO DBC-NUM-ICLI-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-VRF-ICLI-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-IND-ICLI-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO DBC-GLS-ICLI-ATR IN FSE-FLD.
      * IDC-FIN --> BMCHIBCI006.SRCAIU UNP ( KEY Y FLD )
           MOVE FRM-CPIM-UBY TO FSE-CAI-IFOL-ATR.
           MOVE FRM-CPIM-UBY TO FSE-IIC-IFOL-ATR.
           MOVE FRM-CPIM-UBY TO FSE-NUM-IFOL-ATR.
       FIN-UNP-IKY-FSE.
           EXIT.
       
       UNP-MKY-FSE SECTION.
       INI-UNP-MKY-FSE.
       FIN-UNP-MKY-FSE.
           EXIT.
       
       UNP-AKY-FSE SECTION.
       INI-UNP-AKY-FSE.
       FIN-UNP-AKY-FSE.
           EXIT.
       
       UNP-FLD-FSE SECTION.
       INI-UNP-FLD-FSE.
           PERFORM UNP-DBC-FSE.
           PERFORM UNP-FSE-FSE.
       FIN-UNP-FLD-FSE.
           EXIT.
       
       UNP-DBC-FSE SECTION.
       INI-UNP-DBC-FSE.
       FIN-UNP-DBC-FSE.
           EXIT.
       
       UNP-FSE-FSE SECTION.
       INI-UNP-FSE-FSE.
           MOVE FRM-CPIM-UBY TO FSE-GLS-APFS-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO FSE-GLS-AMFS-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO FSE-GLS-NMFS-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO FSE-COD-PTZC-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO FSE-COD-ORGN-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO FSE-NUM-PORC-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO FSE-COD-CRGO-ATR IN FSE-FLD.
           MOVE FRM-CPIM-UBY TO FSE-FEC-FSER-ATR IN FSE-FLD.
       FIN-UNP-FSE-FSE.
           EXIT.
       
       VAL-MKY-FSE SECTION.
       INI-VAL-MKY-FSE.
       FIN-VAL-MKY-FSE.
           EXIT.
       
       VAL-FLD-FSE SECTION.
       INI-VAL-FLD-FSE.
           PERFORM VAL-FRM-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-NOMC-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FSE-GLS-APFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FSE-GLS-APFS-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FSE-GLS-AMFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FSE-GLS-AMFS-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FSE-GLS-NMFS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FSE-GLS-NMFS-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FSE-COD-PTZC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FSE-COD-PTZC-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FRM-GLS-PTZC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-PTZC-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FSE-COD-ORGN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FSE-COD-ORGN-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FRM-GLS-ORGN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-ORGN-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FSE-NUM-PORC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FSE-NUM-PORC-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FSE-COD-CRGO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FSE-COD-CRGO-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
           PERFORM VAL-FRM-GLS-CRGO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO FRM-GLS-CRGO-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
      * FEC-INI --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
           PERFORM VAL-FSE-FEC-FSER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO
                FSE-FEC-FSER-LEN IN FSE-FLD
                GO TO FIN-VAL-FLD-FSE.
      * FEC-FIN --> BMCHIBCI007.SRCAIU PERFORM VAL-[FLD]
       FIN-VAL-FLD-FSE.
           EXIT.
       
       VAL-FRM-GLS-NOMC SECTION.
       INI-VAL-FRM-GLS-NOMC.
       FIN-VAL-FRM-GLS-NOMC.
           EXIT.
       
       VAL-FSE-GLS-APFS SECTION.
       INI-VAL-FSE-GLS-APFS.
           IF FSE-GLS-APFS IN FSE-FLD NOT > SPACES
              MOVE SPACES TO FSE-GLS-APFS IN FSE-FLD.
       FIN-VAL-FSE-GLS-APFS.
           EXIT.
       
       VAL-FSE-GLS-AMFS SECTION.
       INI-VAL-FSE-GLS-AMFS.
           IF FSE-GLS-AMFS IN FSE-FLD NOT > SPACES
              MOVE SPACES TO FSE-GLS-AMFS IN FSE-FLD.
       FIN-VAL-FSE-GLS-AMFS.
           EXIT.
       
       VAL-FSE-GLS-NMFS SECTION.
       INI-VAL-FSE-GLS-NMFS.
           IF FSE-GLS-NMFS IN FSE-FLD NOT > SPACES
              MOVE SPACES TO FSE-GLS-NMFS IN FSE-FLD.
      *<<<< FIN_FSE_GLS_NMFS
           IF FSE-GLS-NMFS IN FSE-FLD NOT > SPACES
              PERFORM ERR-GLS
              GO TO FIN-VAL-FSE-GLS-NMFS.
      *>>>>
       FIN-VAL-FSE-GLS-NMFS.
           EXIT.
       
       VAL-FSE-COD-PTZC SECTION.
       INI-VAL-FSE-COD-PTZC.
           IF FSE-COD-PTZC IN FSE-FLD NOT > SPACES
              MOVE SPACES TO FSE-COD-PTZC IN FSE-FLD.
      *<<<< FIN_FSE_COD_PTZC
           PERFORM VAL-FSE-DAP.
           IF FSE-COD-PTZC IN FSE-FLD NOT > SPACES AND
              WSS-IND-EDAP IN WSS-VARI = 'S'
              PERFORM ERR-GLS
              GO TO FIN-VAL-FSE-COD-PTZC.

           IF FSE-COD-PTZC IN FSE-FLD > SPACES AND
              WSS-IND-EDAP IN WSS-VARI = 'N'
              MOVE SPACES TO FSE-COD-PTZC IN FSE-FLD
              GO TO FIN-VAL-FSE-COD-PTZC.

      *<<<< FSE_COD_PTZC
           IF FSE-COD-PTZC IN FSE-FLD > SPACES
               MOVE 'SGC'                   TO TAB-COD-SIST
               MOVE 'PZC'                   TO TAB-COD-TTAB IN TAB
               MOVE FSE-COD-PTZC IN FSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                  MOVE TAB-GLS-DESC TO FRM-GLS-PTZC IN FSE-FLD
               ELSE
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FSE-COD-PTZC.
      *>>>>
       FIN-VAL-FSE-COD-PTZC.
           EXIT.
       
       VAL-FRM-GLS-PTZC SECTION.
       INI-VAL-FRM-GLS-PTZC.
       FIN-VAL-FRM-GLS-PTZC.
           EXIT.
       
       VAL-FSE-COD-ORGN SECTION.
       INI-VAL-FSE-COD-ORGN.
           IF FSE-COD-ORGN IN FSE-FLD NOT > SPACES
              MOVE SPACES TO FSE-COD-ORGN IN FSE-FLD.
      *<<<< FIN_FSE_COD_ORGN
           IF FSE-COD-ORGN IN FSE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-FSE-COD-ORGN.

      *<<<< FSE_COD_ORGN
           IF FSE-COD-ORGN IN FSE-FLD > SPACES
               MOVE 'SGC'                   TO TAB-COD-SIST
               MOVE 'OAE'                   TO TAB-COD-TTAB IN TAB
               MOVE FSE-COD-ORGN IN FSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                  MOVE TAB-GLS-DESC TO FRM-GLS-ORGN IN FSE-FLD
               ELSE
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FSE-COD-ORGN.
      *>>>>
       FIN-VAL-FSE-COD-ORGN.
           EXIT.
       
       VAL-FRM-GLS-ORGN SECTION.
       INI-VAL-FRM-GLS-ORGN.
       FIN-VAL-FRM-GLS-ORGN.
           EXIT.
       
       VAL-FSE-NUM-PORC SECTION.
       INI-VAL-FSE-NUM-PORC.
      *<<<< FIN_FSE_NUM_PORC
           PERFORM VAL-FSE-DAE.
           IF FSE-NUM-PORC IN FSE-FLD > ZEROES AND
              WSS-IND-EDAE IN WSS-VARI = 'N'
              MOVE ZEROES TO FSE-NUM-PORC IN FSE-FLD
              GO TO FIN-VAL-FSE-NUM-PORC.                               

           IF FSE-NUM-PORC IN FSE-FLD > 100
               MOVE 'SGC'         TO MSG-COD-SIST                       
               MOVE 'VALPORC100>' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                           
               MOVE MSG-GLS-DESC  TO FRM-MENS                           
               GO TO FIN-VAL-FSE-NUM-PORC.                              

           PERFORM VAL-FSE-FSE.

           IF SCR-CMND = 'MOD'
               PERFORM BUS-POR-FSE
               COMPUTE WSS-NUM-TPOR IN WSS-VARI = WSS-NUM-TPOR -
                                              WSS-NUM-PORC IN WSS-VARI.

           COMPUTE WSS-NUM-TPOR IN WSS-VARI = WSS-NUM-TPOR +
                                     FSE-NUM-PORC IN FSE-FLD.

           IF WSS-NUM-TPOR IN WSS-VARI > 100
               MOVE 'SGC'         TO MSG-COD-SIST                       
               MOVE 'VALPORC100>' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE FRM-SUAR-MAL  TO FRM-SUAR                           
               MOVE MSG-GLS-DESC  TO FRM-MENS                           
               GO TO FIN-VAL-FSE-NUM-PORC.
      *>>>>
       FIN-VAL-FSE-NUM-PORC.
           EXIT.
       
       VAL-FSE-COD-CRGO SECTION.
       INI-VAL-FSE-COD-CRGO.
           IF FSE-COD-CRGO IN FSE-FLD NOT > SPACES
              MOVE SPACES TO FSE-COD-CRGO IN FSE-FLD.
      *<<<< FIN_FSE_COD_CRGO
           IF FSE-COD-CRGO IN FSE-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-FSE-COD-CRGO.

      *<<<< FSE_COD_CRGO
           IF FSE-COD-CRGO IN FSE-FLD > SPACES
               MOVE 'SGC'                   TO TAB-COD-SIST
               MOVE 'COE'                   TO TAB-COD-TTAB IN TAB
               MOVE FSE-COD-CRGO IN FSE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS NOT > SPACES
                  MOVE TAB-GLS-DESC TO FRM-GLS-CRGO IN FSE-FLD
               ELSE
                  MOVE MSG-GLS-DESC TO FRM-MENS
                  MOVE FRM-SUAR-MAL TO FRM-SUAR
                  GO TO FIN-VAL-FSE-COD-CRGO.
      *>>>>
       FIN-VAL-FSE-COD-CRGO.
           EXIT.
       
       VAL-FRM-GLS-CRGO SECTION.
       INI-VAL-FRM-GLS-CRGO.
       FIN-VAL-FRM-GLS-CRGO.
           EXIT.
      * FEC-INI --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       VAL-FSE-FEC-FSER SECTION.
       INI-VAL-FSE-FEC-FSER.
           IF FSE-FEC-FSER IN FSE-FLD  NOT > ZEROES
              MOVE ZEROES TO FSE-FEC-FSER IN FSE-FLD.
      *VAL-FEC Validar Fecha
           MOVE FSE-FEC-FSER IN FSE-FLD TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S  TO FEC-FBLK.
           MOVE FEC-CHOY-LE TO FEC-CHOY.
           MOVE FEC-VHBL-S TO FEC-VHBL.
      *<<<< INI_FSE_FEC_FSER
*AFRI-INI 16-NOV-2011 CAMBIO FECHA HABIL      
           MOVE FEC-VHBL-N TO FEC-VHBL.
*AFRI-FIN 16-NOV-2011 CAMBIO FECHA HABIL
           
           PERFORM VAL-FSE-DAE.
           IF FSE-FEC-FSER IN FSE-FLD NOT > ZEROES AND
              WSS-IND-EDAE IN WSS-VARI = 'S'
              PERFORM ERR-GLS
              GO TO FIN-VAL-FSE-FEC-FSER.

           IF FSE-FEC-FSER IN FSE-FLD  > ZEROES AND
              WSS-IND-EDAE IN WSS-VARI = 'N'
              MOVE ZEROES TO FSE-FEC-FSER IN FSE-FLD
              GO TO FIN-VAL-FSE-FEC-FSER.
      *>>>>
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO FSE-FEC-FSER IN FSE-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS
               GO TO FIN-VAL-FSE-FEC-FSER.
       FIN-VAL-FSE-FEC-FSER.
           EXIT.
      * FEC-FIN --> BMCHIBCI008.SRCAIU VAL-[FLD] SECTION
       
       VAL-CON-FLD-FSE SECTION.
       INI-VAL-CON-FLD-FSE.
       FIN-VAL-CON-FLD-FSE.
           EXIT.
       
       VAL-CON-FSE SECTION.
       INI-VAL-CON-FSE.
       FIN-VAL-CON-FSE.
           EXIT.
       
       VAL-NUM-KEY-FSE SECTION.
       INI-VAL-NUM-KEY-FSE.
           PERFORM VAL-NUM-IKY-FSE.
           PERFORM VAL-NUM-MKY-FSE.
           PERFORM VAL-NUM-AKY-FSE.
       FIN-VAL-NUM-KEY-FSE.
           EXIT.
       
       VAL-NUM-IKY-FSE SECTION.
       INI-VAL-NUM-IKY-FSE.
      * IDC-INI --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-DBC-NUM-ICLI.
           MOVE DBC-NUM-ICLI-ALF IN FSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO DBC-NUM-ICLI IN FSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO DBC-NUM-ICLI-LEN IN FSE-FLD
                GO TO FIN-VAL-NUM-IKY-FSE.
      * IDC-FIN --> BMCHIBCI010.SRCAIU VALIDACION NUMERICA
       VAL-NUM-FSE-IIC-IFOL.
           MOVE FSE-IIC-IFOL-ALF IN FSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FSE-IIC-IFOL IN FSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FSE-IIC-IFOL-LEN IN FSE-FLD
                GO TO FIN-VAL-NUM-IKY-FSE.
       VAL-NUM-FSE-NUM-IFOL.
           MOVE FSE-NUM-IFOL-ALF IN FSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FSE-NUM-IFOL IN FSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FSE-NUM-IFOL-LEN IN FSE-FLD
                GO TO FIN-VAL-NUM-IKY-FSE.
       FIN-VAL-NUM-IKY-FSE.
           EXIT.
       
       VAL-NUM-MKY-FSE SECTION.
       INI-VAL-NUM-MKY-FSE.
       FIN-VAL-NUM-MKY-FSE.
           EXIT.
       
       VAL-NUM-AKY-FSE SECTION.
       INI-VAL-NUM-AKY-FSE.
       FIN-VAL-NUM-AKY-FSE.
           EXIT.
       
       VAL-NUM-FLD-FSE SECTION.
       INI-VAL-NUM-FLD-FSE.
       VAL-NUM-FSE-NUM-PORC.
           MOVE FSE-NUM-PORC-ALF IN FSE-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO FSE-NUM-PORC IN FSE-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO FSE-NUM-PORC-LEN IN FSE-FLD
                GO TO FIN-VAL-NUM-FLD-FSE.
       FIN-VAL-NUM-FLD-FSE.
           EXIT.
       
       EDT-KEY-FSE SECTION.
       INI-EDT-KEY-FSE.
           PERFORM EDT-IKY-FSE.
           PERFORM EDT-MKY-FSE.
           PERFORM EDT-AKY-FSE.
       FIN-EDT-KEY-FSE.
           EXIT.
       
       EDT-IKY-FSE SECTION.
       INI-EDT-IKY-FSE.
      * IDC-INI --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF DBC-NUM-ICLI-LEN IN FSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO DBC-NUM-ICLI-LEN IN FSE-FLD
                GO TO FIN-EDT-IKY-FSE.
           MOVE DBC-NUM-ICLI IN FSE-FLD TO
                DBC-NUM-ICLI-EDT IN FSE-EDT.
           MOVE DBC-NUM-ICLI-EDT IN FSE-EDT TO
                DBC-NUM-ICLI-ALF IN FSE-FLD.
      * IDC-FIN --> BMCHIBCI011.SRCAIU EDICION NUMERICA
           IF FSE-IIC-IFOL-LEN IN FSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FSE-IIC-IFOL-LEN IN FSE-FLD
                GO TO FIN-EDT-IKY-FSE.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO FSE-IIC-IFOL-EDT IN FSE-EDT.
           MOVE FSE-IIC-IFOL-EDT IN FSE-EDT TO 
                FSE-IIC-IFOL-ALF IN FSE-FLD.
           IF FSE-NUM-IFOL-LEN IN FSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FSE-NUM-IFOL-LEN IN FSE-FLD
                GO TO FIN-EDT-IKY-FSE.
           MOVE FSE-NUM-IFOL IN FSE-FLD TO FSE-NUM-IFOL-EDT IN FSE-EDT.
           MOVE FSE-NUM-IFOL-EDT IN FSE-EDT TO 
                FSE-NUM-IFOL-ALF IN FSE-FLD.
       FIN-EDT-IKY-FSE.
           EXIT.
       
       EDT-MKY-FSE SECTION.
       INI-EDT-MKY-FSE.
       FIN-EDT-MKY-FSE.
           EXIT.
       
       EDT-AKY-FSE SECTION.
       INI-EDT-AKY-FSE.
       FIN-EDT-AKY-FSE.
           EXIT.
       
       EDT-FLD-FSE SECTION.
       INI-EDT-FLD-FSE.
           IF FSE-NUM-PORC-LEN IN FSE-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO FSE-NUM-PORC-LEN IN FSE-FLD
                GO TO FIN-EDT-FLD-FSE.
           MOVE FSE-NUM-PORC IN FSE-FLD TO FSE-NUM-PORC-EDT IN FSE-EDT.
           MOVE FSE-NUM-PORC-EDT IN FSE-EDT TO 
                FSE-NUM-PORC-ALF IN FSE-FLD.
       FIN-EDT-FLD-FSE.
           EXIT.
      *<<<< EOF_BU
       VAL-FSE-DAP SECTION.
       INI-VAL-FSE-DAP.
           MOVE 'S' TO WSS-IND-EDAP IN WSS-VARI.
           MOVE FSE-CAI-IFOL IN FSE-FLD TO DAP-CAI-IFOL IN DAP.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO DAP-IIC-IFOL IN DAP.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DAP.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO WSS-IND-EDAP IN WSS-VARI.

       FIN-VAL-FSE-DAP.
           EXIT.

       VAL-FSE-DAE SECTION.
       INI-VAL-FSE-DAE.
           MOVE 'S' TO WSS-IND-EDAE IN WSS-VARI.
           MOVE FSE-CAI-IFOL IN FSE-FLD TO DAE-CAI-IFOL IN DAE.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO DAE-IIC-IFOL IN DAE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-DAE.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO WSS-IND-EDAE IN WSS-VARI.

       FIN-VAL-FSE-DAP.
           EXIT.

       VAL-FSE-FSE SECTION.
       INI-VAL-FSE-FSE.
           MOVE 'N' TO WSS-IND-EFSE IN WSS-VARI.
           MOVE FSE-CAI-IFOL IN FSE-FLD TO FSE-CAI-IFOL IN FSE.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO FSE-IIC-IFOL IN FSE.
           MOVE ZEROES                  TO FSE-NUM-IFOL IN FSE.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-VAL-FSE-FSE.
           PERFORM SGC-FIO-FSE.
           IF NOT (FIO-STAT-OKS AND
               FSE-CAI-IFOL IN FSE-FLD = FSE-CAI-IFOL IN FSE AND
               FSE-IIC-IFOL IN FSE-FLD = FSE-IIC-IFOL IN FSE)
               GO TO FIN-VAL-FSE-FSE.

           COMPUTE WSS-NUM-TPOR IN WSS-VARI =  WSS-NUM-TPOR +
                                               FSE-NUM-PORC IN FSE.

       NXT-VAL-FSE-FSE.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LUP-VAL-FSE-FSE.
       FIN-VAL-FSE-FSE.
           EXIT.

       BUS-POR-FSE SECTION.
       INI-BUS-POR-FSE.

           MOVE FSE-CAI-IFOL IN FSE-FLD TO FSE-CAI-IFOL IN FSE.
           MOVE FSE-IIC-IFOL IN FSE-FLD TO FSE-IIC-IFOL IN FSE.
           MOVE FSE-NUM-IFOL IN FSE-FLD TO FSE-NUM-IFOL IN FSE.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-FSE.
           IF NOT (FIO-STAT-OKS)
               MOVE ZEROES TO WSS-NUM-PORC IN WSS-VARI
               GO TO FIN-BUS-POR-FSE.

           MOVE FSE-NUM-PORC IN FSE TO WSS-NUM-PORC IN WSS-VARI.

       FIN-BUS-POR-FSE.
           EXIT.
      *>>>>
