       IDENTIFICATION DIVISION.
      *=======================*
       PROGRAM-ID.      SGCPGIDS.
       AUTHOR.          CONSIST(REL).
       DATE-WRITTEN.    17-ENE-1996
      *
      *  BDE --->  REC }  ADS  de Sistema SGC
      *
       ENVIRONMENT DIVISION.
      *====================*
       CONFIGURATION SECTION.
      *---------------------*
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------*
       FILE-CONTROL.

       DATA DIVISION.
      *=============*
       WORKING-STORAGE SECTION.
      *-----------------------*
      *<<<< WSS_DTC

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DSF-REQA==.

      *<<<< WSS
       COPY SGCBRADS.
       COPY SGCBRIDS.
       COPY SGCBRDSF.

       COPY GNSBRTAB.
       COPY GNSBRIDD.

       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWVIDD.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGSYS.

       01  WSS-VARI.
           03 WSS-NUM-RLEE          VALUE ZEROES PIC 9(05).
           03 WSS-NUM-RPRO          VALUE ZEROES PIC 9(05).
           03 SUP-NUM-RLEE          VALUE ZEROES PIC 9(05).


       PROCEDURE DIVISION.
      *==================*
       MAIN SECTION.
      *------------*
       INI-MAIN.
      *--------*
           COPY GNSBGEDB.
           MOVE 'SGCPGIDS' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.

           PERFORM  ABRE2-ARCHIVOS.
           MOVE LOW-VALUES         TO ADS-NUM-ICLI.
           MOVE FIO-GET-FST        TO FIO-CMND.
           PERFORM SGC-FIO-ADS.
       LUP-SUP
           IF NOT FIO-STAT-OKS
              DISPLAY ' ARCHIVO VACIO '
              PERFORM CIERRA2-ARCHIVOS
              STOP RUN
           ELSE
              ADD 1 TO WSS-NUM-RLEE IN WSS-VARI
              MOVE ADS-CIC-ICLI         TO DSF-CIC-IDEU
              MOVE FIO-GET-KEY          TO FIO-CMND
              PERFORM SGC-FIO-DSF
              IF NOT FIO-STAT-OKS
                 DISPLAY ' ARCHIVO NO LEIDO '
                 PERFORM LEE-ADS
                 GO TO LUP-SUP 
              ELSE
                 PERFORM LLENA-IDS
                 PERFORM GUARDA-REG
                 PERFORM LEE-ADS
                 GO TO LUP-SUP.
      * --------
       FIN-MAIN.
      *--------*


       ABRE2-ARCHIVOS SECTION.
       INI-ABRE2-ARCHIVOS.
           MOVE FIO-INP TO FIO-CMND.
           DISPLAY 'OPEN-OUTPUT SEQ'.
           PERFORM SGC-FIO-DSF.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR EN APERTURA SEQ: ' FIO-STAT
              PERFORM GNS-PRO-END.
 
           MOVE FIO-OUT TO FIO-CMND.
           PERFORM SGC-FIO-IDS.
           IF NOT FIO-STAT-OKS
              DISPLAY 'ERROR EN APERTURA SEQ: ' FIO-STAT
              PERFORM GNS-PRO-END.
       FIN-ABRE2-ARCHIVOS.
           EXIT.


       CIERRA2-ARCHIVOS SECTION.
       INI-CIERRA2-ARCHIVOS.
           DISPLAY 'CIERRA ARCHIVOS'.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-ADS.
           MOVE FIO-CLO TO FIO-CMND.
           PERFORM SGC-FIO-IDS.
       FIN-CIERRA2-ARCHIVOS.
           EXIT.



       GUARDAR-REG SECTION.
       INI-GUARDAR-REG.
              MOVE FIO-PUT TO FIO-CMND.
              PERFORM SGC-FIO-IDS.
              IF NOT FIO-STAT-OKS
                 DISPLAY 'ERROR AL GRABAR SEQ-IDS: ' FIO-STAT
                 PERFORM GNS-PRO-END.
              ADD 1 TO WSS-NUM-RPRO IN WSS-VARI.
       FIN-GUARDAR-REG.
           EXIT.                   

       LLENA-IDS SECTION.
       INI-LLENA-IDS.
           MOVE ADS-NUM-ICLI IN ADS TO IDS-NUM-ICLI  IN IDS. 
           MOVE ADS-VRF-ICLI IN ADS      TO IDS-VRF-ICLI IN IDS.
           MOVE DSF-VAL-DVCX IN DSF      TO IDS-MTO-DEUD IN IDS.
       FIN-LLENA-IDS.
           EXIT.                   

       LEE-ADS SECTION.
       INI-LEE-ADS.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM SGC-FIO-ADS.
       FIN-LEE-ADS.
           EXIT.                   




       COPY SGCBFADS.
       COPY SGCBFDSF.
       COPY SGCBFIDS.

      * COPY SGCBFDBC.
       COPY GNSBFTAB.

       COPY GNSBGDTC.
       COPY GNSBGIDD.
       COPY GNSBTABT.
       COPY GNSBBSYS.
       COPY GNSBGEND.
       COPY GNSBGABT.


