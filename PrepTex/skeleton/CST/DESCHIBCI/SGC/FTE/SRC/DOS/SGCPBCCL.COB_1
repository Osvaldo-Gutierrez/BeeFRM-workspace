       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.    SGCPBCCL.
       AUTHOR.        VERONICA CORREA.
       DATE-WRITTEN.  MAYO 1997.
       DATE-COMPILED.
      **************************************************************
      *                                                            *
      *  Sistema    : Plataforma Comercial.                        *
      *  J.Proyecto : Mariela Albornoz.                            *
      *  Analista   : Gerardo Ureta.                               *
      *  Objetivos  :                                              *
      *                                                            *
      *   Entrada   :                                              *
      *               - ARCHIVO AECPR01                            *
      *                                                            *
      *   Salida    :                                              *
      *               - BASES ACTUALIZADA DBC DCP RCD               *
      *                                                            *
      **************************************************************
      *   Modificaciones                                           *
      *                                                            *
      *   AUTOR : VERONICA CORREA ANASTASIADES                     *
      *                                                            *
      *   FECHA : 1-09-97                                          *
      *                                                            *
      *   MODIF.: SE AGREGA EL LISTADO CON CTA PRIMA               *
      *   Modificaciones                                           *
      *                                                            *
      *   AUTOR : E SALDIVIA C                                     *
      *                                                            *
      *   FECHA : 26-12-97                                         *
      *                                                            *
      *   MODIF.: SE AGREGAN DISPLAY DE ERRORES                    *
      **************************************************************
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
           DECIMAL-POINT IS COMMA
           C01 IS CANAL-1.

       INPUT-OUTPUT SECTION.
      *---------------------
       FILE-CONTROL.
      *-------------
           SELECT AECPR01      ASSIGN TO AECPR01
                               ORGANIZATION IS SEQUENTIAL
                               FILE STATUS  IS FST-AECPR01.
           SELECT ARCHERR      ASSIGN TO ARCHERR
                               FILE STATUS IS FST-ARCHERR.
           SELECT LSTCREG      ASSIGN TO LSTCREG.

       DATA DIVISION.
      *=============
       FILE SECTION.
      *-------------


       FD  AECPR01
           RECORDING MODE F
           RECORD CONTAINS 258 CHARACTERS
           BLOCK  CONTAINS 0   RECORDS
           LABEL RECORD IS STANDARD.

       01  REG-AECPR01.
           05  AEC-FILLER-1                 PIC X(01).
           05  AEC-RUT-EMP                  PIC X(08).
           05  AEC-FILLER                   PIC X(01).
           05  AEC-IDC-CLI                  PIC X(08).
           05  AEC-DIG-VER                  PIC X(01).
           05  AEC-CLI-IND                  PIC X(01).
           05  AEC-CLI-TIP                  PIC X(02).
           05  AEC-CLI-CIC                  PIC X(12).
           05  AEC-COD-EST                  PIC X(03).
           05  AEC-APE-PTN                  PIC X(25).
           05  AEC-APE-MTN                  PIC X(25).
           05  AEC-CLI-NOM                  PIC X(25).
           05  AEC-IND-SEX                  PIC X(01).
           05  AEC-COD-ACV                  PIC X(09).
           05  AEC-COD-EJE                  PIC X(12).
           05  AEC-COD-ECV                  PIC X(03).
           05  AEC-FEC-NAC                  PIC X(10).
           05  AEC-REG-CNY                  PIC X.
           05  AEC-COD-NAC                  PIC 9(03).
           05  AEC-COD-OFI                  PIC X(03).
           05  AEC-COD-PLN                  PIC X(01).
           05  AEC-TIP-BCA                  PIC X(03).
           05  AEC-IND-ORN                  PIC X(01).
           05  AEC-TIP-ORN                  PIC X(03).
           05  AEC-IDN-USU                  PIC X(12).
           05  AEC-TIP-DIR                  PIC X(01).
           05  AEC-EST-DIR                  PIC X(01).
           05  AEC-FEC-VFC                  PIC X(10).
           05  AEC-DIR                      PIC X(60).
           05  AEC-COD-LUG                  PIC X(04).
           05  AEC-CTA-CAR                  PIC X(08).

       FD  ARCHERR
           LABEL RECORD STANDARD
           RECORD CONTAINS 113 CHARACTERS
           BLOCK  CONTAINS 0   RECORDS.
       01  REG-ARCHERR.
           05  ERR-SISTEMA                  PIC X(03).
           05  ERR-NOM-PGM                  PIC X(10).
           05  ERR-FECHA.
               07  ERR-FEC-SS               PIC 9(02).
               07  ERR-FEC-AA               PIC 9(02).
               07  ERR-PAL-1                PIC X(01).
               07  ERR-FEC-MM               PIC 9(02).
               07  ERR-PAL-2                PIC X(01).
               07  ERR-FEC-DD               PIC 9(02).
           05  ERR-HORA                     PIC X(08).
           05  ERR-TIPO                     PIC X(03).
           05  ERR-TABLA-PROG               PIC X(08).
           05  ERR-SENTENCIA                PIC X(10).
           05  ERR-SQLCODE                  PIC S9(08).
           05  ERR-KEY                      PIC X(24).
           05  ERR-ERRCODE                  PIC X(02).
           05  ERR-ERRINT                   PIC X(02).
           05  ERR-GLOSA                    PIC X(25).

      *
       FD LSTCREG                 RECORDING MODE F
                                  RECORD CONTAINS 132 CHARACTERS
                                  LABEL RECORD OMITTED.
       01 FD-LSTCREG                    PIC X(132).
      *
       WORKING-STORAGE SECTION.
      *========================
       01  VARIOS.
           03 FST-AECPR01              PIC X(02) VALUE SPACES.
           03 FST-ARCHERR              PIC X(02) VALUE SPACES.
           03 WA-NUM-PAG               PIC 9(02) VALUE 1.
           03 WA-CREADOS               PIC 9(08) VALUE 0.
           03 WS-CREADO                PIC 9(01) VALUE 0.
           03 WS-ACTUALIZ              PIC 9(01) VALUE 0.
           03 WA-LEIDOS-ARCH           PIC 9(08) VALUE 0.
           03 WA-ACTUALIZ-DBC          PIC 9(08) VALUE 0.
           03 WA-ACTUALIZ-DCP          PIC 9(08) VALUE 0.
           03 WA-ACTUALIZ-RCD          PIC 9(08) VALUE 0.
           03 WA-ACTUALIZ-REC          PIC 9(08) VALUE 0.
           03 WA-CREADOS-DBC           PIC 9(08) VALUE 0.
           03 WA-CREADOS-DCP           PIC 9(08) VALUE 0.
           03 WA-CREADOS-RCD           PIC 9(08) VALUE 0.
           03 WA-CREADOS-REC           PIC 9(08) VALUE 0.
           03 WA-ACTUALIZ              PIC 9(08) VALUE 0.
           03 WA-REGRABADOS-CDV        PIC 9(08) VALUE 0.
           03 WA-GRABADOS-ELIM         PIC 9(06) VALUE 0.
           03 WA-GRABADOS-MOD          PIC 9(06) VALUE 0.
           03 WA-MONTO-EDIT            PIC ZZ.ZZZ.ZZZ.
           03 WA-ERROR                 PIC 9(01) VALUE 0.
           03 WS-FIN-ARCH              PIC 9(01) VALUE 0.
           03 WS-EXITO-DBC             PIC X(02) VALUE SPACES.
           03 WS-EXITO-DCP             PIC X(02) VALUE SPACES.
           03 WS-EXITO-RCD             PIC X(02) VALUE SPACES.
           03 WS-EXITO-REC             PIC X(02) VALUE SPACES.
           03 WS-BLANCO                PIC X(15) VALUE SPACES.
           03 OK-OPE                   PIC X(02) VALUE 'SI'.
           03 OK-PROC-REC              PIC X(02) VALUE 'SI'.
           03 OK-OPE-TOT               PIC X(02) VALUE 'SI'.
           03 AUX-IDC.
              05 AUX-RUT               PIC X(08).
              05 AUX-RES               PIC X(04).
           03 WS-CIC-EMP               PIC X(12).
           03 WS-CIC-AUX.
              05 WS-CAI-AUX            PIC X(04).
              05 WS-IIC-AUX            PIC X(08).
           03 FS-ARCHIVO               PIC X(02)     VALUE '00'.
           03 WS-FEC-TND.
              05 WS-AGNO-TND           PIC 9(04).
              05 FILLER                PIC X(01).
              05 WS-MES-TND            PIC 9(02).
              05 FILLER                PIC X(01).
              05 WS-DIA-TND            PIC 9(02).
           03 WS-FEC-NAC.
              05 WS-AGNO-NAC           PIC 9(04).
              05 WS-MES-NAC            PIC 9(02).
              05 WS-DIA-NAC            PIC 9(02).
           03 WS-FEC-VEN.
              05 WS-AGNO-VEN           PIC 9(04).
              05 WS-MES-VEN            PIC 9(02).
              05 WS-DIA-VEN            PIC 9(02).
      *---------------------------------------------------------------*
      * VARIABLES PARA COMPACTAR STRING                               *
      *---------------------------------------------------------------*
       01  WR-CPT-VARI.
           02 WR-CPT-STRN                            PIC  X(76).
           02 WR-CPT-STRN-RED REDEFINES WR-CPT-STRN  PIC  X(01)
                           OCCURS 76.
           02 WR-CPT-LENG                  VALUE  76 PIC  9(03).
           02 WR-CPT-IBLK                            PIC  X(01).
              88 WR-CPT-PONGO-BLANCO       VALUE 'S'.
           02 WR-CPT-UBLK                  VALUE 0   PIC  9(03).
           02 WR-CPT-I                     VALUE 0   PIC  9(03).
           02 WR-CPT-J                     VALUE 0   PIC  9(03).

       01  WR-GLS-NOMC.
           03 WR-GLS-APAT                  PIC X(25).
           03 WR-GLS-AMAT                  PIC X(25).
           03 WR-GLS-NOMB                  PIC X(25).
      *********************************************************
      *              VARIABLES DE LISTADO                     *
      *********************************************************
       01  LINEA-01.
           03 FILLER      PIC X(45) VALUE
                                    'BANCO DE CREDITO E INVERSIONES'.
           03 FILLER      PIC X(67) VALUE SPACES.
           03 FILLER      PIC X(09) VALUE 'FECHA  : '.
           03 L1-FECHA    PIC X(10).

       01  LINEA-02.
           03 FILLER      PIC X(41) VALUE '             '.
           03 FILLER      PIC X(71) VALUE SPACES.
           03 FILLER      PIC X(16) VALUE 'PAGINA :        '.
           03 L2-PAG      PIC ZZ9.

       01  LINEA-03.
           03 FILLER      PIC X(55) VALUE SPACES.
           03 FILLER      PIC X(22) VALUE 'SISTEMA DE CLIENTES'.

       01  LINEA-04.
           03 FILLER      PIC X(55) VALUE SPACES.
           03 FILLER      PIC X(26) VALUE '   INFORME DE ERRORES     '.

       01  LINEA-041.
           03 FILLER      PIC X(55) VALUE SPACES.
           03 FILLER      PIC X(26) VALUE '   CON CUENTA CORRIENTE   '.

       01  LINEA-07.
           03 FILLER      PIC X(132) VALUE ALL '-'.

       01  LINEA-08.
           03 FILLER      PIC X(132) VALUE SPACES.


       01  LINEA-06.
           03 FILLER      PIC X(05) VALUE SPACES.
           03 FILLER      PIC X(07) VALUE 'RUT-CLI'.
           03 FILLER      PIC X(07) VALUE SPACES.
           03 FILLER      PIC X(08) VALUE 'NOM-CLI '.
           03 FILLER      PIC X(22) VALUE SPACES.
           03 FILLER      PIC X(07) VALUE 'OFICINA'.
           03 FILLER      PIC X(02) VALUE SPACES.
           03 FILLER      PIC X(09) VALUE 'EJECUTIVO'.

       01  LINEA-DET2.
           03 FILLER        PIC X(03) VALUE SPACES.
           03 LINE-NRUT     PIC X(08) VALUE SPACES.
           03 LINE-RAY      PIC X(01) VALUE '-'.
           03 LINE-DRUT     PIC X(01) VALUE SPACES.
           03 FILLER        PIC X(06) VALUE SPACES.
           03 LINE-NOM      PIC X(30) VALUE SPACES.
           03 FILLER        PIC X(02) VALUE SPACES.
           03 LINE-OFI      PIC X(03) VALUE SPACES.
           03 FILLER        PIC X(05) VALUE SPACES.
           03 LINE-EJE      PIC X(12) VALUE SPACES.
      *
       01  WP-FECHA-ENTRADA.
           05 FILLER                   PIC X(17).
           05 WP-FECHA-PROCESO         PIC X(08).
           05 WP-FECHA-PROC-R REDEFINES WP-FECHA-PROCESO.
              10 WP-FPROC-SS            PIC 9(02).
              10 WP-FPROC-AA            PIC 9(02).
              10 WP-FPROC-MM            PIC 9(02).
              10 WP-FPROC-DD            PIC 9(02).

       01  WS-VARIABLES-PROCESO.
           03 WS-FECHA-N               PIC 9(06).
           03 WS-FECHA-R REDEFINES    WS-FECHA-N.
              05 WS-AA                 PIC 9(02).
              05 WS-MM                 PIC 9(02).
              05 WS-DD                 PIC 9(02).
           03 WS-FECHA-X               PIC X(10).
           03 WS-FECHA-RED REDEFINES  WS-FECHA-X.
              05 WS-DD-X               PIC 9(02).
              05 WS-F1-X               PIC X(01).
              05 WS-MM-X               PIC 9(02).
              05 WS-F2-X               PIC X(01).
              05 WS-AA-X               PIC 9(02).
           03 WS-HORA-N                PIC 9(08).
           03 WS-HORA-R REDEFINES      WS-HORA-N.
              05 WS-HHH                PIC 9(02).
              05 WS-MMM                PIC 9(02).
              05 WS-SSS                PIC 9(02).
              05 WS-MMS                PIC 9(02).
           03 WS-HORA-X                PIC X(09).
           03 WS-HORA-RED REDEFINES    WS-HORA-X.
              05 WS-HHH-X              PIC 9(02).
              05 WS-FI1-X              PIC X(01).
              05 WS-MMM-X              PIC 9(02).
              05 WS-FI2-X              PIC X(01).
              05 WS-SSS-X              PIC 9(03).
           03 WS-FECHA-A               PIC 9(08).
           03 WS-FECHA-AR REDEFINES   WS-FECHA-A.
              05 WS-AA-A               PIC 9(04).
              05 WS-MM-A               PIC 9(02).
              05 WS-DD-A               PIC 9(02).
           03 R-WS-HORA .
              05 WS-HRA-HH           PIC 9(02).
              05 PUNTO-1             PIC X(01).
              05 WS-HRA-MM           PIC 9(02).
              05 PUNTO-2             PIC X(01).
              05 WS-HRA-SS           PIC 9(02).

       01  WK-PARAM-1.
           03 FILLER                   PIC X(17).
           03 WK-FECHA-ACT             PIC 9(08).
           03 FILLER                   PIC X(50).
       01  REQ-AREA.
           03 COMAN                    PIC X(05).
           03 FILLER                   PIC X(295).

      ******************************************************************
      *      USER INFORMATION BLOCK                                    *
      ******************************************************************
      *
       01  UIB.
           02 FILLER               PIC X(32) VALUE 'SGCPBCCL'.
      *
      ******************************************************************
      *      REQUEST AREA                                              *
      ******************************************************************
      *
      *
       01  REQ-AREA-DBC.
           02 REQ-COMAN-DBC        PIC X(5).
           02 REQ-TBLNM-DBC        PIC X(3)  VALUE 'DBC'.
           02 REQ-KYNAM-DBC        PIC X(5)  VALUE 'DBC00'.
           02 REQ-RTNCD-DBC        PIC X(2)  VALUE SPACES.
           02 REQ-INRCD-DBC        PIC X(1).
           02 REQ-DBIDE-DBC        PIC S9(4)  COMP VALUE +100.
           02 REQ-TBLID-DBC        PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-CTMAX-DBC        PIC S9(4)  COMP.
           02 REQ-IOCNT-DBC        PIC S9(4)  COMP.
           02 FILLER               PIC X(22).
           02 REQ-KYVAL-DBC        PIC X(12).
           02 REQ-KYVAL1-DBC REDEFINES REQ-KYVAL-DBC.
              03 REQ-CAI-ICLI-DBC   PIC X(04).
              03 REQ-IIC-ICLI-DBC   PIC X(08).
           02 REQ-KYVAL2-DBC REDEFINES  REQ-KYVAL-DBC.
              03 REQ-NUM-ICLI-DBC   PIC X(08).
              03 REQ-RES-ICLI-DBC   PIC X(04).
      *
       01  REQ-AREA-DCP.
           02 REQ-COMAN-DCP        PIC X(5).
           02 REQ-TBLNM-DCP        PIC X(3)  VALUE 'DCP'.
           02 REQ-KYNAM-DCP        PIC X(5)  VALUE 'DCP00'.
           02 REQ-RTNCD-DCP        PIC X(2)  VALUE SPACES.
           02 REQ-INRCD-DCP        PIC X(1).
           02 REQ-DBIDE-DCP        PIC S9(4)  COMP VALUE +100.
           02 REQ-TBLID-DCP        PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-CTMAX-DCP        PIC S9(4)  COMP.
           02 REQ-IOCNT-DCP        PIC S9(4)  COMP.
           02 FILLER               PIC X(22).
           02 REQ-KYVAL-DCP.
              03 REQ-CAI-ICLI-DCP  PIC X(04).
              03 REQ-IIC-ICLI-DCP  PIC X(08).
      *
       01  REQ-AREA-RCD.
           02 REQ-COMAN-RCD        PIC X(5).
           02 REQ-TBLNM-RCD        PIC X(3)  VALUE 'RCD'.
           02 REQ-KYNAM-RCD        PIC X(5)  VALUE 'RCD00'.
           02 REQ-RTNCD-RCD        PIC X(2)  VALUE SPACES.
           02 REQ-INRCD-RCD        PIC X(1).
           02 REQ-DBIDE-RCD        PIC S9(4)  COMP VALUE +100.
           02 REQ-TBLID-RCD        PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-CTMAX-RCD        PIC S9(4)  COMP.
           02 REQ-IOCNT-RCD        PIC S9(4)  COMP.
           02 FILLER               PIC X(22).
           02 REQ-KYVAL-RCD.
              03 REQ-CAI-ICLI-RCD  PIC X(04).
              03 REQ-IIC-ICLI-RCD  PIC X(08).
              03 REQ-NUM-DIRE      PIC 9(02).
      *
       01  REQ-AREA-REC.
           02 REQ-COMAN-REC        PIC X(5).
           02 REQ-TBLNM-REC        PIC X(3)  VALUE 'REC'.
           02 REQ-KYNAM-REC        PIC X(5)  VALUE 'REC00'.
           02 REQ-RTNCD-REC        PIC X(2)  VALUE SPACES.
           02 REQ-INRCD-REC        PIC X(1).
           02 REQ-DBIDE-REC        PIC S9(4)  COMP VALUE +100.
           02 REQ-TBLID-REC        PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-CTMAX-REC        PIC S9(4)  COMP.
           02 REQ-IOCNT-REC        PIC S9(4)  COMP.
           02 FILLER               PIC X(22).
           02 REQ-KYVAL-REC.
              03 REQ-CIC-ICLI-REC  PIC X(12).
              03 REQ-COD-TREC      PIC X(02).
              03 REQ-CIC-IREL      PIC X(12).
              03 REQ-NUM-TREC      PIC 9(02).
      ******************************************************************
      *                   WORK AREA                                    *
      ******************************************************************
      *
       01  REG-DBC.
      *    COPYDD DGC-R-DBC.DGC-E-DBC00(PROD),01,D.
      *                             EQUIVALENTE AL REGISTRO DBC
           02  DGC-E-DBC00.
      *                             DATOS BASICOS DEL CLIENTE
               03  DBC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DBC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DBC-KEY-IREG.
      *                             IDENTIFICACION DATOS BASICOS CLIENTE
                       05  DBC-KEY-IDBC.
      *                             COD. INT. COMP. CLIENTE
                       06  DBC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DBC-CAI-ICLI.
                       08  DBC-COD-TCLI
                                    PICTURE X(1).
                       08  DBC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DBC-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DBC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DBC-FEC-FTRN.
                       07  DBC-NUM-STRN
                                    PICTURE 9(2).
                       07  DBC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DBC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DBC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DBC-HRA-HRTR.
                       07  DBC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DBC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DBC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DBC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DBC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DBC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DBC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DBC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DBC-COD-ATRN PICTURE X(12).
      *                             KEY RUT CLIENTE + INDICADOR O CALIFI
                   04  DBC-IDC-ICLI.
      *                             RUT CLIENTE
                       05  DBC-NUM-ICLI
                                    PICTURE X(8).
      *                             INDICADOR TIPO RUT
                       05  DBC-IND-ICLI
                                    PICTURE X(1).
      *                             EXTENSION DEL RUT
                       05  DBC-GLS-ICLI
                                    PICTURE X(3).
      *                             KEY DIGITO VERIFICADOR DEL RUT
                   04  DBC-VRF-ICLI PICTURE X(1).
      *                             KEY NOMBRE CLIENTE GENERICO (PERSONA
                   04  DBC-GLS-NOMC.
                       05  DBC-GLS-APAT
                                    PICTURE X(25).
                       05  DBC-GLS-AMAT
                                    PICTURE X(25).
                       05  DBC-GLS-NOMB
                                    PICTURE X(25).
      *                             SOUNDEX DEL NOMBRE DE CLIENTE
                   04  DBC-SNX-NOMC.
                       05  DBC-SNX-APAT
                                    PICTURE X(3).
                       05  DBC-SNX-AMAT
                                    PICTURE X(3).
                       05  DBC-SNX-NOMB
                                    PICTURE X(3).
      *                             NUMERO DE DIRECCION DE ENVIO CORRESP
                   04  DBC-NUM-DCOR PICTURE 9(2).
      *                             OPR IND TIPO CLIENTE ( PERSONA O EMP
                   04  DBC-IND-TICL PICTURE X(1).
      *                             TIPO CLIENTE (POTENCIAL,NO CLIENTE,G
                   04  DBC-COD-TICL PICTURE X(2).
      *                             CODIGO CLASIFICACION COMERCIAL
                   04  DBC-COD-CLCM PICTURE X(2).
      *                             RCM CODIGO DEL EJECUTIVO ENCARGADO D
                   04  DBC-COD-EJEC PICTURE X(12).
      *                             OPR CODIGO DE OFICINA DONDE OPERA EL
                   04  DBC-COD-OFIC PICTURE X(3).
      *                             RCM INDICADOR SI OPERA EN OTRA OFICI
                   04  DBC-IND-OOFI PICTURE X(1).
      *                             EXT CODIGO ACTIVIDAD ECONOMICA
                   04  DBC-COD-ACTI PICTURE X(9).
      *                             EXT ORIGEN Y DESTINO SECT (COMP.INST
                   04  DBC-COD-ODSE PICTURE X(3).
      *                             INF FECHA INGRESO AL PLAN
                   04  DBC-FEC-FPLN.
                       05  DBC-NUM-SPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-APLN
                                    PICTURE 9(2).
                       05  DBC-NUM-MPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-DPLN
                                    PICTURE 9(2).
      *                             CODIGO DE SEGMENTO
                   04  DBC-COD-SETO PICTURE X(5).
      *                             PERIODO DE SEGMENTO (SSAAMM)
                   04  DBC-PDO-SETO PICTURE X(6).
      *                             INF INDICADOR DE MULTAS BANCO CENTRA
                   04  DBC-IND-MUBC PICTURE X(1).
      *                             INF INDICADOR DE JUICIOS BANCO CENTR
                   04  DBC-IND-JUBC PICTURE X(1).
      *                             EXT CODIGO ESTADO CLIENTE ( COMO DEU
                   04  DBC-MSC-SCLI PICTURE X(1).
      *                             FECHA ESTADO CLIENTE
                   04  DBC-FEC-FSCL.
                       05  DBC-NUM-SSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-ASCL
                                    PICTURE 9(2).
                       05  DBC-NUM-MSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-DSCL
                                    PICTURE 9(2).
      *                             CODIGO DE BLOQUEO DEL CLIENTE
                   04  DBC-COD-BLOC PICTURE X(2).
      *                             NUMERO TOTAL DE DIRECCIONES
                   04  DBC-NUM-TDIR PICTURE 9(2).
      *                             NUMERO TOTAL DE COMENTARIOS
                   04  DBC-NUM-TCMT PICTURE 9(3).
      *                             FECHA INICIO OPERACION
                   04  DBC-FEC-FIOP.
                       05  DBC-NUM-SIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-AIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DIOP
                                    PICTURE 9(2).
      *                             FECHA TERMINO OPERACION
                   04  DBC-FEC-FTOP.
                       05  DBC-NUM-STOP
                                    PICTURE 9(2).
                       05  DBC-NUM-ATOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MTOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DTOP
                                    PICTURE 9(2).
      *                             NUMERO OPERACIONES FECHA TERMINO NUL
                   04  DBC-NUM-OFTN PICTURE 9(3).
      *                             FECHA INGRESO DE DATOS A LA BASE DE
                   04  DBC-FEC-FINP.
                       05  DBC-NUM-SINP
                                    PICTURE 9(2).
                       05  DBC-NUM-AINP
                                    PICTURE 9(2).
                       05  DBC-NUM-MINP
                                    PICTURE 9(2).
                       05  DBC-NUM-DINP
                                    PICTURE 9(2).
      *
       01  REG-DCP.
      *    COPYDD DGC-R-DCP.DGC-E-DCP00(PROD),01,D.
      *                             EQUIVALENTE AL REGISTRO DCP
           02  DGC-E-DCP00.
      *                             DATOS COMPLEMENTARIOS PERSONAS
               03  DCP.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DCP-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DCP-KEY-IREG.
      *                             ID DATOS COMPLEMENTARIOS PERSONAS
                       05  DCP-KEY-IDCP.
      *                             COD. INT. COMP. CLIENTE
                       06  DCP-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DCP-CAI-ICLI.
                       08  DCP-COD-TCLI
                                    PICTURE X(1).
                       08  DCP-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DCP-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DCP-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DCP-FEC-FTRN.
                       07  DCP-NUM-STRN
                                    PICTURE 9(2).
                       07  DCP-NUM-ATRN
                                    PICTURE 9(2).
                       07  DCP-NUM-MTRN
                                    PICTURE 9(2).
                       07  DCP-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DCP-HRA-HRTR.
                       07  DCP-NUM-HHTR
                                    PICTURE 9(2).
                       07  DCP-NUM-MMTR
                                    PICTURE 9(2).
                       07  DCP-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DCP-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DCP-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DCP-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DCP-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DCP-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DCP-COD-ATRN PICTURE X(12).
      *                             FECHA DE NACIMIENTO
                   04  DCP-FEC-FNAC.
                       05  DCP-NUM-SNAC
                                    PICTURE 9(2).
                       05  DCP-NUM-ANAC
                                    PICTURE 9(2).
                       05  DCP-NUM-MNAC
                                    PICTURE 9(2).
                       05  DCP-NUM-DNAC
                                    PICTURE 9(2).
      *                             CODIGO DEL PAIS DE LA NACIONALIDAD
                   04  DCP-COD-PNAC PICTURE X(3).
      *                             INDICADOR DE SEXO
                   04  DCP-IND-SEXO PICTURE X(1).
      *                             INDICADOR DE ESTADO CIVIL
                   04  DCP-IND-ECIV PICTURE X(3).
      *                             CEDULA DE IDENTIDAD
                   04  DCP-NUM-CIDE PICTURE X(8).
      *                             DIGITO VERIFICADOR CEDULA IDENTIDAD
                   04  DCP-VRF-CIDE PICTURE X(1).
      *                             GABINETE CEDULA DE IDENTIDAD
                   04  DCP-GLS-GABI PICTURE X(12).
      *                             CODIGO TIPO BANCA
                   04  DCP-COD-TBAN PICTURE X(3).
      *                             INDICADOR NIVEL EDUCACIONAL
                   04  DCP-IND-NEDU PICTURE X(3).
      *                             CODIGO DE ACTIVIDAD SECUNDARIA
                   04  DCP-COD-ACTS PICTURE X(9).
      *                             CODIGO DE PROFESION
                   04  DCP-COD-PROF PICTURE X(5).
      *                             INDICADOR DE SITUACION LABORAL
                   04  DCP-IND-SLAB PICTURE X(3).
      *                             CODIGO CATEGORIA SOCIOECONOMICA
                   04  DCP-COD-CSEC PICTURE X(2).
      *                             INDICADOR SITUACION CASA
                   04  DCP-IND-CASA PICTURE X(5).
      *                             # MSJ ASOC A NOMBRE DE PILA (SBT)
                   04  DCP-NUM-NMSG PICTURE 9(4).
      *                             INDICADOR REGIMEN CONYUGAL
                   04  DCP-IND-RCNY PICTURE X(1).
      *                             TIPO PLAN
                   04  DCP-COD-TPLN PICTURE X(1).
      *
       01  REG-RCD.
      *    COPYDD DGC-R-RCD.DGC-E-RCD00(PROD),01,D.
      *                             EQUIVALENTE AL REGISTRO RCD
           02  DGC-E-RCD00.
      *                             RELACION CLIENTE DIRECCIONES
               03  RCD.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RCD-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  RCD-KEY-IREG.
      *                             IDENTIFICACION RELACION CLIENTE DIRE
                       05  RCD-KEY-IRCD.
      *                             COD. INT. COMP. CLIENTE
                       06  RCD-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RCD-CAI-ICLI.
                       08  RCD-COD-TCLI
                                    PICTURE X(1).
                       08  RCD-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RCD-IIC-ICLI
                                    PICTURE X(8).
      *                             NUMERO DIRECCION
                       06  RCD-NUM-DIRE
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  RCD-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RCD-FEC-FTRN.
                       07  RCD-NUM-STRN
                                    PICTURE 9(2).
                       07  RCD-NUM-ATRN
                                    PICTURE 9(2).
                       07  RCD-NUM-MTRN
                                    PICTURE 9(2).
                       07  RCD-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RCD-HRA-HRTR.
                       07  RCD-NUM-HHTR
                                    PICTURE 9(2).
                       07  RCD-NUM-MMTR
                                    PICTURE 9(2).
                       07  RCD-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  RCD-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RCD-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  RCD-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RCD-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RCD-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  RCD-COD-ATRN PICTURE X(12).
      *                             TIPO DIRECCION
                   04  RCD-MSC-TDIR PICTURE X(1).
      *                             ESTADO DIRECCION ( MALA, VERIFICADA,
                   04  RCD-MSC-SDIR PICTURE X(1).
      *                             FECHA DE VERIFICACION
                   04  RCD-FEC-FVRF.
                       05  RCD-NUM-SVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-AVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-MVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-DVRF
                                    PICTURE 9(2).
      *                             RCM DESCRIPCION DE LA DIRECCION
                   04  RCD-GLS-DIRE PICTURE X(60).
      *                             RCM CODIGO DE LUGAR
                   04  RCD-COD-LUGA PICTURE X(4).
      *                             TELEFONO DE LA DIRECCION
                   04  RCD-GLS-FONO.
                       05  RCD-NUM-FONO
                                    PICTURE X(8).
                       05  RCD-NUM-ANXO
                                    PICTURE X(4).
      *                             CODIGO POSTAL
                   04  RCD-COD-POST PICTURE X(7).
      *                             DISPONIBLE
                   04  RCD-GLS-DISP PICTURE X(18).

      *
       01  REG-REC.
      *    COPYDD DGC-R-REC.DGC-E-REC00(PROD),01,D.
      *                             EQUIVALENTE AL REGISTRO REC
           02  DGC-E-REC00.
      *                             RELACIONES ENTRE CLIENTES
               03  REC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  REC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  REC-KEY-IREG.
      *                             IDENTIFICACION RELACION ENTRE CLIENT
                       05  REC-KEY-IREC.
      *                             KEY         COD. INT. COMP. CLIENTE
                       06  REC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  REC-CAI-ICLI.
                       08  REC-COD-TCLI
                                    PICTURE X(1).
                       08  REC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  REC-IIC-ICLI
                                    PICTURE X(8).
      *                             KEY         CODIGO TIPO RELACION ENT
                       06  REC-COD-TREC
                                    PICTURE X(2).
      *                             KEY         COD. INT. COMP. CLIENTE
                       06  REC-CIC-IREL.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  REC-CAI-IREL.
                       08  REC-COD-TREL
                                    PICTURE X(1).
                       08  REC-COD-CREL
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  REC-IIC-IREL
                                    PICTURE X(8).
      *                             KEY         NUM CORR SEGUN TIPO RELA
                       06  REC-NUM-TREC
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  REC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  REC-FEC-FTRN.
                       07  REC-NUM-STRN
                                    PICTURE 9(2).
                       07  REC-NUM-ATRN
                                    PICTURE 9(2).
                       07  REC-NUM-MTRN
                                    PICTURE 9(2).
                       07  REC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  REC-HRA-HRTR.
                       07  REC-NUM-HHTR
                                    PICTURE 9(2).
                       07  REC-NUM-MMTR
                                    PICTURE 9(2).
                       07  REC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  REC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  REC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  REC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  REC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  REC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  REC-COD-ATRN PICTURE X(12).
      *                             INDICADOR DE VIGENCIA RELACION (S/N)
                   04  REC-IND-VIGE PICTURE X(1).
      *                             OPR FECHA INICIO DE LA RELACION
                   04  REC-FEC-FINI.
                       05  REC-NUM-SINI
                                    PICTURE 9(2).
                       05  REC-NUM-AINI
                                    PICTURE 9(2).
                       05  REC-NUM-MINI
                                    PICTURE 9(2).
                       05  REC-NUM-DINI
                                    PICTURE 9(2).
      *                             OPR FECHA INICIO COMPUTACIONAL
                   04  REC-FEC-FINP.
                       05  REC-NUM-SINP
                                    PICTURE 9(2).
                       05  REC-NUM-AINP
                                    PICTURE 9(2).
                       05  REC-NUM-MINP
                                    PICTURE 9(2).
                       05  REC-NUM-DINP
                                    PICTURE 9(2).
      *                             OPR FECHA DE TERMINO DE LA RELACION
                   04  REC-FEC-FTER.
                       05  REC-NUM-STER
                                    PICTURE 9(2).
                       05  REC-NUM-ATER
                                    PICTURE 9(2).
                       05  REC-NUM-MTER
                                    PICTURE 9(2).
                       05  REC-NUM-DTER
                                    PICTURE 9(2).
      *                             OPR FECHA DE TERMINO COMPUTACIONAL
                   04  REC-FEC-FOUT.
                       05  REC-NUM-SOUT
                                    PICTURE 9(2).
                       05  REC-NUM-AOUT
                                    PICTURE 9(2).
                       05  REC-NUM-MOUT
                                    PICTURE 9(2).
                       05  REC-NUM-DOUT
                                    PICTURE 9(2).
      *                             RCM CODIGO ASOCIADO A LA RELACION
                   04  REC-COD-AREC PICTURE X(5).
      *                             VALOR ASOCIADO A LA RELACION
                   04  REC-SGV-AREC PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             OPR CODIGO DE VALOR ASOCIADO A LA RE
                   04  REC-COD-VCAM.
      *                             MISCELANEO TIPO VALOR
                       05  REC-MSC-TVAL
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       05  REC-COD-CVAL
                                    PICTURE X(3).
      *                             CODIGO TIPO CAMBIO
                       05  REC-COD-TCAM
                                    PICTURE X(2).
      *                             INF FECHA REFERENCIA VALOR ASOCIADO
                   04  REC-FEC-FVAL.
                       05  REC-NUM-SVAL
                                    PICTURE 9(2).
                       05  REC-NUM-AVAL
                                    PICTURE 9(2).
                       05  REC-NUM-MVAL
                                    PICTURE 9(2).
                       05  REC-NUM-DVAL
                                    PICTURE 9(2).
      *                             FECHA DE VERIFICACION
                   04  REC-FEC-FVRF.
                       05  REC-NUM-SVRF
                                    PICTURE 9(2).
                       05  REC-NUM-AVRF
                                    PICTURE 9(2).
                       05  REC-NUM-MVRF
                                    PICTURE 9(2).
                       05  REC-NUM-DVRF
                                    PICTURE 9(2).
      *                             DISPONIBLE
                   04  REC-GLS-DISP PICTURE X(29).
      *
      ******************************************************************
      *                 ELEMENT LIST                                   *
      ******************************************************************
      *
      *
       01  ELEM-LIST-DBC.
           03 ELEM-DBC             PIC X(05)  VALUE 'DBC00'.
           03 ELSE-DBC             PIC X(01).
           03 FILLER               PIC X(05)  VALUE SPACES.

       01  ELEM-LIST-DCP.
           03 ELEM-DCP             PIC X(05)  VALUE 'DCP00'.
           03 ELSE-DCP             PIC X(01).
           03 FILLER               PIC X(05)  VALUE SPACES.
      *
       01  ELEM-LIST-RCD.
           03 ELEM-RCD             PIC X(05)  VALUE 'RCD00'.
           03 ELSE-RCD             PIC X(01).
           03 FILLER               PIC X(05)  VALUE SPACES.
      *
       01  ELEM-LIST-REC.
           03 ELEM-REC             PIC X(05)  VALUE 'REC00'.
           03 ELSE-REC             PIC X(01).
           03 FILLER               PIC X(05)  VALUE SPACES.
      *------------------------------------------------------------*
      *
      *                   PROGRAMA PRINCIPAL                       *
      *------------------------------------------------------------*
       PROCEDURE DIVISION.
      *==================
           ENTRY 'DBMSCBL'.
       A-CONTROL SECTION.
           PERFORM B-INICIO.
       AB-PROCESAMIENTO.
           IF WA-ERROR = 0
              PERFORM C-PROCESAR
           END-IF.
       AC-TERMINACION.
           PERFORM D-TERMINAR.
       AZZ-FIN-DE-PROCESO.
           GOBACK.
      *
       B-INICIO SECTION.
      *-----------------
       BA-INICIO-PROC.
      *---------------
           PERFORM BA-ACEPTA-PARAMETROS.
           PERFORM BC-ABRIR-ARCHIVOS.
           PERFORM BF-TITULO2.
           GO TO BZ-FIN-SECCION.
      *
       BA-ACEPTA-PARAMETROS.
      *---------------------
           ACCEPT WS-HORA-N FROM TIME.
           ACCEPT WP-FECHA-ENTRADA.
           DISPLAY ' LA FECHA ES ' WP-FECHA-ENTRADA.
           IF WP-FPROC-SS IS NOT NUMERIC OR WP-FPROC-AA  IS NOT  NUMERIC
             OR WP-FPROC-MM IS NOT NUMERIC OR WP-FPROC-DD IS NOT NUMERIC
              DISPLAY '*** ERROR EN FECHA PROCESO ***'
              DISPLAY '*** FECHA PROCESO = ' WP-FECHA-PROCESO
              DISPLAY '*** SE ABORTA EL PROCESO ***'
              MOVE 100 TO RETURN-CODE
              GOBACK
           END-IF.
      *
       BC-ABRIR-ARCHIVOS.
      *------------------
           OPEN INPUT   AECPR01.
           IF FST-AECPR01 NOT = '00'
              DISPLAY ' '
              DISPLAY 'ERROR AL ABRIR ARCHIVO AECPR01. '
                      'FILE STATUS = ' FST-AECPR01
              DISPLAY 'PROGRAMA CANCELADO'
              DISPLAY ' '
              MOVE 100 TO RETURN-CODE
              GOBACK
           END-IF.
           OPEN OUTPUT ARCHERR.
           OPEN OUTPUT LSTCREG.

      *
       BF-TITULO2.
      *-----------
           MOVE ':'  TO PUNTO-1 PUNTO-2.
           MOVE WA-NUM-PAG   TO   L2-PAG.
           ACCEPT WS-FECHA-N FROM DATE.
           MOVE WS-DD    TO WS-DD-X.
           MOVE WS-MM    TO WS-MM-X.
           MOVE WS-AA    TO WS-AA-X.
           MOVE '-'      TO WS-F1-X.
           MOVE '-'      TO WS-F2-X.
           MOVE WS-FECHA-X TO L1-FECHA.
           WRITE FD-LSTCREG FROM  LINEA-01  AFTER PAGE.
           WRITE FD-LSTCREG FROM  LINEA-02  AFTER 1.
           WRITE FD-LSTCREG FROM  LINEA-03  AFTER 1.
           WRITE FD-LSTCREG FROM  LINEA-041 AFTER 1.
           WRITE FD-LSTCREG FROM  LINEA-07  AFTER 1.
           WRITE FD-LSTCREG FROM  LINEA-06  AFTER 1.
           WRITE FD-LSTCREG FROM  LINEA-07  AFTER 1.
      *
       BZ-FIN-SECCION.
      *---------------
           EXIT.
      *
       C-PROCESAR SECTION.
      *===================
       CA-CONTROL.
      *-----------
           PERFORM CB-PROCESA-AECPR.
           GO TO CZ-FIN-DE-SECCION.
      *
       CB-PROCESA-AECPR.
      *-------------------
           PERFORM CC-LEER-ARCH
           PERFORM CD-CICLO-LECTURA-ARCH UNTIL WS-FIN-ARCH = 1.

       CC-LEER-ARCH.
      *------------

           READ AECPR01.
           MOVE SPACES  TO WR-GLS-NOMC.
           MOVE SPACES  TO REG-ARCHERR.
           IF FST-AECPR01 NOT = '00' AND FST-AECPR01 NOT = '10'
              DISPLAY ' '
              DISPLAY 'ERROR AL LEER ARCHIVO AECPR01 '
                      'FILE STATUS = ' FST-AECPR01
              DISPLAY 'PROGRAMA CANCELADO'
              MOVE 100 TO RETURN-CODE
              MOVE 1   TO WA-ERROR
           END-IF.
           IF FST-AECPR01 = '10'
             MOVE 1 TO WS-FIN-ARCH
           END-IF.
      *
       CD-CICLO-LECTURA-ARCH.
      *---------------------
           ADD 1 TO WA-LEIDOS-ARCH.
           MOVE 0   TO WS-ACTUALIZ WS-CREADO.
           MOVE 'SI'             TO OK-OPE.
           MOVE 'SI'             TO OK-OPE-TOT.
           MOVE 'SI'             TO OK-PROC-REC.
           MOVE SPACES           TO AUX-RES.
           MOVE AEC-IDC-CLI      TO AUX-RUT.
           PERFORM CE-REGISTRA-DBC.
           PERFORM CF-REGISTRA-DCP.
           PERFORM CG-REGISTRA-RCD.
           PERFORM CH-REGISTRA-REC.
           IF OK-OPE-TOT = 'SI'
             PERFORM CI-LISTA-REG
             IF WS-ACTUALIZ = '1'
               ADD 1 TO WA-ACTUALIZ
             ELSE
               IF WS-CREADO = 1

               ADD 1 TO WA-CREADOS
             END-IF
           END-IF.
           PERFORM CC-LEER-ARCH.

       CE-REGISTRA-DBC.
      *----------------
      *    MOVE SPACES       TO REQ-CAI-ICLI-DBC.
      *    MOVE SPACES       TO REQ-KYVAL-DBC.
           MOVE AEC-CLI-CIC  TO REQ-KYVAL-DBC.
           MOVE 'DBC00 '     TO REQ-KYNAM-DBC
           PERFORM CEA-LEER-DBC.
           IF WS-EXITO-DBC = 'SI'
              MOVE 1   TO WS-ACTUALIZ
              PERFORM CEB-ACTUALIZA-DBC
           ELSE
                PERFORM CEC-CREA-DBC
                MOVE 1   TO WS-CREADO
           END-IF.
      *
       CF-REGISTRA-DCP.
      *----------------
           IF OK-OPE = 'SI'
             PERFORM CFA-LEER-DCP
             IF WS-EXITO-DCP = 'SI'
                PERFORM CFB-ACTUALIZA-DCP
             ELSE
                PERFORM CFC-CREA-DCP
             END-IF
           END-IF.
      *
       CG-REGISTRA-RCD.
      *----------------
           IF OK-OPE = 'SI'
            PERFORM CGA-LEER-RCD
            IF WS-EXITO-RCD = 'SI'
               PERFORM CGB-ACTUALIZA-RCD
            ELSE
               PERFORM CGC-CREA-RCD
            END-IF
           END-IF.
      *
      *
       CH-REGISTRA-REC.
      *----------------
           IF OK-OPE = 'SI'
             MOVE SPACES       TO REQ-RES-ICLI-DBC
             MOVE AEC-RUT-EMP  TO REQ-NUM-ICLI-DBC
             MOVE 'DBC02 '     TO REQ-KYNAM-DBC
             PERFORM CEA-LEER-DBC
             MOVE DBC-CIC-ICLI  TO WS-CIC-EMP
             MOVE AEC-CLI-CIC  TO WS-CIC-AUX
             IF WS-EXITO-DBC = 'SI'
               PERFORM CH-CONSULTA-CREA-REC
             END-IF
           END-IF.
      *
       CEA-LEER-DBC.
      *-------------
           MOVE 'REDKY' TO REQ-COMAN-DBC.
           MOVE 'READ'  TO ERR-SENTENCIA.

           PERFORM EJEC-COMAN-DBC.
      *
       CEB-ACTUALIZA-DBC.
      *-------------------
           MOVE 'RDUKY' TO REQ-COMAN-DBC ERR-SENTENCIA.
           PERFORM EJEC-COMAN-DBC.
           IF WS-EXITO-DBC = 'SI'
              PERFORM CEBA-MOVER-DATOS-DBC
              MOVE 'UPDAT' TO REQ-COMAN-DBC ERR-SENTENCIA
              PERFORM EJEC-COMAN-DBC
              IF WS-EXITO-DBC = 'SI'
                ADD 1 TO WA-ACTUALIZ-DBC
              ELSE
                MOVE 'RELES' TO REQ-COMAN-DBC
                PERFORM EJEC-COMAN-DBC
                MOVE 'NO' TO OK-OPE
                MOVE 'NO' TO OK-OPE-TOT
              END-IF
           ELSE
                MOVE 'RELES' TO REQ-COMAN-DBC
                PERFORM EJEC-COMAN-DBC
                MOVE 'NO' TO OK-OPE
                MOVE 'NO' TO OK-OPE-TOT
           END-IF.
      *
       CEBA-MOVER-DATOS-DBC.
      *--------------------
           MOVE WP-FECHA-PROCESO TO DBC-FEC-FTRN
           MOVE WS-HHH           TO DBC-NUM-HHTR
           MOVE WS-MMM           TO DBC-NUM-MMTR
           MOVE WS-SSS           TO DBC-NUM-SSTR
           MOVE 'I'              TO DBC-MSC-STAT
           MOVE 'I'              TO DBC-MSC-TACC
           MOVE 'SGCPBCCL'       TO DBC-COD-ATRN
           MOVE AEC-IDC-CLI      TO AUX-RUT
           MOVE SPACES           TO AUX-RES
           MOVE AUX-IDC          TO DBC-IDC-ICLI
           MOVE AEC-DIG-VER      TO DBC-VRF-ICLI
           MOVE AEC-APE-PTN      TO DBC-GLS-APAT
           MOVE AEC-APE-MTN      TO DBC-GLS-AMAT
           MOVE AEC-CLI-NOM      TO DBC-GLS-NOMB
           MOVE 1                TO DBC-NUM-DCOR
           MOVE AEC-CLI-IND      TO DBC-IND-TICL
           MOVE AEC-CLI-TIP      TO DBC-COD-TICL
           MOVE AEC-COD-EJE      TO DBC-COD-EJEC
           MOVE AEC-COD-OFI      TO DBC-COD-OFIC
           MOVE 'N'              TO DBC-IND-OOFI
           MOVE AEC-COD-ACV      TO DBC-COD-ACTI
           MOVE '121'            TO DBC-COD-ODSE
           MOVE  1               TO DBC-NUM-TDIR
           MOVE  0               TO DBC-NUM-TCMT
           MOVE 0                TO DBC-NUM-OFTN
           MOVE '00000000'       TO DBC-FEC-FTOP
           MOVE WP-FECHA-PROCESO TO DBC-FEC-FPLN
           MOVE WP-FECHA-PROCESO TO DBC-FEC-FIOP
           MOVE WP-FECHA-PROCESO TO DBC-FEC-FINP
           MOVE AEC-APE-PTN      TO WR-GLS-APAT
           MOVE AEC-APE-MTN      TO WR-GLS-AMAT
           MOVE AEC-CLI-NOM      TO WR-GLS-NOMB.
      *
       CEC-CREA-DBC.
      *--------------
            MOVE SPACES TO DBC.
            PERFORM CEBA-MOVER-DATOS-DBC.
            MOVE AEC-CLI-CIC TO DBC-CIC-ICLI.
            MOVE 'ADDIT' TO REQ-COMAN-DBC.
            MOVE 'INSERT' TO ERR-SENTENCIA.
            PERFORM EJEC-COMAN-DBC.
            IF WS-EXITO-DBC = 'NO'
             MOVE 'NO' TO OK-OPE
             MOVE 'NO' TO OK-OPE-TOT
            ELSE
              ADD  1 TO WA-CREADOS-DBC
            END-IF.
      *
       CFA-LEER-DCP.
      *-------------
           MOVE AEC-CLI-CIC  TO REQ-KYVAL-DCP.
           MOVE 'REDKY'      TO REQ-COMAN-DCP.
           MOVE 'READ'       TO ERR-SENTENCIA.
           PERFORM EJEC-COMAN-DCP.
      *
       CFB-ACTUALIZA-DCP.
      *-------------------
           MOVE 'RDUKY' TO REQ-COMAN-DCP.
           PERFORM EJEC-COMAN-DCP.
           IF WS-EXITO-DCP = 'SI'
              PERFORM CFBA-MOVER-DATOS-DCP
              MOVE 'UPDAT' TO REQ-COMAN-DCP ERR-SENTENCIA
              PERFORM EJEC-COMAN-DCP
              IF WS-EXITO-DCP = 'SI'
                ADD 1 TO WA-ACTUALIZ-DCP
              ELSE
                MOVE 'RELES' TO REQ-COMAN-DCP
                PERFORM EJEC-COMAN-DCP
                MOVE 'NO' TO OK-OPE
                MOVE 'NO' TO OK-OPE-TOT
              END-IF
           ELSE
                MOVE 'RELES' TO REQ-COMAN-DCP
                PERFORM EJEC-COMAN-DCP
                MOVE 'NO' TO OK-OPE
                MOVE 'NO' TO OK-OPE-TOT
           END-IF.
      *
       CFBA-MOVER-DATOS-DCP.
      *--------------------
           MOVE WP-FECHA-PROCESO TO DCP-FEC-FTRN
           MOVE WS-HHH           TO DCP-NUM-HHTR
           MOVE WS-MMM           TO DCP-NUM-MMTR
           MOVE WS-SSS           TO DCP-NUM-SSTR
           MOVE 'I'              TO DCP-MSC-STAT
           MOVE 'I'              TO DCP-MSC-TACC
           MOVE 'SGCPBCCL'       TO DCP-COD-ATRN
           MOVE AEC-FEC-NAC      TO WS-FEC-TND
           MOVE WS-AGNO-TND      TO WS-AGNO-NAC
           MOVE WS-MES-TND       TO WS-MES-NAC
           MOVE WS-DIA-TND       TO WS-DIA-NAC
           MOVE WS-FEC-NAC       TO DCP-FEC-FNAC
           MOVE '997'            TO DCP-COD-PNAC
           MOVE AEC-IND-SEX      TO DCP-IND-SEXO
           MOVE AEC-COD-ECV      TO DCP-IND-ECIV
           MOVE AUX-IDC          TO DCP-NUM-CIDE
           MOVE AEC-DIG-VER      TO DCP-VRF-CIDE
           MOVE AEC-TIP-BCA      TO DCP-COD-TBAN
           MOVE 0                TO DCP-NUM-NMSG
           MOVE AEC-REG-CNY      TO DCP-IND-RCNY
           MOVE AEC-COD-PLN      TO DCP-COD-TPLN.
      *
       CFC-CREA-DCP.
      *--------------
            MOVE SPACES TO DCP.
            PERFORM CFBA-MOVER-DATOS-DCP
      *     MOVE SPACES TO DCP-CAI-ICLI.
            MOVE AEC-CLI-CIC TO DCP-CIC-ICLI.
            MOVE 'ADDIT' TO REQ-COMAN-DCP.
            MOVE 'INSERT' TO ERR-SENTENCIA.
            PERFORM EJEC-COMAN-DCP.
            IF WS-EXITO-DCP = 'NO'
             MOVE 'NO' TO OK-OPE
             MOVE 'NO' TO OK-OPE-TOT
            ELSE
              ADD  1 TO WA-CREADOS-DCP
            END-IF.
      *
       CGA-LEER-RCD.
      *-------------
           MOVE AEC-CLI-CIC  TO REQ-KYVAL-RCD.
           MOVE 1            TO REQ-NUM-DIRE.
           MOVE 'REDKY' TO REQ-COMAN-RCD.
           MOVE 'READ'  TO ERR-SENTENCIA.
           PERFORM EJEC-COMAN-RCD.
      *
       CGB-ACTUALIZA-RCD.
      *-------------------
           MOVE 'RDUKY' TO REQ-COMAN-RCD.
           MOVE 'BLOCK' TO ERR-SENTENCIA.

           PERFORM EJEC-COMAN-RCD.
           IF WS-EXITO-RCD = 'SI'
              PERFORM CGBA-MOVER-DATOS-RCD
              MOVE 'UPDAT' TO REQ-COMAN-RCD ERR-SENTENCIA
              PERFORM EJEC-COMAN-RCD
              IF WS-EXITO-RCD = 'SI'
                ADD 1  TO WA-ACTUALIZ-RCD
              ELSE
                MOVE 'RELES' TO REQ-COMAN-RCD
                PERFORM EJEC-COMAN-RCD
                MOVE 'NO'  TO OK-OPE
                MOVE 'NO'  TO OK-OPE-TOT
              END-IF
           ELSE
                MOVE 'RELES' TO REQ-COMAN-RCD
                PERFORM EJEC-COMAN-RCD
                MOVE 'NO'  TO OK-OPE
                MOVE 'NO'  TO OK-OPE-TOT
           END-IF.
      *
       CGBA-MOVER-DATOS-RCD.
      *--------------------
           MOVE WP-FECHA-PROCESO TO RCD-FEC-FTRN
           MOVE WS-HHH           TO RCD-NUM-HHTR
           MOVE WS-MMM           TO RCD-NUM-MMTR
           MOVE WS-SSS           TO RCD-NUM-SSTR
           MOVE 'I'              TO RCD-MSC-STAT
           MOVE 'I'              TO RCD-MSC-TACC
           MOVE 'SGCPBCCL'       TO RCD-COD-ATRN
           MOVE AEC-TIP-DIR      TO RCD-MSC-TDIR
           MOVE 'C'              TO RCD-MSC-SDIR
           MOVE AEC-FEC-VFC      TO WS-FEC-TND
           MOVE WS-AGNO-TND      TO WS-AGNO-VEN
           MOVE WS-MES-TND       TO WS-MES-VEN
           MOVE WS-DIA-TND       TO WS-DIA-VEN
           MOVE WS-FEC-VEN       TO RCD-FEC-FVRF
           MOVE AEC-DIR          TO RCD-GLS-DIRE
           MOVE ZEROS            TO RCD-GLS-FONO
           MOVE AEC-COD-LUG      TO RCD-COD-LUGA.
      *
       CGC-CREA-RCD.
      *-------------
            MOVE SPACES TO RCD.
            PERFORM CGBA-MOVER-DATOS-RCD.
      *     MOVE SPACES TO RCD-CAI-ICLI.
            MOVE AEC-CLI-CIC TO RCD-CIC-ICLI.
            MOVE 1           TO RCD-NUM-DIRE.
            MOVE 'ADDIT' TO REQ-COMAN-RCD.
            MOVE 'INSERT' TO ERR-SENTENCIA.

            PERFORM EJEC-COMAN-RCD.
            IF WS-EXITO-RCD = 'NO'
             MOVE 'NO' TO OK-OPE
             MOVE 'NO' TO OK-OPE-TOT
            ELSE
              ADD  1 TO WA-CREADOS-RCD
            END-IF.
      *
       CH-CONSULTA-CREA-REC.
      *--------------------
           PERFORM CH-BUS-CREA-EM.
           IF OK-PROC-REC = 'SI'
             PERFORM CH-BUS-CREA-FU
           END-IF.
           IF OK-PROC-REC = 'SI'
              PERFORM CH-BUS-CREA-PP
            END-IF.

      *
       CH-BUS-CREA-EM.
      *---------------
           MOVE 'EM'         TO REQ-COD-TREC
           PERFORM CH-LEER-REC
           IF WS-EXITO-REC = 'SI'
             PERFORM CH-ACTUALIZA-REC
           ELSE
             PERFORM CH-CREA-REC-EM
           END-IF.
      *
       CH-BUS-CREA-FU.
      *---------------
           MOVE 'FU'         TO REQ-COD-TREC
           PERFORM CH-LEER-REC
           IF WS-EXITO-REC = 'SI'
             PERFORM CH-ACTUALIZA-REC
           ELSE
             PERFORM CH-CREA-REC-FU
           END-IF.
      *
       CH-BUS-CREA-PP.
      *---------------
           MOVE 'PP'         TO REQ-COD-TREC
           PERFORM CH-LEER-REC
           IF WS-EXITO-REC = 'SI'
             PERFORM CH-ACTUALIZA-REC
           ELSE
             PERFORM CH-CREA-REC-PP
           END-IF.
      *
       CH-LEER-REC.
      *-------------
      *    MOVE SPACES       TO REQ-CAI-ICLI-REC
           MOVE AEC-CLI-CIC  TO REQ-CIC-ICLI-REC
           MOVE WS-CIC-EMP   TO REQ-CIC-IREL
           MOVE 99           TO REQ-NUM-TREC
           MOVE 'REDKY' TO REQ-COMAN-REC.
           MOVE 'READ' TO ERR-SENTENCIA
           PERFORM EJEC-COMAN-REC.
      *
       CH-MOVER-DATOS-REC.
      *--------------------
           MOVE WP-FECHA-PROCESO TO REC-FEC-FTRN
           MOVE WS-HHH           TO REC-NUM-HHTR
           MOVE WS-MMM           TO REC-NUM-MMTR
           MOVE WS-SSS           TO REC-NUM-SSTR
           MOVE 'I'              TO REC-MSC-STAT
           MOVE 'I'              TO REC-MSC-TACC
           MOVE 'SGCPBCCL'       TO REC-COD-ATRN
           MOVE 'S'              TO REC-IND-VIGE
           MOVE WP-FECHA-PROCESO TO REC-FEC-FINI
           MOVE ZEROES           TO REC-FEC-FINP
           MOVE ZEROES           TO REC-FEC-FTER
           MOVE ZEROES           TO REC-FEC-FOUT
           MOVE SPACES           TO REC-COD-AREC
           MOVE ZEROES           TO REC-SGV-AREC
           MOVE SPACES           TO REC-COD-VCAM
           MOVE ZEROES           TO REC-FEC-FVAL
      *    MOVE WS-CIC-AUX       TO REC-CIC-ICLI
           MOVE WS-CIC-EMP       TO REC-CIC-IREL
           MOVE 99               TO REC-NUM-TREC.
      *
       CH-CREA-REC-EM.
      *---------------
            MOVE SPACES TO REC.
            PERFORM CH-MOVER-DATOS-REC.
            MOVE 'EM'    TO REC-COD-TREC.
      *     MOVE SPACES TO      REC-CAI-ICLI.
            MOVE AEC-CLI-CIC TO REC-CIC-ICLI.
            MOVE 'ADDIT' TO REQ-COMAN-REC.
            PERFORM EJEC-COMAN-REC.
            IF WS-EXITO-REC = 'NO'
             MOVE 'NO' TO OK-OPE
             MOVE 'NO' TO OK-OPE-TOT
             MOVE 'NO' TO OK-PROC-REC
            ELSE
             ADD   1    TO WA-CREADOS-REC
            END-IF.

       CH-CREA-REC-FU.
      *---------------
            MOVE SPACES    TO REC.
            PERFORM CH-MOVER-DATOS-REC.
            MOVE 'FU'    TO REC-COD-TREC.
            MOVE AEC-CLI-CIC TO REC-CIC-ICLI.
            MOVE 'ADDIT' TO REQ-COMAN-REC.
            PERFORM EJEC-COMAN-REC.
            IF WS-EXITO-REC = 'NO'
             MOVE 'NO' TO OK-OPE
             MOVE 'NO' TO OK-OPE-TOT
             MOVE 'NO' TO OK-PROC-REC
            END-IF.
      *
       CH-CREA-REC-PP.
      *---------------
            MOVE SPACES TO REC.
            MOVE SPACES TO      REC-CIC-ICLI.
            PERFORM CH-MOVER-DATOS-REC.
            MOVE 'PP'    TO REC-COD-TREC.
            MOVE AEC-CLI-CIC TO REC-CIC-ICLI.
            MOVE 'ADDIT' TO REQ-COMAN-REC.
            PERFORM EJEC-COMAN-REC.
            IF WS-EXITO-REC = 'NO'
             MOVE 'NO' TO OK-OPE
             MOVE 'NO' TO OK-OPE-TOT
             MOVE 'NO' TO OK-PROC-REC
            END-IF.
      *
       CH-ACTUALIZA-REC.
      *-------------------
           MOVE 'RDUKY' TO REQ-COMAN-REC.
           PERFORM EJEC-COMAN-REC.
           IF WS-EXITO-REC = 'SI'
              MOVE WP-FECHA-PROCESO TO REC-FEC-FTRN
              MOVE WS-HHH           TO REC-NUM-HHTR
              MOVE WS-MMM           TO REC-NUM-MMTR
              MOVE WS-SSS           TO REC-NUM-SSTR
              MOVE 'UPDAT' TO REQ-COMAN-REC
              PERFORM EJEC-COMAN-REC
              IF WS-EXITO-RCD = 'SI'
                ADD 1  TO WA-ACTUALIZ-REC
              ELSE
                MOVE 'RELES' TO REQ-COMAN-REC
                PERFORM EJEC-COMAN-REC
                MOVE 'NO'  TO OK-OPE
                MOVE 'NO'  TO OK-OPE-TOT
              END-IF
           ELSE
                MOVE 'RELES' TO REQ-COMAN-REC
                PERFORM EJEC-COMAN-REC
                MOVE 'NO'  TO OK-OPE
                MOVE 'NO'  TO OK-OPE-TOT
           END-IF.
      *
       CI-LISTA-REG.
      *-------------
           PERFORM COMPACTA-NOMBRE.
           MOVE  AEC-IDC-CLI  TO LINE-NRUT.
           MOVE  AEC-DIG-VER  TO LINE-DRUT.
           MOVE  WR-GLS-NOMC  TO LINE-NOM.
           MOVE  AEC-COD-OFI  TO LINE-OFI.
           MOVE  AEC-COD-EJE  TO LINE-EJE.
           WRITE FD-LSTCREG FROM  LINEA-DET2 AFTER 1.
      *
       EJEC-COMAN-DBC.
      *---------------
           CALL 'DBNTRY' USING UIB REQ-AREA-DBC REG-DBC ELEM-LIST-DBC.
           IF REQ-RTNCD-DBC  NOT = SPACES
             IF REQ-RTNCD-DBC   = '14'
                MOVE 'NO'   TO WS-EXITO-DBC
             ELSE
                MOVE 'DBC'            TO ERR-TABLA-PROG
                MOVE 'SIS'            TO ERR-TIPO
                MOVE REQ-KYVAL-DBC    TO ERR-KEY
                DISPLAY WS-BLANCO '* TABLA          : ' REQ-TBLNM-DBC
                DISPLAY WS-BLANCO '* CODIGO RETORNO : ' REQ-RTNCD-DBC
                DISPLAY WS-BLANCO '* CODIGO INTERNO : ' REQ-INRCD-DBC
                DISPLAY WS-BLANCO '* COMANDO        : ' REQ-COMAN-DBC
                DISPLAY WS-BLANCO '* CLAVE          : ' REQ-KYVAL-DBC
                MOVE REQ-RTNCD-DBC    TO ERR-ERRCODE
                MOVE REQ-INRCD-DBC    TO ERR-ERRINT
                PERFORM ERROR-BASES
                MOVE 'NO'   TO WS-EXITO-DBC
                MOVE 'NO'   TO OK-OPE
                MOVE 'NO'   TO OK-OPE-TOT
                MOVE 1 TO WA-ERROR
             END-IF
           ELSE
              MOVE 'SI'      TO WS-EXITO-DBC
           END-IF.
      *
       EJEC-COMAN-DCP.
      *---------------
           CALL 'DBNTRY' USING UIB REQ-AREA-DCP REG-DCP ELEM-LIST-DCP.
           IF REQ-RTNCD-DCP  NOT = SPACES
             IF REQ-RTNCD-DCP   = '14'
                MOVE 'NO'   TO WS-EXITO-DCP
             ELSE
                MOVE 'NO'   TO WS-EXITO-DCP
                MOVE 'DCP'            TO ERR-TABLA-PROG
                MOVE 'SIS'            TO ERR-TIPO
                MOVE REQ-COMAN-DCP  TO ERR-SENTENCIA
                MOVE REQ-KYVAL-DCP   TO ERR-KEY
                DISPLAY WS-BLANCO '* TABLA          : ' REQ-TBLNM-DCP
                DISPLAY WS-BLANCO '* CODIGO RETORNO : ' REQ-RTNCD-DCP
                DISPLAY WS-BLANCO '* CODIGO INTERNO : ' REQ-INRCD-DCP
                DISPLAY WS-BLANCO '* COMANDO        : ' REQ-COMAN-DCP
                DISPLAY WS-BLANCO '* CLAVE          : ' REQ-KYVAL-DCP
                MOVE REQ-RTNCD-DCP    TO ERR-ERRCODE
                MOVE REQ-INRCD-DCP    TO ERR-ERRINT
                PERFORM ERROR-BASES
                MOVE 1 TO WA-ERROR
             END-IF
           ELSE
              MOVE 'SI'      TO WS-EXITO-DCP
           END-IF.
      *
       EJEC-COMAN-RCD.
      *---------------
           CALL 'DBNTRY' USING UIB REQ-AREA-RCD REG-RCD ELEM-LIST-RCD.
           IF REQ-RTNCD-RCD  NOT = SPACES
             IF REQ-RTNCD-RCD   = '14'
                MOVE 'NO'  TO WS-EXITO-RCD
             ELSE
                MOVE 'SIS'            TO ERR-TIPO
                MOVE 'RCD'            TO ERR-TABLA-PROG

                MOVE REQ-KYVAL-RCD  TO ERR-KEY
                DISPLAY WS-BLANCO '* TABLA          : ' REQ-TBLNM-RCD
                DISPLAY WS-BLANCO '* CODIGO RETORNO : ' REQ-RTNCD-RCD
                DISPLAY WS-BLANCO '* CODIGO INTERNO : ' REQ-INRCD-RCD
                DISPLAY WS-BLANCO '* COMANDO        : ' REQ-COMAN-RCD
                DISPLAY WS-BLANCO '* CLAVE          : ' REQ-KYVAL-RCD
                MOVE REQ-RTNCD-RCD    TO ERR-ERRCODE
                MOVE REQ-INRCD-RCD    TO ERR-ERRINT
                PERFORM ERROR-BASES
                MOVE 1 TO WA-ERROR
             END-IF
           ELSE
              MOVE 'SI'      TO WS-EXITO-RCD
           END-IF.
      *
       EJEC-COMAN-REC.
      *---------------
           CALL 'DBNTRY' USING UIB REQ-AREA-REC REG-REC ELEM-LIST-REC.
           IF REQ-RTNCD-REC  NOT = SPACES
             IF REQ-RTNCD-REC   = '14'
                MOVE 'NO'  TO WS-EXITO-REC
             ELSE
                MOVE 'SIS'             TO ERR-TIPO
                MOVE REQ-KYVAL-REC     TO ERR-KEY
                MOVE 'REC'             TO ERR-TABLA-PROG
                DISPLAY WS-BLANCO '* TABLA          : ' REQ-TBLNM-REC
                DISPLAY WS-BLANCO '* CODIGO RETORNO : ' REQ-RTNCD-REC
                DISPLAY WS-BLANCO '* CODIGO INTERNO : ' REQ-INRCD-REC
                DISPLAY WS-BLANCO '* COMANDO        : ' REQ-COMAN-REC
                DISPLAY WS-BLANCO '* CLAVE          : ' REQ-KYVAL-REC
                MOVE REQ-RTNCD-REC    TO ERR-ERRCODE
                MOVE REQ-INRCD-REC    TO ERR-ERRINT
                PERFORM ERROR-BASES
                MOVE 1 TO WA-ERROR
             END-IF
           ELSE
              MOVE 'SI'      TO WS-EXITO-REC
           END-IF.
      *
      *EJEC-LOGCP.
      *---------------
      *    MOVE LOW-VALUES     TO REQ-AREA.
      *    MOVE 'LOGCP'        TO COMAN.
      *    CALL 'DBNTRY' USING UIB REQ-AREA.
      *
      *EJEC-ROLBK.
      *---------------
      *    MOVE LOW-VALUES     TO REQ-AREA.
      *    MOVE 'ROLBK'        TO COMAN.
      *    CALL 'DBNTRY' USING UIB REQ-AREA.
      *
       COMPACTA-NOMBRE.
      *-----------------
              MOVE WR-GLS-NOMC                     TO WR-CPT-STRN
              MOVE  1  TO WR-CPT-I WR-CPT-J
              MOVE 'N' TO WR-CPT-IBLK
              PERFORM LUP-CPT-BLKS UNTIL WR-CPT-J > WR-CPT-LENG
              IF WR-CPT-UBLK > ZEROES
               PERFORM BLK-CPT-BLKS UNTIL WR-CPT-UBLK > WR-CPT-LENG
              ELSE
                MOVE SPACES                       TO WR-CPT-STRN
              END-IF.
              MOVE WR-CPT-STRN                    TO  WR-GLS-NOMC.


       LUP-CPT-BLKS.
      *-------------
      *
           IF WR-CPT-STRN-RED(WR-CPT-J) > SPACES
               MOVE WR-CPT-STRN-RED(WR-CPT-J)   TO
                                               WR-CPT-STRN-RED(WR-CPT-I)
               ADD  1                           TO WR-CPT-I
               ADD  1                           TO WR-CPT-J
               MOVE 'S'                         TO WR-CPT-IBLK
           ELSE
               IF WR-CPT-PONGO-BLANCO
                  MOVE SPACES                   TO
                                               WR-CPT-STRN-RED(WR-CPT-I)
                  MOVE 'N'                      TO WR-CPT-IBLK
                  MOVE WR-CPT-I                 TO WR-CPT-UBLK
                  ADD  1                        TO WR-CPT-I
                  ADD  1                        TO WR-CPT-J
               ELSE
                  ADD  1                        TO WR-CPT-J
               END-IF
           END-IF.
      *
       BLK-CPT-BLKS.
      *-----------------
      *
           IF WR-CPT-UBLK NOT > WR-CPT-LENG
              MOVE SPACES                       TO
                                            WR-CPT-STRN-RED(WR-CPT-UBLK)
              ADD 1                             TO WR-CPT-UBLK
           END-IF.
      *
       ERROR-BASES.
      *------------
           IF ERR-SENTENCIA = 'READ'
              MOVE 'ERROR LECTURA' TO ERR-GLOSA
           ELSE
            IF ERR-SENTENCIA = 'UPDAT'
              MOVE 'ERROR ACTUALIZACION' TO ERR-GLOSA
            ELSE
            IF ERR-SENTENCIA = 'INSERT'
              MOVE 'ERROR  AGREGAR-REG' TO ERR-GLOSA
            ELSE
            IF ERR-SENTENCIA = 'BLOCK'
              MOVE 'ERROR BLOQUEAR REG' TO ERR-GLOSA

           END-IF.
           MOVE '/'                TO ERR-PAL-1 ERR-PAL-2
           MOVE 'SGC'              TO ERR-SISTEMA
           MOVE 'SGCPBCCL'         TO ERR-NOM-PGM
           MOVE WP-FPROC-SS        TO ERR-FEC-SS
           MOVE WP-FPROC-AA        TO ERR-FEC-AA
           MOVE WP-FPROC-MM        TO ERR-FEC-MM
           MOVE WP-FPROC-DD        TO ERR-FEC-DD
           MOVE WS-HHH             TO WS-HRA-HH
           MOVE WS-MMM             TO WS-HRA-MM
           MOVE WS-SSS             TO WS-HRA-SS
           MOVE R-WS-HORA          TO ERR-HORA
           WRITE REG-ARCHERR.
           DISPLAY ' REG ERROR : ' REG-ARCHERR.

      *
       CZ-FIN-DE-SECCION.
      *------------------
           EXIT.

      *
       D-TERMINAR SECTION.
      *------------------
       DA-CONTROL.
      *-----------
           PERFORM DB-TOTALES.
           PERFORM DC-CERRAR-ARCHIVOS.
           PERFORM DD-FIN-PROGRAMA.
           GO TO DZ-FIN-DE-SECCION.

       DB-TOTALES.
      *----------
           DISPLAY ' '.
           DISPLAY '==========================================='.
           DISPLAY ' '.
           DISPLAY '  ESTADISTICAS DE PROCESO PROGRAMA         '.
           DISPLAY ' '.
           DISPLAY '==========================================='.
           DISPLAY ' '.
           MOVE WA-LEIDOS-ARCH         TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS LEIDOS DE AECPR01..........: '
                     WA-MONTO-EDIT.
           DISPLAY ' '.
           MOVE WA-ACTUALIZ        TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS ACTUALIZADOS ...........: '
                     WA-MONTO-EDIT.
           MOVE WA-ACTUALIZ-DBC    TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS ACTUALIZADOS-DBC........: '
                     WA-MONTO-EDIT.
           MOVE WA-ACTUALIZ-DCP    TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS ACTUALIZADOS-DCP........: '
                     WA-MONTO-EDIT.
           MOVE WA-ACTUALIZ-RCD    TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS ACTUALIZADOS-RCD........: '
                     WA-MONTO-EDIT.
           MOVE WA-ACTUALIZ-REC    TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS ACTUALIZADOS-REC........: '
                     WA-MONTO-EDIT.
           MOVE WA-CREADOS-DBC    TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS CREADOS-DBC........: '
                     WA-MONTO-EDIT.
           MOVE WA-CREADOS-DCP    TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS CREADOS-DCP........: '
                     WA-MONTO-EDIT.
           MOVE WA-CREADOS-RCD    TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS CREADOS-RCD........: '
                     WA-MONTO-EDIT.
           MOVE WA-CREADOS-REC    TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS CREADOS-REC........: '
                     WA-MONTO-EDIT.
           MOVE WA-CREADOS         TO WA-MONTO-EDIT.
           DISPLAY ' REGISTROS CREADOS.................: '
                     WA-MONTO-EDIT.
           DISPLAY '==========================================='.

       DC-CERRAR-ARCHIVOS.
      *-------------------
           CLOSE AECPR01 .
           CLOSE ARCHERR .
           CLOSE LSTCREG .

       DD-FIN-PROGRAMA.
      *----------------
           DISPLAY ' '
           DISPLAY '+-------------------------------------------+'
           DISPLAY '+ MENSAJES PARA EL EXPLOTADOR               +'
           DISPLAY '+-------------------------------------------+'
           DISPLAY '+-------------------------------------------+'
           IF WA-ERROR = 1
              DISPLAY 'HAY MENSAJES PARA EL EXPLOTADOR'
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY ' '
           ELSE
              DISPLAY 'NO HAY MENSAJES PARA EL EXPLOTADOR'
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*** PROCESO TERMINO EN FORMA NORMAL'
           END-IF.

       DZ-FIN-DE-SECCION.
      *------------------
           EXIT.
