       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. SGCPNEG.
       AUTHOR.     RDELACUADRA.
      *REMARKS.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 15 DE ABRIL DE 1998                                    *
      ******************************************************************
000000*COMPILED SITE 2000          10.09.98
      *****************************************************************
      *                                                               *
      *  OBJETIVO :                                                   *
      *           - GENERACION MASIVA DE CLIENTE EN EL SISTEMA GENE-  *
      *             RAL DE CLIENTES.                                  *
      *  PARAMETROS:                                                  *
      *                                                               *
      *  INPUT    :                                                   *
      *                                                               *
      *         ARCLIEN  ARCHIVO SAM DE LARGE 200                     *
      *         -------  ARCHIVO QUE  TRAE    TODOS LOS CLIENTES      *
      *                  A GENERAR MASIVAMENTE.                       *
      *                                                               *
      *              CONTIENE 4 TIPOS DE REGISTROS EN QUE:            *
      *                                                               *
      *              TR-1  DATOS DEL CLIENTE.                         *
      *              TR-2  DATOS DE LA EMPRESA DONDE LABORA EL CLTE.  *
      *              TR-3  DATOS DEL CONYUGE (SOLO CLTES. CASADOS).   *
      *              TR-4  FLUJOS MENSUALES Y ESTADO DE SITUACION     *
      *                    PATRIMONIAL.                               *
      *                                                               *
      *             OFI 150 - TABLA DE OFICINAS                       *
      *             USR 150 - TABLA DE EJECUTIVOS                     *
      *             TAB 150 - 'COM' TABLA DE COMUNAS                  *
      *                     - 'ACT' TABLA DE CODIGO ACTIVIDAD         *
      *                     - 'PLN' TABLA TIPOS DE PLAN               *
      *             TAB 190 - 'PRF' TABLA DE PROFESIONES              *
      *                     - 'TCL' TABLA TIPOS DE CLIENTES           *
      *                                                               *
      *  INPUT-OUTPUT:                                                *
      *             CIC 180 - CODIGO  INTERNO COMPUTACIONAL           *
      *             DBC 100 - TABLA DATOS BASICOS CLIENTES            *
      *             DCC 100 - DATOS COMPLEMENTARION CLIENTES          *
      *             AEP 100 - ANTECEDENTES ESTADO PATRIMONIAL         *
      *             DCP 100 - DATOS COMPLEMENTARIOS PERSONAS          *
      *             REC 100 - RELACION ENTRE CLIENTES                 *
      *             RCD 100 - DIRECCIONES                             *
      *  OUTPUT   :                                                   *
      *             RPTEJEC - REPORTE DE ERRORES DEL PROCESO          *
      *                       Y ESTADISTICAS DE VALIDACION            *
      *                                                               *
      *  FECHA    : AGO/25, 1995                                      *
      *                                                               *
      * PROGRAMDOR: JUAN DE DIOS HERNANDEZ                            *
      * FECHA     : 15/01/96                                          *
      * CAMBIO    : - SE CORRIGE ACCESO A LA TABLA REC (REC-NUM-TREC) *
      *                                                               *
      *                                                               *
      * PROGRAMDOR: JUAN DE DIOS HERNANDEZ                            *
      * FECHA     : 18/01/96                                          *
      * CAMBIO    : - SE CORRIGIO "GO TO" EN PROCESO VALIDACION       *
      *            DE TIPO DE CLIENTES CO.                            *
      *                                                               *
      * PROGRAMDOR: ELIANA CONTRERAS HERNANDEZ                        *
      * FECHA     : 05/02/96                                          *
      * CAMBIO    : - SE MODIFICA EL QUE ACEPTE LOS VALORES EN        *
      *            BLANCO O ZEROS PARA :                              *
      *             - FECHA DE NACIMIENTO                             *
      *             - REGIMEN CONYUGAL                                *
      *             - INDICADOR DE SITUACION CONYUGAL                 *
      *             - INDICADOR DE NIVEL EDUCACIONAL                  *
      *               COMENTE WS-AEP-CLI = 'N' PARA QUE CREE AEP      *
      *               AEP-COD-VCAE = 'M$'                             *
      * PROGRAMADOR: ELIANA CONTRERAS HERNANDEZ                       *
      * FECHA     : 15/02/96                                          *
      * CAMBIO    : - SE MODIFICA CLAVE DE ACCESO A TABLA AEP         *
      * PROGRAMADOR: ELIANA CONTRERAS HERNANDEZ                       *
      * FECHA     : 21/03/96                                          *
      * CAMBIO    : - SE CORRIGE VALIDACION DE FECHA DE NACIMIENTO    *
      ******************************************************************
      * PROGRAMADOR: ELIANA CONTRERAS HERNANDEZ                       *
      * FECHA     : 06/04/96                                          *
      * CAMBIO    : - INCLUIR LISTADO DE RECHAZOS,    ADEMAS SE ELIMI-*
      *               TODO EL CODIGO QUE NO SE ESTA UTILIZANDO        *
      ******************************************************************
      ******************************************************************
      *      MANTENCIONES.
      *      ==============
      *
      *      PROGRAMADOR : FORMAT 2000 INC.
      *      FECHA       : 20.02.1998
      *      CAMBIO      : SE APLICA TECNICA WINDOWING PARA CONVERSION
      *                      2000 COMPLIANT.
      ******************************************************************
       ENVIRONMENT DIVISION.
      *=====================
           SKIP1
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
           C01 IS CANAL-1
           DECIMAL-POINT IS COMMA.
           SKIP1
      *
       INPUT-OUTPUT SECTION.
      *=====================
       FILE-CONTROL.

           SELECT RPTEJEC       ASSIGN TO RPTEJEC.
           SELECT ARCLIEN       ASSIGN TO ARCLIEN
                                FILE STATUS IS FS-ARCLIEN.
           SELECT LISTADO       ASSIGN TO LISTADO.

       DATA DIVISION.
      *==============
      *
       EJECT
       FILE SECTION.
      *=============

       FD  ARCLIEN
           RECORD CONTAINS 200 CHARACTERS
           BLOCK CONTAINS 0 RECORDS.

      *    DATOS DE ARCHIVO SAM PARA GENERACION DE CLIENTES
      *    ------------------------------------------------
      *
      *    NOMBRE ARCHIVO  :
      *    LARGO           : 200
      *    BLOQUEO         :
      *    Observaciones   :
      *
      *
      *---------------------------------------------------------------*
      *              DATOS BASICOS DEL CLIENTE
      *---------------------------------------------------------------*
      *
       01  TREG01.
      *        TIPO DE REGISTRO
           03  TR1-TIPO-REG                  PIC 9(01).
               88  TR1-DATOS-CLIENTE  VALUE 1.
      *
      *        RUT DEL CLIENTE
           03  TR1-RUT-CLIENTE.
               05  TR1-NUM-RUT-CLIENTE       PIC 9(08).
               05  TR1-NUM-RUT-CLIENTEX REDEFINES TR1-NUM-RUT-CLIENTE
                                             PIC X(08).
               05  TR1-DV-RUT-CLIENTE        PIC X(01).
      *
      *        NOMBRE DEL CLIENTE
           03  TR1-NOMBRE-CLIENTE.
               05  TR1-APAT-CLIENTE          PIC X(20).
               05  TR1-AMAT-CLIENTE          PIC X(20).
               05  TR1-NOMB-CLIENTE          PIC X(20).
      *
      *        TIPO CLIENTE
           03  TR1-TIPO-CLIENTE              PIC X(02).
      *
      *        TIPO BANCA
           03  TR1-TIPO-BANCA                PIC X(03).
      *
      *        COD EJECUTIVO
           03  TR1-COD-EJECUTIVO             PIC X(12).
      *
      *        OFICINA
           03  TR1-COD-OFIC                  PIC X(03).
      *
      *        FECHA DE NACIMIENTO DEL CLIENTE
           03  TR1-FECNAC-CLIENTE.
               05  TR1-FNAC-DD               PIC 9(02).
               05  TR1-FNAC-MM               PIC 9(02).
               05  TR1-FNAC-AA1              PIC 9(02).
               05  TR1-FNAC-AA2              PIC 9(02).
      *
      *        INDICADOR DE SEXO
           03  TR1-IND-SEXO                  PIC X(01).
               88  TR1-FEMENINO  VALUE 'F'.
               88  TR1-MASCULINO VALUE 'M'.
      *
      *        INDICADOR DE ESTADO CIVIL.
           03  TR1-IND-ECIVIL                PIC X(03).
               88  TR1-CASADO    VALUE 'CAS'.
               88  TR1-SOLTERO   VALUE 'SOL'.
               88  TR1-SEPARADO  VALUE 'SEP'.
               88  TR1-VIUDO     VALUE 'VIU'.
      *
      *        INDICADOR DE REGIMEN CONYUGAL
           03  TR1-IND-RCONYUGAL             PIC X(01).
               88  TR1-SOC-CONYUGAL-0  VALUE ' '.
               88  TR1-SOC-CONYUGAL    VALUE '1'.
               88  TR1-SEP-BIENES      VALUE '2'.
               88  TR1-PART-GANANCIA   VALUE '3'.
      *
      *        INDICADOR DE TIPO DE VIVIENDA
           03  TR1-IND-TVIVIENDA             PIC X(01).
               88  TR1-CASA      VALUE 'C'.
               88  TR1-DEPTO     VALUE 'D'.
      *
      *        INDICADOR DE SITUACION CASA
           03  TR1-IND-SIT-CASA              PIC X(05).
               88  TR1-ARR-MENOS-12-MESES     VALUE 'ARR1A'.
               88  TR1-ARR-DESDE-12A36        VALUE 'ARR2A'.
               88  TR1-ARR-MAS-36-MESES       VALUE 'ARR3A'.
               88  TR1-PROP-PAGA-DIVID        VALUE 'DIVID'.
               88  TR1-PROPIETARIO            VALUE 'PRPIA'.
               88  TR1-ARR-BLANCO             VALUE SPACES .
      *
      *        INDICADOR DE NIVEL EDUCACIONAL
           03  TR1-IND-NIV-EDUCACION         PIC X(03).
               88  TR1-BASICA        VALUE 'BAS'.
               88  TR1-MEDIA         VALUE 'MED'.
               88  TR1-PROFESIONAL   VALUE 'PRF'.
               88  TR1-TECNICA       VALUE 'TEC'.
               88  TR1-UNIVERSITARIA VALUE 'UNV'.
               88  TR1-NIV-EDUC-BLAN VALUE SPACES.
      *
      *        CODIGO DE PROFESION   (TABLA)
           03  TR1-COD-PROFESION             PIC X(05).
      *
      *        NUMERO DE CARGAS
           03  TR1-NRO-CARGAS                PIC 9(02).
           03  TR1-NRO-CARGASX REDEFINES TR1-NRO-CARGAS PIC X(02).
      *
      *        NUMERO DE HIJOS
           03  TR1-NRO-HIJOS                 PIC 9(02).
           03  TR1-NRO-HIJOSX REDEFINES TR1-NRO-HIJOS   PIC X(02).
      *
      *        DIRECCION DEL CLIENTE
           03  TR1-DIRECCION                 PIC X(50).
      *
      *        CODIGO DE COMUNA   (TABLA)
           03  TR1-COD-COMUNA                PIC X(04).
      *
      *        TELEFONO PARTICULAR DEL CLIENTE
           03  TR1-FONO                      PIC X(12).
      *
      *        ESPACIO DISPONIBLE
           03  TR1-FILLER                    PIC X(13).
      *
      *
       EJECT
      *---------------------------------------------------------------*
      *              DATOS DE LA EMPRESA DONDE LABORA EL CLIENTE
      *---------------------------------------------------------------*
      *
       01  TREG02.
      *
      *        TIPO DE REGISTRO
           03  TR2-TIPO-REG                  PIC 9(01).
               88  TR2-DATOS-LABORA-CLTE   VALUE 2.
      *
      *        RUT DE EMPRESA EN QUE TRABAJA EL CLIENTE
           03  TR2-RUT-EMPRESA.
               05  TR2-NUM-RUT-EMPRESA       PIC 9(08).
               05  TR2-NUM-RUT-EMPRESAX REDEFINES TR2-NUM-RUT-EMPRESA
                                             PIC X(08).
               05  TR2-DV-RUT-EMPRESA        PIC X(01).
      *
      *        RAZON SOCIAL DE LA EMPRESA
           03  TR2-RAZON-SOCIAL              PIC X(60).
      *
      *        DIRECCION LABORAL
           03  TR2-DIRECCION                 PIC X(50).
      *
      *        CODIGO DE COMUNA DIRECCION LABORAL  (TABLA)
           03  TR2-COD-COMUNA                PIC X(04).
      *
      *        TELEFONO DE LA EMPRESA DONDE TRABAJA EL CLIENTE
           03  TR2-FONO                      PIC X(12).
      *
      *        FECHA DE INGRESO A LA EMPRESA
           03  TR2-FECING-EMPRESA.
               05  TR2-FING-DD               PIC 9(02).
               05  TR2-FING-MM               PIC 9(02).
               05  TR2-FING-AA1              PIC 9(02).
               05  TR2-FING-AA2              PIC 9(02).
      *
      *        CODIGO DE ACTIVIDAD ECONOMICA   (TABLA)
           03  TR2-COD-ACTIVIDAD             PIC X(09).
      *
      *        ESPACIO DISPONIBLE
           03  TR2-FILLER                    PIC X(47).
      *
      *
      *
       EJECT
      *---------------------------------------------------------------*
      *              DATOS DEL CONYUGE DEL CLIENTE
      *---------------------------------------------------------------*
      *
       01  TREG03.
      *        TIPO DE REGISTRO
           03  TR3-TIPO-REG                  PIC 9(01).
               88  TR3-DATOS-CLIENTE  VALUE 3.
      *
      *        RUT CONYUGE DEL CLIENTE
           03  TR3-RUT-CONYUGE.
               05  TR3-NUM-RUT-CONYUGE       PIC 9(08).
               05  TR3-NUM-RUT-CONYUGEX REDEFINES TR3-NUM-RUT-CONYUGE
                                             PIC X(08).
               05  TR3-DV-RUT-CONYUGE        PIC X(01).
      *
      *        NOMBRE DEL CONYUGE
           03  TR3-NOMBRE-CONYUGE.
               05  TR3-APAT-CONYUGE          PIC X(20).
               05  TR3-AMAT-CONYUGE          PIC X(20).
               05  TR3-NOMB-CONYUGE          PIC X(20).
      *
      *        FECHA DE NACIMIENTO DEL CONYUGE
           03  TR3-FECNAC-CONYUGE.
               05  TR3-FNAC-DD       PIC 9(02).
               05  TR3-FNAC-MM       PIC 9(02).
               05  TR3-FNAC-AA1      PIC 9(02).
               05  TR3-FNAC-AA2      PIC 9(02).
      *
      *        INDICADOR DE SEXO DEL CONYUGE
           03  TR3-IND-SEXO               PIC X(01).
               88  TR3-FEMENINO  VALUE 'F'.
               88  TR3-MASCULINO VALUE 'M'.
      *
      *        INDICADOR DE NIVEL EDUCACIONAL DEL CONYUGE
           03  TR3-IND-NIV-EDUCACION         PIC X(03).
               88  TR3-BASICA        VALUE 'BAS'.
               88  TR3-MEDIA         VALUE 'MED'.
               88  TR3-PROFESIONAL   VALUE 'PRF'.
               88  TR3-TECNICA       VALUE 'TEC'.
               88  TR3-UNIVERSITARIA VALUE 'UNV'.
      *
      *        CODIGO DE PROFESION DEL CONYUGE   (TABLA)
           03  TR3-COD-PROFESION             PIC X(05).
      *
      *        DIRECCION DEL CONYUGE
           03  TR3-DIRECCION                 PIC X(50).
      *
      *        CODIGO DE COMUNA   (TABLA)
           03  TR3-COD-COMUNA                PIC X(04).
      *
      *        TELEFONO PARTICULAR DEL CONYUGE
           03  TR3-FONO                      PIC X(12).
      *
      *        ESPACIO DISPONIBLE
           03  TR3-FILLER                    PIC X(47).
      *
      *
      *
      *
       EJECT
      *
      *---------------------------------------------------------------*
      *   DATOS DE FLUJOS MENSUALES Y ESTADOS DE SITUACION PATRIMONIAL
      *---------------------------------------------------------------*
      *
       01  TREG04.
      *        TIPO DE REGISTRO
           03  TR4-TIPO-REG                  PIC 9(01).
               88  TR4-DATOS-SITUACION   VALUE 4.
      *
      *        RENTA LIQUIDA CLIENTE (PESOS)
           03  TR4-RENTA-LIQ-CLIENTE         PIC 9(09).
           03  TR4-RENTA-LIQ-CLIENTEX REDEFINES TR4-RENTA-LIQ-CLIENTE
                                             PIC X(09).
      *
      *        RENTA LIQUIDA CONYUGE (PESOS)
           03  TR4-RENTA-LIQ-CONYUGE         PIC 9(09).
           03  TR4-RENTA-LIQ-CONYUGEX REDEFINES TR4-RENTA-LIQ-CONYUGE
                                             PIC X(09).
      *
      *        OTROS INGRESOS CLIENTE (PESOS)
           03  TR4-OTROS-ING-CLIENTE         PIC 9(09).
           03  TR4-OTROS-ING-CLIENTEX REDEFINES TR4-OTROS-ING-CLIENTE
                                             PIC X(09).
      *
      *        PAGO DIVIDENDO MENSUAL (PESOS)
           03  TR4-DIVID-MENSUAL             PIC 9(09).
           03  TR4-DIVID-MENSUALX REDEFINES TR4-DIVID-MENSUAL
                                             PIC X(09).
      *
      *        PAGO ARRIENDO  (PESOS)
           03  TR4-ARRIENDO                  PIC 9(09).
           03  TR4-ARRIENDOX      REDEFINES TR4-ARRIENDO
                                             PIC X(09).
      *
      *        OTROS EGRESOS  (PESOS)
           03  TR4-OTROS-EGRESOS             PIC 9(09).
           03  TR4-OTROS-EGRESOSX REDEFINES TR4-OTROS-EGRESOS
                                             PIC X(09).
      *
      *        VEHICULOS VALOR TOTAL EN PESOS
           03  TR4-VEHICULOS                 PIC 9(09).
           03  TR4-VEHICULOSX     REDEFINES TR4-VEHICULOS
                                             PIC X(09).
      *
      *        PROPIEDADES VALOR TOTAL EN PESOS
           03  TR4-PROPIEDADES               PIC 9(09).
           03  TR4-PROPIEDADESX   REDEFINES TR4-PROPIEDADES
                                             PIC X(09).
      *
      *        OTROS ACTIVOS (VALOR TOTAL EN PESOS)
           03  TR4-OTROS-ACTIVOS             PIC 9(09).
           03  TR4-OTROS-ACTIVOSX REDEFINES TR4-OTROS-ACTIVOS
                                             PIC X(09).
      *
      *        DEUDAS BANCOS-FINANCIERAS (VALOR TOTAL EN PESOS)
           03  TR4-DEUDAS-BCO-FIN            PIC 9(09).
           03  TR4-DEUDAS-BCO-FINX REDEFINES TR4-DEUDAS-BCO-FIN
                                             PIC X(09).
      *
      *        CREDITOS HIPOTECARIOS (VALOR TOTAL EN PESOS)
           03  TR4-CRED-HIP                  PIC 9(09).
           03  TR4-CRED-HIPX       REDEFINES TR4-CRED-HIP
                                             PIC X(09).
      *
      *        OTRAS DEUDAS (VALOR TOTAL EN PESOS)
           03  TR4-OTRAS-DEUDAS              PIC 9(09).
           03  TR4-OTRAS-DEUDASX   REDEFINES TR4-OTRAS-DEUDAS
                                             PIC X(09).
      *
      *        ESPACIO DISPONIBLE
           03  TR4-FILLER                    PIC X(91).
      *
      ***************************************************************
      *
      *
       FD  RPTEJEC
           RECORDING MODE IS F
           LABEL RECORD OMITTED.
       01  REG-RPTEJEC.
           02 FILLER               PIC X(80).

       FD  LISTADO
           RECORDING MODE IS F
           LABEL RECORD OMITTED.
       01  R-LISTADO               PIC X(132).

       EJECT
       WORKING-STORAGE SECTION.
      *========================

       01  WS-PARAMETROS.
           03 WS-COD-OFIC          PIC X(03) VALUE SPACES.
           03 WS-COD-EJEC          PIC X(12) VALUE SPACES.
           03 WS-COD-TICL          PIC X(02) VALUE SPACES.
           03 WS-COD-TPLN          PIC X(12) VALUE SPACES.
       01  WS-CONTADORES.
           03 WS-LEI-DBC           PIC 9(06) VALUE 0.
           03 WS-TOLEI-DBC         PIC 9(06) VALUE 0.
           03 WS-LEI-RCO           PIC 9(06) VALUE 0.
           03 WS-LEI-OPE           PIC 9(06) VALUE 0.
           03 WS-ACT-OPE           PIC 9(06) VALUE 0.
           03 WS-NUM-ICIC          PIC 9(08) VALUE ZEROS.
           03 WS-NUM-ICIC-CLTE     PIC 9(08) VALUE ZEROS.
           03 WS-CAI-ICIC-CLTE     PIC X(04) VALUE SPACES.
           03 WS-CAI-ICLI-EMP      PIC X(04) VALUE SPACES.
           03 WS-IIC-ICLI-EMP      PIC X(08) VALUE SPACES.
           03 WS-COD-ACTIV         PIC X(09) VALUE SPACES.
           03 WS-COD-COMUNA        PIC X(04) VALUE SPACES.
           03 WS-COD-PROFESION     PIC X(05) VALUE SPACES.
           03 FS-ARCLIEN           PIC X(02) VALUE '00'.
           03 WS-FIN               PIC X(01) VALUE 'N'.
           03 WS-PRIMEREG          PIC X(01) VALUE 'S'.
           03 WS-VALIDO-COMUNA     PIC X(01) VALUE 'S'.
           03 WS-VALIDO-PROF       PIC X(01) VALUE 'S'.
           03 WS-VALIDO-ACTIV      PIC X(01) VALUE 'S'.
           03 WS-VALIDO            PIC X(01) VALUE 'S'.
           03 WS-AEP-CLI           PIC X(01) VALUE 'N'.
           03 WS-RCDE-CLI          PIC X(01) VALUE 'N'.


           03 WS-TOTCLI-LEIDOS      PIC 9(06) VALUE 0.
           03 WS-TOTCLI-CASADOS     PIC 9(06) VALUE 0.
           03 WS-TOTCONY-LEIDOS     PIC 9(06) VALUE 0.
           03 WS-TOTCLI-RECH        PIC 9(06) VALUE 0.
           03 WS-TOTCLI-GRADBC      PIC 9(06) VALUE 0.
           03 WS-TOTCLI-GRADBC-CAS  PIC 9(06) VALUE 0.
           03 WS-TOTCLI-GRADBC-OTR  PIC 9(06) VALUE 0.
           03 WS-TOTCLI-GRADCP      PIC 9(06) VALUE 0.
           03 WS-TOTCLI-GRAAEP      PIC 9(06) VALUE 0.
           03 WS-TOTCONY-GRADCC     PIC 9(06) VALUE 0.
           03 WS-TOTCLI-GRADCC      PIC 9(06) VALUE 0.
           03 WS-TOTGRA-RCD-CONY-D  PIC 9(06) VALUE 0.
           03 WS-TOTGRA-RCD-D       PIC 9(06) VALUE 0.
           03 WS-TOTGRA-RCD-E       PIC 9(06) VALUE 0.
           03 WS-TOTCONY-GRADBC     PIC 9(06) VALUE 0.
           03 WS-TOTCONY-GRADCP     PIC 9(06) VALUE 0.
           03 WS-TOTGRA-REC-CLI-EMP PIC 9(06) VALUE 0.
           03 WS-TOTGRA-REC-EMP-CLI PIC 9(06) VALUE 0.
           03 WS-TOTGRA-REC-CLI-CON PIC 9(06) VALUE 0.
           03 WS-TOTGRA-REC-CON-CLI PIC 9(06) VALUE 0.


       01  WS-VARIABLES.
           03 WS-RETURN-CODE       PIC X(02) VALUE '  '.
           03 WS-FEC-AMD.
              05 WS-ANO-AMD        PIC X(02).
              05 WS-MES-AMD        PIC X(02).
              05 WS-DIA-AMD        PIC X(02).
           03 WS-FEC-DMA.
              05 WS-DIA-DMA        PIC X(02).
              05 FILLER            PIC X(01) VALUE '/'.
              05 WS-MES-DMA        PIC X(02).
              05 FILLER            PIC X(01) VALUE '/'.
              05 WS-ANO-DMA        PIC X(02).
           03 WS-FEC-DMSA.
              05 WS-DIA-DMSA       PIC X(02).
              05 FILLER            PIC X(01) VALUE '/'.
              05 WS-MES-DMSA       PIC X(02).
              05 FILLER            PIC X(01) VALUE '/'.
              05 WS-SIGLO-DMSA     PIC X(02).
              05 WS-ANO-DMSA       PIC X(02).
           03 WS-FEC-FDAT.
              05 WS-NUM-SDAT       PIC 99 VALUE 19.
              05 WS-NUM-ADAT       PIC 99.
              05 WS-NUM-MDAT       PIC 99.
              05 WS-NUM-DDAT       PIC 99.
           03 WS-HORA.
              05 WS-HH             PIC 99.
              05 FILLER            PIC X.
              05 WS-MM             PIC 99.
              05 FILLER            PIC X.
              05 WS-SS             PIC 99.
           03 WS-HORA2.
              05 WS-HH2            PIC 99.
              05 WS-MM2            PIC 99.
              05 WS-SS2            PIC 99.
           03 CONT-LIN             PIC 99 VALUE 65.
           03 CONT-PAG             PIC 9(3) VALUE 1.
           03 WS-PROCESO-OK        PIC 9(1) VALUE 0.
           03 ER-MENSAJE    PIC X(30) VALUE SPACES.
           03 ER-PARRAFO    PIC X(20) VALUE SPACES.
           03 ER-ARCHIVO    PIC X(20) VALUE SPACES.
           03 ER-OPERACI    PIC X(20) VALUE SPACES.
           03 ER-SECCION    PIC X(20) VALUE SPACES.
           03 ER-FILE-ST    PIC X(10) VALUE SPACES.

       EJECT
      *---------------------------------------------------------------*
      *        WSS   DATOS BASICOS DEL CLIENTE
      *---------------------------------------------------------------*
      *
       01  WS-TREG01.
      *        TIPO DE REGISTRO
           03  WS-TR1-TIPO-REG                  PIC 9(01).
               88  WS-TR1-DATOS-CLIENTE  VALUE 1.
      *
      *        RUT DEL CLIENTE
           03  WS-TR1-RUT-CLIENTE.
               05  WS-TR1-NUM-RUT-CLIENTE       PIC 9(08).
               05  WS-TR1-NUM-RUT-CLIENTEX REDEFINES
                   WS-TR1-NUM-RUT-CLIENTE       PIC X(08).
               05  WS-TR1-DV-RUT-CLIENTE        PIC X(01).
      *
      *        NOMBRE DEL CLIENTE
           03  WS-TR1-NOMBRE-CLIENTE.
               05  WS-TR1-APAT-CLIENTE          PIC X(20).
               05  WS-TR1-AMAT-CLIENTE          PIC X(20).
               05  WS-TR1-NOMB-CLIENTE          PIC X(20).
      *
      *        TIPO CLIENTE
           03  WS-TR1-COD-TICL                 PIC X(02).
      *
      *        TIPO BANCA
           03  WS-TR1-TIPO-BANCA                PIC X(03).
      *
      *        COD EJECUTIVO
           03  WS-TR1-COD-EJEC                  PIC X(12).
      *
      *        OFICINA
           03  WS-TR1-COD-OFIC                  PIC X(03).
      *
      *        FECHA DE NACIMIENTO DEL CLIENTE
           03  WS-TR1-FECNAC-CLIENTE.
               05  WS-TR1-FNAC-DD               PIC 9(02).
               05  WS-TR1-FNAC-MM               PIC 9(02).
               05  WS-TR1-FNAC-AA1              PIC 9(02).
               05  WS-TR1-FNAC-AA2              PIC 9(02).
      *
      *        INDICADOR DE SEXO
           03  WS-TR1-IND-SEXO                  PIC X(01).
               88  WS-TR1-FEMENINO  VALUE 'F'.
               88  WS-TR1-MASCULINO VALUE 'M'.
      *
      *        INDICADOR DE ESTADO CIVIL.
           03  WS-TR1-IND-ECIVIL                PIC X(03).
               88  WS-TR1-CASADO    VALUE 'CAS'.
               88  WS-TR1-SOLTERO   VALUE 'SOL'.
               88  WS-TR1-SEPARADO  VALUE 'SEP'.
               88  WS-TR1-VIUDO     VALUE 'VIU'.
      *
      *        INDICADOR DE REGIMEN CONYUGAL
           03  WS-TR1-IND-RCONYUGAL             PIC X(01).
               88  WS-TR1-SOC-CONYUGAL-0  VALUE ' '.
               88  WS-TR1-SOC-CONYUGAL    VALUE '1'.
               88  WS-TR1-SEP-BIENES      VALUE '2'.
               88  WS-TR1-PART-GANANCIA   VALUE '3'.
      *
      *        INDICADOR DE TIPO DE VIVIENDA
           03  WS-TR1-IND-TVIVIENDA             PIC X(01).
               88  WS-TR1-CASA      VALUE 'C'.
               88  WS-TR1-DEPTO     VALUE 'D'.
      *
      *        INDICADOR DE SITUACION CASA
           03  WS-TR1-IND-SIT-CASA              PIC X(05).
               88  WS-TR1-ARR-MENOS-12-MESES     VALUE 'ARR1A'.
               88  WS-TR1-ARR-DESDE-12A36        VALUE 'ARR2A'.
               88  WS-TR1-ARR-MAS-36-MESES       VALUE 'ARR3A'.
               88  WS-TR1-PROP-PAGA-DIVID        VALUE 'DIVID'.
               88  WS-TR1-PROPIETARIO            VALUE 'PRPIA'.
               88  WS-TR1-ARR-BLANCO             VALUE SPACES.
      *
      *        INDICADOR DE NIVEL EDUCACIONAL
           03  WS-TR1-IND-NIV-EDUCACION         PIC X(03).
               88  WS-TR1-BASICA        VALUE 'BAS'.
               88  WS-TR1-MEDIA         VALUE 'MED'.
               88  WS-TR1-PROFESIONAL   VALUE 'PRF'.
               88  WS-TR1-TECNICA       VALUE 'TEC'.
               88  WS-TR1-UNIVERSITARIA VALUE 'UNV'.
               88  WS-TR1-NIV-EDUC-BLAN VALUE SPACES.
      *
      *        CODIGO DE PROFESION   (TABLA)
           03  WS-TR1-COD-PROFESION             PIC X(05).
      *
      *        NUMERO DE CARGAS
           03  WS-TR1-NRO-CARGAS                PIC 9(02).
           03  WS-TR1-NRO-CARGASX REDEFINES
               WS-TR1-NRO-CARGAS                PIC X(02).
      *
      *        NUMERO DE HIJOS
           03  WS-TR1-NRO-HIJOS                 PIC 9(02).
           03  WS-TR1-NRO-HIJOSX REDEFINES
               WS-TR1-NRO-HIJOS                 PIC X(02).
      *
      *        DIRECCION DEL CLIENTE
           03  WS-TR1-DIRECCION                 PIC X(50).
      *
      *        CODIGO DE COMUNA   (TABLA)
           03  WS-TR1-COD-COMUNA                PIC X(04).
      *
      *        TELEFONO PARTICULAR DEL CLIENTE
           03  WS-TR1-FONO                      PIC X(12).
      *
      *        ESPACIO DISPONIBLE
           03  WS-TR1-FILLER                    PIC X(33).
      *
      *
       EJECT
      *---------------------------------------------------------------*
      *        WSS   DATOS DE LA EMPRESA DONDE LABORA EL CLIENTE
      *---------------------------------------------------------------*
      *
       01  WS-TREG02.
      *
      *        TIPO DE REGISTRO
           03  WS-TR2-TIPO-REG                  PIC 9(01).
               88  WS-TR2-DATOS-LABORA-CLTE   VALUE 2.
      *
      *        RUT DE EMPRESA EN QUE TRABAJA EL CLIENTE
           03  WS-TR2-RUT-EMPRESA.
               05  WS-TR2-NUM-RUT-EMPRESA       PIC 9(08).
               05  WS-TR2-NUM-RUT-EMPRESAX REDEFINES
                   WS-TR2-NUM-RUT-EMPRESA       PIC X(08).
               05  WS-TR2-DV-RUT-EMPRESA        PIC X(01).
      *
      *        RAZON SOCIAL DE LA EMPRESA
           03  WS-TR2-RAZON-SOCIAL              PIC X(60).
      *
      *        DIRECCION LABORAL
           03  WS-TR2-DIRECCION                 PIC X(50).
      *
      *        CODIGO DE COMUNA DIRECCION LABORAL  (TABLA)
           03  WS-TR2-COD-COMUNA                PIC X(04).
      *
      *        TELEFONO DE LA EMPRESA DONDE TRABAJA EL CLIENTE
           03  WS-TR2-FONO                      PIC X(12).
      *
      *        FECHA DE INGRESO A LA EMPRESA
           03  WS-TR2-FECING-EMPRESA.
               05  WS-TR2-FING-DD               PIC 9(02).
               05  WS-TR2-FING-MM               PIC 9(02).
               05  WS-TR2-FING-AA1              PIC 9(02).
               05  WS-TR2-FING-AA2              PIC 9(02).
      *
      *        CODIGO DE ACTIVIDAD ECONOMICA   (TABLA)
           03  WS-TR2-COD-ACTIVIDAD             PIC X(09).
      *
      *        ESPACIO DISPONIBLE
           03  WS-TR2-FILLER                    PIC X(47).
      *
      *
      *
       EJECT
      *---------------------------------------------------------------*
      *         WSS  DATOS DEL CONYUGE DEL CLIENTE
      *---------------------------------------------------------------*
      *
       01  WS-TREG03.
      *        TIPO DE REGISTRO
           03  WS-TR3-TIPO-REG                  PIC 9(01).
               88  WS-TR3-DATOS-CLIENTE  VALUE 3.
      *
      *        RUT CONYUGE DEL CLIENTE
           03  WS-TR3-RUT-CONYUGE.
               05  WS-TR3-NUM-RUT-CONYUGE       PIC 9(08).
               05  WS-TR3-NUM-RUT-CONYUGEX REDEFINES
                   WS-TR3-NUM-RUT-CONYUGE       PIC X(08).
               05  WS-TR3-DV-RUT-CONYUGE        PIC X(01).
      *
      *        NOMBRE DEL CONYUGE
           03  WS-TR3-NOMBRE-CONYUGE.
               05  WS-TR3-APAT-CONYUGE          PIC X(20).
               05  WS-TR3-AMAT-CONYUGE          PIC X(20).
               05  WS-TR3-NOMB-CONYUGE          PIC X(20).
      *
      *        FECHA DE NACIMIENTO DEL CONYUGE
           03  WS-TR3-FECNAC-CONYUGE.
               05  WS-TR3-FNAC-DD       PIC 9(02).
               05  WS-TR3-FNAC-MM       PIC 9(02).
               05  WS-TR3-FNAC-AA1      PIC 9(02).
               05  WS-TR3-FNAC-AA2      PIC 9(02).
      *
      *        INDICADOR DE SEXO DEL CONYUGE
           03  WS-TR3-IND-SEXO          PIC X(01).
               88  WS-TR3-FEMENINO  VALUE 'F'.
               88  WS-TR3-MASCULINO VALUE 'M'.
      *
      *        INDICADOR DE NIVEL EDUCACIONAL DEL CONYUGE
           03  WS-TR3-IND-NIV-EDUCACION         PIC X(03).
               88  WS-TR3-BASICA        VALUE 'BAS'.
               88  WS-TR3-MEDIA         VALUE 'MED'.
               88  WS-TR3-PROFESIONAL   VALUE 'PRF'.
               88  WS-TR3-TECNICA       VALUE 'TEC'.
               88  WS-TR3-UNIVERSITARIA VALUE 'UNV'.
      *
      *        CODIGO DE PROFESION DEL CONYUGE   (TABLA)
           03  WS-TR3-COD-PROFESION             PIC X(05).
      *
      *        DIRECCION DEL CONYUGE
           03  WS-TR3-DIRECCION                 PIC X(50).
      *
      *        CODIGO DE COMUNA   (TABLA)
           03  WS-TR3-COD-COMUNA                PIC X(04).
      *
      *        TELEFONO PARTICULAR DEL CONYUGE
           03  WS-TR3-FONO                      PIC X(12).
      *
      *        ESPACIO DISPONIBLE
           03  WS-TR3-FILLER                    PIC X(47).
      *
      *
       EJECT
      *---------------------------------------------------------------*
      * WSSDATOS DE FLUJOS MENSUALES Y ESTADOS DE SITUACION PATRIMONIAL
      *---------------------------------------------------------------*
      *
       01  WS-TREG04.
      *        TIPO DE REGISTRO
           03  WS-TR4-TIPO-REG                  PIC 9(01).
               88  WS-TR4-DATOS-SITUACION   VALUE 4.
      *
      *        RENTA LIQUIDA CLIENTE (PESOS)
           03  WS-TR4-RENTA-LIQ-CLIENTE         PIC 9(09).
           03  WS-TR4-RENTA-LIQ-CLIENTEX REDEFINES
               WS-TR4-RENTA-LIQ-CLIENTE         PIC X(09).
      *
      *        RENTA LIQUIDA CONYUGE (PESOS)
           03  WS-TR4-RENTA-LIQ-CONYUGE         PIC 9(09).
           03  WS-TR4-RENTA-LIQ-CONYUGEX REDEFINES
               WS-TR4-RENTA-LIQ-CONYUGE         PIC X(09).
      *
      *        OTROS INGRESOS CLIENTE (PESOS)
           03  WS-TR4-OTROS-ING-CLIENTE         PIC 9(09).
           03  WS-TR4-OTROS-ING-CLIENTEX REDEFINES
               WS-TR4-OTROS-ING-CLIENTE         PIC X(09).
      *
      *        PAGO DIVIDENDO MENSUAL (PESOS)
           03  WS-TR4-DIVID-MENSUAL             PIC 9(09).
           03  WS-TR4-DIVID-MENSUALX REDEFINES
               WS-TR4-DIVID-MENSUAL             PIC X(09).
      *
      *        PAGO ARRIENDO  (PESOS)
           03  WS-TR4-ARRIENDO                  PIC 9(09).
           03  WS-TR4-ARRIENDOX REDEFINES
               WS-TR4-ARRIENDO                  PIC X(09).
      *
      *        OTROS EGRESOS  (PESOS)
           03  WS-TR4-OTROS-EGRESOS             PIC 9(09).
           03  WS-TR4-OTROS-EGRESOSX REDEFINES
               WS-TR4-OTROS-EGRESOS             PIC X(09).
      *
      *        VEHICULOS VALOR TOTAL EN PESOS
           03  WS-TR4-VEHICULOS                 PIC 9(09).
           03  WS-TR4-VEHICULOSX REDEFINES
               WS-TR4-VEHICULOS                 PIC X(09).
      *
      *        PROPIEDADES VALOR TOTAL EN PESOS
           03  WS-TR4-PROPIEDADES               PIC 9(09).
           03  WS-TR4-PROPIEDADESX REDEFINES
               WS-TR4-PROPIEDADES               PIC X(09).
      *
      *        OTROS ACTIVOS (VALOR TOTAL EN PESOS)
           03  WS-TR4-OTROS-ACTIVOS             PIC 9(09).
           03  WS-TR4-OTROS-ACTIVOSX REDEFINES
               WS-TR4-OTROS-ACTIVOS             PIC X(09).
      *
      *        DEUDAS BANCOS-FINANCIERAS (VALOR TOTAL EN PESOS)
           03  WS-TR4-DEUDAS-BCO-FIN            PIC 9(09).
           03  WS-TR4-DEUDAS-BCO-FINX REDEFINES
               WS-TR4-DEUDAS-BCO-FIN            PIC X(09).
      *
      *        CREDITOS HIPOTECARIOS (VALOR TOTAL EN PESOS)
           03  WS-TR4-CRED-HIP                  PIC 9(09).
           03  WS-TR4-CRED-HIPX REDEFINES
               WS-TR4-CRED-HIP                  PIC X(09).
      *
      *        OTRAS DEUDAS (VALOR TOTAL EN PESOS)
           03  WS-TR4-OTRAS-DEUDAS              PIC 9(09).
           03  WS-TR4-OTRAS-DEUDASX REDEFINES
               WS-TR4-OTRAS-DEUDAS              PIC X(09).
      *
      *        ESPACIO DISPONIBLE
           03  WS-TR4-FILLER                    PIC X(91).
      *
      ***************************************************************
      *
       EJECT

       01  RPT-T01.
           02 FILLER               PIC X(15) VALUE
              'B. C. I. '.
           02 FILLER               PIC X(43) VALUE
              'INFORME DEL PROCESO GENERACION DE CLIENTES '.
           02 FILLER               PIC X(08) VALUE SPACES.
           02 RPT-T01-FEC          PIC X(08) VALUE SPACES.

       01  RPT-T02.
           02 FILLER               PIC X(15) VALUE SPACES.
           02 FILLER               PIC X(42) VALUE ALL '='.

       01  RPT-D01.
           02 FILLER               PIC X(16) VALUE SPACES.
           02 RPT-D01-GLOS         PIC X(20).
           02 RPT-D01-OFIC         PIC X(03).

       01  RPT-D02.
           02 FILLER               PIC X(16) VALUE SPACES.
           02 RPT-D02-GLOS         PIC X(20).
           02 RPT-D02-EJEC         PIC X(12).

       01  RPT-D03.
           02 FILLER               PIC X(16) VALUE SPACES.
           02 RPT-D03-GLOS         PIC X(70).

       01  RPT-D04.
           02 FILLER               PIC X(16) VALUE SPACES.
           02 RPT-D04-GLOS         PIC X(34).
           02 RPT-D04-CANT         PIC ZZZ.ZZ9.

       01  RPT-TOT.
           02 FILLER               PIC X(16) VALUE SPACES.
           02 RPT-TOT-GLOS         PIC X(34).
           02 RPT-TOT-CAN          PIC ZZZ.ZZ9.

       01  L1.
           02 FILLER      PIC X(17)    VALUE ' BANCO DE CREDITO'.
           02 FILLER      PIC X(21)    VALUE SPACES.
           02 FILLER      PIC X(20)
                          VALUE 'LISTADO DE CLIENTES '.
           02 FILLER      PIC X(22)
                          VALUE 'RECHAZADOS          '.
           02 FILLER      PIC X(12)    VALUE SPACES.
           02 FILLER      PIC X(10)    VALUE 'PAGINA  : ' JUST.
           02 L1-PAG      PIC ZZ9.

       01  L2.
           02 FILLER      PIC X(15)    VALUE '  E INVERSIONES'.
           02 FILLER      PIC X(23)    VALUE SPACES.
           02 FILLER      PIC X(32)    VALUE ALL '='.
           02 FILLER      PIC X(22)    VALUE SPACES.
           02 FILLER      PIC X(10)    VALUE 'FECHA   : ' JUST.
           02 L2-FECHA    PIC X(10).

       01  L3.
           02 FILLER      PIC X(01)    VALUE ' '.
           02 FILLER      PIC X(16)    VALUE 'TIPO DE REGISTRO'.
           02 FILLER      PIC X(04)    VALUE SPACES.
           02 FILLER      PIC X(08)    VALUE 'RUT'.
           02 FILLER      PIC X(04)    VALUE SPACES.
           02 FILLER      PIC X(30)    VALUE ' MENSAJE'.
           02 FILLER      PIC X(04)    VALUE SPACES.
           02 FILLER      PIC X(20)    VALUE ' DATO  '.
           02 FILLER      PIC X(04)    VALUE SPACES.


       01  L4.
           02 FILLER      PIC X(09)    VALUE SPACES.
           02 L4-TIPO     PIC X(01).
           02 FILLER      PIC X(11)    VALUE SPACES.
           02 L4-RUT      PIC X(08).
           02 FILLER      PIC X(04)    VALUE SPACES.
           02 L4-MENSAJE  PIC X(30).
           02 FILLER      PIC X(04)    VALUE SPACES.
           02 L4-DATO     PIC X(20).
           02 FILLER      PIC X(04)    VALUE SPACES.
           02 L4-MENSAJE-2 PIC X(20).
           02 FILLER      PIC X(04)    VALUE SPACES.
           02 L4-DATO-2    PIC X(20).
           02 FILLER      PIC X(04)    VALUE SPACES.


       01  L5.
           02 FILLER      PIC X(132)   VALUE ALL '-'.

       EJECT
      ******************************************************************
      *      USER INFORMATION BLOCK                                    *
      ******************************************************************
      *
       01  UIB.
           05 FILLER               PIC X(32) VALUE 'SGCPNEG'.
      *
      ******************************************************************
      *        REQUEST AREA OFI                                        *
      ******************************************************************
      *
       01  REQ-AREA-OFI.
           02 REQ-CMD-OFI          PIC X(5).
           02 REQ-TBLNM-OFI        PIC X(3) VALUE SPACES.
           02 REQ-KEYNM-OFI        PIC X(5) VALUE SPACES.
           02 REQ-RETURN-CODE-OFI  PIC X(2) VALUE '  '.
           02 REQ-INT-RTN-CD-OFI   PIC X(1).
           02 REQ-DBID-OFI         PIC S9(4) COMP VALUE +150.
           02 REQ-TBLID-OFI        PIC X(7) VALUE SPACES.
           02 FILLER               PIC X(25).
           02 REQ-COUNT-MAX-OFI    PIC S9(4) COMP.
           02 REQ-IO-COUNT-OFI     PIC S9(4) COMP.
           02 FILLER               PIC X(22).
           02 REQ-KEY-VALUE-OFI.
              03 REQ-USR-TIPO-OFI  PIC X(03).
              03 REQ-USR-EJEC-OFI  PIC X(12).
           02 R-REQ-KEY-VALUE-OFI REDEFINES REQ-KEY-VALUE-OFI.
              03 REQ-OFI           PIC X(03).
              03 FILLER            PIC X(12).


      *
      ******************************************************************
      *        REQUEST AREA USR                                        *
      ******************************************************************
      *
       01  REQ-AREA-USR.
           02 REQ-CMD-USR          PIC X(5).
           02 REQ-TBLNM-USR        PIC X(3) VALUE SPACES.
           02 REQ-KEYNM-USR        PIC X(5) VALUE SPACES.
           02 REQ-RETURN-CODE-USR  PIC X(2) VALUE '  '.
           02 REQ-INT-RTN-CD-USR   PIC X(1).
           02 REQ-DBID-USR         PIC S9(4) COMP VALUE +150.
           02 REQ-TBLID-USR        PIC X(7) VALUE SPACES.
           02 FILLER               PIC X(25).
           02 REQ-COUNT-MAX-USR    PIC S9(4) COMP.
           02 REQ-IO-COUNT-USR     PIC S9(4) COMP.
           02 FILLER               PIC X(22).
           02 REQ-KEY-VALUE-USR.
              03 REQ-USR-TIPO-USR  PIC X(03).
              03 REQ-USR-EJEC-USR  PIC X(12).

      ******************************************************************
      *      REQUEST AREA  CIC                                         *
      ******************************************************************
      *
       01  REQ-CIC-AREA.
           02 REQ-CIC-CMD          PIC X(5).
           02 REQ-CIC-TBLNM        PIC X(3).
           02 REQ-CIC-KEYNM        PIC X(5).
           02 REQ-CIC-RETURN-CODE  PIC X(2) VALUE SPACES.
           02 REQ-CIC-INT-RTN-CD   PIC X(1).
           02 REQ-CIC-DBID         PIC S9(4) COMP VALUE +180.
           02 REQ-CIC-TBLID        PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-CIC-COUNT-MAX    PIC S9(4) COMP.
           02 REQ-CIC-IO-COUNT     PIC S9(4) COMP.
           02 FILLER               PIC X(22).
           02 REQ-CIC-KEY-VALUE    PIC X(04).

      *
      ******************************************************************
      *      REQUEST AREA  RCD                                         *
      ******************************************************************
      *
       01  REQ-RCD-AREA.
           02 REQ-RCD-CMD          PIC X(5).
           02 REQ-RCD-TBLNM        PIC X(3) VALUE 'RCD'.
           02 REQ-RCD-KEYNM        PIC X(5) VALUE 'RCD00'.
           02 REQ-RCD-RETURN-CODE  PIC X(2) VALUE '  '.
           02 REQ-RCD-INT-RTN-CD   PIC X(1).
           02 REQ-RCD-DBID         PIC S9(4) COMP VALUE +100.
           02 REQ-RCD-TBLID        PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-RCD-COUNT-MAX    PIC S9(4) COMP.
           02 REQ-RCD-IO-COUNT     PIC S9(4) COMP.
           02 FILLER               PIC X(22).
           02 REQ-RCD-KEY-VALUE    PIC X(14).
      *
      ******************************************************************
      *      REQUEST AREA  RCD    CONSULTA                             *
      ******************************************************************
      *
       01  REQ-RCDC-AREA.
           02 REQ-RCDC-CMD          PIC X(5).
           02 REQ-RCDC-TBLNM        PIC X(3) VALUE 'RCD'.
           02 REQ-RCDC-KEYNM        PIC X(5) VALUE 'RCD00'.
           02 REQ-RCDC-RETURN-CODE  PIC X(2) VALUE '  '.
           02 REQ-RCDC-INT-RTN-CD   PIC X(1).
           02 REQ-RCDC-DBID         PIC S9(4) COMP VALUE +100.
           02 REQ-RCDC-TBLID        PIC X(7).
           02 FILLER                PIC X(25).
           02 REQ-RCDC-COUNT-MAX    PIC S9(4) COMP.
           02 REQ-RCDC-IO-COUNT     PIC S9(4) COMP.
           02 FILLER                PIC X(22).
           02 REQ-RCDC-KEY-VALUE.
              05 REQ-RCDC-CAI-ICLI      PIC X(04).
              05 REQ-RCDC-IIC-ICLI      PIC X(08).
              05 REQ-RCDC-CORR          PIC X(02).
      *
      ******************************************************************
      *      REQUEST AREA  REC                                         *
      ******************************************************************
      *
       01  REQ-REC-AREA.
           02 REQ-REC-CMD          PIC X(5).
           02 REQ-REC-TBLNM        PIC X(3) VALUE 'REC'.
           02 REQ-REC-KEYNM        PIC X(5) VALUE 'REC00'.
           02 REQ-REC-RETURN-CODE  PIC X(2) VALUE '  '.
           02 REQ-REC-INT-RTN-CD   PIC X(1).
           02 REQ-REC-DBID         PIC S9(4) COMP VALUE +100.
           02 REQ-REC-TBLID        PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-REC-COUNT-MAX    PIC S9(4) COMP.
           02 REQ-REC-IO-COUNT     PIC S9(4) COMP.
           02 FILLER               PIC X(22).
           02 REQ-REC-KEY-VALUE.
              03 REQ-REC-KEY-COD-TCLI PIC X(01).
              03 REQ-REC-KEY-COD-CCLI PIC X(03).
              03 REQ-REC-KEY-IIC-ICLI PIC X(08).
              03 REQ-REC-KEY-COD-TREC PIC X(02).
              03 REQ-REC-KEY-COD-TREL PIC X(01).
              03 REQ-REC-KEY-COD-CREL PIC X(03).
              03 REQ-REC-KEY-IIC-IREL PIC X(08).
      *
      ******************************************************************
      *      REQUEST AREA  REC  CONSULTA                               *
      ******************************************************************
      *
       01  REQ-RECC-AREA.
           02 REQ-RECC-CMD          PIC X(5).
           02 REQ-RECC-TBLNM        PIC X(3) VALUE 'REC'.
           02 REQ-RECC-KEYNM        PIC X(5) VALUE 'REC00'.
           02 REQ-RECC-RETURN-CODE  PIC X(2) VALUE '  '.
           02 REQ-RECC-INT-RTN-CD   PIC X(1).
           02 REQ-RECC-DBID         PIC S9(4) COMP VALUE +100.
           02 REQ-RECC-TBLID        PIC X(7).
           02 FILLER                PIC X(25).
           02 REQ-RECC-COUNT-MAX    PIC S9(4) COMP.
           02 REQ-RECC-IO-COUNT     PIC S9(4) COMP.
           02 FILLER                PIC X(22).
           02 REQ-RECC-KEY-VALUE.
              03 REQ-RECC-CAI-ICIC  PIC X(04).
              03 REQ-RECC-NUM-ICIC  PIC X(08).
              03 REQ-RECC-TREL      PIC X(02).
              03 REQ-RECC-CAI-IREL  PIC X(04).
              03 REQ-RECC-NUM-IREL  PIC X(08).
              03 REQ-RECC-NUM-TREC  PIC X(02).
      *
      ******************************************************************
      *      REQUEST AREA  DBC                                         *
      ******************************************************************
      *
       01  REQ-DBC-AREA.
           02 REQ-DBC-CMD          PIC X(5).
           02 REQ-DBC-TBLNM        PIC X(3) VALUE 'DBC'.
           02 REQ-DBC-KEYNM        PIC X(5) VALUE 'DBC06'.
           02 REQ-DBC-RETURN-CODE  PIC X(2) VALUE '  '.
           02 REQ-DBC-INT-RTN-CD   PIC X(1).
           02 REQ-DBC-DBID         PIC S9(4) COMP VALUE +100.
           02 REQ-DBC-TBLID        PIC X(7).
           02 FILLER               PIC X(25).
           02 REQ-DBC-COUNT-MAX    PIC S9(4) COMP.
           02 REQ-DBC-IO-COUNT     PIC S9(4) COMP.
           02 FILLER               PIC X(22).
           02 REQ-DBC-KEY-VALUE    PIC X(12).
      *
      ******************************************************************
      *      REQUEST AREA  DBC-EMPRESA                                 *
      ******************************************************************
      *
       01  REQ-DBCE-AREA.
           02 REQ-DBCE-CMD          PIC X(5).
           02 REQ-DBCE-TBLNM        PIC X(3) VALUE 'DBC'.
           02 REQ-DBCE-KEYNM        PIC X(5) VALUE 'DBC02'.
           02 REQ-DBCE-RETURN-CODE  PIC X(2) VALUE '  '.
           02 REQ-DBCE-INT-RTN-CD   PIC X(1).
           02 REQ-DBCE-DBID         PIC S9(4) COMP VALUE +100.
           02 REQ-DBCE-TBLID        PIC X(7).
           02 FILLER                PIC X(25).
           02 REQ-DBCE-COUNT-MAX    PIC S9(4) COMP.
           02 REQ-DBCE-IO-COUNT     PIC S9(4) COMP.
           02 FILLER                PIC X(22).
           02 REQ-DBCE-KEY-VALUE    PIC X(12).
      *
      *
      ******************************************************************
      *      REQUEST AREA  DBC-CLIENTE RUT                             *
      ******************************************************************
      *
       01  REQ-DBCC-AREA.
           02 REQ-DBCC-CMD          PIC X(5).
           02 REQ-DBCC-TBLNM        PIC X(3) VALUE 'DBC'.
           02 REQ-DBCC-KEYNM        PIC X(5) VALUE 'DBC02'.
           02 REQ-DBCC-RETURN-CODE  PIC X(2) VALUE '  '.
           02 REQ-DBCC-INT-RTN-CD   PIC X(1).
           02 REQ-DBCC-DBID         PIC S9(4) COMP VALUE +100.
           02 REQ-DBCC-TBLID        PIC X(7).
           02 FILLER                PIC X(25).
           02 REQ-DBCC-COUNT-MAX    PIC S9(4) COMP.
           02 REQ-DBCC-IO-COUNT     PIC S9(4) COMP.
           02 FILLER                PIC X(22).
           02 REQ-DBCC-KEY-VALUE    PIC X(12).
      *
      ******************************************************************
      *      REQUEST AREA  DCC                                         *
      ******************************************************************
      *
       01  REQ-DCC-AREA.
           03 REQ-DCC-CMD              PIC X(5).
           03 REQ-DCC-TBLNM            PIC X(3).
           03 REQ-DCC-KEYNM            PIC X(5).
           03 REQ-DCC-RETURN-CODE      PIC X(2) VALUE SPACES.
           03 REQ-DCC-INT-RTN-CD       PIC X(1).
           03 REQ-DCC-DBID             PIC S9(4) COMP VALUE +100.
           03 REQ-DCC-TBLID            PIC X(7).
           03 FILLER                   PIC X(25).
           03 REQ-DCC-COUNT-MAX        PIC S9(4) COMP.
           03 REQ-DCC-IO-COUNT         PIC S9(4) COMP.
           03 FILLER                   PIC X(22).
           03 REQ-DCC-KEY-VALUE        PIC X(12).
      *
      ******************************************************************
      *      REQUEST AREA  DCC   CONSULTA                              *
      ******************************************************************
      *
       01  REQ-DCCC-AREA.
           03 REQ-DCCC-CMD              PIC X(5).
           03 REQ-DCCC-TBLNM            PIC X(3).
           03 REQ-DCCC-KEYNM            PIC X(5).
           03 REQ-DCCC-RETURN-CODE      PIC X(2) VALUE SPACES.
           03 REQ-DCCC-INT-RTN-CD       PIC X(1).
           03 REQ-DCCC-DBID             PIC S9(4) COMP VALUE +100.
           03 REQ-DCCC-TBLID            PIC X(7).
           03 FILLER                   PIC X(25).
           03 REQ-DCCC-COUNT-MAX        PIC S9(4) COMP.
           03 REQ-DCCC-IO-COUNT         PIC S9(4) COMP.
           03 FILLER                   PIC X(22).
           03 REQ-DCCC-KEY-VALUE.
              05 REQ-DCCC-CAI-ICLI      PIC X(04).
              05 REQ-DCCC-IIC-ICLI      PIC X(08).
      *
      ******************************************************************
      *      REQUEST AREA    DCP                                       *
      ******************************************************************
      *
       01  REQ-DCP-AREA.
           03 REQ-DCP-CMD              PIC X(5).
           03 REQ-DCP-TBLNM            PIC X(3).
           03 REQ-DCP-KEYNM            PIC X(5).
           03 REQ-DCP-RETURN-CODE      PIC X(2) VALUE SPACES.
           03 REQ-DCP-INT-RTN-CD       PIC X(1).
           03 REQ-DCP-DBID             PIC S9(4) COMP VALUE +100.
           03 REQ-DCP-TBLID            PIC X(7).
           03 FILLER                   PIC X(25).
           03 REQ-DCP-COUNT-MAX        PIC S9(4) COMP.
           03 REQ-DCP-IO-COUNT         PIC S9(4) COMP.
           03 FILLER                   PIC X(22).
           03 REQ-DCP-KEY-VALUE        PIC X(12).
      *
      *
      ******************************************************************
      *      REQUEST AREA    DCP CONSULTA-CLIENTE                      *
      ******************************************************************
      *
       01  REQ-DCPC-AREA.
           03 REQ-DCPC-CMD              PIC X(5).
           03 REQ-DCPC-TBLNM            PIC X(3).
           03 REQ-DCPC-KEYNM            PIC X(5).
           03 REQ-DCPC-RETURN-CODE      PIC X(2) VALUE SPACES.
           03 REQ-DCPC-INT-RTN-CD       PIC X(1).
           03 REQ-DCPC-DBID             PIC S9(4) COMP VALUE +100.
           03 REQ-DCPC-TBLID            PIC X(7).
           03 FILLER                    PIC X(25).
           03 REQ-DCPC-COUNT-MAX        PIC S9(4) COMP.
           03 REQ-DCPC-IO-COUNT         PIC S9(4) COMP.
           03 FILLER                    PIC X(22).
           03 REQ-DCPC-KEY-VALUE.
              05 REQ-DCPC-CAI-ICLI      PIC X(04).
              05 REQ-DCPC-IIC-ICLI      PIC X(08).
      *
      ******************************************************************
      *      REQUEST AREA    AEP                                       *
      ******************************************************************
      *
       01  REQ-AEP-AREA.
           03 REQ-AEP-CMD              PIC X(5).
           03 REQ-AEP-TBLNM            PIC X(3).
           03 REQ-AEP-KEYNM            PIC X(5).
           03 REQ-AEP-RETURN-CODE      PIC X(2) VALUE SPACES.
           03 REQ-AEP-INT-RTN-CD       PIC X(1).
           03 REQ-AEP-DBID             PIC S9(4) COMP VALUE +100.
           03 REQ-AEP-TBLID            PIC X(7).
           03 FILLER                   PIC X(25).
           03 REQ-AEP-COUNT-MAX        PIC S9(4) COMP.
           03 REQ-AEP-IO-COUNT         PIC S9(4) COMP.
           03 FILLER                   PIC X(22).
           03 REQ-AEP-KEY-VALUE.
              05 REQ-AEP-CIC-ICLI      PIC X(12).
              05 REQ-AEP-FEC-FAEP      PIC X(08).
      *
      ******************************************************************
      *      REQUEST AREA    AEP CONSULTA CLIENTE - CONYUGE            *
      ******************************************************************
      *
       01  REQ-AEPC-AREA.
           03 REQ-AEPC-CMD              PIC X(5).
           03 REQ-AEPC-TBLNM            PIC X(3).
           03 REQ-AEPC-KEYNM            PIC X(5).
           03 REQ-AEPC-RETURN-CODE      PIC X(2) VALUE SPACES.
           03 REQ-AEPC-INT-RTN-CD       PIC X(1).
           03 REQ-AEPC-DBID             PIC S9(4) COMP VALUE +100.
           03 REQ-AEPC-TBLID            PIC X(7).
           03 FILLER                    PIC X(25).
           03 REQ-AEPC-COUNT-MAX        PIC S9(4) COMP.
           03 REQ-AEPC-IO-COUNT         PIC S9(4) COMP.
           03 FILLER                    PIC X(22).
           03 REQ-AEPC-KEY-VALUE.
              05 REQ-AEPC-CAI-ICLI      PIC X(04).
              05 REQ-AEPC-IIC-ICLI      PIC X(08).
              05 REQ-AEPC-FEC-FAEP      PIC X(08).
      *
      ******************************************************************
      *      REQUEST AREA    TAB                                       *
      ******************************************************************
      *
       01  REQ-TAB-AREA.
           02 REQ-TAB-CMD                   PIC X(05).
           02 REQ-TAB-TABLE                 PIC X(03) VALUE 'TAB'.
           02 REQ-TAB-KEY                   PIC X(05).
           02 REQ-TAB-RTN-CODE              PIC X(02) VALUE SPACES.
           02 REQ-TAB-INT-RC                PIC X(01).
           02 REQ-TAB-DB-ID                 PIC S9(04) COMP VALUE +150.
           02 REQ-TAB-REC-ID                PIC X(07).
           02 FILLER                        PIC X(25).
           02 REQ-TAB-CONT-MAX              PIC S9(04) COMP.
           02 REQ-TAB-CONT-ID               PIC S9(04) COMP.
           02 FILLER                        PIC X(22).
           02 REQ-TAB-KEY-VALUE             PIC X(15).
           02 REQ-TAB-KEY-COMU REDEFINES REQ-TAB-KEY-VALUE.
              03 REQ-TAB-KEY-COM            PIC X(03).
              03 REQ-TAB-KEY-COMUNA         PIC X(12).

      ******************************************************************
      *      REQUEST AREA    TAB   PROFESION                           *
      ******************************************************************
      *
       01  REQ-TAB-AREA-PRF.
           02 REQ-TAB-CMD-PRF               PIC X(05) VALUE 'REDKX'.
           02 REQ-TAB-TABLE-PRF             PIC X(03) VALUE 'TAB'.
           02 REQ-TAB-KEY-PRF               PIC X(05) VALUE 'TAB00'.
           02 REQ-TAB-RTN-CODE-PRF          PIC X(02) VALUE SPACES.
           02 REQ-TAB-INT-RC-PRF            PIC X(01).
           02 REQ-TAB-DB-ID-PRF             PIC S9(04) COMP VALUE +190.
           02 REQ-TAB-REC-ID-PRF            PIC X(07).
           02 FILLER                        PIC X(25).
           02 REQ-TAB-CONT-MAX-PRF          PIC S9(04) COMP.
           02 REQ-TAB-CONT-ID-PRF           PIC S9(04) COMP.
           02 FILLER                        PIC X(22).
           02 REQ-TAB-KEY-VALUE-PRF.
              03 REQ-TAB-KEY-PROF           PIC X(03) VALUE 'PRF'.
              03 REQ-TAB-KEY-PROFESION      PIC X(12).

      ******************************************************************
      *      REQUEST AREA    TAB   ACTIVIDAD ECONOMICA                 *
      ******************************************************************
      *
       01  REQ-TAB-AREA-ACT.
           02 REQ-TAB-CMD-ACT               PIC X(05).
           02 REQ-TAB-TABLE-ACT             PIC X(03) VALUE 'TAB'.
           02 REQ-TAB-KEY-ACT               PIC X(05).
           02 REQ-TAB-RTN-CODE-ACT          PIC X(02) VALUE SPACES.
           02 REQ-TAB-INT-RC-ACT            PIC X(01).
           02 REQ-TAB-DB-ID-ACT             PIC S9(04) COMP VALUE +150.
           02 REQ-TAB-REC-ID-ACT            PIC X(07).
           02 FILLER                        PIC X(25).
           02 REQ-TAB-CONT-MAX-ACT          PIC S9(04) COMP.
           02 REQ-TAB-CONT-ID-ACT           PIC S9(04) COMP.
           02 FILLER                        PIC X(22).
           02 REQ-TAB-KEY-VALUE-ACT         PIC X(15).
           02 REQ-TAB-KEY-VACT REDEFINES REQ-TAB-KEY-VALUE-ACT.
              03 REQ-TAB-KEY-ACTI           PIC X(03).
              03 REQ-TAB-KEY-ACTIVIDAD      PIC X(12).

      ******************************************************************
      *      REQUEST AREA    TAB   TIPO DE CLIENTE       TCL           *
      ******************************************************************
      *
       01  REQ-TAB-AREA-TCL.
           02 REQ-TAB-CMD-TCL               PIC X(05).
           02 REQ-TAB-TABLE-TCL             PIC X(03) VALUE 'TAB'.
           02 REQ-TAB-KEY-TCL               PIC X(05).
           02 REQ-TAB-RTN-CODE-TCL          PIC X(02) VALUE SPACES.
           02 REQ-TAB-INT-RC-TCL            PIC X(01).
           02 REQ-TAB-DB-ID-TCL             PIC S9(04) COMP VALUE +190.
           02 REQ-TAB-REC-ID-TCL            PIC X(07).
           02 FILLER                        PIC X(25).
           02 REQ-TAB-CONT-MAX-TCL          PIC S9(04) COMP.
           02 REQ-TAB-CONT-ID-TCL           PIC S9(04) COMP.
           02 FILLER                        PIC X(22).
           02 REQ-TAB-KEY-VALUE-TCL         PIC X(15).
           02 REQ-TAB-KEY-VTCL REDEFINES REQ-TAB-KEY-VALUE-TCL.
              03 REQ-TAB-KEY-TCLI           PIC X(03).
              03 REQ-TAB-KEY-TCLIENTE       PIC X(12).


      ******************************************************************
      *      REQUEST AREA    TAB   TIPO DE PLAN          PLN           *
      ******************************************************************
      *
       01  REQ-TAB-AREA-PLN.
           02 REQ-TAB-CMD-PLN               PIC X(05).
           02 REQ-TAB-TABLE-PLN             PIC X(03) VALUE 'TAB'.
           02 REQ-TAB-KEY-PLN               PIC X(05).
           02 REQ-TAB-RTN-CODE-PLN          PIC X(02) VALUE SPACES.
           02 REQ-TAB-INT-RC-PLN            PIC X(01).
           02 REQ-TAB-DB-ID-PLN             PIC S9(04) COMP VALUE +150.
           02 REQ-TAB-REC-ID-PLN            PIC X(07).
           02 FILLER                        PIC X(25).
           02 REQ-TAB-CONT-MAX-PLN          PIC S9(04) COMP.
           02 REQ-TAB-CONT-ID-PLN           PIC S9(04) COMP.
           02 FILLER                        PIC X(22).
           02 REQ-TAB-KEY-VALUE-PLN         PIC X(15).
           02 REQ-TAB-KEY-VPLN REDEFINES REQ-TAB-KEY-VALUE-PLN.
              03 REQ-TAB-KEY-TPLN           PIC X(03).
              03 REQ-TAB-KEY-TIPOPLAN       PIC X(12).

       EJECT

      *    Registro Generico de Tablas
      *    ---------------------------
      *
      *    Nombre Registro : TAB
      *    Clave(s)        : TAB-COD-TABL(UU), TAB-STP-ITRN(UU),
      *                      TAB-CIC-TABL(UU), TAB-EXT-TABL(DC)
      *    Largo           : 194
      *    Bloqueo         : 2
      *    Observaciones   :
      *
       01  TAB.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  TAB-GLS-FLAG                             PIC X(01).
      *
      *    Clave Primaria Registro
           03  TAB-KEY-IREG.
      *
      *KEY     Tipo + Codigo ( LLave Primaria )
               05  TAB-COD-TABL.
      *
      *            Codigo Tipo Tabla
                   07  TAB-COD-TTAB                     PIC X(03).
      *
      *            Codigo Tabla
                   07  TAB-COD-CTAB                     PIC X(12).
      *
      *        Time Stamp Transaccion
               05  TAB-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  TAB-FEC-FTRN.
                       09  TAB-NUM-STRN                 PIC 9(02).
                       09  TAB-NUM-ATRN                 PIC 9(02).
                       09  TAB-NUM-MTRN                 PIC 9(02).
                       09  TAB-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  TAB-HRA-HRTR.
                       09  TAB-NUM-HHTR                 PIC 9(02).
                       09  TAB-NUM-MMTR                 PIC 9(02).
                       09  TAB-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  TAB-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  TAB-MSC-STAT                             PIC X(01).
      *
      *    Indicador Vigencia                           GNS VIGE
           03  TAB-IND-VIGE  REDEFINES  TAB-MSC-STAT    PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  TAB-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  TAB-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  TAB-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  TAB-COD-ATRN                             PIC X(12).
      *
      *KEY Tipo + Codigo ( Interno Computacional )
           03  TAB-CIC-TABL.
      *
      *        Codigo Tipo Tabla
               05  TAB-CIC-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  TAB-CIC-CTAB                         PIC X(12).
      *
      *    Codigo Externo
           03  TAB-EXT-TABL.
      *
      *        Codigo Tipo Tabla
               05  TAB-EXT-TTAB                         PIC X(03).
      *
      *        Codigo Tabla
               05  TAB-EXT-CTAB                         PIC X(05).
      *
      *    Descripcion Corta
           03  TAB-GLS-DCOR                             PIC X(12).
      *
      *    Abreviacion Descripcion
           03  TAB-GLS-ABRV                             PIC X(05).
      *
      *    Descripcion del Codigo
           03  TAB-GLS-DESC                             PIC X(40).
      *
      *    Datos Anexos
           03  TAB-GLS-DATA.
               05  TAB-GLS-DAT1.
                   07  TAB-COD-DAT1     OCCURS 10       PIC X(01).
               05  TAB-GLS-DAT2.
                   07  TAB-COD-DAT2     OCCURS 10       PIC X(02).
               05  TAB-GLS-DAT3.
                   07  TAB-COD-DAT3     OCCURS 10       PIC X(03).
      *
      *    Clave Soundex
           03  TAB-SNX-TABL.
               05  TAB-SNX-TTAB                         PIC X(03).
               05  TAB-SNX-CTAB                         PIC X(03).
      *
      *    Variables de Tablas
       01  TAB-VARI.
      *
      *    Codigo Sistema
           03  TAB-COD-SIST                             PIC X(03).
       EJECT
      ****  REGISTROS DE DATOS   **************************
      *
       01  REG-CIC.
      *    COPYDD GEN-R-CIC.GEN-E-CIC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO CIC
           02  GEN-E-CIC00.
      *                             CODIGO INTERNO COMPUTACIONAL
               03  CIC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CIC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  CIC-KEY-IREG.
      *                             IDENTIFICACION ENTIDAD
                       05  CIC-KEY-ICIC.
      *                             CODIGO INTERNO COMPUTACIONAL
                       06  CIC-CIC-ICIC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  CIC-CAI-ICIC.
                       08  CIC-COD-TCIC
                                    PICTURE X(1).
                       08  CIC-COD-CCIC
                                    PICTURE X(3).
      *                             IDENTIFICACION INTERNA COMPUTACIONAL
                       07  CIC-NUM-ICIC
                                    PICTURE 9(8).
                       07  CIC-IIC-ICIC
                             REDEFINES CIC-NUM-ICIC.
                       08  CIC-COD-OCIC.
                       09  CIC-COD-SCIC
                                    PICTURE X(2).
                       09  CIC-IND-SCIC
                                    PICTURE X(1).
                       08  CIC-GLS-NCIC
                                    PICTURE X(5).
      *                             TIME STAMP TRANSACCION
                       05  CIC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CIC-FEC-FTRN.
                       07  CIC-NUM-STRN
                                    PICTURE 9(2).
                       07  CIC-NUM-ATRN
                                    PICTURE 9(2).
                       07  CIC-NUM-MTRN
                                    PICTURE 9(2).
                       07  CIC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CIC-HRA-HRTR.
                       07  CIC-NUM-HHTR
                                    PICTURE 9(2).
                       07  CIC-NUM-MMTR
                                    PICTURE 9(2).
                       07  CIC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  CIC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CIC-MSC-STAT PICTURE X(1).
      *                             INDICADOR DE VIGENCIA CENTRO ASIGNAC
                   04  CIC-IND-VIGE
                             REDEFINES CIC-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  CIC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CIC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CIC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  CIC-COD-ATRN PICTURE X(12).
      *                             DISPONIBLE
                   04  CIC-GLS-DISP PICTURE X(3).
      *
       EJECT

       01  REG-DBC.
      *    COPYDD DGC-R-DBC.DGC-E-DBC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DBC
           02  DGC-E-DBC00.
      *                             DATOS BASICOS DEL CLIENTE
               03  DBC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DBC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DBC-KEY-IREG.
      *                             IDENTIFICACION DATOS BASICOS CLIENTE
                       05  DBC-KEY-IDBC.
      *                             COD. INT. COMP. CLIENTE
                       06  DBC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DBC-CAI-ICLI.
                       08  DBC-COD-TCLI
                                    PICTURE X(1).
                       08  DBC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DBC-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DBC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DBC-FEC-FTRN.
                       07  DBC-NUM-STRN
                                    PICTURE 9(2).
                       07  DBC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DBC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DBC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DBC-HRA-HRTR.
                       07  DBC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DBC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DBC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DBC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DBC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DBC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DBC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DBC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DBC-COD-ATRN PICTURE X(12).
      *                             KEY RUT CLIENTE + INDICADOR O CALIFI
                   04  DBC-IDC-ICLI.
      *                             RUT CLIENTE
                       05  DBC-NUM-ICLI
                                    PICTURE X(8).
      *                             INDICADOR TIPO RUT
                       05  DBC-IND-ICLI
                                    PICTURE X(1).
      *                             EXTENSION DEL RUT
                       05  DBC-GLS-ICLI
                                    PICTURE X(3).
      *                             KEY DIGITO VERIFICADOR DEL RUT
                   04  DBC-VRF-ICLI PICTURE X(1).
      *                             KEY NOMBRE CLIENTE GENERICO (PERSONA
                   04  DBC-GLS-NOMC.
                       05  DBC-GLS-APAT
                                    PICTURE X(25).
                       05  DBC-GLS-AMAT
                                    PICTURE X(25).
                       05  DBC-GLS-NOMB
                                    PICTURE X(25).
      *                             SOUNDEX DEL NOMBRE DE CLIENTE
                   04  DBC-SNX-NOMC.
                       05  DBC-SNX-APAT
                                    PICTURE X(3).
                       05  DBC-SNX-AMAT
                                    PICTURE X(3).
                       05  DBC-SNX-NOMB
                                    PICTURE X(3).
      *                             NUMERO DE DIRECCION DE ENVIO CORRESP
                   04  DBC-NUM-DCOR PICTURE 9(2).
      *                             OPR IND TIPO CLIENTE ( PERSONA O EMP
                   04  DBC-IND-TICL PICTURE X(1).
      *                             TIPO CLIENTE (POTENCIAL,NO CLIENTE,G
                   04  DBC-COD-TICL PICTURE X(2).
      *                             CODIGO CLASIFICACION COMERCIAL
                   04  DBC-COD-CLCM PICTURE X(2).
      *                             RCM CODIGO DEL EJECUTIVO ENCARGADO D
                   04  DBC-COD-EJEC PICTURE X(12).
      *                             OPR CODIGO DE OFICINA DONDE OPERA EL
                   04  DBC-COD-OFIC PICTURE X(3).
      *                             RCM INDICADOR SI OPERA EN OTRA OFICI
                   04  DBC-IND-OOFI PICTURE X(1).
      *                             EXT CODIGO ACTIVIDAD ECONOMICA
                   04  DBC-COD-ACTI PICTURE X(9).
      *                             EXT ORIGEN Y DESTINO SECT (COMP.INST
                   04  DBC-COD-ODSE PICTURE X(3).
      *                             INF FECHA INGRESO AL PLAN
                   04  DBC-FEC-FPLN.
                       05  DBC-NUM-SPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-APLN
                                    PICTURE 9(2).
                       05  DBC-NUM-MPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-DPLN
                                    PICTURE 9(2).
      *                             CODIGO DE SEGMENTO
                   04  DBC-COD-SETO PICTURE X(5).
      *                             PERIODO DE SEGMENTO (SSAAMM)
                   04  DBC-PDO-SETO PICTURE X(6).
      *                             INF INDICADOR DE MULTAS BANCO CENTRA
                   04  DBC-IND-MUBC PICTURE X(1).
      *                             INF INDICADOR DE JUICIOS BANCO CENTR
                   04  DBC-IND-JUBC PICTURE X(1).
      *                             EXT CODIGO ESTADO CLIENTE ( COMO DEU
                   04  DBC-MSC-SCLI PICTURE X(1).
      *                             FECHA ESTADO CLIENTE
                   04  DBC-FEC-FSCL.
                       05  DBC-NUM-SSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-ASCL
                                    PICTURE 9(2).
                       05  DBC-NUM-MSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-DSCL
                                    PICTURE 9(2).
      *                             CODIGO DE BLOQUEO DEL CLIENTE
                   04  DBC-COD-BLOC PICTURE X(2).
      *                             NUMERO TOTAL DE DIRECCIONES
                   04  DBC-NUM-TDIR PICTURE 9(2).
      *                             NUMERO TOTAL DE COMENTARIOS
                   04  DBC-NUM-TCMT PICTURE 9(3).
      *                             FECHA INICIO OPERACION
                   04  DBC-FEC-FIOP.
                       05  DBC-NUM-SIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-AIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DIOP
                                    PICTURE 9(2).
      *                             FECHA TERMINO OPERACION
                   04  DBC-FEC-FTOP.
                       05  DBC-NUM-STOP
                                    PICTURE 9(2).
                       05  DBC-NUM-ATOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MTOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DTOP
                                    PICTURE 9(2).
      *                             NUMERO OPERACIONES FECHA TERMINO NUL
                   04  DBC-NUM-OFTN PICTURE 9(3).
      *                             FECHA INGRESO DE DATOS A LA BASE DE
                   04  DBC-FEC-FINP.
                       05  DBC-NUM-SINP
                                    PICTURE 9(2).
                       05  DBC-NUM-AINP
                                    PICTURE 9(2).
                       05  DBC-NUM-MINP
                                    PICTURE 9(2).
                       05  DBC-NUM-DINP
                                    PICTURE 9(2).
      *
       EJECT

       01  REG-RCD.
      *    COPYDD DGC-R-RCD.DGC-E-RCD00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RCD
           02  DGC-E-RCD00.
      *                             RELACION CLIENTE DIRECCIONES
               03  RCD.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RCD-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  RCD-KEY-IREG.
      *                             IDENTIFICACION RELACION CLIENTE DIRE
                       05  RCD-KEY-IRCD.
      *                             COD. INT. COMP. CLIENTE
                       06  RCD-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RCD-CAI-ICLI.
                       08  RCD-COD-TCLI
                                    PICTURE X(1).
                       08  RCD-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RCD-IIC-ICLI
                                    PICTURE X(8).
      *                             NUMERO DIRECCION
                       06  RCD-NUM-DIRE
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  RCD-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RCD-FEC-FTRN.
                       07  RCD-NUM-STRN
                                    PICTURE 9(2).
                       07  RCD-NUM-ATRN
                                    PICTURE 9(2).
                       07  RCD-NUM-MTRN
                                    PICTURE 9(2).
                       07  RCD-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RCD-HRA-HRTR.
                       07  RCD-NUM-HHTR
                                    PICTURE 9(2).
                       07  RCD-NUM-MMTR
                                    PICTURE 9(2).
                       07  RCD-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  RCD-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RCD-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  RCD-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RCD-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RCD-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  RCD-COD-ATRN PICTURE X(12).
      *                             TIPO DIRECCION
                   04  RCD-MSC-TDIR PICTURE X(1).
      *                             ESTADO DIRECCION ( MALA, VERIFICADA,
                   04  RCD-MSC-SDIR PICTURE X(1).
      *                             FECHA DE VERIFICACION
                   04  RCD-FEC-FVRF.
                       05  RCD-NUM-SVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-AVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-MVRF
                                    PICTURE 9(2).
                       05  RCD-NUM-DVRF
                                    PICTURE 9(2).
      *                             RCM DESCRIPCION DE LA DIRECCION
                   04  RCD-GLS-DIRE PICTURE X(60).
      *                             RCM CODIGO DE LUGAR
                   04  RCD-COD-LUGA PICTURE X(4).
      *                             TELEFONO DE LA DIRECCION
                   04  RCD-GLS-FONO.
                       05  RCD-NUM-FONO
                                    PICTURE X(8).
                       05  RCD-NUM-ANXO
                                    PICTURE X(4).
      *                             CODIGO POSTAL
                   04  RCD-COD-POST PICTURE X(7).
      *                             DISPONIBLE
                   04  RCD-GLS-DISP PICTURE X(18).
      *
       EJECT

       01  REG-REC.
      *    COPYDD DGC-R-REC.DGC-E-REC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO REC
           02  DGC-E-REC00.
      *                             RELACIONES ENTRE CLIENTES
               03  REC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  REC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  REC-KEY-IREG.
      *                             IDENTIFICACION RELACION ENTRE CLIENT
                       05  REC-KEY-IREC.
      *                             KEY         COD. INT. COMP. CLIENTE
                       06  REC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  REC-CAI-ICLI.
                       08  REC-COD-TCLI
                                    PICTURE X(1).
                       08  REC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  REC-IIC-ICLI
                                    PICTURE X(8).
      *                             KEY         CODIGO TIPO RELACION ENT
                       06  REC-COD-TREC
                                    PICTURE X(2).
      *                             KEY         COD. INT. COMP. CLIENTE
                       06  REC-CIC-IREL.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  REC-CAI-IREL.
                       08  REC-COD-TREL
                                    PICTURE X(1).
                       08  REC-COD-CREL
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  REC-IIC-IREL
                                    PICTURE X(8).
      *                             KEY         NUM CORR SEGUN TIPO RELA
                       06  REC-NUM-TREC
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  REC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  REC-FEC-FTRN.
                       07  REC-NUM-STRN
                                    PICTURE 9(2).
                       07  REC-NUM-ATRN
                                    PICTURE 9(2).
                       07  REC-NUM-MTRN
                                    PICTURE 9(2).
                       07  REC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  REC-HRA-HRTR.
                       07  REC-NUM-HHTR
                                    PICTURE 9(2).
                       07  REC-NUM-MMTR
                                    PICTURE 9(2).
                       07  REC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  REC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  REC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  REC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  REC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  REC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  REC-COD-ATRN PICTURE X(12).
      *                             INDICADOR DE VIGENCIA RELACION (S/N)
                   04  REC-IND-VIGE PICTURE X(1).
      *                             OPR FECHA INICIO DE LA RELACION
                   04  REC-FEC-FINI.
                       05  REC-NUM-SINI
                                    PICTURE 9(2).
                       05  REC-NUM-AINI
                                    PICTURE 9(2).
                       05  REC-NUM-MINI
                                    PICTURE 9(2).
                       05  REC-NUM-DINI
                                    PICTURE 9(2).
      *                             OPR FECHA INICIO COMPUTACIONAL
                   04  REC-FEC-FINP.
                       05  REC-NUM-SINP
                                    PICTURE 9(2).
                       05  REC-NUM-AINP
                                    PICTURE 9(2).
                       05  REC-NUM-MINP
                                    PICTURE 9(2).
                       05  REC-NUM-DINP
                                    PICTURE 9(2).
      *                             OPR FECHA DE TERMINO DE LA RELACION
                   04  REC-FEC-FTER.
                       05  REC-NUM-STER
                                    PICTURE 9(2).
                       05  REC-NUM-ATER
                                    PICTURE 9(2).
                       05  REC-NUM-MTER
                                    PICTURE 9(2).
                       05  REC-NUM-DTER
                                    PICTURE 9(2).
      *                             OPR FECHA DE TERMINO COMPUTACIONAL
                   04  REC-FEC-FOUT.
                       05  REC-NUM-SOUT
                                    PICTURE 9(2).
                       05  REC-NUM-AOUT
                                    PICTURE 9(2).
                       05  REC-NUM-MOUT
                                    PICTURE 9(2).
                       05  REC-NUM-DOUT
                                    PICTURE 9(2).
      *                             RCM CODIGO ASOCIADO A LA RELACION
                   04  REC-COD-AREC PICTURE X(5).
      *                             VALOR ASOCIADO A LA RELACION
                   04  REC-SGV-AREC PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             OPR CODIGO DE VALOR ASOCIADO A LA RE
                   04  REC-COD-VCAM.
      *                             MISCELANEO TIPO VALOR
                       05  REC-MSC-TVAL
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       05  REC-COD-CVAL
                                    PICTURE X(3).
      *                             CODIGO TIPO CAMBIO
                       05  REC-COD-TCAM
                                    PICTURE X(2).
      *                             INF FECHA REFERENCIA VALOR ASOCIADO
                   04  REC-FEC-FVAL.
                       05  REC-NUM-SVAL
                                    PICTURE 9(2).
                       05  REC-NUM-AVAL
                                    PICTURE 9(2).
                       05  REC-NUM-MVAL
                                    PICTURE 9(2).
                       05  REC-NUM-DVAL
                                    PICTURE 9(2).
      *                             FECHA DE VERIFICACION
                   04  REC-FEC-FVRF.
                       05  REC-NUM-SVRF
                                    PICTURE 9(2).
                       05  REC-NUM-AVRF
                                    PICTURE 9(2).
                       05  REC-NUM-MVRF
                                    PICTURE 9(2).
                       05  REC-NUM-DVRF
                                    PICTURE 9(2).
      *                             DISPONIBLE
                   04  REC-GLS-DISP PICTURE X(29).
      *
       EJECT

       01  REG-DCC.
      *    COPYDD DGC-R-DCC.DGC-E-DCC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DCC
           02  DGC-E-DCC00.
      *                             NOMBRE REGISTRO : DCC
               03  DCC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DCC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DCC-KEY-IREG.
      *                             IDENTIFICACION INFORMES COMERCIALES
                       05  DCC-KEY-IDCC.
      *                             COD. INT. COMP. CLIENTE
                       06  DCC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DCC-CAI-ICLI.
                       08  DCC-COD-TCLI
                                    PICTURE X(1).
                       08  DCC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DCC-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DCC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DCC-FEC-FTRN.
                       07  DCC-NUM-STRN
                                    PICTURE 9(2).
                       07  DCC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DCC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DCC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DCC-HRA-HRTR.
                       07  DCC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DCC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DCC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DCC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DCC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DCC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DCC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DCC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DCC-COD-ATRN PICTURE X(12).
      *                             NRO TOTAL DOCTOS PROTESTADOS
                   04  DCC-NUM-TCHP PICTURE 9(3).
      *                             NRO TOTAL DOCTOS ACLARADOS
                   04  DCC-NUM-TCHA PICTURE 9(3).
      *                             INDICADOR PROTESTOS EN BOLETIN
                   04  DCC-IND-PBOL PICTURE X(1).
      *                             NRO UNIDADES PERIODO BLOQUEO CUENTAC
                   04  DCC-NUM-UPBC PICTURE 9(3).
      *                             UNIDAD TIEMPO PERIODO BLOQUEO CUENTA
                   04  DCC-IND-UTBC PICTURE X(1).
      *                             FECHA INICIO BLOQUEO CUENTACORRIENTE
                   04  DCC-FEC-FIBC.
                       05  DCC-NUM-SIBC
                                    PICTURE 9(2).
                       05  DCC-NUM-AIBC
                                    PICTURE 9(2).
                       05  DCC-NUM-MIBC
                                    PICTURE 9(2).
                       05  DCC-NUM-DIBC
                                    PICTURE 9(2).
      *                             NRO TOTAL DE DOCTOS. PROTESTADOS HIS
                   04  DCC-NUM-TDPH PICTURE 9(3).
      *                             NRO TOTAL DE DOCTOS. ACLARADOS HISTO
                   04  DCC-NUM-TDAH PICTURE 9(3).
      *                             CODIGO DE RECHAZO APERTURA CTA. CTE.
                   04  DCC-COD-RCHZ PICTURE X(1).
      *                             OFICINA INGRESO RECHAZO APERTURA CCT
                   04  DCC-COD-OFIR PICTURE X(3).
      *                             DISPONIBLE
                   04  DCC-GLS-DISP PICTURE X(18).
      *
       EJECT

       01  REG-DCP.
      *    COPYDD DGC-R-DCP.DGC-E-DCP00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DCP
           02  DGC-E-DCP00.
      *                             DATOS COMPLEMENTARIOS PERSONAS
               03  DCP.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DCP-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DCP-KEY-IREG.
      *                             ID DATOS COMPLEMENTARIOS PERSONAS
                       05  DCP-KEY-IDCP.
      *                             COD. INT. COMP. CLIENTE
                       06  DCP-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DCP-CAI-ICLI.
                       08  DCP-COD-TCLI
                                    PICTURE X(1).
                       08  DCP-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DCP-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DCP-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DCP-FEC-FTRN.
                       07  DCP-NUM-STRN
                                    PICTURE 9(2).
                       07  DCP-NUM-ATRN
                                    PICTURE 9(2).
                       07  DCP-NUM-MTRN
                                    PICTURE 9(2).
                       07  DCP-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DCP-HRA-HRTR.
                       07  DCP-NUM-HHTR
                                    PICTURE 9(2).
                       07  DCP-NUM-MMTR
                                    PICTURE 9(2).
                       07  DCP-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DCP-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DCP-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DCP-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DCP-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DCP-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DCP-COD-ATRN PICTURE X(12).
      *                             FECHA DE NACIMIENTO
                   04  DCP-FEC-FNAC.
                       05  DCP-NUM-SNAC
                                    PICTURE 9(2).
                       05  DCP-NUM-ANAC
                                    PICTURE 9(2).
                       05  DCP-NUM-MNAC
                                    PICTURE 9(2).
                       05  DCP-NUM-DNAC
                                    PICTURE 9(2).
      *                             CODIGO DEL PAIS DE LA NACIONALIDAD
                   04  DCP-COD-PNAC PICTURE X(3).
      *                             INDICADOR DE SEXO
                   04  DCP-IND-SEXO PICTURE X(1).
      *                             INDICADOR DE ESTADO CIVIL
                   04  DCP-IND-ECIV PICTURE X(3).
      *                             CEDULA DE IDENTIDAD
                   04  DCP-NUM-CIDE PICTURE X(8).
      *                             DIGITO VERIFICADOR CEDULA IDENTIDAD
                   04  DCP-VRF-CIDE PICTURE X(1).
      *                             GABINETE CEDULA DE IDENTIDAD
                   04  DCP-GLS-GABI PICTURE X(12).
      *                             CODIGO TIPO BANCA
                   04  DCP-COD-TBAN PICTURE X(3).
      *                             INDICADOR NIVEL EDUCACIONAL
                   04  DCP-IND-NEDU PICTURE X(3).
      *                             CODIGO DE ACTIVIDAD SECUNDARIA
                   04  DCP-COD-ACTS PICTURE X(9).
      *                             CODIGO DE PROFESION
                   04  DCP-COD-PROF PICTURE X(5).
      *                             INDICADOR DE SITUACION LABORAL
                   04  DCP-IND-SLAB PICTURE X(3).
      *                             CODIGO CATEGORIA SOCIOECONOMICA
                   04  DCP-COD-CSEC PICTURE X(2).
      *                             INDICADOR SITUACION CASA
                   04  DCP-IND-CASA PICTURE X(5).
      *                             # MSJ ASOC A NOMBRE DE PILA (SBT)
                   04  DCP-NUM-NMSG PICTURE 9(4).
      *                             INDICADOR REGIMEN CONYUGAL
                   04  DCP-IND-RCNY PICTURE X(1).
      *                             TIPO PLAN
                   04  DCP-COD-TPLN PICTURE X(1).
      *
       EJECT

      *01  REG-AEP.
      *    COPYDD DGC-R-AEP.DGC-E-AEP00(PROD),01,D
      *    Antecedentes Economicos Persona
      *    -------------------------------
      *
      *    Nombre Registro : AEP
      *    Clave(s)        : AEP-KEY-IAEP(UU), AEP-STP-ITRN(UU)
      *    Largo           : 137
      *    Bloqueo         : 2
      *    Observaciones   :
      *
       01  AEP.
      *
      *    Filler Compatibilidad VSAM/MVS
           03  AEP-GLS-FLAG                             PIC X(01).
      *
      *KEY Clave Primaria Registro
           03  AEP-KEY-IREG.
      *
      *        Identificacion Antecedentes Economicos Persona
               05  AEP-KEY-IAEP.
      *
      *            Cod. Int. Comp. Cliente
                   07  AEP-CIC-ICLI.
      *
      *                Centro Asignacion Identificacion
                       09  AEP-CAI-ICLI.
                           11  AEP-COD-TCLI             PIC X(01).
                           11  AEP-COD-CCLI             PIC X(03).
      *
      *                Ident. Interna Computacional
                       09  AEP-IIC-ICLI                 PIC X(08).
      *
      *            Fecha Antecedentes Economicos Persona
                   07  AEP-FEC-FAEP.
                       09  AEP-NUM-SAEP                 PIC 9(02).
                       09  AEP-NUM-AAEP                 PIC 9(02).
                       09  AEP-NUM-MAEP                 PIC 9(02).
                       09  AEP-NUM-DAEP                 PIC 9(02).
      *
      *        Time Stamp Transaccion
               05  AEP-STP-ITRN.
      *
      *            Fecha Transaccion
                   07  AEP-FEC-FTRN.
                       09  AEP-NUM-STRN                 PIC 9(02).
                       09  AEP-NUM-ATRN                 PIC 9(02).
                       09  AEP-NUM-MTRN                 PIC 9(02).
                       09  AEP-NUM-DTRN                 PIC 9(02).
      *
      *            Hora Transaccion
                   07  AEP-HRA-HRTR.
                       09  AEP-NUM-HHTR                 PIC 9(02).
                       09  AEP-NUM-MMTR                 PIC 9(02).
                       09  AEP-NUM-SSTR                 PIC 9(02).
      *
      *    Indicador Tipo Accion
           03  AEP-MSC-TACC                             PIC X(01).
      *
      *    Indicador Status
           03  AEP-MSC-STAT                             PIC X(01).
      *
      *    Codigo Origen Transaccion
           03  AEP-COD-OTRN.
      *
      *        Indicador Tipo Origen
               05  AEP-MSC-TTRN                         PIC X(01).
      *
      *        Codigo Tipo Origen
               05  AEP-COD-TTRN                         PIC X(03).
      *
      *    Autor Transaccion
           03  AEP-COD-ATRN                             PIC X(12).
      *
      *    Fecha de Verificacion
           03  AEP-FEC-FVRF.
               05  AEP-NUM-SVRF                         PIC 9(02).
               05  AEP-NUM-AVRF                         PIC 9(02).
               05  AEP-NUM-MVRF                         PIC 9(02).
               05  AEP-NUM-DVRF                         PIC 9(02).
      *
      *    Renta Liquida Cliente
           03  AEP-VAL-RLCL             COMP            PIC 9(09).
      *
      *    Dividendo Mensual
           03  AEP-VAL-DMEN             COMP            PIC 9(09).
      *
      *    Renta Liquida Conyuge
           03  AEP-VAL-RLCJ             COMP            PIC 9(09).
      *
      *    Arriendo
           03  AEP-VAL-ARRD             COMP            PIC 9(09).
      *
      *    Otros Ingresos
           03  AEP-VAL-OING             COMP            PIC 9(09).
      *
      *    Otros Egresos
           03  AEP-VAL-OEGR             COMP            PIC 9(09).
      *
      *    Depositos a Plazos
           03  AEP-VAL-DPZO             COMP            PIC 9(09).
      *
      *    Deudas Banco/Comercial
           03  AEP-VAL-DBYC             COMP            PIC 9(09).
      *
      *    Acciones y Bonos
           03  AEP-VAL-ACBO             COMP            PIC 9(09).
      *
      *    Deuda Hipotecaria
           03  AEP-VAL-DHIP             COMP            PIC 9(09).
      *
      *    Bienes Raices
           03  AEP-VAL-BIRA             COMP            PIC 9(09).
      *
      *    Otros Pasivos
           03  AEP-VAL-OPAS             COMP            PIC 9(09).
      *
      *    Vehiculos
           03  AEP-VAL-VEHI             COMP            PIC 9(09).
      *
      *    Aporte Sociedades
           03  AEP-VAL-ASOC             COMP            PIC 9(09).
      *
      *    Otros Activos
           03  AEP-VAL-OACT             COMP            PIC 9(09).
      *
      *    Avales Otorgados
           03  AEP-VAL-AVAL             COMP            PIC 9(09).
      *    Valor de cambio Est.Fin.Emp.
           03  AEP-COD-VCAE.
      *        Miscelaneo Tipo Valor                    TAB TVAL
               05  AEP-COD-TVEF                         PIC X(01).
      *        Codigo Valor
               05  AEP-COD-CEFE                         PIC X(03).
      *        Codigo tipo valor
               05  AEP-COD-TCEF                         PIC X(02).
      *
      *    Glosa Disponible
           03  AEP-GLS-DISP                             PIC X(06).
      *
       EJECT
       01  REG-COM.
      *    COPYDD TAB-R-COM.TAB-E-COM00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO COM
           02  TAB-E-COM00.
      *                             REGISTRO DE COMUNAS
               03  COM.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  COM-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  COM-KEY-IREG.
      *                             KEY     TIPO + CODIGO ( LLAVE PRIMAR
                       05  COM-COD-TABL.
      *                             CODIGO TIPO TABLA
                       06  COM-COD-TTAB
                                    PICTURE X(3).
      *                             CODIGO COMUNA
                       06  COM-COD-COMU
                                    PICTURE X(12).
      *                             TIME STAMP TRANSACCION
                       05  COM-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  COM-FEC-FTRN.
                       07  COM-NUM-STRN
                                    PICTURE 9(2).
                       07  COM-NUM-ATRN
                                    PICTURE 9(2).
                       07  COM-NUM-MTRN
                                    PICTURE 9(2).
                       07  COM-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  COM-HRA-HRTR.
                       07  COM-NUM-HHTR
                                    PICTURE 9(2).
                       07  COM-NUM-MMTR
                                    PICTURE 9(2).
                       07  COM-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  COM-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  COM-MSC-STAT PICTURE X(1).
      *                             INDICADOR VIGENCIA
                   04  COM-IND-VIGE
                             REDEFINES COM-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  COM-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  COM-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  COM-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  COM-COD-ATRN PICTURE X(12).
      *                             KEY TIPO + CODIGO ( INTERNO COMPUTAC
                   04  COM-CIC-TABL.
      *                             CODIGO TIPO TABLA
                       05  COM-CIC-TTAB
                                    PICTURE X(3).
      *                             CODIGO COMUNA
                       05  COM-CIC-COMU
                                    PICTURE X(12).
      *                             CODIGO EXTERNO
                   04  COM-EXT-TABL.
      *                             CODIGO TIPO TABLA
                       05  COM-EXT-TTAB
                                    PICTURE X(3).
      *                             CODIGO TABLA
                       05  COM-EXT-CTAB
                                    PICTURE X(5).
      *                             DESCRIPCION CORTA
                   04  COM-GLS-DCOR PICTURE X(12).
      *                             ABREVIACION DESCRIPCION
                   04  COM-GLS-ABRV PICTURE X(5).
      *                             DESCRIPCION DEL CODIGO
                   04  COM-GLS-DESC.
      *                             DESCRIPCION COMUNA
                       05  COM-GLS-COMU
                                    PICTURE X(20).
      *                             DESCRIPCION CIUDAD
                       05  COM-GLS-CIUD
                                    PICTURE X(20).
      *                             DISCADO DIRECTO DISTANTE
                   04  COM-GLS-CDDD PICTURE X(5).
      *                             CODIGO POSTAL
                   04  COM-GLS-CPOS PICTURE X(10).
      *                             CODIGO DEPARTAMENTO
                   04  COM-COD-DPTO PICTURE X(5).
      *                             CODIGO PROVINCIA
                   04  COM-COD-PRVC PICTURE X(2).
      *                             CODIGO REGION
                   04  COM-COD-REGI PICTURE X(2).
      *                             CODIGO PAIS
                   04  COM-COD-PAIS PICTURE X(3).
      *                             DISPONIBLE
                   04  COM-GLS-DISP PICTURE X(33).
      *                             CLAVE SOUNDEX
                   04  COM-SNX-TABL.
                       05  COM-SNX-TTAB
                                    PICTURE X(3).
                       05  COM-SNX-COMU
                                    PICTURE X(3).
               03  COM-REDEF REDEFINES COM
                                    PICTURE X(194).
      *
       EJECT
       01  REG-OFI.
      *    COPYDD TAB-R-OFI.TAB-E-OFI00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO OFI
           02  TAB-E-OFI00.
      *                             REGISTRO DE OFICINAS
               03  OFI.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  OFI-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  OFI-KEY-IREG.
      *                             KEY     CODIGO OFICINA ( LLAVE PRIMA
                       05  OFI-COD-OFIC
                                    PICTURE X(3).
      *                             TIME STAMP TRANSACCION
                       05  OFI-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  OFI-FEC-FTRN.
                       07  OFI-NUM-STRN
                                    PICTURE 9(2).
                       07  OFI-NUM-ATRN
                                    PICTURE 9(2).
                       07  OFI-NUM-MTRN
                                    PICTURE 9(2).
                       07  OFI-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  OFI-HRA-HRTR.
                       07  OFI-NUM-HHTR
                                    PICTURE 9(2).
                       07  OFI-NUM-MMTR
                                    PICTURE 9(2).
                       07  OFI-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  OFI-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  OFI-MSC-STAT PICTURE X(1).
      *                             INDICADOR VIGENCIA
                   04  OFI-IND-VIGE
                             REDEFINES OFI-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  OFI-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  OFI-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  OFI-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  OFI-COD-ATRN PICTURE X(12).
      *                             KEY CODIGO OFICINA ( INTERNO COMPUTA
                   04  OFI-CIC-OFIC PICTURE X(3).
      *                             CODIGO OFICINA EXTERNO
                   04  OFI-EXT-TABL.
      *                             CODIGO TIPO TABLA
                       05  OFI-EXT-TTAB
                                    PICTURE X(3).
      *                             CODIGO TABLA
                       05  OFI-EXT-CTAB
                                    PICTURE X(5).
      *                             ABREVIACION OFICINA
                   04  OFI-GLS-ABRV PICTURE X(5).
      *                             DESCRIPCION OFICINA
                   04  OFI-GLS-DESC PICTURE X(38).
      *                             DIRECCION OFICINA
                   04  OFI-GLS-DIRE PICTURE X(38).
      *                             CODIGO COMUNA OFICINA
                   04  OFI-COD-COMU PICTURE X(4).
      *                             NUMERO FAX OFICINA
                   04  OFI-NUM-NFAX PICTURE X(9).
      *                             CODIGO MODELO
                   04  OFI-COD-MODL PICTURE X(1).
      *                             CODIGO ZONAL
                   04  OFI-COD-ZONL PICTURE X(1).
      *                             CODIGO USR JEFE BANCA PERSONAS
                   04  OFI-COD-JPOP PICTURE X(12).
      *                             CODIGO USR JEFE BANCA EMPRESAS
                   04  OFI-COD-JEOP PICTURE X(12).
      *                             CODIGO REGIONAL EN BANCA PERSONAS
                   04  OFI-COD-REGP PICTURE X(3).
      *                             CODIGO PLAZA OFICINA
                   04  OFI-COD-PLZA PICTURE X(4).
      *                             FONOS OFICINA
                   04  OFI-GLS-FONO.
      *                             FONO 1 OFICINA
                       05  OFI-GLS-FON1
                                    PICTURE X(10).
      *                             FONO 2 OFICINA
                       05  OFI-GLS-FON2
                                    PICTURE X(10).
      *                             ANEXOS OFICINA
                   04  OFI-GLS-ANXO.
      *                             ANEXO 1 OFICINA
                       05  OFI-GLS-ANX1
                                    PICTURE X(4).
      *                             ANEXO 2 OFICINA
                       05  OFI-GLS-ANX2
                                    PICTURE X(4).
      *                             OFICINA REGIONAL
                   04  OFI-COD-OREG PICTURE X(3).
      *                             OFICINA CENTRALIZACION OPERATIVA
                   04  OFI-COD-OFCO PICTURE X(3).
      *                             CLASIFICACION OPERATIVA OFICINA
                   04  OFI-IND-COPE PICTURE X(1).
      *                             CLASIFICACION COMERCIAL OFICINA
                   04  OFI-IND-CCOM PICTURE X(1).
                   04  OFI-NUM-CCON PICTURE X(12).
      *                             DIGITO VERIFICADOR CUENTA CONTABLE
                   04  OFI-VRF-CCON PICTURE X(1).
                   04  OFI-NUM-CCTE PICTURE X(12).
      *                             DIGITO VERIFICADOR CUENTA CORRIENTE
                   04  OFI-VRF-CCTE PICTURE X(1).
      *                             CODIGO JEFE OFICINA
                   04  OFI-COD-JFOF PICTURE X(12).
      *                             FECHA DESDE JEFE OFICINA (SSAAMMDD)
                   04  OFI-FEC-FJFO.
                       05  OFI-NUM-SJFO
                                    PICTURE 9(2).
                       05  OFI-NUM-AJFO
                                    PICTURE 9(2).
                       05  OFI-NUM-MJFO
                                    PICTURE 9(2).
                       05  OFI-NUM-DJFO
                                    PICTURE 9(2).
      *                             CODIGO JEFE OPERACIONES OFICINA
                   04  OFI-COD-JOOF PICTURE X(12).
      *                             FECHA DESDE JEFE OPERACIONES OFICINA
                   04  OFI-FEC-FJOO.
                       05  OFI-NUM-SJOO
                                    PICTURE 9(2).
                       05  OFI-NUM-AJOO
                                    PICTURE 9(2).
                       05  OFI-NUM-MJOO
                                    PICTURE 9(2).
                       05  OFI-NUM-DJOO
                                    PICTURE 9(2).
      *                             FECHA APERTURA OFICINA (SSAAMMDD)
                   04  OFI-FEC-FAPE.
                       05  OFI-NUM-SAPE
                                    PICTURE 9(2).
                       05  OFI-NUM-AAPE
                                    PICTURE 9(2).
                       05  OFI-NUM-MAPE
                                    PICTURE 9(2).
                       05  OFI-NUM-DAPE
                                    PICTURE 9(2).
      *                             FECHA CIERRE OFICINA (SSAAMMDD)
                   04  OFI-FEC-FCIE.
                       05  OFI-NUM-SCIE
                                    PICTURE 9(2).
                       05  OFI-NUM-ACIE
                                    PICTURE 9(2).
                       05  OFI-NUM-MCIE
                                    PICTURE 9(2).
                       05  OFI-NUM-DCIE
                                    PICTURE 9(2).
      *                             CODIGO REGIONAL EN BANCA EMPRESAS
                   04  OFI-COD-REGE PICTURE X(3).
      *                             DISPONIBLE
                   04  OFI-GLS-DISP PICTURE X(2).
      *
       EJECT
       01  REG-USR.
      *    COPYDD TAB-R-USR.TAB-E-USR00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO USR
           02  TAB-E-USR00.
      *                             REGISTRO DE USUARIOS
               03  USR.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  USR-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  USR-KEY-IREG.
      *                             KEY     TIPO + CODIGO ( LLAVE PRIMAR
                       05  USR-COD-TABL.
      *                             CODIGO TIPO TABLA
                       06  USR-COD-TTAB
                                    PICTURE X(3).
      *                             CODIGO USUARIO
                       06  USR-COD-USER
                                    PICTURE X(12).
      *                             TIME STAMP TRANSACCION
                       05  USR-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  USR-FEC-FTRN.
                       07  USR-NUM-STRN
                                    PICTURE 9(2).
                       07  USR-NUM-ATRN
                                    PICTURE 9(2).
                       07  USR-NUM-MTRN
                                    PICTURE 9(2).
                       07  USR-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  USR-HRA-HRTR.
                       07  USR-NUM-HHTR
                                    PICTURE 9(2).
                       07  USR-NUM-MMTR
                                    PICTURE 9(2).
                       07  USR-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  USR-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  USR-MSC-STAT PICTURE X(1).
      *                             INDICADOR VIGENCIA
                   04  USR-IND-VIGE
                             REDEFINES USR-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  USR-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  USR-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  USR-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  USR-COD-ATRN PICTURE X(12).
      *                             KEY TIPO + CODIGO ( INTERNO COMPUTAC
                   04  USR-CIC-TABL.
      *                             CODIGO TIPO TABLA
                       05  USR-CIC-TTAB
                                    PICTURE X(3).
      *                             CODIGO USUARIO
                       05  USR-CIC-USER
                                    PICTURE X(12).
      *                             CODIGO EXTERNO
                   04  USR-EXT-TABL.
      *                             CODIGO TIPO TABLA
                       05  USR-EXT-TTAB
                                    PICTURE X(3).
      *                             CODIGO TABLA
                       05  USR-EXT-CTAB
                                    PICTURE X(5).
      *                             DESCRIPCION CORTA
                   04  USR-GLS-DCOR PICTURE X(12).
      *                             ABREVIACION DESCRIPCION
                   04  USR-GLS-ABRV PICTURE X(5).
      *                             DESCRIPCION DEL CODIGO
                   04  USR-GLS-DESC PICTURE X(40).
      *                             IDENTIFICADOR USUARIO
                   04  USR-IDC-IUSR.
      *                             RUT USUARIO
                       05  USR-NUM-IUSR
                                    PICTURE X(8).
      *                             INDICADOR RUT USUARIO
                       05  USR-IND-IUSR
                                    PICTURE X(1).
      *                             GLOSA RUT USUARIO
                       05  USR-GLS-IUSR
                                    PICTURE X(3).
      *                             DIGITO VERIFICADOR RUT USUARIO
                   04  USR-VRF-IUSR PICTURE X(1).
      *                             UBICACION USUARIO
                   04  USR-COD-UBIC.
      *                             TIPO UBICACION
                       05  USR-IND-UBIC
                                    PICTURE X(1).
      *                             CODIGO UBICACION
                       05  USR-COD-OFIC
                                    PICTURE X(3).
      *                             CATEGORIA USUARIO
                   04  USR-COD-CUSR PICTURE X(8).
      *                             CODIGO OFICINA DEL USUARIO
                   04  USR-COD-OFUS PICTURE X(3).
      *                             CODIGO AREA DE GESTION
                   04  USR-COD-AGES PICTURE X(3).
      *                             CODIGO DE REGIONAL
                   04  USR-COD-REGL PICTURE X(3).
      *                             CODIGO DE BANCA
                   04  USR-COD-BNCA PICTURE X(3).
      *                             CODIGO DE PLATAFORMA
                   04  USR-COD-PLAT PICTURE X(1).
      *                             GRUPO CENTRO DE NEGOCIO
                   04  USR-GRP-CNEG PICTURE X(2).
      *                             TELEFONO DEL USUARIO
                   04  USR-NUM-FONO PICTURE X(8).
      *                             CODIGO PLATAFORMA EMPRESA
                   04  USR-COD-PTDT PICTURE X(3).
      *                             DISPONIBLE
                   04  USR-GLS-DISP PICTURE X(9).
      *                             CLAVE SOUNDEX
                   04  USR-SNX-TABL.
                       05  USR-SNX-TTAB
                                    PICTURE X(3).
                       05  USR-SNX-USER
                                    PICTURE X(3).

      *
      *
      *
      ******************************************************************
      *                 ELEMENT LIST                                   *
      ******************************************************************
      *
       01  ELEM-LIST.
           03 ELEM           PIC X(05).
           03 ELEM-SEC       PIC X(01).
           03 FILLER         PIC X(05) VALUE SPACES.
      *
           COPY RLOVR001.

       EJECT
       PROCEDURE DIVISION.
      *===================
       A-CONTROL SECTION.
      *==================
           ENTRY 'DBMSCBL'.
       AA-INICIO.
           PERFORM B-INICIAR.
       AB-PROCESO.
           IF WS-PROCESO-OK = 0
              PERFORM C-PROCESAR
           END-IF.
       AC-FIN.
           PERFORM D-TERMINAR.
       AZ-FIN-PROGRAMA.
           STOP RUN.

       EJECT
       B-INICIAR SECTION.
      *==================
       BA-CONTROL-PROCESO.
      *-------------------
           PERFORM BB-ABRE-REPORTER.
           GO TO BZ-FIN.

       BB-ABRE-REPORTER.
      *-----------------
           OPEN OUTPUT RPTEJEC LISTADO.

           ACCEPT WS-FEC-AMD FROM DATE.
           MOVE WS-DIA-AMD TO WS-DIA-DMA WS-DIA-DMSA  WS-NUM-DDAT.
           MOVE WS-MES-AMD TO WS-MES-DMA WS-MES-DMSA  WS-NUM-MDAT.
           MOVE WS-ANO-AMD TO WS-ANO-DMA WS-ANO-DMSA  WS-NUM-ADAT.
      *****IF WS-ANO-AMD > 50
           IF WS-ANO-AMD < ROLL-YY
              MOVE '20'    TO WS-SIGLO-DMSA
           ELSE
              MOVE '19'    TO WS-SIGLO-DMSA
           END-IF.
           MOVE WS-FEC-DMSA TO L2-FECHA.
           MOVE WS-FEC-DMA TO RPT-T01-FEC.
           WRITE REG-RPTEJEC FROM RPT-T01 AFTER PAGE.
           WRITE REG-RPTEJEC FROM RPT-T02.

           ACCEPT WS-HORA    FROM TIME.
           MOVE WS-HH  TO  WS-HH2.
           MOVE WS-MM  TO  WS-MM2.
           MOVE WS-SS  TO  WS-SS2.


           OPEN INPUT  ARCLIEN.
           IF FS-ARCLIEN NOT = '00'
              DISPLAY 'ERROR AL ABRIR ARCLIEN '
              MOVE 'OPEN '        TO ER-OPERACI
              MOVE 'B-INICIAR'        TO ER-SECCION
              MOVE 'BB-ABRE-REPORTES' TO ER-SECCION
              MOVE SPACES             TO ER-MENSAJE
              MOVE FS-ARCLIEN         TO ER-FILE-ST
              MOVE 'ARCLIEN '         TO ER-ARCHIVO
              PERFORM BD-DESPLIEGA-ERROR.

       BD-DESPLIEGA-ERROR.
      *-----------------
           DISPLAY ' '
           DISPLAY 'ERROR EN SECCION   : ' ER-SECCION
           DISPLAY '   PARRAFO         : ' ER-PARRAFO
           DISPLAY '   ARCHIVO O BASE  : ' ER-ARCHIVO
           DISPLAY '   OPERACION       : ' ER-OPERACI
           DISPLAY '   FILE STATUS     : ' ER-FILE-ST
           DISPLAY '   MENSAJE DE ERROR: ' ER-MENSAJE
           MOVE 1 TO WS-PROCESO-OK
           CLOSE RPTEJEC  ARCLIEN LISTADO
           MOVE 100 TO WS-RETURN-CODE.

      *
       BZ-FIN.   EXIT.

       EJECT
       C-PROCESAR SECTION.
      *===================
       CA-CONTROL-PROCESO.
      *-------------------
           PERFORM CB-LEER-ULTIMO-CIC.
           IF WS-PROCESO-OK = 0 THEN PERFORM CB-UPDAT-CIC.
           IF WS-PROCESO-OK = 0 THEN PERFORM CB-RELES-CIC.
           IF WS-PROCESO-OK = 0 THEN PERFORM CB-LEER-ARCLIEN.
           IF WS-PROCESO-OK = 0 THEN PERFORM   CC-PROCESAR-ARCLIEN.
       CZ-FIN-PROC.    EXIT.

       CC-PROCESAR-ARCLIEN SECTION.
      *----------------------------*
       CC-PROC-ARCLIEN.
           IF WS-FIN = 'S'
              MOVE 'S' TO WS-VALIDO
              PERFORM VALIDAR-ARCLIEN
              IF WS-VALIDO = 'N'
                 ADD  1       TO WS-TOTCLI-RECH
                 PERFORM CB-RELES-CIC
                 GO TO CC-FIN-PROCESAR-ARCLIEN
              ELSE
                 PERFORM CD-GRABAR-BASES
                 PERFORM CB-LEER-ULTIMO-CIC
                 PERFORM CB-UPDAT-CIC
                 PERFORM CB-RELES-CIC
                 GO TO CC-FIN-PROCESAR-ARCLIEN.

           IF TR1-TIPO-REG = 1 AND WS-PRIMEREG = 'S'
              MOVE 'N' TO WS-PRIMEREG
              MOVE TREG01 TO WS-TREG01
           ELSE
           IF TR1-TIPO-REG = 1 OR WS-FIN = 'S'
              MOVE 'S' TO WS-VALIDO
              PERFORM VALIDAR-ARCLIEN
              IF WS-VALIDO = 'N'
                 ADD  1       TO WS-TOTCLI-RECH
                 MOVE ALL '0' TO WS-TREG01 WS-TREG02
                                 WS-TREG03 WS-TREG04
                 MOVE TREG01 TO WS-TREG01
              ELSE
                 PERFORM CD-GRABAR-BASES
                 PERFORM CB-LEER-ULTIMO-CIC
                 PERFORM CB-UPDAT-CIC
                 PERFORM CB-RELES-CIC
                 MOVE ALL '0' TO WS-TREG01 WS-TREG02
                                 WS-TREG03 WS-TREG04
                 MOVE TREG01 TO WS-TREG01
           ELSE
           IF TR2-TIPO-REG = 2
              MOVE TREG02 TO WS-TREG02
           ELSE
           IF TR3-TIPO-REG = 3
              MOVE TREG03 TO WS-TREG03
           ELSE
           IF TR4-TIPO-REG = 4
              MOVE TREG04 TO WS-TREG04
           ELSE
              DISPLAY   '******************************'
              DISPLAY   '* ERROR: DATOS ARCHIVO ARCLIEN'
              DISPLAY   '*        TIPO DE REGISTRO : ' WS-TR1-TIPO-REG
              DISPLAY   '* REGISTRO ES IGNORADO TREG01 ' WS-TREG01
              DISPLAY   '* ****************************'.

           PERFORM   CB-LEER-ARCLIEN.
           GO TO CC-PROC-ARCLIEN.

       CC-FIN-PROCESAR-ARCLIEN.  EXIT.

       EJECT
       CB-LECTURAS SECTION.
      *--------------------------

       CB-LEER-ARCLIEN.
      *--------------------------
            READ ARCLIEN AT END MOVE 'S' TO WS-FIN.
            IF WS-FIN NOT = 'S'
               IF TR1-TIPO-REG = 1
                  ADD  1       TO WS-TOTCLI-LEIDOS
                  IF TR1-CASADO
                     ADD  1    TO WS-TOTCLI-CASADOS
                  ELSE
                     NEXT SENTENCE
               ELSE
               IF TR2-TIPO-REG = 3
                  ADD  1       TO WS-TOTCONY-LEIDOS.


       CB-LEER-ULTIMO-CIC.
      *-------------------
           MOVE 'RDUKY' TO REQ-CIC-CMD.
           MOVE 'CIC'   TO REQ-CIC-TBLNM.
           MOVE 'CIC00' TO REQ-CIC-KEYNM.
           MOVE '    '  TO REQ-CIC-KEY-VALUE.
           MOVE 'CIC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-CIC-AREA CIC ELEM-LIST.
           IF REQ-CIC-RETURN-CODE = '  '
              COMPUTE WS-NUM-ICIC = CIC-NUM-ICIC + 1
           ELSE
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'CB-LEER-ULTIMO-CIC'       TO ER-PARRAFO
              MOVE   'CIC '                    TO ER-ARCHIVO
              MOVE    REQ-CIC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-CIC-AREA             TO ER-MENSAJE
              MOVE    'RDUKY '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR.

       CB-UPDAT-CIC.
      *-------------
           MOVE 'UPDAT' TO REQ-CIC-CMD.
           MOVE 'CIC'   TO REQ-CIC-TBLNM.
           MOVE 'CIC00' TO REQ-CIC-KEYNM.
           MOVE '    '  TO REQ-CIC-KEY-VALUE.
           MOVE WS-NUM-ICIC TO CIC-NUM-ICIC.
           MOVE 'CIC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-CIC-AREA CIC ELEM-LIST.
           IF REQ-CIC-RETURN-CODE = '  '
              NEXT SENTENCE
           ELSE
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'CB-UPDAT-CIC      '       TO ER-PARRAFO
              MOVE   'CIC '                    TO ER-ARCHIVO
              MOVE    REQ-CIC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-CIC-AREA             TO ER-MENSAJE
              MOVE    'UPDAT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR.

       CB-RELES-CIC.
      *-------------
           MOVE 'RELES' TO REQ-CIC-CMD.
           MOVE 'CIC'   TO REQ-CIC-TBLNM.
           CALL 'DBNTRY' USING UIB REQ-CIC-AREA
           IF REQ-CIC-RETURN-CODE = '  '
              NEXT SENTENCE
           ELSE
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'CB-RELES-CIC      '       TO ER-PARRAFO
              MOVE   'CIC '                    TO ER-ARCHIVO
              MOVE    REQ-CIC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-CIC-AREA             TO ER-MENSAJE
              MOVE    'RELES '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR.

       CB-BUSCA-COD-COMUNA.
      *----------------------
           MOVE SPACES        TO REQ-TAB-KEY-VALUE.
           MOVE 'COM'         TO REQ-TAB-KEY-COM.
           MOVE WS-COD-COMUNA TO REQ-TAB-KEY-COMUNA.
           MOVE 'REDKY'       TO REQ-TAB-CMD.
           MOVE 'TAB00'       TO REQ-TAB-KEY.
           MOVE 'TAB00'       TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-TAB-AREA COM ELEM-LIST
           IF REQ-TAB-RTN-CODE NOT = SPACES
              MOVE 'N'  TO WS-VALIDO-COMUNA
              END-IF.

       CB-BUSCA-COD-PROFESION.
      *------------------------*
           MOVE SPACES           TO REQ-TAB-KEY-PROFESION.
           MOVE WS-COD-PROFESION TO REQ-TAB-KEY-PROFESION.
           MOVE 'TAB00'              TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-TAB-AREA-PRF TAB ELEM-LIST
           IF REQ-TAB-RTN-CODE-PRF NOT = SPACES
              DISPLAY   '**************************'
              DISPLAY   '* CODIGO RETORNO : ' REQ-TAB-RTN-CODE-PRF
              DISPLAY   '* REQ. AREA      : ' REQ-TAB-AREA-PRF
              DISPLAY   '* LLAVE          : ' REQ-TAB-KEY-VALUE-PRF
              MOVE 'N'  TO WS-VALIDO-PROF
              END-IF.

       CB-BUSCA-COD-ACTIV.
      *------------------------*
           MOVE SPACES               TO REQ-TAB-KEY-VALUE-ACT.
           MOVE 'ACT'                TO REQ-TAB-KEY-ACTI.
           MOVE WS-TR2-COD-ACTIVIDAD TO REQ-TAB-KEY-ACTIVIDAD.
           MOVE 'REDKX'              TO REQ-TAB-CMD-ACT.
           MOVE 'TAB00'              TO REQ-TAB-KEY-ACT.
           MOVE 'TAB00'              TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-TAB-AREA-ACT TAB ELEM-LIST
           IF REQ-TAB-RTN-CODE-ACT NOT = SPACES
              MOVE 'N'  TO WS-VALIDO-ACTIV
              END-IF.

       CB-BUSCA-EMPRESA-DBC.
           MOVE SPACES                  TO REQ-DBCE-KEY-VALUE.
           MOVE WS-TR2-NUM-RUT-EMPRESAX TO REQ-DBCE-KEY-VALUE.
           MOVE 'REDKX' TO REQ-DBCE-CMD.
           MOVE 'DBC'   TO REQ-DBCE-TBLNM.
           MOVE 'DBC02' TO REQ-DBCE-KEYNM.
           MOVE 'DBC00' TO REQ-DBCE-TBLID.
           MOVE 'DBC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DBCE-AREA DBC ELEM-LIST.
           IF REQ-DBCE-RETURN-CODE NOT = '  ' AND
              REQ-DBCE-RETURN-CODE NOT = '14'
              DISPLAY   '**************************'
              DISPLAY   '* ERROR: REDKX TABLA DBC EMPRESA *'
              DISPLAY   '* TABLA          : ' REQ-DBCE-TBLNM
              DISPLAY   '* CODIGO RETORNO : ' REQ-DBCE-RETURN-CODE
              DISPLAY   '* REQ. AREA      : ' REQ-DBCE-AREA
              DISPLAY   '* PGM. SGCPNEG CANCELADO *'
              PERFORM D-TERMINAR
              MOVE 100 TO RETURN-CODE
              GOBACK
           ELSE
           IF REQ-DBCE-RETURN-CODE  = '14'
              MOVE 'N'  TO WS-VALIDO
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'NO EXISTE EMPRESA DONDE TRABAJA CLTE.'
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR2-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT EMPRESA   : '  TO RPT-D02-GLOS
              MOVE  WS-TR2-RUT-EMPRESA    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
           ELSE
              MOVE DBC-CAI-ICLI  TO  WS-CAI-ICLI-EMP.
              MOVE DBC-IIC-ICLI  TO  WS-IIC-ICLI-EMP.

       CB-BUSCA-EN-DBC.
           DISPLAY ' CB-BUSCA-EN-DBC     '.
           MOVE SPACES  TO REQ-DBCC-RETURN-CODE.
           MOVE 'REDKX' TO REQ-DBCC-CMD.
           MOVE 'DBC'   TO REQ-DBCC-TBLNM.
           MOVE 'DBC02' TO REQ-DBCC-KEYNM.
           MOVE 'DBC00' TO REQ-DBCC-TBLID.
           MOVE 'DBC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DBCC-AREA DBC ELEM-LIST.
           IF REQ-DBCC-RETURN-CODE NOT = '  ' AND
              REQ-DBCC-RETURN-CODE NOT = '14'
              DISPLAY   '**************************'
              DISPLAY   '* ERROR: REDKX TABLA DBC CLIENTE *'
              DISPLAY   '* TABLA          : ' REQ-DBCC-TBLNM
              DISPLAY   '* CODIGO RETORNO : ' REQ-DBCC-RETURN-CODE
              DISPLAY   '* REQ. AREA      : ' REQ-DBCC-AREA
              DISPLAY   '* PGM. SGCPNEG CANCELADO *'
              PERFORM D-TERMINAR
              MOVE 100 TO RETURN-CODE
              GOBACK.


       CB-BUSCA-EN-DCP.
      *----------------*
           DISPLAY ' CB-BUSCA-EN-DCP     '.

           MOVE SPACES  TO REQ-DCPC-RETURN-CODE.
           MOVE 'REDKX' TO REQ-DCPC-CMD.
           MOVE 'DCP'   TO REQ-DCPC-TBLNM.
           MOVE 'DCP00' TO REQ-DCPC-KEYNM.
           MOVE 'DCP00' TO REQ-DCPC-TBLID.
           MOVE 'DCP00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DCPC-AREA DCP ELEM-LIST.
           IF REQ-DCPC-RETURN-CODE NOT = '  ' AND
              REQ-DCPC-RETURN-CODE NOT = '14'
              DISPLAY   '**************************'
              DISPLAY   '* ERROR: REDKX TABLA DCP *'
              DISPLAY   '* TABLA          : ' REQ-DCPC-TBLNM
              DISPLAY   '* CODIGO RETORNO : ' REQ-DCPC-RETURN-CODE
              DISPLAY   '* REQ. AREA      : ' REQ-DCPC-AREA
              DISPLAY   '* PGM. SGCPNEG CANCELADO *'
              PERFORM D-TERMINAR
              MOVE 100 TO RETURN-CODE
              GOBACK.

       CB-BUSCA-EN-AEP.
      *----------------*

           DISPLAY ' CB-BUSCA-EN-AEP     '.
           MOVE SPACES  TO REQ-AEPC-RETURN-CODE.
           MOVE 'REDKX' TO REQ-AEPC-CMD.
           MOVE 'AEP'   TO REQ-AEPC-TBLNM.
           MOVE 'AEP00' TO REQ-AEPC-KEYNM.
           MOVE 'AEP00' TO REQ-AEPC-TBLID.
           MOVE 'AEP00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-AEPC-AREA AEP ELEM-LIST.
           IF REQ-AEPC-RETURN-CODE NOT = '  ' AND
              REQ-AEPC-RETURN-CODE NOT = '14'
              DISPLAY   '**************************'
              DISPLAY   '* ERROR: REDKX TABLA AEP *'
              DISPLAY   '* TABLA          : ' REQ-AEPC-TBLNM
              DISPLAY   '* CODIGO RETORNO : ' REQ-AEPC-RETURN-CODE
              DISPLAY   '* REQ. AREA      : ' REQ-AEPC-AREA
              DISPLAY   '* PGM. SGCPNEG CANCELADO *'
              PERFORM D-TERMINAR
              MOVE 100 TO RETURN-CODE
              GOBACK.

       CB-BUSCA-EN-RCD.
      *----------------*

           DISPLAY ' CB-BUSCA-EN-RCO     '.
           MOVE SPACES  TO REQ-RCDC-RETURN-CODE.
           MOVE 'REDKX' TO REQ-RCDC-CMD.
           MOVE 'RCD'   TO REQ-RCDC-TBLNM.
           MOVE 'RCD00' TO REQ-RCDC-KEYNM.
           MOVE 'RCD00' TO REQ-RCDC-TBLID.
           MOVE 'RCD00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-RCDC-AREA RCD ELEM-LIST.
           IF REQ-RCDC-RETURN-CODE NOT = '  ' AND
              REQ-RCDC-RETURN-CODE NOT = '14'
              DISPLAY   '**************************'
              DISPLAY   '* ERROR: REDKX TABLA RCD *'
              DISPLAY   '* TABLA          : ' REQ-RCDC-TBLNM
              DISPLAY   '* CODIGO RETORNO : ' REQ-RCDC-RETURN-CODE
              DISPLAY   '* REQ. AREA      : ' REQ-RCDC-AREA
              DISPLAY   '* PGM. SGCPNEG CANCELADO *'
              PERFORM D-TERMINAR
              MOVE 100 TO RETURN-CODE
              GOBACK.

       CB-BUSCA-EN-DCC.
      *----------------*

           DISPLAY ' CB-BUSCA-EN-DCC     '.
           MOVE SPACES  TO REQ-DCCC-RETURN-CODE.
           MOVE 'REDKX' TO REQ-DCCC-CMD.
           MOVE 'DCC'   TO REQ-DCCC-TBLNM.
           MOVE 'DCC00' TO REQ-DCCC-KEYNM.
           MOVE 'DCC00' TO REQ-DCCC-TBLID.
           MOVE 'DCC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DCCC-AREA DCC ELEM-LIST.
           IF REQ-DCCC-RETURN-CODE NOT = '  ' AND
              REQ-DCCC-RETURN-CODE NOT = '14'
              DISPLAY   '**************************'
              DISPLAY   '* ERROR: REDKX TABLA DCC *'
              DISPLAY   '* TABLA          : ' REQ-DCCC-TBLNM
              DISPLAY   '* CODIGO RETORNO : ' REQ-DCCC-RETURN-CODE
              DISPLAY   '* REQ. AREA      : ' REQ-DCCC-AREA
              DISPLAY   '* PGM. SGCPNEG CANCELADO *'
              PERFORM D-TERMINAR
              MOVE 100 TO RETURN-CODE
              GOBACK.

       CB-BUSCA-EN-REC.
      *----------------*

           DISPLAY ' CB-BUSCA-EN-REC     '.
           MOVE SPACES  TO REQ-RECC-RETURN-CODE.
           MOVE 'REDKX' TO REQ-RECC-CMD.
           MOVE 'REC'   TO REQ-RECC-TBLNM.
           MOVE 'REC00' TO REQ-RECC-KEYNM.
           MOVE 'REC00' TO REQ-RECC-TBLID.
           MOVE 'REC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-RECC-AREA REC ELEM-LIST.
           IF REQ-RECC-RETURN-CODE NOT = '  ' AND
              REQ-RECC-RETURN-CODE NOT = '14'
              DISPLAY   '**************************'
              DISPLAY   '* ERROR: REDKX TABLA REC *'
              DISPLAY   '* TABLA          : ' REQ-RECC-TBLNM
              DISPLAY   '* CODIGO RETORNO : ' REQ-RECC-RETURN-CODE
              DISPLAY   '* REQ. AREA      : ' REQ-RECC-AREA
              DISPLAY   '* PGM. SGCPNEG CANCELADO *'
              PERFORM D-TERMINAR
              MOVE 100 TO RETURN-CODE
              GOBACK.


       CB-FIN-ACC-TABLAS.  EXIT.

       EJECT
       CD-GRABAR-BASES   SECTION.
      *==========================

       CD-GRABAR-DBC-CLIENTE.
      *----------------------

       CHEQUEA-CLIENTE-EN-DBC.
      *
           MOVE SPACES                  TO REQ-DBCC-KEY-VALUE.
           MOVE WS-TR1-NUM-RUT-CLIENTEX TO REQ-DBCC-KEY-VALUE.
           PERFORM CB-BUSCA-EN-DBC.

           IF REQ-DBCC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CLIENTE YA EXISTE EN DBC SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1

      * SE ASIGNA EL CIC DEL CLIENTE EXISTENTE EN DBC PARA RESTO BASES
              MOVE DBC-CAI-ICLI TO CIC-CAI-ICIC
              MOVE DBC-IIC-ICLI TO WS-NUM-ICIC

              GO TO CD-GRABA-DCP-CLIENTE.



       GENERA-CLIENTE-EN-DBC.
           MOVE ' '          TO DBC-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO DBC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO DBC-IIC-ICLI.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FTRN.
           MOVE WS-HORA2  TO DBC-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO DBC-MSC-TACC.
           MOVE 'V'          TO DBC-MSC-STAT.
           MOVE 'B'          TO DBC-MSC-TTRN.
           MOVE '   '        TO DBC-COD-TTRN.

      *    MUEVE NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO DBC-COD-ATRN.

      *    MUEVE EL RUT DEJANDO CON  S LA EXTENSION.
           MOVE WS-TR1-NUM-RUT-CLIENTE TO DBC-NUM-ICLI.
           MOVE ' '                 TO DBC-IND-ICLI.
           MOVE '   '               TO DBC-GLS-ICLI.
           MOVE WS-TR1-DV-RUT-CLIENTE  TO DBC-VRF-ICLI.

      *    SE MUEVE EL NOMBRE DEL CLIENTE.
           MOVE WS-TR1-APAT-CLIENTE TO DBC-GLS-APAT.
           MOVE WS-TR1-AMAT-CLIENTE TO DBC-GLS-AMAT.
           MOVE WS-TR1-NOMB-CLIENTE TO DBC-GLS-NOMB.

      *    MUEVE LAS 3 PRIMERAS LETRAS DE LOS NOMBRES AL SOUNDEX.
           MOVE DBC-GLS-APAT TO DBC-SNX-APAT
           MOVE DBC-GLS-AMAT TO DBC-SNX-AMAT
           MOVE DBC-GLS-NOMB TO DBC-SNX-NOMB.

      *    MUEVE EL CODIGO DE DOMICILIO A LA DIRECCION DE ENVIO CORRESP
           MOVE 01           TO DBC-NUM-DCOR.

      *    SEGUN EL RUT ASIGNA CODIGO DE PERSONA O EMPRESA.
           MOVE 'P'          TO DBC-IND-TICL.

      *    MUEVE EL CODIGO DE CLIENTE CUENTACORRENTISTA AL TIPO CLTE.
           MOVE WS-TR1-COD-TICL  TO DBC-COD-TICL.

      *    MUEVE SPACES AL CODIGO CLASIF. COMERCIAL.
           MOVE '  '         TO DBC-COD-CLCM.

      *    SE ASIGNA CODIGO DE EJECUTIVO DE PARAMETRO.
           MOVE WS-TR1-COD-EJEC  TO DBC-COD-EJEC.

      *    ASIGNA LA OFICINA DE PARAMETRO.
           MOVE WS-TR1-COD-OFIC TO DBC-COD-OFIC.

      *    MOVE SPACES AL INDICADOR OPERA OTRA OFICINA.
           MOVE 'N'          TO DBC-IND-OOFI.

      *    MOVE SPACES AL CODIGO ACTIVIDAD ECONOMICA.
           MOVE WS-TR2-COD-ACTIVIDAD  TO DBC-COD-ACTI.

      *    SEGUN EL RUT ASIGNA EL ORIGEN Y DESTINO SECTORIAL.
           MOVE '121'        TO DBC-COD-ODSE.

      *    MOVE ZEROES A LA FECHA DECLARACION ART. 85.
      *    MOVE 00000000     TO DBC-FEC-FA85.

      *    MOVE FECHA DE PROCESO A LA FECHA DE INGRESO AL PLAN.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FPLN.

      *    MOVE SPACES AL TIPO ULTIMO PAGO IMPUESTO A LA RENTA.
           MOVE '   '        TO DBC-IND-UPIR.

      *    MOVE ZEROES A LA FECHA ULTIMO PAGO IMPUESTO A LA RENTA.
           MOVE 00000000     TO DBC-FEC-FUPI.

      *    MOVE SPACES AL INDICADOR DE MULTAS BANCO CENTRAL.
           MOVE ' '          TO DBC-IND-MUBC.

      *    MOVE SPACES AL INDICADOR DE JUICIOS BANCO CENTRAL.
           MOVE ' '          TO DBC-IND-JUBC.

      *    MOVE 'CLTE. EN MARCHA' A CODIGO ESTADO CLIENTE.
           MOVE '4'          TO DBC-MSC-SCLI.

      *    MOVE CURRENT-DATE A FECHA ESTADO CLIENTE.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FSCL.

      *    MOVE 'SIN BLOQUEO' A CODIGO BLOQUEO CLIENTE.
           MOVE '  '         TO DBC-COD-BLOC.

      *****MOVE 01 A CAMPO TOTAL DIRECCIONES.
           MOVE 01           TO DBC-NUM-TDIR.

      *    MOVE ZEROES AL CAMPO NUMERO TOTAL DE COMENTARIOS.
           MOVE 000          TO DBC-NUM-TCMT.

      *    MOVE FECHA APERTURA A FECHA INICIO OPERACION.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FIOP.

      *    MOVE ZEROES A FECHA TERMINO OPERACION.
           MOVE 00000000     TO DBC-FEC-FTOP.

      *    MOVE ZEROES A OPERACIONES FECHA TERMINA NULA.
           MOVE 000          TO DBC-NUM-OFTN.

      *    MOVE CURRENT-DATE A FECHA INGRESO REG. A LA TABLA.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FINP.

           MOVE 'ADDIT' TO REQ-DBC-CMD.
           MOVE 'DBC'   TO REQ-DBC-TBLNM.
           MOVE 'DBC00' TO REQ-DBC-KEYNM.
           MOVE 'DBC00' TO REQ-DBC-TBLID.
           MOVE 'DBC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DBC-AREA DBC ELEM-LIST.
           IF REQ-DBC-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CLIENTE-EN-DBC '   TO ER-PARRAFO
              MOVE   'DBC '                    TO ER-ARCHIVO
              MOVE    REQ-DBC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-DBC-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS
           ELSE
              ADD  1  TO  WS-TOTCLI-GRADBC
              IF WS-TR1-CASADO
                 ADD  1  TO  WS-TOTCLI-GRADBC-CAS
              ELSE
                 ADD  1  TO  WS-TOTCLI-GRADBC-OTR.


       EJECT
       CD-GRABA-DCP-CLIENTE.
      *----------------------

       CHEQUEA-CLIENTE-EN-DCP.

           MOVE CIC-CAI-ICIC TO REQ-DCPC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO REQ-DCPC-IIC-ICLI.

           PERFORM CB-BUSCA-EN-DCP.
           IF REQ-DCPC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CLIENTE YA EXISTE EN DCP SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   CIC CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  REQ-DCPC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-AEP-CLIENTE.



       GENERA-CLIENTE-EN-DCP.
           MOVE ' '          TO DCP-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO DCP-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO DCP-IIC-ICLI.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO DCP-FEC-FTRN.
           MOVE WS-HORA2 TO DCP-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO DCP-MSC-TACC.
           MOVE 'V'          TO DCP-MSC-STAT.
           MOVE 'B'          TO DCP-MSC-TTRN.
           MOVE '   '        TO DCP-COD-TTRN.

      *    MUEVE NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO DCP-COD-ATRN.

      *    FECHA DE NACIMIENTO.
           MOVE WS-TR1-FNAC-AA1 TO DCP-NUM-SNAC.
           MOVE WS-TR1-FNAC-AA2 TO DCP-NUM-ANAC.
           MOVE WS-TR1-FNAC-MM  TO DCP-NUM-MNAC.
           MOVE WS-TR1-FNAC-DD  TO DCP-NUM-DNAC.

      *    MOVE SPACES A CODIGO DEL PAIS DE LA NACIONALIDAD.
           MOVE '   '           TO DCP-COD-PNAC.

      *    INDICADOR DE SEXO.
           MOVE WS-TR1-IND-SEXO    TO DCP-IND-SEXO.

      *    INDICADOR DE ESTADO CIVIL.
           MOVE WS-TR1-IND-ECIVIL  TO DCP-IND-ECIV.

      *    CEDULA DE IDENTIDAD.
           MOVE WS-TR1-NUM-RUT-CLIENTE  TO DCP-NUM-CIDE.

      *    DIG. VERIF. CEDULA DE IDENTIDAD.
           MOVE WS-TR1-DV-RUT-CLIENTE   TO DCP-VRF-CIDE.

      *    GABINETE CEDULA DE IDENTIDAD.
           MOVE SPACES       TO DCP-GLS-GABI.

      *    INDICADOR NIVEL EDUCACIONAL.
           MOVE WS-TR1-IND-NIV-EDUCACION  TO DCP-IND-NEDU.

      *    CODIGO ACTIVIDAD SECUNDARIA.
           MOVE SPACES             TO DCP-COD-ACTS.

      *    CODIGO DE PROFESION.
           MOVE WS-TR1-COD-PROFESION  TO DCP-COD-PROF.

      *    INDICADOR SITUACION LABORAL.
           MOVE '   '              TO DCP-IND-SLAB.

      *    CATEGORIA SOCIOECONOMICA.
           MOVE '  '               TO DCP-COD-CSEC.

      *    INDICADOR SITUACION CASA.
           MOVE WS-TR1-IND-SIT-CASA     TO DCP-IND-CASA.
      *    CODIGO TIPO DE BANCA.
      *    MOVE 'N'                     TO DCP-COD-TBAN.
           MOVE 'PP'                    TO DCP-COD-TBAN.
      *    CODIGO TIPO DE REGIMEN CONYUGAL.
           MOVE WS-TR1-IND-RCONYUGAL TO DCP-IND-RCNY.
      *    TIPO DE PLAN.
           MOVE WS-COD-TPLN             TO DCP-COD-TPLN.

           MOVE 'ADDIT' TO REQ-DCP-CMD.
           MOVE 'DCP'   TO REQ-DCP-TBLNM.
           MOVE 'DCP00' TO REQ-DCP-KEYNM.
           MOVE 'DCP00' TO REQ-DCP-TBLID.
           MOVE 'DCP00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DCP-AREA DCP ELEM-LIST.
           IF REQ-DCP-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CLIENTE-EN-DCP '   TO ER-PARRAFO
              MOVE   'DCP '                    TO ER-ARCHIVO
              MOVE    REQ-DCP-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-DCP-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTCLI-GRADCP.



       EJECT
       CD-GRABA-AEP-CLIENTE.
      *----------------------

       CHEQUEA-CLIENTE-EN-AEP.

      *    IF WS-AEP-CLI = 'N' THEN GO TO CD-GRABA-RCD-D.

           MOVE CIC-CAI-ICIC TO REQ-AEPC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO REQ-AEPC-IIC-ICLI.
           MOVE WS-FEC-FDAT  TO REQ-AEPC-FEC-FAEP.

           PERFORM CB-BUSCA-EN-AEP.
           IF REQ-AEPC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CLIENTE YA EXISTE EN AEP SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   CIC CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  REQ-AEPC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-RCD-D.



       GENERA-CLIENTE-EN-AEP.
           MOVE ' '          TO AEP-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO AEP-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO AEP-IIC-ICLI.
      *    FECHA ANTECEDENTES ECONOMICOS PERSONA (PARTE DE LLAVE)
           MOVE WS-FEC-FDAT TO  AEP-FEC-FAEP.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO AEP-FEC-FTRN.
           MOVE WS-HORA2  TO AEP-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO AEP-MSC-TACC.
           MOVE 'V'          TO AEP-MSC-STAT.
           MOVE 'B'          TO AEP-MSC-TTRN.
           MOVE '   '        TO AEP-COD-TTRN.

      *    MUEVE NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO AEP-COD-ATRN.

      *    Fecha de Verificacion
           MOVE WS-FEC-FDAT TO  AEP-FEC-FVRF.

      *    Renta Liquida Cliente
           MOVE WS-TR4-RENTA-LIQ-CLIENTE TO   AEP-VAL-RLCL.

      *    Dividendo Mensual
           MOVE WS-TR4-DIVID-MENSUAL     TO   AEP-VAL-DMEN.
      *    Renta Liquida Conyuge
           MOVE WS-TR4-RENTA-LIQ-CONYUGE TO   AEP-VAL-RLCJ.
      *    Arriendo
           MOVE WS-TR4-ARRIENDO          TO   AEP-VAL-ARRD.
      *    Otros Ingresos
           MOVE WS-TR4-OTROS-ING-CLIENTE TO   AEP-VAL-OING.
      *    Otros Egresos
           MOVE WS-TR4-OTROS-EGRESOS     TO   AEP-VAL-OEGR.
      *    Depositos a Plazos
           MOVE ZEROS                    TO   AEP-VAL-DPZO.
      *    Deudas Banco/Comercial
           MOVE WS-TR4-DEUDAS-BCO-FIN    TO   AEP-VAL-DBYC.
      *    Acciones y Bonos
           MOVE ZEROS                    TO   AEP-VAL-ACBO.
      *    Deuda Hipotecaria
           MOVE WS-TR4-CRED-HIP          TO   AEP-VAL-DHIP.
      *    Bienes Raices
           MOVE WS-TR4-PROPIEDADES       TO   AEP-VAL-BIRA.
      *    Otros Pasivos
           MOVE WS-TR4-OTRAS-DEUDAS      TO   AEP-VAL-OPAS.
      *    Vehiculos
           MOVE WS-TR4-VEHICULOS         TO   AEP-VAL-VEHI.
      *    Aporte Sociedades
           MOVE ZEROS                    TO   AEP-VAL-ASOC.
      *    Otros Activos
           MOVE WS-TR4-OTROS-ACTIVOS     TO   AEP-VAL-OACT.
      *    Avales Otorgados
           MOVE ZEROS                    TO   AEP-VAL-AVAL.
      *    VALORES EN
           MOVE 'M$'                     TO   AEP-COD-VCAE.
      *    Glosa Disponible
           MOVE SPACES                TO   AEP-GLS-DISP.


           MOVE 'ADDIT' TO REQ-AEP-CMD.
           MOVE 'AEP'   TO REQ-AEP-TBLNM.
           MOVE 'AEP00' TO REQ-AEP-KEYNM.
           MOVE 'AEP00' TO REQ-AEP-TBLID.
           MOVE 'AEP00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-AEP-AREA AEP ELEM-LIST.
           IF REQ-AEP-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CLIENTE-EN-AEP '   TO ER-PARRAFO
              MOVE   'AEP '                    TO ER-ARCHIVO
              MOVE    REQ-AEP-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-AEP-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTCLI-GRAAEP.

       EJECT
       CD-GRABA-RCD-D.
      *---------------

       CHEQUEA-CLIENTE-EN-RCDD.

           MOVE CIC-CAI-ICIC TO  REQ-RCDC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO  REQ-RCDC-IIC-ICLI.
           MOVE '01'         TO  REQ-RCDC-CORR.

           PERFORM CB-BUSCA-EN-RCD.
           IF REQ-RCDC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CLIENTE YA EXISTE EN RCD SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   CIC CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  REQ-RCDC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-RCD-E.



       GENERA-CLIENTE-EN-RCDD.
           MOVE ' '          TO RCD-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO RCD-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO RCD-IIC-ICLI.
           MOVE 01           TO RCD-NUM-DIRE.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO RCD-FEC-FTRN.
           MOVE WS-HORA2  TO RCD-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO RCD-MSC-TACC.
           MOVE 'V'          TO RCD-MSC-STAT.
           MOVE 'B'          TO RCD-MSC-TTRN.
           MOVE '   '        TO RCD-COD-TTRN.

      *    MUEVE NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO RCD-COD-ATRN.

      *    MUEVE DOMICILIO AL TIPO DE DIRECCION.
           MOVE 'D'          TO RCD-MSC-TDIR.

      *    MUEVE 'CREADA' A CAMPO ESTADO DE DIRECCION.
           MOVE 'C'          TO RCD-MSC-SDIR.

      *    MOVE ZEROES A FECHA VERIFICACION.
           MOVE ZEROS        TO RCD-FEC-FVRF.

      *    MOVE DOMICILIO A DESCRIPCION DIRECCION.
           MOVE WS-TR1-DIRECCION   TO RCD-GLS-DIRE.

      *    CODIGO DE LUGAR.
           MOVE WS-TR1-COD-COMUNA  TO RCD-COD-LUGA.

      *    TELEFONO DE LA DIRECCION.
           MOVE WS-TR1-FONO        TO RCD-GLS-FONO.

      *    MOVE SPACES A FILLER DISPONIBLE.
           MOVE SPACES          TO RCD-GLS-DISP.

           MOVE 'ADDIT' TO REQ-RCD-CMD.
           MOVE 'RCD'   TO REQ-RCD-TBLNM.
           MOVE 'RCD00' TO REQ-RCD-KEYNM.
           MOVE 'RCD00' TO REQ-RCD-TBLID.
           MOVE 'RCD00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-RCD-AREA RCD ELEM-LIST.
           IF REQ-RCD-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CLIENTE-EN-RCD '   TO ER-PARRAFO
              MOVE   'RCD '                    TO ER-ARCHIVO
              MOVE    REQ-RCD-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-RCD-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTGRA-RCD-D.

       EJECT
       CD-GRABA-RCD-E.
      *---------------

       CHEQUEA-CLIENTE-EN-RCDE.

           IF WS-RCDE-CLI = 'N' THEN   GO TO CD-GRABA-DCC-CLIENTE.
           MOVE CIC-CAI-ICIC TO  REQ-RCDC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO  REQ-RCDC-IIC-ICLI.
           MOVE '02'         TO  REQ-RCDC-CORR.

           PERFORM CB-BUSCA-EN-RCD.
           IF REQ-RCDC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CLIENTE YA EXISTE EN RCD-E SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   CIC CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  REQ-RCDC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-DCC-CLIENTE.



       GENERA-CLIENTE-EN-RCDE.
           MOVE ' '          TO RCD-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO RCD-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO RCD-IIC-ICLI.
           MOVE 02           TO RCD-NUM-DIRE.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO RCD-FEC-FTRN.
           MOVE WS-HORA2 TO RCD-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO RCD-MSC-TACC.
           MOVE 'V'          TO RCD-MSC-STAT.
           MOVE 'B'          TO RCD-MSC-TTRN.
           MOVE '   '        TO RCD-COD-TTRN.

      *    NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO RCD-COD-ATRN.

      *    MUEVE EMPRESA   AL TIPO DE DIRECCION.
           MOVE 'E'          TO RCD-MSC-TDIR.

      *    MUEVE 'CREADA' A CAMPO ESTADO DE DIRECCION.
           MOVE 'C'          TO RCD-MSC-SDIR.

      *    MOVE ZEROES A FECHA VERIFICACION.
           MOVE ZEROS        TO RCD-FEC-FVRF.

      *    MOVE DIRECCION LABORAL A DESCRIPCION DIRECCION.
           MOVE WS-TR2-DIRECCION   TO RCD-GLS-DIRE.

      *    CODIGO DE LUGAR  (COMUNA DE DIRECCION LABORAL).
           MOVE WS-TR2-COD-COMUNA   TO RCD-COD-LUGA.

      *    TELEFONO DE LA EMRESA.
           MOVE WS-TR2-FONO     TO RCD-GLS-FONO.

      *    MOVE SPACES A FILLER DISPONIBLE.
           MOVE SPACES       TO RCD-GLS-DISP.

           MOVE 'ADDIT' TO REQ-RCD-CMD.
           MOVE 'RCD'   TO REQ-RCD-TBLNM.
           MOVE 'RCD00' TO REQ-RCD-KEYNM.
           MOVE 'RCD00' TO REQ-RCD-TBLID.
           MOVE 'RCD00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-RCD-AREA RCD ELEM-LIST.
           IF REQ-RCD-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CLIENTE-EN-RCDE'   TO ER-PARRAFO
              MOVE   'RCD '                    TO ER-ARCHIVO
              MOVE    REQ-RCD-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-RCD-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTGRA-RCD-E.

       EJECT
       CD-GRABA-DCC-CLIENTE.
      *----------------------

       CHEQUEA-CLIENTE-EN-DCC.

           MOVE CIC-CAI-ICIC TO  REQ-DCCC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO  REQ-DCCC-IIC-ICLI.

           PERFORM CB-BUSCA-EN-DCC.
           IF REQ-DCCC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CLIENTE YA EXISTE EN DCC   SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   CIC CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  REQ-DCCC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-REC-CLI-EMP.



       GENERA-CLIENTE-EN-DCC.
           MOVE ' '          TO DCC-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO DCC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO DCC-IIC-ICLI.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO DCC-FEC-FTRN.
           MOVE WS-HORA2 TO DCC-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO DCC-MSC-TACC.
           MOVE 'V'          TO DCC-MSC-STAT.
           MOVE 'B'          TO DCC-MSC-TTRN.
           MOVE '   '        TO DCC-COD-TTRN.

      *    MUEVE NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO DCC-COD-ATRN.

      *    NUMERO DE DOCUMENTOS PROTESTADOS.
           MOVE ZEROS        TO DCC-NUM-TCHP.

      *    NUMERO DE DOCUMENTOS ACLARADOS.
           MOVE ZEROS        TO DCC-NUM-TCHA.

      *    INDICADOR DE PROTESTOS EN BOLETIN.
           MOVE ' '          TO DCC-IND-PBOL.

      *    NRO. DE UNIDADES PERIODO BLOQUEO CTACTE.
           MOVE ZEROS        TO DCC-NUM-UPBC.

      *    UNIDAD TIEMPO PERIODO BLOQUEO CTACTE.
           MOVE ' '          TO DCC-IND-UTBC.

      *    FECHA INICIO BLOQUEO CTACTE.
           MOVE '00000000'   TO DCC-FEC-FIBC.

      *    NRO. TOTAL DE DOCTOS. PROTESTADOS HISTORICOS.
           MOVE ZEROS        TO DCC-NUM-TDPH.

      *    NRO. TOTAL DE DOCTOS. ACLARADOS   HISTORICOS.
           MOVE ZEROS        TO DCC-NUM-TDAH.

      *    RECHAZO DE APERTURA CTACTE.
           MOVE ' '          TO DCC-COD-RCHZ.

      *    OFICINA DE RECHAZO DE APERTURA CTACTE.
           MOVE '   '        TO DCC-COD-OFIR.

      *    DISPONIBLE.
           MOVE SPACES       TO DCC-GLS-DISP.

           MOVE 'ADDIT' TO REQ-DCC-CMD.
           MOVE 'DCC'   TO REQ-DCC-TBLNM.
           MOVE 'DCC00' TO REQ-DCC-KEYNM.
           MOVE 'DCC00' TO REQ-DCC-TBLID.
           MOVE 'DCC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DCC-AREA DCC ELEM-LIST.
           IF REQ-DCC-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CLIENTE-EN-DCC '   TO ER-PARRAFO
              MOVE   'DCC '                    TO ER-ARCHIVO
              MOVE    REQ-DCC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-DCC-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTCLI-GRADCC.

       EJECT
       CD-GRABA-REC-CLI-EMP.
      *----------------------*

       CHEQUEA-CLIEMP-EN-REC.
      ***** CORREGIR LOGICA A POSTERIOR
           GO  TO FIN-CREA-TABLAS.


           MOVE CIC-CAI-ICIC TO REQ-RECC-CAI-ICIC.
           MOVE WS-NUM-ICIC  TO REQ-RECC-NUM-ICIC.
           MOVE 'FU'         TO REQ-RECC-TREL.
           MOVE WS-CAI-ICLI-EMP TO REQ-RECC-CAI-IREL.
           MOVE WS-IIC-ICLI-EMP TO REQ-RECC-NUM-IREL.
222222     MOVE '01'            TO REQ-RECC-NUM-TREC


           PERFORM CB-BUSCA-EN-REC.
           IF REQ-RECC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'RELACION CLIENTE-EMPRESA EXISTE EN REC SE IGNORA'
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   CIC CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  REQ-RECC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-REC-EMP-CLI.

       GENERA-CLIEMP-EN-REC.


           MOVE ' '          TO  REC-GLS-FLAG

      *    ASIGNA AL CIC DEL CLIENTE.
           MOVE CIC-CAI-ICIC TO REC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO REC-IIC-ICLI.

           MOVE 'FU' TO  REC-COD-TREC.

      *    ASIGNA AL CIC EL CIC DE3 LA EMPRESA LEIDA EN DBC.
           MOVE WS-CAI-ICLI-EMP TO REC-CAI-IREL.
           MOVE WS-IIC-ICLI-EMP TO REC-IIC-IREL.

      *    CORRELATIVO
           MOVE 01   TO  REC-NUM-TREC
      *    FECHA TRANSACCION
           MOVE WS-FEC-FDAT TO REC-FEC-FTRN.
      *    HORA TRANSACCION
           MOVE ALL '0'     TO  REC-HRA-HRTR.
      *    ASIGNA VALORES CORRESPONDIENTESA PROCESO BATCH DE CARGA.
           MOVE  'I'        TO    REC-MSC-TACC.
           MOVE  'V'        TO    REC-MSC-STAT.
           MOVE  'B'        TO    REC-MSC-TTRN.
           MOVE  '   '      TO    REC-COD-TTRN.
      *    MUEVE NOMBRE DEL PROGRAMA DE CARGA AL CAMPO AUTORIZADO.
           MOVE  'SGCPNEG'  TO    REC-COD-ATRN.
      *
      *    INDICADOR DE VIGENCIA RELACION (S/N)
           MOVE 'S'  TO  REC-IND-VIGE
      *
      *    FECHA INICIO DE LA RELACION
           MOVE  WS-TR2-FING-DD    TO REC-NUM-DINI.
           MOVE  WS-TR2-FING-MM    TO REC-NUM-MINI.
           MOVE  WS-TR2-FING-AA2   TO REC-NUM-AINI.
           MOVE  WS-TR2-FING-AA1   TO REC-NUM-SINI.
      *
      *    FECHA INICIO COMPUTACIONAL
           MOVE WS-FEC-FDAT TO  REC-FEC-FINP.
      *
      *    FECHA DE TERMINO DE LA RELACION
           MOVE ALL '0' TO  REC-FEC-FTER.
      *
      *    FECHA DE TERMINO COMPUTACIONAL
           MOVE ALL '0' TO  REC-FEC-FOUT.
      *
      *    CODIGO ASOCIADO A LA RELACION
           MOVE ALL ' ' TO  REC-COD-AREC.
      *
      *    Valor Asociado a la Relacion
           MOVE +0      TO  REC-SGV-AREC.
      *
      *    MISCELANEO TIPO VALOR.
           MOVE SPACES  TO  REC-MSC-TVAL.
      *
      *    CODIGO VALOR
           MOVE SPACES  TO  REC-COD-CVAL.
      *
      *    CODIGO TIPO CAMBIO
           MOVE SPACES  TO  REC-COD-TCAM.
      *
      *    FECHA REFERENCIA VALOR ASOCIADO A RELACION
           MOVE ALL '0' TO  REC-FEC-FVAL.
      *
      *    Fecha de Verificacion
           MOVE ALL '0' TO   REC-FEC-FVRF.
      *
      *    GLOSA DISPONIBLE
           MOVE SPACES  TO   REC-GLS-DISP.
      *

111111     DISPLAY 'GENERA-CLIEMP-EN-REC.'
111111     DISPLAY '  REC:' REC ':'
           MOVE 'ADDIT' TO REQ-REC-CMD.
           MOVE 'REC'   TO REQ-REC-TBLNM.
           MOVE 'REC00' TO REQ-REC-KEYNM.
           MOVE 'REC00' TO REQ-REC-TBLID.
           MOVE 'REC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-REC-AREA REC ELEM-LIST.
           IF REQ-REC-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CLIENTE-EN-REC '   TO ER-PARRAFO
              MOVE   'REC '                    TO ER-ARCHIVO
              MOVE    REQ-REC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-REC-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTGRA-REC-CLI-EMP.
      *
       EJECT
       CD-GRABA-REC-EMP-CLI.
      *----------------------*

       CHEQUEA-EMPCLI-EN-REC.

           MOVE WS-CAI-ICLI-EMP TO REQ-RECC-CAI-ICIC.
           MOVE WS-IIC-ICLI-EMP TO REQ-RECC-NUM-ICIC.
222222     MOVE 'EM'         TO REQ-RECC-TREL.
           MOVE CIC-CAI-ICIC TO REQ-RECC-CAI-IREL.
           MOVE WS-NUM-ICIC  TO REQ-RECC-NUM-IREL.
222222     MOVE '01'            TO REQ-RECC-NUM-TREC

           PERFORM CB-BUSCA-EN-REC.
           IF REQ-RECC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'RELACION EMPRESA-CLIENTE EXISTE EN REC SE IGNORA'
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   CIC CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  REQ-RECC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-DBC-CONYUGE.

       GENERA-EMPCLI-EN-REC.


           MOVE ' '  TO  REC-GLS-FLAG.

      *    ASIGNA AL CIC EL CIC DE  LA EMPRESA LEIDA EN DBC.
           MOVE WS-CAI-ICLI-EMP TO REC-CAI-ICLI.
           MOVE WS-IIC-ICLI-EMP TO REC-IIC-ICLI.

           MOVE 'EM' TO  REC-COD-TREC.

      *    ASIGNA AL CIC DEL CLIENTE RELACIONADO A LA EMPRESA.
           MOVE CIC-CAI-ICIC TO REC-CAI-IREL.
           MOVE WS-NUM-ICIC  TO REC-IIC-IREL.

      *    CORRELATIVO.
           MOVE 01   TO  REC-NUM-TREC.

      *    FECHA TRANSACCION
           MOVE WS-FEC-FDAT TO REC-FEC-FTRN.
      *    HORA TRANSACCION
           MOVE ALL '0'     TO  REC-HRA-HRTR.
      *    ASIGNA VALORES CORRESPONDIENTESA PROCESO BATCH DE CARGA.
           MOVE  'I'        TO    REC-MSC-TACC.
           MOVE  'V'        TO    REC-MSC-STAT.
           MOVE  'B'        TO    REC-MSC-TTRN.
           MOVE  '   '      TO    REC-COD-TTRN.
      *    MUEVE NOMBRE DEL PROGRAMA DE CARGA AL CAMPO AUTORIZADO.
           MOVE  'SGCPNEG'  TO    REC-COD-ATRN.
      *
      *    INDICADOR DE VIGENCIA RELACION (S/N)
           MOVE 'S'  TO  REC-IND-VIGE
      *
      *    FECHA INICIO DE LA RELACION
           MOVE  WS-TR2-FING-DD    TO REC-NUM-DINI.
           MOVE  WS-TR2-FING-MM    TO REC-NUM-MINI.
           MOVE  WS-TR2-FING-AA2   TO REC-NUM-AINI.
           MOVE  WS-TR2-FING-AA1   TO REC-NUM-SINI.
      *
      *    FECHA INICIO COMPUTACIONAL
           MOVE WS-FEC-FDAT TO  REC-FEC-FINP.
      *
      *    FECHA DE TERMINO DE LA RELACION
           MOVE ALL '0' TO  REC-FEC-FTER.
      *
      *    FECHA DE TERMINO COMPUTACIONAL
           MOVE ALL '0' TO  REC-FEC-FOUT.
      *
      *    CODIGO ASOCIADO A LA RELACION
           MOVE ALL ' ' TO  REC-COD-AREC.
      *
      *    Valor Asociado a la Relacion
           MOVE +0      TO  REC-SGV-AREC.
      *
      *    MISCELANEO TIPO VALOR.
           MOVE SPACES  TO  REC-MSC-TVAL.
      *
      *    CODIGO VALOR
           MOVE SPACES  TO  REC-COD-CVAL.
      *
      *    CODIGO TIPO CAMBIO
           MOVE SPACES  TO  REC-COD-TCAM.
      *
      *    FECHA REFERENCIA VALOR ASOCIADO A RELACION
           MOVE ALL '0' TO  REC-FEC-FVAL.
      *
      *    Fecha de Verificacion
           MOVE ALL '0' TO   REC-FEC-FVRF.
      *
      *    GLOSA DISPONIBLE
           MOVE SPACES  TO   REC-GLS-DISP.
      *
           MOVE 'ADDIT' TO REQ-REC-CMD.
           MOVE 'REC'   TO REQ-REC-TBLNM.
           MOVE 'REC00' TO REQ-REC-KEYNM.
           MOVE 'REC00' TO REQ-REC-TBLID.
           MOVE 'REC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-REC-AREA REC ELEM-LIST.
           IF REQ-REC-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-EMPCLI-EN-REC '   TO ER-PARRAFO
              MOVE   'REC '                    TO ER-ARCHIVO
              MOVE    REQ-REC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-REC-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTGRA-REC-EMP-CLI.
      *
      *
       EJECT
       CD-GRABA-DBC-CONYUGE.
      *----------------------


      * GRABA DATOS DEL CONYUGE SOLO SI CLIENTE ES CASADO.
           IF WS-TR1-CASADO AND WS-TR3-NUM-RUT-CONYUGE > ZEROS
              NEXT SENTENCE
           ELSE
              GO TO FIN-CREA-TABLAS.

       GUARDO-CIC-CLIENTE.
           MOVE WS-NUM-ICIC  TO WS-NUM-ICIC-CLTE.
           MOVE CIC-CAI-ICIC TO WS-CAI-ICIC-CLTE.
           DISPLAY 'WS-NUM-ICIC-CLTE: ' WS-NUM-ICIC-CLTE.

       CHEQUEA-CONYUGE-EN-DBC.
      *
           MOVE SPACES                  TO REQ-DBCC-KEY-VALUE.
           MOVE WS-TR3-NUM-RUT-CONYUGEX TO REQ-DBCC-KEY-VALUE.
           PERFORM CB-BUSCA-EN-DBC.

           IF REQ-DBCC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CONYUGE YA EXISTE EN DBC SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CONYUGE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-NUM-RUT-CONYUGE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1

      *  GUARDO EL CIC DEL CONYUGE EXISTENTE
              MOVE DBC-CAI-ICLI TO CIC-CAI-ICIC
              MOVE DBC-IIC-ICLI TO WS-NUM-ICIC
           DISPLAY 'WS-NUM-ICIC : ' WS-NUM-ICIC
              GO TO CD-GRABA-DCP-CONYUGE.

      *GENERA-CONYUGE-EN-DBC.

       OBTENGO-CIC-CONYUGE.
           PERFORM   CB-LEER-ULTIMO-CIC.
           PERFORM   CB-UPDAT-CIC.
           PERFORM   CB-RELES-CIC.


           MOVE ' '          TO DBC-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO DBC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO DBC-IIC-ICLI.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FTRN.
           MOVE WS-HORA2  TO DBC-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO DBC-MSC-TACC.
           MOVE 'V'          TO DBC-MSC-STAT.
           MOVE 'B'          TO DBC-MSC-TTRN.
           MOVE '   '        TO DBC-COD-TTRN.

      *    MUEVE NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO DBC-COD-ATRN.

      *    MUEVE EL RUT DEJANDO CON  S LA EXTENSION.
           MOVE WS-TR3-NUM-RUT-CONYUGE TO DBC-NUM-ICLI.
           MOVE ' '                 TO DBC-IND-ICLI.
           MOVE '   '               TO DBC-GLS-ICLI.
           MOVE WS-TR3-DV-RUT-CONYUGE  TO DBC-VRF-ICLI.

      *    SE MUEVE EL NOMBRE DEL CONYUGE.
           MOVE WS-TR3-APAT-CONYUGE TO DBC-GLS-APAT.
           MOVE WS-TR3-AMAT-CONYUGE TO DBC-GLS-AMAT.
           MOVE WS-TR3-NOMB-CONYUGE TO DBC-GLS-NOMB.

      *    MUEVE LAS 3 PRIMERAS LETRAS DE LOS NOMBRES AL SOUNDEX.
           MOVE DBC-GLS-APAT TO DBC-SNX-APAT.
           MOVE DBC-GLS-AMAT TO DBC-SNX-AMAT.
           MOVE DBC-GLS-NOMB TO DBC-SNX-NOMB.

      *    MUEVE EL CODIGO DE DOMICILIO A LA DIRECCION DE ENVIO CORRESP
           MOVE 01           TO DBC-NUM-DCOR.

      *    SEGUN EL RUT ASIGNA CODIGO DE PERSONA O EMPRESA.
           MOVE 'P'          TO DBC-IND-TICL.

      *    MUEVE EL CODIGO DE CLIENTE CUENTACORRENTISTA AL TIPO CLTE.
           MOVE WS-COD-TICL  TO DBC-COD-TICL.

      *    MUEVE SPACES AL CODIGO CLASIF. COMERCIAL.
           MOVE '  '         TO DBC-COD-CLCM.

      *    SE ASIGNA EJECUTIVO DE PARAMETRO.
           MOVE WS-COD-EJEC  TO DBC-COD-EJEC.

      *    ASIGNA LA OFICINA DE PARAMETRO.
           MOVE WS-COD-OFIC  TO DBC-COD-OFIC.

      *    MOVE SPACES AL INDICADOR OPERA OTRA OFICINA.
           MOVE 'N'          TO DBC-IND-OOFI.

      *    MOVE SPACES AL CODIGO ACTIVIDAD ECONOMICA.
           MOVE '         '  TO DBC-COD-ACTI.

      *    SEGUN EL RUT ASIGNA EL ORIGEN Y DESTINO SECTORIAL.
           MOVE '121'        TO DBC-COD-ODSE.

      *    MOVE ZEROES A LA FECHA DECLARACION ART. 85.
      *    MOVE 00000000     TO DBC-FEC-FA85.

      *    MOVE FECHA DE PROCESO A LA FECHA DE INGRESO AL PLAN.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FPLN.

      *    MOVE SPACES AL TIPO ULTIMO PAGO IMPUESTO A LA RENTA.
           MOVE '   '        TO DBC-IND-UPIR.

      *    MOVE ZEROES A LA FECHA ULTIMO PAGO IMPUESTO A LA RENTA.
           MOVE 00000000     TO DBC-FEC-FUPI.

      *    MOVE SPACES AL INDICADOR DE MULTAS BANCO CENTRAL.
           MOVE ' '          TO DBC-IND-MUBC.

      *    MOVE SPACES AL INDICADOR DE JUICIOS BANCO CENTRAL.
           MOVE ' '          TO DBC-IND-JUBC.

      *    MOVE 'CLTE. EN MARCHA' A CODIGO ESTADO CLIENTE.
           MOVE '4'          TO DBC-MSC-SCLI.

      *    MOVE CURRENT-DATE A FECHA ESTADO CLIENTE.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FSCL.

      *    MOVE 'SIN BLOQUEO' A CODIGO BLOQUEO CLIENTE.
           MOVE '  '         TO DBC-COD-BLOC.

      *    MOVE 01 A CAMPO TOTAL DIRECCIONES.
           MOVE 01           TO DBC-NUM-TDIR.

      *    MOVE ZEROES AL CAMPO NUMERO TOTAL DE COMENTARIOS.
           MOVE 000          TO DBC-NUM-TCMT.

      *    MOVE FECHA APERTURA A FECHA INICIO OPERACION.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FIOP.

      *    MOVE ZEROES A FECHA TERMINO OPERACION.
           MOVE 00000000     TO DBC-FEC-FTOP.

      *    MOVE ZEROES A OPERACIONES FECHA TERMINA NULA.
           MOVE 000          TO DBC-NUM-OFTN.

      *    MOVE CURRENT-DATE A FECHA INGRESO REG. A LA TABLA.
           MOVE WS-FEC-FDAT  TO DBC-FEC-FINP.

           MOVE 'ADDIT' TO REQ-DBC-CMD.
           MOVE 'DBC'   TO REQ-DBC-TBLNM.
           MOVE 'DBC00' TO REQ-DBC-KEYNM.
           MOVE 'DBC00' TO REQ-DBC-TBLID.
           MOVE 'DBC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DBC-AREA DBC ELEM-LIST.
           IF REQ-DBC-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'OBTENGO-CIC-CONYUGE  '   TO ER-PARRAFO
              MOVE   'DBC '                    TO ER-ARCHIVO
              MOVE    REQ-DBC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-DBC-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTCONY-GRADBC.

       EJECT
       CD-GRABA-DCP-CONYUGE.
      *----------------------

       CHEQUEA-CONYUGE-EN-DCP.

           MOVE CIC-CAI-ICIC TO REQ-DCPC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO REQ-DCPC-IIC-ICLI.

           PERFORM CB-BUSCA-EN-DCP.
           IF REQ-DCPC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CONYUGE YA EXISTE EN DCP SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CONYUGE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-NUM-RUT-CONYUGE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   CIC CONYUGE   : '  TO RPT-D02-GLOS
              MOVE  REQ-DCPC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-CONY-RCD-D.



       GENERA-CONYUGE-EN-DCP.
           MOVE ' '          TO DCP-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO DCP-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO DCP-IIC-ICLI.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO DCP-FEC-FTRN.
           MOVE WS-HORA2 TO DCP-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO DCP-MSC-TACC.
           MOVE 'V'          TO DCP-MSC-STAT.
           MOVE 'B'          TO DCP-MSC-TTRN.
           MOVE '   '        TO DCP-COD-TTRN.

      *    MUEVE NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO DCP-COD-ATRN.

      *    FECHA DE NACIMIENTO.
           MOVE WS-TR3-FNAC-AA1 TO DCP-NUM-SNAC.
           MOVE WS-TR3-FNAC-AA2 TO DCP-NUM-ANAC.
           MOVE WS-TR3-FNAC-MM  TO DCP-NUM-MNAC.
           MOVE WS-TR3-FNAC-DD  TO DCP-NUM-DNAC.

      *    MOVE SPACES A CODIGO DEL PAIS DE LA NACIONALIDAD.
           MOVE '   '           TO DCP-COD-PNAC.

      *    INDICADOR DE SEXO.
           MOVE WS-TR3-IND-SEXO    TO DCP-IND-SEXO.

      *    INDICADOR DE ESTADO CIVIL.
           MOVE WS-TR1-IND-ECIVIL  TO DCP-IND-ECIV.

      *    CEDULA DE IDENTIDAD.
           MOVE WS-TR3-NUM-RUT-CONYUGE  TO DCP-NUM-CIDE.

      *    DIG. VERIF. CEDULA DE IDENTIDAD.
           MOVE WS-TR3-DV-RUT-CONYUGE   TO DCP-VRF-CIDE.

      *    GABINETE CEDULA DE IDENTIDAD.
           MOVE SPACES       TO DCP-GLS-GABI.

      *    INDICADOR NIVEL EDUCACIONAL.
           MOVE WS-TR3-IND-NIV-EDUCACION  TO DCP-IND-NEDU.

      *    CODIGO ACTIVIDAD SECUNDARIA.
           MOVE SPACES                TO DCP-COD-ACTS.

      *    CODIGO DE PROFESION.
           MOVE WS-TR3-COD-PROFESION  TO DCP-COD-PROF.

      *    INDICADOR SITUACION LABORAL.
           MOVE '   '              TO DCP-IND-SLAB.

      *    CATEGORIA SOCIOECONOMICA.
           MOVE '  '               TO DCP-COD-CSEC.

      *    INDICADOR SITUACION CASA.
           MOVE ' '                TO DCP-IND-CASA.

           MOVE 'ADDIT' TO REQ-DCP-CMD.
           MOVE 'DCP'   TO REQ-DCP-TBLNM.
           MOVE 'DCP00' TO REQ-DCP-KEYNM.
           MOVE 'DCP00' TO REQ-DCP-TBLID.
           MOVE 'DCP00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DCP-AREA DCP ELEM-LIST.
           IF REQ-DCP-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CONYUGE-EN-DCP'   TO ER-PARRAFO
              MOVE   'DCP '                    TO ER-ARCHIVO
              MOVE    REQ-DCP-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-DCP-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTCONY-GRADCP.

       EJECT
       CD-GRABA-CONY-RCD-D.
      *---------------------

       CHEQUEA-CONYUGE-EN-RCDD.

           MOVE CIC-CAI-ICIC TO  REQ-RCDC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO  REQ-RCDC-IIC-ICLI.
           MOVE '01'         TO  REQ-RCDC-CORR.

           PERFORM CB-BUSCA-EN-RCD.
           IF REQ-RCDC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CONYUGE YA EXISTE EN RCD-D SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CONYUGE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-NUM-RUT-CONYUGE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   CIC CONYUGE   : '  TO RPT-D02-GLOS
              MOVE  REQ-RCDC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-REC-CLI-CONYUGE.



       GENERA-CONYUGE-EN-RCDD.
           MOVE ' '          TO RCD-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO RCD-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO RCD-IIC-ICLI.
           MOVE 01           TO RCD-NUM-DIRE.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO RCD-FEC-FTRN.
           MOVE WS-HORA2  TO RCD-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO RCD-MSC-TACC.
           MOVE 'V'          TO RCD-MSC-STAT.
           MOVE 'B'          TO RCD-MSC-TTRN.
           MOVE '   '        TO RCD-COD-TTRN.

      *    MUEVE NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO RCD-COD-ATRN.

      *    MUEVE DOMICILIO AL TIPO DE DIRECCION.
           MOVE 'D'          TO RCD-MSC-TDIR.

      *    MUEVE 'CREADA' A CAMPO ESTADO DE DIRECCION.
           MOVE 'C'          TO RCD-MSC-SDIR.

      *    MOVE ZEROES A FECHA VERIFICACION.
           MOVE ZEROS        TO RCD-FEC-FVRF.

      *    MOVE DOMICILIO A DESCRIPCION DIRECCION.
           MOVE WS-TR3-DIRECCION   TO RCD-GLS-DIRE.

      *    CODIGO DE LUGAR.
           MOVE WS-TR3-COD-COMUNA  TO RCD-COD-LUGA.

      *    TELEFONO DE LA DIRECCION.
           MOVE WS-TR3-FONO        TO RCD-GLS-FONO.

      *    MOVE SPACES A FILLER DISPONIBLE.
           MOVE SPACES          TO RCD-GLS-DISP.

           MOVE 'ADDIT' TO REQ-RCD-CMD.
           MOVE 'RCD'   TO REQ-RCD-TBLNM.
           MOVE 'RCD00' TO REQ-RCD-KEYNM.
           MOVE 'RCD00' TO REQ-RCD-TBLID.
           MOVE 'RCD00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-RCD-AREA RCD ELEM-LIST.
           IF REQ-RCD-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CONYUGE-EN-RCDD'   TO ER-PARRAFO
              MOVE   'RCD '                    TO ER-ARCHIVO
              MOVE    REQ-RCD-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-RCD-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTGRA-RCD-CONY-D.
      *
       EJECT
       CD-GRABA-REC-CLI-CONYUGE.
      *-------------------------*

       CHEQUEA-CLICONY-EN-REC.

           MOVE WS-CAI-ICIC-CLTE TO REQ-RECC-CAI-ICIC.
           MOVE WS-NUM-ICIC-CLTE  TO REQ-RECC-NUM-ICIC.
           MOVE 'CY'              TO REQ-RECC-TREL.
           MOVE CIC-CAI-ICIC      TO REQ-RECC-CAI-IREL.
222222     MOVE WS-NUM-ICIC       TO REQ-RECC-NUM-IREL.
222222     MOVE '01'              TO REQ-RECC-NUM-TREC

111111     DISPLAY 'CHEQUEA-CLICONY-EN-REC.'
111111     DISPLAY '  REQ-RECC-KEY-VALUE:' REQ-RECC-KEY-VALUE ':'
           PERFORM CB-BUSCA-EN-REC.
           IF REQ-RECC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'RELACION CLIENTE-CONYUGE EXISTE EN REC SE IGNORA'
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CONYUGE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-NUM-RUT-CONYUGE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE 'CIC REL CLI-CONY : '  TO RPT-D02-GLOS
              MOVE  REQ-RECC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-REC-CONYUGE-CLI.

       GENERA-CLICONY-EN-REC.

           MOVE ' '  TO  REC-GLS-FLAG.

      *    ASIGNA EL CIC DEL CLIENTE.
           MOVE WS-CAI-ICIC-CLTE  TO REC-CAI-ICLI.
           MOVE WS-NUM-ICIC-CLTE  TO REC-IIC-ICLI.

           MOVE 'CY' TO  REC-COD-TREC.

      *    ASIGNA EL CIC DEL CONYUGE RELACIONADO CON EL CLIENTE.
           MOVE CIC-CAI-ICIC TO REC-CAI-IREL.
           MOVE WS-NUM-ICIC  TO REC-IIC-IREL.

      *    CORRELATIVO.
           MOVE 01   TO  REC-NUM-TREC
      *    FECHA TRANSACCION
           MOVE WS-FEC-FDAT TO REC-FEC-FTRN.
      *    HORA TRANSACCION
           MOVE ALL '0'     TO  REC-HRA-HRTR.
      *    ASIGNA VALORES CORRESPONDIENTESA PROCESO BATCH DE CARGA.
           MOVE  'I'        TO    REC-MSC-TACC.
           MOVE  'V'        TO    REC-MSC-STAT.
           MOVE  'B'        TO    REC-MSC-TTRN.
           MOVE  '   '      TO    REC-COD-TTRN.
      *    MUEVE NOMBRE DEL PROGRAMA DE CARGA AL CAMPO AUTORIZADO.
           MOVE  'SGCPNEG'  TO    REC-COD-ATRN.
      *
      *    INDICADOR DE VIGENCIA RELACION (S/N)
           MOVE 'S'  TO  REC-IND-VIGE
      *
      *    FECHA INICIO DE LA RELACION
           MOVE  WS-TR2-FING-DD    TO REC-NUM-DINI.
           MOVE  WS-TR2-FING-MM    TO REC-NUM-MINI.
           MOVE  WS-TR2-FING-AA2   TO REC-NUM-AINI.
           MOVE  WS-TR2-FING-AA1   TO REC-NUM-SINI.
      *
      *    FECHA INICIO COMPUTACIONAL
           MOVE WS-FEC-FDAT TO  REC-FEC-FINP.
      *
      *    FECHA DE TERMINO DE LA RELACION
           MOVE ALL '0' TO  REC-FEC-FTER.
      *
      *    FECHA DE TERMINO COMPUTACIONAL
           MOVE ALL '0' TO  REC-FEC-FOUT.
      *
      *    CODIGO ASOCIADO A LA RELACION
           MOVE ALL ' ' TO  REC-COD-AREC.
      *
      *    Valor Asociado a la Relacion
           MOVE +0      TO  REC-SGV-AREC.
      *
      *    MISCELANEO TIPO VALOR.
           MOVE SPACES  TO  REC-MSC-TVAL.
      *
      *    CODIGO VALOR
           MOVE SPACES  TO  REC-COD-CVAL.
      *
      *    CODIGO TIPO CAMBIO
           MOVE SPACES  TO  REC-COD-TCAM.
      *
      *    FECHA REFERENCIA VALOR ASOCIADO A RELACION
           MOVE ALL '0' TO  REC-FEC-FVAL.
      *
      *    Fecha de Verificacion
           MOVE ALL '0' TO   REC-FEC-FVRF.
      *
      *    GLOSA DISPONIBLE
           MOVE SPACES  TO   REC-GLS-DISP.
      *
111111     DISPLAY 'GENERA-CLICONY-EN-REC.'
111111     DISPLAY '  REC:' REC ':'
           MOVE 'ADDIT' TO REQ-REC-CMD.
           MOVE 'REC'   TO REQ-REC-TBLNM.
           MOVE 'REC00' TO REQ-REC-KEYNM.
           MOVE 'REC00' TO REQ-REC-TBLID.
           MOVE 'REC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-REC-AREA REC ELEM-LIST.
           IF REQ-REC-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CLICONY-EN-REC '   TO ER-PARRAFO
              MOVE   'REC '                    TO ER-ARCHIVO
              MOVE    REQ-REC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-REC-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTGRA-REC-CLI-CON.
      *
      *
       EJECT
       CD-GRABA-REC-CONYUGE-CLI.
      *-------------------------*

       CHEQUEA-CONYCLI-EN-REC.

           MOVE WS-CAI-ICIC-CLTE TO REQ-RECC-CAI-IREL.
           MOVE WS-NUM-ICIC-CLTE  TO REQ-RECC-NUM-IREL.
           MOVE 'CY'              TO REQ-RECC-TREL.
           MOVE CIC-CAI-ICIC      TO REQ-RECC-CAI-ICIC.
222222     MOVE WS-NUM-ICIC       TO REQ-RECC-NUM-ICIC.
222222     MOVE '01'              TO REQ-RECC-NUM-TREC

           PERFORM CB-BUSCA-EN-REC.
           IF REQ-RECC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'RELACION CONYUGE-CLIENTE EXISTE EN REC SE IGNORA'
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CLIENTE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR1-RUT-CLIENTE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CONYUGE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-NUM-RUT-CONYUGE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE 'CIC REL CONY-CLI : '  TO RPT-D02-GLOS
              MOVE  REQ-RECC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO CD-GRABA-DCC-CONYUGE.

       GENERA-CONYCLI-EN-REC.

           MOVE ' '  TO  REC-GLS-FLAG.

      *    ASIGNA EL CIC AL CONYUGE.
           MOVE CIC-CAI-ICIC TO REC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO REC-IIC-ICLI.

           MOVE 'CY' TO  REC-COD-TREC.

      *    ASIGNA AL CIC AL CLIENTE RELACIONADO CON EL CONYUGE.
           MOVE WS-CAI-ICIC-CLTE  TO REC-CAI-IREL.
           MOVE WS-NUM-ICIC-CLTE  TO REC-IIC-IREL.

      *    CORRELATIVO.
           MOVE 01   TO  REC-NUM-TREC
      *    FECHA TRANSACCION
           MOVE WS-FEC-FDAT TO REC-FEC-FTRN.
      *    HORA TRANSACCION
           MOVE ALL '0'     TO  REC-HRA-HRTR.
      *    ASIGNA VALORES CORRESPONDIENTESA PROCESO BATCH DE CARGA.
           MOVE  'I'        TO    REC-MSC-TACC.
           MOVE  'V'        TO    REC-MSC-STAT.
           MOVE  'B'        TO    REC-MSC-TTRN.
           MOVE  '   '      TO    REC-COD-TTRN.
      *    MUEVE NOMBRE DEL PROGRAMA DE CARGA AL CAMPO AUTORIZADO.
           MOVE  'SGCPNEG'  TO    REC-COD-ATRN.
      *
      *    INDICADOR DE VIGENCIA RELACION (S/N)
           MOVE 'S'  TO  REC-IND-VIGE
      *
      *    FECHA INICIO DE LA RELACION
           MOVE  WS-TR2-FING-DD    TO REC-NUM-DINI.
           MOVE  WS-TR2-FING-MM    TO REC-NUM-MINI.
           MOVE  WS-TR2-FING-AA2   TO REC-NUM-AINI.
           MOVE  WS-TR2-FING-AA1   TO REC-NUM-SINI.
      *
      *    FECHA INICIO COMPUTACIONAL
           MOVE WS-FEC-FDAT TO  REC-FEC-FINP.
      *
      *    FECHA DE TERMINO DE LA RELACION
           MOVE ALL '0' TO  REC-FEC-FTER.
      *
      *    FECHA DE TERMINO COMPUTACIONAL
           MOVE ALL '0' TO  REC-FEC-FOUT.
      *
      *    CODIGO ASOCIADO A LA RELACION
           MOVE ALL ' ' TO  REC-COD-AREC.
      *
      *    Valor Asociado a la Relacion
           MOVE +0      TO  REC-SGV-AREC.
      *
      *    MISCELANEO TIPO VALOR.
           MOVE SPACES  TO  REC-MSC-TVAL.
      *
      *    CODIGO VALOR
           MOVE SPACES  TO  REC-COD-CVAL.
      *
      *    CODIGO TIPO CAMBIO
           MOVE SPACES  TO  REC-COD-TCAM.
      *
      *    FECHA REFERENCIA VALOR ASOCIADO A RELACION
           MOVE ALL '0' TO  REC-FEC-FVAL.
      *
      *    Fecha de Verificacion
           MOVE ALL '0' TO   REC-FEC-FVRF.
      *
      *    GLOSA DISPONIBLE
           MOVE SPACES  TO   REC-GLS-DISP.
      *
           MOVE 'ADDIT' TO REQ-REC-CMD.
           MOVE 'REC'   TO REQ-REC-TBLNM.
           MOVE 'REC00' TO REQ-REC-KEYNM.
           MOVE 'REC00' TO REQ-REC-TBLID.
           MOVE 'REC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-REC-AREA REC ELEM-LIST.
           IF REQ-REC-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CONYCLI-EN-REC '   TO ER-PARRAFO
              MOVE   'REC '                    TO ER-ARCHIVO
              MOVE    REQ-REC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-REC-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTGRA-REC-CON-CLI.
      *

       EJECT
       CD-GRABA-DCC-CONYUGE.
      *----------------------

       CHEQUEA-CONYUGE-EN-DCC.

           MOVE CIC-CAI-ICIC TO  REQ-DCCC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO  REQ-DCCC-IIC-ICLI.

           PERFORM CB-BUSCA-EN-DCC.
           IF REQ-DCCC-RETURN-CODE  = '14'
              NEXT SENTENCE
           ELSE
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 3
              MOVE 'CONYUGE YA EXISTE EN DCC   SE IGNORA   '
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              MOVE 'TIPO DE REGISTRO : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-TIPO-REG       TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '   RUT CONYUGE   : '  TO RPT-D02-GLOS
              MOVE  WS-TR3-NUM-RUT-CONYUGE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE 'CIC REL CONY-CLI : '  TO RPT-D02-GLOS
              MOVE  REQ-DCCC-KEY-VALUE    TO RPT-D02-EJEC
              WRITE REG-RPTEJEC FROM RPT-D02 AFTER 1
              MOVE '====================================='
                                          TO RPT-D03-GLOS
              WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1
              GO TO FIN-CREA-TABLAS.



       GENERA-CONYUGE-EN-DCC.
           MOVE ' '          TO DCC-GLS-FLAG.

      *    ASIGNA AL CIC EL SIGUIENTE NUMERO SECUENCIAL.
           MOVE CIC-CAI-ICIC TO DCC-CAI-ICLI.
           MOVE WS-NUM-ICIC  TO DCC-IIC-ICLI.

      *    MUEVE LA FECHA Y HORA DE PROCESO.
           MOVE WS-FEC-FDAT  TO DCC-FEC-FTRN.
           MOVE WS-HORA2 TO DCC-HRA-HRTR.

      *    ASIGNA VALORES CORRESPONDIENTES A PROCESO BATCH DE CARGA.
           MOVE 'I'          TO DCC-MSC-TACC.
           MOVE 'V'          TO DCC-MSC-STAT.
           MOVE 'B'          TO DCC-MSC-TTRN.
           MOVE '   '        TO DCC-COD-TTRN.

      *    MUEVE NOMBRE DEL PGM. DE CARGA AL CAMPO AUTOR.
           MOVE 'SGCPNEG'   TO DCC-COD-ATRN.

      *    NUMERO DE DOCUMENTOS PROTESTADOS.
           MOVE ZEROS        TO DCC-NUM-TCHP.

      *    NUMERO DE DOCUMENTOS ACLARADOS.
           MOVE ZEROS        TO DCC-NUM-TCHA.

      *    INDICADOR DE PROTESTOS EN BOLETIN.
           MOVE ' '          TO DCC-IND-PBOL.

      *    NRO. DE UNIDADES PERIODO BLOQUEO CTACTE.
           MOVE ZEROS        TO DCC-NUM-UPBC.

      *    UNIDAD TIEMPO PERIODO BLOQUEO CTACTE.
           MOVE ' '          TO DCC-IND-UTBC.

      *    FECHA INICIO BLOQUEO CTACTE.
           MOVE '00000000'   TO DCC-FEC-FIBC.

      *    NRO. TOTAL DE DOCTOS. PROTESTADOS HISTORICOS.
           MOVE ZEROS        TO DCC-NUM-TDPH.

      *    NRO. TOTAL DE DOCTOS. ACLARADOS   HISTORICOS.
           MOVE ZEROS        TO DCC-NUM-TDAH.

      *    RECHAZO DE APERTURA CTACTE.
           MOVE ' '          TO DCC-COD-RCHZ.

      *    OFICINA DE RECHAZO DE APERTURA CTACTE.
           MOVE '   '        TO DCC-COD-OFIR.

      *    DISPONIBLE.
           MOVE SPACES       TO DCC-GLS-DISP.


           MOVE 'ADDIT' TO REQ-DCC-CMD.
           MOVE 'DCC'   TO REQ-DCC-TBLNM.
           MOVE 'DCC00' TO REQ-DCC-KEYNM.
           MOVE 'DCC00' TO REQ-DCC-TBLID.
           MOVE 'DCC00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-DCC-AREA DCC ELEM-LIST.
           IF REQ-DCC-RETURN-CODE NOT = '  '
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'GENERA-CONYUGE-EN-DCC '   TO ER-PARRAFO
              MOVE   'REC '                    TO ER-ARCHIVO
              MOVE    REQ-DCC-RETURN-CODE TO ER-FILE-ST
              MOVE    REQ-DCC-AREA             TO ER-MENSAJE
              MOVE    'ADDIT '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR
              GO TO FIN-CREA-TABLAS.

            ADD  1  TO  WS-TOTCONY-GRADCC.

       FIN-CREA-TABLAS.  EXIT.

       EJECT

       VALIDAR-ARCLIEN SECTION.
      *------------------------*
       EC-PROCESO-VALIDACION.
      *----------------------*
           MOVE 'S' TO WS-VALIDO
           PERFORM VALIDA-TCL
           IF WS-VALIDO = 'S'
              EVALUATE WS-TR1-COD-TICL
                WHEN 'CA'
                  PERFORM EC-PROCESO-TCL-CO
                WHEN 'CL'
                  PERFORM EC-PROCESO-TCL-CO
                WHEN 'CO'
                  PERFORM EC-PROCESO-TCL-CO
                WHEN 'CP'
                  PERFORM EC-PROCESO-TCL-CO
                WHEN 'EE'
                  PERFORM EC-PROCESO-TCL-CO
                WHEN OTHER
                  DISPLAY 'OTRO WS-TR1-COD-TICL' WS-TR1-COD-TICL
                  MOVE 'N' TO WS-VALIDO
              END-EVALUATE
           END-IF.
           GO TO EXIT-VA.

       EC-PROCESO-TCL-CO.
      *-----------------*
           MOVE 'S' TO WS-VALIDO
           PERFORM ED-VALIDA-OBLIGA-CO
           IF WS-VALIDO = 'S'
              PERFORM ED-VALIDO-OPCIONAL-CO
              MOVE 'S' TO WS-VALIDO
              MOVE 'N' TO WS-AEP-CLI
              MOVE 'N' TO WS-RCDE-CLI
           END-IF.

       ED-VALIDA-OBLIGA-CO.
      *-------------------*
           PERFORM VALIDA-NOMBRE-CLIENTE
           PERFORM VALIDA-RUT-CLIENTE
           PERFORM VALIDA-DIRECCION
           PERFORM VALIDA-COD-COMUNA
           PERFORM VALIDA-COD-EJECUTIVO
           PERFORM VALIDA-COD-OFICINA
           PERFORM VALIDA-COD-ACTIVIDAD.


       ED-VALIDO-OPCIONAL-CO.
      *---------------------*
      *
      *** PARA TABLA DCP
           MOVE 'S' TO WS-VALIDO
           PERFORM VALIDA-FECHA-NACTO
           IF WS-VALIDO = 'N'
              MOVE 0 TO WS-TR1-FNAC-DD
                        WS-TR1-FNAC-MM
                        WS-TR1-FNAC-AA1
                        WS-TR1-FNAC-AA2
           END-IF
      *
           MOVE 'S' TO WS-VALIDO
           PERFORM VALIDA-IND-ECIVIL
           IF WS-VALIDO = 'N'
              MOVE SPACES TO WS-TR1-IND-ECIVIL
           END-IF
      *
           MOVE 'S' TO WS-VALIDO
           PERFORM VALIDA-IND-NIV-EDUC
           IF WS-VALIDO = 'N'
              MOVE SPACES TO WS-TR1-IND-NIV-EDUCACION
           END-IF
      *
           MOVE 'S' TO WS-VALIDO
           PERFORM VALIDA-COD-PROFESION
           IF WS-VALIDO = 'N'
              MOVE SPACES TO WS-TR1-COD-PROFESION
           END-IF
      *
           MOVE 'S' TO WS-VALIDO
           PERFORM VALIDA-IND-SIT-CASA
           IF WS-VALIDO = 'N'
              MOVE SPACES TO WS-TR1-IND-SIT-CASA
           END-IF
      *
           MOVE 'S' TO WS-VALIDO
           PERFORM VALIDA-IND-REGCONY
           IF WS-VALIDO = 'N'
              MOVE SPACES TO WS-TR1-IND-RCONYUGAL
           END-IF.
      *
           MOVE SPACES  TO WS-COD-TPLN.
           MOVE 'S' TO WS-VALIDO.

       VALIDA-TCL.
      *-----------
           MOVE SPACES               TO REQ-TAB-KEY-VALUE-TCL.
           MOVE 'TCL'                TO REQ-TAB-KEY-TCLI.
           MOVE WS-TR1-COD-TICL      TO REQ-TAB-KEY-TCLIENTE
           MOVE 'REDKX'              TO REQ-TAB-CMD-TCL.
           MOVE 'TAB00'              TO REQ-TAB-KEY-TCL.
           MOVE 'TAB00'              TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-TAB-AREA-TCL TAB ELEM-LIST
           IF REQ-TAB-RTN-CODE-TCL NOT = '  ' AND NOT = '14'
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'VALIDA-TCL        '       TO ER-PARRAFO
              MOVE   'TCL '                    TO ER-ARCHIVO
              MOVE    REQ-TAB-RTN-CODE TO ER-FILE-ST
              MOVE    REQ-TAB-AREA             TO ER-MENSAJE
              MOVE    'REDKX '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR.

           IF REQ-TAB-RTN-CODE-TCL = '14'
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLIENTE RECHAZADO POR TICL  INVALIDO '
                                          TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG       TO L4-TIPO
              MOVE  WS-TR1-COD-TICL       TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-NOMBRE-CLIENTE.
           IF (WS-TR1-APAT-CLIENTE NOT = SPACES)  AND
              (WS-TR1-AMAT-CLIENTE NOT = SPACES)  AND
              (WS-TR1-NOMB-CLIENTE NOT = SPACES)
              NEXT SENTENCE
           ELSE
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLIENTE RECHAZADO NOMBRE  INVALIDO   '
                                             TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG          TO L4-TIPO
              MOVE  WS-TR1-NOMBRE-CLIENTE    TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-RUT-CLIENTE.
           IF (WS-TR1-NUM-RUT-CLIENTEX IS NUMERIC AND
              WS-TR1-NUM-RUT-CLIENTE > ZEROS)     AND
              (WS-TR1-DV-RUT-CLIENTE NOT = SPACES)
              NEXT SENTENCE
           ELSE
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLIENTE RECHAZADO POR RUT INVALIDO   '
                                          TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG       TO L4-TIPO
              MOVE  WS-TR1-RUT-CLIENTE    TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-DIRECCION.
           IF (WS-TR1-DIRECCION NOT = SPACES)
              NEXT SENTENCE
           ELSE
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLTE RECH. DIRECCION      INVALIDA   '
                                          TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG       TO L4-TIPO
              MOVE  WS-TR1-DIRECCION      TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-COD-COMUNA.
           MOVE 'S'                  TO WS-VALIDO-COMUNA.
           MOVE WS-TR1-COD-COMUNA    TO WS-COD-COMUNA.
           PERFORM CB-BUSCA-COD-COMUNA.
           IF WS-VALIDO-COMUNA = 'S'
              NEXT SENTENCE
           ELSE
              MOVE 'N' TO WS-VALIDO
              MOVE  WS-TR1-TIPO-REG    TO L4-TIPO
              MOVE 'CLTE RECH. COD COMUNA     INVALIDO'
                                       TO L4-MENSAJE
              MOVE WS-TR1-COD-COMUNA   TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-COD-EJECUTIVO.
      *---------------------
           MOVE 'REDKY'     TO REQ-CMD-USR.
           MOVE 'USR'       TO REQ-TBLNM-USR.
           MOVE 'USR00'     TO REQ-KEYNM-USR.
           MOVE 'EJC'       TO REQ-USR-TIPO-USR.
           MOVE WS-TR1-COD-EJEC TO REQ-USR-EJEC-USR.
           MOVE 'USR00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-AREA-USR USR ELEM-LIST.
           IF REQ-RETURN-CODE-USR NOT = '  ' AND NOT = '14'
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'VALIDA-COD-EJECUTIVO '       TO ER-PARRAFO
              MOVE   'USR '                    TO ER-ARCHIVO
              MOVE    REQ-RETURN-CODE-USR TO ER-FILE-ST
              MOVE    REQ-AREA-USR             TO ER-MENSAJE
              MOVE    'REDKY '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR.
           IF REQ-RETURN-CODE-USR = '14'
              MOVE 'N'  TO WS-VALIDO
              MOVE  WS-TR1-TIPO-REG    TO L4-TIPO
              MOVE 'CLIENTE RECHAZADO POR EJEC. INVALIDO '
                                       TO L4-MENSAJE
              MOVE WS-TR1-COD-EJEC     TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-COD-OFICINA.
      *---------------
           MOVE 'REDKY'     TO REQ-CMD-OFI.
           MOVE 'OFI'       TO REQ-TBLNM-OFI.
           MOVE 'OFI00'     TO REQ-KEYNM-OFI.
           MOVE WS-TR1-COD-OFIC TO REQ-OFI
           MOVE 'OFI00' TO ELEM.
           CALL 'DBNTRY' USING UIB REQ-AREA-OFI OFI ELEM-LIST.
           IF REQ-RETURN-CODE-OFI NOT = '  ' AND NOT = '14'
              MOVE  'C-PROCESAR        '       TO ER-SECCION
              MOVE  'VALIDA-COD-OFICINA'       TO ER-PARRAFO
              MOVE   'OFI '                    TO ER-ARCHIVO
              MOVE    REQ-TAB-RTN-CODE TO ER-FILE-ST
              MOVE    REQ-TAB-AREA             TO ER-MENSAJE
              MOVE    'REDKY '                    TO ER-OPERACI
              PERFORM BD-DESPLIEGA-ERROR.
           IF REQ-RETURN-CODE-OFI = '14'
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLIENTE RECHAZADO POR OFIC. INVALIDO '
                                          TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG       TO L4-TIPO
              MOVE  WS-TR1-COD-OFIC       TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-COD-ACTIVIDAD.
           MOVE 'S'                  TO WS-VALIDO-ACTIV.
           MOVE WS-TR2-COD-ACTIVIDAD TO WS-COD-ACTIV.
           PERFORM CB-BUSCA-COD-ACTIV.
           IF WS-VALIDO-ACTIV = 'S'
              NEXT SENTENCE
           ELSE
              MOVE 'N' TO WS-VALIDO
              MOVE 'CLTE RECH. COD ACTIVIDAD  INVALIDO'
                                             TO L4-MENSAJE
              MOVE  WS-TR2-TIPO-REG          TO L4-TIPO
              MOVE '   RUT EMPRESA   : '     TO L4-MENSAJE-2
              MOVE  WS-TR2-RUT-EMPRESA       TO L4-DATO-2
              MOVE  WS-TR2-COD-ACTIVIDAD     TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

      * FIN CAMPOS OBLIGATORIOS, CAMPOS OPCIONALES

       VALIDA-FECHA-NACTO.
           IF ((WS-TR1-FECNAC-CLIENTE IS NUMERIC) AND
              (WS-TR1-FNAC-DD > ZEROS AND WS-TR1-FNAC-DD < 32) AND
              (WS-TR1-FNAC-MM > ZEROS AND WS-TR1-FNAC-MM < 13) AND
              (WS-TR1-FNAC-AA1 = 19)  AND
              (WS-TR1-FNAC-AA2 NOT < ZEROS)) OR
      *ECONTRE PARA QUE ACEPTE BLANCOS EN LA FECHA
              (WS-TR1-FNAC-DD = ZEROS AND
              WS-TR1-FNAC-MM = ZEROS AND
              WS-TR1-FNAC-AA1 = ZEROS  AND
              WS-TR1-FNAC-AA2 = ZEROS)
              NEXT SENTENCE
           ELSE
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLTE RECHAZADO FECHA NACTO INVALIDO'
                                             TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG          TO L4-TIPO
              MOVE  WS-TR1-FECNAC-CLIENTE    TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-IND-ECIVIL.
           IF  WS-TR1-CASADO OR WS-TR1-SOLTERO OR
               WS-TR1-SEPARADO OR WS-TR1-VIUDO
              NEXT SENTENCE
           ELSE
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLTE RECHA. INDIC. E.CIVIL INVALIDO'
                                             TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG          TO L4-TIPO
              MOVE  WS-TR1-IND-ECIVIL        TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-IND-NIV-EDUC.
           IF  WS-TR1-BASICA OR WS-TR1-MEDIA OR WS-TR1-PROFESIONAL OR
               WS-TR1-TECNICA OR WS-TR1-UNIVERSITARIA OR
      *ECONTRE DEBE PERMITIR INGRESAR
               WS-TR1-NIV-EDUC-BLAN
              NEXT SENTENCE
           ELSE
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLTE RECH. IND. NIV.EDUC. INVALIDO'
                                             TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG          TO L4-TIPO
              MOVE  WS-TR1-IND-NIV-EDUCACION TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-COD-PROFESION.
           MOVE 'S'                  TO WS-VALIDO-PROF.
           MOVE WS-TR1-COD-PROFESION TO WS-COD-PROFESION.
           PERFORM CB-BUSCA-COD-PROFESION.
           IF WS-VALIDO-PROF = 'S'
              NEXT SENTENCE
           ELSE
              MOVE 'N' TO WS-VALIDO
              MOVE 'CLTE RECH. COD PROFESION  INVALIDO'
                                             TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG          TO L4-TIPO
              MOVE WS-TR1-COD-PROFESION TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-IND-SIT-CASA.
           IF  WS-TR1-ARR-MENOS-12-MESES OR
               WS-TR1-ARR-DESDE-12A36    OR
               WS-TR1-ARR-MAS-36-MESES OR
               WS-TR1-PROP-PAGA-DIVID    OR
               WS-TR1-PROPIETARIO      OR
      *ECONTRE PERMITE INGRESAR EN BLANCO
               WS-TR1-ARR-BLANCO
              NEXT SENTENCE
           ELSE
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLTE RECH. IND. SIT. CASA INVALIDO'
                                             TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG          TO L4-TIPO
              MOVE  WS-TR1-IND-SIT-CASA      TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       VALIDA-IND-REGCONY.
           IF  WS-TR1-SOC-CONYUGAL OR WS-TR1-SEP-BIENES OR
               WS-TR1-PART-GANANCIA OR WS-TR1-SOC-CONYUGAL-0
              NEXT SENTENCE
           ELSE
              MOVE 'N'  TO WS-VALIDO
              MOVE 'CLTE RECH. IND. REG.CONY. INVALIDO'
                                             TO L4-MENSAJE
              MOVE  WS-TR1-TIPO-REG          TO L4-TIPO
              MOVE  WS-TR1-IND-RCONYUGAL     TO L4-DATO
              PERFORM GENERA-LISTADO
           END-IF.

       EJECT
       EXIT-VA.  EXIT.

       EJECT
       D-TERMINAR SECTION.
      *===================
       DA-ESTADISTICAS.
      *----------------
           MOVE      '*****************************************' TO
                   RPT-D03-GLOS.
                   WRITE REG-RPTEJEC FROM RPT-D03 AFTER 7.
           MOVE      '*                                       *' TO
                   RPT-D03-GLOS.
                   WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1.
           MOVE      '*        ESTADISTICAS DEL PROCESO       *' TO
                   RPT-D03-GLOS.
                   WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1.
           MOVE      '*                                       *' TO
                   RPT-D03-GLOS.
                   WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1.
           MOVE      '*****************************************' TO
                   RPT-D03-GLOS.
                   WRITE REG-RPTEJEC FROM RPT-D03 AFTER 1.
           MOVE '** TOTAL DE CLIENTES LEIDOS (TR=1) : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCLI-LEIDOS                        TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 5.

           MOVE '** TOTAL DE CLTES. LEIDOS CASADOS  : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCLI-CASADOS                       TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL DE CONYUGES LEIDOS (TR=3) : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCONY-LEIDOS                       TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL CLTES. RECH. VALIDACION   : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCLI-RECH                          TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL DE CLTES. GRABADOS  DBC   : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCLI-GRADBC                        TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 5.

           MOVE '** TOTAL DE CLTES. GRABADOS  DCP   : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCLI-GRADCP                        TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL DE CLTES. GRABADOS  DCC   : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCLI-GRADCC                        TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL DE CLTES. GRABADOS  AEP   : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCLI-GRAAEP                        TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL DE CLTES. GRAB. CASADOS   : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCLI-GRADBC-CAS                    TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL CLTES GRAB. OTRO  ECIVIL  : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCLI-GRADBC-OTR                    TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL CONYUGES GRABADOS EN  DBC : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCONY-GRADBC                       TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL CONYUGES GRABADOS EN  DCP : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCONY-GRADCP                       TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL CONYUGES GRABADOS EN  DCC : ' TO RPT-TOT-GLOS
           MOVE WS-TOTCONY-GRADCC                       TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL DE RCD  TIPO=D GRABADOS   : ' TO RPT-TOT-GLOS
           MOVE WS-TOTGRA-RCD-D                         TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 3.

           MOVE '** TOTAL DE RCD  TIPO=E GRABADOS   : ' TO RPT-TOT-GLOS
           MOVE WS-TOTGRA-RCD-E                         TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL RCD CONYUGE TIPO=D GRAB.  : ' TO RPT-TOT-GLOS
           MOVE WS-TOTGRA-RCD-CONY-D                    TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 3.

           MOVE '** TOTAL REC  CLIENTE-EMPRESA      : ' TO RPT-TOT-GLOS
           MOVE WS-TOTGRA-REC-CLI-EMP                   TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL REC  EMPRESA-CLIENTE      : ' TO RPT-TOT-GLOS
           MOVE WS-TOTGRA-REC-EMP-CLI                   TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL REC  CLIENTE-CONYUGE      : ' TO RPT-TOT-GLOS
           MOVE WS-TOTGRA-REC-CLI-CON                   TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.

           MOVE '** TOTAL REC  CONYUGE-CLIENTE      : ' TO RPT-TOT-GLOS
           MOVE WS-TOTGRA-REC-CON-CLI                   TO RPT-TOT-CAN
           WRITE REG-RPTEJEC FROM RPT-TOT AFTER 1.


       DB-CIERRA-REPORTER.
      *-------------------
           CLOSE RPTEJEC ARCLIEN LISTADO.

       DZ-FIN.  EXIT.

       GENERA-LISTADO SECTION.
      *--------------------
           IF CONT-LIN > 60
              PERFORM ENCABEZADO
           END-IF
           MOVE WS-TR1-TIPO-REG    TO L4-TIPO
           MOVE WS-TR1-RUT-CLIENTE TO L4-RUT
           WRITE R-LISTADO FROM L4 AFTER 1
           MOVE SPACES        TO L4
           ADD 1              TO CONT-LIN.

       GENERA-LISTADO-FIN.
      *------------------
           EXIT.

       ENCABEZADO SECTION.
      *------------------
           MOVE CONT-PAG TO L1-PAG.
           MOVE L1       TO R-LISTADO.
           WRITE R-LISTADO AFTER CANAL-1.
           MOVE L2       TO R-LISTADO.
           WRITE R-LISTADO AFTER 2
           MOVE L3       TO R-LISTADO
           WRITE R-LISTADO AFTER 2
           MOVE L5       TO R-LISTADO
           WRITE R-LISTADO AFTER 2.
           MOVE 5  TO CONT-LIN.
           ADD  1  TO CONT-PAG.
       ENCABEZADO-FIN.
      *------------------
           EXIT.


