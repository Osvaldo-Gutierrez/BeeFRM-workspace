*%! Codigo adicional para archivo
*% IF FIN_PUT_ALL_DBD
      *<<<< FIN_PUT_ALL_DBD
           PERFORM PUT-FRM-DBD.
      *>>>>
*% END
*% IF INI_PUT_DBC_DBD
      *<<<< INI_PUT_DBC_DBD
           IF PGM-STAT-DBC-NUL
               GO TO FIN-PUT-DBC-DBD.
           IF NOT PGM-STAT-DBC-OKS
               PERFORM CLR-DBC-DBD
               GO TO FIN-PUT-DBC-DBD.
      *>>>>
*% END
*% IF FIN_PUT_DBC_DBD
      *<<<< FIN_PUT_DBC_DBD
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO DBC-GLS-NOMC IN DBD-FLD.
      *>>>>
*% END
*% IF INI_PUT_DBD_DBD
      *<<<< INI_PUT_DBD_DBD
           IF PGM-STAT-DBD-NUL
               GO TO FIN-PUT-DBD-DBD.
           IF NOT PGM-STAT-DBD-OKS
               PERFORM CLR-DBD-DBD
               GO TO FIN-PUT-DBD-DBD.
      *>>>>
*% END
*% IF INI_PUT_CRI_DBD
      *<<<< INI_PUT_CRI_DBD
           IF PGM-STAT-CRI-NUL
               GO TO FIN-PUT-CRI-DBD.
           IF NOT PGM-STAT-CRI-OKS
               PERFORM CLR-CRI-DBD
               GO TO FIN-PUT-CRI-DBD.
      *>>>>
*% END
*% IF DBC_IND_ICLI
      *<<<< DBC_IND_ICLI
           MOVE DBC-IND-ICLI IN DBD-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
           MOVE IDC-IND-RUTV TO DBC-IND-ICLI IN DBD-FLD.
      *>>>>
*% END
*% IF DBC_GLS_ICLI
      *<<<< DBC_GLS_ICLI
      *VAL-GLS o VAL-IDC Valida glosa ( extension ) de identificador
           MOVE DBC-GLS-ICLI IN DBD-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
           MOVE IDC-GLS-RUTV TO DBC-GLS-ICLI IN DBD-FLD.
      *>>>>
*% END
*% IF DBC_VRF_ICLI
      *<<<< DBC_VRF_ICLI
           MOVE IDC-ZERO-S TO IDC-ZERO.
           MOVE DBC-NUM-ICLI IN DBD-FLD TO IDC-NUM-RUTV.
           MOVE DBC-VRF-ICLI IN DBD-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
      *>>>>
*% END
*% IF FIN_VAL_CON_KEY_DBD
      *<<<< FIN_VAL_CON_KEY_DBD
           IF DBC-GLS-NOMC IN DBD-FLD NOT > SPACES AND
              DBC-NUM-ICLI IN DBD-FLD = ZEROES
               MOVE 'GNS'       TO MSG-COD-SIST
               MOVE 'VALCONKEY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF EOF AND PGM_BQ
      *<<<< EOF
       PUT-FRM-DBD SECTION.
       INI-PUT-FRM-DBD.
           IF DBC-COD-EJEC IN DBC NOT > SPACES
               GO TO GET-FRM-GLS-OFIC.
           MOVE DBC-COD-EJEC IN DBC TO USR-COD-USER IN USR.
           PERFORM BUS-USR.
           MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN DBD-FLD.
       GET-FRM-GLS-OFIC.
           IF DBC-COD-OFIC IN DBC NOT > SPACES
               GO TO GET-FRM-GLS-ACTI.
           MOVE DBC-COD-OFIC IN DBC TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN DBD-FLD.
       GET-FRM-GLS-ACTI.
           IF DBC-COD-ACTI IN DBC NOT > SPACES
               GO TO GET-FRM-GLS-RELB.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ACT' TO TAB-COD-TTAB IN TAB.
           MOVE DBC-COD-ACTI IN DBC TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ACTI IN DBD-FLD.
       GET-FRM-GLS-RELB.
           PERFORM BUS-PPU.
           IF MSG-COD-MENS > SPACES
               MOVE MSG-GLS-DCOR TO FRM-GLS-RELB IN DBD-FLD
           ELSE
               PERFORM CIC-PPU
               IF MSG-COD-MENS > SPACES
                   MOVE MSG-GLS-DCOR TO FRM-GLS-RELB IN DBD-FLD
               ELSE
                   MOVE DBD-CAI-ICLI IN DBD-FLD TO PPU-CAI-ICLI
                   MOVE DBD-IIC-ICLI IN DBD-FLD TO PPU-IIC-ICLI
                   PERFORM BUS-RCU
                   MOVE TAB-GLS-DCOR IN TAB TO FRM-GLS-RELB IN DBD-FLD.
       GET-FRM-IND-DCOM.
           MOVE SPACES TO REC-KEY-IREC IN REC.
           MOVE DBD-CAI-ICLI IN DBD-FLD TO REC-CAI-ICLI IN REC.
           MOVE DBD-IIC-ICLI IN DBD-FLD TO REC-IIC-ICLI IN REC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GET-FRM-IND-DCOM.
           PERFORM SGC-FIO-REC.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO FRM-IND-DCOM IN DBD-FLD
               GO TO FIN-GET-FRM-IND-DCOM.
           IF REC-CAI-ICLI IN REC = DBD-CAI-ICLI IN DBD-FLD AND
              REC-IIC-ICLI IN REC = DBD-IIC-ICLI IN DBD-FLD
               IF REC-IND-VIGE IN REC = 'S' AND
                  REC-COD-TREC IN REC = REC-COD-DCOM
                   MOVE 'S' TO FRM-IND-DCOM IN DBD-FLD
               ELSE
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-GET-FRM-IND-DCOM
           ELSE
               MOVE 'N' TO FRM-IND-DCOM IN DBD-FLD.
       FIN-GET-FRM-IND-DCOM.
           MOVE DBD-CAI-ICLI IN DBD-FLD TO DSF-CAI-ICLI IN DSF.
           MOVE DBD-IIC-ICLI IN DBD-FLD TO DSF-IIC-ICLI IN DSF.
           MOVE 'DSF-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           PERFORM SGC-FIO-DSF.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO FRM-IND-DVCF IN DBD-FLD
               MOVE 'N' TO FRM-IND-DVDF IN DBD-FLD
               GO TO GET-RBS.
           IF DSF-VAL-DVCN IN DSF > ZEROES OR
      * NGA-INI/CAMBIO ARCHIVO DEUDA BANCARIA/OCT 2013
      *       DSF-VAL-DVCX IN DSF > ZEROES OR                           
      * NGA-FIN/CAMBIO ARCHIVO DEUDA BANCARIA/OCT 2013
              DSF-VAL-IVCT IN DSF > ZEROES
               MOVE 'S' TO FRM-IND-DVCF IN DBD-FLD
           ELSE
               MOVE 'N' TO FRM-IND-DVCF IN DBD-FLD.
      *    IF DSF-VAL-PVDT IN DSF  > ZEROES             CB2  DAD
      *        MOVE 'S' TO FRM-IND-DVDF IN DBD-FLD      CB2  DAD
      *    ELSE                                         CB2  DAD
               MOVE 'N' TO FRM-IND-DVDF IN DBD-FLD.
       GET-RBS.
           MOVE DBD-CAI-ICLI IN DBD-FLD TO RBS-CAI-ICLI IN RBS.
           MOVE DBD-IIC-ICLI IN DBD-FLD TO RBS-IIC-ICLI IN RBS.
           MOVE 'RBS-CIC-ICLI' TO FIO-AKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM SGC-FIO-RBS.
           IF FIO-STAT-OKS
               IF RBS-IND-ICSF IN RBS NOT > SPACES
                   MOVE 'N' TO FRM-IND-CASF IN DBD-FLD
               ELSE
                   MOVE RBS-IND-ICSF IN RBS TO FRM-IND-CASF IN DBD-FLD
           ELSE
               MOVE 'N' TO FRM-IND-CASF IN DBD-FLD.
       FIN-PUT-FRM-DBD.
           EXIT.
      *>>>>
*% END
*% IF VAL_CON_FLD_DBD
      *<<<< VAL_CON_FLD_DBD
           IF CRI-FEC-FCLA  IN DBD-FLD     > ZEROES AND
              FRM-COD-CRCB  IN DBD-FLD NOT > SPACES AND
              FRM-COD-CRCS  IN DBD-FLD NOT > SPACES AND
              FRM-COD-CRVB  IN DBD-FLD NOT > SPACES AND
              FRM-COD-CRVS  IN DBD-FLD NOT > SPACES
               MOVE 'DEU'        TO MSG-COD-SIST
               MOVE 'CRI    BLKS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC IN MSG TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF FRM_COD_CRVS
      *<<<< FRM_COD_CRVS
           IF SCR-CMND = 'ACR'
      *VAL-MSC Valida miscelaneo de tabla
               MOVE 'SGC' TO MSC-COD-SIST
               MOVE 'RIES' TO MSC-COD-TMSC IN MSC
               MOVE FRM-COD-CRVS IN DBD-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND.
      *>>>>
*% END
*% IF FRM_COD_CRVB
      *<<<< FRM_COD_CRVB
           IF SCR-CMND = 'ACR'
      *VAL-MSC Valida miscelaneo de tabla
               MOVE 'SGC' TO MSC-COD-SIST
               MOVE 'RIES' TO MSC-COD-TMSC IN MSC
               MOVE FRM-COD-CRVB IN DBD-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND.
      *>>>>
*% END
*% IF FRM_COD_CRCS
      *<<<< FRM_COD_CRCS
           IF SCR-CMND = 'ACR'
      *VAL-MSC Valida miscelaneo de tabla
               MOVE 'SGC' TO MSC-COD-SIST
               MOVE 'RIES' TO MSC-COD-TMSC IN MSC
               MOVE FRM-COD-CRCS IN DBD-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND.
      *>>>>
*% END
*% IF FRM_COD_CRCB
      *<<<< FRM_COD_CRCB
           IF SCR-CMND = 'ACR'
      *VAL-MSC Valida miscelaneo de tabla
               MOVE 'SGC' TO MSC-COD-SIST
               MOVE 'RIES' TO MSC-COD-TMSC IN MSC
               MOVE FRM-COD-CRCB IN DBD-FLD TO MSC-COD-CMSC IN MSC
               PERFORM VAL-IND.
      *>>>>
*% END
