*%! Codigo adicional para archivo
*% RA1 = "DBC"
*% RA2 = "FIA"
*% FRM = "ALZ"
*% NRA = 2
*% IF PGM_PER
*% INCLUDE DE ELEMENTOS DE C.A. PARA PLATAFORMA COMERCIAL
*% INCLUDE 'GNSPPPTC.TXT'
*% END
*% INCLUDE 'PFSALLALL'
*% IF FIN_SCR_VARI
      *<<<< FIN_SCR_VARI
       COPY GNSWV3CR.                                                   
      * PTC-FIN-AUT                                                     
      *<<<< FIN_SCR_VARI                                                
       COPY GNSWGRQA REPLACING                                          
                     ==01  ADR-REQA== BY ==02  SCR-DBC-REQA==.          
           02 SCR-KEY-IDBC                     PIC X(03).               
       COPY GNSWGRQA REPLACING                                          
                     ==01  ADR-REQA== BY ==02  SCR-FIA-REQA==.          
           02 SCR-KEY-IFIA                     PIC X(03).               
      *>>>>
*% END
*% IF WSS_DTC
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ESC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
      *>>>>
*% END
*% IF WSS
      *<<<< WSS
      * PTC-INI-AUT                                                     
      * COPY GNSWGFRM.                                                  
       COPY GNSWG3CF.                                                   
       COPY GNSWGQUE.                                                   
       COPY GNSWGTSK.                                                   
      * PTC-FIN-AUT  
      *MHM-INI 20-SEP-2006                                              
       COPY GNSWGCVT.                                                   
      *MHM-FIN 20-SEP-2006 
       COPY DEUBRESC.
       COPY SGCBRDBC.
       COPY GNSWGSTR.
       COPY GNSWGCPT.
       COPY TABBRTIO.
*% IF PGM_PU
      *LOP-INI 6-DIC-2002                                               
       COPY LDCWGCCU.                                                   
       COPY LDCWGCEG.                                                   
       COPY LDCBRCLF.                                                   
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CLF-REQA==.        
       COPY LDCBRRDC REPLACING RDC BY RDL.                              
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.        
      *LOP-FIN 6-DIC-2002   
*% END
       01  WSS-VARI.
           03 WSS-COD-TUSR                          PIC X(05).
           03 WSS-KEY-IFIA.
              05 WSS-CIC-IESC.
                 07 WSS-CAI-IESC                    PIC X(04).
                 07 WSS-IIC-IESC                    PIC X(08).
              05 WSS-NUM-IFIA                       PIC 9(02).
           03 WSS-CIC-ICLI                          PIC X(12).
           03 WSS-IFIA                      VALUE 0 PIC 9(01).
              88 EXISTE-FIANZA              VALUE 1.
           03 WSS-IESC                      VALUE 0 PIC 9(01).
              88 EXISTE-ESCRITURA           VALUE 1.
           03 WSS-IKEY                      VALUE 0 PIC 9(01).
*% IF PGM_PU
      *LOP-INI 6-DIC-2002                                               
           03 WSS-COD-CVMC.                                             
              05  WSS-COD-MENS                         PIC X(12).       
              05  WSS-COD-MEN2                         PIC X(12).       
              05  WSS-NUM-MENS                         PIC 9(02).       
              05  WSS-NUM-MEN2                         PIC 9(02).       
              05  WSS-CAMB                             PIC X(28).       
           03 WSS-FEC-FCIE     VALUE 0                 PIC 9(08).       
           03 WSS-CIC-ICLF                             PIC X(12).       
           03 WSS-IBUS                                 PIC 9(01).       
           03 WSS-IBUS-LDC                             PIC 9(01).       
           03 WSS-T                     VALUE ZEROES   PIC 9(02).       
           03 WSS-IND-ALZA          VALUE SPACES    PIC X(03).          
      *LOP-FIN 6-DIC-2002 
*% END
*% IF PGM_PQ
      *LOP-INI 12-12-2002                                               
           03 WSS-IND-ALZA          VALUE SPACES    PIC X(03).          
      *LOP-FIN 12-12-2002
*% END
      *>>>>
*% END
*% IF INI_FND_KEY
      *<<<< INI_FND_KEY
           PERFORM KEY-ALL-ALZ.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               IF SCR-KEY-IDBC = 'ESC'
                   PERFORM NXT-PRV-ESC
                   IF FIO-STAT-OKS
                       PERFORM SCR-CLRA-ALZ
                       MOVE 1 TO WSS-IESC
*% IF PGM_PER
      *<<<< PGM_PER
      *JSS-JUS-INI 22-APR-1996 19:03:22 
      *FLB CST  28-MAR-1995 
      *                PERFORM VAL-OFI-USR
      *                IF MSG-COD-MENS > SPACES
      *                    GO TO FIN-FND-KEY
      *                ELSE
      *FLB CST  28-MAR-1995 FIN
      *JSS-JUS-FIN
      *>>>>
*% END
                       PERFORM BUS-COR-FIA
                       IF FIA-NUM-IFIA IN ALZ-FLD NOT > ZEROES
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'FIAIFIANEX' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'ESC' TO SCR-KEY-IFIA
                           MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                           MOVE '00' TO PGM-STAT-FIA
                           MOVE 1 TO WSS-IFIA
                           MOVE '00' TO FIO-STAT
                           GO TO FIN-FND-KEY
                   ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'ESC    NOPRV' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'ESC    NONXT' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
               ELSE
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-ALZ
                   IF SCR-KEY-IDBC = 'FIA'
                       MOVE DBC-CIC-ICLI IN DBC TO FIA-CIC-ICFS 
                                                         IN FIA
                       PERFORM PUT-DBC-FIA
                       PERFORM BUS-FIA-SFI
                       IF NOT FIO-STAT-OKS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           MOVE SPACES TO SCR-FIA-REQA
                           MOVE SPACES TO SCR-KEY-IFIA
                           GO TO FIN-FND-KEY
                       ELSE
                           GO TO FIN-FND-KEY
                   ELSE
                       MOVE DBC-CIC-ICLI IN DBC TO FIA-CIC-ICLI 
                                                         IN FIA
                       PERFORM PUT-DBC-DEU
                       PERFORM BUS-FIA-SDE
                       IF NOT FIO-STAT-OKS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           MOVE SPACES TO SCR-FIA-REQA
                           MOVE SPACES TO SCR-KEY-IFIA
                           GO TO FIN-FND-KEY
                       ELSE
                           GO TO FIN-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NOPRV' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NONXT' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY.

           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV-ESC
               IF MSG-COD-MENS = 'FIASI'
                   MOVE 1 TO WSS-IFIA
                   PERFORM BUS-ESC
                   IF FIO-STAT-OKS
                       PERFORM SCR-CLRA-ALZ
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'CICIESCNEX' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF SCR-KEY-IFIA = 'FIA'
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICFSNOPRV' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICFSNONXT' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                   ELSE      
                   IF SCR-KEY-IFIA = 'DEU'
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICLINOPRV' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICLINONXT' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                   ELSE
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICIESCNOPRV' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICIESCNONXT' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY.
           PERFORM KEY-ALL-ALZ.
           IF ESC-IIC-IESC IN ALZ-FLD NOT > ZEROES
               PERFORM ANL-KEY-ALZ
               IF NOT FIO-STAT-OKS
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   GO TO FIN-FND-KEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'DEU' TO SCR-KEY-IDBC
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
           IF FIO-STAT-OKS
               MOVE 'ESC' TO SCR-KEY-IDBC
*% IF PGM_PER
      *<<<< PGM_PER
      *JSS-JUS-INI 22-APR-1996 19:03:22 
      *FLB CST  28-MAR-1995 
      *         PERFORM VAL-OFI-USR
      *         IF MSG-COD-MENS > SPACES
      *             GO TO FIN-FND-KEY
      *         ELSE
      *FLB CST  28-MAR-1995 FIN
      *JSS-JUS-FIN
      *>>>>
*% END
               IF FIA-NUM-IFIA IN FIA > ZEROES
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM DEU-FIO-FIA
                   IF FIO-STAT-OKS
                       MOVE 'ESC' TO SCR-KEY-IFIA
                       MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                       MOVE '00' TO PGM-STAT-FIA
                       MOVE 1 TO WSS-IFIA
                   ELSE
                       NEXT SENTENCE
               ELSE
                   PERFORM BUS-COR-FIA
                   IF FIA-NUM-IFIA IN ALZ-FLD NOT > ZEROES
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'FIAIFIANEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE '00' TO FIO-STAT
                       MOVE SCR-STAT-CON TO SCR-STAT
                   ELSE
                       MOVE 'ESC' TO SCR-KEY-IFIA
                       MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                       MOVE '00' TO PGM-STAT-FIA
                       MOVE 1 TO WSS-IFIA
                       MOVE '00' TO FIO-STAT
           ELSE
               NEXT SENTENCE.
           GO TO FIN-FND-KEY.
      *>>>>
*% END
*% IF INI_SCR_TRL
      *<<<< INI_SCR_TRL
           IF FRM-FFLD NOT = FRM-FFLD-PF12
               IF EXISTE-FIANZA
                   MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                   IF FIA-MSC-STAT IN FIA = 'N' OR
                      FIA-MSC-STAT IN FIA NOT > SPACES
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'FIASTATNO' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       IF SCR-STAT = SCR-STAT-CON
                           MOVE MSG-GLS-DESC TO FRM-MEN2
                       ELSE
                           MOVE SCR-STAT-CON TO SCR-STAT
                           MOVE MSG-GLS-DESC TO FRM-MENS.
      *>>>>
*% END
*% IF FIN_HBL_FLD
      *<<<< FIN_HBL_FLD
           IF SCR-CMND = 'SOL'
               MOVE FRM-CPIM-AEY TO FIA-FEC-FALZ-ATR IN ALZ-FLD
               MOVE FRM-CPIM-AEY TO FIA-FEC-FAUT-ATR IN ALZ-FLD
               MOVE FRM-CPIM-AEY TO FIA-COD-RAUT-ATR IN ALZ-FLD
               MOVE FRM-CPIM-AEY TO FIA-COD-ABOA-ATR IN ALZ-FLD
               MOVE -1 TO FIA-FEC-FSOL-LEN IN ALZ-FLD
           ELSE
           IF SCR-CMND = 'AUT'
               MOVE FRM-CPIM-AEY TO FIA-FEC-FSOL-ATR IN ALZ-FLD
               MOVE FRM-CPIM-AEY TO FIA-FEC-FALZ-ATR IN ALZ-FLD
               MOVE FRM-CPIM-AEY TO FIA-COD-ABOA-ATR IN ALZ-FLD
               MOVE  0           TO FIA-FEC-FSOL-LEN IN ALZ-FLD
               MOVE -1           TO FIA-FEC-FAUT-LEN IN ALZ-FLD
           ELSE
           IF SCR-CMND = 'ALZ'
               MOVE FRM-CPIM-AEY TO FIA-FEC-FSOL-ATR IN ALZ-FLD
               MOVE FRM-CPIM-AEY TO FIA-FEC-FAUT-ATR IN ALZ-FLD
               MOVE FRM-CPIM-AEY TO FIA-COD-RAUT-ATR IN ALZ-FLD
               MOVE  0           TO FIA-FEC-FSOL-LEN IN ALZ-FLD
      *MHM-INI 30-JUN-2006                                              
      *        MOVE -1           TO FIA-FEC-FALZ-LEN IN ALZ-FLD.        
               MOVE -1           TO FIA-FEC-FALZ-LEN IN ALZ-FLD         
           ELSE                                                         
           IF SCR-CMND = 'ALM'                                          
               MOVE FRM-CPIM-AEY TO FIA-FEC-FSOL-ATR IN ALZ-FLD         
               MOVE FRM-CPIM-AEY TO FIA-FEC-FAUT-ATR IN ALZ-FLD         
               MOVE FRM-CPIM-AEY TO FIA-COD-RAUT-ATR IN ALZ-FLD         
               MOVE FRM-CPIM-AEY TO FIA-FEC-FALZ-ATR IN ALZ-FLD         
               MOVE  0           TO FIA-FEC-FSOL-LEN IN ALZ-FLD         
               MOVE -1           TO FIA-COD-ABOA-LEN IN ALZ-FLD.        
      *MHM-FIN 30-JUN-2006  
      *>>>>
*% END
*% IF CMN_MOD
      *<<<< CMN_MOD
           IF SCR-CMND = 'ALZ'
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO FIA-NUM-DOUT IN FIA
               MOVE HOY-MHOY TO FIA-NUM-MOUT IN FIA
               MOVE HOY-SHOY TO FIA-NUM-SOUT IN FIA
               MOVE HOY-AHOY TO FIA-NUM-AOUT IN FIA.

      *LOP-INI 6-DIC-2002                                               
           IF WSS-IND-ALZA IN WSS-VARI NOT > SPACES                     
               MOVE FIA-CIC-ICLI IN FIA TO DBC-CIC-ICLI IN DBC          
               MOVE FIA-CAI-IESC IN FIA TO CCU-CAI-IFIA                 
               MOVE FIA-IIC-IESC IN FIA TO CCU-IIC-IFIA                 
               PERFORM LLAMA-CCU-LDC                                    
               IF MSG-COD-MENS > SPACES                                 
                  GO TO MSG-CMN-MOD.                                    
      *LOP-FIN 6-DIC-2002 
      *>>>>
*% END
*% IF EOF
      *<<<< EOF

       CPT-NOMC SECTION.
       INI-CPT-NOMC.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
       FIN-CPT-NOMC.
           EXIT.

       ANL-KEY-ALZ SECTION.
       INI-ANL-KEY-ALZ.
      * Si existe rut de Deudor y rut de Fiador
      *     IF FRM-NUM-ICLI IN ALZ-FLD NOT = ZEROES AND
      *        FRM-NUM-ICFS IN ALZ-FLD NOT = ZEROES
           IF FRM-NUM-ICLI IN ALZ-FLD > ZEROES AND                      
              FRM-NUM-ICFS IN ALZ-FLD > ZEROES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-IDC-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-IDC-CIC-FIA
                   IF FIO-STAT-OKS
                       PERFORM BUS-FIA-ADF
                   ELSE
                       NEXT SENTENCE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe rut de Deudor
      *     IF FRM-NUM-ICLI IN ALZ-FLD NOT = ZEROES
           IF FRM-NUM-ICLI IN ALZ-FLD > ZEROES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-IDC-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SDE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe rut de Fiador
      *     IF FRM-NUM-ICFS IN ALZ-FLD NOT = ZEROES
           IF FRM-NUM-ICFS IN ALZ-FLD > ZEROES 
               MOVE 'FIA' TO SCR-KEY-IFIA
               MOVE 'FIA' TO SCR-KEY-IDBC
               PERFORM BUS-IDC-CIC-FIA
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SFI
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe nombre de Deudor y nombre de Fiador
           IF FRM-GLS-NOMC IN ALZ-FLD > SPACES AND
              FRM-GLS-NOMF IN ALZ-FLD > SPACES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-NMB-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-NMB-CIC-FIA
                   IF FIO-STAT-OKS
                       PERFORM BUS-FIA-ADF
                   ELSE
                       NEXT SENTENCE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe nombre de Deudor
           IF FRM-GLS-NOMC IN ALZ-FLD     > SPACES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-NMB-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SDE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe nombre de Fiador
           IF FRM-GLS-NOMF IN ALZ-FLD     > SPACES
               MOVE 'FIA' TO SCR-KEY-IFIA
               MOVE 'FIA' TO SCR-KEY-IDBC
               PERFORM BUS-NMB-CIC-FIA
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SFI.
       FIN-ANL-KEY-ALZ.
           EXIT.

       BUS-FIA-SDE SECTION.
       INI-BUS-FIA-SDE.    
           MOVE 1 TO WSS-IKEY.
           MOVE FIA-CIC-ICLI IN FIA TO WSS-CIC-ICLI.
           MOVE LOW-VALUES          TO FIA-CIC-ICFS IN FIA.
           MOVE FIO-GET-NLS-ALT TO FIO-CMND.
           MOVE 'FIA-GLS-ICYF'  TO FIO-AKEY.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND
              WSS-CIC-ICLI = FIA-CIC-ICLI IN FIA
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 1 TO WSS-IFIA
               PERFORM BUS-ESC
      *JSS     IF FIO-STAT-OKS
      *             PERFORM BUS-COR-AMF
      *             IF AMF-NUM-IAMF IN ALZ-FLD > ZEROES
      *                 MOVE 1 TO WSS-IAMF
      *                 PERFORM PUT-AMF-FIA
      *                 MOVE '00' TO FIO-STAT
      *             ELSE
      *                 PERFORM CLR-AMF
      *                 MOVE '00' TO FIO-STAT
      *         ELSE
      *             NEXT SENTENCE
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICICLINODEU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-FIA-SDE.
           EXIT.

       BUS-FIA-SFI SECTION.
       INI-BUS-FIA-SFI.    
           MOVE 2 TO WSS-IKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND
           MOVE 'FIA-CIC-ICFS'  TO FIO-AKEY
           PERFORM DEU-FIO-FIA
           IF FIO-STAT-OKS
               MOVE 'FIA' TO SCR-KEY-IFIA
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 1 TO WSS-IFIA
               PERFORM BUS-ESC
      *JSS     IF FIO-STAT-OKS
      *             PERFORM BUS-COR-AMF
      *             IF AMF-NUM-IAMF IN ALZ-FLD > ZEROES
      *                 MOVE 1 TO WSS-IAMF
      *                 PERFORM PUT-AMF-FIA
      *                 MOVE '00' TO FIO-STAT
      *             ELSE
      *                 PERFORM CLR-AMF
      *                 MOVE '00' TO FIO-STAT
      *         ELSE
      *             NEXT SENTENCE
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICICFSNOFIA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-FIA-SFI.
           EXIT.

       BUS-FIA-ADF SECTION.
       INI-BUS-FIA-ADF.
           MOVE 3 TO WSS-IKEY.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           MOVE 'FIA-GLS-ICYF'  TO FIO-AKEY.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 1 TO WSS-IFIA
               PERFORM BUS-ESC
      *JSS     IF FIO-STAT-OKS
      *             PERFORM BUS-COR-AMF
      *             IF AMF-NUM-IAMF IN ALZ-FLD > ZEROES
      *                 MOVE 1 TO WSS-IAMF
      *                PERFORM PUT-AMF-FIA
      *                 MOVE '00' TO FIO-STAT
      *             ELSE
      *                 PERFORM CLR-AMF
      *                 MOVE '00' TO FIO-STAT
      *         ELSE
      *             NEXT SENTENCE
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'GLSICYFNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-FIA-ADF.
           EXIT.

       BUS-ESC SECTION.
       INI-BUS-ESC.
           MOVE FIA-CIC-IESC IN FIA TO ESC-CIC-IESC IN ESC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-ESC
               MOVE 1 TO WSS-IESC
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICIESCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-ESC.
           EXIT.

       BUS-NMB-CIC-DEU SECTION.
       INI-BUS-NMB-CIC-DEU.
      *NOM-CLI Busca Cliente por medio del Nombre
      *ALD
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.

           MOVE FRM-GLS-NOMC IN ALZ-FLD TO STR-GLS-GSTR
           PERFORM STR-UNS
           MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC.

           MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.
           MOVE FIO-GET-NLS-ALT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'FRMNOMCNOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               PERFORM PUT-DBC-DEU
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICLI IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICLI IN FIA.

       FIN-BUS-NMB-CIC-DEU.
           EXIT.

       PUT-DBC-DEU SECTION.
       INI-PUT-DBC-DEU.
           
           PERFORM CPT-NOMC.
           MOVE CPT-STRN TO FRM-GLS-NOMC IN ALZ-FLD.

           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN ALZ-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN ALZ-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN ALZ-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN ALZ-FLD.
       FIN-PUT-DBC-DEU.
           EXIT.

       BUS-NMB-CIC-FIA SECTION.
       INI-BUS-NMB-CIC-FIA.
      *NOM-CLI Busca Cliente por medio del Nombre
      *ALD
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.

           MOVE FRM-GLS-NOMF IN ALZ-FLD TO STR-GLS-GSTR
           PERFORM STR-UNS
           MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC.

           MOVE 'DBC-GLS-NOMC'  TO FIO-AKEY.
           MOVE FIO-GET-NLS-ALT TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'FRMNOMFNOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               PERFORM PUT-DBC-FIA
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICFS IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICFS IN FIA.

       FIN-BUS-NMB-CIC-FIA.
           EXIT.

       PUT-DBC-FIA SECTION.
       INI-PUT-DBC-FIA.
           
           PERFORM CPT-NOMC.
           MOVE CPT-STRN TO FRM-GLS-NOMF IN ALZ-FLD.

           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICFS IN ALZ-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICFS IN ALZ-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICFS IN ALZ-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICFS IN ALZ-FLD.
       FIN-PUT-DBC-FIA.
           EXIT.

       BUS-IDC-CIC-DEU SECTION.
       INI-BUS-IDC-CIC-DEU.
           MOVE FRM-NUM-ICLI IN ALZ-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-ICLI IN ALZ-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-ICLI IN ALZ-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               
               PERFORM CPT-NOMC
               MOVE CPT-STRN TO FRM-GLS-NOMC IN ALZ-FLD

               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICLI IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICLI IN FIA
           ELSE
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CICICLINOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-IDC-CIC-DEU.
           EXIT.

       BUS-IDC-CIC-FIA SECTION.
       INI-BUS-IDC-CIC-FIA.
           MOVE FRM-NUM-ICFS IN ALZ-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-ICFS IN ALZ-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-ICFS IN ALZ-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE FIO-GET-KEY-ALT TO FIO-CMND.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               
               PERFORM CPT-NOMC
               MOVE CPT-STRN TO FRM-GLS-NOMF IN ALZ-FLD

               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICFS IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICFS IN FIA
           ELSE
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CICICFSNOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-IDC-CIC-FIA.
           EXIT.

       BUS-COR-FIA SECTION.
       INI-BUS-COR-FIA.
           MOVE 0 TO FIA-NUM-IFIA IN ALZ-FLD.
           MOVE ESC-CAI-IESC IN ESC TO FIA-CAI-IESC IN FIA.
           MOVE ESC-IIC-IESC IN ESC TO FIA-IIC-IESC IN FIA.
           MOVE 99                  TO FIA-NUM-IFIA IN FIA.
           MOVE FIA-CIC-IESC IN FIA TO WSS-CIC-IESC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND WSS-CIC-IESC = FIA-CIC-IESC IN FIA
               MOVE FIA-NUM-IFIA IN FIA TO FIA-NUM-IFIA IN ALZ-FLD.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO FIA-NUM-IFIA IN ALZ-FLD.
       FIN-BUS-COR-FIA.
           EXIT.

       SET-MSG SECTION.
       INI-SET-MSG.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
       FIN-SET-MSG.
           EXIT.

       LEE-NXT-PRV-ESC SECTION.
       INI-LEE-NXT-PRV-ESC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-FIA-REQA > SPACES
               PERFORM LEE-NXT-PRV-FIA
           ELSE
               MOVE 'FIANO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-ESC.
           EXIT.

       LEE-NXT-PRV-FIA SECTION.
       INI-LEE-NXT-PRV-FIA.
           MOVE SCR-FIA-REQA TO ADR-FIA-REQA.
           MOVE ADR-VKEY IN ADR-FIA-REQA TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND SCR-KEY-IFIA = 'DEU' AND
              FIA-CIC-ICLI IN FIA = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 'FIASI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-FIA.
           IF FIO-STAT-OKS AND SCR-KEY-IFIA = 'FIA' AND
              FIA-CIC-ICFS IN FIA = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 'FIASI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-FIA.
           IF FIO-STAT-OKS AND SCR-KEY-IFIA = 'ESC' AND
              FIA-CIC-IESC IN FIA = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 'FIASI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-FIA.
           MOVE 'FIANO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-FIA.
           EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.

       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           MOVE 'DEU' TO SCR-KEY-IDBC.
           MOVE FRM-GLS-NOMC IN ALZ-FLD TO DBC-GLS-NOMC IN DBC.
           IF FRM-GLS-NOMF IN ALZ-FLD > SPACES
               MOVE 'FIA' TO SCR-KEY-IDBC 
               MOVE FRM-GLS-NOMF IN ALZ-FLD TO DBC-GLS-NOMC IN DBC.
           IF FRM-GLS-NOMC IN ALZ-FLD > SPACES
               MOVE 'DEU' TO SCR-KEY-IDBC
               MOVE FRM-GLS-NOMC IN ALZ-FLD TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.

       NXT-PRV-ESC SECTION.
       INI-NXT-PRV-ESC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
       FIN-NXT-PRV-ESC.
           EXIT.

       COPY DEUBFESC.
       COPY GNSBBMSC.
       COPY GNSBVCOD.                                                   
       COPY GNSBVTAB.
       COPY GNSBGSTR.
       COPY GNSBGCPT.
       COPY TABBVUSR.
       COPY TABBVOFI.
       COPY TABBVTDU.
       COPY SGCBFDBC.

*% IF PGM_PU
      *<<<<
      *LOP-INI 6-DIC-2002                                               
       COPY LDCBKCEG.                                                   
       COPY LDCBKCCU.                                                   
       COPY LDCBGCCU.                                                   
       COPY LDCBFCLF.                                                   
       COPY LDCBFRDC REPLACING RDC BY RDL.                              
       COPY LDCBGCC1.                                                   
      *LOP-FIN 6-DIC-2002 
      *>>>>
*% END
*% IF PGM_PQ AND PGM_PER
      *<<<< PGM_PQ AND PGM_PER
      *JSS-JUS-INI 22-APR-1996 19:03:22 
      *FLB CST  28-MAR-1995 
      * COPY DEUBVUOF.
      *JSS-JUS-FIN
      *>>>>
*% END
      *>>>>
*% END
*% IF INI_FIO
      *<<<<
      *LOP-INI 12-12-2002                                               
           MOVE SPACES TO WSS-IND-ALZA IN WSS-VARI.                     
           IF SCR-CMND ='ALS'                                           
              MOVE 'ALZ' TO SCR-CMND                                    
              MOVE 'ALS' TO WSS-IND-ALZA IN WSS-VARI.                   
      *MHM-INI 20-SEP-2006                                              
           IF SCR-CMND ='ALM'                                           
              MOVE 'ALM' TO WSS-IND-ALZA IN WSS-VARI.                   
      *MHM-FIN 20-SEP-2006                                              
           IF SCR-CMND ='SOS'                                           
              MOVE 'SOL' TO SCR-CMND                                    
              MOVE 'SOS' TO WSS-IND-ALZA IN WSS-VARI.                   
           IF SCR-CMND ='AUS'                                           
              MOVE 'AUT' TO SCR-CMND                                    
              MOVE 'AUS' TO WSS-IND-ALZA IN WSS-VARI.                   
      *LOP-FIN 12-12-2002  
      *>>>>
*% END
*% IF PFS_SCR_MOD AND PGM_PQ
      *<<<< PFS_SCR_MOD
           IF (FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR               
                          FRM-FFLD-PF7 OR FRM-FFLD-PF8) AND             
              SCR-STAT = SCR-STAT-CON                                   
               PERFORM VAL-NUM-KEY-ALZ                                  
               PERFORM VAL-NUM-FLD-ALZ.                                 
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR                
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8                   
               PERFORM RST-STAT                                         
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY                     
               IF SCR-STAT NOT = SCR-STAT-ABT                           
                   PERFORM SCR-TRL                                      
               ELSE                                                     
                   PERFORM GNS-CLR-RQA                                  
                   PERFORM DESSCRTRL                                    
                   GO TO FIN-SCR-MOD.                                   
           PERFORM GNS-CLR-RQA.
      *>>>> PFS_SCR_MOD
*% END
*% IF EXIT_SCR
      *<<<< EXIT_SCR 
      *LOP-INI 12-12-2002                                               
           IF WSS-IND-ALZA IN WSS-VARI > SPACES                         
              MOVE WSS-IND-ALZA IN WSS-VARI TO SCR-CMND.                
      *LOP-FIN 12-12-2002 
      *>>>> EXIT_SCR
*% END
*% IF FIN_CMN_MOD
      *<<<< FIN_CMN_MOD
      *LOP-INI 6-DIC-2002                                               
           GO TO FIN-CMN-MOD.                                           
       MSG-CMN-MOD.                                                     
           MOVE FRM-SUAR-MAL TO FRM-SUAR.                               
           MOVE MSG-GLS-DESC TO FRM-MENS.                               
           MOVE 'S'          TO SCR-IERR.                               
      *LOP-FIN 6-DIC-2002 
      *>>>> FIN_CMN_MOD
*% END
