*%! Codigo adicional
*% IF INI_UNP_IKY_IC2
      *<<<< INI_UNP_IKY_IC2
           IF SCR-CCPP = WCC-ING
               MOVE FRM-CPIM-UBY TO CIP-CAI-ICER-ATR
               MOVE FRM-CPIM-UBY TO CIP-IIC-ICER-ATR
               MOVE FRM-CPIM-AEY TO CIP-NUM-ICIP-ATR
               GO TO FIN-UNP-IKY-IC2.
      *>>>>
*% END
*% IF INI_CIP_NUM_ICIP
      *<<<< INI_CIP_NUM_ICIP
           IF SCR-CCPP = WCC-ING
               GO TO FIN-VAL-CIP-NUM-ICIP.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_IC2
      *<<<< INI_VAL_CON_KEY_IC2
           IF SCR-CCPP = WCC-ING
              IF CIP-CAI-ICER IN IC2-FLD NOT > SPACES
                 AND CIP-IIC-ICER IN IC2-FLD NOT > ZEROES
                  PERFORM ERR-KEY
                  PERFORM FST-KEY-IC2
                  GO TO FIN-VAL-CON-KEY-IC2.
      *>>>>
*% END
*% IF INI_VAL_CON_IKY_IC2
      *<<<< INI_VAL_CON_IKY_IC2
           IF SCR-CCPP = WCC-ING
              IF CIP-CAI-ICER IN IC2-FLD NOT > SPACES
                 AND CIP-IIC-ICER IN IC2-FLD NOT > ZEROES
                  PERFORM ERR-KEY
                  PERFORM FST-KEY-IC2
                  GO TO FIN-VAL-CON-IKY-IC2.
      *>>>>
*% END
*% IF INI_RET_CIP_IC2
      *<<<< INI_RET_CIP_IC2
           MOVE CIP-COD-CPTO IN IC2-FLD TO CIP-COD-CPTO IN CIP.
           MOVE CIP-NUM-DCOL IN IC2-FLD TO CIP-NUM-DCOL IN CIP.
           MOVE CIP-NUM-MCOL IN IC2-FLD TO CIP-NUM-MCOL IN CIP.
           MOVE CIP-NUM-SCOL IN IC2-FLD TO CIP-NUM-SCOL IN CIP.
           MOVE CIP-NUM-ACOL IN IC2-FLD TO CIP-NUM-ACOL IN CIP.
           MOVE CIP-NUM-DMAV IN IC2-FLD TO CIP-NUM-DMAV IN CIP.
           MOVE CIP-NUM-MMAV IN IC2-FLD TO CIP-NUM-MMAV IN CIP.
           MOVE CIP-NUM-SMAV IN IC2-FLD TO CIP-NUM-SMAV IN CIP.
           MOVE CIP-NUM-AMAV IN IC2-FLD TO CIP-NUM-AMAV IN CIP.
           MOVE CIP-VAL-SIMO IN IC2-FLD TO CIP-VAL-SIMO IN CIP.
           MOVE CIP-SGV-TOPE IN IC2-FLD TO CIP-SGV-TOPE IN CIP.
           MOVE CIP-SGV-TINT IN IC2-FLD TO CIP-SGV-TINT IN CIP.
           MOVE CIP-NUM-DINI IN IC2-FLD TO CIP-NUM-DINI IN CIP.
           MOVE CIP-NUM-MINI IN IC2-FLD TO CIP-NUM-MINI IN CIP.
           MOVE CIP-NUM-SINI IN IC2-FLD TO CIP-NUM-SINI IN CIP.
           MOVE CIP-NUM-AINI IN IC2-FLD TO CIP-NUM-AINI IN CIP.
           MOVE CIP-NUM-DTER IN IC2-FLD TO CIP-NUM-DTER IN CIP.
           MOVE CIP-NUM-MTER IN IC2-FLD TO CIP-NUM-MTER IN CIP.
           MOVE CIP-NUM-STER IN IC2-FLD TO CIP-NUM-STER IN CIP.
           MOVE CIP-NUM-ATER IN IC2-FLD TO CIP-NUM-ATER IN CIP.
           MOVE CIP-NUM-PTRM IN IC2-FLD TO CIP-NUM-PTRM IN CIP.
           MOVE CIP-SGV-CUOT IN IC2-FLD TO CIP-SGV-CUOT IN CIP.
           MOVE CIP-NUM-FOLI IN IC2-FLD TO CIP-NUM-FOLI IN CIP.
           IF CIP-GLS-NORM IN IC2-FLD = SPACES
               MOVE WCC-DL20130 IN WSS-VARI TO CIP-GLS-NORM IN CIP
           ELSE
               MOVE CIP-GLS-NORM IN IC2-FLD TO CIP-GLS-NORM IN CIP.
           MOVE CIP-COD-TIPO IN IC2-FLD TO CIP-COD-TIPO IN CIP.

           MOVE WCC-HIS      IN WSS-VARI TO CIP-COD-EVEN IN CIP.
           MOVE WCC-1        IN WSS-VARI TO CIP-NUM-ICAN IN CIP.
           MOVE WCC-1        IN WSS-VARI TO CIP-NUM-CPTO IN CIP.
           MOVE CIP-FEC-FCOL IN CIP      TO CIP-FEC-FORI IN CIP.
           MOVE CIP-NUM-PTRM IN CIP      TO CIP-VAL-CTRA IN CIP.
           MOVE CIP-SGV-TINT IN CIP      TO CIP-SGV-TACU IN CIP.
           IF CIP-NUM-PTRM IN CIP > ZEROES
               COMPUTE CIP-SGV-TUNI IN CIP = CIP-SGV-TINT IN CIP /
                                                   CIP-NUM-PTRM IN CIP
           ELSE
               MOVE ZEROES TO CIP-SGV-TUNI IN CIP.

           MOVE CIP-SGV-MNTO IN IC2-FLD  TO CIP-SGV-MNTO IN CIP.
           IF CIP-COD-MONE IN CIP = WCC-PESOS
               MOVE CIP-SGV-MNTO IN CIP TO CIP-SGV-MORI IN CIP
           ELSE
               MOVE SPACES TO CAM
               MOVE CIP-COD-MONE IN CIP TO CAM-COD-VCAM IN CAM(1)
               MOVE WCC-PESOS IN WSS-VARI TO CAM-COD-VCAM IN CAM(2)
               MOVE CIP-FEC-FCOL IN CIP TO CAM-FEC-FCAM IN CAM(1)
               MOVE CIP-FEC-FCOL IN CIP TO CAM-FEC-FCAM IN CAM(2)
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM TAB-FIO-CAM
               IF NOT FIO-STAT-OKS OR CAM-MSC-STAT IN CAM NOT = WCC-S
                   MOVE ZEROES TO CIP-SGV-MORI IN CIP
               ELSE
                   COMPUTE CIP-SGV-MORI IN CIP = CIP-SGV-MNTO IN CIP /
                                                 CAM-SGV-VCAM IN CAM.

           COMPUTE CIP-SGV-VTOT IN CIP = CIP-SGV-CUOT IN CIP -
                                         CIP-SGV-VDES IN CIP.

           IF CIP-SGV-VTOT IN CIP NOT > ZEROES
               MOVE ZEROES TO CIP-SGV-VTOT IN CIP.

           MOVE CIP-SGV-VTOT IN CIP TO CIP-SGV-MCAL IN CIP.
           MOVE CIP-FEC-FTER IN CIP TO CIP-FEC-TTRI IN CIP.
           MOVE CIP-NUM-PTRM IN CIP TO CIP-VAL-CTRA IN CIP.
           MOVE CIP-FEC-FMAV IN CIP TO CIP-FEC-FVEN IN CIP.
           MOVE CIP-COD-TIPO IN CIP TO CIP-MSC-STAT IN CIP.
           MOVE WCC-N TO CIP-IND-DUSO IN CIP.

           GO TO FIN-RET-CIP-IC2.
      *>>>>
*% END
*% IF INI_CIP_COD_TIPO
      *<<<< INI_CIP_COD_TIPO
           GO TO CONT-COD-TIPO.
      *>>>>
*% END
*% IF CIP_COD_TIPO
      *<<<< CIP_COD_TIPO
       CONT-COD-TIPO.

      *VAL-COD Valida codigo de tabla
           MOVE 'COL'  TO TAB-COD-SIST FIO-SIST.
           MOVE 'CEO ' TO TAB-COD-TTAB IN TAB.
           MOVE CIP-COD-CPTO IN IC2-FLD  TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS  AND TAB-IND-VIGE = 'S'
               MOVE TAB-GLS-DATA IN TAB(1:1) TO CIP-COD-TIPO IN IC2-FLD.

           IF CIP-COD-TIPO IN IC2-FLD NOT > SPACES
               MOVE WCC-A TO CIP-COD-TIPO IN IC2-FLD.
      *         PERFORM ERR-GLS
      *         MOVE SPACES TO FRM-GLS-TIPO IN IC2-FLD
      *         GO TO FIN-VAL-CIP-COD-TIPO.
      *>>>>
*% END
*% IF INI_CIP_FEC_FCOL
      *<<<< INI_CIP_FEC_FCOL
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FCOL IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.

           GO TO FIN-VAL-CIP-FEC-FCOL.
      *>>>>
*% END
*% IF INI_CIP_FEC_FMAV
      *<<<< INI_CIP_FEC_FMAV
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FMAV IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.

           GO TO FIN-VAL-CIP-FEC-FMAV.
      *>>>>
*% END
*% IF INI_CIP_FEC_FINI
      *<<<< INI_CIP_FEC_FINI
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FINI IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.

           GO TO FIN-VAL-CIP-FEC-FINI.
      *>>>>
*% END
*% IF INI_CIP_FEC_FTER
      *<<<< INI_CIP_FEC_FTER
           MOVE FEC-FBLK-N  TO FEC-FBLK.
           MOVE FEC-CHOY-N  TO FEC-CHOY.
           MOVE FEC-VHBL-N TO FEC-VHBL.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FECH TO CIP-FEC-FTER IN IC2-FLD
           ELSE
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FEC-MENS     TO FRM-MENS.

           GO TO FIN-VAL-CIP-FEC-FTER.
      *>>>>
*% END
*% IF FIN_CIP_NUM_PTRM
      *<<<< FIN_CIP_NUM_PTRM
           MOVE ZEROES TO WSS-NUM-MAXI IN WSS-VARI
           MOVE WCC-COL    TO FIO-SIST.
           MOVE WCC-IPTE   TO TAB-COD-TTAB IN TAB.
           MOVE WCC-IPTEXC TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF (FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S)
                MOVE TAB-GLS-DATA IN TAB TO WSS-GLS-DATA IN WSS-VARI.

           IF CIP-NUM-PTRM IN IC2-FLD > ZEROES AND
              CIP-NUM-PTRM IN IC2-FLD > WSS-NUM-MAXI IN WSS-VARI
               MOVE WCC-COL        TO MSG-COD-SIST
               MOVE WCC-ERRVALTRM  TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CIP-NUM-PTRM.
      *>>>>
*% END
*% IF INI_CIP_NUM_FOLI
      *<<<< INI_CIP_NUM_FOLI
           IF CIP-NUM-FOLI IN IC2-FLD = ZEROES AND
              CIP-COD-TIPO IN IC2-FLD = WCC-A
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-NUM-FOLI.

           GO TO FIN-VAL-CIP-NUM-FOLI.
      *>>>>
*% END
*% IF INI_CIP_GLS_NORM
      *<<<< INI_CIP_GLS_NORM
           IF CIP-GLS-NORM IN IC2-FLD NOT > SPACES
               MOVE WCC-DL20130 TO CIP-GLS-NORM IN IC2-FLD
               GO TO FIN-VAL-CIP-GLS-NORM.

           MOVE SPACES TO TAB.
           MOVE WCC-COL TO TAB-COD-SIST FIO-SIST.
           MOVE WCC-NOEE TO TAB-COD-TTAB IN TAB.
           MOVE CIP-GLS-NORM IN IC2-FLD TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF FIO-STAT-OKS AND TAB-IND-VIGE = WCC-S
               GO TO FIN-VAL-CIP-GLS-NORM
           ELSE
               MOVE WCC-COL        TO MSG-COD-SIST
               MOVE WCC-ERRVALNEXC TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CIP-GLS-NORM.

           GO TO FIN-VAL-CIP-GLS-NORM.
      *>>>>
*% END
*% IF VAL_CON_FLD_IC2
      *<<<< VAL_CON_FLD_IC2
      *FECHA CURSE-VENCIMIENTO TERMINO
           MOVE CIP-NUM-DCOL IN IC2-FLD TO WSS-NU1-DIA IN WSS-VARI.
           MOVE CIP-NUM-MCOL IN IC2-FLD TO WSS-NU1-MES IN WSS-VARI.
           MOVE CIP-NUM-SCOL IN IC2-FLD TO WSS-NU1-SIG IN WSS-VARI.
           MOVE CIP-NUM-ACOL IN IC2-FLD TO WSS-NU1-ANO IN WSS-VARI.
           MOVE CIP-NUM-DMAV IN IC2-FLD TO WSS-NU2-DIA IN WSS-VARI.
           MOVE CIP-NUM-MMAV IN IC2-FLD TO WSS-NU2-MES IN WSS-VARI.
           MOVE CIP-NUM-SMAV IN IC2-FLD TO WSS-NU2-SIG IN WSS-VARI.
           MOVE CIP-NUM-AMAV IN IC2-FLD TO WSS-NU2-ANO IN WSS-VARI.
           IF WSS-FEC-FEC1 IN WSS-VARI > WSS-FEC-FEC2 IN WSS-VARI
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-FEC-FMAV-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN1 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

      *FECHA INICIO-FECHA TERMINO
           MOVE CIP-NUM-DINI IN IC2-FLD TO WSS-NU1-DIA IN WSS-VARI.
           MOVE CIP-NUM-MINI IN IC2-FLD TO WSS-NU1-MES IN WSS-VARI.
           MOVE CIP-NUM-SINI IN IC2-FLD TO WSS-NU1-SIG IN WSS-VARI.
           MOVE CIP-NUM-AINI IN IC2-FLD TO WSS-NU1-ANO IN WSS-VARI.
           MOVE CIP-NUM-DTER IN IC2-FLD TO WSS-NU2-DIA IN WSS-VARI.
           MOVE CIP-NUM-MTER IN IC2-FLD TO WSS-NU2-MES IN WSS-VARI.
           MOVE CIP-NUM-STER IN IC2-FLD TO WSS-NU2-SIG IN WSS-VARI.
           MOVE CIP-NUM-ATER IN IC2-FLD TO WSS-NU2-ANO IN WSS-VARI.
           IF WSS-FEC-FEC1 IN WSS-VARI > WSS-FEC-FEC2 IN WSS-VARI
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-FEC-FTER-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN2 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

           IF CIP-COD-TIPO IN IC2-FLD = WCC-A AND
              CIP-NUM-PTRM IN IC2-FLD = ZEROES
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-NUM-PTRM-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN3 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

           IF CIP-COD-TIPO IN IC2-FLD = WCC-A AND
              CIP-SGV-TINT IN IC2-FLD = ZEROES
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-SGV-TINT-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN4 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

      * VALIDACION MONTO Y SALDO
           IF CIP-SGV-MNTO IN IC2-FLD < CIP-VAL-SIMO IN IC2-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-VAL-SIMO-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN6 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.

      * VALIDACION TASA MAXIMA Y TASA PERIODO
           IF CIP-SGV-TOPE IN IC2-FLD < CIP-SGV-TINT IN IC2-FLD
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               MOVE FRM-IND-ERRO TO CIP-SGV-TINT-LEN IN IC2-FLD
               MOVE SPACES TO TAB
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-MEN5 TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS AND TAB-IND-VIGE IN TAB = WCC-S
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2
               ELSE
                   MOVE SPACES TO FRM-MENS
                   GO TO FIN-VAL-CON-FLD-IC2.
      *>>>>
*% END
