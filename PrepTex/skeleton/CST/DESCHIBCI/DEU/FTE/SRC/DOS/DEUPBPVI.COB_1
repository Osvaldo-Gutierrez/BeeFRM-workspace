       IDENTIFICATION DIVISION.
       PROGRAM-ID. DEUPBPVI.
       AUTHOR. P.JELDRES.
      *REMARKS. PAREA EL MAESTRO DE VISA V/S
      *         TABLA OPC DE LA BASE DE DATOS 160.
      *         COMPARA LOS SALDOS,SI SON DIFERENTES IMPRIME
      *         EL REGISTRO.
      *         TAMBIEN DETECTA LOS QUE NO EXISTEN EN UNO U OTRO
      *         ARCHIVO.
      *         SEGUN PARAMETRO GRABA TABLA CAN 170 CON
      *         CANCELACION TOTAL EN EL CASO EN QUE NO EXISTA EN
      *         EL MAESTRO.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 30 DE MARZO DE 1998                                    *
      ******************************************************************
      *---------------------------------------------------------------*
      * MODIFICACION : ACTUALIZAR CAMPO OPC-MSC-STAT CON "E" EN TABLA *
      *                OPC-160 PARA LAS OPERACIONES QUE NO EXISTAN EN *
      *                EL ARCHIVO MAESTRO            ODONOSO 13/04/92 *
      *---------------------------------------------------------------*
      * MODIFICACION : SE CORRIGE MANTENCION ANTERIOR, PARA CONSIDERAR*
      *                ADEMAS QUE LA OPERACION EN LA TABLA OPC NO ESTE*
      *                YA EN ESTADO "E"              ODONOSO 30/04/92 *
      *---------------------------------------------------------------*
      ******************************************************************
      *      MANTENCIONES.
      *      ==============
      *
      *      PROGRAMADOR : FORMAT 2000 INC.
      *      FECHA       : 20.02.1998
      *      CAMBIO      : SE APLICA TECNICA WINDOWING PARA CONVERSION
      *                      2000 COMPLIANT.
      ******************************************************************
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.

       SPECIAL-NAMES.
           C01 IS CANAL-1
           DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT CIN-CINVISA     ASSIGN UT-S-VISA.
      *    SELECT LISTADO ASSIGN TO SYS020-DA-3375-S-LISTADO.
           SELECT LISTADO ASSIGN TO SYS020-UR-1403-S-LISTADO.
       DATA DIVISION.
       FILE SECTION.

      *FD  LISTADO LABEL RECORD STANDARD.
      *01  REG-LIST PIC X(107).
       FD  LISTADO
           LABEL RECORD OMITTED
           RECORD CONTAINS 133 CHARACTERS.
       01  LINEA PIC X(133).
       FD  CIN-CINVISA
           RECORD CONTAINS 448 CHARACTERS
           BLOCK CONTAINS 10 RECORDS
           LABEL RECORD OMITTED.
       01  REG-CINTA.
           03  CIN-RUT.
               05 CIN-RUT-NUMERO-1         PIC   9(01).
               05 CIN-RUT-FILLER           PIC   X.
               05 CIN-RUT-NUMERO-2         PIC   X(08).
               05 CIN-RUT-DIGITO           PIC   X(01).
           03  CIN-NOMBRE                  PIC   X(40).
           03  CIN-DIRECCION               PIC   X(40).
           03  CIN-COMUNA                  PIC   X(15).
           03  CIN-CIUDAD                  PIC   X(15).
           03  CIN-COD-REGION              PIC   9(02).
           03  CIN-TELEFONO                PIC   9(09).
           03  CIN-TIP-TAR2                PIC   9(01).
           03  CIN-FECHA-ACTIV.
               05  CIN-FECHA-ACTIV-DD      PIC   9(02).
               05  CIN-FECHA-ACTIV-MM      PIC   9(02).
               05  CIN-FECHA-ACTIV-AA      PIC   9(02).
           03  CIN-FECH2                   PIC   9(06).
           03  CIN-FECH REDEFINES CIN-FECH2.
               05  DIA2                  PIC   99.
               05  MES2                  PIC   99.
               05  ANO2                  PIC   99.
           03  CIN-COD-EMPRESA             PIC   9(06).
           03  CIN-COD-BLOQ                PIC   9(01).
           03  CIN-COD-PERDIDA             PIC   9(01).
           03  CIN-COD-CARTERA-VENC        PIC   9(01).
           03  CIN-COD-MORA                PIC   9(01).
           03  CIN-COD-FV                  PIC   9(01).
           03  CIN-COD-MOVIMIENTO          PIC   9(01).
           03  CIN-NRO-TAR2.
               05  CIN-NRO-TARJETA-1       PIC   9(02).
               05  CIN-NRO-TARJETA-2       PIC   9(01).
               05  CIN-NRO-TARJETA-3       PIC   9(06).
           03  CIN-NRO-INTERNO.
               05  CIN-NRO-INTERNO-SUC     PIC   9(02).
               05  CIN-NRO-INTERNO-CTA     PIC   9(08).
           03  CIN-CUPO-TOTAL              PIC   9(10).
           03  CIN-CUPO-INTERNAC           PIC   9(10).
           03  CIN-SALDO-DEUDOR            PIC  S9(08)V99  SIGN LEADING
                                                 SEPARATE.
           03  CIN-INT-COBRAR-BANCARD      PIC   9(08)V99.
           03  CIN-INT-COBRAR-USUARIO      PIC   9(08)V99.
           03  CIN-INT-COBRAR-MORA         PIC   9(08)V99.
           03  CIN-INT-DEVENG-BANCARD      PIC   9(08)V99.
           03  CIN-INT-DEVENG-USUARIO      PIC   9(08)V99.
           03  CIN-INT-DEVENG-MORA         PIC   9(08)V99.
           03  CIN-INT-PERCIB-BANCARD      PIC   9(08)V99.
           03  CIN-INT-PERCIB-USUARIO      PIC   9(08)V99.
           03  CIN-INT-PERCIB-MORA         PIC   9(08)V99.
           03  CIN-PAGO-MINIMO             PIC  S9(08)V99  SIGN LEADING
                                                 SEPARATE.
           03  CIN-DIS-AVAN-EFEC           PIC  S9(08)V99  SIGN LEADING
                                                SEPARATE.
           03  CIN-DEUDA-TOTAL             PIC  S9(08)V99  SIGN LEADING
                                                SEPARATE.
           03  CIN-DEUDA-TOTAL-NAC         PIC  S9(08)V99  SIGN LEADING
                                                SEPARATE.
           03  CIN-DEUDA-TOTAL-INT         PIC  S9(08)V99  SIGN LEADING
                                                SEPARATE.
           03  CIN-CUPO-DISP-NAC           PIC  S9(08)V99  SIGN LEADING
                                                SEPARATE.
           03  CIN-CUPO-DISP-INT           PIC  S9(08)V99  SIGN LEADING
                                                SEPARATE.
           03  CIN-DEUDA-MORA-30           PIC   9(08)V99.
           03  CIN-DEUDA-MORA-30-60        PIC   9(08)V99.
           03  CIN-DEUDA-MORA-60-90        PIC   9(08)V99.
           03  CIN-DEUDA-MORA-90           PIC   9(08)V99.
           03  CIN-TRASP-DOLARES           PIC  S9(08)V99  SIGN LEADING
                                                SEPARATE.
           03  FILLER                    PIC   X(23).


       WORKING-STORAGE SECTION.
      *-----------------------
       77  FS-VISA                   PIC XX              VALUE SPACES.
       77  LEIDOS                    PIC 9(9)            VALUE 0.
       77  REG-LEIDOS                PIC 9(9)            VALUE 0.
       77  LEIDOS-BD                 PIC 9(9)            VALUE 0.
       77  IGUALES                   PIC 9(9)            VALUE 0.
       77  VAL-IGUALES               PIC 9(9)            VALUE 0.
       77  VAL-DISTINTOS             PIC 9(9)            VALUE 0.
       77  GRABADOS-OPC              PIC 9(9)            VALUE 0.
       77  GRABADOS-DLC              PIC 9(9)            VALUE 0.
       77  CONTA                     PIC 9(9)            VALUE 0.
       77  CL                        PIC 99              VALUE 70.
       77  CP                        PIC 9(4)            VALUE 0.
       77  FIN-PGM                   PIC XX              VALUE 'NO'.
       77  FECHA-AUX                 PIC XXX             VALUE SPACES.
       77  VALOR-WS                  PIC 9(11)V99        VALUE 0.
       77  FECHA-WS                  PIC 9(6)            VALUE 0.
       77  TIPO-WS                   PIC XXX             VALUE SPACES.
       77  TASA-WS                   PIC 99V9999         VALUE 0.
       77  SW-OPC                    PIC XXX             VALUE SPACES.
       77  CANTI-WS                  PIC 9(7)            VALUE 0.
       77  VALOR-A                   PIC 9(9)V99 COMP-3.
       77  VALOR-B                   PIC 9(9)V99 COMP-3.
       77  GRABADOS-CAN              PIC 9(9)            VALUE 0.
       77  REPETIDOS-CAN             PIC 9(9)            VALUE 0.
       77  CONT-DD-IGUALES           PIC 9(9)            VALUE 0.
       77  CONT-DD-DISTINTOS         PIC 9(9)            VALUE 0.
       77  CONT-DI-IGUALES           PIC 9(9)            VALUE 0.
       77  CONT-DI-DISTINTOS         PIC 9(9)            VALUE 0.
       77  MARCADOS-OPC              PIC 9(9)            VALUE 0.
       77  MARCADOS-DLC              PIC 9(9)            VALUE 0.
       77  MARCADOS-RDC              PIC 9(9)            VALUE 0.
       77  MARCADOS-RDC9             PIC 9(9)            VALUE 0.
       77  MARCADOS-VEN              PIC 9(9)            VALUE 0.
       77  MARCADOS-ICG              PIC 9(9)            VALUE 0.
       77  REPETIDOS-OPC             PIC 9(9)            VALUE 0.
       77  REPETIDOS-DLC             PIC 9(9)            VALUE 0.
       77  REPETIDOS-RDC             PIC 9(9)            VALUE 0.
       77  REPETIDOS-RDC9            PIC 9(9)            VALUE 0.
       77  REPETIDOS-VEN             PIC 9(9)            VALUE 0.
       77  REPETIDOS-ICG             PIC 9(9)            VALUE 0.
       77  ACTUALIZA-OPC             PIC 9(9)            VALUE 0.
       77  RUT-DD                    PIC X(8).
       77  DV-DD                     PIC X.
       77  RUT-DI                    PIC X(8).
       77  DV-DI                     PIC X.
       77  SW-DD                     PIC 9               VALUE 0.
       77  RUT-DD-B                  PIC X(8).
       77  DV-DD-B                   PIC X.
       77  RUT-DI-B                  PIC X(8).
       77  DV-DI-B                   PIC X.
       77  SW-DI                     PIC 9               VALUE 0.
       77  SW-RTN                    PIC 9               VALUE 0.
       77  ICG-WS                    PIC X(15) VALUE SPACES.
       01  TARJETA.
           05 FILLER      PIC X(18) VALUE 'GRABA TABLA CAN : '.
           05 OPCION-T    PIC X(2).
           05 FILLER      PIC X(1).
           05 FECHA-T     PIC 9(6).
           05 RFECHA-T   REDEFINES FECHA-T.
              10 ANO-T   PIC 99.
              10 MES-T   PIC 99.
              10 DIA-T   PIC 99.
           05 FILLER     PIC X(53).
       01  FECHAS-VARIAS.
           05 FECHA-TARJETA PIC 9(6).
           05 RFECHA-TARJETA REDEFINES FECHA-TARJETA.
              10 ANO-TARJETA PIC 99.
              10 MES-TARJETA PIC 99.
              10 DIA-TARJETA PIC 99.
           05 FECHA-APERTURA PIC 9(6).
           05 RFECHA-APERTURA REDEFINES FECHA-APERTURA.
              10 ANO-APERTURA PIC 99.
              10 MES-APERTURA PIC 99.
              10 DIA-APERTURA PIC 99.
       01  LLAVES.
           05 LLAVE-AUX.
              10 LLAVE-1             PIC 999.
              10 LLAVE-2             PIC 9(8).
           05 LLAVE-A.
              10 LLAVE-1A            PIC X(8).
              10 LLAVE-2A            PIC X(3).
           05 LLAVE-B.
              10 LLAVE-2B            PIC X(3).
              10 LLAVE-1B            PIC X(8).
           05 FECHA-HOY.
              10 AA-HOY PIC 99.
              10 MM-HOY PIC 99.
              10 DD-HOY PIC 99.
           05 RDC-WS.
              10 RDC-A PIC X(12).
              10 RDC-B PIC 999.
           05 CLAVE-VISA.
      *       10 COD-VISA    PIC X.
              10 FILLER-VISA PIC 99.
              10 NUMERO-VISA PIC 9(9).
           05 N1-VISA        PIC 9(9).
           05 RN1-VISA REDEFINES N1-VISA.
              10 VISA1       PIC 99.
              10 VISA2       PIC 9.
              10 VISA3       PIC 9(6).


       01  CAMPOS-BCD.
           05 FEC-BCD.
              10 FECHA-BCD           PIC XXX.
              10 RFECHA-BCD REDEFINES FECHA-BCD.
                 15 R-DIA            PIC X.
                 15 R-MES            PIC X.
                 15 R-ANO            PIC X.
              10 FILLER              PIC 9 COMP-3 VALUE 0.
           05 RFEC-BCD REDEFINES FEC-BCD.
              10 FECHA-INT           PIC 9(6)V9 COMP-3.
           05 FECHA-EBCDIC           PIC 9(6).
           05 RFECHA-EBCDIC REDEFINES FECHA-EBCDIC.
              10 DIA-EBCDIC          PIC 99.
              10 MES-EBCDIC          PIC 99.
              10 ANO-EBCDIC          PIC 99.
      *
           05 RUT-MAE                PIC X(6).
           05 FILLER REDEFINES RUT-MAE.
              10 RUT-BASE            PIC X(5).
              10 RUT-DV              PIC X.
           05 RUT-BCD.
              10 RUT-BCD-BASE        PIC X(5).
              10 FILLER-1            PIC 9 COMP-3 VALUE 0.
           05 RUT-COMP REDEFINES RUT-BCD PIC 9(11) COMP-3.
           05 RUT-EBCDIC             PIC 9(11).
           05 FILLER REDEFINES RUT-EBCDIC.
              10 FILLER              PIC 99.
              10 RUT-OK-EBCDIC       PIC 9(8).
              10 FILLER              PIC 9.

           05 WK-AREA-CTACTE-BCD.
              10 WK-CTACTE-BCD       PIC X(4).
              10 FILLER              PIC 9 COMP-3 VALUE 0.
           05 WK-AREA-CTACTE-EBCDIC REDEFINES WK-AREA-CTACTE-BCD.
              10 WK-CTACTE-DISP      PIC 9(8)V9 COMP-3.
           05 WK-CTACTE-EBCDIC       PIC 9(8).

           05 WK-AREA-OFIC-BCD.
              10 WK-OFIC-BCD         PIC XX.
              10 FILLER              PIC 9 COMP-3 VALUE 0.
           05 WK-AREA-OFIC-EBCDIC REDEFINES WK-AREA-OFIC-BCD.
              10 WK-OFIC-DISP        PIC 999V9 COMP-3.
           05 WK-OFIC-EBCDIC         PIC 999.


       01  TIT-1.
           05 FILLER PIC X(46) VALUE 'BANCO DE CREDITO E INVERSIONES'.
           05 FILLER PIC X(70) VALUE
              ' PAREADOR MAESTRO VISA V/S BASE DATOS 160'.
           05 FILLER PIC X(7) VALUE 'FECHA:'.
           05 T1-FECHA.
              10 T1-FECHA-DD  PIC X(2).
              10 FILLER       PIC X(1) VALUE '/'.
              10 T1-FECHA-MM  PIC X(2).
              10 FILLER       PIC X(1) VALUE '/'.
              10 T1-FECHA-AA  PIC X(2).
       01  TIT-2.
           05 FILLER PIC X(45) VALUE 'INTERFAZ COLOCACIONES'.
           05 FILLER PIC X(71) VALUE
              '-----------------------------------------------'.
           05 FILLER PIC X(7) VALUE 'PAG  :'.
           05 PAG-T1 PIC ZZZ9.
       01  RAYA PIC X(132) VALUE ALL '-'.
       01  ESPA PIC X(132) VALUE ALL SPACES.
       01  TIT-3.
           05 FILLER PIC XXX VALUE SPACES.
           05 FILLER PIC X(49)
              VALUE 'C L A V E      RUT DD(BD)  RUT DD(VI) FECHA'.
           05 FILLER PIC X(49)
              VALUE 'FECHA   INDICA. INDICA.      MONTO'.
           05 FILLER PIC X(31)
              VALUE 'SALDO                SALDO'.

       01  TIT-4.
           05 FILLER PIC XXX VALUE SPACES.
           05 FILLER PIC X(49)
              VALUE '                                      CURSE'.
           05 FILLER PIC X(49)
              VALUE 'VCTO.   T.ACC.  STATUS    ORIGINAL'.
           05 FILLER PIC X(31)
              VALUE 'MAESTRO         BASE DATOS'.
       01  DETA-1.
           05 FILLER      PIC X VALUE SPACE.
           05 CLAVE-S     PIC X(8)B.
           05 SUC-S       PIC XXXBBBB.
           05 RUTDDBD-S   PIC X(8).
           05 FILLER      PIC X VALUE '-'.
           05 DVDDBD-S    PIC XBB.
           05 RUTDDSE-S   PIC X(8).
           05 FILLER      PIC X VALUE '-'.
           05 DVDDSE-S    PIC XBB.
           05 DIAC-S      PIC 99.
           05 MESC-S      PIC 99.
           05 ANOC-S      PIC 99BBBB.
           05 DIAV-S      PIC 99.
           05 MESV-S      PIC 99.
           05 ANOV-S      PIC 99BBBB.
           05 INDT-S      PIC XB(8).
           05 INDS-S      PIC XBBBB.
           05 MONTO-S     PIC ZZZZ.ZZZ.ZZ9,9999B.
           05 SALDOM-S    PIC ZZZZZ.ZZZ.ZZ9,9999B.
           05 SALDOB-S    PIC ZZZZZ.ZZZ.ZZ9,9999.
       01  DETA-2.
           05 FILLER      PIC X VALUE SPACE.
           05 CLAVE-2     PIC X(8)B.
           05 SUC-2       PIC XXXB(72).
           05 OBS-S       PIC X(28).
           05 SALDOB-2    PIC ZZZZZ.ZZZ.ZZ9,9999.
       01  DETA-9.
           05 FILLER      PIC X VALUE SPACE.
           05 CLAVE-9     PIC X(8)B.
           05 SUC-9       PIC XXXB(72).
           05 SALDOB-9    PIC ZZZZZ.ZZZ.ZZ9,9999BB.
           05 OBS-9       PIC X(28).
       01  DETA-2A.
           05 FILLER      PIC X(17)  VALUE SPACES.
           05 RUTDIBD-S   PIC X(8).
           05 FILLER      PIC X VALUE '-'.
           05 DVDIBD-S    PIC XBB.
           05 RUTDISE-S   PIC X(8).
           05 FILLER      PIC X VALUE '-'.
           05 DVDISE-S    PIC X.
           05 FILLER      PIC X(90) VALUE SPACES.












      *****************************************************************
      *          USER INFORMATION BLOCK
      *****************************************************************
       01  UIB.
           05 FILLER                 PIC X(32) VALUE 'BSEPAR09'.
      *****************************************************************
      *           REQUEST AREA
      *****************************************************************
       01  REQ-AREA-OPC.
           03 OPC-COMMAND         PIC X(5).
           03 OPC-TABLE           PIC X(3)     VALUE 'OPC'.
           03 OPC-KEY             PIC X(5).
           03 OPC-RET-COD         PIC X(2)     VALUE SPACES.
           03 OPC-INT-RC          PIC X(1).
           03 OPC-DB-ID           PIC S9(4)    COMP VALUE +160.
           03 OPC-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 OPC-CONT-MAX        PIC S9(4)    COMP.
           03 OPC-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 OPC-VALUE           PIC X(28).

       01  REQ-AREA-DLC.
           03 DLC-COMMAND         PIC X(5).
           03 DLC-TABLE           PIC X(3)     VALUE 'DLC'.
           03 DLC-KEY             PIC X(5).
           03 DLC-RET-COD         PIC X(2)     VALUE SPACES.
           03 DLC-INT-RC          PIC X(1).
           03 DLC-DB-ID           PIC S9(4)    COMP VALUE +160.
           03 DLC-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 DLC-CONT-MAX        PIC S9(4)    COMP.
           03 DLC-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 DLC-VALUE           PIC X(40).

       01  REQ-AREA-RDC.
           03 RDC-COMMAND         PIC X(5).
           03 RDC-TABLE           PIC X(3)     VALUE 'RDC'.
           03 RDC-KEY             PIC X(5).
           03 RDC-RET-COD         PIC X(2)     VALUE SPACES.
           03 RDC-INT-RC          PIC X(1).
           03 RDC-DB-ID           PIC S9(4)    COMP VALUE +160.
           03 RDC-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 RDC-CONT-MAX        PIC S9(4)    COMP.
           03 RDC-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 RDC-VALUE           PIC X(40).

       01  REQ-AREA-VEN.
           03 VEN-COMMAND         PIC X(5).
           03 VEN-TABLE           PIC X(3)     VALUE 'VEN'.
           03 VEN-KEY             PIC X(5).
           03 VEN-RET-COD         PIC X(2)     VALUE SPACES.
           03 VEN-INT-RC          PIC X(1).
           03 VEN-DB-ID           PIC S9(4)    COMP VALUE +160.
           03 VEN-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 VEN-CONT-MAX        PIC S9(4)    COMP.
           03 VEN-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 VEN-VALUE           PIC X(40).

       01  REQ-AREA-ICG.
           03 ICG-COMMAND         PIC X(5).
           03 ICG-TABLE           PIC X(3)     VALUE 'ICG'.
           03 ICG-KEY             PIC X(5).
           03 ICG-RET-COD         PIC X(2)     VALUE SPACES.
           03 ICG-INT-RC          PIC X(1).
           03 ICG-DB-ID           PIC S9(4)    COMP VALUE +160.
           03 ICG-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 ICG-CONT-MAX        PIC S9(4)    COMP.
           03 ICG-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 ICG-VALUE           PIC X(40).

       01  REQ-AREA-OPC9.
           03 OPC9-COMMAND         PIC X(5).
           03 OPC9-TABLE           PIC X(3)     VALUE 'OPC'.
           03 OPC9-KEY             PIC X(5).
           03 OPC9-RET-COD         PIC X(2)     VALUE SPACES.
           03 OPC9-INT-RC          PIC X(1).
           03 OPC9-DB-ID           PIC S9(4)    COMP VALUE +170.
           03 OPC9-REC-ID          PIC X(7).
           03 FILLER               PIC X(25).
           03 OPC9-CONT-MAX        PIC S9(4)    COMP.
           03 OPC9-CONT-ID         PIC S9(4)    COMP.
           03 FILLER               PIC X(22).
           03 OPC9-VALUE           PIC X(40).

       01  REQ-AREA-DLC9.
           03 DLC9-COMMAND         PIC X(5).
           03 DLC9-TABLE           PIC X(3)     VALUE 'DLC'.
           03 DLC9-KEY             PIC X(5).
           03 DLC9-RET-COD         PIC X(2)     VALUE SPACES.
           03 DLC9-INT-RC          PIC X(1).
           03 DLC9-DB-ID           PIC S9(4)    COMP VALUE +170.
           03 DLC9-REC-ID          PIC X(7).
           03 FILLER               PIC X(25).
           03 DLC9-CONT-MAX        PIC S9(4)    COMP.
           03 DLC9-CONT-ID         PIC S9(4)    COMP.
           03 FILLER               PIC X(22).
           03 DLC9-VALUE           PIC X(40).

       01  REQ-AREA-RDC9.
           03 RDC9-COMMAND         PIC X(5).
           03 RDC9-TABLE           PIC X(3)     VALUE 'RDC'.
           03 RDC9-KEY             PIC X(5).
           03 RDC9-RET-COD         PIC X(2)     VALUE SPACES.
           03 RDC9-INT-RC          PIC X(1).
           03 RDC9-DB-ID           PIC S9(4)    COMP VALUE +170.
           03 RDC9-REC-ID          PIC X(7).
           03 FILLER               PIC X(25).
           03 RDC9-CONT-MAX        PIC S9(4)    COMP.
           03 RDC9-CONT-ID         PIC S9(4)    COMP.
           03 FILLER               PIC X(22).
           03 RDC9-VALUE           PIC X(40).

       01  REQ-AREA-VEN9.
           03 VEN9-COMMAND         PIC X(5).
           03 VEN9-TABLE           PIC X(3)     VALUE 'VEN'.
           03 VEN9-KEY             PIC X(5).
           03 VEN9-RET-COD         PIC X(2)     VALUE SPACES.
           03 VEN9-INT-RC          PIC X(1).
           03 VEN9-DB-ID           PIC S9(4)    COMP VALUE +170.
           03 VEN9-REC-ID          PIC X(7).
           03 FILLER               PIC X(25).
           03 VEN9-CONT-MAX        PIC S9(4)    COMP.
           03 VEN9-CONT-ID         PIC S9(4)    COMP.
           03 FILLER               PIC X(22).
           03 VEN9-VALUE           PIC X(40).

       01  REQ-AREA-ICG9.
           03 ICG9-COMMAND         PIC X(5).
           03 ICG9-TABLE           PIC X(3)     VALUE 'ICG'.
           03 ICG9-KEY             PIC X(5).
           03 ICG9-RET-COD         PIC X(2)     VALUE SPACES.
           03 ICG9-INT-RC          PIC X(1).
           03 ICG9-DB-ID           PIC S9(4)    COMP VALUE +170.
           03 ICG9-REC-ID          PIC X(7).
           03 FILLER               PIC X(25).
           03 ICG9-CONT-MAX        PIC S9(4)    COMP.
           03 ICG9-CONT-ID         PIC S9(4)    COMP.
           03 FILLER               PIC X(22).
           03 ICG9-VALUE           PIC X(40).


       01  REQ-AREA-CAN.
           03 CAN-COMMAND         PIC X(5).
           03 CAN-TABLE           PIC X(3)     VALUE 'CAN'.
           03 CAN-KEY             PIC X(5).
           03 CAN-RET-COD         PIC X(2)     VALUE SPACES.
           03 CAN-INT-RC          PIC X(1).
           03 CAN-DB-ID           PIC S9(4)    COMP VALUE +170.
           03 CAN-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 CAN-CONT-MAX        PIC S9(4)    COMP.
           03 CAN-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 CAN-VALUE           PIC X(40).

       01  REQ-AREA-DBC.
           03 DBC-COMMAND         PIC X(5).
           03 DBC-TABLE           PIC X(3)     VALUE 'DBC'.
           03 DBC-KEY             PIC X(5).
           03 DBC-RET-COD         PIC X(2)     VALUE SPACES.
           03 DBC-INT-RC          PIC X(1).
           03 DBC-DB-ID           PIC S9(4)    COMP VALUE +100.
           03 DBC-REC-ID          PIC X(7).
           03 FILLER              PIC X(25).
           03 DBC-CONT-MAX        PIC S9(4)    COMP.
           03 DBC-CONT-ID         PIC S9(4)    COMP.
           03 FILLER              PIC X(22).
           03 DBC-VALUE           PIC X(40).
      ****************************************************************
      *                     WORK AREA
      ****************************************************************

       01  REG-OPC.
      *    COPYDD COL-R-OPC.COL-E-OPC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO OPC
           02  COL-E-OPC00.
      *                             OPERACION CREDITO
               03  OPC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  OPC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  OPC-KEY-IREG.
      *                             KEY     IDENTIFICACION OPERACION CRE
                       05  OPC-KEY-IOPC.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  OPC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  OPC-CAI-IOPC.
                       08  OPC-COD-TOPC
                                    PICTURE X(1).
                       08  OPC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  OPC-IIC-IOPC.
                       08  OPC-COD-OOPC.
                       09  OPC-COD-SOPC
                                    PICTURE X(2).
                       09  OPC-IND-SOPC
                                    PICTURE X(1).
                       08  OPC-GLS-NOPC
                                    PICTURE X(5).
      *                             TIME STAMP TRANSACCION
                       05  OPC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  OPC-FEC-FTRN.
                       07  OPC-NUM-STRN
                                    PICTURE 9(2).
                       07  OPC-NUM-ATRN
                                    PICTURE 9(2).
                       07  OPC-NUM-MTRN
                                    PICTURE 9(2).
                       07  OPC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  OPC-HRA-HRTR.
                       07  OPC-NUM-HHTR
                                    PICTURE 9(2).
                       07  OPC-NUM-MMTR
                                    PICTURE 9(2).
                       07  OPC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  OPC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  OPC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  OPC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  OPC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  OPC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  OPC-COD-ATRN PICTURE X(12).
      *                             REQ VALOR DE CAMBIO OPERACION CREDIT
                   04  OPC-COD-VCOC.
      *                             MISCELANEO TIPO VALOR
                       05  OPC-MSC-TVOC
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       05  OPC-COD-CVOC
                                    PICTURE X(3).
      *                             CODIGO TIPO CAMBIO
                       05  OPC-COD-TCOC
                                    PICTURE X(2).
      *                             REQ CODIGO CLASE OPERACION CREDITO
                   04  OPC-COD-COOC.
      *                             CODIGO TIPO OPERACION
                       05  OPC-COD-TOOC
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       05  OPC-COD-AOOC
                                    PICTURE X(3).
      *                             REQ CODIGO OFICINA OPERACION CREDITO
                   04  OPC-COD-OFOC PICTURE X(3).
      *                             RESPONSABLE MANTENCION OPERACION CRE
                   04  OPC-COD-RMOC PICTURE X(12).
      *                             CODIGO DESTINO OPERACION CREDITO
                   04  OPC-COD-CDOC PICTURE X(3).
      *                             COD. INT. COMP. LINEA DE CREDITO
                   04  OPC-CIC-ILDC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       05  OPC-CAI-ILDC.
                       06  OPC-COD-TLDC
                                    PICTURE X(1).
                       06  OPC-COD-CLDC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       05  OPC-IIC-ILDC.
                       06  OPC-COD-OLDC.
                       07  OPC-COD-SLDC
                                    PICTURE X(2).
                       07  OPC-IND-SLDC
                                    PICTURE X(1).
                       06  OPC-GLS-NLDC
                                    PICTURE X(5).
      *                             REQ FECHA CURSE O COLOCACION
                   04  OPC-FEC-FCOL.
                       05  OPC-NUM-SCOL
                                    PICTURE 9(2).
                       05  OPC-NUM-ACOL
                                    PICTURE 9(2).
                       05  OPC-NUM-MCOL
                                    PICTURE 9(2).
                       05  OPC-NUM-DCOL
                                    PICTURE 9(2).
      *                             REQ FECHA CURSE CONTABLE
                   04  OPC-FEC-FING.
                       05  OPC-NUM-SING
                                    PICTURE 9(2).
                       05  OPC-NUM-AING
                                    PICTURE 9(2).
                       05  OPC-NUM-MING
                                    PICTURE 9(2).
                       05  OPC-NUM-DING
                                    PICTURE 9(2).
      *                             REQ FECHA CURSE COMPUTACIONAL
                   04  OPC-FEC-FINP.
                       05  OPC-NUM-SINP
                                    PICTURE 9(2).
                       05  OPC-NUM-AINP
                                    PICTURE 9(2).
                       05  OPC-NUM-MINP
                                    PICTURE 9(2).
                       05  OPC-NUM-DINP
                                    PICTURE 9(2).
      *                             REQ MONTO CREDITO
                   04  OPC-VAL-CRED PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ SALDO VALOR CREDITO
                   04  OPC-VAL-SCRE PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ ANALISIS FERIADOS (S/N)
                   04  OPC-IND-AFER PICTURE X(1).
      *                             REQ MODALIDAD CALCULO VALORES FINALE
                   04  OPC-MSC-MCVF PICTURE X(1).
      *                             REQ TIPO CALCULO VENCIMIENTOS
                   04  OPC-MSC-TCVE.
      *                             BASE CALCULO CREDITO
                       05  OPC-MSC-BCCR
                                    PICTURE X(1).
      *                             VALORES INFORMADOS CREDITO
                       05  OPC-MSC-VICR
                                    PICTURE X(1).
      *                             TIPO RENOVACION
                   04  OPC-IND-RENO PICTURE X(3).
      *                             CONDICION GARANTIA
                   04  OPC-IND-GARA PICTURE X(3).
      *                             VALOR COMISION
                   04  OPC-SGV-VCOM PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR GASTOS
                   04  OPC-VAL-GAST PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             CODIGO DE SEGURO DESGRAVAMEN
                   04  OPC-COD-SEGD.
                       05  OPC-COD-ISEG
                                    PICTURE X(3).
                       05  OPC-COD-CSEG
                                    PICTURE X(3).
                       05  OPC-COD-SSEG
                                    PICTURE X(3).
      *                             VALOR SEGURO
                   04  OPC-VAL-SEGD PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR LIQUIDO
                   04  OPC-SGV-LIQU PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ NUMERO PROXIMO VENCIMIENTO
                   04  OPC-NUM-IVEN PICTURE 9(3).
      *                             REQ NUMERO VENCIMIENTOS ORIGINALES
                   04  OPC-NUM-VCOR PICTURE 9(3).
      *                             REQ NUMERO VENCIMIENTOS VIGENTES
                   04  OPC-NUM-VCVG PICTURE 9(3).
      *                             NUMERO VENCTOS CANCELADOS EN FORMA O
                   04  OPC-NUM-VCCO PICTURE 9(3).
      *                             NUMERO VENCIMIENTOS CANCELADOS MOROS
                   04  OPC-NUM-VCCM PICTURE 9(3).
      *                             NUMERO DE VENCIMIENTOS CANCELADOS VE
                   04  OPC-NUM-VCCV PICTURE 9(3).
      *                             REQ NUMERO TOTAL VENCIMIENTOS CANCEL
                   04  OPC-NUM-TVCC PICTURE 9(3).
      *                             INDICADOR VENCIMIENTOS ESTRUCTURADOS
                   04  OPC-IND-VSTR PICTURE X(1).
      *                             COD. INT. COMP. CREDITO ENLACE
                   04  OPC-CIC-ICEN.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       05  OPC-CAI-ICEN.
                       06  OPC-COD-TCEN
                                    PICTURE X(1).
                       06  OPC-COD-CCEN
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       05  OPC-IIC-ICEN.
                       06  OPC-COD-OCEN.
                       07  OPC-COD-SCEN
                                    PICTURE X(2).
                       07  OPC-IND-SCEN
                                    PICTURE X(1).
                       06  OPC-GLS-NCEN
                                    PICTURE X(5).
      *                             CODIGO AREA GESTION
                   04  OPC-COD-AGES PICTURE X(2).
      *                             FLAG PARA ACTIVAR SIN CONTABILIZAR
                   04  FILLER       PICTURE X(1).
      *                             INDICADOR INSISTENCIA
                   04  FILLER       PICTURE X(1).
      *                             CANAL DE VENTA
                   04  FILLER       PICTURE X(1).
      *                             VALOR SEGURO
                   04  FILLER       PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             GLOSA DISPONIBLE
                   04  OPC-GLS-DISP PICTURE X(20).

       01  REG-VEN.
      *    COPYDD COL-R-VEN.COL-E-VEN00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO VEN
           02  COL-E-VEN00.
      *                             VENCIMIENTOS
               03  VEN.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  VEN-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  VEN-KEY-IREG.
      *                             KEY     IDENTIFICACION VENCIMIENTOS
                       05  VEN-KEY-IVEN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  VEN-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  VEN-CAI-IOPC.
                       08  VEN-COD-TOPC
                                    PICTURE X(1).
                       08  VEN-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  VEN-IIC-IOPC.
                       08  VEN-COD-OOPC.
                       09  VEN-COD-SOPC
                                    PICTURE X(2).
                       09  VEN-IND-SOPC
                                    PICTURE X(1).
                       08  VEN-GLS-NOPC
                                    PICTURE X(5).
      *                             NUMERO IDENTIFICACION VENCIMIENTO
                       06  VEN-NUM-IVEN
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  VEN-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  VEN-FEC-FTRN.
                       07  VEN-NUM-STRN
                                    PICTURE 9(2).
                       07  VEN-NUM-ATRN
                                    PICTURE 9(2).
                       07  VEN-NUM-MTRN
                                    PICTURE 9(2).
                       07  VEN-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  VEN-HRA-HRTR.
                       07  VEN-NUM-HHTR
                                    PICTURE 9(2).
                       07  VEN-NUM-MMTR
                                    PICTURE 9(2).
                       07  VEN-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  VEN-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  VEN-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  VEN-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  VEN-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  VEN-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  VEN-COD-ATRN PICTURE X(12).
      *                             REQ FECHA VENCIMIENTO
                   04  VEN-FEC-FVEN.
                       05  VEN-NUM-SVEN
                                    PICTURE 9(2).
                       05  VEN-NUM-AVEN
                                    PICTURE 9(2).
                       05  VEN-NUM-MVEN
                                    PICTURE 9(2).
                       05  VEN-NUM-DVEN
                                    PICTURE 9(2).
      *                             REQ FECHA INICIO MORA VENCIMIENTO
                   04  VEN-FEC-FIMV.
                       05  VEN-NUM-SIMV
                                    PICTURE 9(2).
                       05  VEN-NUM-AIMV
                                    PICTURE 9(2).
                       05  VEN-NUM-MIMV
                                    PICTURE 9(2).
                       05  VEN-NUM-DIMV
                                    PICTURE 9(2).
      *                             REQ VALOR CAPITAL VENCIMIENTO
                   04  VEN-VAL-CAPI PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ SALDO VALOR CAPITAL VENCIMIENTO
                   04  VEN-VAL-SCAP PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ INT DEVENGADOS NO INCLUIDOS EN V
                   04  VEN-VAL-IDNI PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR FINAL VENCIMIENTO
                   04  VEN-VAL-FINA PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ SALDO VALOR FINAL VENCIMIENTO
                   04  VEN-VAL-SFIN PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SITUACION CONTABLE
                   04  VEN-IND-SCTB PICTURE X(3).
      *                             REQ NUMERO IDENTIFICACION VENCIMIENT
                   04  VEN-NUM-IVCT PICTURE 9(3).
      *                             NUMERO IDENTIFICACION ESTRUCTURA VEN
                   04  VEN-NUM-IEVC PICTURE 9(3).
      *                             REQ NUMERO IDENTIFICACION DOCUMENTO
                   04  VEN-NUM-IDLC PICTURE 9(3).
      *                             INDICADOR CARGO AUTOMATICO
                   04  VEN-IND-CAUT PICTURE X(1).
      *                             SITUACION COBRANZA
                   04  VEN-IND-SCBZ PICTURE X(5).
      *                             MONTO TRASPASADO SITUACION CONTABLE
                   04  VEN-VAL-MTSC PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR TRASPASO SITUACION CONTAB.
                   04  VEN-IND-MTSC PICTURE X(1).
      *                             INDICADOR DE CALCULO
                   04  VEN-IND-CALC PICTURE X(1).
      *                             SITUACION CONTABLE ANTERIOR
                   04  VEN-IND-CTBA PICTURE X(3).
      *                             GLOSA DISPONIBLE
                   04  VEN-GLS-DISP PICTURE X(10).

       01  REG-CAN.
      *    COPYDD COL-R-CAN.COL-E-CAN00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO CAN
           02  COL-E-CAN00.
      *                             CANCELACIONES
               03  CAN.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CAN-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  CAN-KEY-IREG.
      *                             KEY    IDENTIFICACION CANCELACION
                       05  CAN-KEY-ICAN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  CAN-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  CAN-CAI-IOPC.
                       08  CAN-COD-TOPC
                                    PICTURE X(1).
                       08  CAN-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  CAN-IIC-IOPC.
                       08  CAN-COD-OOPC.
                       09  CAN-COD-SOPC
                                    PICTURE X(2).
                       09  CAN-IND-SOPC
                                    PICTURE X(1).
                       08  CAN-GLS-NOPC
                                    PICTURE X(5).
      *                             NUMERO IDENTIFICACION CANCELACION
                       06  CAN-NUM-ICAN
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  CAN-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CAN-FEC-FTRN.
                       07  CAN-NUM-STRN
                                    PICTURE 9(2).
                       07  CAN-NUM-ATRN
                                    PICTURE 9(2).
                       07  CAN-NUM-MTRN
                                    PICTURE 9(2).
                       07  CAN-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CAN-HRA-HRTR.
                       07  CAN-NUM-HHTR
                                    PICTURE 9(2).
                       07  CAN-NUM-MMTR
                                    PICTURE 9(2).
                       07  CAN-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  CAN-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CAN-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  CAN-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CAN-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CAN-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  CAN-COD-ATRN PICTURE X(12).
      *                             REQ OFICINA CANCELACION
                   04  CAN-COD-OFCA PICTURE X(3).
      *                             CODIGO RESPONSABLE CANCELACION
                   04  CAN-COD-RCAN PICTURE X(12).
      *                             REQ CODIGO CANCELACION
                   04  CAN-MSC-CANC.
      *                             TIPO CANCELACION
                       05  CAN-MSC-TCAN
                                    PICTURE X(1).
      *                             FORMA CANCELACION
                       05  CAN-MSC-FCAN
                                    PICTURE X(1).
      *                             ENTIDAD CANCELACION
                       05  CAN-MSC-ECAN
                                    PICTURE X(1).
      *                             REQ FECHA CANCELACION REAL
                   04  CAN-FEC-FCAN.
                       05  CAN-NUM-SCAN
                                    PICTURE 9(2).
                       05  CAN-NUM-ACAN
                                    PICTURE 9(2).
                       05  CAN-NUM-MCAN
                                    PICTURE 9(2).
                       05  CAN-NUM-DCAN
                                    PICTURE 9(2).
      *                             REQ FECHA CANCELACION CONTABLE
                   04  CAN-FEC-FEGR.
                       05  CAN-NUM-SEGR
                                    PICTURE 9(2).
                       05  CAN-NUM-AEGR
                                    PICTURE 9(2).
                       05  CAN-NUM-MEGR
                                    PICTURE 9(2).
                       05  CAN-NUM-DEGR
                                    PICTURE 9(2).
      *                             REQ FECHA CANCELACION COMPUTACIONAL
                   04  CAN-FEC-FOUT.
                       05  CAN-NUM-SOUT
                                    PICTURE 9(2).
                       05  CAN-NUM-AOUT
                                    PICTURE 9(2).
                       05  CAN-NUM-MOUT
                                    PICTURE 9(2).
                       05  CAN-NUM-DOUT
                                    PICTURE 9(2).
      *                             VALOR GASTOS
                   04  CAN-SGV-GAST PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR TOTAL PAGADO
                   04  CAN-SGV-TPAG PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR TOTAL RENOVADO
                   04  CAN-SGV-TREN PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             TOTAL DE VENCIMIENTOS CANCELADOS
                   04  CAN-NUM-TVCC PICTURE S9(3).
      *                             DIFERENCIA, PAGO EFECT - DEBE PAGAR
                   04  CAN-SGV-DIFE PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             FECHA DEVENGO ANTERIOR
                   04  CAN-FEC-FDVA.
                       05  CAN-NUM-SDVA
                                    PICTURE 9(2).
                       05  CAN-NUM-ADVA
                                    PICTURE 9(2).
                       05  CAN-NUM-MDVA
                                    PICTURE 9(2).
                       05  CAN-NUM-DDVA
                                    PICTURE 9(2).
      *                             GLOSA DISPONIBLE
                   04  CAN-GLS-DISP PICTURE X(25).

       01  REG-DBC.
      *    COPYDD DGC-R-DBC.DGC-E-DBC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DBC
           02  DGC-E-DBC00.
      *                             DATOS BASICOS DEL CLIENTE
               03  DBC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DBC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DBC-KEY-IREG.
      *                             IDENTIFICACION DATOS BASICOS CLIENTE
                       05  DBC-KEY-IDBC.
      *                             COD. INT. COMP. CLIENTE
                       06  DBC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DBC-CAI-ICLI.
                       08  DBC-COD-TCLI
                                    PICTURE X(1).
                       08  DBC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DBC-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DBC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DBC-FEC-FTRN.
                       07  DBC-NUM-STRN
                                    PICTURE 9(2).
                       07  DBC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DBC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DBC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DBC-HRA-HRTR.
                       07  DBC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DBC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DBC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DBC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DBC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DBC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DBC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DBC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DBC-COD-ATRN PICTURE X(12).
      *                             KEY RUT CLIENTE + INDICADOR O CALIFI
                   04  DBC-IDC-ICLI.
      *                             RUT CLIENTE
                       05  DBC-NUM-ICLI
                                    PICTURE X(8).
      *                             INDICADOR TIPO RUT
                       05  DBC-IND-ICLI
                                    PICTURE X(1).
      *                             EXTENSION DEL RUT
                       05  DBC-GLS-ICLI
                                    PICTURE X(3).
      *                             KEY DIGITO VERIFICADOR DEL RUT
                   04  DBC-VRF-ICLI PICTURE X(1).
      *                             KEY NOMBRE CLIENTE GENERICO (PERSONA
                   04  DBC-GLS-NOMC.
                       05  DBC-GLS-APAT
                                    PICTURE X(25).
                       05  DBC-GLS-AMAT
                                    PICTURE X(25).
                       05  DBC-GLS-NOMB
                                    PICTURE X(25).
      *                             SOUNDEX DEL NOMBRE DE CLIENTE
                   04  DBC-SNX-NOMC.
                       05  DBC-SNX-APAT
                                    PICTURE X(3).
                       05  DBC-SNX-AMAT
                                    PICTURE X(3).
                       05  DBC-SNX-NOMB
                                    PICTURE X(3).
      *                             NUMERO DE DIRECCION DE ENVIO CORRESP
                   04  DBC-NUM-DCOR PICTURE 9(2).
      *                             OPR IND TIPO CLIENTE ( PERSONA O EMP
                   04  DBC-IND-TICL PICTURE X(1).
      *                             TIPO CLIENTE (POTENCIAL,NO CLIENTE,G
                   04  DBC-COD-TICL PICTURE X(2).
      *                             CODIGO CLASIFICACION COMERCIAL
                   04  DBC-COD-CLCM PICTURE X(2).
      *                             RCM CODIGO DEL EJECUTIVO ENCARGADO D
                   04  DBC-COD-EJEC PICTURE X(12).
      *                             OPR CODIGO DE OFICINA DONDE OPERA EL
                   04  DBC-COD-OFIC PICTURE X(3).
      *                             RCM INDICADOR SI OPERA EN OTRA OFICI
                   04  DBC-IND-OOFI PICTURE X(1).
      *                             EXT CODIGO ACTIVIDAD ECONOMICA
                   04  DBC-COD-ACTI PICTURE X(9).
      *                             EXT ORIGEN Y DESTINO SECT (COMP.INST
                   04  DBC-COD-ODSE PICTURE X(3).
      *                             INF FECHA INGRESO AL PLAN
                   04  DBC-FEC-FPLN.
                       05  DBC-NUM-SPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-APLN
                                    PICTURE 9(2).
                       05  DBC-NUM-MPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-DPLN
                                    PICTURE 9(2).
      *                             CODIGO DE SEGMENTO
                   04  DBC-COD-SETO PICTURE X(5).
      *                             PERIODO DE SEGMENTO (SSAAMM)
                   04  DBC-PDO-SETO PICTURE X(6).
      *                             INF INDICADOR DE MULTAS BANCO CENTRA
                   04  DBC-IND-MUBC PICTURE X(1).
      *                             INF INDICADOR DE JUICIOS BANCO CENTR
                   04  DBC-IND-JUBC PICTURE X(1).
      *                             EXT CODIGO ESTADO CLIENTE ( COMO DEU
                   04  DBC-MSC-SCLI PICTURE X(1).
      *                             FECHA ESTADO CLIENTE
                   04  DBC-FEC-FSCL.
                       05  DBC-NUM-SSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-ASCL
                                    PICTURE 9(2).
                       05  DBC-NUM-MSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-DSCL
                                    PICTURE 9(2).
      *                             CODIGO DE BLOQUEO DEL CLIENTE
                   04  DBC-COD-BLOC PICTURE X(2).
      *                             NUMERO TOTAL DE DIRECCIONES
                   04  DBC-NUM-TDIR PICTURE 9(2).
      *                             NUMERO TOTAL DE COMENTARIOS
                   04  DBC-NUM-TCMT PICTURE 9(3).
      *                             FECHA INICIO OPERACION
                   04  DBC-FEC-FIOP.
                       05  DBC-NUM-SIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-AIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DIOP
                                    PICTURE 9(2).
      *                             FECHA TERMINO OPERACION
                   04  DBC-FEC-FTOP.
                       05  DBC-NUM-STOP
                                    PICTURE 9(2).
                       05  DBC-NUM-ATOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MTOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DTOP
                                    PICTURE 9(2).
      *                             NUMERO OPERACIONES FECHA TERMINO NUL
                   04  DBC-NUM-OFTN PICTURE 9(3).
      *                             FECHA INGRESO DE DATOS A LA BASE DE
                   04  DBC-FEC-FINP.
                       05  DBC-NUM-SINP
                                    PICTURE 9(2).
                       05  DBC-NUM-AINP
                                    PICTURE 9(2).
                       05  DBC-NUM-MINP
                                    PICTURE 9(2).
                       05  DBC-NUM-DINP
                                    PICTURE 9(2).

       01  REG-RDC.
      *    COPYDD COL-R-RDC.COL-E-RDC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RDC
           02  COL-E-RDC00.
      *                             RELACION DEUDOR CREDITO
               03  RDC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RDC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  RDC-KEY-IREG.
      *                             KEY     IDENTIFICACION RELACION DEUD
                       05  RDC-KEY-IRDC.
      *                             COD. INT. COMP. CLIENTE
                       06  RDC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RDC-CAI-ICLI.
                       08  RDC-COD-TCLI
                                    PICTURE X(1).
                       08  RDC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RDC-IIC-ICLI
                                    PICTURE X(8).
      *                             IDENTIFICACION DOCUMENTO LEGAL
                       06  RDC-KEY-IDLC.
      *                             COD. INT. COMP. OPERACION CURSADA
                       07  RDC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  RDC-CAI-IOPC.
                       09  RDC-COD-TOPC
                                    PICTURE X(1).
                       09  RDC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  RDC-IIC-IOPC.
                       09  RDC-COD-OOPC.
                       10  RDC-COD-SOPC
                                    PICTURE X(2).
                       10  RDC-IND-SOPC
                                    PICTURE X(1).
                       09  RDC-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENTIFICACION DOCUMENTO LEGAL
                       07  RDC-NUM-IDLC
                                    PICTURE 9(3).
      *                             CODIGO TIPO RELACION
                       05  RDC-COD-TRDC
                                    PICTURE X(3).
      *                             TIME STAMP TRANSACCION
                       05  RDC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RDC-FEC-FTRN.
                       07  RDC-NUM-STRN
                                    PICTURE 9(2).
                       07  RDC-NUM-ATRN
                                    PICTURE 9(2).
                       07  RDC-NUM-MTRN
                                    PICTURE 9(2).
                       07  RDC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RDC-HRA-HRTR.
                       07  RDC-NUM-HHTR
                                    PICTURE 9(2).
                       07  RDC-NUM-MMTR
                                    PICTURE 9(2).
                       07  RDC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  RDC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RDC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  RDC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RDC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RDC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  RDC-COD-ATRN PICTURE X(12).
      *                             PEN DIRECCION ASOCIADA
                   04  RDC-NUM-DIRE PICTURE X(2).
      *                             REQ MONTO LIMITE DEUDA ( PORCENTAJE
                   04  RDC-VAL-LIMD PICTURE 9(3)V9(6)
                                        COMPUTATIONAL.
      *                             GLOSA DISPONIBLE
                   04  RDC-GLS-DISP PICTURE X(6).

       01  REG-DLC.
      *    COPYDD COL-R-DLC.COL-E-DLC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DLC
           02  COL-E-DLC00.
      *                             DOCUMENTO LEGAL CREDITO
               03  DLC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DLC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  DLC-KEY-IREG.
      *                             KEY     IDENTIFICACION DOCUMENTO LEG
                       05  DLC-KEY-IDLC.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  DLC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DLC-CAI-IOPC.
                       08  DLC-COD-TOPC
                                    PICTURE X(1).
                       08  DLC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DLC-IIC-IOPC.
                       08  DLC-COD-OOPC.
                       09  DLC-COD-SOPC
                                    PICTURE X(2).
                       09  DLC-IND-SOPC
                                    PICTURE X(1).
                       08  DLC-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENTIFICACION DOCUMENTO LEGAL
                       06  DLC-NUM-IDLC
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  DLC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DLC-FEC-FTRN.
                       07  DLC-NUM-STRN
                                    PICTURE 9(2).
                       07  DLC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DLC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DLC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DLC-HRA-HRTR.
                       07  DLC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DLC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DLC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  DLC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DLC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  DLC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DLC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DLC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  DLC-COD-ATRN PICTURE X(12).
      *                             REQ VALOR NOMINAL DOCUMENTO LEGAL
                   04  DLC-VAL-NDLC PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR SALDO DOCUMENTO LEGAL
                   04  DLC-VAL-SDLC PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ CODIGO TIPO DOCUMENTO
                   04  DLC-COD-TDOC PICTURE X(3).
      *                             REQ CODIGO PLAZO ( CONTABLE )
                   04  DLC-COD-PLZO.
                       05  DLC-MSC-TPZO
                                    PICTURE X(1).
                       05  DLC-MSC-CPZO
                                    PICTURE X(1).
      *                             TIPO IMPUESTOS
                   04  DLC-MSC-TIMP PICTURE X(1).
      *                             VALOR IMPUESTOS
                   04  DLC-VAL-IMPU PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             CODIGO NOTARIO CREDITO
                   04  DLC-COD-NOTC.
                       05  DLC-COD-INOT
                                    PICTURE X(3).
                       05  DLC-COD-CNOT
                                    PICTURE X(3).
                       05  DLC-COD-SNOT
                                    PICTURE X(3).
      *                             VALOR GASTOS NOTARIO
                   04  DLC-VAL-GNOT PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SITUACION COBRANZA
                   04  DLC-IND-SCBZ PICTURE X(5).
      *                             REQ SITUACION CARTERA
                   04  DLC-IND-SCRT PICTURE X(3).
      *                             CODIGO UBICACION FISICA
                   04  DLC-COD-UBFD.
                       05  DLC-COD-IUBF
                                    PICTURE X(3).
                       05  DLC-COD-CUBF
                                    PICTURE X(3).
                       05  DLC-COD-SUBF
                                    PICTURE X(3).
      *                             REQ CODIGO PLAZA
                   04  DLC-COD-PLZA PICTURE X(4).
      *                             REQ MANEJO INTERESES PERIODOS LARGOS
                   04  DLC-MSC-MIPL PICTURE X(1).
      *                             REQ CLASIFICACION RIESGO
                   04  DLC-IND-RIES PICTURE X(2).
      *                             PEN VALOR REAJUSTES DEVENGADOS DOCUM
                   04  DLC-VAL-READ PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             PEN VALOR INTERESES DEVENGADOS DOCUM
                   04  DLC-VAL-INTD PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ FECHA DEVENGO ( ULTIMO PAGO TOTA
                   04  DLC-FEC-FDEV.
                       05  DLC-NUM-SDEV
                                    PICTURE 9(2).
                       05  DLC-NUM-ADEV
                                    PICTURE 9(2).
                       05  DLC-NUM-MDEV
                                    PICTURE 9(2).
                       05  DLC-NUM-DDEV
                                    PICTURE 9(2).
      *                             SALDO INTERESES
                   04  DLC-VAL-SINT PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SALDO CAPITAL POR AMORTIZAR
                   04  DLC-VAL-SCPA PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             FECHA AMORTIZACION
                   04  DLC-FEC-FAMT.
                       05  DLC-NUM-SAMT
                                    PICTURE 9(2).
                       05  DLC-NUM-AAMT
                                    PICTURE 9(2).
                       05  DLC-NUM-MAMT
                                    PICTURE 9(2).
                       05  DLC-NUM-DAMT
                                    PICTURE 9(2).
      *                             IDENTIFICACION DOCUMENTO LEGAL ORIGI
                   04  DLC-KEY-IDLO.
      *                             COD. INT. COMP. OPERACION CREDITO OR
                       05  DLC-CIC-IOCO.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       06  DLC-CAI-IOCO.
                       07  DLC-COD-TOCO
                                    PICTURE X(1).
                       07  DLC-COD-COCO
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       06  DLC-IIC-IOCO.
                       07  DLC-COD-OOCO.
                       08  DLC-COD-SOCO
                                    PICTURE X(2).
                       08  DLC-IND-SOCO
                                    PICTURE X(1).
                       07  DLC-GLS-NOCO
                                    PICTURE X(5).
      *                             NUM IDENT DOCUMENTO LEGAL ORIGINAL
                       05  DLC-NUM-IDLO
                                    PICTURE 9(3).
      *                             MONTO INTERESES PENDIENTES
                   04  DLC-VAL-IPEN PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR DOCTO EN PESOS (CUADRE CON
                   04  DLC-VAL-DPES PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR SITUACION CONTABLE
                   04  DLC-IND-SCTB PICTURE X(3).
      *                             FECHA MAXIMO VENCIMIENTO
                   04  DLC-FEC-FMAV.
                       05  DLC-NUM-SMAV
                                    PICTURE 9(2).
                       05  DLC-NUM-AMAV
                                    PICTURE 9(2).
                       05  DLC-NUM-MMAV
                                    PICTURE 9(2).
                       05  DLC-NUM-DMAV
                                    PICTURE 9(2).
      *                             VENC. EN SITUACION CONTBLE ESPECIAL
                   04  DLC-NUM-VSCE PICTURE 9(3).
      *                             FECHA SUSPENCION DEVENGO
                   04  DLC-FEC-FSDE.
                       05  DCL-NUM-SSDE
                                    PICTURE 9(2).
                       05  DCL-NUM-ASDE
                                    PICTURE 9(2).
                       05  DCL-NUM-MSDE
                                    PICTURE 9(2).
                       05  DCL-NUM-DSDE
                                    PICTURE 9(2).
      *                             GLOSA DISPONIBLE
                   04  DLC-GLS-DISP PICTURE X(63).

       01  REG-ICG.
      *    COPYDD COL-R-ICG.COL-E-ICG00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO ICG
           02  COL-E-ICG00.
      *                             INTERES COMISIONES GASTOS
               03  ICG.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  ICG-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  ICG-KEY-IREG.
      *                             KEY     IDENTIFICACION TASAS
                       05  ICG-KEY-IICG.
      *                             IDENTIFICACION CANCELACION
                       06  ICG-KEY-ICAN.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  ICG-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  ICG-CAI-IOPC.
                       09  ICG-COD-TOPC
                                    PICTURE X(1).
                       09  ICG-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  ICG-IIC-IOPC.
                       09  ICG-COD-OOPC.
                       10  ICG-COD-SOPC
                                    PICTURE X(2).
                       10  ICG-IND-SOPC
                                    PICTURE X(1).
                       09  ICG-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENT. CANCELACION
                       07  ICG-NUM-ICAN
                                    PICTURE 9(3).
      *                             IDENTIFICACION VENCIMIENTO
                       06  ICG-KEY-IVCT.
      *                             COD. INT. COMP. OPERACION CREDITO
                       07  ICG-CIC-IOPV.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  ICG-CAI-IOPV.
                       09  ICG-COD-TOPV
                                    PICTURE X(1).
                       09  ICG-COD-COPV
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  ICG-IIC-IOPV.
                       09  ICG-COD-OOPV.
                       10  ICG-COD-SOPV
                                    PICTURE X(2).
                       10  ICG-IND-SOPV
                                    PICTURE X(1).
                       09  ICG-GLS-NOPV
                                    PICTURE X(5).
      *                             NUM IDENT. VENCIMIENTO
                       07  ICG-NUM-IVCT
                                    PICTURE 9(3).
      *                             TIPO TASA
                       06  ICG-IND-TTAS
                                    PICTURE X(3).
      *                             FECHA INICIO VIGENCIA TASA
                       06  ICG-FEC-FINI.
                       07  ICG-NUM-SINI
                                    PICTURE 9(2).
                       07  ICG-NUM-AINI
                                    PICTURE 9(2).
                       07  ICG-NUM-MINI
                                    PICTURE 9(2).
                       07  ICG-NUM-DINI
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  ICG-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  ICG-FEC-FTRN.
                       07  ICG-NUM-STRN
                                    PICTURE 9(2).
                       07  ICG-NUM-ATRN
                                    PICTURE 9(2).
                       07  ICG-NUM-MTRN
                                    PICTURE 9(2).
                       07  ICG-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  ICG-HRA-HRTR.
                       07  ICG-NUM-HHTR
                                    PICTURE 9(2).
                       07  ICG-NUM-MMTR
                                    PICTURE 9(2).
                       07  ICG-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  ICG-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  ICG-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  ICG-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  ICG-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  ICG-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  ICG-COD-ATRN PICTURE X(12).
      *                             REQ CODIGO TIPO TASA INTERES
                   04  ICG-COD-TINT.
      *                             CODIGO TIPO TASA
                       05  ICG-COD-TIPT.
      *                             BASE CALCULO TASA INTERES
                       06  ICG-MSC-BCTI
                                    PICTURE X(1).
      *                             PERIODO BASE TASA INTERES
                       06  ICG-MSC-PBTI
                                    PICTURE X(1).
      *                             MODALIDAD CALCULO TASA INTERES
                       06  ICG-MSC-MCTI.
      *                             BAJO PERIODO BASE TASA           COL
                       07  ICG-MSC-BPBT
                                    PICTURE X(1).
      *                             SOBRE PERIODO BASE TASA          COL
                       07  ICG-MSC-SPBT
                                    PICTURE X(1).
      *                             CODIGO VALOR TASA INTERES
                       05  ICG-COD-CVTI
                                    PICTURE X(3).
      *                             TIPO FECHA PERIODO REPACTO
                       05  ICG-MSC-TFPR
                                    PICTURE X(1).
      *                             NUMERO PERIODO REPACTO
                       05  ICG-NUM-PREP
                                    PICTURE 9(3).
      *                             UNIDAD TIEMPO PERIODO REPACTO
                       05  ICG-MSC-UTPR
                                    PICTURE X(1).
      *                             FECHA TERMINO VIGENCIA TASA
                   04  ICG-FEC-FTER.
                       05  ICG-NUM-STER
                                    PICTURE 9(2).
                       05  ICG-NUM-ATER
                                    PICTURE 9(2).
                       05  ICG-NUM-MTER
                                    PICTURE 9(2).
                       05  ICG-NUM-DTER
                                    PICTURE 9(2).
      *                             REQ VALOR SPREAD
                   04  ICG-SGV-SPRD PICTURE S9(3)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR TASA
                   04  ICG-SGV-TINT PICTURE S9(3)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR EN MONTO
                   04  ICG-SGV-MNTO PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             GLOSA DISPONIBLE
                   04  ICG-GLS-DISP PICTURE X(7).
      ******************************************************************
      *                     ELEMENT LIST
      ******************************************************************


       01  ELEM-LIST-OPC.
           05 ELEM-1          PIC X(5) VALUE 'OPC00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-DLC.
           05 ELEM-1          PIC X(5) VALUE 'DLC00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-VEN.
           05 ELEM-1          PIC X(5) VALUE 'VEN00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-RDC.
           05 ELEM-1          PIC X(5) VALUE 'RDC00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-ICG.
           05 ELEM-1          PIC X(5) VALUE 'ICG00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-CAN.
           05 ELEM-1          PIC X(5) VALUE 'CAN00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
       01  ELEM-LIST-DBC.
           05 ELEM-1          PIC X(5) VALUE 'DBC00'.
           05 ELEM-SEC        PIC X(1).
           05 FILLER          PIC X(5) VALUE SPACES.
      *
           COPY RLOVR001.







       PROCEDURE DIVISION.
      *------------------
             ENTRY 'DBMSCBL'

           ACCEPT TARJETA
           OPEN OUTPUT LISTADO.
           ACCEPT FECHA-HOY FROM DATE
           MOVE DD-HOY TO T1-FECHA-DD
           MOVE MM-HOY TO T1-FECHA-MM
           MOVE AA-HOY TO T1-FECHA-AA
           PERFORM ABRIR-ARCHIVOS.
           READ CIN-CINVISA AT END MOVE 'SI' TO FIN-PGM
                               MOVE HIGH-VALUES TO LLAVE-A.
           PERFORM LEER-MAESTRO.
           PERFORM LEER-BD1.
           PERFORM PROCESO UNTIL (FIN-PGM = 'SI'
                   AND SW-OPC = 'FIN').
           PERFORM CERRAR-ARCHIVOS.
           CLOSE LISTADO.
           PERFORM ESTADISTICAS
           GOBACK.

       EJECT


       ABRIR-ARCHIVOS.
      *---------------

           OPEN INPUT  CIN-CINVISA.
       CERRAR-ARCHIVOS.
      *----------------
           CLOSE CIN-CINVISA.
      *
       LEER-MAESTRO.
      *--------------
           READ CIN-CINVISA AT END MOVE 'SI' TO FIN-PGM
                               MOVE HIGH-VALUES TO LLAVE-A.
           ADD 1 TO CONTA.
           IF FIN-PGM NOT = 'SI'
                 MOVE 0                 TO FILLER-VISA
                 MOVE CIN-NRO-TARJETA-1 TO VISA1
                 MOVE CIN-NRO-TARJETA-2 TO VISA2
                 MOVE CIN-NRO-TARJETA-3 TO VISA3
                 MOVE N1-VISA           TO NUMERO-VISA
                 MOVE CLAVE-VISA        TO LLAVE-A
                 ADD 1 TO LEIDOS.
      ****************************************************************
      *    IF LEIDOS < 10
      *        DISPLAY '********************************'
      *        DISPLAY 'VISA1:' VISA1
      *        DISPLAY 'VISA1:' VISA2
      *        DISPLAY 'VISA1:' VISA3
      *        DISPLAY 'N1-VISA:' N1-VISA
      *        DISPLAY 'NUMERO-VISA:' NUMERO-VISA
      *        DISPLAY 'CLAVE-VISA:' CLAVE-VISA
      *        DISPLAY 'LLAVE-A:' LLAVE-A
      *       ELSE MOVE 'SI' TO FIN-PGM MOVE 'FIN' TO SW-OPC.


       LEER-BD1.
      *----------

           MOVE 'E                 ' TO OPC-VALUE
           MOVE 'LOCKY'                   TO OPC-COMMAND
           MOVE 'OPC00'                   TO OPC-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-OPC OPC ELEM-LIST-OPC
           IF OPC-RET-COD = SPACES
              THEN
               MOVE 'REDLE'                   TO OPC-COMMAND
               MOVE 'OPC00'                   TO OPC-KEY
               CALL 'DBNTRY' USING UIB REQ-AREA-OPC OPC ELEM-LIST-OPC
               IF OPC-RET-COD NOT = SPACES
                  THEN DISPLAY 'ERROR EN REDLE :' OPC-RET-COD
                       GOBACK
                  ELSE
                   NEXT SENTENCE
              ELSE DISPLAY 'ERROR EN LOCKY :' OPC-RET-COD
                   GOBACK.
             ADD 1 TO LEIDOS-BD
             MOVE OPC-COD-COPC TO LLAVE-2B
             MOVE OPC-IIC-IOPC TO LLAVE-1B.
      *      DISPLAY 'LLAVE-2B:' LLAVE-2B
      *      DISPLAY 'LLAVE-1B:' LLAVE-1B
      *      DISPLAY 'LLAVE-B:' LLAVE-B.
       ACCESO-OPC.
      *-----------
           MOVE 'OPC00'                   TO OPC-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-OPC OPC ELEM-LIST-OPC.
           IF OPC-RET-COD NOT = SPACES
                 THEN
                  DISPLAY 'ERROR EN ' OPC-COMMAND ' : ' OPC-RET-COD
                  DISPLAY ' O P C'
                  DISPLAY 'REG LEIDOS:' REG-LEIDOS
                  MOVE 'FIN' TO SW-OPC
                  MOVE HIGH-VALUES TO LLAVE-B
                 ELSE ADD 1 TO REG-LEIDOS
                  IF OPC-COD-TOPC = 'E'
                     IF (OPC-COMMAND = 'REDNX')
                         ADD 1 TO LEIDOS-BD
                     END-IF
                      MOVE OPC-COD-COPC TO LLAVE-2B
                      MOVE OPC-IIC-IOPC TO LLAVE-1B
      *      DISPLAY 'LLAVE-2B:' LLAVE-2B
      *      DISPLAY 'LLAVE-1B:' LLAVE-1B
      *      DISPLAY 'LLAVE-B:' LLAVE-B
                     ELSE
                      MOVE HIGH-VALUES TO LLAVE-B
                      MOVE 'FIN' TO SW-OPC.
       PROCESO.
      *---------
      ****** DISPLAY 'LLAVES:' LLAVE-A ' ' LLAVE-B
             IF LLAVE-A = LLAVE-B
                THEN ADD 1 TO IGUALES
                 PERFORM PROCESO-IGUAL
                ELSE
                 IF LLAVE-A < LLAVE-B
                    THEN
                     PERFORM PROCESO-MENOR
                    ELSE
                     PERFORM PROCESO-MAYOR.


       PROCESO-IGUAL.
      *------------------
           MOVE CIN-SALDO-DEUDOR TO VALOR-A
           IF CIN-SALDO-DEUDOR < 0 MOVE ZEROS TO VALOR-A.
           MOVE OPC-VAL-SCRE TO VALOR-B
      **** DISPLAY 'VALORES:' VALOR-A ' ' VALOR-B
           MOVE 0 TO SW-DD
           MOVE 0 TO SW-DI
           MOVE 0 TO SW-RTN
           MOVE CIN-RUT-NUMERO-2 TO RUT-DD-B
           MOVE CIN-RUT-DIGITO   TO DV-DD-B

           PERFORM LEER-DD-BD

              PERFORM COMPARAR-DD.
           IF VALOR-A = VALOR-B
              THEN ADD 1 TO VAL-IGUALES
              ELSE MOVE 1 TO SW-RTN
                  ADD 1 TO VAL-DISTINTOS.
           IF (SW-RTN = 1) OR (SW-DD = 1)
              PERFORM RTN-IMPRESION.

           IF SW-DD = 1
              THEN
               PERFORM MARCAR-BD
              ELSE
               NEXT SENTENCE.

           IF FIN-PGM NOT = 'SI'
              PERFORM LEER-MAESTRO.
           IF SW-OPC NOT = 'FIN'
              MOVE 'REDNX' TO OPC-COMMAND
              PERFORM ACCESO-OPC.
       PROCESO-MENOR.
      *---------------
           IF CIN-SALDO-DEUDOR NOT = ZEROES
             MOVE LLAVE-1A        TO CLAVE-9
             MOVE LLAVE-2A        TO SUC-9
             MOVE 'CLAVE NO EXISTE EN BD=160' TO OBS-9
             MOVE CIN-SALDO-DEUDOR TO SALDOB-9
             IF CL > 60
                PERFORM ENCABEZADO
                WRITE LINEA FROM DETA-9    AFTER 1
                ADD 1 TO CL
             ELSE
                WRITE LINEA FROM DETA-9    AFTER 1
                ADD 1 TO CL.
           PERFORM LEER-MAESTRO.
       PROCESO-MAYOR.
      *---------------
           IF OPC-VAL-SCRE = ZEROES
              NEXT SENTENCE
           ELSE
              PERFORM VER-SI-GRABA-TABLA-CAN
              MOVE LLAVE-1B        TO CLAVE-2
              MOVE LLAVE-2B        TO SUC-2
              MOVE OPC-VAL-SCRE    TO SALDOB-2
              MOVE 'CLAVE NO EXISTE EN MAESTRO' TO OBS-S
              IF CL > 60
                 PERFORM ENCABEZADO
                 WRITE LINEA FROM DETA-2    AFTER 1
                 ADD 1 TO CL
              ELSE
                 WRITE LINEA FROM DETA-2    AFTER 1
                 ADD 1 TO CL.

           IF (OPC-MSC-STAT NOT = 'E')
               MOVE 'RDUKY' TO OPC-COMMAND
               PERFORM ACCESO-OPC
               MOVE 'E' TO OPC-MSC-STAT
               MOVE 'UPDAT' TO OPC-COMMAND
               PERFORM ACCESO-OPC
               ADD 1 TO ACTUALIZA-OPC.

           MOVE 'REDNX' TO OPC-COMMAND
           PERFORM ACCESO-OPC.

       COMPARAR-DD.
      *-------------
           IF RUT-DD = RUT-DD-B
              THEN MOVE 0 TO SW-DD
               ADD 1 TO CONT-DD-IGUALES
              ELSE
               MOVE 1 TO SW-DD
               ADD 1 TO CONT-DD-DISTINTOS.


       LEER-DD-BD.
      *--------------
           MOVE SPACES        TO RDC-VALUE
           MOVE OPC-CIC-IOPC  TO RDC-A
           MOVE 000           TO RDC-B
           MOVE RDC-WS        TO RDC-VALUE
               MOVE 'REDKY'                   TO RDC-COMMAND
               MOVE 'RDC01'                   TO RDC-KEY
               CALL 'DBNTRY' USING UIB REQ-AREA-RDC RDC ELEM-LIST-RDC
               IF RDC-RET-COD NOT = SPACES
                  THEN
      *                DISPLAY 'ERROR EN REDKY (RDC):' RDC-RET-COD
      *                DISPLAY 'CLAVE:' RDC-VALUE
                       MOVE ZEROS        TO RUT-DD
                       MOVE '0'          TO DV-DD
                       MOVE 1 TO SW-DD
                  ELSE
                   MOVE SPACES           TO DBC-VALUE
                   MOVE RDC-CIC-ICLI     TO DBC-VALUE
                   MOVE 'REDKY'          TO DBC-COMMAND
                   MOVE 'DBC00'          TO DBC-KEY
                   CALL 'DBNTRY' USING UIB REQ-AREA-DBC DBC
                                 ELEM-LIST-DBC
                   IF DBC-RET-COD NOT = SPACES
                      THEN DISPLAY 'ERROR EN REDKY (DBC):' DBC-RET-COD
                           DISPLAY 'CLAVE:' DBC-KEY
                           MOVE 1 TO SW-DD
                           MOVE ZEROS    TO RUT-DD
                           MOVE '0'      TO DV-DD
                      ELSE
                           MOVE DBC-NUM-ICLI TO RUT-DD
                           MOVE DBC-VRF-ICLI TO DV-DD.


       MARCAR-BD.
      *-----------
           MOVE SPACES        TO OPC9-VALUE
           MOVE OPC-KEY-IOPC  TO OPC9-VALUE
           MOVE 'D'           TO OPC-MSC-TACC
           MOVE ' '           TO OPC-MSC-STAT
           MOVE 'ADDIT'       TO OPC9-COMMAND
           MOVE 'OPC00'       TO OPC9-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-OPC9 OPC ELEM-LIST-OPC
           IF OPC9-RET-COD NOT = SPACES
              THEN
               IF OPC9-RET-COD = '10'
                 THEN
                  ADD 1 TO REPETIDOS-OPC
                  DISPLAY 'REG-DUPLICADO  OPC:' OPC
                 ELSE
                  DISPLAY 'NO GRABO TABLA OPC'
                  DISPLAY 'STATUS:' OPC9-RET-COD
                  DISPLAY 'PROCESO CANCELADO'
                  DISPLAY 'PROCESO CANCELADO' UPON CONSOLE
                  CLOSE CIN-CINVISA LISTADO
                  PERFORM ESTADISTICAS
                  GOBACK
              ELSE ADD 1 TO MARCADOS-OPC.


           MOVE SPACES          TO DLC-VALUE
           MOVE OPC-KEY-IOPC    TO DLC-CIC-IOPC
           MOVE 001             TO DLC-NUM-IDLC
           MOVE DLC-KEY-IDLC    TO DLC-VALUE
           MOVE 'REDKY'         TO DLC-COMMAND
           MOVE 'DLC00'         TO DLC-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-DLC DLC ELEM-LIST-DLC.
           IF DLC-RET-COD NOT = SPACES
              THEN
                  DISPLAY '------------------------'
                  DISPLAY 'NO ACCESO DLC, COD.RET :' DLC-RET-COD
                  DISPLAY '------------------------'
                  DISPLAY 'REQ. AREA :' REQ-AREA-DLC
              ELSE
      *        MOVE SPACES        TO DLC9-VALUE
      *        MOVE DLC-KEY-IDLC  TO DLC9-VALUE
               MOVE 'D'           TO DLC-MSC-TACC
               MOVE ' '           TO DLC-MSC-STAT
               MOVE 'ADDIT'       TO DLC9-COMMAND
               MOVE 'DLC00'       TO DLC9-KEY
               CALL 'DBNTRY' USING UIB REQ-AREA-DLC9 DLC ELEM-LIST-DLC
               IF DLC9-RET-COD NOT = SPACES
                  THEN
                   IF DLC9-RET-COD = '10'
                      THEN
                       ADD 1 TO REPETIDOS-DLC
                       DISPLAY 'REG-DUPLICADO  DLC:' DLC
                      ELSE
                       DISPLAY 'NO GRABO TABLA DLC'
                       DISPLAY 'STATUS:' DLC9-RET-COD
                       DISPLAY 'PROCESO CANCELADO'
                       DISPLAY 'PROCESO CANCELADO' UPON CONSOLE
                       CLOSE CIN-CINVISA LISTADO
                       PERFORM ESTADISTICAS
                       GOBACK
                  ELSE ADD 1 TO MARCADOS-DLC.




           MOVE SPACES        TO RDC-VALUE
           MOVE OPC-KEY-IOPC  TO RDC-A
           MOVE 000           TO RDC-B
           MOVE RDC-WS        TO RDC-VALUE
           MOVE 'REDKY'       TO RDC-COMMAND
           MOVE 'RDC01'       TO RDC-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-RDC RDC ELEM-LIST-RDC.
           IF RDC-RET-COD NOT = SPACES
              THEN
                  DISPLAY '------------------------'
                  DISPLAY 'NO ACCESO RDC, COD.RET :' RDC-RET-COD
                  DISPLAY '------------------------'
                  DISPLAY 'REQ. AREA :' REQ-AREA-RDC
              ELSE
      *        MOVE SPACES        TO RDC9-VALUE
      *        MOVE RDC-KEY-IRDC  TO RDC9-VALUE
               MOVE 'D'           TO RDC-MSC-TACC
               MOVE ' '           TO RDC-MSC-STAT
               MOVE 'ADDIT'       TO RDC9-COMMAND
               MOVE 'RDC01'       TO RDC9-KEY
               CALL 'DBNTRY' USING UIB REQ-AREA-RDC9 RDC ELEM-LIST-RDC
               IF RDC9-RET-COD NOT = SPACES
                  THEN
                   IF RDC9-RET-COD = '10'
                      THEN
                       ADD 1 TO REPETIDOS-RDC
                       DISPLAY 'REG-DUPLICADO  DLC:' RDC
                      ELSE
                       DISPLAY 'NO GRABO TABLA RDC'
                       DISPLAY 'STATUS:' RDC9-RET-COD
                       DISPLAY 'PROCESO CANCELADO'
                       DISPLAY 'PROCESO CANCELADO' UPON CONSOLE
                       CLOSE CIN-CINVISA LISTADO
                       PERFORM ESTADISTICAS
                       GOBACK
                  ELSE ADD 1 TO MARCADOS-RDC.



      *    IF (SW-DI = 0) AND
      *       ((RUT-DI NOT = ZEROS) OR (RUT-DI-B NOT = ZEROS))
      *       MOVE SPACES        TO RDC-VALUE
      *       MOVE OPC-KEY-IOPC  TO RDC-A
      *       MOVE 001           TO RDC-B
      *       MOVE RDC-WS        TO RDC-VALUE
      *       MOVE 'REDKY'       TO RDC-COMMAND
      *       MOVE 'RDC01'       TO RDC-KEY
      *       CALL 'DBNTRY' USING UIB REQ-AREA-RDC RDC ELEM-LIST-RDC
      *       IF RDC-RET-COD NOT = SPACES
      *          THEN
      *           DISPLAY '------------------------'
      *           DISPLAY 'NO ACCESO DLC, COD.RET :' RDC-RET-COD
      *           DISPLAY '------------------------'
      *           DISPLAY 'REQ. AREA :' REQ-AREA-RDC
      *          ELSE
      *           MOVE SPACES        TO RDC9-VALUE
      *           MOVE RDC-KEY-IRDC  TO RDC9-VALUE
      *           MOVE 'D'           TO RDC-MSC-TACC
      *           MOVE ' '           TO RDC-MSC-STAT
      *           MOVE 'ADDIT'       TO RDC9-COMMAND
      *           MOVE 'RDC01'       TO RDC9-KEY
      *          CALL 'DBNTRY' USING UIB REQ-AREA-RDC9 RDC ELEM-LIST-RDC
      *          IF RDC9-RET-COD NOT = SPACES
      *             THEN
      *              IF RDC9-RET-COD = '10'
      *                 THEN
      *                  ADD 1 TO REPETIDOS-RDC9
      *                  DISPLAY 'REG-DUPLICADO  DLC:' RDC
      *                 ELSE
      *                  DISPLAY 'NO GRABO TABLA RDC'
      *                  DISPLAY 'STATUS:' RDC9-RET-COD
      *                  DISPLAY 'PROCESO CANCELADO'
      *                  DISPLAY 'PROCESO CANCELADO' UPON CONSOLE
      *                  CLOSE CIN-CINVISA LISTADO
      *                  PERFORM ESTADISTICAS
      *                  GOBACK
      *           ELSE ADD 1 TO MARCADOS-RDC9
      *       ELSE NEXT SENTENCE.




           MOVE SPACES          TO VEN-VALUE
           MOVE OPC-KEY-IOPC    TO VEN-CIC-IOPC
           MOVE 001             TO VEN-NUM-IVEN
           MOVE VEN-KEY-IVEN    TO VEN-VALUE
           MOVE 'REDKY'         TO VEN-COMMAND
           MOVE 'VEN00'         TO VEN-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-VEN VEN ELEM-LIST-VEN.
           IF VEN-RET-COD NOT = SPACES
              THEN
                  DISPLAY '------------------------'
                  DISPLAY 'NO ACCESO VEN, COD.RET :' VEN-RET-COD
                  DISPLAY '------------------------'
                  DISPLAY 'REQ. AREA :' REQ-AREA-VEN
              ELSE
      *        MOVE SPACES        TO VEN9-VALUE
      *        MOVE VEN-KEY-IVEN  TO VEN9-VALUE
               MOVE 'D'           TO VEN-MSC-TACC
               MOVE ' '           TO VEN-MSC-STAT
               MOVE 'ADDIT'       TO VEN9-COMMAND
               MOVE 'VEN00'       TO VEN9-KEY
               CALL 'DBNTRY' USING UIB REQ-AREA-VEN9 VEN ELEM-LIST-VEN
               IF VEN9-RET-COD NOT = SPACES
                  THEN
                   IF VEN9-RET-COD = '10'
                      THEN
                       ADD 1 TO REPETIDOS-VEN
                       DISPLAY 'REG-DUPLICADO  VEN:' VEN
                      ELSE
                       DISPLAY 'NO GRABO TABLA VEN'
                       DISPLAY 'STATUS:' VEN9-RET-COD
                       DISPLAY 'PROCESO CANCELADO'
                       DISPLAY 'PROCESO CANCELADO' UPON CONSOLE
                       CLOSE CIN-CINVISA LISTADO
                       PERFORM ESTADISTICAS
                       GOBACK
                  ELSE ADD 1 TO MARCADOS-VEN.






           MOVE SPACES          TO ICG-VALUE
           MOVE OPC-KEY-IOPC    TO ICG-CIC-IOPC
           MOVE 000             TO ICG-NUM-ICAN
           MOVE ICG-KEY-ICAN    TO ICG-VALUE
           MOVE ICG-KEY-ICAN    TO ICG-WS
           MOVE 'LOCKY'         TO ICG-COMMAND
           MOVE 'ICG00'         TO ICG-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-ICG ICG ELEM-LIST-ICG.
           IF ICG-RET-COD = SPACES
              THEN
               MOVE 'REDLE'       TO ICG-COMMAND
               MOVE 'ICG00'       TO ICG-KEY
               CALL 'DBNTRY' USING UIB REQ-AREA-ICG ICG ELEM-LIST-ICG
               IF ICG-RET-COD NOT = SPACES
                  THEN DISPLAY 'ERROR EN REDLE :' ICG-RET-COD
                       PERFORM ESTADISTICAS
                       GOBACK
                  ELSE
                   NEXT SENTENCE
              ELSE DISPLAY 'ERROR EN LOCKY :' ICG-RET-COD
                   PERFORM ESTADISTICAS
                   GOBACK.

           IF ICG-WS = ICG-KEY-ICAN
      *        MOVE SPACES        TO ICG9-VALUE
      *        MOVE ICG-KEY-ICAN  TO ICG9-VALUE
               MOVE 'D'           TO ICG-MSC-TACC
               MOVE ' '           TO ICG-MSC-STAT
               MOVE 'ADDIT'       TO ICG9-COMMAND
               MOVE 'ICG00'       TO ICG9-KEY
               CALL 'DBNTRY' USING UIB REQ-AREA-ICG9 ICG ELEM-LIST-ICG
               IF ICG9-RET-COD NOT = SPACES
                  THEN
                   IF ICG9-RET-COD = '10'
                      THEN
                       ADD 1 TO REPETIDOS-ICG
                       DISPLAY 'REG-DUPLICADO  ICG:' ICG
                      ELSE
                       DISPLAY 'NO GRABO TABLA UCG'
                       DISPLAY 'STATUS:' ICG9-RET-COD
                       DISPLAY 'PROCESO CANCELADO'
                       DISPLAY 'PROCESO CANCELADO' UPON CONSOLE
                       PERFORM ESTADISTICAS
                       CLOSE CIN-CINVISA LISTADO
                       GOBACK
                  ELSE ADD 1 TO MARCADOS-ICG.




       FIN-MARCAR-BD.
      *--------------
       VER-SI-GRABA-TABLA-CAN.
      *----------------------
           IF OPCION-T = 'SI'
              PERFORM GRABA-TABLA-CAN.

       GRABA-TABLA-CAN.
      *---------------
           PERFORM MOVER-DATOS-CAN
           MOVE 'ADDIT'                   TO CAN-COMMAND
           MOVE 'CAN00'                   TO CAN-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-CAN CAN ELEM-LIST-CAN.
           IF CAN-RET-COD NOT = SPACES
              IF CAN-RET-COD = '10'
                 DISPLAY 'REG. CAN DUPLICADO:' CAN-KEY-ICAN
                 ADD 1 TO REPETIDOS-CAN
              ELSE
                 DISPLAY '--------------------'
                 DISPLAY 'NO GRABO ARCHIVO CAN, COD.RET :' CAN-RET-COD
                 DISPLAY '--------------------'
                 DISPLAY 'REQ. AREA :' REQ-AREA-CAN
                 DISPLAY 'REG:' CAN
                 DISPLAY 'PROCESO CANCELADO'
                 DISPLAY 'PROCESO CANCELADO' UPON CONSOLE
                 PERFORM ESTADISTICAS
                 PERFORM CERRAR-ARCHIVOS
                 GOBACK
           ELSE
              ADD 1                       TO GRABADOS-CAN.

       MOVER-DATOS-CAN.
      *---------------
           MOVE    SPACES                         TO  CAN-GLS-FLAG.
      *            COD. INT. COMP. OPERACION CREDITO
      *                CENTRO ASIGNACION IDENTIFICACION

           MOVE    'E'                            TO  CAN-COD-TOPC.
           MOVE    OPC-COD-COPC                   TO  CAN-COD-COPC.

      *                IDENT. INTERNA COMPUTACIONAL

           MOVE    OPC-COD-OOPC                   TO  CAN-COD-OOPC.
           MOVE    OPC-GLS-NOPC                   TO  CAN-GLS-NOPC.

      *            NUMERO IDENTIFICACION CANCELACION

           MOVE    999                            TO  CAN-NUM-ICAN

      *        TIME STAMP TRANSACCION

      *            FECHA TRANSACCION

      *****MOVE   19                              TO  CAN-NUM-STRN
           MOVE   ANO-T                           TO  CAN-NUM-ATRN
           MOVE   MES-T                           TO  CAN-NUM-MTRN
           MOVE   DIA-T                           TO  CAN-NUM-DTRN
           IF ANO-T < ROLL-YY
              MOVE 20                             TO  CAN-NUM-STRN
           ELSE
              MOVE 19                             TO  CAN-NUM-STRN
           END-IF

      *            HORA TRANSACCION

           ACCEPT CAN-HRA-HRTR                    FROM TIME

      *REQ INDICADOR TIPO ACCION

           MOVE   'I'                             TO  CAN-MSC-TACC

      *    INDICADOR STATUS

           MOVE     SPACES                        TO  CAN-MSC-STAT

      *REQ CODIGO ORIGEN TRANSACCION

      *        INDICADOR TIPO ORIGEN

           MOVE     'C'                           TO  CAN-MSC-TTRN

      *        CODIGO TIPO ORIGEN

           MOVE        'DIA'                      TO  CAN-COD-TTRN

      *REQ AUTOR TRANSACCION

           MOVE    'CARGA BATCH'                  TO  CAN-COD-ATRN


      *REQ OFICINA CANCELACION                          TAB OFI

           MOVE OPC-COD-COPC                      TO  CAN-COD-OFCA.

      *    CODIGO RESPONSABLE CANCELACION               TAB USR

           MOVE     SPACES                        TO  CAN-COD-RCAN.

      *REQ CODIGO CANCELACION                           COL CANC

      *        TIPO CANCELACION                         COL TCAN

           MOVE     'C'                           TO  CAN-MSC-TCAN.

      *        FORMA CANCELACION                        COL FCAN
      *        ENTIDAD CANCELACION                      COL ECAN

           MOVE   'T'                        TO  CAN-MSC-FCAN
                                                 CAN-MSC-ECAN


      *REQ FECHA CANCELACION REAL
      *REQ FECHA CANCELACION CONTABLE
      *REQ FECHA CANCELACION COMPUTACIONAL


      *****MOVE  19                               TO  CAN-NUM-SCAN
      *****                                           CAN-NUM-SEGR
      *****                                           CAN-NUM-SOUT.
           IF ANO-T < ROLL-YY
              MOVE 20                             TO  CAN-NUM-SCAN
                                                      CAN-NUM-SEGR
                                                      CAN-NUM-SOUT
           ELSE
              MOVE 19                             TO  CAN-NUM-SCAN
                                                      CAN-NUM-SEGR
                                                      CAN-NUM-SOUT
           END-IF.
           MOVE  ANO-T                            TO  CAN-NUM-ACAN
                                                      CAN-NUM-AEGR
                                                      CAN-NUM-AOUT.
           MOVE  MES-T                            TO  CAN-NUM-MCAN
                                                      CAN-NUM-MEGR
                                                      CAN-NUM-MOUT.
           MOVE  DIA-T                            TO  CAN-NUM-DCAN
                                                      CAN-NUM-DEGR
                                                      CAN-NUM-DOUT.

      *    VALOR GASTOS

           MOVE   ZERO                            TO  CAN-SGV-GAST.

      *    VALOR TOTAL PAGADO

           MOVE  OPC-VAL-SCRE                     TO  CAN-SGV-TPAG.

      *    VALOR TOTAL RENOVADO

           MOVE   ZERO                            TO  CAN-SGV-TREN.
           MOVE   001                             TO  CAN-NUM-TVCC.
           MOVE   ZEROES                          TO  CAN-SGV-DIFE.

      *    GLOSA DISPONIBLE

           MOVE   SPACES                          TO  CAN-GLS-DISP.

       RTN-IMPRESION.
      *---------------
             IF CL > 60
                PERFORM ENCABEZADO.
             PERFORM DETALLE.
       ENCABEZADO.
      *------------
              ADD 1   TO CP.
              MOVE CP TO PAG-T1
              WRITE LINEA FROM TIT-1 AFTER CANAL-1
              WRITE LINEA FROM TIT-2 AFTER 1
              WRITE LINEA FROM RAYA  AFTER 2
              WRITE LINEA FROM TIT-3 AFTER 2
              WRITE LINEA FROM TIT-4 AFTER 2
              WRITE LINEA FROM RAYA  AFTER 1
              MOVE 10 TO CL.
       DETALLE.
      *---------
           MOVE LLAVE-1A        TO CLAVE-S
           MOVE LLAVE-2A        TO SUC-S
           MOVE RUT-DD-B        TO RUTDDSE-S
           MOVE DV-DD-B         TO DVDDSE-S
           MOVE RUT-DD          TO RUTDDBD-S
           MOVE DV-DD           TO DVDDBD-S

           MOVE CIN-FECHA-ACTIV-AA TO ANOC-S
           MOVE CIN-FECHA-ACTIV-MM TO MESC-S
           MOVE CIN-FECHA-ACTIV-DD TO DIAC-S
           MOVE OPC-KEY-IOPC    TO VEN-CIC-IOPC
           MOVE 001             TO VEN-NUM-IVEN
           MOVE VEN-KEY-IVEN    TO VEN-VALUE
           MOVE 'REDKY'              TO VEN-COMMAND
           MOVE 'VEN00'              TO VEN-KEY
           CALL 'DBNTRY' USING UIB REQ-AREA-VEN VEN ELEM-LIST-VEN.
           IF VEN-RET-COD NOT = SPACES
              THEN
                  DISPLAY '------------------------'
                  DISPLAY 'NO ACCESO VEN, COD.RET :' VEN-RET-COD
                  DISPLAY '------------------------'
                  DISPLAY 'REQ. AREA :' REQ-AREA-VEN
                  MOVE 0 TO ANOV-S
                  MOVE 0 TO MESV-S
                  MOVE 0 TO DIAV-S
              ELSE
               MOVE VEN-NUM-AVEN TO ANOV-S
               MOVE VEN-NUM-MVEN TO MESV-S
               MOVE VEN-NUM-DVEN TO DIAV-S.
           MOVE OPC-MSC-TACC     TO INDT-S
           MOVE OPC-MSC-STAT     TO INDS-S
           MOVE OPC-VAL-CRED     TO MONTO-S
           MOVE OPC-VAL-SCRE     TO SALDOB-S
           MOVE CIN-SALDO-DEUDOR TO SALDOM-S.
           WRITE LINEA FROM DETA-1    AFTER 1
      *    WRITE LINEA FROM DETA-2A   AFTER 1
           ADD 2 TO CL.
       ESTADISTICAS.
      *---------------
           DISPLAY 'PAREADOR VISA'
           DISPLAY 'LEIDOS MAESTRO:' LEIDOS
           DISPLAY 'LEIDOS BD     :' LEIDOS-BD
           DISPLAY 'CLAVES IGUALES:' IGUALES
           DISPLAY 'SALDOS IGUALES:' VAL-IGUALES
           DISPLAY 'SALDOS DISTINTOS:' VAL-DISTINTOS
           DISPLAY '                 '
           DISPLAY 'RUT DD IGUALES  :' CONT-DD-IGUALES
           DISPLAY 'RUT DD DISTINTOS:' CONT-DD-DISTINTOS
           DISPLAY '                 '
           DISPLAY 'MARCADOS OPC    :' MARCADOS-OPC
           DISPLAY 'MARCADOS DLC    :' MARCADOS-DLC
           DISPLAY 'MARCADOS RDC    :' MARCADOS-RDC
           DISPLAY 'MARCADOS RDC (I):' MARCADOS-RDC9
           DISPLAY 'MARCADOS VEN    :' MARCADOS-VEN
           DISPLAY 'MARCADOS ICG    :' MARCADOS-ICG
           DISPLAY '                 '
           DISPLAY 'REPETIDOS OPC   :' REPETIDOS-OPC
           DISPLAY 'REPETIDOS DLC   :' REPETIDOS-DLC
           DISPLAY 'REPETIDOS RDC   :' REPETIDOS-RDC
           DISPLAY 'REPETIDOS RDC (I):' REPETIDOS-RDC9
           DISPLAY 'REPETIDOS VEN   :' REPETIDOS-VEN
           DISPLAY 'REPETIDOS ICG   :' REPETIDOS-ICG
           DISPLAY '                 '
           DISPLAY 'GRABADOS CAN    :' GRABADOS-CAN
           DISPLAY 'REPETIDOS CAN   :' REPETIDOS-CAN.
           DISPLAY '                 '
           DISPLAY 'ACT. "E" OPC    :' ACTUALIZA-OPC.
       FIN-PROGRAMA.

