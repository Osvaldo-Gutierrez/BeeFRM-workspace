       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID. DEUPAFIA.
       AUTHOR.     CONSIST.
      * ACTUALIZA ARCHIVO DEUAMF EN FORMA INTERACTIVA.
       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============
       WORKING-STORAGE SECTION.
      *------------------------
       COPY DEUBRAMF.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AMF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSG.
       COPY GNSBRMSC.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
       COPY GNSWGFRM.
       COPY GNSWGSCR.
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-DBC-REQA==.
           02 SCR-KEY-IDBC                     PIC X(03).
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-FIA-REQA==.
           02 SCR-KEY-IFIA                     PIC X(03).
      *>>>>
      *<<<< FIN_SCR_VARI
           02 SCR-MSC-STAT                         PIC X(01).
      *>>>>
       COPY DEUWIFIA.
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGSYS.
      *<<<< WSS
       COPY DEUBRESC.
       COPY DEUBRFIA.
       COPY SGCBRDBC.
       COPY GNSWGIDC.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSBRTAB.
       COPY GNSWGCPT.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY TABBRTIO.
       01  WSS-VARI.
           03 WSS-COD-TUSR                          PIC X(05).
           03 WSS-KEY-IFIA.
              05 WSS-CIC-IESC.
                 07 WSS-CAI-IESC                    PIC X(04).
                 07 WSS-IIC-IESC                    PIC X(08).
              05 WSS-NUM-IFIA                       PIC 9(02).
           03 WSS-COD-TOAX.
              05 WSS-COD-TOOA                       PIC X(03).
              05 WSS-COD-AOOA                       PIC X(03).
           03 WSS-CIC-ICLI                          PIC X(12).
           03 WSS-IFIA                      VALUE 0 PIC 9(01).
              88 EXISTE-FIANZA              VALUE 1.
           03 WSS-IESC                      VALUE 0 PIC 9(01).
              88 EXISTE-ESCRITURA           VALUE 1.
           03 WSS-IAMF                      VALUE 0 PIC 9(01).
              88 EXISTE-AMBITO              VALUE 1.
           03 WSS-IKEY                      VALUE 0 PIC 9(01).
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ESC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-FIA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
      *>>>>
       01  PGM-VARI.
           03 PGM-ICKY                 VALUE 0 PIC 9(01).
              88 PGM-LIMPIAR-LLAVES    VALUE 0.
              88 PGM-NO-LIMPIAR-LLAVES VALUE 1.
           03 PGM-STAT.
              05 PGM-STAT-FIA           VALUE '23'      PIC X(02).
                 88 PGM-STAT-FIA-OKS    VALUE '00'.
                 88 PGM-STAT-FIA-NUL    VALUE '  '.
              05 PGM-STAT-ESC           VALUE '23'      PIC X(02).
                 88 PGM-STAT-ESC-OKS    VALUE '00'.
                 88 PGM-STAT-ESC-NUL    VALUE '  '.
              05 PGM-STAT-AMF           VALUE '23'      PIC X(02).
                 88 PGM-STAT-AMF-OKS    VALUE '00'.
                 88 PGM-STAT-AMF-NUL    VALUE '  '.
       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
      *<<<< CMA
           02 FILLER                      PIC X(2016).
      *>>>>
       COPY GNSLGFIO.
       PROCEDURE DIVISION.
      *===================
       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
                 PERFORM SCR-PGM.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.
       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
       COPY GNSBGCMA.
           MOVE 'DEUPAFIA' TO FIO-PROG.
      *<<<< INI_FIO
           MOVE +2016 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               PERFORM GNS-CLR-RQA.
      *>>>>
       FIN-INI.
           EXIT.
       SCR-COM SECTION.
       INI-SCR-COM.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-FIA.
           PERFORM EDT-KEY-FIA.
           PERFORM EDT-FLD-FIA.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO FRM-PROG.
           MOVE SCR-VARI     TO FRM-CMMA.
           MOVE SCR-TCMA     TO FRM-TCMA.
           MOVE FRM-XCT      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-CLR-FRM  TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE FRM-MSG      TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.
       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               IF PGM-LIMPIAR-LLAVES
                   PERFORM SCR-CLRA-FIA
                   PERFORM EDT-KEY-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM CLR-FLD-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_MOD
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-FIA
               PERFORM VAL-NUM-FLD-FIA.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           PERFORM GNS-CLR-RQA.
      *>>>>
       MSG-SCR-MOD.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'MODNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-MOD
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'MODYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.
       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-IKY
               IF PGM-LIMPIAR-LLAVES
                   PERFORM SCR-CLRA-FIA
                   PERFORM EDT-KEY-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM CLR-FLD-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-FIA
                            MOVE 0 TO PGM-ICKY
                            PERFORM SCR-TRL
                        ELSE
                        MOVE 1 TO PGM-ICKY
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'INGNOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ING
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'INGYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.
       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               IF PGM-LIMPIAR-LLAVES
                   PERFORM SCR-CLRA-FIA
                   PERFORM EDT-KEY-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM CLR-FLD-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-FIA
               PERFORM VAL-NUM-FLD-FIA
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-ACC.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.
       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               IF PGM-LIMPIAR-LLAVES
                   PERFORM SCR-CLRA-FIA
                   PERFORM EDT-KEY-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM CLR-FLD-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-FIA
               PERFORM VAL-NUM-FLD-FIA
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           PERFORM GNS-CLR-RQA.
      *>>>>
           IF SCR-STAT = SCR-STAT-CON
               MOVE SPACES TO FRM-MENS
           ELSE
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ELINOT    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
           ELSE
               MOVE SPACES TO FRM-MENS
               PERFORM CMN-ELI
               IF FIO-STAT-OKS
                   IF FRM-MENS NOT > SPACES
                       MOVE 'ELIYES    ' TO MSG-COD-MENS
                       MOVE 'GNS' TO MSG-COD-SIST
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                   ELSE
                       NEXT SENTENCE
               ELSE
               IF FRM-MENS NOT > SPACES
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.
       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               IF PGM-LIMPIAR-LLAVES
                   PERFORM SCR-CLRA-FIA
                   PERFORM EDT-KEY-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM CLR-FLD-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF FIO-STAT-OKS
                            MOVE SCR-ACTU-MOD TO SCR-ACTU
                            PERFORM PUT-SCR
                            MOVE 0 TO PGM-ICKY
                            PERFORM SCR-TRL
                        ELSE
                        MOVE 1 TO PGM-ICKY
                        IF FIO-STAT-EOF
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGEOF    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                        IF FIO-STAT = FIO-STAT-NEX
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGNEX    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                            MOVE SCR-ACTU-ING TO SCR-ACTU
      *JSS                  PERFORM CLR-FLD-FIA
                            MOVE 0 TO PGM-ICKY
                            PERFORM SCR-TRL
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACT
           ELSE
           IF SCR-INST = SCR-INST-GFL
                PERFORM GET-FLD
           ELSE
           IF SCR-INST = SCR-INST-GCS
                PERFORM GET-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACT
           IF ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                           FRM-FFLD-PF7 OR FRM-FFLD-PF8 ) AND
              SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-FIA
               PERFORM VAL-NUM-FLD-FIA.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACT.
           PERFORM GNS-CLR-RQA.
      *>>>>
           IF SCR-ACTU = SCR-ACTU-MOD
                  PERFORM MSG-SCR-MOD
           ELSE
                  PERFORM MSG-SCR-ING.
       FIN-SCR-ACT.
           EXIT.
       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM HBL-KEY
               IF PGM-LIMPIAR-LLAVES
                   PERFORM SCR-CLRA-FIA
                   PERFORM EDT-KEY-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM CLR-FLD-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-PGM.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
      *JSS IF NOT FIO-STAT-OKS
      *        PERFORM CLR-FLD-FIA.
           IF FIO-STAT = FIO-STAT-NEX
               IF FRM-MENS NOT > SPACES
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   PERFORM SCR-MSSG
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-PGM
               ELSE
                   PERFORM SCR-MSSG
                   MOVE SCR-STAT-ABT TO SCR-STAT
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           IF SCR-STAT NOT = SCR-STAT-CON
               PERFORM CMN-PGM.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.
       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE 0 TO PGM-ICKY
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-FIA.
       ERR-SCR-KEY.
           MOVE 1 TO PGM-ICKY.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
        FIN-SCR-KEY.
           EXIT.
       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO FIA-FLD.
       FIN-SCR-RST.
           EXIT.
       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.
       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.
       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY
           PERFORM KEY-ALL-FIA.
           IF SCR-CCPP NOT = 'ING'
               GO TO CON-FND-ACC.
           MOVE 'DEU' TO SCR-KEY-IDBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
           IF FIO-STAT-OKS
               MOVE 1 TO WSS-IESC
               PERFORM PUT-ESC-FIA
               IF FIA-NUM-IFIA IN FIA > ZEROES
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM DEU-FIO-FIA
                   MOVE FIO-STAT TO PGM-STAT-FIA
                   IF NOT FIO-STAT-OKS
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'FIAIFIANEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FIO-STAT-NEX TO FIO-STAT
                   ELSE
                       MOVE 'ESC' TO SCR-KEY-IFIA
                       MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                       MOVE 1 TO WSS-IFIA
                       PERFORM PUT-FIA-FIA
                       PERFORM BUS-COR-AMF
                       MOVE '23' TO FIO-STAT
               ELSE
                   PERFORM BUS-COR-FIA
                   MOVE 1 TO AMF-NUM-IAMF IN FIA-FLD
                   MOVE '23' TO FIO-STAT
           ELSE
               MOVE 1 TO FIA-NUM-IFIA IN FIA-FLD
               MOVE 1 TO AMF-NUM-IAMF IN FIA-FLD.
           GO TO FIN-FND-KEY.
       CON-FND-ACC.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               IF SCR-KEY-IDBC = 'ESC'
                   PERFORM NXT-PRV-ESC
                   IF FIO-STAT-OKS
                       PERFORM SCR-CLRA-FIA
                       MOVE 1 TO WSS-IESC
                       PERFORM BUS-COR-FIA
                       IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'FIAIFIANEX' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'ESC' TO SCR-KEY-IFIA
                           MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                           MOVE '00' TO PGM-STAT-FIA
                           MOVE 1 TO WSS-IFIA
                           MOVE '00' TO FIO-STAT
                           PERFORM BUS-COR-AMF
                           IF AMF-NUM-IAMF IN FIA-FLD >  ZEROES
                               MOVE 1 TO WSS-IAMF
                               MOVE '00' TO PGM-STAT-AMF
                               MOVE '00' TO FIO-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE '00' TO FIO-STAT
                               GO TO FIN-FND-KEY
                   ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'ESC    NOPRV' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'ESC    NONXT' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
               ELSE
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-FIA
                   IF SCR-KEY-IDBC = 'FIA'
                       MOVE DBC-CIC-ICLI IN DBC TO FIA-CIC-ICFS
                                                         IN FIA
                       PERFORM PUT-DBC-FIA
                       PERFORM BUS-FIA-SFI
                       IF NOT FIO-STAT-OKS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           MOVE SPACES TO SCR-FIA-REQA
                           MOVE SPACES TO SCR-KEY-IFIA
                           GO TO FIN-FND-KEY
                       ELSE
                           GO TO FIN-FND-KEY
                   ELSE
                       MOVE DBC-CIC-ICLI IN DBC TO FIA-CIC-ICLI
                                                         IN FIA
                       PERFORM PUT-DBC-DEU
                       PERFORM BUS-FIA-SDE
                       IF NOT FIO-STAT-OKS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           MOVE SPACES TO SCR-FIA-REQA
                           MOVE SPACES TO SCR-KEY-IFIA
                           GO TO FIN-FND-KEY
                       ELSE
                           GO TO FIN-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NOPRV' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NONXT' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV-ESC
               IF MSG-COD-MENS = 'FIASI'
                   MOVE 1 TO WSS-IFIA
                   PERFORM BUS-ESC
                   IF FIO-STAT-OKS
                       PERFORM SCR-CLRA-FIA
                       PERFORM BUS-COR-AMF
                       IF AMF-NUM-IAMF IN FIA-FLD >  ZEROES
                           MOVE 1 TO WSS-IAMF
                           MOVE '00' TO PGM-STAT-AMF
                           MOVE '00' TO FIO-STAT
                           GO TO FIN-FND-KEY
                        ELSE
                            MOVE '00' TO FIO-STAT
                            GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'CICIESCNEX' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF SCR-KEY-IFIA = 'FIA'
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICFSNOPRV' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICFSNONXT' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                   ELSE
                   IF SCR-KEY-IFIA = 'DEU'
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICLINOPRV' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICLINONXT' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                   ELSE
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICIESCNOPRV' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICIESCNONXT' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY.
           IF ESC-IIC-IESC IN FIA-FLD NOT > ZEROES
               PERFORM ANL-KEY-FIA
               IF NOT FIO-STAT-OKS
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   GO TO FIN-FND-KEY.
           PERFORM KEY-ALL-FIA.
           MOVE 'DEU' TO SCR-KEY-IDBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
           IF FIO-STAT-OKS
               MOVE 'ESC' TO SCR-KEY-IDBC
               MOVE 1 TO WSS-IESC
      *        PERFORM PUT-ESC-FIA
               IF FIA-NUM-IFIA IN FIA > ZEROES
                   MOVE ESC-CIC-IESC IN ESC TO FIA-CIC-IESC IN FIA
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM DEU-FIO-FIA
                   MOVE FIO-STAT TO PGM-STAT-FIA
                   IF NOT FIO-STAT-OKS
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'FIAIFIANEX' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 1 TO WSS-IFIA
                       MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                       MOVE 'ESC' TO SCR-KEY-IFIA
      *                PERFORM PUT-FIA-FIA
                       IF AMF-NUM-IAMF IN AMF > ZEROES
                           MOVE FIA-KEY-IFIA IN FIA TO
                                AMF-KEY-IFIA IN AMF
                           MOVE FIO-GET-KEY TO FIO-CMND
                           PERFORM DEU-FIO-AMF
                           MOVE FIO-STAT TO PGM-STAT-AMF
                           IF NOT FIO-STAT-OKS
                               MOVE 'DEU' TO MSG-COD-SIST
                               MOVE 'AMFIAMFNEX' TO MSG-COD-MENS
                               PERFORM SET-MSG
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE 1 TO WSS-IAMF
      *                        PERFORM PUT-AMF-FIA
                               MOVE '00' TO FIO-STAT
                       ELSE
                           PERFORM BUS-COR-AMF
                           IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                               MOVE 1 TO WSS-IAMF
                               MOVE '00' TO PGM-STAT-AMF
      *                        PERFORM PUT-AMF-FIA
                               MOVE '00' TO FIO-STAT
                           ELSE
                               PERFORM CLR-AMF
                               MOVE '00' TO FIO-STAT
               ELSE
                   PERFORM BUS-COR-FIA
                   IF FIA-NUM-IFIA IN FIA-FLD > ZEROES
                       MOVE '00' TO PGM-STAT-FIA
                       MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                       MOVE 'ESC' TO SCR-KEY-IFIA
                       MOVE 1 TO WSS-IFIA
      *                PERFORM PUT-FIA-FIA
                       IF AMF-NUM-IAMF IN AMF > ZEROES
                           MOVE FIA-KEY-IFIA IN FIA TO
                                AMF-KEY-IFIA IN AMF
                           MOVE FIO-GET-KEY TO FIO-CMND
                           PERFORM DEU-FIO-AMF
                           MOVE FIO-STAT TO PGM-STAT-AMF
                           IF NOT FIO-STAT-OKS
                               MOVE 'DEU' TO MSG-COD-SIST
                               MOVE 'AMFIAMFNEX' TO MSG-COD-MENS
                               PERFORM SET-MSG
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE 1 TO WSS-IAMF
      *                        PERFORM PUT-AMF-FIA
                               MOVE '00' TO FIO-STAT
                       ELSE
                           PERFORM BUS-COR-AMF
                           IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                               MOVE '00' TO PGM-STAT-AMF
                               MOVE 1 TO WSS-IAMF
      *                        PERFORM PUT-AMF-FIA
                               MOVE '00' TO FIO-STAT
                           ELSE
                               PERFORM CLR-AMF
                               MOVE '00' TO FIO-STAT
                   ELSE
                       PERFORM CLR-FIA
                       PERFORM CLR-AMF
                       MOVE '00' TO FIO-STAT
           ELSE
               NEXT SENTENCE.
           GO TO FIN-FND-KEY.
      *>>>>
           PERFORM KEY-ALL-FIA.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
           MOVE FIO-STAT TO PGM-STAT-AMF.
       FIN-FND-KEY.
           EXIT.
       PUT-SCR SECTION.
       INI-PUT-SCR.
           PERFORM PUT-ALL-FIA.
       FIN-PUT-SCR.
           EXIT.
       GET-FLD SECTION.
       INI-GET-FLD.
           PERFORM SCR-GFLD.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-FLD.
           EXIT.
       CMN-MOD SECTION.
       INI-CMN-MOD.
      *<<<< INI_CMN_MOD
           PERFORM RET-ALL-FIA.
           PERFORM MOD-ESC-FIA.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-AMF-FIA.
           IF AMF-NUM-IAMF IN AMF = ZEROES
               GO TO FIN-CMN-MOD.
           PERFORM KEY-ALL-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
           IF NOT FIO-STAT-OKS
               PERFORM RET-AMF-FIA
               MOVE HOY-STP-ITRN TO AMF-STP-ITRN IN AMF
               MOVE FIO-PUT TO FIO-CMND
               PERFORM DEU-FIO-AMF
               GO TO FIN-CMN-MOD.
           PERFORM RET-ALL-FIA.
           MOVE HOY-STP-ITRN TO AMF-STP-ITRN IN AMF.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
           GO TO FIN-CMN-MOD.
      *>>>>
           PERFORM KEY-ALL-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-MOD.
           PERFORM RET-ALL-FIA.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
       FIN-CMN-MOD.
           EXIT.
       CMN-ING SECTION.
       INI-CMN-ING.
      *<<<< INI_CMN_ING
           PERFORM RET-ALL-FIA.
           PERFORM MOD-ESC-FIA.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ING.
      *>>>>
           PERFORM RET-ALL-FIA.
      *<<<< CMN_ING
           IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES OR
              AMF-NUM-IAMF IN FIA-FLD NOT > ZEROES OR
              ( AMF-MSC-TVOA IN FIA-FLD NOT > SPACES AND
                AMF-COD-TOOA IN FIA-FLD NOT > SPACES AND
                AMF-COD-OFOA IN FIA-FLD NOT > SPACES AND
                AMF-CAI-IOCA IN FIA-FLD NOT > SPACES AND
                AMF-IIC-IOCA IN FIA-FLD NOT > ZEROES AND
                AMF-COD-VCOA IN FIA-FLD NOT > SPACES AND
                AMF-COD-AOOA IN FIA-FLD NOT > SPACES AND
                AMF-COD-CDOA IN FIA-FLD NOT > SPACES AND
                AMF-VAL-LIMA IN FIA-FLD NOT > ZEROES AND
                AMF-COD-VCLA IN FIA-FLD NOT > SPACES AND
                AMF-IND-TDEU IN FIA-FLD NOT > SPACES )
               GO TO FIN-CMN-ING.
           MOVE HOY-STP-ITRN TO AMF-STP-ITRN IN AMF.
      *>>>>
           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
       FIN-CMN-ING.
           EXIT.
       CMN-ACC SECTION.
       INI-CMN-ACC.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-VFLD = SCR-VFLD-NOT
               MOVE 'ACCION NO REALIZADA' TO FRM-MENS
      *<<<< ABT_CMN_ACC
               IF SCR-CMND = 'VRF'
                   MOVE 'DEU' TO MSG-COD-SIST
                   MOVE 'FIASTATNOMOD' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   GO TO FIN-CMN-ACC
               ELSE
      *>>>>
               GO TO FIN-CMN-ACC.
      *<<<< INI_CMN_ACC
           IF SCR-CMND NOT = 'VRF'
               GO TO FIN-CMN-ACC.
           PERFORM KEY-FIA-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM RET-FIA-FIA.
           PERFORM GET-FHOY.
           MOVE HOY-STP-ITRN TO FIA-STP-ITRN IN FIA.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM KEY-ESC-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ESC-FIA.
           MOVE HOY-STP-ITRN TO ESC-STP-ITRN IN ESC.
           MOVE FIA-MSC-STAT IN FIA-FLD TO ESC-MSC-STAT IN ESC.
           MOVE FIO-MOD TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-CMN-ACC.
           MOVE 'DEU' TO MSG-COD-SIST.
           MOVE 'FIASTATMOD' TO MSG-COD-MENS.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           GO TO FIN-CMN-ACC.
      *>>>>
           PERFORM KEY-ALL-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ACC.
           PERFORM RET-ALL-FIA.
       FIN-CMN-ACC.
           EXIT.
       CMN-ELI SECTION.
       INI-CMN-ELI.
           IF AMF-NUM-IAMF IN FIA-FLD NOT > ZEROES
               IF FIA-NUM-IFIA IN FIA-FLD > ZEROES
                   PERFORM KEY-ALL-FIA
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND
                   PERFORM DEU-FIO-FIA
                   IF NOT FIO-STAT-OKS
                       MOVE FIO-MENS TO FRM-MENS
                       GO TO FIN-CMN-ELI
                   ELSE
                       MOVE FIO-DEL TO FIO-CMND
                       PERFORM DEU-FIO-FIA
                       GO TO FIN-CMN-ELI
               ELSE
                   PERFORM KEY-ESC-FIA
                   MOVE FIO-GET-KEY-UPD TO FIO-CMND
                   PERFORM DEU-FIO-ESC
                   IF NOT FIO-STAT-OKS
                       MOVE FIO-MENS TO FRM-MENS
                       GO TO FIN-CMN-ELI
                   ELSE
                       MOVE FIO-DEL TO FIO-CMND
                       PERFORM DEU-FIO-ESC
                       GO TO FIN-CMN-ELI.
      *>>>>
           PERFORM KEY-ALL-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
           IF NOT FIO-STAT-OKS
               GO TO FIN-CMN-ELI.
           MOVE FIO-DEL TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
       FIN-CMN-ELI.
           EXIT.
       CMN-PGM SECTION.
       INI-CMN-PGM.
           PERFORM RET-ALL-FIA.
       FIN-CMN-PGM.
           EXIT.
       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO FRM-NTRN.
           MOVE SCR-VARI TO FRM-CMMA.
           MOVE SCR-TCMA TO FRM-TCMA.
           MOVE FRM-EXT  TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-EXIT.
           EXIT.
       SCR-PUTA SECTION.
       INI-SCR-PUTA.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FIA-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.
       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO FIA-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.
       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-FIA
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO FIA-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-FIA
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-CON-KEY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM FST-KEY-FIA
               GO TO ERR-SCR-GKEY.
      *JSS
           PERFORM CLR-FLD-FIA.
           PERFORM VAL-IKY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-FIA.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
       ERR-SCR-GKEY.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-FIA.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.
       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-FIA
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO FIA-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-IKY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-FIA
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-CON-IKY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM FST-KEY-FIA
               GO TO ERR-SCR-GIKY.
      *JSS
           PERFORM CLR-FLD-FIA.
           PERFORM VAL-IKY-FIA.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
       ERR-SCR-GIKY.
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-FIA.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.
       SCR-GFLD SECTION.
       INI-SCR-GFLD.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GFLD
           IF NOT ( ( SCR-CCPP = 'MOD' OR  SCR-CCPP = 'ACC' OR
                      SCR-CCPP = 'ELI'                      OR
                    ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-MOD ) )
                      AND ( FRM-FFLD = FRM-FFLD-PF8 OR
                            FRM-FFLD = FRM-FFLD-PF7 OR
                            FRM-FFLD = FRM-FFLD-PF5 OR
                            FRM-FFLD = FRM-FFLD-PF6 ) )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-FLD-FIA
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO FIA-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GFLD.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-FIA
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-NUM-FLD-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-FIA
               PERFORM EDT-FLD-FIA
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           PERFORM VAL-MKY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-FLD-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GFLD.
           PERFORM VAL-CON-FLD-FIA.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GFLD.
           PERFORM FST-FLD-FIA.
       ERR-SCR-GFLD.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-FIA.
           PERFORM EDT-FLD-FIA.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GFLD.
           MOVE SCR-STAT-MOD TO SCR-STAT.
       GET-ACC SECTION.
       INI-GET-ACC.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD = FRM-FFLD-PF6 OR
                FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD = FRM-FFLD-PF8 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO FIA-GLS-MEN2
               MOVE SCR-GLS-PRMT( SCR-I ) TO FIA-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO FIA-FLD.
           IF NOT ( ( FRM-FFLD = FRM-FFLD-PF12 OR FRM-FFLD-PF3 ) OR
                      SCR-GLS-CONF( SCR-I ) > SPACES )
               PERFORM VAL-NUM-KEY-FIA
               PERFORM VAL-NUM-FLD-FIA.
       FIN-GET-ACC.
           MOVE SCR-STAT-SON TO SCR-STAT.
       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD = FRM-FFLD-PF6 OR
                FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD = FRM-FFLD-PF8 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO FIA-GLS-MEN2
               MOVE SCR-GLS-PRMT( SCR-I ) TO FIA-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO FIA-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO FIA-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.
       HBL-IKY SECTION.
       INI-HBL-IKY.
           IF SCR-DESDE-CMN
               MOVE FIA-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO FIA-FLD
               MOVE FRM-MENS TO FIA-GLS-MENS.
           PERFORM PRO-FLD-FIA.
           PERFORM PRO-MKY-FIA.
           PERFORM PRO-AKY-FIA.
           PERFORM UNP-IKY-FIA.
           PERFORM FST-KEY-FIA.
       FIN-HBL-IKY.
           EXIT.
       HBL-KEY SECTION.
       INI-HBL-KEY.
           IF SCR-DESDE-CMN
               MOVE FIA-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO FIA-FLD
               MOVE FRM-MENS TO FIA-GLS-MENS.
           PERFORM PRO-FLD-FIA.
           PERFORM UNP-KEY-FIA.
           PERFORM FST-KEY-FIA.
       FIN-HBL-KEY.
           EXIT.
       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-FIA.
           PERFORM PRO-AKY-FIA.
           PERFORM UNP-MKY-FIA.
           PERFORM UNP-FLD-FIA.
           PERFORM FST-FLD-FIA.
      *<<<< FIN_HBL_FLD
           IF NOT ( SCR-MSC-STAT = 'N' OR SCR-MSC-STAT NOT > SPACES )
               PERFORM PRO-ESC-FIA.
           IF SCR-CMND = 'VRF'
               PERFORM PRO-MKY-FIA
               PERFORM PRO-FLD-FIA
               MOVE  0 TO FIA-COD-TOFS-LEN IN FIA-FLD
               MOVE -1 TO FIA-MSC-STAT-LEN IN FIA-FLD
               MOVE FRM-CPIM-UBY TO FIA-MSC-STAT-ATR IN FIA-FLD
               GO TO FIN-HBL-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO FIA-MSC-STAT-ATR IN FIA-FLD
               MOVE 'N' TO FIA-MSC-STAT IN FIA-FLD.
           IF FIA-NUM-IFIA-ALF IN FIA-FLD NOT > SPACES OR
              FIA-NUM-IFIA-ALF IN FIA-FLD = ZEROES
               PERFORM PRO-FIA-FIA
               PERFORM PRO-MKY-FIA
               MOVE  0 TO FIA-COD-TOFS-LEN IN FIA-FLD
               MOVE -1 TO ESC-COD-OFEF-LEN IN FIA-FLD.
           IF AMF-NUM-IAMF-ALF IN FIA-FLD NOT > SPACES OR
              AMF-NUM-IAMF-ALF IN FIA-FLD = ZEROES
               PERFORM PRO-AMF-FIA.
      *>>>>
       FIN-HBL-FLD.
           EXIT.
       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO FIA-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.
       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-FIA.
           PERFORM PRO-FLD-FIA.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.
       SCR-TRL SECTION.
       INI-SCR-TRL.
      *<<<< INI_SCR_TRL
           MOVE SPACES TO MSG-COD-MENS.
           IF FRM-FFLD = FRM-FFLD-PF12
               GO TO CON-SCR-TRL.
           IF NOT EXISTE-ESCRITURA
               GO TO CON-SCR-TRL.
           IF NOT ( ESC-MSC-STAT IN ESC = 'N' OR
                    ESC-MSC-STAT IN ESC NOT > SPACES )
               MOVE ESC-MSC-STAT IN ESC TO SCR-MSC-STAT
               IF ( SCR-CCPP = 'ING' OR 'ELI' OR 'ACC' ) AND
                    SCR-CMND NOT = 'VRF'
                   MOVE 'ESCSTATSI' TO MSG-COD-MENS.
      *ALD
      *            IF EXISTE-FIANZA
      *                MOVE ADR-FIA-REQA TO SCR-FIA-REQA
      *                GO TO MSG-SCR-TRL
      *            ELSE
      *                GO TO MSG-SCR-TRL.
           IF EXISTE-FIANZA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               IF FIA-FEC-FALZ > ZEROES
                   MOVE 'FIA    ALZ' TO MSG-COD-MENS
               ELSE
               IF FIA-FEC-FAUT > ZEROES
               MOVE 'FIA    AUT' TO MSG-COD-MENS
               ELSE
               IF FIA-FEC-FSOL > ZEROES
                   MOVE 'FIA    SOL' TO MSG-COD-MENS
               ELSE
               IF NOT ( FIA-MSC-STAT IN FIA = 'N' OR
                        FIA-MSC-STAT IN FIA NOT > SPACES )
                   MOVE 'FIASTATSI' TO MSG-COD-MENS
               ELSE
                   NEXT SENTENCE
           ELSE
               IF SCR-CMND = 'VRF'
                   MOVE 'FIAIFIANEX' TO MSG-COD-MENS.
       MSG-SCR-TRL.
           IF MSG-COD-MENS > SPACES
               MOVE 'DEU' TO MSG-COD-SIST
               PERFORM GET-MSG
               IF SCR-STAT = SCR-STAT-CON
                   MOVE MSG-GLS-DESC TO FRM-MEN2
               ELSE
                   MOVE SCR-STAT-CON TO SCR-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS.
       CON-SCR-TRL.
      *>>>>
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-GLS-PRMT( SCR-I ) TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               IF FRM-FFLD NOT = FRM-FFLD-PF12
                   PERFORM EDT-KEY-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               IF FRM-FFLD NOT = FRM-FFLD-PF12
                   PERFORM EDT-KEY-FIA
                   PERFORM EDT-FLD-FIA
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT
               ELSE
                   PERFORM SCR-PUTA
                   PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           IF FRM-FFLD NOT = FRM-FFLD-PF12
               PERFORM EDT-KEY-FIA
               PERFORM EDT-FLD-FIA
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT
           ELSE
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.
       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           IF SCR-INST = SCR-INST-GCF
                  PERFORM SCR-GCNF
                  GO TO FIN-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF SCR-STAT = SCR-STAT-ABT OR SCR-STAT-CON
                  GO TO FIN-DESSCRTRL.
           IF SCR-FFLD-RET OR SCR-FFLD-PF10
                  MOVE SCR-VFLD-YES TO SCR-VFLD
                  PERFORM PRO-CONF.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.
       PRO-CONF SECTION.
       INI-PRO-CONF.
           IF FRM-MENS NOT > SPACES
               IF SCR-GLS-CONF( SCR-I ) NOT > SPACES
                   GO TO FIN-PRO-CONF
               ELSE
                   MOVE SCR-GLS-CONF( SCR-I ) TO FRM-MENS
           ELSE
               IF FRM-MEN1 NOT > SPACES
                   MOVE SCR-GLS-CONF( SCR-I ) TO FRM-MEN1.
           MOVE SCR-INST-GCF TO SCR-INST.
           PERFORM SCR-MSSG.
           PERFORM PRO-KEY-FIA.
           PERFORM PRO-FLD-FIA.
           PERFORM FST-MSG.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM EDT-KEY-FIA
               PERFORM EDT-FLD-FIA.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-PRO-CONF.
           EXIT.
       SCR-GCNF SECTION.
       INI-SCR-GCNF.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3  OR
                               FRM-FFLD-PF4 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC          TO FIA-GLS-MEN2
               MOVE SCR-GLS-CONF( SCR-I ) TO FIA-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO FIA-FLD.
           MOVE FRM-FFLD TO SCR-FFLD.
           IF FRM-FFLD = FRM-FFLD-PF3
               MOVE SCR-VFLD-NOT TO SCR-VFLD
           ELSE
           IF FRM-FFLD = FRM-FFLD-RET OR FRM-FFLD-PF10 OR FRM-FFLD-PF4
               MOVE SCR-VFLD-YES TO SCR-VFLD
               PERFORM VAL-NUM-KEY-FIA
               PERFORM VAL-NUM-FLD-FIA
           ELSE
           IF FRM-FFLD = FRM-FFLD-PF12
               MOVE SCR-STPP TO SCR-STAT
               IF SCR-STAT = SCR-STAT-MOD
                   PERFORM SCR-TRL
               ELSE
                   MOVE SCR-VFLD-NOT TO SCR-VFLD.
       FIN-SCR-GCNF.
           EXIT.
       COPY DEUBMFIA.
       COPY DEUBFAMF.
       COPY GNSBFMSC.
       COPY GNSBFMSG.
       COPY GNSBECIC.
       COPY GNSBGSYS.
       COPY GNSBGVSM.
       COPY GNSBGDTC.
       COPY GNSBGFRM.
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.
       GNS-CLR-RQA SECTION.
       INI-GNS-CLR-RQA.
           MOVE SPACES TO SCR-DBC-REQA.
           MOVE SPACES TO SCR-KEY-IDBC.
           MOVE SPACES TO SCR-FIA-REQA.
           MOVE SPACES TO SCR-KEY-IFIA.
       FIN-GNS-CLR-RQA.
           EXIT.
      *>>>>
      *<<<< EOF
       ANL-KEY-FIA SECTION.
       INI-ANL-KEY-FIA.
      * Si existe rut de Deudor y rut de Fiador
           IF FRM-NUM-ICLI IN FIA-FLD > ZEROES AND
              FRM-NUM-ICFS IN FIA-FLD > ZEROES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-IDC-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-IDC-CIC-FIA
                   IF FIO-STAT-OKS
                       PERFORM BUS-FIA-ADF
                   ELSE
                       NEXT SENTENCE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe rut de Deudor
           IF FRM-NUM-ICLI IN FIA-FLD > ZEROES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-IDC-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SDE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe rut de Fiador
           IF FRM-NUM-ICFS IN FIA-FLD > ZEROES
               MOVE 'FIA' TO SCR-KEY-IFIA
               MOVE 'FIA' TO SCR-KEY-IDBC
               PERFORM BUS-IDC-CIC-FIA
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SFI
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe nombre de Deudor y nombre de Fiador
           IF FRM-GLS-NOMC IN FIA-FLD > SPACES AND
              FRM-GLS-NOMF IN FIA-FLD > SPACES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-NMB-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-NMB-CIC-FIA
                   IF FIO-STAT-OKS
                       PERFORM BUS-FIA-ADF
                   ELSE
                       NEXT SENTENCE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe nombre de Deudor
           IF FRM-GLS-NOMC IN FIA-FLD     > SPACES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-NMB-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SDE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe nombre de Fiador
           IF FRM-GLS-NOMF IN FIA-FLD     > SPACES
               MOVE 'FIA' TO SCR-KEY-IFIA
               MOVE 'FIA' TO SCR-KEY-IDBC
               PERFORM BUS-NMB-CIC-FIA
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SFI.
       FIN-ANL-KEY-FIA.
           EXIT.
       BUS-FIA-SDE SECTION.
       INI-BUS-FIA-SDE.
           MOVE 1 TO WSS-IKEY.
           MOVE FIA-CIC-ICLI IN FIA TO WSS-CIC-ICLI.
           MOVE LOW-VALUES          TO FIA-CIC-ICFS IN FIA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'FIA-GLS-ICYF'  TO FIO-AKEY.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND
              WSS-CIC-ICLI = FIA-CIC-ICLI IN FIA
               MOVE 1 TO WSS-IFIA
               MOVE '00' TO PGM-STAT-FIA
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               PERFORM BUS-ESC
               IF FIO-STAT-OKS
                   PERFORM BUS-COR-AMF
                   IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                       MOVE 1 TO WSS-IAMF
                       MOVE '00' TO PGM-STAT-AMF
      *                PERFORM PUT-AMF-FIA
                       MOVE '00' TO FIO-STAT
                   ELSE
                       PERFORM CLR-AMF
                       MOVE '00' TO FIO-STAT
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICICLINODEU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-FIA-SDE.
           EXIT.
       BUS-FIA-SFI SECTION.
       INI-BUS-FIA-SFI.
           MOVE 2 TO WSS-IKEY.
           MOVE FIO-GET-KEY TO FIO-CMND
           MOVE 'FIA-CIC-ICFS'  TO FIO-AKEY
           PERFORM DEU-FIO-FIA
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-FIA
               MOVE 'FIA' TO SCR-KEY-IFIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 1 TO WSS-IFIA
               PERFORM BUS-ESC
               IF FIO-STAT-OKS
                   PERFORM BUS-COR-AMF
                   IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                       MOVE 1 TO WSS-IAMF
                       MOVE '00' TO PGM-STAT-AMF
      *                PERFORM PUT-AMF-FIA
                       MOVE '00' TO FIO-STAT
                   ELSE
                       PERFORM CLR-AMF
                       MOVE '00' TO FIO-STAT
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICICFSNOFIA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-FIA-SFI.
           EXIT.
       BUS-FIA-ADF SECTION.
       INI-BUS-FIA-ADF.
           MOVE 3 TO WSS-IKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'FIA-GLS-ICYF'  TO FIO-AKEY.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-FIA
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 1 TO WSS-IFIA
               PERFORM BUS-ESC
               IF FIO-STAT-OKS
                   PERFORM BUS-COR-AMF
                   IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                       MOVE 1 TO WSS-IAMF
                       MOVE '00' TO PGM-STAT-AMF
      *                PERFORM PUT-AMF-FIA
                       MOVE '00' TO FIO-STAT
                   ELSE
                       PERFORM CLR-AMF
                       MOVE '00' TO FIO-STAT
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'GLSICYFNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-FIA-ADF.
           EXIT.
       BUS-ESC SECTION.
       INI-BUS-ESC.
           MOVE FIA-CIC-IESC IN FIA TO ESC-CIC-IESC IN ESC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
           IF FIO-STAT-OKS
               MOVE 1 TO WSS-IESC
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICIESCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-ESC.
           EXIT.
       BUS-NMB-CIC-DEU SECTION.
       INI-BUS-NMB-CIC-DEU.
      *NOM-CLI Busca Cliente por medio del Nombre
      *ALD
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.
           UNSTRING FRM-GLS-NOMC IN FIA-FLD DELIMITED BY '/' INTO
                                   DBC-GLS-APAT IN DBC
                                   DBC-GLS-AMAT IN DBC
                                   DBC-GLS-NOMB IN DBC.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO FRM-NUM-ICLI IN FIA-FLD
               MOVE SPACES TO FRM-VRF-ICLI IN FIA-FLD
               MOVE SPACES TO FRM-IND-ICLI IN FIA-FLD
               MOVE SPACES TO FRM-GLS-ICLI IN FIA-FLD
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'FRMNOMCNOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMC IN FIA-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN FIA-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN FIA-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN FIA-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN FIA-FLD
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICLI IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICLI IN FIA.
       FIN-BUS-NMB-CIC-DEU.
           EXIT.
       BUS-NMB-CIC-FIA SECTION.
       INI-BUS-NMB-CIC-FIA.
      *NOM-CLI Busca Cliente por medio del Nombre
      *ALD
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.
           UNSTRING FRM-GLS-NOMF IN FIA-FLD DELIMITED BY '/' INTO
                                   DBC-GLS-APAT IN DBC
                                   DBC-GLS-AMAT IN DBC
                                   DBC-GLS-NOMB IN DBC.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO FRM-NUM-ICFS IN FIA-FLD
               MOVE SPACES TO FRM-VRF-ICFS IN FIA-FLD
               MOVE SPACES TO FRM-IND-ICFS IN FIA-FLD
               MOVE SPACES TO FRM-GLS-ICFS IN FIA-FLD
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'FRMNOMFNOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMF IN FIA-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICFS IN FIA-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICFS IN FIA-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICFS IN FIA-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICFS IN FIA-FLD
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICFS IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICFS IN FIA.
       FIN-BUS-NMB-CIC-FIA.
           EXIT.
       BUS-IDC-CIC-DEU SECTION.
       INI-BUS-IDC-CIC-DEU.
           MOVE FRM-NUM-ICLI IN FIA-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-ICLI IN FIA-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-ICLI IN FIA-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMC IN FIA-FLD
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICLI IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICLI IN FIA
           ELSE
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CICICLINOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-IDC-CIC-DEU.
           EXIT.
       BUS-IDC-CIC-FIA SECTION.
       INI-BUS-IDC-CIC-FIA.
           MOVE FRM-NUM-ICFS IN FIA-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-ICFS IN FIA-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-ICFS IN FIA-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMF IN FIA-FLD
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICFS IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICFS IN FIA
           ELSE
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CICICFSNOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-IDC-CIC-FIA.
           EXIT.
       BUS-COR-FIA SECTION.
       INI-BUS-COR-FIA.
           MOVE 0 TO FIA-NUM-IFIA IN FIA-FLD.
           MOVE ESC-CAI-IESC IN ESC TO FIA-CAI-IESC IN FIA.
           MOVE ESC-IIC-IESC IN ESC TO FIA-IIC-IESC IN FIA.
           MOVE 99                  TO FIA-NUM-IFIA IN FIA.
           MOVE FIA-CIC-IESC IN FIA TO WSS-CIC-IESC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND WSS-CIC-IESC = FIA-CIC-IESC IN FIA
               MOVE FIA-NUM-IFIA IN FIA TO FIA-NUM-IFIA IN FIA-FLD.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO FIA-NUM-IFIA IN FIA-FLD.
       FIN-BUS-COR-FIA.
           EXIT.
       BUS-COR-AMF SECTION.
       INI-BUS-COR-AMF.
           MOVE 0 TO AMF-NUM-IAMF IN FIA-FLD.
           MOVE ESC-CAI-IESC IN ESC TO AMF-CAI-IESC IN AMF.
           MOVE ESC-IIC-IESC IN ESC TO AMF-IIC-IESC IN AMF.
           MOVE FIA-NUM-IFIA IN FIA TO AMF-NUM-IFIA IN AMF.
           MOVE 99                  TO AMF-NUM-IAMF IN AMF.
           MOVE AMF-KEY-IFIA IN AMF TO WSS-KEY-IFIA.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
           IF FIO-STAT-OKS AND WSS-KEY-IFIA = AMF-KEY-IFIA IN AMF
               MOVE AMF-NUM-IAMF IN AMF TO AMF-NUM-IAMF IN FIA-FLD.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO AMF-NUM-IAMF IN FIA-FLD.
       FIN-BUS-COR-AMF.
           EXIT.
       MOD-ESC-FIA SECTION.
       INI-MOD-ESC-FIA.
           PERFORM KEY-ESC-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           IF NOT FIO-STAT-OKS
               PERFORM RET-ESC-FIA
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO ESC-NUM-DINP IN ESC
               MOVE HOY-MHOY TO ESC-NUM-MINP IN ESC
               MOVE HOY-SHOY TO ESC-NUM-SINP IN ESC
               MOVE HOY-AHOY TO ESC-NUM-AINP IN ESC
           ELSE
               PERFORM RET-ESC-FIA
               PERFORM GET-FHOY
               MOVE FIO-MOD TO FIO-CMND.
           MOVE HOY-STP-ITRN TO ESC-STP-ITRN IN ESC.
           PERFORM DEU-FIO-ESC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-MOD-ESC-FIA.
       CON-MOD-FIA.
           PERFORM KEY-FIA-FIA.
           IF FIA-NUM-IFIA IN FIA NOT > ZEROES
               GO TO FIN-MOD-ESC-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF NOT FIO-STAT-OKS
               PERFORM RET-FIA-FIA
               IF FIA-MSC-TVLF IN FIA-FLD NOT > SPACES AND
                  FIA-COD-TOFS IN FIA-FLD NOT > SPACES AND
                  FIA-VAL-LIMF IN FIA-FLD NOT > ZEROES AND
                  FIA-COD-VCLF IN FIA-FLD NOT > SPACES AND
                  FIA-FEC-FVEN IN FIA-FLD NOT > ZEROES AND
                  FIA-CAI-ICLI IN FIA-FLD NOT > SPACES AND
                  FIA-IIC-ICLI IN FIA-FLD NOT > SPACES AND
                  FIA-CAI-ICFS IN FIA-FLD NOT > SPACES AND
                  FIA-IIC-ICFS IN FIA-FLD NOT > SPACES
                   GO TO FIN-MOD-ESC-FIA
               ELSE
                   MOVE FIO-PUT TO FIO-CMND
                   MOVE ZEROES TO FIA-FEC-FSOL IN FIA
                   MOVE ZEROES TO FIA-FEC-FAUT IN FIA
                   MOVE ZEROES TO FIA-FEC-FALZ IN FIA
                   MOVE SPACES TO FIA-COD-RAUT IN FIA
                   MOVE SPACES TO FIA-COD-ABOA IN FIA
           ELSE
               PERFORM RET-FIA-FIA
               MOVE FIO-MOD TO FIO-CMND.
           MOVE HOY-STP-ITRN TO FIA-STP-ITRN IN FIA.
           PERFORM DEU-FIO-FIA.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS.
       FIN-MOD-ESC-FIA.
           EXIT.
       CLR-ESC SECTION.
       INI-CLR-ESC.
           MOVE SPACES TO ESC-COD-OFEF IN ESC.
           MOVE SPACES TO ESC-FEC-FCTT IN ESC.
           MOVE SPACES TO ESC-COD-NOTC IN ESC.
           MOVE SPACES TO ESC-COD-RCTT IN ESC.
           MOVE SPACES TO ESC-COD-ABOC IN ESC.
       FIN-CLR-ESC.
           EXIT.
       CLR-FIA SECTION.
       INI-CLR-FIA.
           MOVE ZEROES TO FIA-NUM-IFIA IN FIA.
           MOVE SPACES TO FIA-MSC-TVLF IN FIA.
           MOVE SPACES TO FIA-COD-TOFS IN FIA.
           MOVE ZEROES TO FIA-VAL-LIMF IN FIA.
           MOVE SPACES TO FIA-COD-VCLF IN FIA.
           MOVE SPACES TO FIA-FEC-FVEN IN FIA.
           MOVE SPACES TO FIA-CAI-ICLI IN FIA.
           MOVE SPACES TO FIA-IIC-ICLI IN FIA.
           MOVE SPACES TO FIA-CAI-ICFS IN FIA.
           MOVE SPACES TO FIA-IIC-ICFS IN FIA.
       FIN-CLR-FIA.
           EXIT.
       CLR-AMF SECTION.
       INI-CLR-AMF.
           MOVE ZEROES TO AMF-NUM-IAMF IN AMF.
           MOVE SPACES TO AMF-MSC-TVOA IN AMF.
           MOVE SPACES TO AMF-COD-TOOA IN AMF.
           MOVE SPACES TO AMF-COD-OFOA IN AMF.
           MOVE SPACES TO AMF-CAI-IOCA IN AMF.
           MOVE ZEROES TO AMF-IIC-IOCA IN AMF.
           MOVE SPACES TO AMF-COD-VCOA IN AMF.
           MOVE SPACES TO AMF-COD-AOOA IN AMF.
           MOVE SPACES TO AMF-COD-CDOA IN AMF.
           MOVE ZEROES TO AMF-VAL-LIMA IN AMF.
           MOVE SPACES TO AMF-COD-VCLA IN AMF.
           MOVE SPACES TO AMF-IND-TDEU IN AMF.
       FIN-CLR-AMF.
           EXIT.
       PUT-DBC-FIA SECTION.
       INI-PUT-DBC-FIA.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO FRM-GLS-NOMF IN FIA-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICFS IN FIA-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICFS IN FIA-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICFS IN FIA-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICFS IN FIA-FLD.
       FIN-PUT-DBC-FIA.
           EXIT.
       PUT-DBC-DEU SECTION.
       INI-PUT-DBC-DEU.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO FRM-GLS-NOMC IN FIA-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN FIA-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN FIA-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN FIA-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN FIA-FLD.
       FIN-PUT-DBC-DEU.
           EXIT.
       SET-MSG SECTION.
       INI-SET-MSG.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
       FIN-SET-MSG.
           EXIT.
       LEE-NXT-PRV-ESC SECTION.
       INI-LEE-NXT-PRV-ESC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-FIA-REQA > SPACES
               PERFORM LEE-NXT-PRV-FIA
           ELSE
               MOVE 'FIANO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-ESC.
           EXIT.
       LEE-NXT-PRV-FIA SECTION.
       INI-LEE-NXT-PRV-FIA.
           MOVE SCR-FIA-REQA TO ADR-FIA-REQA.
           MOVE ADR-VKEY IN ADR-FIA-REQA TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND SCR-KEY-IFIA = 'DEU' AND
              FIA-CIC-ICLI IN FIA = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 'FIASI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-FIA.
           IF FIO-STAT-OKS AND SCR-KEY-IFIA = 'FIA' AND
              FIA-CIC-ICFS IN FIA = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 'FIASI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-FIA.
           IF FIO-STAT-OKS AND SCR-KEY-IFIA = 'ESC' AND
              FIA-CIC-IESC IN FIA = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 'FIASI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-FIA.
           MOVE 'FIANO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-FIA.
           EXIT.
       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.
       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.
       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           MOVE 'DEU' TO SCR-KEY-IDBC.
           MOVE FRM-GLS-NOMC IN FIA-FLD TO DBC-GLS-NOMC IN DBC.
           IF FRM-GLS-NOMF IN FIA-FLD > SPACES
               MOVE 'FIA' TO SCR-KEY-IDBC
               MOVE FRM-GLS-NOMF IN FIA-FLD TO DBC-GLS-NOMC IN DBC.
           IF FRM-GLS-NOMC IN FIA-FLD > SPACES
               MOVE 'DEU' TO SCR-KEY-IDBC
               MOVE FRM-GLS-NOMC IN FIA-FLD TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.
       NXT-PRV-ESC SECTION.
       INI-NXT-PRV-ESC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
       FIN-NXT-PRV-ESC.
           EXIT.
       COPY DEUBFESC.
       COPY DEUBFFIA.
       COPY GNSBVIDC.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY GNSBPVRF.
       COPY GNSBFTAB.
       COPY GNSBBTAB.
       COPY GNSBBMSC.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBEGLS.
       COPY GNSBGCPT.
       COPY TABBBUSR.
       COPY TABBVUSR.
       COPY TABBFUSR.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBVTDU.
       COPY SGCBFDBC.
      *>>>>
