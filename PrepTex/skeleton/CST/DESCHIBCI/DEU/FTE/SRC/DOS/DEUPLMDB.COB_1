       IDENTIFICATION DIVISION.
      ************************
       PROGRAM-ID. DEUPLMDB.
      *AUTHOR. DONOSO JARA OSVALDO.
      *DATE-WRITTEN,  05/12/90.
      *DATE-COMPILED, 05/12/90.
      *REMARKS. SISTEMA DEUDORES
      *         ANALISTA DONOSO JARA OSVALDO.
      ******************************************************************
      *  INTERSOFT                                                     *
      *  MIGRACION A COBOL OS/390                                      *
      *  FECHA: 30 DE MARZO DE 1998                                    *
      ******************************************************************
       ENVIRONMENT DIVISION.
      *********************
       CONFIGURATION SECTION.
      *=====================
       SPECIAL-NAMES.
                      DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *====================
       FILE-CONTROL.
           SELECT DEUSRT  ASSIGN TO   DA-S-SORTWK1.

           SELECT DEULMDB ASSIGN   TO SYS017-UR-1403-S-DEULMDB.

       DATA DIVISION.
      **************
       FILE SECTION.
      *============
       SD  DEUSRT.
       01  REGSRT.
           05 SRT-IND-CRSB           PIC X(02).
           05 SRT-GLS-NOMC           PIC X(40).
           05 SRT-VGTE-BCI           PIC 9(10).
           05 SRT-VCDD-BCI           PIC 9(10).
           05 SRT-VCDI-BCI           PIC 9(10).
           05 SRT-VCDD-SIS           PIC 9(10).
           05 SRT-VCDI-SIS           PIC 9(10).
           05 SRT-CAST-SIS           PIC 9(10).
           05 SRT-MORO-SIS           PIC 9(10).
           05 SRT-NUM-ICLI           PIC 9(08).
           05 SRT-VRF-ICLI           PIC X(01).
           05 SRT-COD-TBAN           PIC X(03).

       FD  DEULMDB      LABEL RECORD OMITTED.
       01  RCRLMDB                   PIC X(132).
       EJECT
       WORKING-STORAGE SECTION.
      *=======================
       SKIP1
       01  W-PARAMETROS.
           05 WP-FECHA-FINMES.
              10 WP-DIA                 PIC X(02).
              10 FILLER                 PIC X(01).
              10 WP-MES                 PIC X(02).
              10 FILLER                 PIC X(01).
              10 WP-ANO                 PIC X(04).
              10 FILLER                 PIC X(01).
              10 WP-IND                 PIC X(02).

       01  W-SUBINDICES.
           05 WI-I                      PIC 9(02).
           05 WI-K                      PIC 9(02).
       SKIP1
       01  W-SWITCHES.
           05 WS-TERMINO                PIC 9(01)  VALUE 0.
              88 WS-TERMINO-OK      VALUE 0.
              88 WS-TERMINO-ANORMAL VALUE 1.
           05 WS-TIPO-PTMO              PIC 9(01)  VALUE 0.
              88 WS-ES-OTRO         VALUE 0.
              88 WS-ES-COMERCIAL    VALUE 1.
              88 WS-ES-CONSUMO      VALUE 2.
       SKIP1
       01  W-CONTADORES-Y-ACUMULADORES.
           05 WA-CON-LIN                PIC 9(02) VALUE 60.
           05 WA-CON-PAG                PIC 9(05) VALUE 0.
           05 WA-VGTE-BCI               PIC 9(12) VALUE 0.
           05 WA-VCDD-BCI               PIC 9(12) VALUE 0.
           05 WA-VCDI-BCI               PIC 9(12) VALUE 0.
           05 WA-VCDD-SIS               PIC 9(12) VALUE 0.
           05 WA-VCDI-SIS               PIC 9(12) VALUE 0.
           05 WA-CAST-SIS               PIC 9(12) VALUE 0.
           05 WA-MORO-SIS               PIC 9(12) VALUE 0.
           05 WA-T-VGTE-BCI             PIC 9(12) VALUE 0.
           05 WA-T-VCDD-BCI             PIC 9(12) VALUE 0.
           05 WA-T-VCDI-BCI             PIC 9(12) VALUE 0.
           05 WA-T-VCDD-SIS             PIC 9(12) VALUE 0.
           05 WA-T-VCDI-SIS             PIC 9(12) VALUE 0.
           05 WA-T-CAST-SIS             PIC 9(12) VALUE 0.
           05 WA-T-MORO-SIS             PIC 9(12) VALUE 0.
           05 WA-L-RDC                  PIC 9(06) VALUE 0.
           05 WA-L-DLC                  PIC 9(06) VALUE 0.
           05 WA-L-OPC                  PIC 9(06) VALUE 0.
           05 WA-L-CAM                  PIC 9(06) VALUE 0.
           05 WA-L-CRI                  PIC 9(06) VALUE 0.
           05 WA-L-CRI-R                PIC 9(06) VALUE 0.
           05 WA-L-DBC                  PIC 9(06) VALUE 0.
           05 WA-L-DSF                  PIC 9(06) VALUE 0.
           05 WA-L-CYR                  PIC 9(06) VALUE 0.
           05 WA-L-RBS                  PIC 9(06) VALUE 0.
           05 WA-L-TOC                  PIC 9(06) VALUE 0.
           05 WA-L-AUX                  PIC 9(06) VALUE 0.
           05 WA-L-MSC                  PIC 9(06) VALUE 0.
           05 WA-L-SRT                  PIC 9(06) VALUE 0.
       SKIP1
       01  W-TABLAS.
           05 WT-NOMBRE                 PIC X(75).
           05 WT-N REDEFINES WT-NOMBRE OCCURS 75 PIC X(01).
           05 WT-TAB-TOC  OCCURS 1 TO 400 TIMES
                          DEPENDING ON WA-L-TOC
                          ASCENDING KEY IS WT-COD-TOCR
                          INDEXED BY WT-IND.
              10 WT-COD-TOCR             PIC X(12).
              10 WT-MSC-OPEC             PIC X(04).
       SKIP1
       01  W-REGISTROS-DE-TRABAJO.
           05 WR-SECCION                 PIC X(15).
           05 WR-PARRAFO                 PIC X(15).
           05 WR-ARCHIVO                 PIC X(10).
           05 WR-OPERACI                 PIC X(10).
           05 WR-FILE-ST                 PIC X(02).
           05 WR-MENSAJE                 PIC X(35).
           05 WR-FECHA-HOY               PIC X(08).
           05 WR-FS-SRT                  PIC X(02) VALUE '  '.
           05 WR-MONEDA                  PIC X(03).
           05 WR-MONTO-DEUDA             PIC 9(13).
           05 WR-CAR-AUX                 PIC X(01).
           05 WR-FECHA.
              10 WR-ANO                  PIC 9(02).
              10 WR-MES                  PIC 9(02).
              10 WR-DIA                  PIC 9(02).
           05 WR-FECHA-AMD-PARAM.
              10 WR-AA                   PIC X(04).
              10 WR-MM                   PIC X(02).
              10 WR-DD                   PIC X(02).
           05 WR-FECHA-DMA.
              10 WR-DDD                  PIC 9(02).
              10 WR-MMM                  PIC 9(02).
              10 WR-AAA                  PIC 9(04).
       01  WR-LINEA01.
           05 FILLER            PIC X(020) VALUE 'BANCO DE CREDITO E I'.
           05 FILLER            PIC X(003) VALUE 'NV.'.
           05 FILLER            PIC X(093) VALUE ALL ' '.
           05 FILLER            PIC X(009) VALUE 'PAG. :'.
           05 WR-LA01-PAG       PIC ZZ.ZZZ.

       01  WR-LINEA02.
           05 FILLER            PIC X(019) VALUE 'SISTEMA DE DEUDORES'.
           05 FILLER            PIC X(025) VALUE ALL ' '.
           05 FILLER            PIC X(020) VALUE 'CLASIFICACION MAYORE'.
           05 FILLER            PIC X(014) VALUE 'S DEUDORES AL'.
           05 WR-LA02-FECHA     PIC X(010).
           05 FILLER            PIC X(028) VALUE ALL ' '.
           05 FILLER            PIC X(007) VALUE 'FECHA:'.
           05 WR-LA02-DD        PIC X(002).
           05 FILLER            PIC X(001) VALUE ALL '/'.
           05 WR-LA02-MM        PIC X(002).
           05 FILLER            PIC X(001) VALUE ALL '/'.
           05 WR-LA02-AA        PIC X(002).

       01  WR-LINEA0301.
           05 FILLER            PIC X(017) VALUE ' TIPO DE BANCA :'.
           05 WR-LA0301-TBAN    PIC X(004).
           05 FILLER            PIC X(02) VALUE SPACES.
           05 WR-LA0301-GLS     PIC X(30).
           05 FILLER            PIC X(89) VALUE SPACES.

       01  WR-LINEA03.
           05 FILLER            PIC X(017) VALUE ' CLASIFICACION :'.
           05 WR-LA03-CLAS      PIC X(004).
           05 FILLER            PIC X(017) VALUE '  DEUDA SUPER AL'.
           05 WR-LA03-DD        PIC X(02).
           05 FILLER            PIC X(01) VALUE '/'.
           05 WR-LA03-MM        PIC X(02).
           05 FILLER            PIC X(01) VALUE '/'.
           05 WR-LA03-AA        PIC X(04).

       01  WR-LINEA04.
           05 FILLER            PIC X(132) VALUE ALL '-'.

       01  WR-LINEA05.
           05 FILLER            PIC X(045) VALUE ALL ' '.
           05 FILLER            PIC X(020) VALUE '<------ DEUDA  COMER'.
           05 FILLER            PIC X(020) VALUE 'CIAL  BCI ------->  '.
           05 FILLER            PIC X(010) VALUE '         <'.
           05 FILLER            PIC X(020) VALUE '---- DEUDA SISTEMA F'.
           05 FILLER            PIC X(017) VALUE 'INANCIERO ------>'.

       01  WR-LINEA06.
           05 FILLER            PIC X(008) VALUE '  R.U.T.'.
           05 FILLER            PIC X(037) VALUE ALL ' '.
           05 FILLER            PIC X(020) VALUE 'DIRECTA      DIRECTA'.
           05 FILLER            PIC X(020) VALUE '     INDIRECTA     D'.
           05 FILLER            PIC X(020) VALUE 'IRECTA     INDIRECTA'.
           05 FILLER            PIC X(013) VALUE '  DIR E INDIR'.
           05 FILLER            PIC X(013) VALUE '  M O R O S A'.

       01  WR-LINEA07.
           05 FILLER            PIC X(008) VALUE '  DEUDOR'.
           05 FILLER            PIC X(020) VALUE '                  N'.
           05 FILLER            PIC X(009) VALUE 'O M B R E'.
           05 FILLER            PIC X(007) VALUE ALL ' '.
           05 FILLER            PIC X(020) VALUE 'VIGENTE $    VENCIDA'.
           05 FILLER            PIC X(020) VALUE ' $    VENCIDA $    V'.
           05 FILLER            PIC X(020) VALUE 'ENCIDA $    VENCIDA'.
           05 FILLER            PIC X(014) VALUE '$  CASTIGADA $'.

       01  WR-LINEA08.
           05 WR-LA08-RUT       PIC ZZZZZZZ9.
           05 FILLER            PIC X(001) VALUE ALL '-'.
           05 WR-LA08-DGV       PIC X(001).
           05 FILLER            PIC X(002) VALUE ALL ' '.
           05 WR-LA08-NOMB      PIC X(027).
           05 FILLER            PIC X(003) VALUE ALL ' '.
           05 WR-LA08-VGTE-BCI  PIC ZZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(001) VALUE ALL ' '.
           05 WR-LA08-VCDD-BCI  PIC ZZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(001) VALUE ALL ' '.
           05 WR-LA08-VCDI-BCI  PIC ZZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(001) VALUE ALL ' '.
           05 WR-LA08-VCDD-SIS  PIC ZZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(001) VALUE ALL ' '.
           05 WR-LA08-VCDI-SIS  PIC ZZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(001) VALUE ALL ' '.
           05 WR-LA08-CAST-SIS  PIC ZZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(001) VALUE ALL ' '.
           05 WR-LA08-MORO-SIS  PIC ZZZZ.ZZZ.ZZ9.

       01  WR-LINEA09.
           05 FILLER            PIC X(039) VALUE ALL ' '.
           05 WR-LA09-VGTE-BCI  PIC ZZZ.ZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(011) VALUE ALL ' '.
           05 WR-LA09-VCDI-BCI  PIC ZZZ.ZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(011) VALUE ALL ' '.
           05 WR-LA09-VCDI-SIS  PIC ZZZ.ZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(013) VALUE ALL ' '.

       01  WR-LINEA10.
           05 FILLER            PIC X(052) VALUE ALL ' '.
           05 WR-LA10-VCDD-BCI  PIC ZZZ.ZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(011) VALUE ALL ' '.
           05 WR-LA10-VCDD-SIS  PIC ZZZ.ZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(011) VALUE ALL ' '.
           05 WR-LA10-CAST-SIS  PIC ZZZ.ZZZ.ZZZ.ZZ9.
           05 FILLER            PIC X(011) VALUE ALL ' '.
           05 WR-LA10-MORO-SIS  PIC ZZZ.ZZZ.ZZZ.ZZ9.
       SKIP1
       EJECT
       01  WR-RDC.
      *COPYDD COL-R-RDC.COL-E-RDC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RDC
           02  COL-E-RDC00.
      *                             RELACION DEUDOR CREDITO
               03  RDC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RDC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  RDC-KEY-IREG.
      *                             KEY     IDENTIFICACION RELACION DEUD
                       05  RDC-KEY-IRDC.
      *                             COD. INT. COMP. CLIENTE
                       06  RDC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RDC-CAI-ICLI.
                       08  RDC-COD-TCLI
                                    PICTURE X(1).
                       08  RDC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RDC-IIC-ICLI
                                    PICTURE X(8).
      *                             IDENTIFICACION DOCUMENTO LEGAL
                       06  RDC-KEY-IDLC.
      *                             COD. INT. COMP. OPERACION CURSADA
                       07  RDC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       08  RDC-CAI-IOPC.
                       09  RDC-COD-TOPC
                                    PICTURE X(1).
                       09  RDC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       08  RDC-IIC-IOPC.
                       09  RDC-COD-OOPC.
                       10  RDC-COD-SOPC
                                    PICTURE X(2).
                       10  RDC-IND-SOPC
                                    PICTURE X(1).
                       09  RDC-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENTIFICACION DOCUMENTO LEGAL
                       07  RDC-NUM-IDLC
                                    PICTURE 9(3).
      *                             CODIGO TIPO RELACION
                       05  RDC-COD-TRDC
                                    PICTURE X(3).
      *                             TIME STAMP TRANSACCION
                       05  RDC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RDC-FEC-FTRN.
                       07  RDC-NUM-STRN
                                    PICTURE 9(2).
                       07  RDC-NUM-ATRN
                                    PICTURE 9(2).
                       07  RDC-NUM-MTRN
                                    PICTURE 9(2).
                       07  RDC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RDC-HRA-HRTR.
                       07  RDC-NUM-HHTR
                                    PICTURE 9(2).
                       07  RDC-NUM-MMTR
                                    PICTURE 9(2).
                       07  RDC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  RDC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RDC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  RDC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RDC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RDC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  RDC-COD-ATRN PICTURE X(12).
      *                             PEN DIRECCION ASOCIADA
                   04  RDC-NUM-DIRE PICTURE X(2).
      *                             REQ MONTO LIMITE DEUDA ( PORCENTAJE
                   04  RDC-VAL-LIMD PICTURE 9(3)V9(6)
                                        COMPUTATIONAL.
      *                             GLOSA DISPONIBLE
                   04  RDC-GLS-DISP PICTURE X(6).
       EJECT
       01  WR-DLC.
      *COPYDD COL-R-DLC.COL-E-DLC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DLC
           02  COL-E-DLC00.
      *                             DOCUMENTO LEGAL CREDITO
               03  DLC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DLC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  DLC-KEY-IREG.
      *                             KEY     IDENTIFICACION DOCUMENTO LEG
                       05  DLC-KEY-IDLC.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  DLC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DLC-CAI-IOPC.
                       08  DLC-COD-TOPC
                                    PICTURE X(1).
                       08  DLC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DLC-IIC-IOPC.
                       08  DLC-COD-OOPC.
                       09  DLC-COD-SOPC
                                    PICTURE X(2).
                       09  DLC-IND-SOPC
                                    PICTURE X(1).
                       08  DLC-GLS-NOPC
                                    PICTURE X(5).
      *                             NUM IDENTIFICACION DOCUMENTO LEGAL
                       06  DLC-NUM-IDLC
                                    PICTURE 9(3).
      *                             TIME STAMP TRANSACCION
                       05  DLC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DLC-FEC-FTRN.
                       07  DLC-NUM-STRN
                                    PICTURE 9(2).
                       07  DLC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DLC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DLC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DLC-HRA-HRTR.
                       07  DLC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DLC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DLC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  DLC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DLC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  DLC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DLC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DLC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  DLC-COD-ATRN PICTURE X(12).
      *                             REQ VALOR NOMINAL DOCUMENTO LEGAL
                   04  DLC-VAL-NDLC PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR SALDO DOCUMENTO LEGAL
                   04  DLC-VAL-SDLC PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ CODIGO TIPO DOCUMENTO
                   04  DLC-COD-TDOC PICTURE X(3).
      *                             REQ CODIGO PLAZO ( CONTABLE )
                   04  DLC-COD-PLZO.
                       05  DLC-MSC-TPZO
                                    PICTURE X(1).
                       05  DLC-MSC-CPZO
                                    PICTURE X(1).
      *                             TIPO IMPUESTOS
                   04  DLC-MSC-TIMP PICTURE X(1).
      *                             VALOR IMPUESTOS
                   04  DLC-VAL-IMPU PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             CODIGO NOTARIO CREDITO
                   04  DLC-COD-NOTC.
                       05  DLC-COD-INOT
                                    PICTURE X(3).
                       05  DLC-COD-CNOT
                                    PICTURE X(3).
                       05  DLC-COD-SNOT
                                    PICTURE X(3).
      *                             VALOR GASTOS NOTARIO
                   04  DLC-VAL-GNOT PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SITUACION COBRANZA
                   04  DLC-IND-SCBZ PICTURE X(5).
      *                             REQ SITUACION CARTERA
                   04  DLC-IND-SCRT PICTURE X(3).
      *                             CODIGO UBICACION FISICA
                   04  DLC-COD-UBFD.
                       05  DLC-COD-IUBF
                                    PICTURE X(3).
                       05  DLC-COD-CUBF
                                    PICTURE X(3).
                       05  DLC-COD-SUBF
                                    PICTURE X(3).
      *                             REQ CODIGO PLAZA
                   04  DLC-COD-PLZA PICTURE X(4).
      *                             REQ MANEJO INTERESES PERIODOS LARGOS
                   04  DLC-MSC-MIPL PICTURE X(1).
      *                             REQ CLASIFICACION RIESGO
                   04  DLC-IND-RIES PICTURE X(2).
      *                             PEN VALOR REAJUSTES DEVENGADOS DOCUM
                   04  DLC-VAL-READ PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             PEN VALOR INTERESES DEVENGADOS DOCUM
                   04  DLC-VAL-INTD PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ FECHA DEVENGO ( ULTIMO PAGO TOTA
                   04  DLC-FEC-FDEV.
                       05  DLC-NUM-SDEV
                                    PICTURE 9(2).
                       05  DLC-NUM-ADEV
                                    PICTURE 9(2).
                       05  DLC-NUM-MDEV
                                    PICTURE 9(2).
                       05  DLC-NUM-DDEV
                                    PICTURE 9(2).
      *                             SALDO INTERESES
                   04  DLC-VAL-SINT PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             SALDO CAPITAL POR AMORTIZAR
                   04  DLC-VAL-SCPA PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             FECHA AMORTIZACION
                   04  DLC-FEC-FAMT.
                       05  DLC-NUM-SAMT
                                    PICTURE 9(2).
                       05  DLC-NUM-AAMT
                                    PICTURE 9(2).
                       05  DLC-NUM-MAMT
                                    PICTURE 9(2).
                       05  DLC-NUM-DAMT
                                    PICTURE 9(2).
      *                             IDENTIFICACION DOCUMENTO LEGAL ORIGI
                   04  DLC-KEY-IDLO.
      *                             COD. INT. COMP. OPERACION CREDITO OR
                       05  DLC-CIC-IOCO.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       06  DLC-CAI-IOCO.
                       07  DLC-COD-TOCO
                                    PICTURE X(1).
                       07  DLC-COD-COCO
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       06  DLC-IIC-IOCO.
                       07  DLC-COD-OOCO.
                       08  DLC-COD-SOCO
                                    PICTURE X(2).
                       08  DLC-IND-SOCO
                                    PICTURE X(1).
                       07  DLC-GLS-NOCO
                                    PICTURE X(5).
      *                             NUM IDENT DOCUMENTO LEGAL ORIGINAL
                       05  DLC-NUM-IDLO
                                    PICTURE 9(3).
      *                             MONTO INTERESES PENDIENTES
                   04  DLC-VAL-IPEN PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ VALOR DOCTO EN PESOS (CUADRE CON
                   04  DLC-VAL-DPES PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             INDICADOR SITUACION CONTABLE
                   04  DLC-IND-SCTB PICTURE X(3).
      *                             FECHA MAXIMO VENCIMIENTO
                   04  DLC-FEC-FMAV.
                       05  DLC-NUM-SMAV
                                    PICTURE 9(2).
                       05  DLC-NUM-AMAV
                                    PICTURE 9(2).
                       05  DLC-NUM-MMAV
                                    PICTURE 9(2).
                       05  DLC-NUM-DMAV
                                    PICTURE 9(2).
      *                             VENC. EN SITUACION CONTBLE ESPECIAL
                   04  DLC-NUM-VSCE PICTURE 9(3).
      *                             FECHA SUSPENCION DEVENGO
                   04  DLC-FEC-FSDE.
                       05  DCL-NUM-SSDE
                                    PICTURE 9(2).
                       05  DCL-NUM-ASDE
                                    PICTURE 9(2).
                       05  DCL-NUM-MSDE
                                    PICTURE 9(2).
                       05  DCL-NUM-DSDE
                                    PICTURE 9(2).
      *                             GLOSA DISPONIBLE
                   04  DLC-GLS-DISP PICTURE X(63).
       EJECT
       01  WR-OPC.
      *COPYDD COL-R-OPC.COL-E-OPC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO OPC
           02  COL-E-OPC00.
      *                             OPERACION CREDITO
               03  OPC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  OPC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  OPC-KEY-IREG.
      *                             KEY     IDENTIFICACION OPERACION CRE
                       05  OPC-KEY-IOPC.
      *                             COD. INT. COMP. OPERACION CREDITO
                       06  OPC-CIC-IOPC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  OPC-CAI-IOPC.
                       08  OPC-COD-TOPC
                                    PICTURE X(1).
                       08  OPC-COD-COPC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  OPC-IIC-IOPC.
                       08  OPC-COD-OOPC.
                       09  OPC-COD-SOPC
                                    PICTURE X(2).
                       09  OPC-IND-SOPC
                                    PICTURE X(1).
                       08  OPC-GLS-NOPC
                                    PICTURE X(5).
      *                             TIME STAMP TRANSACCION
                       05  OPC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  OPC-FEC-FTRN.
                       07  OPC-NUM-STRN
                                    PICTURE 9(2).
                       07  OPC-NUM-ATRN
                                    PICTURE 9(2).
                       07  OPC-NUM-MTRN
                                    PICTURE 9(2).
                       07  OPC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  OPC-HRA-HRTR.
                       07  OPC-NUM-HHTR
                                    PICTURE 9(2).
                       07  OPC-NUM-MMTR
                                    PICTURE 9(2).
                       07  OPC-NUM-SSTR
                                    PICTURE 9(2).
      *                             REQ INDICADOR TIPO ACCION
                   04  OPC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  OPC-MSC-STAT PICTURE X(1).
      *                             REQ CODIGO ORIGEN TRANSACCION
                   04  OPC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  OPC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  OPC-COD-TTRN
                                    PICTURE X(3).
      *                             REQ AUTOR TRANSACCION
                   04  OPC-COD-ATRN PICTURE X(12).
      *                             REQ VALOR DE CAMBIO OPERACION CREDIT
                   04  OPC-COD-VCOC.
      *                             MISCELANEO TIPO VALOR
                       05  OPC-MSC-TVOC
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       05  OPC-COD-CVOC
                                    PICTURE X(3).
      *                             CODIGO TIPO CAMBIO
                       05  OPC-COD-TCOC
                                    PICTURE X(2).
      *                             REQ CODIGO CLASE OPERACION CREDITO
                   04  OPC-COD-COOC.
      *                             CODIGO TIPO OPERACION
                       05  OPC-COD-TOOC
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR OPERACION
                       05  OPC-COD-AOOC
                                    PICTURE X(3).
      *                             REQ CODIGO OFICINA OPERACION CREDITO
                   04  OPC-COD-OFOC PICTURE X(3).
      *                             RESPONSABLE MANTENCION OPERACION CRE
                   04  OPC-COD-RMOC PICTURE X(12).
      *                             CODIGO DESTINO OPERACION CREDITO
                   04  OPC-COD-CDOC PICTURE X(3).
      *                             COD. INT. COMP. LINEA DE CREDITO
                   04  OPC-CIC-ILDC.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       05  OPC-CAI-ILDC.
                       06  OPC-COD-TLDC
                                    PICTURE X(1).
                       06  OPC-COD-CLDC
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       05  OPC-IIC-ILDC.
                       06  OPC-COD-OLDC.
                       07  OPC-COD-SLDC
                                    PICTURE X(2).
                       07  OPC-IND-SLDC
                                    PICTURE X(1).
                       06  OPC-GLS-NLDC
                                    PICTURE X(5).
      *                             REQ FECHA CURSE O COLOCACION
                   04  OPC-FEC-FCOL.
                       05  OPC-NUM-SCOL
                                    PICTURE 9(2).
                       05  OPC-NUM-ACOL
                                    PICTURE 9(2).
                       05  OPC-NUM-MCOL
                                    PICTURE 9(2).
                       05  OPC-NUM-DCOL
                                    PICTURE 9(2).
      *                             REQ FECHA CURSE CONTABLE
                   04  OPC-FEC-FING.
                       05  OPC-NUM-SING
                                    PICTURE 9(2).
                       05  OPC-NUM-AING
                                    PICTURE 9(2).
                       05  OPC-NUM-MING
                                    PICTURE 9(2).
                       05  OPC-NUM-DING
                                    PICTURE 9(2).
      *                             REQ FECHA CURSE COMPUTACIONAL
                   04  OPC-FEC-FINP.
                       05  OPC-NUM-SINP
                                    PICTURE 9(2).
                       05  OPC-NUM-AINP
                                    PICTURE 9(2).
                       05  OPC-NUM-MINP
                                    PICTURE 9(2).
                       05  OPC-NUM-DINP
                                    PICTURE 9(2).
      *                             REQ MONTO CREDITO
                   04  OPC-VAL-CRED PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ SALDO VALOR CREDITO
                   04  OPC-VAL-SCRE PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ ANALISIS FERIADOS (S/N)
                   04  OPC-IND-AFER PICTURE X(1).
      *                             REQ MODALIDAD CALCULO VALORES FINALE
                   04  OPC-MSC-MCVF PICTURE X(1).
      *                             REQ TIPO CALCULO VENCIMIENTOS
                   04  OPC-MSC-TCVE.
      *                             BASE CALCULO CREDITO
                       05  OPC-MSC-BCCR
                                    PICTURE X(1).
      *                             VALORES INFORMADOS CREDITO
                       05  OPC-MSC-VICR
                                    PICTURE X(1).
      *                             TIPO RENOVACION
                   04  OPC-IND-RENO PICTURE X(3).
      *                             CONDICION GARANTIA
                   04  OPC-IND-GARA PICTURE X(3).
      *                             VALOR COMISION
                   04  OPC-SGV-VCOM PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR GASTOS
                   04  OPC-VAL-GAST PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             CODIGO DE SEGURO DESGRAVAMEN
                   04  OPC-COD-SEGD.
                       05  OPC-COD-ISEG
                                    PICTURE X(3).
                       05  OPC-COD-CSEG
                                    PICTURE X(3).
                       05  OPC-COD-SSEG
                                    PICTURE X(3).
      *                             VALOR SEGURO
                   04  OPC-VAL-SEGD PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             VALOR LIQUIDO
                   04  OPC-SGV-LIQU PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             REQ NUMERO PROXIMO VENCIMIENTO
                   04  OPC-NUM-IVEN PICTURE 9(3).
      *                             REQ NUMERO VENCIMIENTOS ORIGINALES
                   04  OPC-NUM-VCOR PICTURE 9(3).
      *                             REQ NUMERO VENCIMIENTOS VIGENTES
                   04  OPC-NUM-VCVG PICTURE 9(3).
      *                             NUMERO VENCTOS CANCELADOS EN FORMA O
                   04  OPC-NUM-VCCO PICTURE 9(3).
      *                             NUMERO VENCIMIENTOS CANCELADOS MOROS
                   04  OPC-NUM-VCCM PICTURE 9(3).
      *                             NUMERO DE VENCIMIENTOS CANCELADOS VE
                   04  OPC-NUM-VCCV PICTURE 9(3).
      *                             REQ NUMERO TOTAL VENCIMIENTOS CANCEL
                   04  OPC-NUM-TVCC PICTURE 9(3).
      *                             INDICADOR VENCIMIENTOS ESTRUCTURADOS
                   04  OPC-IND-VSTR PICTURE X(1).
      *                             COD. INT. COMP. CREDITO ENLACE
                   04  OPC-CIC-ICEN.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       05  OPC-CAI-ICEN.
                       06  OPC-COD-TCEN
                                    PICTURE X(1).
                       06  OPC-COD-CCEN
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       05  OPC-IIC-ICEN.
                       06  OPC-COD-OCEN.
                       07  OPC-COD-SCEN
                                    PICTURE X(2).
                       07  OPC-IND-SCEN
                                    PICTURE X(1).
                       06  OPC-GLS-NCEN
                                    PICTURE X(5).
      *                             CODIGO AREA GESTION
                   04  OPC-COD-AGES PICTURE X(2).
      *                             FLAG PARA ACTIVAR SIN CONTABILIZAR
                   04  FILLER       PICTURE X(1).
      *                             INDICADOR INSISTENCIA
                   04  FILLER       PICTURE X(1).
      *                             CANAL DE VENTA
                   04  FILLER       PICTURE X(1).
      *                             VALOR SEGURO
                   04  FILLER       PICTURE 9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             GLOSA DISPONIBLE
                   04  OPC-GLS-DISP PICTURE X(20).
       EJECT
       01  WR-CAM.
      *COPYDD TAB-R-CAM.TAB-E-CAM00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO CAM
           02  TAB-E-CAM00.
      *                             REGISTRO DE VALORES DE CAMBIOS
               03  CAM.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CAM-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  CAM-KEY-IREG.
      *                             KEY     FECHA 1 + FECHA 2 + VALOR 1
                       05  CAM-KEY-CAMB.
      *                             FECHA DE CAMBIO
                       06  CAM-FEC-CAMB.
      *                             FECHA 1 + FECHA 2
                       07  CAM-FEC-FCAM
                                        OCCURS 2 TIMES.
                       08  CAM-NUM-SCAM
                                    PICTURE 9(2).
                       08  CAM-NUM-ACAM
                                    PICTURE 9(2).
                       08  CAM-NUM-MCAM
                                    PICTURE 9(2).
                       08  CAM-NUM-DCAM
                                    PICTURE 9(2).
      *                             CODIGO VALOR DE CAMBIO
                       06  CAM-COD-CAMB.
      *                             VALOR 1 + VALOR 2
                       07  CAM-COD-VCAM
                                        OCCURS 2 TIMES.
      *                             TIPO VALOR                   TAB TVA
                       08  CAM-MSC-TVAL
                                    PICTURE X(1).
      *                             CODIGO VALOR
                       08  CAM-COD-CVAL
                                    PICTURE X(3).
      *                             TIPO CAMBIO
                       08  CAM-COD-TCAM
                                    PICTURE X(2).
      *                             TIME STAMP TRANSACCION
                       05  CAM-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CAM-FEC-FTRN.
                       07  CAM-NUM-STRN
                                    PICTURE 9(2).
                       07  CAM-NUM-ATRN
                                    PICTURE 9(2).
                       07  CAM-NUM-MTRN
                                    PICTURE 9(2).
                       07  CAM-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CAM-HRA-HRTR.
                       07  CAM-NUM-HHTR
                                    PICTURE 9(2).
                       07  CAM-NUM-MMTR
                                    PICTURE 9(2).
                       07  CAM-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  CAM-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CAM-MSC-STAT PICTURE X(1).
      *                             INDICADOR VIGENCIA
                   04  CAM-IND-VIGE
                             REDEFINES CAM-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  CAM-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CAM-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CAM-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  CAM-COD-ATRN PICTURE X(12).
      *                             VALOR DE CAMBIO
                   04  CAM-SGV-VCAM PICTURE S9(11)V9(4)
                                        COMPUTATIONAL-3.
      *                             DISPONIBLE
                   04  CAM-GLS-DISP PICTURE X(6).
       EJECT
       01  WR-CRI.
      *COPYDD DEU-R-CRI.DEU-E-CRI00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO CRI
           02  DEU-E-CRI00.
      *                             CLASIFICACIONES DE RIESGOS
               03  CRI.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CRI-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  CRI-KEY-IREG.
      *                             IDENTIFICACION CLASIFICACION RIESGO
                       05  CRI-KEY-ICRI.
      *                             COD. INT. COMP. DEUDOR
                       06  CRI-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  CRI-CAI-ICLI.
                       08  CRI-COD-TCLI
                                    PICTURE X(1).
                       08  CRI-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  CRI-IIC-ICLI
                                    PICTURE X(8).
      *                             IND TIPO CARTERA (COMERC,VDDA)
                       06  CRI-IND-TCAR
                                    PICTURE X(1).
      *                             FECHA CLASIFICACION
                       06  CRI-FEC-FCLA.
                       07  CRI-NUM-SCLA
                                    PICTURE 9(2).
                       07  CRI-NUM-ACLA
                                    PICTURE 9(2).
                       07  CRI-NUM-MCLA
                                    PICTURE 9(2).
                       07  CRI-NUM-DCLA
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  CRI-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CRI-FEC-FTRN.
                       07  CRI-NUM-STRN
                                    PICTURE 9(2).
                       07  CRI-NUM-ATRN
                                    PICTURE 9(2).
                       07  CRI-NUM-MTRN
                                    PICTURE 9(2).
                       07  CRI-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CRI-HRA-HRTR.
                       07  CRI-NUM-HHTR
                                    PICTURE 9(2).
                       07  CRI-NUM-MMTR
                                    PICTURE 9(2).
                       07  CRI-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  CRI-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CRI-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  CRI-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CRI-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CRI-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  CRI-COD-ATRN PICTURE X(12).
      *                             CODIGO CLASIFICACION DEL RIESGO SEGU
                   04  CRI-IND-CRSB PICTURE X(2).
      *                             CODIGO CLASIFICACION DEL RIESGO SEGU
                   04  CRI-IND-CRSS PICTURE X(2).
      *                             GLOSA DISPONIBLE
                   04  CRI-GLS-DISP PICTURE X(17).
       EJECT
       01  WR-DBC.
      *COPYDD DGC-R-DBC.DGC-E-DBC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DBC
           02  DGC-E-DBC00.
      *                             DATOS BASICOS DEL CLIENTE
               03  DBC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DBC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  DBC-KEY-IREG.
      *                             IDENTIFICACION DATOS BASICOS CLIENTE
                       05  DBC-KEY-IDBC.
      *                             COD. INT. COMP. CLIENTE
                       06  DBC-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DBC-CAI-ICLI.
                       08  DBC-COD-TCLI
                                    PICTURE X(1).
                       08  DBC-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DBC-IIC-ICLI
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DBC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DBC-FEC-FTRN.
                       07  DBC-NUM-STRN
                                    PICTURE 9(2).
                       07  DBC-NUM-ATRN
                                    PICTURE 9(2).
                       07  DBC-NUM-MTRN
                                    PICTURE 9(2).
                       07  DBC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DBC-HRA-HRTR.
                       07  DBC-NUM-HHTR
                                    PICTURE 9(2).
                       07  DBC-NUM-MMTR
                                    PICTURE 9(2).
                       07  DBC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DBC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DBC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DBC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DBC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DBC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DBC-COD-ATRN PICTURE X(12).
      *                             KEY RUT CLIENTE + INDICADOR O CALIFI
                   04  DBC-IDC-ICLI.
      *                             RUT CLIENTE
                       05  DBC-NUM-ICLI
                                    PICTURE X(8).
      *                             INDICADOR TIPO RUT
                       05  DBC-IND-ICLI
                                    PICTURE X(1).
      *                             EXTENSION DEL RUT
                       05  DBC-GLS-ICLI
                                    PICTURE X(3).
      *                             KEY DIGITO VERIFICADOR DEL RUT
                   04  DBC-VRF-ICLI PICTURE X(1).
      *                             KEY NOMBRE CLIENTE GENERICO (PERSONA
                   04  DBC-GLS-NOMC.
                       05  DBC-GLS-APAT
                                    PICTURE X(25).
                       05  DBC-GLS-AMAT
                                    PICTURE X(25).
                       05  DBC-GLS-NOMB
                                    PICTURE X(25).
      *                             SOUNDEX DEL NOMBRE DE CLIENTE
                   04  DBC-SNX-NOMC.
                       05  DBC-SNX-APAT
                                    PICTURE X(3).
                       05  DBC-SNX-AMAT
                                    PICTURE X(3).
                       05  DBC-SNX-NOMB
                                    PICTURE X(3).
      *                             NUMERO DE DIRECCION DE ENVIO CORRESP
                   04  DBC-NUM-DCOR PICTURE 9(2).
      *                             OPR IND TIPO CLIENTE ( PERSONA O EMP
                   04  DBC-IND-TICL PICTURE X(1).
      *                             TIPO CLIENTE (POTENCIAL,NO CLIENTE,G
                   04  DBC-COD-TICL PICTURE X(2).
      *                             CODIGO CLASIFICACION COMERCIAL
                   04  DBC-COD-CLCM PICTURE X(2).
      *                             RCM CODIGO DEL EJECUTIVO ENCARGADO D
                   04  DBC-COD-EJEC PICTURE X(12).
      *                             OPR CODIGO DE OFICINA DONDE OPERA EL
                   04  DBC-COD-OFIC PICTURE X(3).
      *                             RCM INDICADOR SI OPERA EN OTRA OFICI
                   04  DBC-IND-OOFI PICTURE X(1).
      *                             EXT CODIGO ACTIVIDAD ECONOMICA
                   04  DBC-COD-ACTI PICTURE X(9).
      *                             EXT ORIGEN Y DESTINO SECT (COMP.INST
                   04  DBC-COD-ODSE PICTURE X(3).
      *                             INF FECHA INGRESO AL PLAN
                   04  DBC-FEC-FPLN.
                       05  DBC-NUM-SPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-APLN
                                    PICTURE 9(2).
                       05  DBC-NUM-MPLN
                                    PICTURE 9(2).
                       05  DBC-NUM-DPLN
                                    PICTURE 9(2).
      *                             CODIGO DE SEGMENTO
                   04  DBC-COD-SETO PICTURE X(5).
      *                             PERIODO DE SEGMENTO (SSAAMM)
                   04  DBC-PDO-SETO PICTURE X(6).
      *                             INF INDICADOR DE MULTAS BANCO CENTRA
                   04  DBC-IND-MUBC PICTURE X(1).
      *                             INF INDICADOR DE JUICIOS BANCO CENTR
                   04  DBC-IND-JUBC PICTURE X(1).
      *                             EXT CODIGO ESTADO CLIENTE ( COMO DEU
                   04  DBC-MSC-SCLI PICTURE X(1).
      *                             FECHA ESTADO CLIENTE
                   04  DBC-FEC-FSCL.
                       05  DBC-NUM-SSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-ASCL
                                    PICTURE 9(2).
                       05  DBC-NUM-MSCL
                                    PICTURE 9(2).
                       05  DBC-NUM-DSCL
                                    PICTURE 9(2).
      *                             CODIGO DE BLOQUEO DEL CLIENTE
                   04  DBC-COD-BLOC PICTURE X(2).
      *                             NUMERO TOTAL DE DIRECCIONES
                   04  DBC-NUM-TDIR PICTURE 9(2).
      *                             NUMERO TOTAL DE COMENTARIOS
                   04  DBC-NUM-TCMT PICTURE 9(3).
      *                             FECHA INICIO OPERACION
                   04  DBC-FEC-FIOP.
                       05  DBC-NUM-SIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-AIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MIOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DIOP
                                    PICTURE 9(2).
      *                             FECHA TERMINO OPERACION
                   04  DBC-FEC-FTOP.
                       05  DBC-NUM-STOP
                                    PICTURE 9(2).
                       05  DBC-NUM-ATOP
                                    PICTURE 9(2).
                       05  DBC-NUM-MTOP
                                    PICTURE 9(2).
                       05  DBC-NUM-DTOP
                                    PICTURE 9(2).
      *                             NUMERO OPERACIONES FECHA TERMINO NUL
                   04  DBC-NUM-OFTN PICTURE 9(3).
      *                             FECHA INGRESO DE DATOS A LA BASE DE
                   04  DBC-FEC-FINP.
                       05  DBC-NUM-SINP
                                    PICTURE 9(2).
                       05  DBC-NUM-AINP
                                    PICTURE 9(2).
                       05  DBC-NUM-MINP
                                    PICTURE 9(2).
                       05  DBC-NUM-DINP
                                    PICTURE 9(2).
       EJECT
       01  WR-DSF.
      *COPYDD DSU-R-DSF.DSU-E-DSF00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO DSF
           02  DSU-E-DSF00.
      *                             DEUDA SISTEMA FINANCIERO
               03  DSF.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  DSF-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  DSF-KEY-IREG.
      *                             IDENTIFICACION DEUDA SISTEMA FINANCI
                       05  DSF-KEY-IDSF.
      *                             COD. INT. COMP. DEUDOR
                       06  DSF-CIC-IDEU.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  DSF-CAI-IDEU.
                       08  DSF-COD-TDEU
                                    PICTURE X(1).
                       08  DSF-COD-CDEU
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  DSF-IIC-IDEU
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  DSF-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  DSF-FEC-FTRN.
                       07  DSF-NUM-STRN
                                    PICTURE 9(2).
                       07  DSF-NUM-ATRN
                                    PICTURE 9(2).
                       07  DSF-NUM-MTRN
                                    PICTURE 9(2).
                       07  DSF-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  DSF-HRA-HRTR.
                       07  DSF-NUM-HHTR
                                    PICTURE 9(2).
                       07  DSF-NUM-MMTR
                                    PICTURE 9(2).
                       07  DSF-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  DSF-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  DSF-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  DSF-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  DSF-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  DSF-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  DSF-COD-ATRN PICTURE X(12).
      *                             COD. INT. COMP. CLIENTE
                   04  DSF-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       05  DSF-CAI-ICLI.
                       06  DSF-COD-TCLI
                                    PICTURE X(1).
                       06  DSF-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       05  DSF-IIC-ICLI
                                    PICTURE X(8).
      *                             DIRECTA VIGENTE M/N
                   04  DSF-VAL-DVGN PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             DIRECTA VIGENTE M/X
                   04  DSF-VAL-DVGX PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             DIRECTA VENCIDA M/N
                   04  DSF-VAL-DVCN PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             DIRECTA VENCIDA M/X
                   04  DSF-VAL-DVCX PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             INDIRECTA VIGENTE TOTAL
                   04  DSF-VAL-IVGT PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             INDIRECTA VENCIDA TOTAL
                   04  DSF-VAL-IVCT PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             MONTO CASTIGOS DIRECTOS
                   04  DSF-VAL-CDIR PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             MONTO CASTIGOS INDIRECTOS
                   04  DSF-VAL-CIND PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             DEUDA COMERCIAL
                   04  DSF-VAL-DCOM PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             DEUDA CREDITOS DE CONSUMO
                   04  DSF-VAL-DCON PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             DEUDA CREDITO HIPOTECARIO
                   04  DSF-VAL-DHIP PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             DEUDA MOROSA ENTRE 60 Y 90 DIAS
                   04  DSF-VAL-DMOR PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             NRO. INSTIT. DEUDOR CON CRED.CONSUMO
                   04  DSF-NUM-ICRC PICTURE 9(2).
      *                             MONTO DE LINEA DE CREDITO DISPONIBLE
                   04  DSF-VAL-LDCD PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             MONTO DEUDA DIRECTA INVER. FINANC.
                   04  DSF-VAL-DDIF PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             MONTO DEUDA DIRECTA OPERS. CON PACTO
                   04  DSF-VAL-DDOP PICTURE 9(11)
                                        COMPUTATIONAL-3.
      *                             DISPONIBLE
                   04  DSF-GLS-DISP PICTURE X(13).
       EJECT
       01  WR-CYR.
      *COPYDD DGC-R-CYR.DGC-E-CYR00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO CYR
           02  DGC-E-CYR00.
      *                             CASTIGOS Y RECUPERACIONES
               03  CYR.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  CYR-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  CYR-KEY-IREG.
      *                             IDENTIFICACION CASTIGOS Y RECUPERACI
                       05  CYR-KEY-ICYR.
      *                             COD. INT. COMP. DEUDOR
                       06  CYR-CIC-IDEU.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  CYR-CAI-IDEU.
                       08  CYR-COD-TDEU
                                    PICTURE X(1).
                       08  CYR-COD-CDEU
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  CYR-IIC-IDEU
                                    PICTURE X(8).
      *                             IND AUTOR CAST/REC (SUP/BCO)
                       06  CYR-IND-ACYR
                                    PICTURE X(3).
      *                             PERIODO CASTIGO
                       06  CYR-SAM-PCAS.
                       07  CYR-NUM-SCAS
                                    PICTURE 9(2).
                       07  CYR-NUM-ACAS
                                    PICTURE 9(2).
                       07  CYR-NUM-MCAS
                                    PICTURE 9(2).
      *                             PERIODO RECUPERACION
                       06  CYR-SAM-PREC.
                       07  CYR-NUM-SREC
                                    PICTURE 9(2).
                       07  CYR-NUM-AREC
                                    PICTURE 9(2).
                       07  CYR-NUM-MREC
                                    PICTURE 9(2).
      *                             TIME STAMP TRANSACCION
                       05  CYR-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  CYR-FEC-FTRN.
                       07  CYR-NUM-STRN
                                    PICTURE 9(2).
                       07  CYR-NUM-ATRN
                                    PICTURE 9(2).
                       07  CYR-NUM-MTRN
                                    PICTURE 9(2).
                       07  CYR-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  CYR-HRA-HRTR.
                       07  CYR-NUM-HHTR
                                    PICTURE 9(2).
                       07  CYR-NUM-MMTR
                                    PICTURE 9(2).
                       07  CYR-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  CYR-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  CYR-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  CYR-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  CYR-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  CYR-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  CYR-COD-ATRN PICTURE X(12).
      *                             VALOR DEUDA DIRECTA
                   04  CYR-VAL-DDIR PICTURE 9(9)
                                        COMPUTATIONAL.
      *                             VALOR DEUDA INDIRECTA
                   04  CYR-VAL-DIND PICTURE 9(9)
                                        COMPUTATIONAL.
      *                             DISPONIBLE
                   04  CYR-GLS-DISP PICTURE X(7).
       EJECT
       01  WR-RBS.
      *COPYDD DSU-R-RBS.DSU-E-RBS00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO RBS
           02  DSU-E-RBS00.
      *                             RELACION BANCO SUPER
               03  RBS.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  RBS-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  RBS-KEY-IREG.
      *                             IDENTIFICACION RELACION BANCO SUPER
                       05  RBS-KEY-IRBS.
      *                             COD. INT. COMP. DEUDOR
                       06  RBS-CIC-IDEU.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       07  RBS-CAI-IDEU.
                       08  RBS-COD-TDEU
                                    PICTURE X(1).
                       08  RBS-COD-CDEU
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       07  RBS-IIC-IDEU
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  RBS-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  RBS-FEC-FTRN.
                       07  RBS-NUM-STRN
                                    PICTURE 9(2).
                       07  RBS-NUM-ATRN
                                    PICTURE 9(2).
                       07  RBS-NUM-MTRN
                                    PICTURE 9(2).
                       07  RBS-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  RBS-HRA-HRTR.
                       07  RBS-NUM-HHTR
                                    PICTURE 9(2).
                       07  RBS-NUM-MMTR
                                    PICTURE 9(2).
                       07  RBS-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  RBS-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  RBS-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  RBS-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  RBS-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  RBS-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  RBS-COD-ATRN PICTURE X(12).
      *                             COD. INT. COMP. CLIENTE
                   04  RBS-CIC-ICLI.
      *                             CENTRO ASIGNACION IDENTIFICACION
                       05  RBS-CAI-ICLI.
                       06  RBS-COD-TCLI
                                    PICTURE X(1).
                       06  RBS-COD-CCLI
                                    PICTURE X(3).
      *                             IDENT. INTERNA COMPUTACIONAL
                       05  RBS-IIC-ICLI
                                    PICTURE X(8).
      *                             IDENTIFICACION CLIENTE SEGUN SUPER
                   04  RBS-GLS-ICLS.
      *                             RUT CLIENTE SEGUN SUPER
                       05  RBS-NUM-RUTS
                                    PICTURE X(8).
      *                             DIGITO VERIFICADOR RUT
                       05  RBS-VRF-RUTS
                                    PICTURE X(1).
      *                             NOMBRE CLIENTE SEGUN SUPER (PERSONA
                   04  RBS-GLS-NCLS PICTURE X(40).
      *                             SOUNDEX NOMBRE CLIENTE SUPER
                   04  RBS-SNX-NCLS PICTURE X(3).
      *                             IND TIPO PAREO DEUDOR-CLIENTE ( R/N
                   04  RBS-IND-TPDC PICTURE X(1).
      *                             IND DEUDA SISTEMA FINANCIERO
                   04  RBS-IND-IDSF PICTURE X(1).
      *                             IND CASTIGOS SISTEMA FINANCIERO
                   04  RBS-IND-ICSF PICTURE X(1).
      *                             IND CASTIGOS PROPIO BANCO
                   04  RBS-IND-ICPB PICTURE X(1).
      *                             IND CASTIGOS VIGENTES SISTEMA FINAN
                   04  RBS-IND-ICVS PICTURE X(1).
      *                             IND CASTIGOS VIGENTES BANCO
                   04  RBS-IND-ICVB PICTURE X(1).
      *                             DISPONIBLE
                   04  RBS-GLS-DISP PICTURE X(2).
       EJECT
       01  WR-TOC.
      *COPYDD TCO-R-TOC.TCO-E-TOC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO TOC
           02  TCO-E-TOC00.
      *                             REGISTRO DE TIPOS DE OPERACION
               03  TOC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  TOC-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  TOC-KEY-IREG.
      *                             IDENTIFICACION TIPO + CODIGO
                       05  TOC-COD-TABL.
      *                             CODIGO TIPO TABLA
                       06  TOC-COD-TTAB
                                    PICTURE X(3).
      *                             CODIGO TIPO DE OPERACION
                       06  TOC-COD-TOCR
                                    PICTURE X(12).
      *                             TIME STAMP TRANSACCION
                       05  TOC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  TOC-FEC-FTRN.
                       07  TOC-NUM-STRN
                                    PICTURE 9(2).
                       07  TOC-NUM-ATRN
                                    PICTURE 9(2).
                       07  TOC-NUM-MTRN
                                    PICTURE 9(2).
                       07  TOC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  TOC-HRA-HRTR.
                       07  TOC-NUM-HHTR
                                    PICTURE 9(2).
                       07  TOC-NUM-MMTR
                                    PICTURE 9(2).
                       07  TOC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  TOC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  TOC-MSC-STAT PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  TOC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  TOC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  TOC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  TOC-COD-ATRN PICTURE X(12).
      *                             RECURSOS
                   04  TOC-COD-RECU PICTURE X(9).
      *                             TIPO DE COLOCACION
                   04  TOC-MSC-TCOL PICTURE X(4).
      *                             OPERA COMO
                   04  TOC-MSC-OPEC PICTURE X(4).
      *                             DISPONIBLE
                   04  TOC-GLS-DISP PICTURE X(10).
       EJECT
       01  WR-AUX.
      *COPYDD TCO-R-AUX.TCO-E-AUX00(PROD),01,D
      *                             EQUIVALE AL REGISTRO AUX
           02  TCO-E-AUX00.
      *                             TABLA CODIGO AUXILIAR
               03  AUX.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  AUX-GLS-FLAG PICTURE X(1).
      *                             KEY CLAVE PRIMARIA REGISTRO
                   04  AUX-KEY-IREG.
      *                             TIPO + CODIGO ( LLAVE PRIMARIA )
                       05  AUX-COD-TABL.
      *                             CODIGO TIPO TABLA
                       06  AUX-COD-TTAB
                                    PICTURE X(3).
      *                             CLASE OPERACION CREDITO
                       06  AUX-COD-COCR.
      *                             TIPO DE OPERACION                TAB
                       07  AUX-COD-TOCR
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR
                       07  AUX-COD-AOCR
                                    PICTURE X(9).
      *                             KEY     TIME STAMP TRANSACCION
                       05  AUX-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  AUX-FEC-FTRN.
                       07  AUX-NUM-STRN
                                    PICTURE 9(2).
                       07  AUX-NUM-ATRN
                                    PICTURE 9(2).
                       07  AUX-NUM-MTRN
                                    PICTURE 9(2).
                       07  AUX-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  AUX-HRA-HRTR.
                       07  AUX-NUM-HHTR
                                    PICTURE 9(2).
                       07  AUX-NUM-MMTR
                                    PICTURE 9(2).
                       07  AUX-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  AUX-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  AUX-MSC-STAT PICTURE X(1).
      *                             INDICADOR VIGENCIA
                   04  AUX-IND-VIGE
                             REDEFINES AUX-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  AUX-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  AUX-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  AUX-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  AUX-COD-ATRN PICTURE X(12).
      *                             KEY TIPO + CODIGO ( INTERNO COMPUTAC
                   04  AUX-CIC-TABL.
      *                             CODIGO TIPO TABLA
                       05  AUX-CIC-TTAB
                                    PICTURE X(3).
      *                             CLASE OPERACION CREDITO
                       05  AUX-CIC-COCR.
      *                             TIPO DE OPERACION
                       06  AUX-CIC-TOCR
                                    PICTURE X(3).
      *                             CODIGO AUXILIAR
                       06  AUX-CIC-AOCR
                                    PICTURE X(9).
      *                             CODIGO EXTERNO
                   04  AUX-EXT-TABL.
      *                             CODIGO TIPO TABLA
                       05  AUX-EXT-TTAB
                                    PICTURE X(3).
      *                             CODIGO TABLA
                       05  AUX-EXT-CTAB
                                    PICTURE X(5).
      *                             DESCRIPCION CORTA
                   04  AUX-GLS-DCOR PICTURE X(12).
      *                             ABREVIACION DESCRIPCION
                   04  AUX-GLS-ABRV PICTURE X(5).
      *                             DESCRIPCION DEL CODIGO
                   04  AUX-GLS-DESC PICTURE X(40).
      *                             CUENTA CORRIENTE
                   04  AUX-GLS-CCTE PICTURE X(13).
      *                             INDICADOR DE PARTICIPACION EN CONTAB
                   04  AUX-IND-PCTB PICTURE X(1).
      *                             INDICADOR DE PARTICIPACION EN CUADRA
                   04  AUX-IND-PCDR PICTURE X(1).
      *                             DISPONIBLE
                   04  AUX-GLS-DISP PICTURE X(45).
      *                             CLAVE SOUNDEX
                   04  AUX-SNX-TABL.
                       05  AUX-SNX-TTAB
                                    PICTURE X(3).
                       05  AUX-SNX-COCR
                                    PICTURE X(3).
       EJECT
       01  WR-MSC.
      *COPYDD TAB-R-MSC.TAB-E-MSC00(PROD),01,D
      *                             EQUIVALENTE AL REGISTRO MSC
           02  TAB-E-MSC00.
      *                             REGISTRO GENERICO DE MISCELANEOS
               03  MSC.
      *                             FILLER COMPATIBILIDAD VSAM/MVS
                   04  MSC-GLS-FLAG PICTURE X(1).
      *                             CLAVE PRIMARIA REGISTRO
                   04  MSC-KEY-IREG.
      *                             KEY     TIPO + CODIGO ( LLAVE PRIMAR
                       05  MSC-COD-TABL.
      *                             CODIGO TIPO TABLA
                       06  MSC-COD-TTAB
                                    PICTURE X(3).
      *                             CODIGO MISCELANEO
                       06  MSC-COD-MSCL.
      *                             TIPO MISCELANEO
                       07  MSC-COD-TMSC
                                    PICTURE X(4).
      *                             CODIGO MISCELANEO
                       07  MSC-COD-CMSC
                                    PICTURE X(8).
      *                             TIME STAMP TRANSACCION
                       05  MSC-STP-ITRN.
      *                             FECHA TRANSACCION
                       06  MSC-FEC-FTRN.
                       07  MSC-NUM-STRN
                                    PICTURE 9(2).
                       07  MSC-NUM-ATRN
                                    PICTURE 9(2).
                       07  MSC-NUM-MTRN
                                    PICTURE 9(2).
                       07  MSC-NUM-DTRN
                                    PICTURE 9(2).
      *                             HORA TRANSACCION
                       06  MSC-HRA-HRTR.
                       07  MSC-NUM-HHTR
                                    PICTURE 9(2).
                       07  MSC-NUM-MMTR
                                    PICTURE 9(2).
                       07  MSC-NUM-SSTR
                                    PICTURE 9(2).
      *                             INDICADOR TIPO ACCION
                   04  MSC-MSC-TACC PICTURE X(1).
      *                             INDICADOR STATUS
                   04  MSC-MSC-STAT PICTURE X(1).
      *                             INDICADOR VIGENCIA
                   04  MSC-IND-VIGE
                             REDEFINES MSC-MSC-STAT
                                    PICTURE X(1).
      *                             CODIGO ORIGEN TRANSACCION
                   04  MSC-COD-OTRN.
      *                             INDICADOR TIPO ORIGEN
                       05  MSC-MSC-TTRN
                                    PICTURE X(1).
      *                             CODIGO TIPO ORIGEN
                       05  MSC-COD-TTRN
                                    PICTURE X(3).
      *                             AUTOR TRANSACCION
                   04  MSC-COD-ATRN PICTURE X(12).
      *                             KEY TIPO + CODIGO ( INTERNO COMPUTAC
                   04  MSC-CIC-TABL.
      *                             CODIGO TIPO TABLA
                       05  MSC-CIC-TTAB
                                    PICTURE X(3).
      *                             CODIGO MISCELANEO
                       05  MSC-CIC-MSCL.
      *                             TIPO MISCELANEO
                       06  MSC-CIC-TMSC
                                    PICTURE X(4).
      *                             CODIGO MISCELANEO
                       06  MSC-CIC-CMSC
                                    PICTURE X(8).
      *                             CODIGO EXTERNO
                   04  MSC-EXT-TABL.
      *                             CODIGO TIPO TABLA
                       05  MSC-EXT-TTAB
                                    PICTURE X(3).
      *                             CODIGO TABLA
                       05  MSC-EXT-CTAB
                                    PICTURE X(5).
      *                             DESCRIPCION CORTA
                   04  MSC-GLS-DCOR PICTURE X(12).
      *                             ABREVIACION DESCRIPCION
                   04  MSC-GLS-ABRV PICTURE X(5).
      *                             DESCRIPCION DEL CODIGO
                   04  MSC-GLS-DESC PICTURE X(40).
      *                             DATOS ANEXOS
                   04  MSC-GLS-DATA.
      *                             GLOSA MENSAJE
                       05  MSC-GLS-MENS
                                    PICTURE X(40).
      *                             CODIGO MENSAJE
                       05  MSC-COD-MENS
                                    PICTURE X(12).
      *                             DISPONIBLE
                       05  MSC-GLS-DISP
                                    PICTURE X(8).
      *                             CLAVE SOUNDEX
                   04  MSC-SNX-TABL.
                       05  MSC-SNX-TTAB
                                    PICTURE X(3).
                       05  MSC-SNX-MSCL
                                    PICTURE X(3).
               03  MSC-REDEF REDEFINES MSC
                                    PICTURE X(194).
       EJECT
       COPY SGCBRDCE.
       EJECT
       COPY SGCBRDCP.
       EJECT
       COPY GNSBRTAB.
       EJECT

       01  WB-UIB.
           05 FILLER                 PIC X(32) VALUE 'DEUPLMDB'.

       01  WB-REQ-TAB-AREA.
           02 WB-REQ-TAB-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'TAB'.
           02 FILLER                        PIC X(5) VALUE 'TAB00'.
           02 WB-REQ-TAB-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 WB-REQ-TAB-BDID               PIC S9(4) COMP VALUE +190.
           02 FILLER                        PIC X(58).
           02 WB-REQ-TAB-KEY-VALUE.
              03 WB-REQ-TAB-KEY-TAB         PIC X(03).
              03 WB-REQ-TAB-KEY-COD         PIC X(12).
      *
       01  WB-REQ-RDC-AREA.
           02 WB-REQ-RDC-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'RDC'.
           02 FILLER                  PIC X(5) VALUE 'RDC00'.
           02 WB-REQ-RDC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +160.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-RDC-KEY          PIC X(50).

       01  WB-REQ-DLC-AREA.
           02 WB-REQ-DLC-CMD          PIC X(5) VALUE 'LOCKY'.
           02 FILLER                  PIC X(3) VALUE 'DLC'.
           02 FILLER                  PIC X(5) VALUE 'DLC00'.
           02 WB-REQ-DLC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +160.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-DLC-KEY          PIC X(50).

       01  WB-REQ-CRI-AREA.
           02 WB-REQ-CRI-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'CRI'.
           02 FILLER                  PIC X(5) VALUE 'CRI00'.
           02 WB-REQ-CRI-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +140.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-CRI-KEY.
              03 WB-REQ-CRI-KEY1      PIC X(12).
              03 WB-REQ-CRI-KEY2      PIC X(09).

       01  WB-REQ-OPC-AREA.
           02 WB-REQ-OPC-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'OPC'.
           02 FILLER                  PIC X(5) VALUE 'OPC00'.
           02 WB-REQ-OPC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +160.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-OPC-KEY          PIC X(50).

       01  WB-REQ-DBC-AREA.
           02 WB-REQ-DBC-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'DBC'.
           02 FILLER                  PIC X(5) VALUE 'DBC00'.
           02 WB-REQ-DBC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +100.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-DBC-KEY          PIC X(50).

       01  WB-REQ-DSF-AREA.
           02 WB-REQ-DSF-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'DSF'.
           02 FILLER                  PIC X(5) VALUE 'DSF02'.
           02 WB-REQ-DSF-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +101.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-DSF-KEY          PIC X(50).

       01  WB-REQ-CYR-AREA.
           02 WB-REQ-CYR-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'CYR'.
           02 FILLER                  PIC X(5) VALUE 'CYR00'.
           02 WB-REQ-CYR-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +100.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-CYR-KEY          PIC X(50).

       01  WB-REQ-RBS-AREA.
           02 WB-REQ-RBS-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'RBS'.
           02 FILLER                  PIC X(5) VALUE 'RBS02'.
           02 WB-REQ-RBS-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +101.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-RBS-KEY          PIC X(50).

       01  WB-REQ-TOC-AREA.
           02 WB-REQ-TOC-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'TOC'.
           02 FILLER                  PIC X(5) VALUE 'TOC00'.
           02 WB-REQ-TOC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +210.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-TOC-KEY.
              03 WB-REQ-TOC-KEY1      PIC X(03).
              03 WB-REQ-TOC-KEY2      PIC X(20).

       01  WB-REQ-MSC-AREA.
           02 WB-REQ-MSC-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'TAB'.
           02 FILLER                  PIC X(5) VALUE 'TAB00'.
           02 WB-REQ-MSC-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +190.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-MSC-KEY          PIC X(50).

       01  WB-REQ-AUX-AREA.
           02 WB-REQ-AUX-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'TAB'.
           02 FILLER                  PIC X(5) VALUE 'TAB00'.
           02 WB-REQ-AUX-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +210.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-AUX-KEY.
              03 WB-REQ-AUX-KEY1      PIC X(03).
              03 WB-REQ-AUX-KEY2      PIC X(20).

       01  WB-REQ-CAM-AREA.
           02 WB-REQ-CAM-CMD          PIC X(5) VALUE 'REDKY'.
           02 FILLER                  PIC X(3) VALUE 'CAM'.
           02 FILLER                  PIC X(5) VALUE 'CAM00'.
           02 WB-REQ-CAM-RC           PIC X(2) VALUE SPACES.
           02 FILLER                  PIC X(1).
           02 FILLER                  PIC S9(4) COMP VALUE +150.
           02 FILLER                  PIC X(32).
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC S9(4) COMP.
           02 FILLER                  PIC X(22).
           02 WB-REQ-CAM-KEY.
              03 WB-REQ-CAM-FEC-1     PIC X(08).
              03 WB-REQ-CAM-FEC-2     PIC X(08).
              03 WB-REQ-CAM-COD.
                 04 WB-REQ-CAM-COD-1  PIC X(06).
                 04 WB-REQ-CAM-COD-2  PIC X(06).
                 04 FILLER            PIC X(30) VALUE SPACES.

       01  WB-REQ-DCP-AREA.
           02 WB-REQ-DCP-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DCP'.
           02 FILLER                        PIC X(5) VALUE 'DCP00'.
           02 WB-REQ-DCP-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DCP-KEY-VALUE.
              03 WB-REQ-DCP-KEY-CIC         PIC X(12).

       01  WB-REQ-DCE-AREA.
           02 WB-REQ-DCE-CMD                PIC X(5) VALUE 'REDKY'.
           02 FILLER                        PIC X(3) VALUE 'DCE'.
           02 FILLER                        PIC X(5) VALUE 'DCE00'.
           02 WB-REQ-DCE-RC                 PIC X(2) VALUE SPACES.
           02 FILLER                        PIC X(1).
           02 FILLER                        PIC S9(4) COMP VALUE +100.
           02 FILLER                        PIC X(58).
           02 WB-REQ-DCE-KEY-VALUE.
              03 WB-REQ-DCE-KEY-CIC         PIC X(12).


       01  WB-ELEM-LIST               PIC X(11) VALUE SPACES.


       EJECT
       PROCEDURE DIVISION.
      *===================
       A-CONTROL SECTION.
      *=================
       AA-INICIALIZACION.
      *------------------
           ENTRY 'DBMSCBL'.
           PERFORM B-INICIALIZAR.
       AB-PROCESAMIENTO.
      *-----------------
           IF WS-TERMINO-OK
              SORT DEUSRT ON ASCENDING KEY SRT-COD-TBAN
                                           SRT-IND-CRSB
                                           SRT-GLS-NOMC
              INPUT  PROCEDURE IS C-PROCESAR
              OUTPUT PROCEDURE IS D-IMPRIMIR
           END-IF.
       AC-TERMINACION.
      *---------------
           PERFORM E-TERMINAR.
       AZ-FIN-DE-PROCESO.
      *------------------
           GOBACK.
       EJECT
       B-INICIALIZAR SECTION.
      *=======================
       BA-INICIALES.
      *-------------
           OPEN OUTPUT DEULMDB.
           ACCEPT WR-FECHA FROM DATE
           MOVE WR-DIA TO WR-LA02-DD
           MOVE WR-MES TO WR-LA02-MM
           MOVE WR-ANO TO WR-LA02-AA.

       BB-VALIDA.
      *----------
           ACCEPT W-PARAMETROS.
           IF (WP-DIA < '01' OR WP-DIA > '31' OR
               WP-MES < '01' OR WP-MES > '12' OR
               WP-ANO NOT NUMERIC)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BB-VALIDA'         TO WR-PARRAFO
               MOVE 'SYSIN'             TO WR-ARCHIVO
               MOVE  '** FECHA INVALIDA **' TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO BZ-FIN-DE-SECCION
           END-IF.
           MOVE WP-FECHA-FINMES TO WR-LA02-FECHA.

       BC-FECHA-SUPER.
      *---------------
           MOVE 'MSCFISFFDSF' TO WB-REQ-MSC-KEY
           MOVE SPACES    TO WB-REQ-MSC-RC
           MOVE 'TAB00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-MSC-AREA WR-MSC WB-ELEM-LIST
           IF (WB-REQ-MSC-RC NOT = '  ')
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BC-FECHA-SUPER'    TO WR-PARRAFO
               MOVE 'MSC'               TO WR-ARCHIVO
               MOVE  WB-REQ-MSC-CMD     TO WR-OPERACI
               MOVE  WB-REQ-MSC-RC      TO WR-FILE-ST
               MOVE  WB-REQ-MSC-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO BZ-FIN-DE-SECCION
           END-IF.
           ADD 1 TO WA-L-MSC.

           MOVE MSC-GLS-DATA  TO WR-FECHA-DMA
           MOVE WR-DDD TO WR-LA03-DD
           MOVE WR-MMM TO WR-LA03-MM
           MOVE WR-AAA TO WR-LA03-AA.

           MOVE WP-DIA TO WR-DD
           MOVE WP-MES TO WR-MM
           MOVE WP-ANO TO WR-AA.

       BD-CARGA-TOC-MEMO.
      *------------------
           MOVE 'TOC'        TO WB-REQ-TOC-KEY1
           MOVE LOW-VALUE    TO WB-REQ-TOC-KEY2
           MOVE 'REDKG'      TO WB-REQ-TOC-CMD
           PERFORM BF-I-O-TOC.
           MOVE 'REDNX'      TO WB-REQ-TOC-CMD
           PERFORM BE-CARGA-OTRO
               UNTIL (TOC-COD-TTAB NOT = 'TOC' OR
                      WB-REQ-TOC-RC NOT = '  ').
           GO TO BZ-FIN-DE-SECCION.

       BE-CARGA-OTRO.
      *--------------
           ADD 1 TO WA-L-TOC.
           MOVE TOC-MSC-OPEC TO WT-MSC-OPEC(WA-L-TOC).
           MOVE TOC-COD-TOCR TO WT-COD-TOCR(WA-L-TOC).
           PERFORM BF-I-O-TOC.
           IF (WA-L-TOC = 400)
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BE-CARGA-OTRO'     TO WR-PARRAFO
               MOVE 'TOC'               TO WR-ARCHIVO
               MOVE '** SE LLENO TABLA DE MEMORIA **' TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO BZ-FIN-DE-SECCION
           END-IF.

       BF-I-O-TOC.
      *-----------
           MOVE SPACES    TO WB-REQ-TOC-RC
           MOVE 'TOC00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-TOC-AREA WR-TOC WB-ELEM-LIST
           IF (WB-REQ-TOC-RC NOT = '  ' AND NOT = '14')
               MOVE 'B-INICIALIZAR'     TO WR-SECCION
               MOVE 'BF-I-O-TOC'        TO WR-PARRAFO
               MOVE 'TOC'               TO WR-ARCHIVO
               MOVE  WB-REQ-TOC-CMD     TO WR-OPERACI
               MOVE  WB-REQ-TOC-RC      TO WR-FILE-ST
               MOVE  WB-REQ-TOC-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO BZ-FIN-DE-SECCION
           END-IF.

       BZ-FIN-DE-SECCION.
      *------------------
           EXIT.
       EJECT
       C-PROCESAR SECTION.
      *===================
       CA-PROCESO-GENERAL.
      *-------------------
           MOVE LOW-VALUE TO WB-REQ-CRI-KEY.
           MOVE 'LOCKY'   TO WB-REQ-CRI-CMD.
           PERFORM CX-I-O-CRI.
           IF (WB-REQ-CRI-RC = ' ')
               MOVE HIGH-VALUE TO WB-REQ-CRI-KEY2
               MOVE 'REDKL' TO WB-REQ-CRI-CMD
               PERFORM CX-I-O-CRI
           END-IF.
           PERFORM CB-BUSCA-DEUDORES
               UNTIL (WB-REQ-CRI-RC NOT = '  ').
           GO TO CZ-FIN-DE-SECCION.

       CB-BUSCA-DEUDORES.
      *------------------
           ADD  1 TO WA-L-CRI
           MOVE CRI-CIC-ICLI TO WB-REQ-RDC-KEY.
           MOVE 'LOCKY'   TO WB-REQ-RDC-CMD.
           PERFORM CX-I-O-RDC.
           IF (WB-REQ-RDC-RC = ' ')
               MOVE 'REDLE' TO WB-REQ-RDC-CMD
               PERFORM CX-I-O-RDC
               MOVE 'REDNX' TO WB-REQ-RDC-CMD
           END-IF.
           MOVE 0 TO WA-VCDD-BCI WA-VCDI-BCI WA-VGTE-BCI
           MOVE 0 TO WA-VCDD-SIS WA-VCDI-SIS WA-CAST-SIS WA-MORO-SIS

           PERFORM CC-ACUMULA-POR-CIC
               UNTIL (WB-REQ-RDC-RC NOT = '  ' OR
                      RDC-CIC-ICLI  NOT = CRI-CIC-ICLI).

           ADD WA-VCDD-BCI WA-VCDI-BCI WA-VGTE-BCI GIVING WR-MONTO-DEUDA

           IF (WR-MONTO-DEUDA < 2000000)
               NEXT SENTENCE
           ELSE
               PERFORM CC-DATOS-DEL-CLIENTE
               ADD WA-VCDD-BCI WA-VCDI-BCI WA-VCDD-SIS WA-VCDI-SIS
               WA-CAST-SIS WA-MORO-SIS GIVING WR-MONTO-DEUDA
               IF (WR-MONTO-DEUDA < 1)
                   NEXT SENTENCE
               ELSE
                   IF (CRI-IND-CRSB > CRI-IND-CRSS)
                       MOVE CRI-IND-CRSB TO SRT-IND-CRSB
                   ELSE
                       MOVE CRI-IND-CRSS TO SRT-IND-CRSB
                   END-IF
                   MOVE WA-VGTE-BCI  TO SRT-VGTE-BCI
                   MOVE WA-VCDD-BCI  TO SRT-VCDD-BCI
                   MOVE WA-VCDI-BCI  TO SRT-VCDI-BCI
                   MOVE WA-VCDD-SIS  TO SRT-VCDD-SIS
                   MOVE WA-VCDI-SIS  TO SRT-VCDI-SIS
                   MOVE WA-CAST-SIS  TO SRT-CAST-SIS
                   MOVE WA-MORO-SIS  TO SRT-MORO-SIS
                   PERFORM CE-COMPACTA-NOMBRE
                   MOVE DBC-GLS-NOMC TO SRT-GLS-NOMC
                   MOVE DBC-NUM-ICLI TO SRT-NUM-ICLI
                   MOVE DBC-VRF-ICLI TO SRT-VRF-ICLI
                   PERFORM CC-BUSCAR-TIPO-BANCA
                   RELEASE REGSRT
                   ADD 1 TO WA-L-SRT
               END-IF
           END-IF.

           MOVE 'REDNX'   TO WB-REQ-CRI-CMD.
           PERFORM CX-I-O-CRI.
           IF (WB-REQ-CRI-RC = ' ')
               MOVE HIGH-VALUE TO WB-REQ-CRI-KEY2
               MOVE 'REDKL' TO WB-REQ-CRI-CMD
               PERFORM CX-I-O-CRI
           END-IF.

      *---------------------------------------------------------------*
      *    POR AHORA                                                  *
      *---------------------------------------------------------------*
           ADD 1 TO WA-L-CRI-R.
           IF WA-L-CRI-R = 1000
              DISPLAY 'RDC LEIDOS : ' WA-L-CRI UPON CONSOLE
              MOVE 0 TO WA-L-CRI-R
           END-IF.

           IF WA-L-SRT > 299 AND WP-IND = 'SI'
              MOVE '14'    TO WB-REQ-CRI-RC
           END-IF.

       CC-LEER-DCE.
      *------------
           MOVE SPACES                      TO WB-REQ-DCE-RC
           MOVE 'DCE00'                     TO WB-ELEM-LIST
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DCE-AREA DCE WB-ELEM-LIST
           IF (WB-REQ-DCE-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CC-LEER-DCE'           TO WR-PARRAFO
               MOVE 'DCE'                   TO WR-ARCHIVO
               MOVE WB-REQ-DCE-CMD          TO WR-OPERACI
               MOVE WB-REQ-DCE-RC           TO WR-FILE-ST
               MOVE WB-REQ-DCE-KEY-VALUE    TO WR-MENSAJE
      ****     PERFORM BE-DISPLAY-ERROR
           END-IF.
           SKIP1
       CC-LEER-DCP.
      *------------
           MOVE SPACES                      TO WB-REQ-DCP-RC
           MOVE 'DCP00'                     TO WB-ELEM-LIST
           CALL 'DBNTRY' USING WB-UIB WB-REQ-DCP-AREA DCP WB-ELEM-LIST
           IF (WB-REQ-DCP-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'            TO WR-SECCION
               MOVE 'CC-LEER-DCP'           TO WR-PARRAFO
               MOVE 'DCP'                   TO WR-ARCHIVO
               MOVE WB-REQ-DCP-CMD          TO WR-OPERACI
               MOVE WB-REQ-DCP-RC           TO WR-FILE-ST
               MOVE WB-REQ-DCP-KEY-VALUE    TO WR-MENSAJE
      ****     PERFORM BE-DISPLAY-ERROR
           END-IF.

       CC-BUSCAR-TIPO-BANCA.
      *---------------------
           IF (DBC-IND-TICL = 'P')
      *PRP 04-96 MOVE RDC-CIC-ICLI     TO WB-REQ-DCP-KEY-CIC
               MOVE DBC-CIC-ICLI     TO WB-REQ-DCP-KEY-CIC
               PERFORM CC-LEER-DCP
               IF (WB-REQ-DCP-RC = '  ')
                  MOVE DCP-COD-TBAN   TO SRT-COD-TBAN
               ELSE
                  IF (WB-REQ-DCP-RC NOT = '  ')
                     DISPLAY 'NO EXISTE CLIENTE ' RDC-CIC-ICLI
                     ' EN DCP PARA OPERACION ' RDC-CIC-IOPC
                     ' ESTADO: ' WB-REQ-DCP-RC
                  MOVE SPACES         TO SRT-COD-TBAN
                  END-IF
               END-IF
           ELSE
      ** PRP 04-96 MOVE RDC-CIC-ICLI     TO WB-REQ-DCE-KEY-CIC
               MOVE DBC-CIC-ICLI     TO WB-REQ-DCE-KEY-CIC
               PERFORM CC-LEER-DCE
               IF (WB-REQ-DCE-RC = '  ')
                  MOVE DCE-COD-TBAN   TO SRT-COD-TBAN
               ELSE
                  IF (WB-REQ-DCE-RC NOT = '  ')
                     DISPLAY 'NO EXISTE CLIENTE ' RDC-CIC-ICLI
                     ' EN DCE PARA OPERACION ' RDC-CIC-IOPC
                     ' ESTADO: ' WB-REQ-DCE-RC
                     MOVE SPACES         TO SRT-COD-TBAN
                  END-IF
               END-IF.

       CC-ACUMULA-POR-CIC.
      *-------------------
           ADD 1 TO WA-L-RDC.
           MOVE RDC-CIC-IOPC TO WB-REQ-DLC-KEY
           MOVE 'LOCKY'  TO WB-REQ-DLC-CMD
           PERFORM CX-I-O-DLC.
           IF (WB-REQ-DLC-RC = '  ')
               MOVE 'REDLE'  TO WB-REQ-DLC-CMD
               PERFORM CX-I-O-DLC
               MOVE 'REDNX'  TO WB-REQ-DLC-CMD
               IF (WB-REQ-DLC-RC = '  ' AND
                   RDC-CIC-IOPC  = DLC-CIC-IOPC)
                   PERFORM CC-CALCULA-DEUDA
               END-IF
           END-IF.

           PERFORM CX-I-O-RDC.

       CC-CALCULA-DEUDA.
      *-----------------
           MOVE DLC-CIC-IOPC TO WB-REQ-OPC-KEY
           PERFORM CX-I-O-OPC.
           IF (WB-REQ-OPC-RC = '  ' AND OPC-VAL-SCRE > 0 AND
               OPC-FEC-FINP NOT > WR-FECHA-AMD-PARAM) AND
      *** PRP NOV/96
               OPC-MSC-STAT = 'A'
               ADD 1 TO WA-L-OPC
               IF (OPC-COD-TOOC = 'HIP')
                   NEXT SENTENCE
               ELSE
               PERFORM CC-VER-PTMO-COMERCIAL
               IF (NOT WS-ES-COMERCIAL)
                   NEXT SENTENCE
               ELSE
               PERFORM CC-VER-PTMO-CONSUMO
               IF (WS-ES-CONSUMO)
                   NEXT SENTENCE
               ELSE
               IF (OPC-COD-CVOC = '999')
                   MOVE OPC-COD-CVOC TO WR-MONEDA
                   MOVE 1 TO CAM-SGV-VCAM
                   ADD  1 TO WA-L-CAM
               ELSE
               IF (WR-MONEDA NOT = OPC-COD-CVOC)
                   MOVE OPC-COD-CVOC TO WR-MONEDA
                   PERFORM CX-I-O-CAM
                   ADD 1 TO WA-L-CAM
               END-IF
               END-IF
               PERFORM CC-ACUMULA-POR-DLC
                 UNTIL (WB-REQ-DLC-RC NOT = '  ' OR
                        RDC-CIC-IOPC  NOT = DLC-CIC-IOPC)
               END-IF
               END-IF
               END-IF
           ELSE
           IF (WB-REQ-OPC-RC NOT = '  ')
               DISPLAY 'PROCESANDO "RDC"   : ' WB-REQ-RDC-KEY
               DISPLAY 'NO EXISTE EN "OPC" : ' WB-REQ-OPC-KEY
               DISPLAY '---------------------------------------'
           END-IF
           END-IF.

       CC-VER-PTMO-COMERCIAL.
      *----------------------
           SET WS-ES-OTRO TO TRUE
           SET WT-IND     TO 1
           SEARCH ALL WT-TAB-TOC
            AT END
                  DISPLAY 'PROCESANDO "RDC"   : ' WB-REQ-RDC-KEY
                  DISPLAY 'NO EXISTE EN "TOC" : TOC' OPC-COD-TOOC
                  DISPLAY '---------------------------------------'
            WHEN  WT-COD-TOCR(WT-IND) = OPC-COD-TOOC
                  IF (WT-MSC-OPEC(WT-IND) = 'P' OR = 'H' OR = 'N')
                      SET WS-ES-COMERCIAL TO TRUE
                  END-IF
            END-SEARCH.

       CC-VER-PTMO-CONSUMO.
      *--------------------
           MOVE 'AUX'        TO WB-REQ-AUX-KEY1
           MOVE OPC-COD-COOC TO WB-REQ-AUX-KEY2
           PERFORM CX-I-O-AUX.
           IF (WB-REQ-AUX-RC = '14')
               DISPLAY 'PROCESANDO "RDC"   : ' WB-REQ-RDC-KEY
               DISPLAY 'NO EXISTE EN "AUX" : ' WB-REQ-AUX-KEY
               DISPLAY '---------------------------------------'
               SET WS-ES-CONSUMO TO TRUE
           ELSE
           ADD 1 TO WA-L-AUX
           IF (AUX-CIC-COCR = 'CON' OR AUX-CIC-COCR = 'DIS')
               SET WS-ES-CONSUMO TO TRUE
           ELSE
               SET WS-ES-OTRO TO TRUE
           END-IF
           END-IF.

       CC-ACUMULA-POR-DLC.
      *-------------------
           ADD 1 TO WA-L-DLC
           IF (DLC-IND-SCRT = 'VDD')
               NEXT SENTENCE
           ELSE
           IF (RDC-NUM-IDLC = 0)
               IF (DLC-IND-SCTB = '   ')
                   COMPUTE WA-VGTE-BCI ROUNDED = WA-VGTE-BCI   +
                                 (DLC-VAL-SDLC * CAM-SGV-VCAM) +
                                  DLC-VAL-READ + DLC-VAL-INTD
               ELSE
               IF (DLC-IND-SCTB = 'VCD')
                   COMPUTE WA-VCDD-BCI ROUNDED = WA-VCDD-BCI   +
                                 (DLC-VAL-SDLC * CAM-SGV-VCAM) +
                                  DLC-VAL-READ + DLC-VAL-INTD
               END-IF
               END-IF
           ELSE
               IF (DLC-IND-SCTB = '   ')
                   NEXT SENTENCE
               ELSE
               IF (DLC-IND-SCTB = 'VCD')
                   COMPUTE WA-VCDI-BCI ROUNDED = WA-VCDI-BCI   +
                                 (DLC-VAL-SDLC * CAM-SGV-VCAM) +
                                  DLC-VAL-READ + DLC-VAL-INTD
               END-IF
               END-IF
           END-IF
           END-IF.
           PERFORM CX-I-O-DLC.

       CC-DATOS-DEL-CLIENTE.
      *---------------------
           MOVE CRI-CIC-ICLI TO WB-REQ-DBC-KEY
           PERFORM CX-I-O-DBC.
           IF (WB-REQ-DBC-RC = '14')
               MOVE '*** NO EXISTE NOMBRE ***' TO DBC-GLS-NOMC
               MOVE ZEROES TO DBC-IDC-ICLI DBC-VRF-ICLI
           ELSE
               ADD 1 TO WA-L-DBC
           END-IF.

           MOVE CRI-CIC-ICLI TO WB-REQ-DSF-KEY
           PERFORM CX-I-O-DSF.
           IF (WB-REQ-DSF-RC = '14')
               MOVE 0 TO WA-VCDD-SIS WA-VCDI-SIS
               MOVE 0 TO WA-MORO-SIS
           ELSE
               ADD  DSF-VAL-DVCN DSF-VAL-DVCX GIVING WA-VCDD-SIS
               MOVE DSF-VAL-IVCT              TO     WA-VCDI-SIS
               MOVE DSF-VAL-DMOR              TO     WA-MORO-SIS
               ADD 1 TO WA-L-DSF
           END-IF.

           MOVE CRI-CIC-ICLI TO WB-REQ-RBS-KEY
           PERFORM CX-I-O-RBS.
           IF (WB-REQ-RBS-RC = '14')
               NEXT SENTENCE
           ELSE
               ADD 1 TO WA-L-RBS
               MOVE RBS-CIC-IDEU TO WB-REQ-CYR-KEY
               MOVE 'LOCKY'      TO WB-REQ-CYR-CMD
      *** PRP NOV.96  PERFORM CX-I-O-CYR
               MOVE '14'         TO WB-REQ-CYR-RC
               ADD DSF-VAL-CDIR DSF-VAL-CIND TO WA-CAST-SIS
      ***
               IF (WB-REQ-CYR-RC = '  ')
                   MOVE 'REDLE'  TO WB-REQ-CYR-CMD
                   PERFORM CX-I-O-CYR
                   MOVE 'REDNX'  TO WB-REQ-CYR-CMD
                   PERFORM CD-ACUMULA-POR-IDEU
                         UNTIL (WB-REQ-CYR-RC NOT = '  ' OR
                                RBS-CIC-IDEU  NOT = CYR-CIC-IDEU)
               END-IF
           END-IF.

       CD-ACUMULA-POR-IDEU.
      *--------------------
           ADD 1 TO WA-L-CYR
           IF (CYR-NUM-MCAS > 0)
               ADD CYR-VAL-DDIR CYR-VAL-DIND TO WA-CAST-SIS
           END-IF
           PERFORM CX-I-O-CYR.

       CE-COMPACTA-NOMBRE.
      *-------------------
           MOVE DBC-GLS-NOMC TO WT-NOMBRE.
           MOVE 0            TO WI-K WI-I
           PERFORM CF-COMPACTA VARYING WI-I FROM 1 BY 1
                   UNTIL (WI-I > 75)
           MOVE WT-NOMBRE TO DBC-GLS-NOMC.

       CF-COMPACTA.
      *------------
           MOVE WT-N(WI-I) TO WR-CAR-AUX
           MOVE ' '        TO WT-N(WI-I)
           IF (WI-K = 0 AND WR-CAR-AUX = ' ')
               NEXT SENTENCE
           ELSE
           IF (WR-CAR-AUX = ' ')
               IF (WT-N(WI-K) = ' ')
                   NEXT SENTENCE
               ELSE
                   ADD 1 TO WI-K
                   MOVE WR-CAR-AUX TO WT-N(WI-K)
               END-IF
           ELSE
               ADD 1 TO WI-K
               MOVE WR-CAR-AUX TO WT-N(WI-K)
           END-IF
           END-IF.

       CX-I-O-RDC.
      *-----------
           MOVE SPACES    TO WB-REQ-RDC-RC
           MOVE 'RDC00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-RDC-AREA WR-RDC WB-ELEM-LIST
           IF (WB-REQ-RDC-RC NOT = '14 ' AND NOT = '  ')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-RDC'        TO WR-PARRAFO
               MOVE 'RDC'               TO WR-ARCHIVO
               MOVE  WB-REQ-RDC-CMD     TO WR-OPERACI
               MOVE  WB-REQ-RDC-RC      TO WR-FILE-ST
               MOVE  WB-REQ-RDC-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CX-I-O-DLC.
      *-----------
           MOVE SPACES    TO WB-REQ-DLC-RC
           MOVE 'DLC00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-DLC-AREA WR-DLC WB-ELEM-LIST
           IF (WB-REQ-DLC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-DLC'        TO WR-PARRAFO
               MOVE 'DLC'               TO WR-ARCHIVO
               MOVE  WB-REQ-DLC-CMD     TO WR-OPERACI
               MOVE  WB-REQ-DLC-RC      TO WR-FILE-ST
               MOVE  WB-REQ-DLC-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CX-I-O-CRI.
      *-----------
           MOVE SPACES    TO WB-REQ-CRI-RC
           MOVE 'CRI00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-CRI-AREA WR-CRI WB-ELEM-LIST
           IF (WB-REQ-CRI-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-CRI'        TO WR-PARRAFO
               MOVE 'CRI'               TO WR-ARCHIVO
               MOVE  WB-REQ-CRI-CMD     TO WR-OPERACI
               MOVE  WB-REQ-CRI-RC      TO WR-FILE-ST
               MOVE  WB-REQ-CRI-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CX-I-O-OPC.
      *-----------
           MOVE SPACES    TO WB-REQ-OPC-RC
           MOVE 'OPC00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-OPC-AREA WR-OPC WB-ELEM-LIST
           IF (WB-REQ-OPC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-OPC'        TO WR-PARRAFO
               MOVE 'OPC'               TO WR-ARCHIVO
               MOVE  WB-REQ-OPC-CMD     TO WR-OPERACI
               MOVE  WB-REQ-OPC-RC      TO WR-FILE-ST
               MOVE  WB-REQ-OPC-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CX-I-O-DSF.
      *-----------
           MOVE SPACES    TO WB-REQ-DSF-RC
           MOVE 'DSF00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-DSF-AREA WR-DSF WB-ELEM-LIST
           IF (WB-REQ-DSF-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-DSF'        TO WR-PARRAFO
               MOVE 'DSF'               TO WR-ARCHIVO
               MOVE  WB-REQ-DSF-CMD     TO WR-OPERACI
               MOVE  WB-REQ-DSF-RC      TO WR-FILE-ST
               MOVE  WB-REQ-DSF-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CX-I-O-CYR.
      *-----------
           MOVE SPACES    TO WB-REQ-CYR-RC
           MOVE 'CYR00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-CYR-AREA WR-CYR WB-ELEM-LIST
           IF (WB-REQ-CYR-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-CYR'        TO WR-PARRAFO
               MOVE 'CYR'               TO WR-ARCHIVO
               MOVE  WB-REQ-CYR-CMD     TO WR-OPERACI
               MOVE  WB-REQ-CYR-RC      TO WR-FILE-ST
               MOVE  WB-REQ-CYR-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CX-I-O-DBC.
      *-----------
           MOVE SPACES    TO WB-REQ-DBC-RC
           MOVE 'DBC00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-DBC-AREA WR-DBC WB-ELEM-LIST
           IF (WB-REQ-DBC-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-DBC'        TO WR-PARRAFO
               MOVE 'DBC'               TO WR-ARCHIVO
               MOVE  WB-REQ-DBC-CMD     TO WR-OPERACI
               MOVE  WB-REQ-DBC-RC      TO WR-FILE-ST
               MOVE  WB-REQ-DBC-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CX-I-O-RBS.
      *-----------
           MOVE SPACES    TO WB-REQ-RBS-RC
           MOVE 'RBS00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-RBS-AREA WR-RBS WB-ELEM-LIST
           IF (WB-REQ-RBS-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-RBS'        TO WR-PARRAFO
               MOVE 'DBC'               TO WR-ARCHIVO
               MOVE  WB-REQ-RBS-CMD     TO WR-OPERACI
               MOVE  WB-REQ-RBS-RC      TO WR-FILE-ST
               MOVE  WB-REQ-RBS-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CX-I-O-AUX.
      *-----------
           MOVE SPACES    TO WB-REQ-AUX-RC
           MOVE 'TAB00'   TO WB-ELEM-LIST
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-AUX-AREA WR-AUX WB-ELEM-LIST
           IF (WB-REQ-AUX-RC NOT = '  ' AND NOT = '14')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-AUX'        TO WR-PARRAFO
               MOVE 'AUX'               TO WR-ARCHIVO
               MOVE  WB-REQ-AUX-CMD     TO WR-OPERACI
               MOVE  WB-REQ-AUX-RC      TO WR-FILE-ST
               MOVE  WB-REQ-AUX-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CX-I-O-CAM.
      *-----------
           MOVE SPACES             TO WB-REQ-CAM-RC
           MOVE 'CAM00'            TO WB-ELEM-LIST
           MOVE WR-FECHA-AMD-PARAM TO WB-REQ-CAM-FEC-1
                                      WB-REQ-CAM-FEC-2
           MOVE OPC-COD-VCOC       TO WB-REQ-CAM-COD-1.
           MOVE '0999  '           TO WB-REQ-CAM-COD-2.
           CALL 'DBNTRY' USING
                          WB-UIB WB-REQ-CAM-AREA WR-CAM WB-ELEM-LIST
           IF (WB-REQ-CAM-RC NOT = '  ')
               MOVE 'C-PROCESAR'        TO WR-SECCION
               MOVE 'CX-I-O-CAM'        TO WR-PARRAFO
               MOVE 'CAM'               TO WR-ARCHIVO
               MOVE  WB-REQ-CAM-CMD     TO WR-OPERACI
               MOVE  WB-REQ-CAM-RC      TO WR-FILE-ST
               MOVE  WB-REQ-CAM-KEY     TO WR-MENSAJE
               SET   WS-TERMINO-ANORMAL TO TRUE
               GO TO CZ-FIN-DE-SECCION
           END-IF.

       CZ-FIN-DE-SECCION.
      *------------------
           EXIT.
       EJECT
       D-IMPRIMIR SECTION.
      *===================
       DA-OBTIENE-LISTADO.
      *-------------------
           RETURN DEUSRT AT END MOVE '10' TO WR-FS-SRT .
           MOVE SRT-IND-CRSB TO WR-LA03-CLAS
           PERFORM DD-LEER-TAB
           MOVE SRT-COD-TBAN TO WR-LA0301-TBAN
           MOVE TAB-GLS-DESC TO WR-LA0301-GLS
           MOVE 0 TO WA-VGTE-BCI WA-VCDD-BCI WA-VCDD-SIS
           MOVE 0 TO WA-VCDI-BCI WA-VCDI-SIS WA-CAST-SIS WA-MORO-SIS
           PERFORM DB-SACA-LISTADO
             UNTIL (WR-FS-SRT NOT = '  ').
           MOVE WA-VGTE-BCI   TO WR-LA09-VGTE-BCI
           MOVE WA-VCDD-BCI   TO WR-LA10-VCDD-BCI
           MOVE WA-VCDI-BCI   TO WR-LA09-VCDI-BCI
           MOVE WA-VCDD-SIS   TO WR-LA10-VCDD-SIS
           MOVE WA-VCDI-SIS   TO WR-LA09-VCDI-SIS
           MOVE WA-CAST-SIS   TO WR-LA10-CAST-SIS
           MOVE WA-MORO-SIS   TO WR-LA10-MORO-SIS
           WRITE RCRLMDB FROM WR-LINEA09 AFTER 3 LINES
           WRITE RCRLMDB FROM WR-LINEA10 AFTER 1 LINES
           ADD WA-VGTE-BCI    TO WA-T-VGTE-BCI
           ADD WA-VCDD-BCI    TO WA-T-VCDD-BCI
           ADD WA-VCDI-BCI    TO WA-T-VCDI-BCI
           ADD WA-VCDD-SIS    TO WA-T-VCDD-SIS
           ADD WA-VCDI-SIS    TO WA-T-VCDI-SIS
           ADD WA-CAST-SIS    TO WA-T-CAST-SIS
           ADD WA-MORO-SIS    TO WA-T-MORO-SIS
           MOVE WA-T-VGTE-BCI TO WR-LA09-VGTE-BCI
           MOVE WA-T-VCDD-BCI TO WR-LA10-VCDD-BCI
           MOVE WA-T-VCDI-BCI TO WR-LA09-VCDI-BCI
           MOVE WA-T-VCDD-SIS TO WR-LA10-VCDD-SIS
           MOVE WA-T-VCDI-SIS TO WR-LA09-VCDI-SIS
           MOVE WA-T-CAST-SIS TO WR-LA10-CAST-SIS
           WRITE RCRLMDB FROM WR-LINEA09 AFTER 3 LINES
           WRITE RCRLMDB FROM WR-LINEA10 AFTER 1 LINES
           GO TO DZ-FIN-DE-SECCION.

       DB-SACA-LISTADO.
      *----------------
           IF (SRT-IND-CRSB NOT = WR-LA03-CLAS) OR
              (SRT-COD-TBAN NOT = WR-LA0301-TBAN)
               MOVE 60 TO WA-CON-LIN
               MOVE WA-VGTE-BCI TO WR-LA09-VGTE-BCI
               MOVE WA-VCDD-BCI TO WR-LA10-VCDD-BCI
               MOVE WA-VCDI-BCI TO WR-LA09-VCDI-BCI
               MOVE WA-VCDD-SIS TO WR-LA10-VCDD-SIS
               MOVE WA-VCDI-SIS TO WR-LA09-VCDI-SIS
               MOVE WA-CAST-SIS TO WR-LA10-CAST-SIS
               MOVE WA-MORO-SIS TO WR-LA10-MORO-SIS
               WRITE RCRLMDB FROM WR-LINEA09 AFTER 3 LINES
               WRITE RCRLMDB FROM WR-LINEA10 AFTER 1 LINES
               ADD WA-VGTE-BCI TO WA-T-VGTE-BCI
               ADD WA-VCDD-BCI TO WA-T-VCDD-BCI
               ADD WA-VCDI-BCI TO WA-T-VCDI-BCI
               ADD WA-VCDD-SIS TO WA-T-VCDD-SIS
               ADD WA-VCDI-SIS TO WA-T-VCDI-SIS
               ADD WA-CAST-SIS TO WA-T-CAST-SIS
               ADD WA-MORO-SIS TO WA-T-MORO-SIS
               MOVE 0 TO WA-VGTE-BCI WA-VCDD-BCI WA-VCDD-SIS
               MOVE 0 TO WA-VCDI-BCI WA-VCDI-SIS WA-CAST-SIS WA-MORO-SIS
               MOVE SRT-IND-CRSB TO WR-LA03-CLAS
               PERFORM DD-LEER-TAB
               MOVE SRT-COD-TBAN TO WR-LA0301-TBAN
               MOVE TAB-GLS-DESC TO WR-LA0301-GLS
           END-IF.

           IF (WA-CON-LIN > 55)
               PERFORM DC-TIT-LISTADO
           END-IF.
           MOVE SRT-VGTE-BCI TO WR-LA08-VGTE-BCI
           MOVE SRT-VCDD-BCI TO WR-LA08-VCDD-BCI
           MOVE SRT-VCDI-BCI TO WR-LA08-VCDI-BCI
           MOVE SRT-VCDD-SIS TO WR-LA08-VCDD-SIS
           MOVE SRT-VCDI-SIS TO WR-LA08-VCDI-SIS
           MOVE SRT-CAST-SIS TO WR-LA08-CAST-SIS
           MOVE SRT-MORO-SIS TO WR-LA08-MORO-SIS
           MOVE SRT-GLS-NOMC TO WR-LA08-NOMB
           MOVE SRT-NUM-ICLI TO WR-LA08-RUT
           MOVE SRT-VRF-ICLI TO WR-LA08-DGV
           WRITE RCRLMDB FROM WR-LINEA08 AFTER 1 LINES
           ADD 1 TO WA-CON-LIN.
           ADD SRT-VGTE-BCI TO WA-VGTE-BCI.
           ADD SRT-VCDD-BCI TO WA-VCDD-BCI.
           ADD SRT-VCDI-BCI TO WA-VCDI-BCI.
           ADD SRT-VCDD-SIS TO WA-VCDD-SIS.
           ADD SRT-VCDI-SIS TO WA-VCDI-SIS.
           ADD SRT-CAST-SIS TO WA-CAST-SIS.
           ADD SRT-MORO-SIS TO WA-MORO-SIS.
           RETURN DEUSRT AT END MOVE '10' TO WR-FS-SRT .

       DC-TIT-LISTADO.
      *---------------
           ADD 1 TO WA-CON-PAG.
           MOVE WA-CON-PAG TO WR-LA01-PAG
           WRITE RCRLMDB FROM WR-LINEA01 AFTER PAGE.
           WRITE RCRLMDB FROM WR-LINEA02 AFTER 1 LINES
           WRITE RCRLMDB FROM WR-LINEA0301 AFTER 2 LINES
           WRITE RCRLMDB FROM WR-LINEA03 AFTER 1 LINES
           WRITE RCRLMDB FROM WR-LINEA04 AFTER 1 LINES
           WRITE RCRLMDB FROM WR-LINEA05 AFTER 1 LINES
           WRITE RCRLMDB FROM WR-LINEA06 AFTER 1 LINES
           WRITE RCRLMDB FROM WR-LINEA07 AFTER 1 LINES
           WRITE RCRLMDB FROM WR-LINEA04 AFTER 1 LINES
           MOVE 7 TO WA-CON-LIN.

       DD-LEER-TAB.
      *------------
           MOVE SPACES                      TO WB-REQ-TAB-RC
           MOVE 'TAB00'                     TO WB-ELEM-LIST
           MOVE +190                        TO WB-REQ-TAB-BDID
           MOVE 'BAN'                       TO WB-REQ-TAB-KEY-TAB
           MOVE SRT-COD-TBAN                TO WB-REQ-TAB-KEY-COD
           CALL 'DBNTRY' USING WB-UIB WB-REQ-TAB-AREA TAB WB-ELEM-LIST
           IF (WB-REQ-TAB-RC NOT = '  ')
               MOVE 'SIN DESCRIPCION'       TO TAB-GLS-DESC
           END-IF.
           SKIP1

       DZ-FIN-DE-SECCION.
      *------------------
           EXIT.
       EJECT
       E-TERMINAR SECTION.
      *===================
       EA-ESTADISTICAS.
      *----------------
           ACCEPT WR-FECHA-HOY FROM DATE.
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'INFORMES'
           DISPLAY '--------'
           DISPLAY ' '
           IF WS-TERMINO-ANORMAL
              MOVE 100 TO RETURN-CODE
              DISPLAY 'DEULMDB, NO EMITIDO O INCOMPLETO'
              DISPLAY ' '
              DISPLAY ' '
           ELSE
              DISPLAY 'DEULMDB, SE EMITIO PARA LAS SIGUIENTES OFICINAS'
              DISPLAY ' '
              DISPLAY '090 L'
           END-IF.
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'ESTADISTICAS DE PROCESO PROGRAMA DEUPLMDB FECHA '
                    WR-FECHA-HOY
           DISPLAY '-----------------------------------------------'
           DISPLAY '          CLASIFICACION MAYORES DEUDORES '
           DISPLAY ' '
           DISPLAY 'TABLA     NRO.REG.'
           DISPLAY ' '
           DISPLAY 'RDC      ' WA-L-RDC
           DISPLAY 'DLC      ' WA-L-DLC
           DISPLAY 'OPC      ' WA-L-OPC
           DISPLAY 'CAM      ' WA-L-CAM
           DISPLAY 'CRI      ' WA-L-CRI
           DISPLAY 'DBC      ' WA-L-DBC
           DISPLAY 'DSF      ' WA-L-DSF
           DISPLAY 'CYR      ' WA-L-CYR
           DISPLAY 'RBS      ' WA-L-RBS
           DISPLAY 'TOC      ' WA-L-TOC
           DISPLAY 'AUX      ' WA-L-AUX
           DISPLAY 'MSC      ' WA-L-MSC
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'TARJETAS DE PARAMETROS'
           DISPLAY '----------------------'
           DISPLAY ' '
           DISPLAY W-PARAMETROS.
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY 'MENSAJES PARA EL EXPLOTADOR'
           DISPLAY '---------------------------'
           DISPLAY ' '
           IF WS-TERMINO-OK
               DISPLAY 'NO HAY MENSAJES PARA EL EXPLOTADOR'
           ELSE
               DISPLAY 'HAY MENSAJES PARA EL EXPLOTADOR'
           END-IF.
           DISPLAY ' '
           DISPLAY ' '
           DISPLAY ' '.
       EB-TERMINO.
      *-----------
           CLOSE DEULMDB.
           IF WS-TERMINO-ANORMAL
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
              DISPLAY '********                              ********'
              DISPLAY '******** TERMINO ERRONEO DEL PROCESO  ********'
              DISPLAY '********                              ********'
              DISPLAY '**********************************************'
              DISPLAY '**********************************************'
              DISPLAY ' '
              DISPLAY 'EL ERROR FUE EN LA SECCION          ' WR-SECCION
              DISPLAY '                   PARRAFO          ' WR-PARRAFO
              DISPLAY '                   ARCHIVO          ' WR-ARCHIVO
              DISPLAY '                   OPERACION        ' WR-OPERACI
              DISPLAY '                   FILE STATUS      ' WR-FILE-ST
              DISPLAY '                   MENSAJE DE ERROR ' WR-MENSAJE
              DISPLAY ' '
              DISPLAY 'RDC==>' WR-RDC
           ELSE
              DISPLAY ' '
              DISPLAY ' '
              DISPLAY '*****PROCESO TERMINO EN FORMA NORMAL*****'
           END-IF.

       EZ-FIN-DE-SECCION.
      *------------------
           EXIT.
