       PUT-ALL SECTION.
       INI-PUT-ALL.
           PERFORM PUT-DBE.
       GET-FRM-GLS-TSOC.
           MOVE 'DGC' TO TAB-COD-SIST.
           MOVE 'SOC' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-TSOC IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TSOC IN DBE-FLD.
       GET-FRM-GLS-LUGA.
           MOVE DBE-COD-LUGA IN DBE-FLD TO WSS-COD-LUGA.
           IF WSS-IND-PAIS = 'P'
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'PAI' TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-PAIS TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN DBE-FLD
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'COM' TO TAB-COD-TTAB IN TAB
               MOVE DBE-COD-LUGA IN DBE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN DBE-FLD.
       GET-FRM-GLS-OFIC.
           MOVE DBE-COD-OFIC IN DBE-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM BUS-OFI.
           MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN DBE-FLD.
       GET-FRM-GLS-TCLI.
           MOVE 'DGC' TO TAB-COD-SIST.
           MOVE 'TCL' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-TCLI IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TCLI IN DBE-FLD.
       GET-FRM-GLS-BLOC.
           MOVE 'DGC' TO TAB-COD-SIST.
           MOVE 'BLO' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-BLOC IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-BLOC IN DBE-FLD.
       GET-FRM-GLS-ODSE.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ODS' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-ODSE IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ODSE IN DBE-FLD.
       GET-FRM-GLS-ACTI.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ACT' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-ACTI IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ACTI IN DBE-FLD.
       GET-FRM-GLS-EJEC.
           MOVE DBE-COD-EJEC IN DBE-FLD TO USR-COD-USER IN USR.
           PERFORM BUS-USR.
           MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN DBE-FLD.
       GET-FRM-GLS-CATE.
           MOVE 'DGC' TO MSC-COD-SIST.
           MOVE 'CATE' TO MSC-COD-TMSC IN MSC.
           MOVE DBE-IND-CATE IN DBE-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-CATE IN DBE-FLD.
       GET-FRM-GLS-SCLI.
           MOVE 'DGC' TO MSC-COD-SIST.
           MOVE 'SCLI' TO MSC-COD-TMSC IN MSC.
           MOVE DBE-IND-SCLI IN DBE-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-SCLI IN DBE-FLD.
       GET-FRM-GLS-TEMP.
           MOVE 'DGC' TO MSC-COD-SIST.
           MOVE 'TEMP' TO MSC-COD-TMSC IN MSC.
           MOVE DBE-IND-TEMP IN DBE-FLD TO MSC-COD-CMSC IN MSC.
           PERFORM BUS-MSC.
           MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TEMP IN DBE-FLD.
      * GET-DBE-IND-ERCC.
      *LJV Ir a 'RCC' y ver si existe RCC con este RUT ( GET FIRST ? )
      *     MOVE DBE-COD-RUTC IN DBE-FLD TO RCC-COD-RUTC IN RCC.
      *     MOVE DBE-IND-RUTC IN DBE-FLD TO RCC-IND-RUTC IN RCC.
      *     MOVE DBE-GLS-RUTC IN DBE-FLD TO RCC-GLS-RUTC IN RCC.
      *     MOVE FIO-GET-KEY-FST TO FIO-CMND.
      * LUP-GET-DBE-IND-ERCC.
      *     PERFORM DGC-FIO-RCC.
      *     IF NOT FIO-STAT-OKS
      *         MOVE 'N' TO DBE-IND-ERCC IN DBE-FLD
      *         GO TO GET-DBE-IND-ACCI.
      *     IF RCC-COD-RUTC IN RCC = DBE-COD-RUTC IN DBE-FLD AND
      *        RCC-IND-RUTC IN RCC = DBE-IND-RUTC IN DBE-FLD AND
      *        RCC-GLS-RUTC IN RCC = DBE-GLS-RUTC IN DBE-FLD
      *         IF RCC-IND-VIGE IN RCC = 'N'
      *             MOVE FIO-GET-KEY-NXT TO FIO-CMND
      *             PERFORM DGC-FIO-RCC
      *             GO TO LUP-GET-DBE-IND-ERCC
      *         ELSE
      *             MOVE 'S' TO DBE-IND-ERCC IN DBE-FLD
      *     ELSE
      *         MOVE 'N' TO DBE-IND-ERCC IN DBE-FLD.
       GET-FRM-IND-ERCC.
      *JSS Reprogramado para VSAM
           MOVE SPACES TO REC-COD-RELA IN REC.
           MOVE DBE-COD-RUTC IN DBE-FLD TO REC-COD-RUTC IN REC.
           MOVE DBE-IND-RUTC IN DBE-FLD TO REC-IND-RUTC IN REC.
           MOVE DBE-GLS-RUTC IN DBE-FLD TO REC-GLS-RUTC IN REC.
           MOVE FIO-GET-NLS TO FIO-CMND.
       LUP-GET-FRM-IND-ERCC.
           PERFORM DGC-FIO-REC.
           IF NOT FIO-STAT-OKS
               MOVE 'N' TO FRM-IND-ERCC IN DBE-FLD
               GO TO GET-FRM-IND-ACCI.
           IF REC-COD-RUTC IN REC = DBE-COD-RUTC IN DBE-FLD AND
              REC-IND-RUTC IN REC = DBE-IND-RUTC IN DBE-FLD AND
              REC-GLS-RUTC IN REC = DBE-GLS-RUTC IN DBE-FLD
               IF REC-IND-VIGE IN REC = 'N'
                   MOVE FIO-GET-NXT TO FIO-CMND
                   GO TO LUP-GET-FRM-IND-ERCC
               ELSE
                   MOVE 'S' TO FRM-IND-ERCC IN DBE-FLD
           ELSE
               MOVE 'N' TO FRM-IND-ERCC IN DBE-FLD.
           MOVE FIO-END-BRW TO FIO-CMND.
           PERFORM DGC-FIO-REC.
      * GET-DBE-IND-ACCI.
      *LJV   Ir a 'RCC' y ver si existe RCC con este RUT y
      *      Tipo Relacion correspondiente a ACCIONISTA ?
      *     MOVE 'USR' TO USR-COD-USER IN USR.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM TAB-FIO-USR.
      *     IF NOT FIO-STAT-OKS
      *JSS     No existe RUT del Usuario
      *         MOVE SPACES TO DBE-IND-ACCI IN DBE-FLD
      *         GO TO FIN-PUT-ALL.
      *     MOVE DBE-COD-RUTC IN DBE-FLD TO RCC-COD-RUTC IN RCC.
      *     MOVE DBE-IND-RUTC IN DBE-FLD TO RCC-IND-RUTC IN RCC.
      *     MOVE DBE-GLS-RUTC IN DBE-FLD TO RCC-GLS-RUTC IN RCC.
      *     MOVE USR-COD-RUTU IN USR     TO RCC-COD-RUTR IN RCC.
      *     MOVE USR-IND-RUTU IN USR     TO RCC-IND-RUTR IN RCC.
      *     MOVE USR-GLS-RUTU IN USR     TO RCC-GLS-RUTR IN RCC.
      *     MOVE '99'                    TO RCC-COD-TRCC IN RCC.
      *     MOVE 'N' TO DBE-IND-ACCI IN DBE-FLD.
      *     PERFORM BUS-IACC VARYING I FROM 1 BY 1 UNTIL I > 99 OR
      *             NOT FIO-STAT-OKS OR DBE-IND-ACCI IN DBE-FLD = 'S'.
       GET-FRM-IND-ACCI.
      *JSS Reprogramado para VSAM
           MOVE 'USR' TO USR-COD-USER IN USR.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM TAB-FIO-USR.
           IF NOT FIO-STAT-OKS
      *JSS     No existe RUT del Usuario
               MOVE SPACES TO FRM-IND-ACCI IN DBE-FLD
               GO TO FIN-PUT-ALL.
           MOVE DBE-COD-RUTC IN DBE-FLD TO REC-COD-RUTC IN REC.
           MOVE DBE-IND-RUTC IN DBE-FLD TO REC-IND-RUTC IN REC.
           MOVE DBE-GLS-RUTC IN DBE-FLD TO REC-GLS-RUTC IN REC.
           MOVE USR-COD-RUTU IN USR     TO REC-COD-RUTR IN REC.
           MOVE USR-IND-RUTU IN USR     TO REC-IND-RUTR IN REC.
           MOVE USR-GLS-RUTU IN USR     TO REC-GLS-RUTR IN REC.
           MOVE '99'                    TO REC-COD-TRCC IN REC.
           MOVE 'N' TO FRM-IND-ACCI IN DBE-FLD.
           PERFORM BUS-IACC VARYING I FROM 1 BY 1 UNTIL I > 99 OR
                   NOT FIO-STAT-OKS OR FRM-IND-ACCI IN DBE-FLD = 'S'.
       FIN-PUT-ALL.
           EXIT.
       PUT-DBE SECTION.
       INI-PUT-DBE.
           MOVE DBE-GLS-NOMC IN DBE TO DBE-GLS-NOMC IN DBE-FLD.
           MOVE DBE-IND-RUTC IN DBE TO DBE-IND-RUTC IN DBE-FLD.
           MOVE DBE-GLS-RUTC IN DBE TO DBE-GLS-RUTC IN DBE-FLD.
           MOVE DBE-COD-RUTC IN DBE TO DBE-COD-RUTC IN DBE-FLD.
           MOVE DBE-VRF-RUTC IN DBE TO DBE-VRF-RUTC IN DBE-FLD.
           MOVE DBE-COD-TSOC IN DBE TO DBE-COD-TSOC IN DBE-FLD.
           MOVE DBE-GLS-NFAN IN DBE TO DBE-GLS-NFAN IN DBE-FLD.
           MOVE DBE-GLS-DIRE IN DBE TO DBE-GLS-DIRE IN DBE-FLD.
           MOVE DBE-NUM-TDIR IN DBE TO DBE-NUM-TDIR IN DBE-FLD.
           MOVE DBE-COD-LUGA IN DBE TO DBE-COD-LUGA IN DBE-FLD.
           MOVE DBE-GLS-FONO IN DBE TO DBE-GLS-FONO IN DBE-FLD.
           MOVE DBE-NUM-DCOR IN DBE TO DBE-NUM-DCOR IN DBE-FLD.
           MOVE DBE-COD-OFIC IN DBE TO DBE-COD-OFIC IN DBE-FLD.
           MOVE DBE-COD-TCLI IN DBE TO DBE-COD-TCLI IN DBE-FLD.
           MOVE DBE-COD-EJEC IN DBE TO DBE-COD-EJEC IN DBE-FLD.
           MOVE DBE-IND-OOFI IN DBE TO DBE-IND-OOFI IN DBE-FLD.
           MOVE DBE-COD-BLOC IN DBE TO DBE-COD-BLOC IN DBE-FLD.
           MOVE DBE-COD-ODSE IN DBE TO DBE-COD-ODSE IN DBE-FLD.
           MOVE DBE-COD-ACTI IN DBE TO DBE-COD-ACTI IN DBE-FLD.
           MOVE DBE-IND-CATE IN DBE TO DBE-IND-CATE IN DBE-FLD.
           MOVE DBE-NUM-DCTT IN DBE TO DBE-NUM-DCTT IN DBE-FLD.
           MOVE DBE-NUM-MCTT IN DBE TO DBE-NUM-MCTT IN DBE-FLD.
           MOVE DBE-NUM-SCTT IN DBE TO DBE-NUM-SCTT IN DBE-FLD.
           MOVE DBE-NUM-ACTT IN DBE TO DBE-NUM-ACTT IN DBE-FLD.
           MOVE DBE-IND-CMOS IN DBE TO DBE-IND-CMOS IN DBE-FLD.
           MOVE DBE-NUM-DCAD IN DBE TO DBE-NUM-DCAD IN DBE-FLD.
           MOVE DBE-NUM-MCAD IN DBE TO DBE-NUM-MCAD IN DBE-FLD.
           MOVE DBE-NUM-SCAD IN DBE TO DBE-NUM-SCAD IN DBE-FLD.
           MOVE DBE-NUM-ACAD IN DBE TO DBE-NUM-ACAD IN DBE-FLD.
           MOVE DBE-NUM-DUME IN DBE TO DBE-NUM-DUME IN DBE-FLD.
           MOVE DBE-NUM-MUME IN DBE TO DBE-NUM-MUME IN DBE-FLD.
           MOVE DBE-NUM-SUME IN DBE TO DBE-NUM-SUME IN DBE-FLD.
           MOVE DBE-NUM-AUME IN DBE TO DBE-NUM-AUME IN DBE-FLD.
           MOVE DBE-IND-SCLI IN DBE TO DBE-IND-SCLI IN DBE-FLD.
           MOVE DBE-IND-RAUT IN DBE TO DBE-IND-RAUT IN DBE-FLD.
           MOVE DBE-IND-TEMP IN DBE TO DBE-IND-TEMP IN DBE-FLD.
           MOVE DBE-NUM-TCMT IN DBE TO DBE-NUM-TCMT IN DBE-FLD.
           MOVE DBE-NUM-DUMO IN DBE TO DBE-NUM-DUMO IN DBE-FLD.
           MOVE DBE-NUM-MUMO IN DBE TO DBE-NUM-MUMO IN DBE-FLD.
           MOVE DBE-NUM-SUMO IN DBE TO DBE-NUM-SUMO IN DBE-FLD.
           MOVE DBE-NUM-AUMO IN DBE TO DBE-NUM-AUMO IN DBE-FLD.
       FIN-PUT-DBE.
           EXIT.
       RET-ALL SECTION.
       INI-RET-ALL.
           PERFORM RET-DBE.
           MOVE 1 TO DBE-NUM-DDOM IN DBE.
       FIN-RET-ALL.
           EXIT.
       RET-DBE SECTION.
       INI-RET-DBE.
           MOVE DBE-GLS-NOMC IN DBE-FLD TO DBE-GLS-NOMC IN DBE.
           MOVE DBE-IND-RUTC IN DBE-FLD TO DBE-IND-RUTC IN DBE.
           MOVE DBE-GLS-RUTC IN DBE-FLD TO DBE-GLS-RUTC IN DBE.
           MOVE DBE-COD-RUTC IN DBE-FLD TO DBE-COD-RUTC IN DBE.
           MOVE DBE-VRF-RUTC IN DBE-FLD TO DBE-VRF-RUTC IN DBE.
           MOVE DBE-COD-TSOC IN DBE-FLD TO DBE-COD-TSOC IN DBE.
           MOVE DBE-GLS-NFAN IN DBE-FLD TO DBE-GLS-NFAN IN DBE.
           MOVE DBE-GLS-DIRE IN DBE-FLD TO DBE-GLS-DIRE IN DBE.
           MOVE DBE-NUM-TDIR IN DBE-FLD TO DBE-NUM-TDIR IN DBE.
           MOVE DBE-COD-LUGA IN DBE-FLD TO DBE-COD-LUGA IN DBE.
           MOVE DBE-GLS-FONO IN DBE-FLD TO DBE-GLS-FONO IN DBE.
           MOVE DBE-NUM-DCOR IN DBE-FLD TO DBE-NUM-DCOR IN DBE.
           MOVE DBE-COD-OFIC IN DBE-FLD TO DBE-COD-OFIC IN DBE.
           MOVE DBE-COD-TCLI IN DBE-FLD TO DBE-COD-TCLI IN DBE.
           MOVE DBE-COD-EJEC IN DBE-FLD TO DBE-COD-EJEC IN DBE.
           MOVE DBE-IND-OOFI IN DBE-FLD TO DBE-IND-OOFI IN DBE.
           MOVE DBE-COD-BLOC IN DBE-FLD TO DBE-COD-BLOC IN DBE.
           MOVE DBE-COD-ODSE IN DBE-FLD TO DBE-COD-ODSE IN DBE.
           MOVE DBE-COD-ACTI IN DBE-FLD TO DBE-COD-ACTI IN DBE.
           MOVE DBE-IND-CATE IN DBE-FLD TO DBE-IND-CATE IN DBE.
           MOVE DBE-NUM-DCTT IN DBE-FLD TO DBE-NUM-DCTT IN DBE.
           MOVE DBE-NUM-MCTT IN DBE-FLD TO DBE-NUM-MCTT IN DBE.
           MOVE DBE-NUM-SCTT IN DBE-FLD TO DBE-NUM-SCTT IN DBE.
           MOVE DBE-NUM-ACTT IN DBE-FLD TO DBE-NUM-ACTT IN DBE.
           MOVE DBE-IND-CMOS IN DBE-FLD TO DBE-IND-CMOS IN DBE.
           MOVE DBE-NUM-DCAD IN DBE-FLD TO DBE-NUM-DCAD IN DBE.
           MOVE DBE-NUM-MCAD IN DBE-FLD TO DBE-NUM-MCAD IN DBE.
           MOVE DBE-NUM-SCAD IN DBE-FLD TO DBE-NUM-SCAD IN DBE.
           MOVE DBE-NUM-ACAD IN DBE-FLD TO DBE-NUM-ACAD IN DBE.
           MOVE DBE-NUM-DUME IN DBE-FLD TO DBE-NUM-DUME IN DBE.
           MOVE DBE-NUM-MUME IN DBE-FLD TO DBE-NUM-MUME IN DBE.
           MOVE DBE-NUM-SUME IN DBE-FLD TO DBE-NUM-SUME IN DBE.
           MOVE DBE-NUM-AUME IN DBE-FLD TO DBE-NUM-AUME IN DBE.
           MOVE DBE-IND-SCLI IN DBE-FLD TO DBE-IND-SCLI IN DBE.
           MOVE DBE-IND-RAUT IN DBE-FLD TO DBE-IND-RAUT IN DBE.
           MOVE DBE-IND-TEMP IN DBE-FLD TO DBE-IND-TEMP IN DBE.
           MOVE DBE-NUM-TCMT IN DBE-FLD TO DBE-NUM-TCMT IN DBE.
           MOVE DBE-NUM-DUMO IN DBE-FLD TO DBE-NUM-DUMO IN DBE.
           MOVE DBE-NUM-MUMO IN DBE-FLD TO DBE-NUM-MUMO IN DBE.
           MOVE DBE-NUM-SUMO IN DBE-FLD TO DBE-NUM-SUMO IN DBE.
           MOVE DBE-NUM-AUMO IN DBE-FLD TO DBE-NUM-AUMO IN DBE.
       FIN-RET-DBE.
           EXIT.
       SCR-CLRA SECTION.
       INI-SCR-CLRA.
           PERFORM CLR-KEY.
           PERFORM CLR-FLD.
       FIN-SCR-CLRA.
           EXIT.
       CLR-KEY SECTION.
       INI-CLR-KEY.
           MOVE SPACES TO DBE-GLS-NOMC IN DBE-FLD.
           MOVE SPACES TO DBE-IND-RUTC IN DBE-FLD.
           MOVE SPACES TO DBE-GLS-RUTC IN DBE-FLD.
           MOVE SPACES TO DBE-COD-RUTC IN DBE-FLD.
           MOVE SPACES TO DBE-VRF-RUTC IN DBE-FLD.
       FIN-CLR-KEY.
           EXIT.
       CLR-FLD SECTION.
       INI-CLR-FLD.
           MOVE SPACES TO DBE-COD-TSOC IN DBE-FLD.
           MOVE SPACES TO DBE-GLS-NFAN IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-TSOC IN DBE-FLD.
           MOVE SPACES TO DBE-GLS-DIRE IN DBE-FLD.
           MOVE ZEROES TO DBE-NUM-TDIR IN DBE-FLD.
           MOVE SPACES TO DBE-COD-LUGA IN DBE-FLD.
           MOVE SPACES TO DBE-GLS-FONO IN DBE-FLD.
           MOVE ZEROES TO DBE-NUM-DCOR IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-LUGA IN DBE-FLD.
           MOVE SPACES TO DBE-COD-OFIC IN DBE-FLD.
           MOVE SPACES TO DBE-COD-TCLI IN DBE-FLD.
           MOVE SPACES TO DBE-COD-EJEC IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-OFIC IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-TCLI IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-EJEC IN DBE-FLD.
           MOVE SPACES TO DBE-IND-OOFI IN DBE-FLD.
           MOVE SPACES TO DBE-COD-BLOC IN DBE-FLD.
           MOVE SPACES TO DBE-COD-ODSE IN DBE-FLD.
           MOVE SPACES TO DBE-COD-ACTI IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-BLOC IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-ODSE IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-ACTI IN DBE-FLD.
           MOVE SPACES TO DBE-IND-CATE IN DBE-FLD.
           MOVE ZEROES TO DBE-FEC-FCTT IN DBE-FLD.
           MOVE SPACES TO DBE-IND-CMOS IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-CATE IN DBE-FLD.
           MOVE ZEROES TO DBE-FEC-FCAD IN DBE-FLD.
           MOVE ZEROES TO DBE-FEC-FUME IN DBE-FLD.
           MOVE SPACES TO DBE-IND-SCLI IN DBE-FLD.
           MOVE SPACES TO DBE-IND-RAUT IN DBE-FLD.
           MOVE SPACES TO DBE-IND-TEMP IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-SCLI IN DBE-FLD.
           MOVE ZEROES TO DBE-NUM-TCMT IN DBE-FLD.
           MOVE SPACES TO FRM-GLS-TEMP IN DBE-FLD.
           MOVE SPACES TO FRM-IND-ERCC IN DBE-FLD.
           MOVE SPACES TO FRM-IND-ACCI IN DBE-FLD.
           MOVE ZEROES TO DBE-FEC-FUMO IN DBE-FLD.
       FIN-CLR-FLD.
           EXIT.
       KEY-ALL SECTION.
       INI-KEY-ALL.
           PERFORM KEY-DBE.
           MOVE 1 TO DBE-NUM-DDOM IN DBE.
       FIN-KEY-ALL.
           EXIT.
       KEY-DBE SECTION.
       INI-KEY-DBE.
           MOVE DBE-GLS-NOMC IN DBE-FLD TO DBE-GLS-NOMC IN DBE.
           MOVE DBE-IND-RUTC IN DBE-FLD TO DBE-IND-RUTC IN DBE.
           MOVE DBE-GLS-RUTC IN DBE-FLD TO DBE-GLS-RUTC IN DBE.
           MOVE DBE-COD-RUTC IN DBE-FLD TO DBE-COD-RUTC IN DBE.
           MOVE DBE-VRF-RUTC IN DBE-FLD TO DBE-VRF-RUTC IN DBE.
       FIN-KEY-DBE.
           EXIT.
       FST-KEY SECTION.
       INI-FST-KEY.
           MOVE -1 TO DBE-COD-RUTC-LEN.
       FIN-FST-KEY.
           EXIT.
       FST-FLD SECTION.
       INI-FST-FLD.
           MOVE -1 TO DBE-GLS-NOMC-LEN.
       FIN-FST-FLD.
           EXIT.
       PRO-KEY SECTION.
       INI-PRO-KEY.
           PERFORM PRO-IKY.
           PERFORM PRO-AKY.
           PERFORM PRO-MKY.
       FIN-PRO-KEY.
           EXIT.
       PRO-IKY SECTION.
       INI-PRO-IKY.
           MOVE FRM-CPIM-AEY TO DBE-IND-RUTC-ATR.
           MOVE FRM-CPIM-AEY TO DBE-GLS-RUTC-ATR.
           MOVE FRM-CPIM-AEY TO DBE-COD-RUTC-ATR.
           MOVE FRM-CPIM-AEY TO DBE-VRF-RUTC-ATR.
       FIN-PRO-IKY.
           EXIT.
       PRO-AKY SECTION.
       INI-PRO-AKY.
       FIN-PRO-AKY.
           EXIT.
       PRO-MKY SECTION.
       INI-PRO-MKY.
           MOVE FRM-CPIM-AEY TO DBE-GLS-NOMC-ATR.
       FIN-PRO-MKY.
           EXIT.
       UNP-KEY SECTION.
       INI-UNP-KEY.
           PERFORM UNP-IKY.
           PERFORM UNP-AKY.
           PERFORM UNP-MKY.
       FIN-UNP-KEY.
           EXIT.
       UNP-IKY SECTION.
       INI-UNP-IKY.
           MOVE FRM-CPIM-UBY TO DBE-IND-RUTC-ATR.
           MOVE FRM-CPIM-UBY TO DBE-GLS-RUTC-ATR.
           MOVE FRM-CPIM-UBY TO DBE-COD-RUTC-ATR.
           MOVE FRM-CPIM-UBY TO DBE-VRF-RUTC-ATR.
       FIN-UNP-IKY.
           EXIT.
       UNP-MKY SECTION.
       INI-UNP-MKY.
           MOVE FRM-CPIM-UBY TO DBE-GLS-NOMC-ATR.
       FIN-UNP-MKY.
           EXIT.
       UNP-AKY SECTION.
       INI-UNP-AKY.
       FIN-UNP-AKY.
           EXIT.
       PRO-FLD SECTION.
       INI-PRO-FLD.
           MOVE FRM-CPIM-AEY TO DBE-COD-TSOC-ATR.
           MOVE FRM-CPIM-AEY TO DBE-GLS-NFAN-ATR.
           MOVE FRM-CPIM-AEY TO DBE-GLS-DIRE-ATR.
           MOVE FRM-CPIM-AEY TO DBE-COD-LUGA-ATR.
           MOVE FRM-CPIM-AEY TO DBE-GLS-FONO-ATR.
           MOVE FRM-CPIM-AEY TO DBE-NUM-DCOR-ATR.
           MOVE FRM-CPIM-AEY TO DBE-COD-OFIC-ATR.
           MOVE FRM-CPIM-AEY TO DBE-COD-TCLI-ATR.
           MOVE FRM-CPIM-AEY TO DBE-COD-EJEC-ATR.
           MOVE FRM-CPIM-AEY TO DBE-IND-OOFI-ATR.
           MOVE FRM-CPIM-AEY TO DBE-COD-BLOC-ATR.
           MOVE FRM-CPIM-AEY TO DBE-COD-ODSE-ATR.
           MOVE FRM-CPIM-AEY TO DBE-COD-ACTI-ATR.
           MOVE FRM-CPIM-AEY TO DBE-IND-CATE-ATR.
           MOVE FRM-CPIM-AEY TO DBE-FEC-FCTT-ATR.
           MOVE FRM-CPIM-AEY TO DBE-IND-CMOS-ATR.
           MOVE FRM-CPIM-AEY TO DBE-FEC-FCAD-ATR.
           MOVE FRM-CPIM-AEY TO DBE-FEC-FUME-ATR.
           MOVE FRM-CPIM-AEY TO DBE-IND-SCLI-ATR.
           MOVE FRM-CPIM-AEY TO DBE-IND-RAUT-ATR.
           MOVE FRM-CPIM-AEY TO DBE-IND-TEMP-ATR.
       FIN-PRO-FLD.
           EXIT.
       UNP-FLD SECTION.
       INI-UNP-FLD.
           MOVE FRM-CPIM-UBY TO DBE-COD-TSOC-ATR.
           MOVE FRM-CPIM-UBY TO DBE-GLS-NFAN-ATR.
           MOVE FRM-CPIM-UBY TO DBE-GLS-DIRE-ATR.
           MOVE FRM-CPIM-UBY TO DBE-COD-LUGA-ATR.
           MOVE FRM-CPIM-UBY TO DBE-GLS-FONO-ATR.
           MOVE FRM-CPIM-UBY TO DBE-NUM-DCOR-ATR.
           MOVE FRM-CPIM-UBY TO DBE-COD-OFIC-ATR.
           MOVE FRM-CPIM-UBY TO DBE-COD-TCLI-ATR.
           MOVE FRM-CPIM-UBY TO DBE-COD-EJEC-ATR.
           MOVE FRM-CPIM-UBY TO DBE-IND-OOFI-ATR.
           MOVE FRM-CPIM-UBY TO DBE-COD-BLOC-ATR.
           MOVE FRM-CPIM-UBY TO DBE-COD-ODSE-ATR.
           MOVE FRM-CPIM-UBY TO DBE-COD-ACTI-ATR.
           MOVE FRM-CPIM-UBY TO DBE-IND-CATE-ATR.
           MOVE FRM-CPIM-UBY TO DBE-FEC-FCTT-ATR.
           MOVE FRM-CPIM-UBY TO DBE-IND-CMOS-ATR.
           MOVE FRM-CPIM-UBY TO DBE-FEC-FCAD-ATR.
           MOVE FRM-CPIM-UBY TO DBE-FEC-FUME-ATR.
           MOVE FRM-CPIM-UBY TO DBE-IND-SCLI-ATR.
           MOVE FRM-CPIM-UBY TO DBE-IND-RAUT-ATR.
           MOVE FRM-CPIM-UBY TO DBE-IND-TEMP-ATR.
       FIN-UNP-FLD.
           EXIT.
       VAL-IKY SECTION.
       INI-VAL-IKY.
           PERFORM VAL-DBE-IND-RUTC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               SUBTRACT 1 FROM FRM-IFLD
               MOVE -1 TO DBE-IND-RUTC-LEN
               GO TO FIN-VAL-IKY.
           PERFORM VAL-DBE-GLS-RUTC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               SUBTRACT 1 FROM FRM-IFLD
               MOVE -1 TO DBE-GLS-RUTC-LEN
               GO TO FIN-VAL-IKY.
           PERFORM VAL-DBE-COD-RUTC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               SUBTRACT 1 FROM FRM-IFLD
               MOVE -1 TO DBE-COD-RUTC-LEN
               GO TO FIN-VAL-IKY.
           PERFORM VAL-DBE-VRF-RUTC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               SUBTRACT 1 FROM FRM-IFLD
               MOVE -1 TO DBE-VRF-RUTC-LEN
               GO TO FIN-VAL-IKY.
       FIN-VAL-IKY.
           EXIT.
       VAL-MKY SECTION.
       INI-VAL-MKY.
           PERFORM VAL-DBE-GLS-NOMC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-GLS-NOMC-LEN
               GO TO FIN-VAL-MKY.
       FIN-VAL-MKY.
           EXIT.
       VAL-AKY SECTION.
       INI-VAL-AKY.
       FIN-VAL-AKY.
           EXIT.
       VAL-FLD SECTION.
       INI-VAL-FLD.
           PERFORM VAL-DBE-COD-TSOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-COD-TSOC-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-GLS-NFAN.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-GLS-NFAN-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-GLS-DIRE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-GLS-DIRE-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-COD-LUGA.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-COD-LUGA-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-GLS-FONO.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-GLS-FONO-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-NUM-DCOR.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-NUM-DCOR-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-COD-OFIC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-COD-OFIC-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-COD-TCLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-COD-TCLI-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-COD-EJEC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-COD-EJEC-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-IND-OOFI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-IND-OOFI-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-COD-BLOC.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-COD-BLOC-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-COD-ODSE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-COD-ODSE-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-COD-ACTI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-COD-ACTI-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-IND-CATE.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-IND-CATE-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-FEC-FCTT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-FEC-FCTT-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-IND-CMOS.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-IND-CMOS-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-FEC-FCAD.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-FEC-FCAD-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-FEC-FUME.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-FEC-FUME-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-IND-SCLI.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-IND-SCLI-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-IND-RAUT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-IND-RAUT-LEN
               GO TO FIN-VAL-FLD.
           PERFORM VAL-DBE-IND-TEMP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
               MOVE -1 TO DBE-IND-TEMP-LEN
               GO TO FIN-VAL-FLD.
       FIN-VAL-FLD.
           EXIT.
       VAL-DBE-GLS-NOMC SECTION.
       INI-VAL-DBE-GLS-NOMC.
           IF DBE-GLS-NOMC IN DBE-FLD NOT > SPACES AND
              SCR-INST = SCR-INST-GFL
               PERFORM ERR-GLS.
       FIN-VAL-DBE-GLS-NOMC.
           EXIT.
       VAL-DBE-IND-RUTC SECTION.
       INI-VAL-DBE-IND-RUTC.
           MOVE DBE-IND-RUTC IN DBE-FLD TO IDC-IND-RUTV.
           PERFORM VAL-IDC.
       FIN-VAL-DBE-IND-RUTC.
           EXIT.
       VAL-DBE-GLS-RUTC SECTION.
       INI-VAL-DBE-GLS-RUTC.
           MOVE DBE-GLS-RUTC IN DBE-FLD TO IDC-GLS-RUTV.
           PERFORM VAL-GLS.
       FIN-VAL-DBE-GLS-RUTC.
           EXIT.
       VAL-DBE-COD-RUTC SECTION.
       INI-VAL-DBE-COD-RUTC.
       FIN-VAL-DBE-COD-RUTC.
           EXIT.
       VAL-DBE-VRF-RUTC SECTION.
       INI-VAL-DBE-VRF-RUTC.
      *JSS MOVE DBE-COD-RUTC IN DBE-FLD TO IDC-COD-RUTV.
           MOVE DBE-COD-RUTC IN DBE-FLD TO IDC-NUM-RUTV.
           MOVE DBE-VRF-RUTC IN DBE-FLD TO IDC-VRF-RUTV.
           PERFORM VAL-RUT.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO FIN-VAL-DBE-VRF-RUTC.
           MOVE IDC-NUM-RUTV TO DBE-COD-RUTC IN DBE-FLD.
           IF NOT ( SCR-CCPP = 'ING' OR SCR-CCPP = 'ACT' )
               GO TO FIN-VAL-DBE-VRF-RUTC.
           MOVE DBE-COD-RUTC IN DBE-FLD TO DBC-COD-RUTC IN DBC.
           MOVE DBE-IND-RUTC IN DBE-FLD TO DBC-IND-RUTC IN DBC.
           MOVE DBE-GLS-RUTC IN DBE-FLD TO DBC-GLS-RUTC IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DGC-FIO-DBC.
           IF FIO-STAT-OKS
               IF NOT ( DBC-IND-TCLI IN DBC = 'E' )
                   MOVE 'TAB' TO MSG-COD-SIST
                   MOVE 'CLI    PER' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-DBE-VRF-RUTC.
           EXIT.
       VAL-DBE-COD-TSOC SECTION.
       INI-VAL-DBE-COD-TSOC.
           MOVE 'DGC' TO TAB-COD-SIST.
           MOVE 'SOC' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-TSOC IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS IN MSG NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TSOC IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TSOC IN DBE-FLD.
       FIN-VAL-DBE-COD-TSOC.
           EXIT.
       VAL-DBE-GLS-NFAN SECTION.
       INI-VAL-DBE-GLS-NFAN.
       FIN-VAL-DBE-GLS-NFAN.
           EXIT.
       VAL-DBE-GLS-DIRE SECTION.
       INI-VAL-DBE-GLS-DIRE.
           IF DBE-GLS-DIRE IN DBE-FLD NOT > SPACES
               PERFORM ERR-GLS.
       FIN-VAL-DBE-GLS-DIRE.
           EXIT.
       VAL-DBE-COD-LUGA SECTION.
       INI-VAL-DBE-COD-LUGA.
           MOVE DBE-COD-LUGA IN DBE-FLD TO WSS-COD-LUGA.
           IF WSS-IND-PAIS = 'P'
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'PAI' TO TAB-COD-TTAB IN TAB
               MOVE WSS-COD-PAIS TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS IN MSG NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN DBE-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-LUGA IN DBE-FLD
           ELSE
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'COM' TO TAB-COD-TTAB IN TAB
               MOVE DBE-COD-LUGA IN DBE-FLD TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               IF MSG-COD-MENS IN MSG NOT = 'COD    NEX'
                   MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-LUGA IN DBE-FLD
               ELSE
                   MOVE SPACES TO FRM-GLS-LUGA IN DBE-FLD.
       FIN-VAL-DBE-COD-LUGA.
           EXIT.
       VAL-DBE-GLS-FONO SECTION.
       INI-VAL-DBE-GLS-FONO.
       FIN-VAL-DBE-GLS-FONO.
           EXIT.
       VAL-DBE-NUM-DCOR SECTION.
       INI-VAL-DBE-NUM-DCOR.
           MOVE NUM-ZERO-N TO NUM-ZERO.
           MOVE DBE-NUM-DCOR IN DBE-FLD TO NUM-NUME.
           PERFORM VAL-NUM.
           IF MSG-COD-MENS NOT = SPACES
               GO TO FIN-VAL-DBE-NUM-DCOR.
           MOVE NUM-NUME TO DBE-NUM-DCOR IN DBE-FLD.
      *JSS  IF SCR-CCPP = 'MOD' OR ( SCR-CCPP = 'ACT' AND
      *                              SCR-ACTU = SCR-ACTU-MOD )
      *         MOVE DBE-COD-RUTC IN DBE-FLD TO DIR-COD-RUTC IN DIR
      *         MOVE DBE-IND-RUTC IN DBE-FLD TO DIR-IND-RUTC IN DIR
      *         MOVE DBE-GLS-RUTC IN DBE-FLD TO DIR-GLS-RUTC IN DIR
      *         MOVE DBE-NUM-DCOR IN DBE-FLD TO DIR-NUM-DIRE IN DIR
      *         MOVE FIO-GET-KEY TO FIO-CMND
      *         PERFORM DGC-FIO-DIR
      *         IF NOT FIO-STAT-OKS
      *             MOVE 'DGC' TO MSG-COD-SIST
      *             MOVE 'NUMDCORNEX  ' TO MSG-COD-MENS
      *             PERFORM GET-MSG
      *             MOVE MSG-GLS-DESC TO FRM-MENS
      *             MOVE FRM-SUAR-MAL TO FRM-SUAR
      *             GO TO FIN-VAL-DBE-NUM-DCOR.
           IF SCR-CCPP = 'MOD' OR ( SCR-CCPP = 'ACT' AND
                                    SCR-ACTU = SCR-ACTU-MOD )
               MOVE DBE-COD-RUTC IN DBE-FLD TO RCD-COD-RUTC IN RCD
               MOVE DBE-IND-RUTC IN DBE-FLD TO RCD-IND-RUTC IN RCD
               MOVE DBE-GLS-RUTC IN DBE-FLD TO RCD-GLS-RUTC IN RCD
               MOVE DBE-NUM-DCOR IN DBE-FLD TO RCD-NUM-DIRE IN RCD
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM DGC-FIO-RCD
               IF NOT FIO-STAT-OKS
                   MOVE 'DGC' TO MSG-COD-SIST
                   MOVE 'NUMDCORNEX  ' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-DBE-NUM-DCOR.
       FIN-VAL-DBE-NUM-DCOR.
           EXIT.
       VAL-DBE-COD-OFIC SECTION.
       INI-VAL-DBE-COD-OFIC.
           MOVE DBE-COD-OFIC IN DBE-FLD TO OFI-COD-OFIC IN OFI.
           PERFORM VAL-OFI.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE OFI-GLS-DESC IN OFI TO FRM-GLS-OFIC IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-OFIC IN DBE-FLD.
       FIN-VAL-DBE-COD-OFIC.
           EXIT.
       VAL-DBE-COD-TCLI SECTION.
       INI-VAL-DBE-COD-TCLI.
           MOVE 'DGC' TO TAB-COD-SIST.
           MOVE 'TCL' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-TCLI IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS IN MSG NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-TCLI IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TCLI IN DBE-FLD.
       FIN-VAL-DBE-COD-TCLI.
           EXIT.
       VAL-DBE-COD-EJEC SECTION.
       INI-VAL-DBE-COD-EJEC.
           MOVE DBE-COD-EJEC IN DBE-FLD TO USR-COD-USER IN USR.
           PERFORM VAL-USR.
           IF MSG-COD-MENS NOT = SPACES
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE USR-GLS-DESC IN USR TO FRM-GLS-EJEC IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-EJEC IN DBE-FLD.
           IF NOT ( FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR-CLR )
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TUS' TO TAB-COD-TTAB IN TAB
               MOVE USR-COD-TUSR IN USR TO TAB-COD-CTAB IN TAB
               PERFORM VAL-COD
               MOVE TAB-GLS-DATA IN TAB TO WSS-COD-TUSR
               IF MSG-COD-MENS IN MSG = 'COD    NEX'
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'CODEJECNEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF MSG-COD-MENS IN MSG = 'COD    NVG'
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'CODEJECNVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF WSS-COD-TUSR NOT = 'EJCOM'
                   MOVE 'TAB'          TO MSG-COD-SIST
                   MOVE 'CODEJECNOEJE' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-DBE-COD-EJEC.
           EXIT.
       VAL-DBE-IND-OOFI SECTION.
       INI-VAL-DBE-IND-OOFI.
           MOVE 'DGC'  TO MSC-COD-SIST.
           MOVE 'OOFI' TO MSC-COD-TMSC.
           MOVE DBE-IND-OOFI IN DBE-FLD TO MSC-COD-CMSC.
           PERFORM VAL-IND.
       FIN-VAL-DBE-IND-OOFI.
           EXIT.
       VAL-DBE-COD-BLOC SECTION.
       INI-VAL-DBE-COD-BLOC.
           MOVE 'DGC' TO TAB-COD-SIST.
           MOVE 'BLO' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-BLOC IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS IN MSG NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-BLOC IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-BLOC IN DBE-FLD.
       FIN-VAL-DBE-COD-BLOC.
           EXIT.
       VAL-DBE-COD-ODSE SECTION.
       INI-VAL-DBE-COD-ODSE.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ODS' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-ODSE IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS IN MSG NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ODSE IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ODSE IN DBE-FLD.
       FIN-VAL-DBE-COD-ODSE.
           EXIT.
       VAL-DBE-COD-ACTI SECTION.
       INI-VAL-DBE-COD-ACTI.
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'ACT' TO TAB-COD-TTAB IN TAB.
           MOVE DBE-COD-ACTI IN DBE-FLD TO TAB-COD-CTAB IN TAB.
           PERFORM VAL-COD.
           IF MSG-COD-MENS IN MSG NOT = 'COD    NEX'
               MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-ACTI IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-ACTI IN DBE-FLD.
       FIN-VAL-DBE-COD-ACTI.
           EXIT.
       VAL-DBE-IND-CATE SECTION.
       INI-VAL-DBE-IND-CATE.
           MOVE 'DGC'  TO MSC-COD-SIST.
           MOVE 'CATE' TO MSC-COD-TMSC.
           MOVE DBE-IND-CATE IN DBE-FLD TO MSC-COD-CMSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-CATE IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CATE IN DBE-FLD.
       FIN-VAL-DBE-IND-CATE.
           EXIT.
       VAL-DBE-FEC-FCTT SECTION.
       INI-VAL-DBE-FEC-FCTT.
      *JSS Validar Fecha, Validar que sea <= hoy
      *    IF DBE-FEC-FCTT IN DBE-FLD = ZEROES OR SPACES
      *        MOVE 'GNS' TO MSG-COD-SIST
      *        MOVE 'FEC    BLK' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR.
           MOVE DBE-FEC-FCTT IN DBE-FLD TO FEC-FDMA.
           MOVE FEC-FBLK-N TO FEC-FBLK.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM VAL-FEC.
           IF NOT FEC-STAT-OKS
               GO TO FIN-VAL-DBE-FEC-FCTT.
           MOVE FEC-FDMA TO DBE-FEC-FCTT IN DBE-FLD.
           MOVE FEC-CMP-HOY TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'GNS'         TO MSG-COD-SIST
               MOVE 'FEC    >HOY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-DBE-FEC-FCTT.
           EXIT.
       VAL-DBE-IND-CMOS SECTION.
       INI-VAL-DBE-IND-CMOS.
       FIN-VAL-DBE-IND-CMOS.
           EXIT.
       VAL-DBE-FEC-FCAD SECTION.
       INI-VAL-DBE-FEC-FCAD.
      *JSS Validar Fecha
           MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE DBE-FEC-FCAD IN DBE-FLD TO FEC-FDMA.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM VAL-FEC.
           IF FEC-STAT-OKS
               MOVE FEC-FDMA TO DBE-FEC-FCAD IN DBE-FLD.
       FIN-VAL-DBE-FEC-FCAD.
           EXIT.
       VAL-DBE-FEC-FUME SECTION.
       INI-VAL-DBE-FEC-FUME.
      *JSS Validar Fecha, Validar que sea <= hoy
           MOVE DBE-FEC-FUME IN DBE-FLD TO FEC-FDMA.
           MOVE FEC-FBLK-S TO FEC-FBLK.
           MOVE FEC-VAL-FEC TO FEC-CMND.
           PERFORM VAL-FEC.
           IF NOT FEC-STAT-OKS
               GO TO FIN-VAL-DBE-FEC-FUME.
           MOVE FEC-FDMA TO DBE-FEC-FUME IN DBE-FLD.
           IF DBE-FEC-FUME IN DBE-FLD = ZEROES
               GO TO FIN-VAL-DBE-FEC-FUME.
           MOVE FEC-CMP-HOY TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'GNS'         TO MSG-COD-SIST
               MOVE 'FEC    >HOY' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-DBE-FEC-FUME.
           EXIT.
       VAL-DBE-IND-SCLI SECTION.
       INI-VAL-DBE-IND-SCLI.
           MOVE 'DGC'  TO MSC-COD-SIST.
           MOVE 'SCLI' TO MSC-COD-TMSC.
           MOVE DBE-IND-SCLI IN DBE-FLD TO MSC-COD-CMSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-SCLI IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-SCLI IN DBE-FLD.
       FIN-VAL-DBE-IND-SCLI.
           EXIT.
       VAL-DBE-IND-RAUT SECTION.
       INI-VAL-DBE-IND-RAUT.
           MOVE 'DGC'  TO MSC-COD-SIST.
           MOVE 'RAUT' TO MSC-COD-TMSC.
           MOVE DBE-IND-RAUT IN DBE-FLD TO MSC-COD-CMSC.
           PERFORM VAL-IND.
       FIN-VAL-DBE-IND-RAUT.
           EXIT.
       VAL-DBE-IND-TEMP SECTION.
       INI-VAL-DBE-IND-TEMP.
           MOVE 'DGC'  TO MSC-COD-SIST.
           MOVE 'TEMP' TO MSC-COD-TMSC.
           MOVE DBE-IND-TEMP IN DBE-FLD TO MSC-COD-CMSC.
           PERFORM VAL-IND.
           IF MSG-COD-MENS NOT = 'COD    NEX'
               MOVE MSC-GLS-DESC IN MSC TO FRM-GLS-TEMP IN DBE-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TEMP IN DBE-FLD.
       FIN-VAL-DBE-IND-TEMP.
           EXIT.
       VAL-CON-IKY SECTION.
       INI-VAL-CON-IKY.
           IF     DBE-IND-RUTC IN DBE-FLD NOT > SPACES
              AND DBE-GLS-RUTC IN DBE-FLD NOT > SPACES
              AND DBE-COD-RUTC IN DBE-FLD NOT > SPACES
              AND DBE-VRF-RUTC IN DBE-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY.
       FIN-VAL-CON-IKY.
           EXIT.
       VAL-CON-KEY SECTION.
       INI-VAL-CON-KEY.
           IF     DBE-GLS-NOMC IN DBE-FLD NOT > SPACES
              AND DBE-IND-RUTC IN DBE-FLD NOT > SPACES
              AND DBE-GLS-RUTC IN DBE-FLD NOT > SPACES
              AND DBE-COD-RUTC IN DBE-FLD NOT > SPACES
              AND DBE-VRF-RUTC IN DBE-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY.
       FIN-VAL-CON-KEY.
           EXIT.
       VAL-CON-FLD SECTION.
       INI-VAL-CON-FLD.
      *JSS
      *VAL-FUME-FCTT.
      *    IF DBE-FEC-FUME IN DBE-FLD = ZEROES
      *        GO TO VAL-FCAD-FCTT.
      *    MOVE DBE-NUM-DUME IN DBE-FLD TO WSS-NUM-DIA1.
      *    MOVE DBE-NUM-MUME IN DBE-FLD TO WSS-NUM-MES1.
      *    MOVE DBE-NUM-SUME IN DBE-FLD TO WSS-NUM-SIG1.
      *    MOVE DBE-NUM-AUME IN DBE-FLD TO WSS-NUM-ANO1.
      *    MOVE DBE-NUM-DCTT IN DBE-FLD TO WSS-NUM-DIA2.
      *    MOVE DBE-NUM-MCTT IN DBE-FLD TO WSS-NUM-MES2.
      *    MOVE DBE-NUM-SCTT IN DBE-FLD TO WSS-NUM-SIG2.
      *    MOVE DBE-NUM-ACTT IN DBE-FLD TO WSS-NUM-ANO2.
      *    IF WSS-FEC-FEC1 NOT > WSS-FEC-FEC2
      *        MOVE 'DGC' TO MSG-COD-SIST
      *        MOVE 'FECFUMEFCTT' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR
      *        GO TO FIN-VAL-CON-FLD.
      *VAL-FCAD-FCTT.
      *    IF DBE-FEC-FCAD IN DBE-FLD = ZEROES
      *        GO TO FIN-VAL-CON-FLD.
      *    MOVE DBE-NUM-DCAD IN DBE-FLD TO WSS-NUM-DIA1.
      *    MOVE DBE-NUM-MCAD IN DBE-FLD TO WSS-NUM-MES1.
      *    MOVE DBE-NUM-SCAD IN DBE-FLD TO WSS-NUM-SIG1.
      *    MOVE DBE-NUM-ACAD IN DBE-FLD TO WSS-NUM-ANO1.
      *    MOVE DBE-NUM-DCTT IN DBE-FLD TO WSS-NUM-DIA2.
      *    MOVE DBE-NUM-MCTT IN DBE-FLD TO WSS-NUM-MES2.
      *    MOVE DBE-NUM-SCTT IN DBE-FLD TO WSS-NUM-SIG2.
      *    MOVE DBE-NUM-ACTT IN DBE-FLD TO WSS-NUM-ANO2.
      *    IF WSS-FEC-FEC1 NOT > WSS-FEC-FEC2
      *        MOVE 'DGC' TO MSG-COD-SIST
      *        MOVE 'FECFCADFCTT' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *VAL-FCAD-FUME.
      *    IF DBE-FEC-FUME IN DBE-FLD = ZEROES
      *        GO TO FIN-VAL-CON-FLD.
      *    MOVE DBE-NUM-DCAD IN DBE-FLD TO WSS-NUM-DIA1.
      *    MOVE DBE-NUM-MCAD IN DBE-FLD TO WSS-NUM-MES1.
      *    MOVE DBE-NUM-SCAD IN DBE-FLD TO WSS-NUM-SIG1.
      *    MOVE DBE-NUM-ACAD IN DBE-FLD TO WSS-NUM-ANO1.
      *    MOVE DBE-NUM-DUME IN DBE-FLD TO WSS-NUM-DIA2.
      *    MOVE DBE-NUM-MUME IN DBE-FLD TO WSS-NUM-MES2.
      *    MOVE DBE-NUM-SUME IN DBE-FLD TO WSS-NUM-SIG2.
      *    MOVE DBE-NUM-AUME IN DBE-FLD TO WSS-NUM-ANO2.
      *    IF WSS-FEC-FEC1 NOT > WSS-FEC-FEC2
      *        MOVE 'DGC' TO MSG-COD-SIST
      *        MOVE 'FECFCADFUME' TO MSG-COD-MENS
      *        PERFORM GET-MSG
      *        MOVE MSG-GLS-DESC TO FRM-MENS
      *        MOVE FRM-SUAR-MAL TO FRM-SUAR.
       VAL-FUME-FCTT.
           IF DBE-FEC-FUME IN DBE-FLD = ZEROES
               GO TO VAL-FCAD-FCTT.
           MOVE DBE-FEC-FCTT IN DBE-FLD TO FEC-FEC1.
           MOVE DBE-FEC-FUME IN DBE-FLD TO FEC-FEC2.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'DGC' TO MSG-COD-SIST
               MOVE 'FECFUMEFCTT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD.
       VAL-FCAD-FCTT.
           IF DBE-FEC-FCAD IN DBE-FLD = ZEROES
               GO TO FIN-VAL-CON-FLD.
           MOVE DBE-FEC-FCTT IN DBE-FLD TO FEC-FEC1.
           MOVE DBE-FEC-FCAD IN DBE-FLD TO FEC-FEC2.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'DGC' TO MSG-COD-SIST
               MOVE 'FECFCADFCTT' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       VAL-FCAD-FUME.
           IF DBE-FEC-FUME IN DBE-FLD = ZEROES
               GO TO FIN-VAL-CON-FLD.
           MOVE DBE-FEC-FUME IN DBE-FLD TO FEC-FEC1.
           MOVE DBE-FEC-FCAD IN DBE-FLD TO FEC-FEC2.
           MOVE FEC-CMP-FEC TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-GRT
               MOVE 'DGC' TO MSG-COD-SIST
               MOVE 'FECFCADFUME' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-CON-FLD.
           EXIT.
       VAL-CON SECTION.
       INI-VAL-CON.
       FIN-VAL-CON.
           EXIT.
      * BUS-IACC SECTION.
      * INI-BUS-IACC.
      *     MOVE I TO RCC-NUM-TRCC IN RCC.
      *     MOVE FIO-GET-KEY TO FIO-CMND.
      *     PERFORM DGC-FIO-RCC.
      *     IF FIO-STAT-OKS AND
      *        RCC-COD-ARCC IN RCC = '999' AND
      *        RCC-IND-VIGE IN RCC NOT = 'N'
      *         MOVE 'S' TO DBE-IND-ACCI IN DBE-FLD.
      * FIN-BUS-IACC.
      *     EXIT.
       BUS-IACC SECTION.
       INI-BUS-IACC.
           MOVE I TO REC-NUM-TRCC IN REC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DGC-FIO-REC.
           IF FIO-STAT-OKS AND
              REC-COD-ARCC IN REC = '999' AND
              REC-IND-VIGE IN REC NOT = 'N'
               MOVE 'S' TO FRM-IND-ACCI IN DBE-FLD.
       FIN-BUS-IACC.
           EXIT.
