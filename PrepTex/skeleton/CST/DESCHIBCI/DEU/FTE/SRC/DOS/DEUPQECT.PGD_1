       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   DEUPQECT.
       AUTHOR.       BEE-CIMA.
       DATE-WRITTEN. 07-Dec-18 12:02 PM.

      * NOMBRE PROGRAMA                   DEUPQECT
      * VERSION PGM                       3.1
      * VERSION SKL                       07.08.21
      * OPCION                            CON
      * ARCHIVO BASE                      COLOPC
      * PANTALLA                          DEUECT
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *<<<< CMT_ID 
      *----------------------------------------------------------------
      * MANTENCION: CAMBIO DE FECHA DE CURSE
      * FECHA : NOVIEMBRE 2014
      * RESPONSABLE: AFRI-CGC
      * ETIQUETA: *AFRI-INI 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN
      *----------------------------------------------------------------
      *>>>> CMT_ID

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-DEUPQECT-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$DEUPQECT$ SKL=$07.08.21$ VSN=${vsnpq}$        
      -    'GEN=$07-Dec-18 12:02 PM$ FNC=${fncpq}$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< MI_COMMAREA
           03 SCR-NUM-PANT               PIC 9(0005).
           03 SCR-ECT-FLD                PIC X(1100).
      *>>>>
       COPY DEUWIECT.

       COPY COLBROPC.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.

      *PTC ini
       COPY GNSWGQUE.
      *PTC fin
      *<<<< WSS
      * INICIO
       COPY DEUWXECT.
       COPY DEUBRCIP.
       COPY DEUBRCIP REPLACING CIP BY CIS.
      *ENTIDADES DE COL
       COPY COLBRCAN.
       COPY COLBRVEN.
       COPY COLBRRDC.
      *ENTIDADES DE SGC
       COPY SGCBRDBC.
       COPY SGCBRDCE.
       COPY SGCBRDCP.
      *ENTIDADES LDC
       COPY LDCBRRLO.
       COPY LDCBRLCC.

      * ENTIDADES DE SGC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCP-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DCE-REQA==.
      * ENTIDADES DE LDC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RLO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-LCC-REQA==.
      * Entidades de COL
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-IPT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CYA-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-VEN-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDC-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AUT-REQA==.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CAM-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RDT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DLC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-EVC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ICG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ROV-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TXC-REQA==.

       COPY COLBRIPT.
       COPY COLBRCYA.
       COPY COLBRAUT.
       COPY COLBRRCV.
       COPY COLBRDLC.
       COPY COLBREVC.
       COPY COLBRICG.
       COPY COLBRROV.
       COPY COLWGVEN.
       COPY COLWGINT.
       COPY GNSWGPES.

       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-BDO-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PTT-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AXU-REQA==.
       COPY SGCBROPE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OPE-REQA==.
       COPY SGCBRRCO.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-RCO-REQA==.
       COPY COLBRDIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DIC-REQA==.
       COPY COLBRCXE.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CXE-REQA==.
       COPY COLBRITR.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ITR-REQA==.
       COPY COLBRTOC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TOC-REQA==.
       COPY COLBRPCP.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-PCP-REQA==.
       COPY COLWGGCI.

       COPY GNSWGCPT.
       COPY COLWGNOR.
       COPY COLWGPCP.
       COPY COLBRVEN REPLACING ==VEN== BY ==GCI-VEN-BKP==.
       COPY COLWICAN.
       COPY COLW1CAN.
       COPY COLW2CAN.
       COPY TABWGTXC.
       COPY TABBRCAM.
       COPY TABBRTXC.
       COPY GNSBRCIC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIP-REQA==.
       COPY GNSWGCIC.
       01 WSS-NUM-CCUR.
           03 WSS-NUM-ICUR-EDT  PIC  ZZ9.
           03 WSS-NUM-ICUR-ALF       PIC X(03).
           03 WSS-NUM-ICUR      REDEFINES
              WSS-NUM-ICUR-ALF       PIC 9(03).
      * FINAL

       01 WSS-VARI.
          03 WSS-CIC-ICER      VALUE SPACES  PIC X(12).
          03 WSS-NUM-ICIP      VALUE ZEROES  PIC 9(03).
          03 WSS-NUM-CORR      VALUE ZEROES  PIC 9(04).
          03 WSS-CON-IPTS      VALUE ZEROES  PIC 9(04).
          03 WSS-MAX-CORR      VALUE 500     PIC 9(03).
          03 WSS-ARR-IPTS      OCCURS 500 TIMES.
             05 VEC-BR-IPTS                   PIC X(500).
          03 WSS-VECTOR-CMP     OCCURS 500 TIMES.
             05 WSS-FRM-NUM-CORR              PIC  9(4).
             05 WSS-FRM-COD-CPTO              PIC  X(6).
             05 WSS-FRM-COD-EVTO              PIC  X(3).
             05 WSS-FRM-SGV-TIMP              PIC  9(03)V9(12).
             05 WSS-FRM-SGV-BIMP              PIC  9(11)V9(04).
             05 WSS-FRM-NUM-FOLI              PIC 9(10).
             05 WSS-FRM-NUM-CPTO              PIC 9(03).
             05 WSS-FRM-NUM-EVTO                  PIC 9(03).
             05 WSS-FRM-NUM-PERI              PIC 9(03).
             05 WSS-FRM-SGV-MIMP              PIC 9(11)V9(04).
             05 WSS-FRM-GLS-NORM              PIC  X(12).
             05 WSS-FRM-CIC-IOPC.
                07 WSS-FRM-CAI-OPCO           PIC  X(4).
                07 WSS-FRM-IIC-OPCO           PIC  X(8).
             05 WSS-FRM-GLS-OPCO              PIC  X(20).
             05 WSS-FRM-GLS-INEM              PIC  X(9).

          03 WSS-I                  VALUE ZEROES   PIC  9(03).
          03 WSS-TOT-DIAS           VALUE ZEROES   PIC  9(02).
          03 WSS-DIA-SUMA           VALUE ZEROES   PIC  9(03).

       01 WCC-VARI.
          03 WCC-1           VALUE 1          PIC 9(01).
          03 WCC-A           VALUE 'A'        PIC X(01).
          03 WCC-N           VALUE 'N'        PIC X(01).
          03 WCC-S           VALUE 'S'        PIC X(01).
          03 WCC-COL         VALUE 'COL'      PIC X(03).
          03 WCC-TAB         VALUE 'TAB'      PIC X(03).
          03 WCC-DEU         VALUE 'DEU'      PIC X(03).
          03 WCC-MSG         VALUE 'MSG'      PIC X(03).
          03 WCC-VSN         VALUE 'VSN'      PIC X(03).
          03 WCC-DIASVIGCERTI VALUE 'DIASVIGCERTI' PIC X(12).
          03 WCC-NODLC        VALUE 'NODLC'   PIC X(05).
          03 WCC-NOGRABACIP   VALUE 'NOGRABACIP'   PIC X(10).

          03 WCC-M           VALUE 'M'        PIC X(01).
          03 WCC-COLBGIPT    VALUE 'COLBGIPT' PIC X(08).
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-OPC.
                 88 PGM-STAT-OPC-NUL    VALUE '  '.
                 07 PGM-STT1-OPC        VALUE '2' PIC X(01).
                    88 PGM-STAT-OPC-OKS VALUE '0'.
                 07 PGM-STT2-OPC        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
           02 FILLER                    PIC X(601).
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
           IF SCR-CCPP = 'ACT'
                 PERFORM SCR-ACT
           ELSE
           IF SCR-CCPP = 'PGM'
                 PERFORM SCR-PGM
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO ECT-FLD.
           MOVE LOW-VALUES TO ECT-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +601 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'DEUPQECT' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO
      *PTC ini
           PERFORM GNS-ERR-QUE.
      *PTC fin
      *<<<< INI_FIO
           IF SCR-OFRM-SRV
               PERFORM CLR-FRM VARYING WSS-I FROM 1 BY 1
                                 UNTIL WSS-I > WSS-IMAX
                MOVE TSK-TERM-ALF TO ECT-COD-TERM
                MOVE TSK-TERM-ALF TO ECT-COD-TERM-MAS
           ELSE
                MOVE EIBTRMID     TO ECT-COD-TERM
                MOVE EIBTRMID     TO ECT-COD-TERM-MAS.
           MOVE +3859 TO SCR-TCMA.
           PERFORM GNS-ERR-QUE.
           IF ( FRM-FFLD = FRM-FFLD-PF5 ) AND ( SCR-NUM-PANT = 1 )
               MOVE SCR-ECT-FLD TO ECT-FLD
               GO TO FIN-INI.

           IF ( FRM-FFLD = FRM-FFLD-PF6 )
               MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
               ADD 1              TO QUE-NITM
               MOVE ECT-NOM-TSECT TO QUE-COLA
               MOVE ECT-LEN-TSECT TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT NOT = QUE-STAT-OKS
                  MOVE SCR-ECT-FLD TO ECT-FLD
                  GO TO FIN-INI.
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-ECT.
           PERFORM EDT-KEY-ECT.
           PERFORM EDT-FLD-ECT.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-MOD.
           PERFORM DESSCRTRL.
       MSG-SCR-MOD.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       BRW-SCR-MOD SECTION.
       INI-BRW-SCR-MOD.
       FIN-BRW-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-ECT
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
      *PTC-INI
                        MOVE 'S' TO SCR-IERR
      *PTC-FIN
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM VAL-NUM-KEY-ECT
               PERFORM VAL-NUM-FLD-ECT
               PERFORM SCRL-TAB-ECT
               PERFORM SCR-TRL.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ELI.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       BRW-SCR-ELI SECTION.
       INI-BRW-SCR-ELI.
       FIN-BRW-SCR-ELI.
           EXIT.

       SCR-ACT SECTION.
       INI-SCR-ACT.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF FIO-STAT-OKS
                            MOVE SCR-ACTU-MOD TO SCR-ACTU
                            PERFORM PUT-SCR
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FIO-STAT-EOF
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGEOF    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                        IF FIO-STAT = FIO-STAT-NEX
                            IF FRM-MENS NOT > SPACES
                                MOVE 'REGNEX    ' TO MSG-COD-MENS
                                MOVE 'GNS' TO MSG-COD-SIST
                                PERFORM GET-MSG
                                MOVE MSG-GLS-DESC TO FRM-MENS
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                            ELSE
                                PERFORM SCR-MSSG
                                MOVE SCR-STAT-ABT TO SCR-STAT
                                PERFORM DESSCRTRL
                                GO TO FIN-SCR-ACT
                        ELSE
                            MOVE SCR-ACTU-ING TO SCR-ACTU
      *JSS                  PERFORM CLR-FLD-ECT
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACT
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACT.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACT.
           EXIT.

       BRW-SCR-ACT SECTION.
       INI-BRW-SCR-ACT.
       FIN-BRW-SCR-ACT.
           EXIT.

       SCR-PGM SECTION.
       INI-SCR-PGM.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-KEY
                IF FRM-STAT-ABT
                    MOVE SPACES TO FRM-MENS
                    PERFORM SCR-MSSG
                    PERFORM DESSCRTRL
                    GO TO FIN-SCR-PGM
                ELSE
                    MOVE SPACES TO FRM-MENS
                    PERFORM FND-KEY
                    IF FIO-STAT = FIO-STAT-NEX
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGNEX    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-PGM
                    ELSE
                        MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                        PERFORM SCR-TRL
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-PGM.
       TRL-SCR-PGM.
           PERFORM DESSCRTRL.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-PGM.
           EXIT.

       BRW-SCR-PGM SECTION.
       INI-BRW-SCR-PGM.
       FIN-BRW-SCR-PGM.
           EXIT.

       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-ECT
               PERFORM EDT-KEY-ECT
               PERFORM EDT-FLD-ECT
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-ECT
               PERFORM EDT-KEY-ECT
           ELSE
               PERFORM CLR-FLD-ECT
               PERFORM EDT-FLD-ECT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-ECT.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO ECT-FLD.
           MOVE LOW-VALUES TO ECT-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY

           MOVE ECT-NOM-TSECT     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE ECT-NOM-TSECT-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

      **   IF SCR-OFRM-SRV
           IF FRM-GLS-IDCE IN ECT-FLD > SPACES AND
              FRM-NUM-ICIP IN ECT-FLD > ZEROES AND
              FRM-NUM-ICIP IN ECT-FLD IS NUMERIC
               MOVE SPACES TO CIP
               MOVE FRM-GLS-IDCE IN ECT-FLD TO
                            WSS-CIC-ICER IN WSS-VARI
               MOVE FRM-NUM-ICIP IN ECT-FLD TO
                            WSS-NUM-ICIP IN WSS-VARI
               PERFORM CRG-MAS-CIP
               MOVE '00' TO PGM-STAT-OPC
               GO TO CARGA-PAN-ECT
           ELSE
               NEXT SENTENCE.
      **   ELSE
      **       NEXT SENTENCE.
      *>>>>
           PERFORM KEY-ALL-ECT.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.
           IF FIO-STAT-OKS
               MOVE OPC-STP-ITRN IN OPC TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-OPC.
      *<<<< FIN_FND_KEY
           IF NOT FIO-STAT-OKS
               GO TO FIN-FND-KEY.

      *OPERACION PROCESADA
           MOVE OPC-CIC-IOPC IN OPC TO GCI-CIC-IOPC IN GCI-VARI.

      *COMISION DE PREPAGO POR SI LA INGRESAN
           MOVE FRM-SGV-COMP IN ECT-FLD TO GCI-VAL-CING IN GCI-VARI.

      * SE DEBE ENVIAR LA FECHA DE HOY PARA LOS CALCULOS
           PERFORM GET-FHOY.
           MOVE HOY-SHOY TO GCI-NUM-SCAL IN GCI-VARI.
           MOVE HOY-AHOY TO GCI-NUM-ACAL IN GCI-VARI.
           MOVE HOY-MHOY TO GCI-NUM-MCAL IN GCI-VARI.
           MOVE HOY-DHOY TO GCI-NUM-DCAL IN GCI-VARI.

           PERFORM GEN-CMP-CIP.
           IF GCI-COD-ERRO IN GCI-VARI NOT = SPACES
               MOVE WCC-TAB TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE GCI-COD-ERRO IN GCI-VARI TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT = WCC-S
               MOVE GCI-COD-ERRO IN GCI-VARI TO FRM-MENS
                   GO TO MSG-FND-KEY
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
               GO TO MSG-FND-KEY.

      * RECUPERO OPC INGRESADA
           MOVE GCI-CIC-IOPC IN GCI-VARI TO OPC-CIC-IOPC IN OPC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM COL-FIO-OPC.

      *LEO DLC DE LA OPERACION
           MOVE OPC-CIC-IOPC IN OPC TO DLC-CIC-IOPC IN DLC.
           MOVE ZEROES TO DLC-NUM-IDLC IN DLC.
           MOVE FIO-GET-NLS TO FIO-CMND.
           PERFORM COL-FIO-DLC.
           IF NOT FIO-STAT-OKS OR
              OPC-CIC-IOPC IN OPC NOT = DLC-CIC-IOPC IN DLC
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-NODLC                TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT = WCC-S
                   MOVE WCC-NODLC                TO FRM-MENS
                   GO TO MSG-FND-KEY
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
               GO TO MSG-FND-KEY.

      * EN ESTE PUNTO LA OPERACION PERMITE LA GENERACION DEL CERTIFICADO
      * SE MUEVEN LOS CAMPOS A LA PANTALLA
      *
      *  TOTAL A PAGAR (ESTA EN PESOS)
           MOVE GCI-VAL-TOTTPAG TO FRM-SGV-TOTP IN ECT-FLD.

      *  CAPITAL ADEUDADO (ESTA EN PESOS)
           MOVE GCI-VAL-CAPR    TO FRM-SGV-CAPC IN ECT-FLD.

      *  INTERES NORMAL (ESTA EN PESOS)
           MOVE GCI-VAL-INTE    TO FRM-SGV-MINT IN ECT-FLD.

      *  COMISION PREPAGO (ESTA EN PESOS)
           MOVE GCI-VAL-COPR    TO FRM-SGV-COMP IN ECT-FLD.

      *  INTERES MORATORIO (ESTA EN PESOS)
           MOVE GCI-VAL-CAMO    TO FRM-SGV-INTM IN ECT-FLD.

      *  COMISION FOGAPE (ESTA EN PESOS)
           MOVE GCI-VAL-COFG    TO FRM-SGV-COMI IN ECT-FLD.

      * SALDO MONEDA ORIGEN
           MOVE OPC-VAL-SCRE IN OPC TO FRM-SGV-SALD IN ECT-FLD.

      * MONEDA CREDITO
           MOVE OPC-COD-VCOC IN OPC TO OPC-COD-VCOC IN ECT-FLD.

      * TOTAL DL
           COMPUTE FRM-SGV-TODL IN ECT-FLD ROUNDED =
                   (OPC-VAL-SCRE IN OPC * GCI-CAM-UF IN GCI-VARI) +
                   GCI-VAL-INTE + GCI-VAL-COPR.

      * FECHA CURSE
           MOVE OPC-NUM-DCOL IN OPC TO FRM-NUM-DCUR IN ECT-FLD.
           MOVE OPC-NUM-MCOL IN OPC TO FRM-NUM-MCUR IN ECT-FLD.
           MOVE OPC-NUM-SCOL IN OPC TO FRM-NUM-SCUR IN ECT-FLD.
           MOVE OPC-NUM-ACOL IN OPC TO FRM-NUM-ACUR IN ECT-FLD.
      *AFRI-INI 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN
           IF OPC-IND-RENO IN OPC = GCI-PRO
               MOVE DLC-CIC-IOCO IN DLC TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC
               MOVE OPC-NUM-DCOL IN OPC TO FRM-NUM-DCUR IN ECT-FLD
               MOVE OPC-NUM-MCOL IN OPC TO FRM-NUM-MCUR IN ECT-FLD
               MOVE OPC-NUM-SCOL IN OPC TO FRM-NUM-SCUR IN ECT-FLD
               MOVE OPC-NUM-ACOL IN OPC TO FRM-NUM-ACUR IN ECT-FLD
               MOVE GCI-CIC-IOPC IN GCI-VARI TO OPC-CIC-IOPC IN OPC
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM COL-FIO-OPC.
      *AFRI-FIN 19-NOV-2014 CAMBIO FEC CURSE POR FEC ORIGEN

      * SE CALCULA FECHA DE VIGENCIA
           PERFORM CAL-FEC-VIG.

      * SE BUSCAN IPTS PARA INFORMAR
           PERFORM BUS-REG-IPT.

      * BUSCA INFORMACION DEL CLIENTE
           PERFORM BUS-REG-DBC.

      * GENERA NUMERO CIP Y GUARDA INFORMACION
           PERFORM GBR-REG-CIP.
           IF NOT FIO-STAT-OKS
               MOVE WCC-DEU TO TAB-COD-SIST FIO-SIST
               MOVE WCC-MSG TO TAB-COD-TTAB IN TAB
               MOVE WCC-NOGRABACIP           TO TAB-COD-CTAB IN TAB
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT = WCC-S
                   MOVE WCC-NOGRABACIP           TO FRM-MENS
                   GO TO MSG-FND-KEY
               ELSE
                   MOVE TAB-GLS-DESC IN TAB TO FRM-MENS
               GO TO MSG-FND-KEY.

            MOVE CIP-KEY-ICIP IN CIP TO FRM-GLS-IDCE IN ECT-FLD.

      * CARGA PANTALLA
       CARGA-PAN-ECT.
           PERFORM CAR-FLD-ECT.

           IF (SCR-OFRM-SRV AND WSS-J > WSS-NITMMAX IN ECT-VARI)
               GO TO FND-KEY-PUT-TAB.

           IF ((NOT SCR-OFRM-SRV) AND WSS-J > WSS-JMAX IN ECT-VARI)
               GO TO FND-KEY-PUT-TAB.

       FND-KEY-PUT-TAB.

           PERFORM PUT-TAB.

           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           GO TO FIN-FND-KEY.
      *----------------------------------------------------------
       MSG-FND-KEY.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
           MOVE 'S' TO SCR-IERR.
           GO TO FIN-FND-KEY.
      *>>>>
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-OPC-OKS
               MOVE OPC-STP-ITRN IN OPC TO SCR-UMOD.
           PERFORM PUT-ALL-ECT.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE ECT-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO ECT-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-ECT
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO ECT-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-ECT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-ECT
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-ECT.
           PERFORM VAL-IKY-ECT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-ECT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-ECT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-ECT.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-ECT.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-ECT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-ECT
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO ECT-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-ECT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-ECT
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-ECT.
           PERFORM VAL-IKY-ECT.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-ECT.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-ECT.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-ECT.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON
           IF NOT ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO ECT-GLS-MEN2
               MOVE SCR-PRMT     TO ECT-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO ECT-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO ECT-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE ECT-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO ECT-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-ECT

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO ECT-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO ECT-GLS-MENS.
           PERFORM PRO-MKY-ECT.
           PERFORM PRO-AKY-ECT.
           PERFORM UNP-IKY-ECT.
           PERFORM FST-KEY-ECT.
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE ECT-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO ECT-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO ECT-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO ECT-GLS-MENS.
           PERFORM UNP-KEY-ECT.
           PERFORM FST-KEY-ECT.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-ECT.
           PERFORM PRO-AKY-ECT.
           PERFORM UNP-MKY-ECT.
           PERFORM UNP-FLD-ECT.
           PERFORM FST-FLD-ECT.
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO ECT-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-ECT.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-ECT
               PERFORM EDT-FLD-ECT
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-ECT
               PERFORM EDT-FLD-ECT
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-ECT.
           PERFORM EDT-FLD-ECT.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY DEUBQECT.
       COPY GNSBVNUM.
       COPY COLBFOPC.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBEGLS.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *PTC ini
       COPY GNSBGQUE.
      *PTC fin
      *<<<< EOF
      *---------------------------------------------------------------
       CAL-FEC-VIG SECTION.
       INI-CAL-FEC-VIG.
           MOVE WCC-COL          TO FIO-SIST TAB-COD-SIST
           MOVE WCC-VSN          TO TAB-COD-TTAB IN TAB.
           MOVE WCC-DIASVIGCERTI TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY      TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS OR TAB-IND-VIGE IN TAB NOT = WCC-S
               MOVE ZEROES TO WSS-TOT-DIAS IN WSS-VARI
           ELSE
               MOVE TAB-GLS-DATA IN TAB TO WSS-TOT-DIAS IN WSS-VARI.

           IF WSS-TOT-DIAS IN WSS-VARI IS NOT NUMERIC
               MOVE ZEROES TO WSS-TOT-DIAS IN WSS-VARI.

           MOVE ZEROES TO WSS-DIA-SUMA IN WSS-VARI.

           MOVE GCI-NUM-DCAL IN GCI-VARI TO FEC-ITM1.
           MOVE GCI-NUM-MCAL IN GCI-VARI TO FEC-ITM2.
           MOVE GCI-NUM-SCAL IN GCI-VARI TO FEC-ITM3.
           MOVE GCI-NUM-ACAL IN GCI-VARI TO FEC-ITM4.

       LOOP-CAL-FEC-VIG.
           IF WSS-DIA-SUMA IN WSS-VARI = WSS-TOT-DIAS IN WSS-VARI
               GO TO MOV-FEC-VIG.

           MOVE FEC-SUM-DIA  TO FEC-CMND.
           MOVE WCC-1        TO FEC-NDIA.
           PERFORM CAL-FEC.

           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-FBLK-S   TO FEC-FBLK.
           MOVE FEC-CHOY-N   TO FEC-CHOY.
           MOVE FEC-VHBL-S   TO FEC-VHBL.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF FEC-STAT-FER
               GO TO LOOP-CAL-FEC-VIG.

           ADD WCC-1         TO WSS-DIA-SUMA IN WSS-VARI.
           GO TO LOOP-CAL-FEC-VIG.

       MOV-FEC-VIG.

      * FECHA DE VIGENCIA
           MOVE FEC-ITM1 TO FRM-NUM-DVIG IN ECT-FLD.
           MOVE FEC-ITM2 TO FRM-NUM-MVIG IN ECT-FLD.
           MOVE FEC-ITM3 TO FRM-NUM-SVIG IN ECT-FLD.
           MOVE FEC-ITM4 TO FRM-NUM-AVIG IN ECT-FLD.

      * FECHA DE EMISION
           MOVE GCI-NUM-DCAL IN GCI-VARI TO FRM-NUM-DEMI IN ECT-FLD.
           MOVE GCI-NUM-MCAL IN GCI-VARI TO FRM-NUM-MEMI IN ECT-FLD.
           MOVE GCI-NUM-SCAL IN GCI-VARI TO FRM-NUM-SEMI IN ECT-FLD.
           MOVE GCI-NUM-ACAL IN GCI-VARI TO FRM-NUM-AEMI IN ECT-FLD.

      * FECHA DE LIQUIDACION
           MOVE GCI-NUM-DCAL IN GCI-VARI TO FRM-NUM-DLIQ IN ECT-FLD.
           MOVE GCI-NUM-MCAL IN GCI-VARI TO FRM-NUM-MLIQ IN ECT-FLD.
           MOVE GCI-NUM-SCAL IN GCI-VARI TO FRM-NUM-SLIQ IN ECT-FLD.
           MOVE GCI-NUM-ACAL IN GCI-VARI TO FRM-NUM-ALIQ IN ECT-FLD.

      * FECHA DE VENCIMIENTO
           MOVE DLC-NUM-DMAV IN DLC      TO FRM-NUM-DVEN IN ECT-FLD.
           MOVE DLC-NUM-MMAV IN DLC      TO FRM-NUM-MVEN IN ECT-FLD.
           MOVE DLC-NUM-SMAV IN DLC      TO FRM-NUM-SVEN IN ECT-FLD.
           MOVE DLC-NUM-AMAV IN DLC      TO FRM-NUM-AVEN IN ECT-FLD.

       FIN-CAL-FEC-VIG.
           EXIT.
      *---------------------------------------------------------------
       BUS-REG-IPT SECTION.
       INI-BUS-REG-IPT.

           MOVE ZEROES TO WSS-NUM-CORR IN WSS-VARI.
           MOVE SPACES TO IPT.
           MOVE GCI-CIC-IOPC IN GCI-VARI TO IPT-CIC-IOPC IN IPT.
           MOVE SPACES                   TO IPT-COD-EVEN IN IPT.
           MOVE ZEROES                   TO IPT-NUM-ICAN IN IPT.
           MOVE SPACES                   TO IPT-COD-CPTO IN IPT.
           MOVE ZEROES                   TO IPT-NUM-CPTO IN IPT.
           MOVE FIO-GET-NLS              TO FIO-CMND.
           PERFORM COL-FIO-IPT.
           IF NOT FIO-STAT-OKS OR
              IPT-CIC-IOPC IN IPT NOT = GCI-CIC-IOPC IN GCI-VARI
               GO TO FIN-BUS-REG-IPT.

       LOOP-IPT-OPC.
           IF IPT-MSC-STAT IN IPT = WCC-A
               PERFORM MOV-DAT-IPT.

           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM COL-FIO-IPT.
           IF NOT FIO-STAT-OKS OR
              IPT-CIC-IOPC IN IPT NOT = GCI-CIC-IOPC IN GCI-VARI
               GO TO FIN-BUS-REG-IPT.

           GO TO LOOP-IPT-OPC.

       FIN-BUS-REG-IPT.
           EXIT.
      *----------------------------------------------------------------
       MOV-DAT-IPT SECTION.
       INI-MOV-DAT-IPT.


           ADD WCC-1 TO WSS-NUM-CORR IN WSS-VARI.
           IF WSS-NUM-CORR IN WSS-VARI >= WSS-MAX-CORR IN WSS-VARI
               GO TO FIN-MOV-DAT-IPT.

           MOVE IPT TO VEC-BR-IPTS(WSS-NUM-CORR).

           MOVE WSS-NUM-CORR IN WSS-VARI TO
                       WSS-FRM-NUM-CORR(WSS-NUM-CORR).
      *
           MOVE IPT-COD-CPTO IN IPT TO
                       WSS-FRM-COD-CPTO(WSS-NUM-CORR).

           MOVE IPT-COD-EVEN IN IPT TO
                       WSS-FRM-COD-EVTO(WSS-NUM-CORR).
      *
           MOVE IPT-SGV-TINT IN IPT TO
                       WSS-FRM-SGV-TIMP(WSS-NUM-CORR).
      *
           MOVE IPT-SGV-MNTO IN IPT TO
                       WSS-FRM-SGV-BIMP(WSS-NUM-CORR).
      *
           MOVE IPT-NUM-FOLI IN IPT TO
                       WSS-FRM-NUM-FOLI(WSS-NUM-CORR).
      *
           MOVE IPT-NUM-CPTO IN IPT TO
                       WSS-FRM-NUM-CPTO(WSS-NUM-CORR).
      *
           MOVE IPT-NUM-ICAN IN IPT TO
                       WSS-FRM-NUM-EVTO(WSS-NUM-CORR).
      *
           MOVE IPT-VAL-CTRA IN IPT TO
                       WSS-FRM-NUM-PERI(WSS-NUM-CORR).
      *
           MOVE IPT-SGV-MCAL IN IPT TO
                       WSS-FRM-SGV-MIMP(WSS-NUM-CORR).
      *
           MOVE IPT-GLS-NORM IN IPT TO
                       WSS-FRM-GLS-NORM(WSS-NUM-CORR).
      *
           MOVE IPT-CAI-IOPC IN IPT TO
                       WSS-FRM-CAI-OPCO(WSS-NUM-CORR).
      *
           MOVE IPT-IIC-IOPC IN IPT TO
                       WSS-FRM-IIC-OPCO(WSS-NUM-CORR).
      *
           MOVE SPACES TO WSS-FRM-GLS-OPCO(WSS-NUM-CORR).
      *
           MOVE IPT-COD-IEMI IN IPT TO
                       WSS-FRM-GLS-INEM(WSS-NUM-CORR).

       FIN-MOV-DAT-IPT.
           EXIT.
      *----------------------------------------------------------------
       BUS-REG-DBC SECTION.
       INI-BUS-REG-DBC.
           MOVE SPACES TO RDC.

           MOVE GCI-CIC-IOPC IN GCI-VARI TO RDC-CIC-IOPC IN RDC.
           MOVE ZEROES                   TO RDC-NUM-IDLC IN RDC.
           MOVE 'RDC-KEY-IDLC'           TO FIO-AKEY.
           MOVE FIO-GET-KEY              TO FIO-CMND.
           PERFORM COL-FIO-RDC.
           IF NOT FIO-STAT-OKS
               GO TO FIN-BUS-REG-DBC.

           MOVE RDC-CIC-ICLI IN RDC TO DBC-CIC-ICLI IN DBC
           MOVE FIO-GET-KEY    TO FIO-CMND
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
              GO TO FIN-BUS-REG-DBC.

           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN ECT-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN ECT-FLD.

           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN ECT-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN ECT-FLD.

           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN TO FRM-GLS-NOMC IN ECT-FLD.

       FIN-BUS-REG-DBC.
           EXIT.
      *----------------------------------------------------------------
       GBR-REG-CIP SECTION.
       INI-GBR-REG-CIP.
           MOVE SPACES TO CIC.
           MOVE 'C'                      TO CIC-COD-TCIC IN CIC.
           MOVE 'IP '                    TO CIC-COD-CCIC IN CIC.
           MOVE CIC-GET                  TO CIC-CMND.
           PERFORM PRO-CIC.

           MOVE SPACES TO CIP.
           MOVE SPACES TO CIP-GLS-FLAG IN CIP.
           MOVE CIC-CIC-ICIC IN CIC TO CIP-CIC-ICER IN CIP.
           MOVE WCC-1 TO CIP-NUM-ICIP IN CIP.
           MOVE DBC-IDC-ICLI IN DBC TO CIP-IDC-ICLI IN CIP.
           MOVE DBC-GLS-NOMC IN DBC TO CIP-GLS-NOMC IN CIP.
           MOVE DBC-CIC-ICLI IN DBC TO CIP-CIC-ICLI IN CIP.
           MOVE DBC-VRF-ICLI IN DBC TO CIP-VRF-ICLI IN CIP.
      * FECHA DE VIGENCIA
           MOVE FRM-NUM-DVIG IN ECT-FLD TO CIP-NUM-DVIG IN CIP.
           MOVE FRM-NUM-MVIG IN ECT-FLD TO CIP-NUM-MVIG IN CIP.
           MOVE FRM-NUM-SVIG IN ECT-FLD TO CIP-NUM-SVIG IN CIP.
           MOVE FRM-NUM-AVIG IN ECT-FLD TO CIP-NUM-AVIG IN CIP.

           MOVE WCC-N TO CIP-IND-DUSO IN CIP.

      * FECHA DE EMISION
           MOVE FRM-NUM-DEMI IN ECT-FLD TO CIP-NUM-DEMI IN CIP.
           MOVE FRM-NUM-MEMI IN ECT-FLD TO CIP-NUM-MEMI IN CIP.
           MOVE FRM-NUM-SEMI IN ECT-FLD TO CIP-NUM-SEMI IN CIP.
           MOVE FRM-NUM-AEMI IN ECT-FLD TO CIP-NUM-AEMI IN CIP.

      * FECHA DE LIQUIDACION
           MOVE FRM-NUM-DLIQ IN ECT-FLD TO CIP-NUM-DLIQ IN CIP.
           MOVE FRM-NUM-MLIQ IN ECT-FLD TO CIP-NUM-MLIQ IN CIP.
           MOVE FRM-NUM-SLIQ IN ECT-FLD TO CIP-NUM-SLIQ IN CIP.
           MOVE FRM-NUM-ALIQ IN ECT-FLD TO CIP-NUM-ALIQ IN CIP.

      * FECHA DE VENCIMIENTO
           MOVE FRM-NUM-DVEN IN ECT-FLD TO CIP-NUM-DVEN IN CIP.
           MOVE FRM-NUM-MVEN IN ECT-FLD TO CIP-NUM-MVEN IN CIP.
           MOVE FRM-NUM-SVEN IN ECT-FLD TO CIP-NUM-SVEN IN CIP.
           MOVE FRM-NUM-AVEN IN ECT-FLD TO CIP-NUM-AVEN IN CIP.

           MOVE OPC-CIC-IOPC IN OPC TO CIP-COD-OPCO IN CIP.
           MOVE OPC-COD-VCOC IN OPC TO CIP-COD-MONE IN CIP.
           MOVE OPC-VAL-CRED IN OPC TO CIP-VAL-MCRE IN CIP.

      *  TOTAL DL
           MOVE FRM-SGV-TODL IN ECT-FLD TO CIP-VAL-3475 IN CIP.

      *  TOTAL A PAGAR (ESTA EN PESOS)
           MOVE GCI-VAL-TOTTPAG TO CIP-VAL-TPAG IN CIP.

      *  SALDO INSOLUTO MONEDA ORIGEN
           MOVE OPC-VAL-SCRE IN OPC TO CIP-VAL-SIMO IN CIP.

      *  CAPITAL ADEUDADO (ESTA EN PESOS)
           MOVE GCI-VAL-CAPR    TO CIP-VAL-CAMO IN CIP

      *  INTERES NORMAL (ESTA EN PESOS)
           MOVE GCI-VAL-INTE    TO CIP-VAL-INTN IN CIP.

      *  COMISION PREPAGO (ESTA EN PESOS)
           MOVE GCI-VAL-COPR    TO CIP-VAL-CPRE IN CIP.

      *  INTERES MORATORIO (ESTA EN PESOS)
           MOVE GCI-VAL-CAMO    TO CIP-VAL-CMOR IN CIP.

      *  COMISION FOGAPE (ESTA EN PESOS)
           MOVE GCI-VAL-COFG    TO CIP-VAL-CFOG IN CIP.

           MOVE WCC-1 TO WSS-CON-IPTS IN WSS-VARI.
           MOVE CIP TO CIS.

       LOOP-GRB-IPT.

           IF WSS-CON-IPTS IN WSS-VARI > WSS-NUM-CORR IN WSS-VARI
               GO TO FIN-GBR-REG-CIP.

           MOVE SPACES TO CIP.
           MOVE CIS TO CIP.
           MOVE WSS-CON-IPTS IN WSS-VARI TO CIP-NUM-ICIP IN CIP.

           MOVE SPACES TO IPT.
           MOVE VEC-BR-IPTS(WSS-CON-IPTS) TO IPT.

           MOVE IPT-KEY-IOPC IN IPT TO CIP-REG-IOPC IN CIP.
           MOVE IPT-COD-EVEN IN IPT TO CIP-COD-EVEN IN CIP.
           MOVE IPT-NUM-ICAN IN IPT TO CIP-NUM-ICAN IN CIP.
           MOVE IPT-COD-CPTO IN IPT TO CIP-COD-CPTO IN CIP.
           MOVE IPT-NUM-CPTO IN IPT TO CIP-NUM-CPTO IN CIP.
           MOVE IPT-STP-ITRN IN IPT TO CIP-STP-ITRN IN CIP.
           MOVE IPT-MSC-TACC IN IPT TO CIP-MSC-TACC IN CIP.
           MOVE IPT-MSC-STAT IN IPT TO CIP-MSC-STAT IN CIP.
           MOVE IPT-COD-OTRN IN IPT TO CIP-COD-OTRN IN CIP.
           MOVE WCC-COLBGIPT        TO CIP-COD-ATRN IN CIP.
           MOVE IPT-KEY-IORI IN IPT TO CIP-KEY-IORI IN CIP.
           MOVE IPT-SGV-TUNI IN IPT TO CIP-SGV-TUNI IN CIP.
           MOVE IPT-SGV-TINT IN IPT TO CIP-SGV-TINT IN CIP.
           MOVE IPT-SGV-MNTO IN IPT TO CIP-SGV-MNTO IN CIP.
           MOVE IPT-SGV-MCAL IN IPT TO CIP-SGV-MCAL IN CIP.
           MOVE IPT-VAL-CTRA IN IPT TO CIP-VAL-CTRA IN CIP.
           MOVE IPT-FEC-FTER IN IPT TO CIP-FEC-FTER IN CIP.
           MOVE IPT-FEC-FMAV IN IPT TO CIP-FEC-FMAV IN CIP.
           MOVE IPT-FEC-FCOL IN IPT TO CIP-FEC-FCOL IN CIP.
           MOVE IPT-NUM-IVEN IN IPT TO CIP-NUM-IVEN IN CIP.
           MOVE IPT-SGV-CUOT IN IPT TO CIP-SGV-CUOT IN CIP.
           MOVE IPT-IND-CXE1 IN IPT TO CIP-IND-CXE1 IN CIP.
           MOVE IPT-NUM-CPRO IN IPT TO CIP-NUM-CPRO IN CIP.
           MOVE IPT-CIC-ORIG IN IPT TO CIP-CIC-ORIG IN CIP.
           MOVE IPT-COD-IEMI IN IPT TO CIP-COD-IEMI IN CIP.
           MOVE IPT-COD-TIPO IN IPT TO CIP-COD-TIPO IN CIP.
           MOVE IPT-NUM-PTRM IN IPT TO CIP-NUM-PTRM IN CIP.
           MOVE IPT-FEC-FORI IN IPT TO CIP-FEC-FORI IN CIP.
           MOVE IPT-SGV-TOPE IN IPT TO CIP-SGV-TOPE IN CIP.
           MOVE IPT-SGV-TACU IN IPT TO CIP-SGV-TACU IN CIP.
           MOVE IPT-NUM-FOLI IN IPT TO CIP-NUM-FOLI IN CIP.
           MOVE IPT-GLS-NORM IN IPT TO CIP-GLS-NORM IN CIP.
           MOVE IPT-NUM-PDES IN IPT TO CIP-NUM-PDES IN CIP.
           MOVE IPT-SGV-VDES IN IPT TO CIP-SGV-VDES IN CIP.
           MOVE IPT-SGV-VTOT IN IPT TO PES-SGV-DECI IN PES-VARI.
           PERFORM PES-SCTV
           MOVE PES-SGV-ENTE IN PES-VARI TO CIP-SGV-VTOT IN CIP.
           MOVE IPT-SGV-MORI IN IPT TO CIP-SGV-MORI IN CIP.
           MOVE IPT-COD-VCOC IN IPT TO CIP-COD-VCOC IN CIP.
           MOVE IPT-FEC-TTRI IN IPT TO CIP-FEC-TTRI IN CIP.
           MOVE IPT-COD-ITRU IN IPT TO CIP-COD-ITRU IN CIP.
           MOVE IPT-COD-TDOC IN IPT TO CIP-COD-TDOC IN CIP.
           MOVE IPT-MSC-TIMP IN IPT TO CIP-MSC-TIMP IN CIP.

           MOVE FIO-PUT TO FIO-CMND.
           PERFORM DEU-FIO-CIP.
           IF NOT FIO-STAT-OKS
               MOVE FIO-BCK-OUT TO FIO-CMND
               PERFORM DEU-FIO-CIP
               MOVE 23 TO FIO-STAT
               GO TO FIN-GBR-REG-CIP.

           ADD 1 TO WSS-CON-IPTS IN WSS-VARI.
           GO TO LOOP-GRB-IPT.

       FIN-GBR-REG-CIP.
           EXIT.
      *----------------------------------------------------------------
      *****************         INICIO

       COPY LDCBFRLO.
       COPY LDCBFLCC.

       COPY COLBFCYA.
       COPY COLBFAUT.
       COPY COLBFCAN.
       COPY COLBFVEN.
       COPY COLBFRCV.
       COPY COLBFDLC.
       COPY COLBFEVC.
       COPY COLBFICG.
       COPY COLBFROV.
       COPY COLBFRDC.
       COPY COLBGVEN.

       COPY SGCBFOPE.
       COPY SGCBFRCO.
       COPY SGCBFDBC.
       COPY SGCBFDCE.
       COPY SGCBFDCP.
       COPY COLBFPCP.
       COPY COLBFDIC.
       COPY COLBFTOC.
       COPY COLBFITR.
       COPY COLBFCXE.
       COPY COLBFIPT.
       COPY COLBGPCP.
       COPY COLBGGCI.
       COPY COLBGLOF.
       COPY COLB6CAN.

       PCP-PRO-SAF SECTION.
       PCP-PRO-ACT SECTION.
       PCP-PRO-VAL SECTION.
       PCP-PRO-VKY SECTION.
       PCP-PRO-VDA SECTION.
       PCP-PRO-ING SECTION.
       PCP-PRO-MOD SECTION.
       PCP-PRO-ELI SECTION.
       PCP-PRO-CON SECTION.
       PCP-PRO-CO2 SECTION.
       PCP-PRO-PF7 SECTION.
       PCP-PRO-AC7 SECTION.
       PCP-PRO-PF8 SECTION.
       PCP-PRO-AC8 SECTION.
       PCP-PRO-CUR SECTION.
       PROCESA-PCP SECTION.
       INI-PROCESA-PCP.
           PERFORM COL-PRO-PCP.
           IF PCP-RETO = '1'
               MOVE SPACES TO PCP
               MOVE 'COL'          TO MSG-COD-SIST
               MOVE 'ERROR PCP'    TO PCP-CMSG MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC   TO FRM-MENS
               MOVE PCP-MMSG       TO FRM-MEN2
               MOVE FRM-SUAR-MAL   TO FRM-SUAR
               GO TO FIN-PROCESA-PCP.
       FIN-PROCESA-PCP.
           EXIT.

       COPY TABBFCAM.
       COPY TABBFTXC.
       COPY TABBKTXC.

       COPY GNSBFCIC.
       COPY GNSBGCIC.
       COPY DEUBFCIP.
       COPY GNSBPFEC.
       COPY COLBGINT.
       COPY GNSBGPES.
       COPY GNSBGCPT.
       COPY GNSBBTAB.
      * FINAL

      *----------------------------------------------------------------
       CAR-FLD-ECT SECTION.
       INI-CAR-FLD-ECT.

           MOVE ZEROES TO WSS-J IN ECT-VARI.

       LOOP-CARGA.
           ADD 1 TO WSS-J IN ECT-VARI.
           IF WSS-J IN ECT-VARI > WSS-JMAX IN ECT-VARI
               GO TO FIN-CAR-FLD-ECT.

           IF (WSS-J IN ECT-VARI <= WSS-NUM-CORR IN WSS-VARI)
                NEXT SENTENCE
           ELSE
               GO TO FIN-CAR-FLD-ECT.

           PERFORM CLR-ECT-VEC.

           MOVE WSS-FRM-NUM-CORR(WSS-J) TO FRM-NUM-CORR IN ECT-FLD.
           MOVE WSS-FRM-COD-CPTO(WSS-J) TO FRM-COD-CPTO IN ECT-FLD.
           MOVE WSS-FRM-COD-EVTO(WSS-J) TO FRM-COD-EVTO IN ECT-FLD.
           MOVE WSS-FRM-SGV-TIMP(WSS-J) TO FRM-SGV-TIMP IN ECT-FLD.
           MOVE WSS-FRM-SGV-BIMP(WSS-J) TO FRM-SGV-BIMP IN ECT-FLD.
           MOVE WSS-FRM-NUM-FOLI(WSS-J) TO FRM-NUM-FOLI IN ECT-FLD.
           MOVE WSS-FRM-NUM-CPTO(WSS-J) TO FRM-NUM-CPTO IN ECT-FLD.
           MOVE WSS-FRM-NUM-EVTO(WSS-J) TO FRM-NUM-EVTO IN ECT-FLD.
           MOVE WSS-FRM-NUM-PERI(WSS-J) TO FRM-NUM-PERI IN ECT-FLD.
           MOVE WSS-FRM-SGV-MIMP(WSS-J) TO FRM-SGV-MIMP IN ECT-FLD.
           MOVE WSS-FRM-GLS-NORM(WSS-J) TO FRM-GLS-NORM IN ECT-FLD.
           MOVE WSS-FRM-CAI-OPCO(WSS-J) TO FRM-CAI-OPCO IN ECT-FLD.
           MOVE WSS-FRM-IIC-OPCO(WSS-J) TO FRM-IIC-OPCO IN ECT-FLD.
           MOVE WSS-FRM-GLS-OPCO(WSS-J) TO FRM-GLS-OPCO IN ECT-FLD.
           MOVE WSS-FRM-GLS-INEM(WSS-J) TO FRM-GLS-INEM IN ECT-FLD.

           GO TO LOOP-CARGA.

       FIN-CAR-FLD-ECT.
           EXIT.
      *----------------------------------------------------------------
       CLR-ECT-VEC SECTION.
       INI-CLR-ECT-VEC.

           MOVE ZEROES TO FRM-NUM-CORR IN ECT-FLD.
           MOVE SPACES TO FRM-COD-CPTO IN ECT-FLD.
           MOVE SPACES TO FRM-COD-EVTO IN ECT-FLD.
           MOVE ZEROES TO FRM-SGV-TIMP IN ECT-FLD.
           MOVE ZEROES TO FRM-SGV-BIMP IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-FOLI IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-CPTO IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-EVTO IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-PERI IN ECT-FLD.
           MOVE ZEROES TO FRM-SGV-MIMP IN ECT-FLD.
           MOVE SPACES TO FRM-GLS-NORM IN ECT-FLD.
           MOVE SPACES TO FRM-CAI-OPCO IN ECT-FLD.
           MOVE SPACES TO FRM-IIC-OPCO IN ECT-FLD.
           MOVE SPACES TO FRM-GLS-OPCO IN ECT-FLD.
           MOVE SPACES TO FRM-GLS-INEM IN ECT-FLD.

       FIN-CLR-ECT-VEC.
           EXIT.
      *----------------------------------------------------------------
       PUT-TAB SECTION.
       INI-PUT-TAB.
           MOVE ECT-NOM-TSECT     TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE ECT-NOM-TSECT-MAS TO QUE-COLA.
           MOVE QUE-DEL           TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

           MOVE 1 TO SCR-NUM-PANT.
           MOVE SPACES TO ECT-VEC-TS.
           MOVE LOW-VALUES TO WSS-NUM-NCRE-IDX.
      *
           MOVE 1 TO FRM-IFLD.
           MOVE ZEROES  TO WSS-NITM IN ECT-VARI.

           MOVE 1 TO WSS-F IN ECT-VARI.

       LUP-PUT-TAB.

           IF WSS-NUM-CORR IN WSS-VARI NOT > ZEROES
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'ECT    NEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-TAB.

           IF WSS-F > WSS-NUM-CORR IN WSS-VARI
               MOVE '00' TO FIO-STAT
               GO TO FIN-PUT-TAB.

           IF WSS-FRM-NUM-CORR(WSS-F) > ZEROES
               PERFORM PUT-TAB-ECT
               PERFORM PUT-ECT-QUE
               PERFORM SET-FRM-IFLD
           ELSE
               IF FRM-IFLD = 1 AND WSS-F = 1
                   MOVE 'TAB' TO MSG-COD-SIST
                   MOVE 'ECT    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-PUT-TAB
               ELSE
                   MOVE '00' TO FIO-STAT
                   GO TO FIN-PUT-TAB.

           ADD 1 TO WSS-F IN ECT-VARI.
           GO TO LUP-PUT-TAB.

       FIN-PUT-TAB.
           MOVE 1                  TO QUE-NITM.
           MOVE ECT-LEN-TSECT-MAS  TO QUE-LITM.
           MOVE ECT-NOM-TSECT-MAS  TO QUE-COLA.

           IF WSS-NITM > WSS-NITMMAX
              MOVE 'S'           TO ECT-MAS-IND-HMAS
           ELSE
              MOVE 'N'           TO ECT-MAS-IND-HMAS.

           IF WSS-NITM > WSS-NITMMAX
               MOVE WSS-NITMMAX TO WSS-NUM-ICUR
           ELSE
               MOVE WSS-NITM TO WSS-NUM-ICUR.

           MOVE FRM-GLS-IDCE IN ECT-FLD TO ECT-MAS-CIC-ICIP.
           MOVE WSS-NUM-ICUR     TO WSS-NUM-ICUR-EDT.
           MOVE WSS-NUM-ICUR-EDT TO WSS-NUM-ICUR-ALF.
           MOVE WSS-NUM-ICUR-ALF TO ECT-MAS-NUM-TOCC.
           MOVE ECT-MAS-ITEM     TO QUE-ITEM.
           MOVE QUE-PUT          TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF WSS-NITM > WSS-IMAX
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CCTTABDMAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       EXT-PUT-TAB.
           EXIT.
      *----------------------------------------------------------------
       PUT-TAB-ECT SECTION.
       INI-PUT-TAB-ECT.

           PERFORM CLR-WSS.

           MOVE WSS-FRM-NUM-CORR(WSS-F) TO
                FRM-NUM-CORR-ECT
                FRM-NUM-CORR-FRM.
      *
           MOVE WSS-FRM-COD-CPTO(WSS-F) TO
                FRM-COD-CPTO-ECT
                FRM-COD-CPTO-FRM.
      *
           MOVE WSS-FRM-COD-EVTO(WSS-F) TO
                FRM-COD-EVTO-ECT
                FRM-COD-EVTO-FRM.
      *
           MOVE WSS-FRM-SGV-TIMP(WSS-F) TO
                FRM-SGV-TIMP-ECT
                FRM-SGV-TIMP-FRM.
      *
           MOVE WSS-FRM-SGV-BIMP(WSS-F) TO
                FRM-SGV-BIMP-ECT
                FRM-SGV-BIMP-FRM.
      *
           MOVE WSS-FRM-NUM-FOLI(WSS-F) TO
                FRM-NUM-FOLI-ECT
                FRM-NUM-FOLI-FRM.
      *
           MOVE WSS-FRM-NUM-CPTO(WSS-F) TO
                FRM-NUM-CPTO-ECT
                FRM-NUM-CPTO-FRM.
      *
           MOVE WSS-FRM-NUM-EVTO(WSS-F) TO
                FRM-NUM-EVTO-ECT
                FRM-NUM-EVTO-FRM.
      *
           MOVE WSS-FRM-NUM-PERI(WSS-F) TO
                FRM-NUM-PERI-ECT
                FRM-NUM-PERI-FRM.
      *
           MOVE WSS-FRM-SGV-MIMP(WSS-F) TO
                FRM-SGV-MIMP-ECT
                FRM-SGV-MIMP-FRM.
      *
           MOVE WSS-FRM-GLS-NORM(WSS-F) TO
                FRM-GLS-NORM-ECT
                FRM-GLS-NORM-FRM.
      *
           MOVE WSS-FRM-CAI-OPCO(WSS-F) TO
                FRM-CAI-OPCO-ECT
                FRM-CAI-OPCO-FRM.
      *
           MOVE WSS-FRM-IIC-OPCO(WSS-F) TO
                FRM-IIC-OPCO-ECT
                FRM-IIC-OPCO-FRM.
      *
           MOVE WSS-FRM-GLS-OPCO(WSS-F) TO
                FRM-GLS-OPCO-ECT
                FRM-GLS-OPCO-FRM.
      *
           MOVE WSS-FRM-GLS-INEM(WSS-F) TO
                FRM-GLS-INEM-ECT
                FRM-GLS-INEM-FRM.

           IF FRM-IFLD > WSS-IMAX
              GO TO FIN-PUT-TAB-ECT.

           MOVE WSS-FRM-NUM-CORR(WSS-F) TO
                FRM-NUM-CORR IN ECT-FLD.
      *
           MOVE WSS-FRM-COD-CPTO(WSS-F) TO
                FRM-COD-CPTO IN ECT-FLD.
      *
           MOVE WSS-FRM-COD-EVTO(WSS-F) TO
                FRM-COD-EVTO IN ECT-FLD.
      *
           MOVE WSS-FRM-SGV-TIMP(WSS-F) TO
                FRM-SGV-TIMP IN ECT-FLD.
      *
           MOVE WSS-FRM-SGV-BIMP(WSS-F) TO
                FRM-SGV-BIMP IN ECT-FLD.
      *
           MOVE WSS-FRM-NUM-FOLI(WSS-F) TO
                FRM-NUM-FOLI IN ECT-FLD.
      *
           MOVE WSS-FRM-NUM-CPTO(WSS-F) TO
                FRM-NUM-CPTO IN ECT-FLD.
      *
           MOVE WSS-FRM-NUM-EVTO(WSS-F) TO
                FRM-NUM-EVTO IN ECT-FLD.
      *
           MOVE WSS-FRM-NUM-PERI(WSS-F) TO
                FRM-NUM-PERI IN ECT-FLD.
      *
           MOVE WSS-FRM-SGV-MIMP(WSS-F) TO
                FRM-SGV-MIMP IN ECT-FLD.
      *
           MOVE WSS-FRM-GLS-NORM(WSS-F) TO
                FRM-GLS-NORM IN ECT-FLD.
      *
           MOVE WSS-FRM-CAI-OPCO(WSS-F) TO
                FRM-CAI-OPCO IN ECT-FLD.
      *
           MOVE WSS-FRM-IIC-OPCO(WSS-F) TO
                FRM-IIC-OPCO IN ECT-FLD.
      *
           MOVE WSS-FRM-GLS-OPCO(WSS-F) TO
                FRM-GLS-OPCO IN ECT-FLD.
      *
           MOVE WSS-FRM-GLS-INEM(WSS-F) TO
                FRM-GLS-INEM IN ECT-FLD.

       FIN-PUT-TAB-ECT.
           EXIT.
      *----------------------------------------------------------------
       CLR-WSS SECTION.
       INI-CLR-WSS.

           MOVE ZEROES TO FRM-NUM-CORR-ECT.
           MOVE SPACES TO FRM-COD-CPTO-ECT.
           MOVE SPACES TO FRM-COD-EVTO-ECT.
           MOVE ZEROES TO FRM-SGV-TIMP-ECT.
           MOVE ZEROES TO FRM-SGV-BIMP-ECT.
           MOVE ZEROES TO FRM-NUM-FOLI-ECT.
           MOVE ZEROES TO FRM-NUM-CPTO-ECT.
           MOVE ZEROES TO FRM-NUM-EVTO-ECT.
           MOVE ZEROES TO FRM-NUM-PERI-ECT.
           MOVE ZEROES TO FRM-SGV-MIMP-ECT.
           MOVE SPACES TO FRM-GLS-NORM-ECT.
           MOVE SPACES TO FRM-CAI-OPCO-ECT.
           MOVE ZEROES TO FRM-IIC-OPCO-ECT.
           MOVE SPACES TO FRM-GLS-OPCO-ECT.
           MOVE SPACES TO FRM-GLS-INEM-ECT.

           IF SCR-OFRM-SRV
               PERFORM CLR-FRM-MTX.

       FIN-CLR-WSS.
           EXIT.
      *-----------------------------------------------------------------
       CLR-FRM-MTX SECTION.
       INI-CLR-FRM-MTX.

           MOVE ZEROES TO FRM-NUM-CORR IN ECT-FLD.
           MOVE SPACES TO FRM-COD-CPTO IN ECT-FLD.
           MOVE SPACES TO FRM-COD-EVTO IN ECT-FLD.
           MOVE ZEROES TO FRM-SGV-TIMP IN ECT-FLD.
           MOVE ZEROES TO FRM-SGV-BIMP IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-FOLI IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-CPTO IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-EVTO IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-PERI IN ECT-FLD.
           MOVE ZEROES TO FRM-SGV-MIMP IN ECT-FLD.
           MOVE SPACES TO FRM-GLS-NORM IN ECT-FLD.
           MOVE SPACES TO FRM-CAI-OPCO IN ECT-FLD.
           MOVE ZEROES TO FRM-IIC-OPCO IN ECT-FLD.
           MOVE SPACES TO FRM-GLS-OPCO IN ECT-FLD.
           MOVE SPACES TO FRM-GLS-INEM IN ECT-FLD.

       FIN-CLR-FRM-MTX.
           EXIT.
      *----------------------------------------------------------------
       PUT-ECT-QUE SECTION.
       INI-PUT-ECT-QUE.
           PERFORM PRO-FLD-QUE.
           ADD 1 TO WSS-NITM.
           MOVE ECT-NOM-TSECT    TO QUE-COLA.
           MOVE ECT-LEN-TSECT    TO QUE-LITM.
           MOVE WSS-NITM         TO QUE-NITM.
           MOVE SPACES           TO QUE-ITEM.
           IF SCR-OFRM-SRV
               IF NOT (WSS-NITM > WSS-NITMMAX)
                   MOVE WSS-FRM-NUM-CORR(WSS-F) TO
                        FRM-NUM-CORR-EDT IN ECT-EDT
                   MOVE FRM-NUM-CORR-EDT IN ECT-EDT TO
                        FRM-NUM-CORR-ALF-ECT
                   MOVE WSS-FRM-SGV-TIMP(WSS-F) TO
                        FRM-SGV-TIMP-EDT IN ECT-EDT
                   MOVE FRM-SGV-TIMP-EDT IN ECT-EDT TO
                        FRM-SGV-TIMP-ALF-ECT
                   MOVE WSS-FRM-SGV-BIMP(WSS-F) TO
                        FRM-SGV-BIMP-EDT IN ECT-EDT
                   MOVE FRM-SGV-BIMP-EDT IN ECT-EDT TO
                        FRM-SGV-BIMP-ALF-ECT
                   MOVE WSS-FRM-NUM-FOLI(WSS-F) TO
                        FRM-NUM-FOLI-EDT IN ECT-EDT
                   MOVE FRM-NUM-FOLI-EDT IN ECT-EDT TO
                        FRM-NUM-FOLI-ALF-ECT

                   MOVE WSS-FRM-NUM-CPTO(WSS-F) TO
                        FRM-NUM-CPTO-EDT IN ECT-EDT
                   MOVE FRM-NUM-CPTO-EDT IN ECT-EDT TO
                        FRM-NUM-CPTO-ALF-ECT
                   MOVE WSS-FRM-NUM-EVTO(WSS-F) TO
                        FRM-NUM-EVTO-EDT IN ECT-EDT
                   MOVE FRM-NUM-EVTO-EDT IN ECT-EDT TO
                        FRM-NUM-EVTO-ALF-ECT
                   MOVE WSS-FRM-NUM-PERI(WSS-F) TO
                        FRM-NUM-PERI-EDT IN ECT-EDT
                   MOVE FRM-NUM-PERI-EDT IN ECT-EDT TO
                        FRM-NUM-PERI-ALF-ECT
                   MOVE WSS-FRM-SGV-MIMP(WSS-F) TO
                        FRM-SGV-MIMP-EDT IN ECT-EDT
                   MOVE FRM-SGV-MIMP-EDT IN ECT-EDT TO
                        FRM-SGV-MIMP-ALF-ECT
                   MOVE ECT-VEC-TS    TO QUE-ITEM
               ELSE
                   GO TO FIN-PUT-ECT-QUE
           ELSE
               MOVE WSS-NUM-NCRE-IDX TO QUE-ITEM.

           MOVE QUE-PUT  TO QUE-CMND.
           PERFORM GNS-PRO-QUE.

       FIN-PUT-ECT-QUE.
           EXIT.
      *----------------------------------------------------------------
       PRO-FLD-QUE SECTION.
       INI-PRO-FLD-QUE.

           MOVE 'P' TO FRM-NUM-CORR-ATR-ECT.
           MOVE 'P' TO FRM-COD-CPTO-ATR-ECT.
           MOVE 'P' TO FRM-COD-EVTO-ATR-ECT.
           MOVE 'P' TO FRM-SGV-TIMP-ATR-ECT.
           MOVE 'P' TO FRM-SGV-BIMP-ATR-ECT.
           MOVE 'P' TO FRM-NUM-FOLI-ATR-ECT.
           MOVE 'P' TO FRM-NUM-CPTO-ATR-ECT.
           MOVE 'P' TO FRM-NUM-EVTO-ATR-ECT.
           MOVE 'P' TO FRM-NUM-PERI-ATR-ECT.
           MOVE 'P' TO FRM-SGV-MIMP-ATR-ECT.
           MOVE 'P' TO FRM-GLS-NORM-ATR-ECT.
           MOVE 'P' TO FRM-CAI-OPCO-ATR-ECT.
           MOVE 'P' TO FRM-IIC-OPCO-ATR-ECT.
           MOVE 'P' TO FRM-GLS-OPCO-ATR-ECT.
           MOVE 'P' TO FRM-GLS-INEM-ATR-ECT.
           MOVE 'P' TO FRM-NUM-CORR-ATR-FRM.
           MOVE 'P' TO FRM-COD-CPTO-ATR-FRM.
           MOVE 'P' TO FRM-COD-EVTO-ATR-FRM.
           MOVE 'P' TO FRM-SGV-TIMP-ATR-FRM.
           MOVE 'P' TO FRM-SGV-BIMP-ATR-FRM.
           MOVE 'P' TO FRM-NUM-FOLI-ATR-FRM.
           MOVE 'P' TO FRM-NUM-CPTO-ATR-FRM.
           MOVE 'P' TO FRM-NUM-EVTO-ATR-FRM.
           MOVE 'P' TO FRM-NUM-PERI-ATR-FRM.
           MOVE 'P' TO FRM-SGV-MIMP-ATR-FRM.
           MOVE 'P' TO FRM-GLS-NORM-ATR-FRM.
           MOVE 'P' TO FRM-CAI-OPCO-ATR-FRM.
           MOVE 'P' TO FRM-IIC-OPCO-ATR-FRM.
           MOVE 'P' TO FRM-GLS-OPCO-ATR-FRM.
           MOVE 'P' TO FRM-GLS-INEM-ATR-FRM.

       FIN-PRO-FLD-QUE.
           EXIT.
      *----------------------------------------------------------------
       SET-FRM-IFLD SECTION.
       INI-SET-FRM-IFLD.
           IF SCR-OFRM-SRV
                MOVE 1 TO FRM-IFLD
           ELSE
                ADD 1 TO FRM-IFLD.
       FIN-SET-FRM-IFLD.
           EXIT.
      *----------------------------------------------------------------
       PUT-TAB-ASC SECTION.
       INI-PUT-TAB-ASC.
           MOVE SPACES TO MSG-COD-MENS.
           MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM.
           MOVE 0 TO FRM-IFLD.
       LUP-PUT-TAB-ASC.
           ADD 1              TO QUE-NITM.
           MOVE ECT-NOM-TSECT TO QUE-COLA.
           MOVE ECT-LEN-TSECT TO QUE-LITM.
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD = 0
                   MULTIPLY SCR-NUM-PANT BY WSS-IMAX GIVING QUE-NITM
                   MOVE ECT-NOM-TSECT TO QUE-COLA
                   MOVE ECT-LEN-TSECT TO QUE-LITM
                   MOVE QUE-GET       TO QUE-CMND
                   PERFORM GNS-PRO-QUE
                   PERFORM MOV-DAT-QUE
                   MOVE 'TAB' TO MSG-COD-SIST
                   MOVE 'CCTTABNONXT' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-ASC
               ELSE
                   GO TO FIN-PUT-TAB-ASC.
           ADD 1 TO FRM-IFLD.
      *    MOVE QUE-ITEM TO FRM-CAI-GTIA-IDX(FRM-IFLD).
           PERFORM MOV-DAT-QUE.
           IF FRM-IFLD < WSS-IMAX
               GO TO LUP-PUT-TAB-ASC.
       FIN-PUT-TAB-ASC.
           IF FRM-IFLD > 0 AND FRM-IFLD < WSS-IMAX
               ADD 1 FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY 1
                                 UNTIL WSS-I > WSS-IMAX.
           IF FRM-IFLD > 0
               ADD 1 TO SCR-NUM-PANT.
           IF FRM-IFLD = WSS-IMAX
               ADD 1              TO QUE-NITM
               MOVE ECT-NOM-TSECT TO QUE-COLA
               MOVE ECT-LEN-TSECT TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               IF QUE-STAT = QUE-STAT-OKS
                   MOVE 'TAB' TO MSG-COD-SIST
                   MOVE 'CCTTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-ASC.
           EXIT.
      *---------------------------------------------------------------
       CLR-FRM SECTION.
       INI-CLR-FRM.

           MOVE ZEROES TO FRM-NUM-CORR IN ECT-FLD.
           MOVE SPACES TO FRM-COD-CPTO IN ECT-FLD.
           MOVE SPACES TO FRM-COD-EVTO IN ECT-FLD.
           MOVE ZEROES TO FRM-SGV-TIMP IN ECT-FLD.
           MOVE ZEROES TO FRM-SGV-BIMP IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-FOLI IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-CPTO IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-EVTO IN ECT-FLD.
           MOVE ZEROES TO FRM-NUM-PERI IN ECT-FLD.
           MOVE ZEROES TO FRM-SGV-MIMP IN ECT-FLD.
           MOVE SPACES TO FRM-GLS-NORM IN ECT-FLD.
           MOVE SPACES TO FRM-CAI-OPCO IN ECT-FLD.
           MOVE ZEROES TO FRM-IIC-OPCO IN ECT-FLD.
           MOVE SPACES TO FRM-GLS-OPCO IN ECT-FLD.
           MOVE SPACES TO FRM-GLS-INEM IN ECT-FLD.

       FIN-CLR-FRM.
           EXIT.
      *----------------------------------------------------------------
       PUT-TAB-DSC SECTION.
       INI-PUT-TAB-DSC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-NUM-PANT = 1
               MOVE SCR-NUM-PANT  TO QUE-NITM
               MOVE ECT-NOM-TSECT TO QUE-COLA
               MOVE ECT-LEN-TSECT TO QUE-LITM
               MOVE QUE-GET       TO QUE-CMND
               PERFORM GNS-PRO-QUE
               PERFORM MOV-DAT-QUE
               MOVE 'TAB' TO MSG-COD-SIST
               MOVE 'CCTTABNOPRV' TO MSG-COD-MENS
               GO TO EXT-PUT-TAB-DSC.

           SUBTRACT 1 FROM SCR-NUM-PANT GIVING QUE-NITM.
           MULTIPLY QUE-NITM BY WSS-IMAX GIVING QUE-NITM.
           ADD 1 TO QUE-NITM.
           ADD 1 WSS-IMAX GIVING FRM-IFLD.
       LUP-PUT-TAB-DSC.
           SUBTRACT  1 FROM QUE-NITM.
           MOVE ECT-NOM-TSECT TO QUE-COLA
           MOVE ECT-LEN-TSECT TO QUE-LITM
           MOVE QUE-GET       TO QUE-CMND.
           PERFORM GNS-PRO-QUE.
           IF QUE-STAT NOT = QUE-STAT-OKS
               IF FRM-IFLD > WSS-IMAX
                   MOVE 'CCTTABNOPRV' TO MSG-COD-MENS
                   GO TO FIN-PUT-TAB-DSC
               ELSE
                   GO TO FIN-PUT-TAB-DSC.
           SUBTRACT 1 FROM FRM-IFLD.
           PERFORM MOV-DAT-QUE.
           IF FRM-IFLD > 1
               GO TO LUP-PUT-TAB-DSC.
       FIN-PUT-TAB-DSC.

           IF FRM-IFLD NOT > WSS-IMAX AND FRM-IFLD > 1
               SUBTRACT 1 FROM FRM-IFLD GIVING WSS-I
               PERFORM CLR-FRM VARYING WSS-I FROM WSS-I BY -1
                                 UNTIL WSS-I < 1.

           IF FRM-IFLD NOT > WSS-IMAX
               SUBTRACT 1 FROM SCR-NUM-PANT
               MOVE 'TAB'        TO MSG-COD-SIST
               MOVE 'CCTTABDMAS' TO MSG-COD-MENS.
       EXT-PUT-TAB-DSC.
           EXIT.
      *-----------------------------------------------------------------
       MOV-DAT-QUE SECTION.
       INI-MOV-DAT-QUE.
           MOVE QUE-ITEM TO ECT-VEC-TS.

           MOVE FRM-NUM-CORR-ECT TO
                FRM-NUM-CORR IN ECT-FLD.
      *
           MOVE FRM-COD-CPTO-ECT TO
                FRM-COD-CPTO IN ECT-FLD.
      *
           MOVE FRM-COD-EVTO-ECT TO
                FRM-COD-EVTO IN ECT-FLD.
      *
           MOVE FRM-SGV-TIMP-ECT TO
                FRM-SGV-TIMP IN ECT-FLD.
      *
           MOVE FRM-SGV-BIMP-ECT TO
                FRM-SGV-BIMP IN ECT-FLD.
      *
           MOVE FRM-NUM-FOLI-ECT TO
                FRM-NUM-FOLI IN ECT-FLD.
      *
           MOVE FRM-NUM-CPTO-ECT TO
                FRM-NUM-CPTO IN ECT-FLD.
      *
           MOVE FRM-NUM-EVTO-ECT TO
                FRM-NUM-EVTO IN ECT-FLD.
      *
           MOVE FRM-NUM-PERI-ECT TO
                FRM-NUM-PERI IN ECT-FLD.
      *
           MOVE FRM-SGV-MIMP-ECT TO
                FRM-SGV-MIMP IN ECT-FLD.
      *
           MOVE FRM-GLS-NORM-ECT TO
                FRM-GLS-NORM IN ECT-FLD.
      *
           MOVE FRM-CAI-OPCO-ECT TO
                FRM-CAI-OPCO IN ECT-FLD.
      *
           MOVE FRM-IIC-OPCO-ECT TO
                FRM-IIC-OPCO IN ECT-FLD.
      *
           MOVE FRM-GLS-OPCO-ECT TO
                FRM-GLS-OPCO IN ECT-FLD.
      *
           MOVE FRM-GLS-INEM-ECT TO
                FRM-GLS-INEM IN ECT-FLD.

       FIN-MOV-DAT-QUE.
           EXIT.
      *-----------------------------------------------------------------
       SCRL-TAB-ECT SECTION.
       INI-SCRL-TAB-ECT.
           MOVE SPACES TO MSG-COD-MENS.

           IF FRM-FFLD = FRM-FFLD-PF6
               PERFORM PUT-TAB-ASC
           ELSE
               PERFORM PUT-TAB-DSC.
           IF MSG-COD-MENS > SPACES
               MOVE 'TAB' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MEN2.
       FIN-SCRL-TAB-ECT.
           EXIT.
      *----------------------------------------------------------------
       CRG-PAN-FIJA SECTION.
       INI-CRG-PAN-FIJA.
           MOVE SPACES TO DBC.
           MOVE CIP-IDC-ICLI IN CIP TO DBC-IDC-ICLI IN DBC.
           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN ECT-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN ECT-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN ECT-FLD.
           MOVE CIP-GLS-NOMC IN CIP TO FRM-GLS-NOMC IN ECT-FLD.
           MOVE CIP-VRF-ICLI IN CIP TO FRM-VRF-ICLI IN ECT-FLD.

      * FECHA DE VIGENCIA
           MOVE CIP-NUM-DVIG IN CIP TO FRM-NUM-DVIG IN ECT-FLD.
           MOVE CIP-NUM-MVIG IN CIP TO FRM-NUM-MVIG IN ECT-FLD.
           MOVE CIP-NUM-SVIG IN CIP TO FRM-NUM-SVIG IN ECT-FLD.
           MOVE CIP-NUM-AVIG IN CIP TO FRM-NUM-AVIG IN ECT-FLD.

      * FECHA DE EMISION
           MOVE CIP-NUM-DEMI IN CIP TO FRM-NUM-DEMI IN ECT-FLD.
           MOVE CIP-NUM-MEMI IN CIP TO FRM-NUM-MEMI IN ECT-FLD.
           MOVE CIP-NUM-SEMI IN CIP TO FRM-NUM-SEMI IN ECT-FLD.
           MOVE CIP-NUM-AEMI IN CIP TO FRM-NUM-AEMI IN ECT-FLD.

      * FECHA DE LIQUIDACION
           MOVE CIP-NUM-DLIQ IN CIP TO FRM-NUM-DLIQ IN ECT-FLD.
           MOVE CIP-NUM-MLIQ IN CIP TO FRM-NUM-MLIQ IN ECT-FLD.
           MOVE CIP-NUM-SLIQ IN CIP TO FRM-NUM-SLIQ IN ECT-FLD.
           MOVE CIP-NUM-ALIQ IN CIP TO FRM-NUM-ALIQ IN ECT-FLD.

      * FECHA DE VENCIMIENTO
           MOVE CIP-NUM-DVEN IN CIP TO FRM-NUM-DVEN IN ECT-FLD.
           MOVE CIP-NUM-MVEN IN CIP TO FRM-NUM-MVEN IN ECT-FLD.
           MOVE CIP-NUM-SVEN IN CIP TO FRM-NUM-SVEN IN ECT-FLD.
           MOVE CIP-NUM-AVEN IN CIP TO FRM-NUM-AVEN IN ECT-FLD.

           MOVE SPACES TO OPC.
           MOVE CIP-COD-OPCO IN CIP TO OPC-CIC-IOPC IN OPC.
           MOVE CIP-COD-MONE IN CIP TO OPC-COD-VCOC IN OPC.
           MOVE CIP-VAL-MCRE IN CIP TO OPC-VAL-CRED IN OPC.
           MOVE OPC-CAI-IOPC IN OPC TO OPC-CAI-IOPC IN ECT-FLD.
           MOVE OPC-IIC-IOPC IN OPC TO OPC-IIC-IOPC IN ECT-FLD.
           MOVE OPC-COD-VCOC IN OPC TO OPC-COD-VCOC IN ECT-FLD.

      *  TOTAL DL
           MOVE CIP-VAL-3475 IN CIP TO FRM-SGV-TODL IN ECT-FLD.

      *  TOTAL A PAGAR (ESTA EN PESOS)
           MOVE CIP-VAL-TPAG IN CIP TO FRM-SGV-TOTP IN ECT-FLD.

      *  SALDO INSOLUTO MONEDA ORIGEN
           MOVE CIP-VAL-SIMO IN CIP TO FRM-SGV-SALD IN ECT-FLD.

      *  CAPITAL ADEUDADO (ESTA EN PESOS)
           MOVE CIP-VAL-CAMO IN CIP TO FRM-SGV-CAPC IN ECT-FLD.

      *  INTERES NORMAL (ESTA EN PESOS)
           MOVE CIP-VAL-INTN IN CIP TO FRM-SGV-MINT IN ECT-FLD.

      *  COMISION PREPAGO (ESTA EN PESOS)
           MOVE CIP-VAL-CPRE IN CIP TO FRM-SGV-COMP IN ECT-FLD.

      *  INTERES MORATORIO (ESTA EN PESOS)
           MOVE CIP-VAL-CMOR IN CIP TO FRM-SGV-INTM IN ECT-FLD.

      *  COMISION FOGAPE (ESTA EN PESOS)
           MOVE CIP-VAL-CFOG IN CIP TO FRM-SGV-COMP IN ECT-FLD.
       FIN-CRG-PAN-FIJA.
           EXIT.
      *----------------------------------------------------------------
       CRG-MAS-CIP SECTION.
       INI-CRG-MAS-CIP.
           MOVE ZEROES TO WSS-NUM-CORR IN WSS-VARI
           MOVE SPACES TO CIP.
           MOVE WSS-CIC-ICER IN WSS-VARI TO CIP-CIC-ICER IN CIP.
           MOVE WSS-NUM-ICIP IN WSS-VARI TO CIP-NUM-ICIP IN CIP.
           MOVE FIO-GET-KEY TO FIO-CMND.
       LOOP-CIP-MAS.
           PERFORM DEU-FIO-CIP.
           IF NOT FIO-STAT-OKS OR
              WSS-CIC-ICER IN WSS-VARI NOT = CIP-CIC-ICER IN CIP
               GO TO FIN-CRG-MAS-CIP.

           IF WSS-NUM-CORR IN WSS-VARI = ZEROES
               PERFORM CRG-PAN-FIJA.

           ADD WCC-1 TO WSS-NUM-CORR IN WSS-VARI.
           IF WSS-NUM-CORR IN WSS-VARI >= WSS-MAX-CORR IN WSS-VARI
               GO TO FIN-MOV-DAT-IPT.

           MOVE CIP-NUM-ICIP IN CIP TO
                       WSS-FRM-NUM-CORR(WSS-NUM-CORR).
      *
           MOVE CIP-COD-CPTO IN CIP TO
                       WSS-FRM-COD-CPTO(WSS-NUM-CORR).

           MOVE CIP-COD-EVEN IN CIP TO
                       WSS-FRM-COD-EVTO(WSS-NUM-CORR).
      *
           MOVE CIP-SGV-TINT IN CIP TO
                       WSS-FRM-SGV-TIMP(WSS-NUM-CORR).
      *
           MOVE CIP-SGV-MNTO IN CIP TO
                       WSS-FRM-SGV-BIMP(WSS-NUM-CORR).
      *
           MOVE CIP-NUM-FOLI IN CIP TO
                       WSS-FRM-NUM-FOLI(WSS-NUM-CORR).
      *
           MOVE CIP-NUM-CPTO IN CIP TO
                       WSS-FRM-NUM-CPTO(WSS-NUM-CORR).
      *
           MOVE CIP-NUM-ICAN IN CIP TO
                       WSS-FRM-NUM-EVTO(WSS-NUM-CORR).
      *
           MOVE CIP-VAL-CTRA IN CIP TO
                       WSS-FRM-NUM-PERI(WSS-NUM-CORR).
      *
           MOVE CIP-SGV-CUOT IN CIP TO
                       WSS-FRM-SGV-MIMP(WSS-NUM-CORR).
      *
           MOVE CIP-GLS-NORM IN CIP TO
                       WSS-FRM-GLS-NORM(WSS-NUM-CORR).
      *
           MOVE CIP-CAI-IOPC IN CIP TO
                       WSS-FRM-CAI-OPCO(WSS-NUM-CORR).
      *
           MOVE CIP-IIC-IOPC IN CIP TO
                       WSS-FRM-IIC-OPCO(WSS-NUM-CORR).
      *
           MOVE SPACES TO WSS-FRM-GLS-OPCO(WSS-NUM-CORR).
      *
           MOVE CIP-COD-IEMI IN CIP TO
                       WSS-FRM-GLS-INEM(WSS-NUM-CORR).

           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO LOOP-CIP-MAS.

       FIN-CRG-MAS-CIP.
           EXIT.
      *----------------------------------------------------------------
      *>>>>
