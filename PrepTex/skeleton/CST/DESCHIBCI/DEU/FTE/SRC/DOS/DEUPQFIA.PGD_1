       IDENTIFICATION DIVISION.
      *========================
       PROGRAM-ID.   DEUPQFIA.
       AUTHOR.       CONSIST.
       DATE-WRITTEN. 25-Aug-16 09:03 AM.

      * NOMBRE PROGRAMA                   DEUPQFIA
      * VERSION PGM                       3.1
      * VERSION SKL                       07.08.21
      * OPCION                            CON
      * ARCHIVO BASE                      DEUAMF
      * PANTALLA                          DEUFIA
      * INP/OUT                           DATACOM
      * TAMANO COMMAREA                   250

      *=============================================================*
      *                        MANTENCIONES                         *
      *=============================================================*
      * MANTENCION : FIANZAS FASE I 
      * ETIQUETA   : *OGB-INI 25-FEB-2016 FIANZAS FASE I
      * OBJETIVO   : DESPLEGAR MENSAJE ADVERTENCIA CUANDO
      *              FEC VEN < FEC HOY
      * FECHA      : FEBRERO-2016
      * RESPONSABLE: CIMA-OGB
      *=============================================================*

       ENVIRONMENT DIVISION.
      *=====================
       CONFIGURATION SECTION.
      *----------------------
       SPECIAL-NAMES.
               DECIMAL-POINT IS COMMA.
       DATA DIVISION.
      *==============

       WORKING-STORAGE SECTION.
      *------------------------
      * COPY GNSWGSCR.
       COPY GNSWGCVT.
       77  WSS-TAG-DEUPQFIA-INI PIC X(125) VALUE                        
           '<IDNPGM NOM=$DEUPQFIA$ SKL=$07.08.21$ VSN=${vsnpq}$        
      -    'GEN=$25-Aug-16 09:03 AM$ FNC=${fncpq}$/>'.    

       COPY GNSWCSCR.
      *PTC-INI
      *PTC-SUB
      * COPY GNSWVSCR.
       COPY GNSWV3CR.
      *PTC-FIN
      *<<<< FIN_SCR_VARI
       COPY LDCWGENG.
      *JSS-INI 21-MAR-1994
      *    03 SCR-CLF     VALUE SPACES              PIC X(64).
           03 FILLER        VALUE SPACES            PIC X(02).
           03 SCR-COD-TOGA  VALUE SPACES            PIC X(03).
           03 SCR-COD-OFIC  VALUE SPACES            PIC X(03).
           03 SCR-COD-EJEC  VALUE SPACES            PIC X(12).
           03 SCR-NUM-ICLI  VALUE SPACES            PIC X(08).
           03 SCR-VRF-ICLI  VALUE SPACES            PIC X(01).
           03 SCR-IND-ICLI  VALUE SPACES            PIC X(01).
           03 SCR-GLS-ICLI  VALUE SPACES            PIC X(03).
           03 SCR-VAL-CMAX  VALUE ZEROES            PIC 9(11).
           03 SCR-COD-VCCF  VALUE SPACES            PIC X(06).
           03 SCR-COD-TOOC  VALUE SPACES            PIC X(03).
           03 SCR-COD-AOOC  VALUE SPACES            PIC X(03).
      *LAV INI 23-MAR-1994
           03 SCR-COD-VCOC  VALUE SPACES            PIC X(06).
           03 SCR-CLF-DISP  VALUE SPACES            PIC X(02).
      *LAV FIN 23-MAR-1994
      *JSS-FIN 21-MAR-1994
           03 SCR-LDC     VALUE SPACES            PIC X(100).
      *>>>>
      *<<<< FIN_SCR_VARI
           03 SCR-FS-ARG                          PIC 9(02).
           03 SCR-ARG-DISP    VALUE SPACES        PIC X(48).
      *>>>>
      *<<<< FIN_SCR_VARI
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-DBC-REQA==.
           02 SCR-KEY-IDBC                     PIC X(03).
       COPY GNSWGRQA REPLACING
                     ==01  ADR-REQA== BY ==02  SCR-FIA-REQA==.
           02 SCR-KEY-IFIA                     PIC X(03).
      *>>>>
      *<<<< FIN_SCR_VARI
           02 SCR-MSC-STAT                         PIC X(01).
      *>>>>
       COPY DEUWIFIA.

       COPY DEUBRAMF.


       COPY GNSWVIDD.
       COPY GNSWGRQA.
       COPY GNSWGUIB.
       COPY GNSWGELS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-AMF-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-TAB-REQA==.
       COPY GNSBRTAB.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSC-REQA==.
       COPY GNSBRMSC.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-MSG-REQA==.
       COPY GNSBRMSG.
       COPY GNSWCFIO.
       COPY GNSWVFIO.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSWGFRM.
       COPY GNSWG3CF.
       COPY GNSWGTSK.
       COPY GNSWGQUE.
      *PTC-FIN
       COPY GNSWVNUM.
       COPY GNSWCNUM.
       COPY GNSWGFEC.
       COPY GNSWGHOY.
       COPY GNSWCVRF.
       COPY GNSWVVRF.
       COPY GNSWGIDC.
       COPY GNSWGSYS.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-OFI-REQA==.
       COPY TABBROFI.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-USR-REQA==.
       COPY TABBRUSR.

      *PTC ini
       COPY GNSWGQUE.
      *PTC fin
      *<<<< WSS
       COPY LDCWGPMP.

      *>>>> WSS 
      *<<<< WSS
       COPY DEUBRESC.
       COPY DEUBRFIA.
       COPY SGCBRDBC.
       COPY GNSWGCPT.
       COPY GNSWGSTR.
       COPY GNSBRCIC.
       COPY GNSWGCIC.
       COPY TABBRTIO.
       01  WSS-VARI.
           03 WSS-COD-TUSR                          PIC X(05).
           03 WSS-KEY-IFIA.
              05 WSS-CIC-IESC.
                 07 WSS-CAI-IESC                    PIC X(04).
                 07 WSS-IIC-IESC                    PIC X(08).
              05 WSS-NUM-IFIA                       PIC 9(02).
           03 WSS-COD-TOAX.
              05 WSS-COD-TOOA                       PIC X(03).
              05 WSS-COD-AOOA                       PIC X(03).
           03 WSS-CIC-ICLI                          PIC X(12).
           03 WSS-IFIA                      VALUE 0 PIC 9(01).
              88 EXISTE-FIANZA              VALUE 1.
           03 WSS-IESC                      VALUE 0 PIC 9(01).
              88 EXISTE-ESCRITURA           VALUE 1.
           03 WSS-IAMF                      VALUE 0 PIC 9(01).
              88 EXISTE-AMBITO              VALUE 1.
           03 WSS-IKEY                      VALUE 0 PIC 9(01).
           03 WSS-ACIC                              PIC X(01).
           03 WSS-MENS.
              05 WSS-FIL1 VALUE SPACES              PIC X(01).
              05 WSS-MEN1 VALUE SPACES              PIC X(04).
              05 WSS-FIL2 VALUE SPACES              PIC X(01).
              05 WSS-MEN2 VALUE SPACES              PIC X(08).
      *LOP-INI 12-12-2002
           03 WSS-IND-ALZA          VALUE SPACES    PIC X(03).
      *LOP-FIN 12-12-2002
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
           03 WSS-GLS-MENS          VALUE SPACES    PIC X(39).
           03 WSS-IND-MEN-ADV       VALUE 'N'       PIC X(01).
           03 WSS-FEC-FHOY.
              05 WSS-NUM-SHOY                   PIC 9(02).
              05 WSS-NUM-AHOY                   PIC 9(02).
              05 WSS-NUM-MHOY                   PIC 9(02).
              05 WSS-NUM-DHOY                   PIC 9(02).
           03 WSS-CT-ING        VALUE 'ING'           PIC X(03).
           03 WSS-CT-INC        VALUE 'INC'           PIC X(03).
           03 WSS-CT-DEU        VALUE 'DEU'           PIC X(03).
           03 WSS-CT-VIGNFVCTO  VALUE 'FIAVIGNFVCTO'  PIC X(12).
           03 WSS-CT-C00        VALUE '00'            PIC X(02).
           03 WSS-CT-S          VALUE 'S'             PIC X(01).
           03 WSS-CT-NOACTINF   VALUE 'FIASNOACTINF'  PIC X(12).
           03 WSS-CT-NOACTVCDA  VALUE 'FIANOACTVCDA'  PIC X(12).
           03 WSS-CT-FIAVCDA    VALUE 'FIAVENCIDA  '  PIC X(12).
           03 WSS-CT-CON        VALUE 'CON'           PIC X(03).
           
           03 WSS-CT-AFVCTOHOY  VALUE 'FIAAFVCTOHOY'  PIC X(12).
           03 WSS-CT-AFVCTOFUT  VALUE 'FIAAFVCTOFUT'  PIC X(12).
           03 WSS-CT-NOACTFECH  VALUE 'FIANOACTFECH'  PIC X(12).
           03 WSS-CT-NOACTFECF  VALUE 'FIANOACTFECF'  PIC X(12).
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I
      *>>>>
      *<<<< WSS_DTC
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-ESC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-FIA-REQA==.
      *JUS-INI 6-FEB-1996 15:09:42 
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==ADR-CIC-REQA==.
      *JUS-FIN
      *>>>>
       01  PGM-VARI.
           03 PGM-ICLR                  VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-TODO          VALUE ' '       PIC X(01).
           03 PGM-LIMPIAR-LLAVES        VALUE 'K'       PIC X(01).
           03 PGM-LIMPIAR-CAMPOS        VALUE 'F'       PIC X(01).
           03 PGM-NO-LIMPIAR-NADA       VALUE 'N'       PIC X(01).
           03 PGM-PROG                                  PIC X(08).
           03 PGM-NTRN                                  PIC X(04).
           03 PGM-STAT.
              05 PGM-STAT-FIA.
                 88 PGM-STAT-FIA-NUL    VALUE '  '.
                 07 PGM-STT1-FIA        VALUE '2' PIC X(01).
                    88 PGM-STAT-FIA-OKS VALUE '0'.
                 07 PGM-STT2-FIA        VALUE '3' PIC X(01).
              05 PGM-STAT-ESC.
                 88 PGM-STAT-ESC-NUL    VALUE '  '.
                 07 PGM-STT1-ESC        VALUE '2' PIC X(01).
                    88 PGM-STAT-ESC-OKS VALUE '0'.
                 07 PGM-STT2-ESC        VALUE '3' PIC X(01).
              05 PGM-STAT-AMF.
                 88 PGM-STAT-AMF-NUL    VALUE '  '.
                 07 PGM-STT1-AMF        VALUE '2' PIC X(01).
                    88 PGM-STAT-AMF-OKS VALUE '0'.
                 07 PGM-STT2-AMF        VALUE '3' PIC X(01).
           03 PGM-SRNF                  VALUE '23'      PIC X(02).
           03 PGM-SOKS                  VALUE '00'      PIC X(02).
           03 PGM-SNUL                  VALUE '  '      PIC X(02).
           03 PGM-SUAR                  VALUE SPACES    PIC X(15).

       LINKAGE SECTION.
      *----------------
       01  DFHCOMMAREA.
      *<<<< CMA
           02 FILLER                      PIC X(1200).
      *>>>>
       COPY GNSLGFIO.

       PROCEDURE DIVISION.
      *===================

       MAIN SECTION.
       INI-MAIN.
           PERFORM INI.
       LUP-MAIN.
           IF SCR-INST = SCR-INST-HCM
                 PERFORM SCR-COM.
           IF SCR-CCPP = 'MOD'
                 PERFORM SCR-MOD
           ELSE
           IF SCR-CCPP = 'ING'
                 PERFORM SCR-ING
           ELSE
           IF SCR-CCPP = 'ACC'
                 PERFORM SCR-ACC
           ELSE
           IF SCR-CCPP = 'ELI'
                 PERFORM SCR-ELI
           ELSE
                 MOVE SCR-INST-HCM TO SCR-INST.
           GO TO LUP-MAIN.
       FIN-MAIN.
           EXIT.

       INI SECTION.
       INI-INI.
       COPY GNSBGEIB.
       COPY GNSBGEDB.
           MOVE LOW-VALUES TO FIA-FLD.
           MOVE LOW-VALUES TO FIA-EDT.
           PERFORM GNS-PRO-RCK.
           PERFORM GNS-BUS-VCA.
           MOVE +1200 TO SCR-TCMA.
           PERFORM GNS-HDL-SYS.
           PERFORM GNS-HDL-FRM.
           MOVE 'DEUPQFIA' TO FIO-PROG.
           PERFORM GNS-BUS-IDD.
      *PTC-INI
           PERFORM GNS-ERR-QUE.
           PERFORM GET-TSK-TERM.
      *PTC-FIN
      *<<<< INI_FIO
      *PTC ini
           PERFORM GNS-ERR-QUE.
      *PTC fin
      *<<<< INI_FIO

      *LOP-INI 12-12-2002
           MOVE SPACES TO WSS-IND-ALZA IN WSS-VARI.
           IF SCR-CMND ='VRS'
              MOVE 'VRF' TO SCR-CMND
              MOVE 'VRS' TO WSS-IND-ALZA IN WSS-VARI.
      *LOP-FIN 12-12-2002

      *<<<< ISP-INI  24-JAN-1996 11:35:48
           IF SCR-OFRM-SRV
              MOVE WSS-IDX-IFIA TO SCR-IPRO
           ELSE
      *<<<< ISP-FIN  24-JAN-1996 11:35:48
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-VEC-ENG
               MOVE 1 TO SCR-IPRO
               GO TO FIN-INI-FIO.
           IF SCR-INST-EXT = WSS-INST-FPEN-CIC
               MOVE SPACES TO SCR-MSC-STAT
               MOVE WSS-INST-NULL TO SCR-INST-EXT
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'FLDING' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO SCR-MENS-EXT
               PERFORM ING-FPEN-CIC.
       FIN-INI-FIO.
      *>>>>
      *<<<< INI_FIO
           MOVE +1200 TO SCR-TCMA.
           IF SCR-DESDE-CMN
               PERFORM GNS-CLR-RQA.
      *>>>>
      *<<<< INI_FIO
      *DAD  30-JAN-1991 
           IF SCR-DESDE-CMN
               MOVE SPACES TO SCR-MSC-STAT.
      *
      *>>>>
       FIN-INI.
           EXIT.

       COPY GNSBHSYS.
       COPY GNSBHFRM.
       COPY GNSBPRCK.
       COPY GNSBBVCA.
       COPY GNSBBIDD.

       SCR-COM SECTION.
       INI-SCR-COM.
           MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-CLRA-FIA.
           PERFORM EDT-KEY-FIA.
           PERFORM EDT-FLD-FIA.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-HCM TO SCR-INST.
           MOVE SCR-CMNP     TO SYS-PROG.
           MOVE SCR-VARI     TO SYS-CMMA.
           MOVE SCR-TCMA     TO SYS-TCMA.
           MOVE SYS-XCTL     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       XCT-ERR.
           MOVE 'XCTERR    ' TO MSG-COD-MENS.
           MOVE 'GNS'        TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO SYS-MEN1.
           MOVE SYS-PROG     TO SYS-MEN2.
           MOVE SYS-ABOR     TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       COPY GNSBGGBK.
       FIN-SCR-COM.
           EXIT.

       SCR-MOD SECTION.
       INI-SCR-MOD.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-MOD
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-MOD.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_MOD 
           IF (FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                          FRM-FFLD-PF7 OR FRM-FFLD-PF8) AND
               SCR-STAT = SCR-STAT-CON
               PERFORM VAL-NUM-KEY-FIA
               PERFORM VAL-NUM-FLD-FIA.
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-MOD.
           PERFORM GNS-CLR-RQA.
      *>>>>
       MSG-SCR-MOD.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-MOD.
           EXIT.

       BRW-SCR-MOD SECTION.
       INI-BRW-SCR-MOD.
       FIN-BRW-SCR-MOD.
           EXIT.

       SCR-ING SECTION.
       INI-SCR-ING.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-IKY
               MOVE SCR-INST-GKY TO SCR-INST
      *PTC-INI
               IF NOT SCR-OFRM-SRV
                   PERFORM SCR-DMSG
               ELSE
                   PERFORM SCR-PUTA
      *PTC-FIN
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-RST
                PERFORM GET-IKY
                IF NOT FRM-STAT-ABT
                        MOVE SPACES TO FRM-MENS
                        PERFORM FND-KEY
                        IF NOT FIO-STAT-OKS AND
                           FIO-STAT NOT = FIO-STAT-NEX
      *JSS                  PERFORM CLR-FLD-FIA
                            MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
                            PERFORM SCR-TRL
                        ELSE
      *PTC-INI
                        MOVE 'S' TO SCR-IERR
      *PTC-FIN
                        MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR
                        IF FRM-MENS NOT > SPACES
                            MOVE 'REGEXI    ' TO MSG-COD-MENS
                            MOVE 'GNS' TO MSG-COD-SIST
                            PERFORM GET-MSG
                            MOVE MSG-GLS-DESC TO FRM-MENS
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                        ELSE
                            PERFORM SCR-MSSG
                            MOVE SCR-STAT-ABT TO SCR-STAT
                            PERFORM DESSCRTRL
                            GO TO FIN-SCR-ING
                ELSE
                        MOVE SPACES TO FRM-MENS
                        PERFORM SCR-MSSG
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ING
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON.
           PERFORM DESSCRTRL.
       MSG-SCR-ING.
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ING.
           EXIT.

       SCR-ACC SECTION.
       INI-SCR-ACC.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ACC
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ACC.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ACC
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-FIA
               PERFORM VAL-NUM-FLD-FIA
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ACC.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ACC.
           EXIT.

       BRW-SCR-ACC SECTION.
       INI-BRW-SCR-ACC.
       FIN-BRW-SCR-ACC.
           EXIT.

       SCR-ELI SECTION.
       INI-SCR-ELI.
           IF SCR-INST = SCR-INST-HKY
               PERFORM HBL-KEY
               MOVE SCR-INST-GKY TO SCR-INST
               PERFORM SCR-DMSG
           ELSE
           IF SCR-INST = SCR-INST-GKY
                PERFORM SCR-KEY
                IF SCR-STAT NOT = SCR-STAT-ABT
                        PERFORM SCR-TRL
                ELSE
                        PERFORM DESSCRTRL
                        GO TO FIN-SCR-ELI
           ELSE
           IF SCR-INST = SCR-INST-GAB
                PERFORM GET-CON
           ELSE
           IF SCR-INST = SCR-INST-BRW
               MOVE SCR-FFLD TO FRM-FFLD
               PERFORM BRW-SCR-ELI.
           PERFORM DESSCRTRL.
      *<<<< PFS_SCR_ELI
           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6 OR
                         FRM-FFLD-PF7 OR FRM-FFLD-PF8
               PERFORM VAL-NUM-KEY-FIA
               PERFORM VAL-NUM-FLD-FIA
               PERFORM RST-STAT
               PERFORM FND-SCR-KEY THRU FIN-SCR-KEY
               IF SCR-STAT NOT = SCR-STAT-ABT
                   PERFORM SCR-TRL
               ELSE
                   PERFORM GNS-CLR-RQA
                   PERFORM DESSCRTRL
                   GO TO FIN-SCR-ELI.
           PERFORM GNS-CLR-RQA.
      *>>>>
           MOVE SPACES TO FRM-MENS.
           PERFORM SCR-MSSG.
       FIN-SCR-ELI.
           EXIT.

       BRW-SCR-ELI SECTION.
       INI-BRW-SCR-ELI.
       FIN-BRW-SCR-ELI.
           EXIT.



       SCR-DMSG SECTION.
       INI-SCR-DMSG.
           IF PGM-ICLR = PGM-NO-LIMPIAR-NADA
               NEXT SENTENCE
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-TODO
               PERFORM SCR-CLRA-FIA
               PERFORM EDT-KEY-FIA
               PERFORM EDT-FLD-FIA
           ELSE
           IF PGM-ICLR = PGM-LIMPIAR-LLAVES
               PERFORM CLR-KEY-FIA
               PERFORM EDT-KEY-FIA
           ELSE
               PERFORM CLR-FLD-FIA
               PERFORM EDT-FLD-FIA.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-DMSG.
           EXIT.

       SCR-KEY SECTION.
       INI-SCR-KEY.
           PERFORM SCR-RST.
           PERFORM GET-KEY.
           IF FRM-STAT-ABT
                   MOVE SPACES TO FRM-MENS
                   PERFORM SCR-MSSG
                   GO TO FIN-SCR-KEY.
       FND-SCR-KEY.
           MOVE SPACES TO FRM-MENS.
           PERFORM FND-KEY.
           IF FIO-STAT-OKS
               PERFORM PUT-SCR
               MOVE PGM-LIMPIAR-TODO TO PGM-ICLR
               GO TO FIN-SCR-KEY.
      *JSS ELSE
      *        PERFORM CLR-FLD-FIA.
       ERR-SCR-KEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE PGM-LIMPIAR-CAMPOS TO PGM-ICLR.
           IF FRM-MENS NOT > SPACES
               IF FIO-STAT-EOF
                   MOVE 'REGEOF    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
               IF FIO-STAT = FIO-STAT-NEX
                   MOVE 'REGNEX    ' TO MSG-COD-MENS
                   MOVE 'GNS' TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
               ELSE
                   MOVE 'FIOSTAT' TO MSG-COD-TMSG
                   MOVE FIO-STAT  TO MSG-COD-CMSG
                   MOVE 'GNS'     TO MSG-COD-SIST
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS.
           PERFORM SCR-MSSG.
           MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-SCR-KEY.
           EXIT.

       SCR-RST SECTION.
       INI-SCR-RST.
           MOVE SPACES       TO PGM-ICLR.
           MOVE SPACES       TO SCR-ACTU.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
           MOVE LOW-VALUES   TO FIA-FLD.
           MOVE LOW-VALUES TO FIA-EDT.
       FIN-SCR-RST.
           EXIT.

       GET-KEY SECTION.
       INI-GET-KEY.
           PERFORM SCR-GKEY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-KEY.
           EXIT.

       GET-IKY SECTION.
       INI-GET-IKY.
           PERFORM SCR-GIKY.
           IF FRM-STAT-ABT
               MOVE SCR-STAT-ABT TO SCR-STAT.
       FIN-GET-IKY.
           EXIT.

       FND-KEY SECTION.
       INI-FND-KEY.
      *<<<< INI_FND_KEY
           PERFORM KEY-ALL-FIA.
           IF SCR-CCPP NOT = 'ING'
               GO TO CON-FND-ACC.
           MOVE 'DEU' TO SCR-KEY-IDBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
           IF FIO-STAT-OKS
               MOVE 1 TO WSS-IESC
               PERFORM PUT-ESC-FIA
               IF FIA-NUM-IFIA IN FIA > ZEROES
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM DEU-FIO-FIA
                   MOVE FIO-STAT TO PGM-STAT-FIA
                   IF NOT FIO-STAT-OKS
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'FIAIFIANEX' TO MSG-COD-MENS
                       PERFORM GET-MSG
                       MOVE MSG-GLS-DESC TO FRM-MENS
                       MOVE FIO-STAT-NEX TO FIO-STAT
                   ELSE
                       MOVE 'ESC' TO SCR-KEY-IFIA
                       MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                       MOVE 1 TO WSS-IFIA
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
                       PERFORM CHK-FEC-FVEN
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I   
                       PERFORM PUT-FIA-FIA
                       PERFORM BUS-COR-AMF
                       MOVE '23' TO FIO-STAT
               ELSE
                   PERFORM BUS-COR-FIA
                   MOVE 1 TO AMF-NUM-IAMF IN FIA-FLD
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
                   PERFORM CHK-FEC-FVEN
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I   
                   MOVE '23' TO FIO-STAT
           ELSE
               MOVE 1 TO FIA-NUM-IFIA IN FIA-FLD
               MOVE 1 TO AMF-NUM-IAMF IN FIA-FLD.
           GO TO FIN-FND-KEY.
       CON-FND-ACC.
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               IF SCR-KEY-IDBC = 'ESC'
                   PERFORM NXT-PRV-ESC
                   IF FIO-STAT-OKS
                       PERFORM SCR-CLRA-FIA
                       MOVE 1 TO WSS-IESC
                       PERFORM BUS-COR-FIA
                       IF FIA-NUM-IFIA IN FIA-FLD NOT > ZEROES
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'FIAIFIANEX' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'ESC' TO SCR-KEY-IFIA
                           MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                           MOVE '00' TO PGM-STAT-FIA
                           MOVE 1 TO WSS-IFIA
                           MOVE '00' TO FIO-STAT
                           PERFORM BUS-COR-AMF
                           IF AMF-NUM-IAMF IN FIA-FLD >  ZEROES
                               MOVE 1 TO WSS-IAMF
                               MOVE '00' TO PGM-STAT-AMF
                               MOVE '00' TO FIO-STAT
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE '00' TO FIO-STAT
                               GO TO FIN-FND-KEY
                   ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'ESC    NOPRV' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'ESC    NONXT' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
               ELSE
               PERFORM LEE-NXT-PRV
               IF FIO-STAT-OKS
                   PERFORM SCR-CLRA-FIA
                   IF SCR-KEY-IDBC = 'FIA'
                       MOVE DBC-CIC-ICLI IN DBC TO FIA-CIC-ICFS 
                                                         IN FIA
                       PERFORM PUT-DBC-FIA
                       PERFORM BUS-FIA-SFI
                       IF NOT FIO-STAT-OKS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           MOVE SPACES TO SCR-FIA-REQA
                           MOVE SPACES TO SCR-KEY-IFIA
                           GO TO FIN-FND-KEY
                       ELSE
                           GO TO FIN-FND-KEY
                   ELSE
                       MOVE DBC-CIC-ICLI IN DBC TO FIA-CIC-ICLI 
                                                         IN FIA
                       PERFORM PUT-DBC-DEU
                       PERFORM BUS-FIA-SDE
                       IF NOT FIO-STAT-OKS
                           MOVE '00' TO FIO-STAT
                           MOVE SCR-STAT-CON TO SCR-STAT
                           MOVE SPACES TO SCR-FIA-REQA
                           MOVE SPACES TO SCR-KEY-IFIA
                           GO TO FIN-FND-KEY
                       ELSE
                           GO TO FIN-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NOPRV' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'SGC' TO MSG-COD-SIST
                       MOVE 'DBC    NONXT' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY.

           IF FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD-PF6
               PERFORM LEE-NXT-PRV-ESC
               IF MSG-COD-MENS = 'FIASI'
                   MOVE 1 TO WSS-IFIA
                   PERFORM BUS-ESC
                   IF FIO-STAT-OKS
                       PERFORM SCR-CLRA-FIA
                       PERFORM BUS-COR-AMF
                       IF AMF-NUM-IAMF IN FIA-FLD >  ZEROES
                           MOVE 1 TO WSS-IAMF
                           MOVE '00' TO PGM-STAT-AMF
                           MOVE '00' TO FIO-STAT
                           GO TO FIN-FND-KEY
                        ELSE
                            MOVE '00' TO FIO-STAT
                            GO TO FIN-FND-KEY
                   ELSE
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'CICIESCNEX' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
               ELSE
                   MOVE SPACES TO PGM-STAT
                   IF SCR-KEY-IFIA = 'FIA'
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICFSNOPRV' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICFSNONXT' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                   ELSE      
                   IF SCR-KEY-IFIA = 'DEU'
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICLINOPRV' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICICLINONXT' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                   ELSE
                       IF FRM-FFLD = FRM-FFLD-PF5
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICIESCNOPRV' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY
                       ELSE
                           MOVE 'DEU' TO MSG-COD-SIST
                           MOVE 'CICIESCNONXT' TO MSG-COD-MENS
                           PERFORM SET-MSG
                           GO TO FIN-FND-KEY.

           IF ESC-IIC-IESC IN FIA-FLD NOT > ZEROES
               PERFORM ANL-KEY-FIA
               IF NOT FIO-STAT-OKS
                   MOVE '00' TO FIO-STAT
                   MOVE SCR-STAT-CON TO SCR-STAT
                   GO TO FIN-FND-KEY
               ELSE
                   GO TO FIN-FND-KEY.
           PERFORM KEY-ALL-FIA.
           MOVE 'DEU' TO SCR-KEY-IDBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
           IF FIO-STAT-OKS
               MOVE 'ESC' TO SCR-KEY-IDBC
               MOVE 1 TO WSS-IESC
      *        PERFORM PUT-ESC-FIA
               IF FIA-NUM-IFIA IN FIA > ZEROES
                   MOVE ESC-CIC-IESC IN ESC TO FIA-CIC-IESC IN FIA
                   MOVE FIO-GET-KEY TO FIO-CMND
                   PERFORM DEU-FIO-FIA
                   MOVE FIO-STAT TO PGM-STAT-FIA
                   IF NOT FIO-STAT-OKS
                       MOVE 'DEU' TO MSG-COD-SIST
                       MOVE 'FIAIFIANEX' TO MSG-COD-MENS
                       PERFORM SET-MSG
                       GO TO FIN-FND-KEY
                   ELSE
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
                       PERFORM CHK-FEC-FVEN
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I    
                       MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                       MOVE 1 TO WSS-IFIA
                       MOVE 'ESC' TO SCR-KEY-IFIA
      *                PERFORM PUT-FIA-FIA
                       IF AMF-NUM-IAMF IN AMF > ZEROES
                           MOVE FIA-KEY-IFIA IN FIA TO
                                AMF-KEY-IFIA IN AMF
                           MOVE FIO-GET-KEY TO FIO-CMND
                           PERFORM DEU-FIO-AMF
                           MOVE FIO-STAT TO PGM-STAT-AMF
                           IF NOT FIO-STAT-OKS
                               MOVE 'DEU' TO MSG-COD-SIST
                               MOVE 'AMFIAMFNEX' TO MSG-COD-MENS
                               PERFORM SET-MSG
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE 1 TO WSS-IAMF
      *                        PERFORM PUT-AMF-FIA
                               MOVE '00' TO FIO-STAT
                       ELSE
                           PERFORM BUS-COR-AMF
                           IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                               MOVE 1 TO WSS-IAMF
                               MOVE '00' TO PGM-STAT-AMF
      *                        PERFORM PUT-AMF-FIA
                               MOVE '00' TO FIO-STAT
                           ELSE
                               PERFORM CLR-AMF
                               MOVE '00' TO FIO-STAT
               ELSE
                   PERFORM BUS-COR-FIA
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
                   PERFORM CHK-FEC-FVEN
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I    
                   IF FIA-NUM-IFIA IN FIA-FLD > ZEROES
                       MOVE 'ESC' TO SCR-KEY-IFIA
                       MOVE '00' TO PGM-STAT-FIA
                       MOVE ADR-FIA-REQA TO SCR-FIA-REQA
                       MOVE 1 TO WSS-IFIA
      *                PERFORM PUT-FIA-FIA
                       IF AMF-NUM-IAMF IN AMF > ZEROES
                           MOVE FIA-KEY-IFIA IN FIA TO
                                AMF-KEY-IFIA IN AMF
                           MOVE FIO-GET-KEY TO FIO-CMND
                           PERFORM DEU-FIO-AMF
                           MOVE FIO-STAT TO PGM-STAT-AMF
                           IF NOT FIO-STAT-OKS
                               MOVE 'DEU' TO MSG-COD-SIST
                               MOVE 'AMFIAMFNEX' TO MSG-COD-MENS
                               PERFORM SET-MSG
                               GO TO FIN-FND-KEY
                           ELSE
                               MOVE 1 TO WSS-IAMF
      *                        PERFORM PUT-AMF-FIA
                               MOVE '00' TO FIO-STAT
                       ELSE
                           PERFORM BUS-COR-AMF
                           IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                               MOVE '00' TO PGM-STAT-AMF
                               MOVE 1 TO WSS-IAMF
      *                        PERFORM PUT-AMF-FIA
                               MOVE '00' TO FIO-STAT
                           ELSE
                               PERFORM CLR-AMF
                               MOVE '00' TO FIO-STAT
                   ELSE
                       PERFORM CLR-FIA
                       PERFORM CLR-AMF
                       MOVE '00' TO FIO-STAT
           ELSE
               NEXT SENTENCE.
           GO TO FIN-FND-KEY.
      *>>>>
           PERFORM KEY-ALL-FIA.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
           IF FIO-STAT-OKS
               MOVE AMF-STP-ITRN IN AMF TO SCR-UMOD.
           MOVE FIO-STAT TO PGM-STAT-AMF.
       FIN-FND-KEY.
           IF FIO-STAT = FIO-STAT-NEX
               MOVE 'S' TO SCR-IERR.
       EXT-FND-KEY.
           EXIT.
 
       PUT-SCR SECTION.
       INI-PUT-SCR.
           IF PGM-STAT-AMF-OKS
               MOVE AMF-STP-ITRN IN AMF TO SCR-UMOD.
           PERFORM PUT-ALL-FIA.
       FIN-PUT-SCR.
           EXIT.

       STP-EXIT SECTION.
       INI-STP-EXIT.
           MOVE SCR-PROG TO PGM-PROG.
           MOVE SCR-NTRN TO PGM-NTRN.

           MOVE SCR-PROV TO SCR-PROG.
           MOVE SCR-NTRV TO SCR-NTRN.

           MOVE PGM-PROG TO SCR-PROV
           MOVE PGM-NTRN TO SCR-NTRV.
       FIN-STP-EXIT.
           EXIT.

       SCR-EXIT SECTION.
       INI-SCR-EXIT.
           MOVE 'P'      TO SCR-ICMN.
           MOVE SCR-NTRN TO SYS-NTRN.
      *<<<< EXIT_SCR
      *LOP-INI 12-12-2002
           IF WSS-IND-ALZA IN WSS-VARI ='VRS'
              MOVE 'VRS' TO SCR-CMND.
      *LOP-FIN 12-12-2002
      *>>>>
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-RTRN TO SYS-CMND.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           PERFORM GNS-PRO-SYS.
       FIN-SCR-EXIT.
           EXIT.

       SCR-PUTA SECTION.
       INI-SCR-PUTA.
      *PTC-INI
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FIA-FLD TO FRM-DFLD.
           MOVE FRM-PUT-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-PUTA.
           EXIT.

       SCR-MSSG SECTION.
       INI-SCR-MSSG.
           IF FRM-MEN1 NOT > SPACES
               MOVE SPACES TO FRM-MEN1.
           IF FRM-MEN2 NOT > SPACES
               MOVE SPACES TO FRM-MEN2.
           MOVE FRM-MENS TO FIA-GLS-MENS.
       FIN-SCR-MSSG.
           EXIT.

       SCR-GKEY SECTION.
       INI-SCR-GKEY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_SCR_GKEY
           IF NOT ( FRM-FFLD = FRM-FFLD-PF8 OR FRM-FFLD = FRM-FFLD-PF7 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-FIA
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO FIA-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GKEY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-FIA
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-FIA.
           PERFORM VAL-IKY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-MKY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-AKY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GKEY.
           PERFORM VAL-CON-KEY-FIA.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GKEY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-FIA.
       ERR-SCR-GKEY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-FIA.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GKEY.
           PERFORM SCR-MSSG.

       SCR-GIKY SECTION.
       INI-SCR-GIKY.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE SPACES TO FRM-MENS.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               PERFORM FST-KEY-FIA
               PERFORM SCR-MSSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO FIA-FLD.
           IF FRM-STAT-ABT
               GO TO FIN-SCR-GIKY.
           MOVE FRM-SUAR-OKS TO FRM-SUAR.
           PERFORM VAL-NUM-KEY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
      *PTC-INI
               MOVE 'S' TO SCR-IERR
      *PTC-FIN
               PERFORM SCR-MSSG
               PERFORM EDT-IKY-FIA
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
      *JSS
           PERFORM CLR-FLD-FIA.
           PERFORM VAL-IKY-FIA.
           IF FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR
               GO TO ERR-SCR-GIKY.
           PERFORM VAL-CON-IKY-FIA.
           IF NOT ( FRM-SUAR EQUAL FRM-SUAR-MAL OR FRM-SUAR-CLR )
               GO TO FIN-SCR-GIKY.
           IF FRM-UCUR NOT > SPACES
               PERFORM FST-KEY-FIA.
       ERR-SCR-GIKY.
      *PTC-INI
           MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           PERFORM SCR-MSSG.
           PERFORM EDT-IKY-FIA.
           PERFORM SCR-PUTA.
           PERFORM SCR-EXIT.
       FIN-SCR-GIKY.
      *<<<< FIN_SCR_GIKY OR FIN_SCR_GCNF OR FIN_SCR_GFLD
           IF FRM-FFLD = FRM-FFLD-PF3 AND
              SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM EGR-FTER-CIC.
      *>>>>
           PERFORM SCR-MSSG.

       GET-CON SECTION.
       INI-GET-CON.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FRM-GET-ALL TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           IF NOT ( FRM-FFLD = FRM-FFLD-RET  OR FRM-FFLD-PF10 OR
                               FRM-FFLD-PF12 OR FRM-FFLD-PF3 )
      *<<<< PFS_GET_CON OR PFS_GET_ACC
           IF NOT
              ( FRM-FFLD = FRM-FFLD-PF5 OR FRM-FFLD = FRM-FFLD-PF6 OR
                FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD = FRM-FFLD-PF8 )
      *>>>>
               MOVE 'PFSINV    ' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FIA-GLS-MEN2
               MOVE SCR-PRMT     TO FIA-GLS-MEN1
               PERFORM FST-MSG
               PERFORM SCR-PUTA
               PERFORM SCR-EXIT.
           MOVE FRM-DFLD TO FIA-FLD.
       FIN-GET-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.

       CLR-MSG SECTION.
       INI-CLR-MSG.
           MOVE SPACES TO FIA-GLS-MENS.
       FIN-CLR-MSG.
           EXIT.

       HBL-IKY SECTION.
       INI-HBL-IKY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE FIA-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO FIA-FLD
      * FLB  7-NOV-1994
               PERFORM CLR-KEY-FIA

               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO FIA-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO FIA-GLS-MENS.
           PERFORM PRO-MKY-FIA.
           PERFORM PRO-AKY-FIA.
           PERFORM UNP-IKY-FIA.
           PERFORM FST-KEY-FIA.
      *<<<< FIN_HBL_IKY
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               PERFORM HBL-KEY-FIA.
      *>>>>
       FIN-HBL-IKY.
           EXIT.

       HBL-KEY SECTION.
       INI-HBL-KEY.
      *PTC-INI
           IF NOT SCR-OFRM-SRV
      *PTC-FIN
           IF SCR-DESDE-CMN
               MOVE FIA-GLS-MENS TO FRM-MENS
               MOVE LOW-VALUES TO FIA-FLD
               IF FRM-MENS < SPACES
                   MOVE LOW-VALUES TO FIA-GLS-MENS
               ELSE
                   MOVE FRM-MENS TO FIA-GLS-MENS.
           PERFORM UNP-KEY-FIA.
           PERFORM FST-KEY-FIA.
       FIN-HBL-KEY.
           EXIT.

       HBL-FLD SECTION.
       INI-HBL-FLD.
           PERFORM PRO-IKY-FIA.
           PERFORM PRO-AKY-FIA.
           PERFORM UNP-MKY-FIA.
           PERFORM UNP-FLD-FIA.
           PERFORM FST-FLD-FIA.
      *<<<< FIN_HBL_FLD
      *ISP: PARA COMPATIBILIDAD ENGANCHE - NO ENGANCHE
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'
           IF NOT ( SCR-MSC-STAT = 'N' OR SCR-MSC-STAT NOT > SPACES )
               PERFORM PRO-ESC-FIA.
           IF SCR-CMND = 'VRF'
               PERFORM PRO-MKY-FIA
               PERFORM PRO-FLD-FIA
               MOVE  0 TO FIA-COD-TOFS-LEN IN FIA-FLD
               MOVE -1 TO FIA-MSC-STAT-LEN IN FIA-FLD
               MOVE FRM-CPIM-UBY TO FIA-MSC-STAT-ATR IN FIA-FLD
               GO TO FIN-HBL-FLD
           ELSE
               MOVE FRM-CPIM-AEY TO FIA-MSC-STAT-ATR IN FIA-FLD
               MOVE 'N' TO FIA-MSC-STAT IN FIA-FLD.
      *ISP: PARA COMPATIBILIDAD ENGANCHE - NO ENGANCHE
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'
           IF FIA-NUM-IFIA-ALF IN FIA-FLD NOT > SPACES OR
              FIA-NUM-IFIA-ALF IN FIA-FLD = ZEROES
               PERFORM PRO-FIA-FIA
               PERFORM PRO-MKY-FIA
               MOVE  0 TO FIA-COD-TOFS-LEN IN FIA-FLD
               MOVE -1 TO ESC-COD-OFEF-LEN IN FIA-FLD.
      *ISP: PARA COMPATIBILIDAD ENGANCHE - NO ENGANCHE
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'
           IF AMF-NUM-IAMF-ALF IN FIA-FLD NOT > SPACES OR
              AMF-NUM-IAMF-ALF IN FIA-FLD = ZEROES
               PERFORM PRO-AMF-FIA.
      *JSS-INI 21-MAR-1994
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) NOT = 'S'
               GO TO CON-HBL-FLD.
           IF FIA-COD-TOFS IN FIA-FLD > SPACES
               MOVE  0           TO FIA-COD-TOFS-LEN IN FIA-FLD
               MOVE -1           TO FRM-NUM-ICFS-LEN IN FIA-FLD
               MOVE FRM-CPIM-AEY TO FIA-COD-TOFS-ATR IN FIA-FLD.
           IF ESC-COD-OFEF IN FIA-FLD > SPACES
               MOVE FRM-CPIM-AEY TO ESC-COD-OFEF-ATR IN FIA-FLD.
           IF ESC-FEC-FCTT IN FIA-FLD > ZEROES
               MOVE FRM-CPIM-AEY TO ESC-FEC-FCTT-ATR IN FIA-FLD.
           IF ESC-COD-RCTT IN FIA-FLD > SPACES
               MOVE FRM-CPIM-AEY TO ESC-COD-RCTT-ATR IN FIA-FLD.
           IF NOT ( FRM-NUM-ICLI IN FIA-FLD = ZEROES OR SPACES )
               MOVE FRM-CPIM-AEY TO FRM-NUM-ICLI-ATR IN FIA-FLD
               MOVE FRM-CPIM-AEY TO FRM-VRF-ICLI-ATR IN FIA-FLD
               MOVE FRM-CPIM-AEY TO FRM-IND-ICLI-ATR IN FIA-FLD
               MOVE FRM-CPIM-AEY TO FRM-GLS-ICLI-ATR IN FIA-FLD.
           IF FIA-VAL-LIMF IN FIA-FLD > ZEROES
               MOVE FRM-CPIM-AEY TO FIA-VAL-LIMF-ATR IN FIA-FLD.
           IF FIA-COD-VCLF IN FIA-FLD > SPACES
               MOVE FRM-CPIM-AEY TO FIA-COD-VCLF-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-TOOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-OFOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-CAI-IOCA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-IIC-IOCA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-NUM-IAMF-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-VCOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-AOOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-CDOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-VAL-LIMA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-VCLA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-IND-TDEU-ATR IN FIA-FLD.
       CON-HBL-FLD.
      *JSS-FIN 21-MAR-1994
      *>>>>
       FIN-HBL-FLD.
           EXIT.

       FST-MSG SECTION.
       INI-FST-MSG.
           MOVE -1 TO FIA-GLS-MENS-LEN.
       FIN-FST-MSG.
           EXIT.

       PRO-ALL SECTION.
       INI-PRO-ALL.
           PERFORM PRO-KEY-FIA.
           PERFORM FST-MSG.
       FIN-PRO-ALL.
           EXIT.

       SCR-TRL SECTION.
       INI-SCR-TRL.
      *<<<< INI_SCR_TRL
      * PTC-INI-AUT
           IF SCR-STAT NOT = SCR-STPP
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      * PTC-FIN-AUT
           MOVE SPACES TO MSG-COD-MENS.
           IF FRM-FFLD = FRM-FFLD-PF12
               GO TO CON-SCR-TRL.
           IF NOT EXISTE-ESCRITURA
               GO TO CON-SCR-TRL.
           IF NOT ( ESC-MSC-STAT IN ESC = 'N' OR
                    ESC-MSC-STAT IN ESC NOT > SPACES )
               MOVE ESC-MSC-STAT IN ESC TO SCR-MSC-STAT
               IF ( SCR-CCPP = 'ING' OR 'ELI' OR 'ACC' ) AND
                    SCR-CMND NOT = 'VRF'
                   MOVE 'ESCSTATSI' TO MSG-COD-MENS.
      *ALD         IF EXISTE-FIANZA
      *                MOVE ADR-FIA-REQA TO SCR-FIA-REQA
      *                GO TO MSG-SCR-TRL
      *            ELSE
      *                GO TO MSG-SCR-TRL.
           IF EXISTE-FIANZA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               IF FIA-FEC-FALZ > ZEROES
                   MOVE 'FIA    ALZ' TO MSG-COD-MENS
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
                   MOVE SPACES       TO WSS-GLS-MENS
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I
               ELSE
               IF FIA-FEC-FAUT > ZEROES
               MOVE 'FIA    AUT' TO MSG-COD-MENS
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
                   MOVE SPACES       TO WSS-GLS-MENS
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I
               ELSE
               IF FIA-FEC-FSOL > ZEROES
                   MOVE 'FIA    SOL' TO MSG-COD-MENS
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
                   MOVE SPACES       TO WSS-GLS-MENS
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I
               ELSE
               IF NOT (FIA-MSC-STAT IN FIA = 'N' OR
                       FIA-MSC-STAT IN FIA NOT > SPACES)
                   MOVE 'FIASTATSI' TO MSG-COD-MENS
               ELSE
                   NEXT SENTENCE
           ELSE
               IF SCR-CMND = 'VRF'
                   MOVE 'FIAIFIANEX' TO MSG-COD-MENS.
       MSG-SCR-TRL.
           IF MSG-COD-MENS > SPACES
               MOVE 'DEU' TO MSG-COD-SIST
               PERFORM GET-MSG
               IF SCR-STAT = SCR-STAT-CON
                   MOVE MSG-GLS-DESC TO FRM-MEN2
               ELSE
                   MOVE SCR-STAT-CON TO SCR-STAT
                   MOVE MSG-GLS-DESC TO FRM-MENS.
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
           IF WSS-GLS-MENS > SPACES
              MOVE WSS-GLS-MENS TO FRM-MEN2.
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I
       CON-SCR-TRL.
      *>>>>
      *PTC-INI
           IF SCR-STAT NOT = SCR-STPP
               MOVE 'S' TO SCR-IERR.
      *PTC-FIN
           IF FRM-MEN1 NOT > SPACES
               MOVE SCR-PRMT TO FRM-MEN1.
      *<<<< FIN_SCR_TRL
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = 'S'
               MOVE 'F10FIANINLDC' TO MSG-COD-MENS
               PERFORM MSG-PF10.
      *>>>>
           IF SCR-STAT = SCR-STAT-MOD
               PERFORM HBL-FLD
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-FIA
               PERFORM EDT-FLD-FIA
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GFL TO SCR-INST
               PERFORM SCR-EXIT.
           IF SCR-STAT = SCR-STAT-SON
               PERFORM PRO-ALL
               PERFORM SCR-MSSG
               PERFORM EDT-KEY-FIA
               PERFORM EDT-FLD-FIA
               PERFORM SCR-PUTA
               PERFORM STP-EXIT
               MOVE SCR-INST-GCS TO SCR-INST
               PERFORM SCR-EXIT.
      *ASUME SCR-STAT-CON.
           MOVE SCR-STAT-CON TO SCR-STAT.
      *    MOVE FRM-CPSF-AEY TO FRM-CPIM-AEY.
           PERFORM PRO-ALL.
           PERFORM SCR-MSSG.
           PERFORM EDT-KEY-FIA.
           PERFORM EDT-FLD-FIA.
           PERFORM SCR-PUTA.
           MOVE SCR-INST-GAB TO SCR-INST.
           PERFORM SCR-EXIT.
       FIN-SCR-TRL.
           EXIT.

       DESSCRTRL SECTION.
       INI-DESSCRTRL.
           MOVE SCR-VFLD-NOT TO SCR-VFLD.
           MOVE FRM-FFLD TO SCR-FFLD.
       FIN-DESSCRTRL.
           IF SCR-FFLD-PF10 OR SCR-FFLD-PF3
                 MOVE SCR-INST-HCM TO SCR-INST
           ELSE
                 MOVE SCR-INST-HKY TO SCR-INST.
       EXT-DESSCRTRL.
           EXIT.

      * PGM-EBR-ALL SECTION.
      * INI-PGM-EBR-ALL.
      *     MOVE 'GNS' TO FIO-SIST.
      *     MOVE FIO-EBR-ALL TO FIO-CMND.
      *     PERFORM GNS-FIO-TAB.
      * FIN-PGM-EBR-ALL.
      *     EXIT.

       COPY DEUBQFIA.
       COPY GNSBVNUM.
       COPY DEUBFAMF.
       COPY GNSBFMSG.
       COPY GNSBGSYS.
       COPY GNSBGDTC.
      *PTC-INI
      *PTC-SUB
      * ISP  10-MAY-2001 13:46:35 
      * COPY GNSBGFRM.
       COPY GNSBG3CF.
      *PTC-FIN
       COPY GNSBGMSG.
       COPY GNSBEKEY.
       COPY GNSBIABT.
       COPY GNSBBTAB.
       COPY GNSBVCOD.
       COPY GNSBVTAB.
       COPY GNSBFTAB.
       COPY GNSBVIND.
       COPY GNSBVMSC.
       COPY GNSBFMSC.
       COPY GNSBVIDC.
       COPY GNSBPVRF.
       COPY GNSBGFEC.
       COPY GNSBGHOY.
       COPY TABBBOFI.
       COPY TABBVOFI.
       COPY TABBFOFI.
       COPY TABBBUSR.
       COPY TABBVTDU.
       COPY TABBFUSR.
      *PTC-INI
       COPY GNSBGQUE.
       COPY GNSBGTSK.
      *PTC-FIN

      *PTC ini
       COPY GNSBGQUE.
      *PTC fin
      *<<<< EOF
       MSG-PF10 SECTION.
       INI-MSG-PF10.
      *GET-MSG Busca mensaje en tabla
           MOVE 'DEU' TO MSG-COD-SIST.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MEN2.
           MOVE FRM-MEN2     TO FIA-GLS-MEN2 IN FIA-FLD.
       FIN-MSG-PF10.
           EXIT.

       HBL-KEY-FIA SECTION.
       INI-HBL-KEY-FIA.
           PERFORM SCR-CLRA-FIA.
           MOVE SCR-CAI-IFIA IN SCR-VARI TO ESC-CAI-IESC IN FIA-FLD.
           MOVE SCR-IIC-IFIA IN SCR-VARI TO ESC-IIC-IESC IN FIA-FLD.
      *ISP   25-JUL-1990 DEBE SER REEMPLAZADO POR VARIABLE
      *     INHIBE MOVE FRM-CPSF TO FRM-CPIM-AEY
           MOVE '1' TO FRM-CPIM-AEY.
           MOVE FRM-CPIM-AEY TO ESC-CAI-IESC-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO ESC-IIC-IESC-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FIA-NUM-IFIA-ATR IN FIA-FLD.
           MOVE +4 TO ESC-CAI-IESC-LEN IN FIA-FLD.
      *ISP: PARA COMPATIBILIDAD ENGANCHE - NO ENGANCHE
      *     PERFORM FND-KEY.
      *JSS-INI 21-MAR-1994
           MOVE SCR-COD-TOGA TO FIA-COD-TOFS IN FIA-FLD.
           MOVE SCR-NUM-ICLI TO FRM-NUM-ICLI IN FIA-FLD.
           MOVE SCR-VRF-ICLI TO FRM-VRF-ICLI IN FIA-FLD.
           MOVE SCR-IND-ICLI TO FRM-IND-ICLI IN FIA-FLD.
           MOVE SCR-GLS-ICLI TO FRM-GLS-ICLI IN FIA-FLD.
           MOVE SCR-VAL-CMAX TO FIA-VAL-LIMF IN FIA-FLD.
           MOVE SCR-COD-VCCF TO FIA-COD-VCLF IN FIA-FLD.
           MOVE SCR-COD-OFIC TO ESC-COD-OFEF IN FIA-FLD.
           MOVE SCR-COD-EJEC TO ESC-COD-RCTT IN FIA-FLD.

      *FLB CST  6-DEC-1994
           MOVE 'TAB' TO FIO-SIST.
           MOVE 'TIO ' TO TAB-COD-TTAB IN TAB.
           MOVE SCR-COD-TOGA TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF TAB-CIC-CTAB IN TAB NOT = 'AVL'
               MOVE SCR-COD-TOOC TO AMF-COD-TOOA IN FIA-FLD
               MOVE SCR-COD-AOOC TO AMF-COD-AOOA IN FIA-FLD
      *LAV INI 23-MAR-1994
               MOVE SCR-COD-VCOC TO AMF-COD-VCOA IN FIA-FLD
      *LAV FIN 23-MAR-1994
               MOVE 1 TO AMF-NUM-IAMF IN FIA-FLD.
      *FLB CST  6-DEC-1994 FIN

           PERFORM GET-FHOY.
           MOVE HOY-DHOY     TO ESC-NUM-DCTT IN FIA-FLD.
           MOVE HOY-MHOY     TO ESC-NUM-MCTT IN FIA-FLD.
           MOVE HOY-SHOY     TO ESC-NUM-SCTT IN FIA-FLD.
           MOVE HOY-AHOY     TO ESC-NUM-ACTT IN FIA-FLD.
      *JSS-FIN 21-MAR-1994
           PERFORM HBL-FLD.
           MOVE SCR-INST-GFL TO SCR-INST.

      *ISP SE REQUIEREN PARA BUS-COR-FIA
           MOVE SCR-CAI-IFIA IN SCR-VARI TO FIA-CAI-IESC IN FIA.
           MOVE SCR-IIC-IFIA IN SCR-VARI TO FIA-IIC-IESC IN FIA.
           PERFORM BUS-COR-FIA.
       CIC-HBL-KEY-FIA.
      *
           PERFORM EDT-KEY-FIA.
           PERFORM EDT-FLD-FIA.

           MOVE 'F10FIANINLDC' TO MSG-COD-MENS.
           PERFORM MSG-PF10.

           IF SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO) = 'S'
               MOVE SPACES TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO)
               PERFORM SCR-INIT
               PERFORM STP-EXIT
           ELSE
               PERFORM SCR-PUTA.
      *<<<< ISP-INI  24-JAN-1996 11:35:48 
           IF SCR-OFRM-SRV
                EXEC CICS
                 RETURN
                END-EXEC.
      *<<<< ISP-FIN  24-JAN-1996 11:35:48 
           PERFORM SCR-EXIT.
       FIN-HBL-KEY-FIA.
           EXIT.

      *  CODIGO ADICIONAL PARA ENGANCHE PROGRAMAS
       ING-FPEN-CIC SECTION.
       INI-ING-FPEN-CIC.
           PERFORM ING-SETE.
           PERFORM SCR-CLRA-FIA.
           MOVE SCR-MENS-EXT TO FIA-GLS-MENS.
           PERFORM HBL-IKY.
       FIN-ING-FPEN-CIC.
           EXIT.

       ING-SETE SECTION.
       INI-ING-SETE.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-NTRN(SCR-IPRO)     TO SCR-NTRN.
           MOVE WSS-PROG(SCR-IPRO)     TO SCR-PROG.
           MOVE WSS-NMAP(SCR-IPRO)     TO SCR-NMAP.
           MOVE WSS-NLIB(SCR-IPRO)     TO SCR-NLIB.

           MOVE WSS-NTRV(SCR-IPRO)     TO SCR-NTRV.
           MOVE WSS-PROV(SCR-IPRO)     TO SCR-PROV.
       FIN-ING-SETE.
           EXIT.

       EGR-FPEN-CIC SECTION.
       INI-EGR-FPEN-CIC.
           PERFORM CRG-TBL-ENG.
           ADD 1 TO SCR-IPRO.
           IF SCR-IPRO > WSS-TOT-IIDX
                  PERFORM EGR-FTER-CIC
                  GO TO FIN-EGR-FPEN-CIC.
           IF SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO) = SPACES
               GO TO INI-EGR-FPEN-CIC.
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      * PTC-INI-AUT
           IF NOT SCR-OFRM-SRV
      * PTC-FIN-AUT
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FPEN-CIC.
           EXIT.

       EGR-FTER-CIC SECTION.
       INI-EGR-FTER-CIC.
           PERFORM CRG-TBL-ENG.
           MOVE WSS-IDX-ILDC TO SCR-IPRO.
           MOVE 'S' TO SCR-IND-ENG IN SCR-VEC-ENG(SCR-IPRO).
           MOVE 'S' TO SCR-IND-FST IN SCR-VEC-FST(SCR-IPRO).
           MOVE WSS-INST-FPEN-CIC TO SCR-INST-EXT.
           MOVE WSS-PROG(SCR-IPRO) TO SYS-PROG.
           MOVE SCR-VARI TO SYS-CMMA.
           MOVE SCR-TCMA TO SYS-TCMA.
           MOVE SYS-XCTL TO SYS-CMND.
      * PTC-INI-AUT
           IF NOT SCR-OFRM-SRV
      * PTC-FIN-AUT
           PERFORM GNS-PRO-SYS.
       FIN-EGR-FTER-CIC.
           EXIT.

       SCR-INIT SECTION.
       INI-SCR-INIT.
           MOVE 3  TO FRM-PLIN.
           MOVE 19 TO FRM-NLIN.
           MOVE FRM-CLR-FRM TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
           MOVE FRM-SINI-DBNF TO FRM-SINI.
           MOVE SCR-NMAP TO FRM-NAME.
           MOVE SCR-NLIB TO FRM-NLIB.
           MOVE FIA-FLD TO FRM-DFLD.
           MOVE FRM-INI TO FRM-CMND.
           PERFORM GNS-PRO-FRM.
       FIN-SCR-INIT.
           EXIT.

       COPY LDCBGMPT.

      *>>>> END EOF
      *<<<< EOF
       RST-STAT SECTION.
       INI-RST-STAT.
           MOVE SCR-STPP     TO SCR-STAT.
           MOVE SCR-MFLD-NOT TO SCR-MFLD.
       FIN-RST-STAT.
           EXIT.

       GNS-CLR-RQA SECTION.
       INI-GNS-CLR-RQA.
           MOVE SPACES TO SCR-DBC-REQA.
           MOVE SPACES TO SCR-KEY-IDBC.
           MOVE SPACES TO SCR-FIA-REQA.
           MOVE SPACES TO SCR-KEY-IFIA.
       FIN-GNS-CLR-RQA.
           EXIT.
      *>>>>
      *<<<< EOF
       ANL-KEY-FIA SECTION.
       INI-ANL-KEY-FIA.
      * Si existe rut de Deudor y rut de Fiador
           IF FRM-NUM-ICLI IN FIA-FLD NOT = ZEROES AND
              FRM-NUM-ICFS IN FIA-FLD NOT = ZEROES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-IDC-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-IDC-CIC-FIA
                   IF FIO-STAT-OKS
                       PERFORM BUS-FIA-ADF
                   ELSE
                       NEXT SENTENCE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe rut de Deudor
           IF FRM-NUM-ICLI IN FIA-FLD NOT = ZEROES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-IDC-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SDE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe rut de Fiador
           IF FRM-NUM-ICFS IN FIA-FLD NOT = ZEROES
               MOVE 'FIA' TO SCR-KEY-IFIA
               MOVE 'FIA' TO SCR-KEY-IDBC
               PERFORM BUS-IDC-CIC-FIA
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SFI
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe nombre de Deudor y nombre de Fiador
           IF FRM-GLS-NOMC IN FIA-FLD > SPACES AND
              FRM-GLS-NOMF IN FIA-FLD > SPACES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-NMB-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-NMB-CIC-FIA
                   IF FIO-STAT-OKS
                       PERFORM BUS-FIA-ADF
                   ELSE
                       NEXT SENTENCE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe nombre de Deudor
           IF FRM-GLS-NOMC IN FIA-FLD     > SPACES
               MOVE 'DEU' TO SCR-KEY-IFIA
               MOVE 'DEU' TO SCR-KEY-IDBC
               PERFORM BUS-NMB-CIC-DEU
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SDE
               ELSE
                   NEXT SENTENCE
           ELSE
      * Si existe nombre de Fiador
           IF FRM-GLS-NOMF IN FIA-FLD     > SPACES
               MOVE 'FIA' TO SCR-KEY-IFIA
               MOVE 'FIA' TO SCR-KEY-IDBC
               PERFORM BUS-NMB-CIC-FIA
               IF FIO-STAT-OKS
                   MOVE ADR-DBC-REQA TO SCR-DBC-REQA
                   PERFORM BUS-FIA-SFI.
       FIN-ANL-KEY-FIA.
           EXIT.

       BUS-FIA-SDE SECTION.
       INI-BUS-FIA-SDE.    
           MOVE 1 TO WSS-IKEY.
           MOVE FIA-CIC-ICLI IN FIA TO WSS-CIC-ICLI.
           MOVE LOW-VALUES          TO FIA-CIC-ICFS IN FIA.
           MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'FIA-GLS-ICYF'  TO FIO-AKEY.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND
              WSS-CIC-ICLI = FIA-CIC-ICLI IN FIA
               MOVE 1 TO WSS-IFIA
               MOVE '00' TO PGM-STAT-FIA
               MOVE 'DEU' TO SCR-KEY-IFIA 
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               PERFORM BUS-ESC
               IF FIO-STAT-OKS
                   PERFORM BUS-COR-AMF
                   IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                       MOVE 1 TO WSS-IAMF
                       MOVE '00' TO PGM-STAT-AMF
      *                PERFORM PUT-AMF-FIA
                       MOVE '00' TO FIO-STAT
                   ELSE
                       PERFORM CLR-AMF
                       MOVE '00' TO FIO-STAT
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICICLINODEU' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-FIA-SDE.
           EXIT.

       BUS-FIA-SFI SECTION.
       INI-BUS-FIA-SFI.    
           MOVE 2 TO WSS-IKEY.
           MOVE FIO-GET-KEY TO FIO-CMND
           MOVE 'FIA-CIC-ICFS'  TO FIO-AKEY
           PERFORM DEU-FIO-FIA
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-FIA
               MOVE 'FIA' TO SCR-KEY-IFIA 
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 1 TO WSS-IFIA
               PERFORM BUS-ESC
               IF FIO-STAT-OKS
                   PERFORM BUS-COR-AMF
                   IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                       MOVE 1 TO WSS-IAMF
                       MOVE '00' TO PGM-STAT-AMF
      *                PERFORM PUT-AMF-FIA
                       MOVE '00' TO FIO-STAT
                   ELSE
                       PERFORM CLR-AMF
                       MOVE '00' TO FIO-STAT
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICICFSNOFIA' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-FIA-SFI.
           EXIT.

       BUS-FIA-ADF SECTION.
       INI-BUS-FIA-ADF.
           MOVE 3 TO WSS-IKEY.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'FIA-GLS-ICYF'  TO FIO-AKEY.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS
               MOVE '00' TO PGM-STAT-FIA
               MOVE 'DEU' TO SCR-KEY-IFIA 
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 1 TO WSS-IFIA
               PERFORM BUS-ESC
               IF FIO-STAT-OKS
                   PERFORM BUS-COR-AMF
                   IF AMF-NUM-IAMF IN FIA-FLD > ZEROES
                       MOVE 1 TO WSS-IAMF
                       MOVE '00' TO PGM-STAT-AMF
      *                PERFORM PUT-AMF-FIA
                       MOVE '00' TO FIO-STAT
                   ELSE
                       PERFORM CLR-AMF
                       MOVE '00' TO FIO-STAT
               ELSE
                   NEXT SENTENCE
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'GLSICYFNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-FIA-ADF.
           EXIT.

       BUS-ESC SECTION.
       INI-BUS-ESC.
           MOVE FIA-CIC-IESC IN FIA TO ESC-CIC-IESC IN ESC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
           IF FIO-STAT-OKS
               MOVE 1 TO WSS-IESC
           ELSE
               MOVE 'DEU' TO MSG-COD-SIST
               MOVE 'CICIESCNEX' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-ESC.
           EXIT.

       BUS-NMB-CIC-DEU SECTION.
       INI-BUS-NMB-CIC-DEU.
      *NOM-CLI Busca Cliente por medio del Nombre
      *ALD
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.
      *    UNSTRING FRM-GLS-NOMC IN FIA-FLD DELIMITED BY '/' INTO
      *                            DBC-GLS-APAT IN DBC
      *                            DBC-GLS-AMAT IN DBC
      *                            DBC-GLS-NOMB IN DBC.

           MOVE FRM-GLS-NOMC IN FIA-FLD TO STR-GLS-GSTR
           PERFORM STR-UNS
           MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC.

           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO FRM-NUM-ICLI IN FIA-FLD
               MOVE SPACES TO FRM-VRF-ICLI IN FIA-FLD
               MOVE SPACES TO FRM-IND-ICLI IN FIA-FLD
               MOVE SPACES TO FRM-GLS-ICLI IN FIA-FLD
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'FRMNOMCNOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMC IN FIA-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN FIA-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN FIA-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN FIA-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN FIA-FLD
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICLI IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICLI IN FIA.
       FIN-BUS-NMB-CIC-DEU.
           EXIT.

       BUS-NMB-CIC-FIA SECTION.
       INI-BUS-NMB-CIC-FIA.
      *NOM-CLI Busca Cliente por medio del Nombre
      *ALD
           MOVE SPACES TO DBC-GLS-NOMC IN DBC.
      *    UNSTRING FRM-GLS-NOMF IN FIA-FLD DELIMITED BY '/' INTO
      *                            DBC-GLS-APAT IN DBC
      *                            DBC-GLS-AMAT IN DBC
      *                            DBC-GLS-NOMB IN DBC.

           MOVE FRM-GLS-NOMF IN FIA-FLD TO STR-GLS-GSTR
           PERFORM STR-UNS
           MOVE STR-GLS-FUNS IN STR-VARI(1) TO DBC-GLS-APAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(2) TO DBC-GLS-AMAT IN DBC
           MOVE STR-GLS-FUNS IN STR-VARI(3) TO DBC-GLS-NOMB IN DBC.

           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           MOVE FIO-GET-NLS    TO FIO-CMND.
           PERFORM SGC-FIO-DBC.
           IF NOT FIO-STAT-OKS
               MOVE ZEROES TO FRM-NUM-ICFS IN FIA-FLD
               MOVE SPACES TO FRM-VRF-ICFS IN FIA-FLD
               MOVE SPACES TO FRM-IND-ICFS IN FIA-FLD
               MOVE SPACES TO FRM-GLS-ICFS IN FIA-FLD
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'FRMNOMFNOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT
           ELSE
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMF IN FIA-FLD
               MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICFS IN FIA-FLD
               MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICFS IN FIA-FLD
               MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICFS IN FIA-FLD
               MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICFS IN FIA-FLD
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICFS IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICFS IN FIA.
       FIN-BUS-NMB-CIC-FIA.
           EXIT.

       BUS-IDC-CIC-DEU SECTION.
       INI-BUS-IDC-CIC-DEU.
           MOVE FRM-NUM-ICLI IN FIA-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-ICLI IN FIA-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-ICLI IN FIA-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMC IN FIA-FLD
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICLI IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICLI IN FIA
           ELSE
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CICICLINOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-IDC-CIC-DEU.
           EXIT.

       BUS-IDC-CIC-FIA SECTION.
       INI-BUS-IDC-CIC-FIA.
           MOVE FRM-NUM-ICFS IN FIA-FLD TO DBC-NUM-ICLI IN DBC.
           MOVE FRM-IND-ICFS IN FIA-FLD TO DBC-IND-ICLI IN DBC.
           MOVE FRM-GLS-ICFS IN FIA-FLD TO DBC-GLS-ICLI IN DBC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           MOVE 'DBC-IDC-ICLI'  TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN
               PERFORM CPT-BLKS
               MOVE CPT-STRN            TO FRM-GLS-NOMF IN FIA-FLD
               MOVE DBC-CAI-ICLI IN DBC TO FIA-CAI-ICFS IN FIA
               MOVE DBC-IIC-ICLI IN DBC TO FIA-IIC-ICFS IN FIA
           ELSE
               MOVE 'DEU'          TO MSG-COD-SIST
               MOVE 'CICICFSNOSGC' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FIO-STAT-NEX TO FIO-STAT.
       FIN-BUS-IDC-CIC-FIA.
           EXIT.

       BUS-COR-FIA SECTION.
       INI-BUS-COR-FIA.
           MOVE 0 TO FIA-NUM-IFIA IN FIA-FLD.
           MOVE ESC-CAI-IESC IN ESC TO FIA-CAI-IESC IN FIA.
           MOVE ESC-IIC-IESC IN ESC TO FIA-IIC-IESC IN FIA.
           MOVE 99                  TO FIA-NUM-IFIA IN FIA.
           MOVE FIA-CIC-IESC IN FIA TO WSS-CIC-IESC.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND WSS-CIC-IESC = FIA-CIC-IESC IN FIA
               MOVE FIA-NUM-IFIA IN FIA TO FIA-NUM-IFIA IN FIA-FLD.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO FIA-NUM-IFIA IN FIA-FLD.
       FIN-BUS-COR-FIA.
           EXIT.

       BUS-COR-AMF SECTION.
       INI-BUS-COR-AMF.
           MOVE 0 TO AMF-NUM-IAMF IN FIA-FLD.
           MOVE ESC-CAI-IESC IN ESC TO AMF-CAI-IESC IN AMF.
           MOVE ESC-IIC-IESC IN ESC TO AMF-IIC-IESC IN AMF.
           MOVE FIA-NUM-IFIA IN FIA TO AMF-NUM-IFIA IN AMF.
           MOVE 99                  TO AMF-NUM-IAMF IN AMF.
           MOVE AMF-KEY-IFIA IN AMF TO WSS-KEY-IFIA.
           MOVE FIO-GET-LEQ TO FIO-CMND.
           PERFORM DEU-FIO-AMF.
           IF FIO-STAT-OKS AND WSS-KEY-IFIA = AMF-KEY-IFIA IN AMF
               MOVE AMF-NUM-IAMF IN AMF TO AMF-NUM-IAMF IN FIA-FLD.
           IF SCR-CCPP = 'ING' OR 'ACT'
               ADD 1 TO AMF-NUM-IAMF IN FIA-FLD.
       FIN-BUS-COR-AMF.
           EXIT.

       MOD-ESC-FIA SECTION.
       INI-MOD-ESC-FIA.
           PERFORM KEY-ESC-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           IF NOT FIO-STAT-OKS
               PERFORM RET-ESC-FIA
               MOVE FIO-PUT TO FIO-CMND
               PERFORM GET-FHOY
               MOVE HOY-DHOY TO ESC-NUM-DINP IN ESC
               MOVE HOY-MHOY TO ESC-NUM-MINP IN ESC
               MOVE HOY-SHOY TO ESC-NUM-SINP IN ESC
               MOVE HOY-AHOY TO ESC-NUM-AINP IN ESC
           ELSE
               PERFORM RET-ESC-FIA
               PERFORM GET-FHOY
               MOVE FIO-MOD TO FIO-CMND.
           MOVE HOY-STP-ITRN TO ESC-STP-ITRN IN ESC.
           PERFORM DEU-FIO-ESC.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS
               GO TO FIN-MOD-ESC-FIA.
       CON-MOD-FIA.
           PERFORM KEY-FIA-FIA.
           IF FIA-NUM-IFIA IN FIA NOT > ZEROES
               GO TO FIN-MOD-ESC-FIA.
           MOVE FIO-GET-KEY-UPD TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF NOT FIO-STAT-OKS
               PERFORM RET-FIA-FIA
               IF FIA-MSC-TVLF IN FIA-FLD NOT > SPACES AND
                  FIA-COD-TOFS IN FIA-FLD NOT > SPACES AND
                  FIA-VAL-LIMF IN FIA-FLD NOT > ZEROES AND
                  FIA-COD-VCLF IN FIA-FLD NOT > SPACES AND
                  FIA-FEC-FVEN IN FIA-FLD NOT > ZEROES AND
                  FIA-CAI-ICLI IN FIA-FLD NOT > SPACES AND
                  FIA-IIC-ICLI IN FIA-FLD NOT > SPACES AND
                  FIA-CAI-ICFS IN FIA-FLD NOT > SPACES AND
                  FIA-IIC-ICFS IN FIA-FLD NOT > SPACES
                   GO TO FIN-MOD-ESC-FIA
               ELSE
                   MOVE FIO-PUT TO FIO-CMND
                   MOVE ZEROES TO FIA-FEC-FSOL IN FIA
                   MOVE ZEROES TO FIA-FEC-FAUT IN FIA
                   MOVE ZEROES TO FIA-FEC-FALZ IN FIA
                   MOVE ZEROES TO FIA-FEC-FOUT IN FIA
                   MOVE SPACES TO FIA-COD-RAUT IN FIA
                   MOVE SPACES TO FIA-COD-ABOA IN FIA
           ELSE
               PERFORM RET-FIA-FIA
               MOVE FIO-MOD TO FIO-CMND.
           MOVE HOY-STP-ITRN TO FIA-STP-ITRN IN FIA.
           PERFORM DEU-FIO-FIA.
           IF NOT FIO-STAT-OKS
               MOVE FIO-MENS TO FRM-MENS.
       FIN-MOD-ESC-FIA.
           EXIT.

       CLR-ESC SECTION.
       INI-CLR-ESC.
           MOVE SPACES TO ESC-COD-OFEF IN ESC.
           MOVE SPACES TO ESC-FEC-FCTT IN ESC.
           MOVE SPACES TO ESC-COD-NOTC IN ESC.
           MOVE SPACES TO ESC-COD-RCTT IN ESC.
           MOVE SPACES TO ESC-COD-ABOC IN ESC.
       FIN-CLR-ESC.
           EXIT.

       CLR-FIA SECTION.
       INI-CLR-FIA.
           MOVE ZEROES TO FIA-NUM-IFIA IN FIA.
           MOVE SPACES TO FIA-MSC-TVLF IN FIA.
           MOVE SPACES TO FIA-COD-TOFS IN FIA.
      *MHM-INI 07-ENE-2015                                              
      *    MOVE SPACES TO FIA-COD-AOFS IN FIA.
      *MHM-FIN 07-ENE-2015                                              
           MOVE ZEROES TO FIA-VAL-LIMF IN FIA.
      *    MOVE ZEROES TO FIA-VAL-LIMI IN FIA.
           MOVE SPACES TO FIA-COD-VCLF IN FIA.
           MOVE SPACES TO FIA-FEC-FVEN IN FIA.
           MOVE SPACES TO FIA-CAI-ICLI IN FIA.
           MOVE SPACES TO FIA-IIC-ICLI IN FIA.
           MOVE SPACES TO FIA-CAI-ICFS IN FIA.
           MOVE SPACES TO FIA-IIC-ICFS IN FIA.
       FIN-CLR-FIA.
           EXIT.

       CLR-AMF SECTION.
       INI-CLR-AMF.
           MOVE ZEROES TO AMF-NUM-IAMF IN AMF.
           MOVE SPACES TO AMF-MSC-TVOA IN AMF.
           MOVE SPACES TO AMF-COD-TOOA IN AMF.
           MOVE SPACES TO AMF-COD-OFOA IN AMF.
           MOVE SPACES TO AMF-CAI-IOCA IN AMF.
           MOVE ZEROES TO AMF-IIC-IOCA IN AMF.
           MOVE SPACES TO AMF-COD-VCOA IN AMF.
           MOVE SPACES TO AMF-COD-AOOA IN AMF.
           MOVE SPACES TO AMF-COD-CDOA IN AMF.
           MOVE ZEROES TO AMF-VAL-LIMA IN AMF.
      *    MOVE ZEROES TO AMF-VAL-LIMI IN AMF.
           MOVE SPACES TO AMF-COD-VCLA IN AMF.
           MOVE SPACES TO AMF-IND-TDEU IN AMF.
      *    MOVE SPACES TO AMF-FEC-FIAM IN AMF.
      *    MOVE SPACES TO AMF-FEC-FFAM IN AMF.
       FIN-CLR-AMF.
           EXIT.
       PUT-DBC-FIA SECTION.
       INI-PUT-DBC-FIA.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO FRM-GLS-NOMF IN FIA-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICFS IN FIA-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICFS IN FIA-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICFS IN FIA-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICFS IN FIA-FLD.
       FIN-PUT-DBC-FIA.
           EXIT.

       PUT-DBC-DEU SECTION.
       INI-PUT-DBC-DEU.
           MOVE DBC-GLS-NOMC IN DBC TO CPT-STRN.
           PERFORM CPT-BLKS.
           MOVE CPT-STRN            TO FRM-GLS-NOMC IN FIA-FLD.
           MOVE DBC-NUM-ICLI IN DBC TO FRM-NUM-ICLI IN FIA-FLD.
           MOVE DBC-IND-ICLI IN DBC TO FRM-IND-ICLI IN FIA-FLD.
           MOVE DBC-VRF-ICLI IN DBC TO FRM-VRF-ICLI IN FIA-FLD.
           MOVE DBC-GLS-ICLI IN DBC TO FRM-GLS-ICLI IN FIA-FLD.
       FIN-PUT-DBC-DEU.
           EXIT.

       SET-MSG SECTION.
       INI-SET-MSG.
           PERFORM GET-MSG.
           MOVE MSG-GLS-DESC TO FRM-MENS.
           MOVE '00' TO FIO-STAT.
           MOVE SCR-STAT-CON TO SCR-STAT.
       FIN-SET-MSG.
           EXIT.

       LEE-NXT-PRV-ESC SECTION.
       INI-LEE-NXT-PRV-ESC.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-FIA-REQA > SPACES
               PERFORM LEE-NXT-PRV-FIA
           ELSE
               MOVE 'FIANO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-ESC.
           EXIT.

       LEE-NXT-PRV-FIA SECTION.
       INI-LEE-NXT-PRV-FIA.
           MOVE SCR-FIA-REQA TO ADR-FIA-REQA.
           MOVE ADR-VKEY IN ADR-FIA-REQA TO WSS-CIC-ICLI IN WSS-VARI.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF5
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-FIA.
           IF FIO-STAT-OKS AND SCR-KEY-IFIA = 'DEU' AND
              FIA-CIC-ICLI IN FIA = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 'FIASI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-FIA.
           IF FIO-STAT-OKS AND SCR-KEY-IFIA = 'FIA' AND
              FIA-CIC-ICFS IN FIA = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 'FIASI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-FIA.
           IF FIO-STAT-OKS AND SCR-KEY-IFIA = 'ESC' AND
              FIA-CIC-IESC IN FIA = WSS-CIC-ICLI IN WSS-VARI
               MOVE '00' TO PGM-STAT-FIA
               MOVE ADR-FIA-REQA TO SCR-FIA-REQA
               MOVE 'FIASI' TO MSG-COD-MENS
               GO TO FIN-LEE-NXT-PRV-FIA.
           MOVE 'FIANO' TO MSG-COD-MENS.
       FIN-LEE-NXT-PRV-FIA.
           EXIT.

       LEE-NXT-PRV SECTION.
       INI-LEE-NXT-PRV.
           MOVE SPACES TO MSG-COD-MENS.
           IF SCR-DBC-REQA > SPACES
               PERFORM LEE-NXT-PRV-DBC
           ELSE
               PERFORM LEE-NXT-PRV-NOM.
       FIN-LEE-NXT-PRV.
           EXIT.

       LEE-NXT-PRV-DBC SECTION.
       INI-LEE-NXT-PRV-DBC.
           MOVE SCR-DBC-REQA TO ADR-DBC-REQA.
           MOVE FIO-KDEF-S TO FIO-KDEF.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-DBC.
           EXIT.

       LEE-NXT-PRV-NOM SECTION.
       INI-LEE-NXT-PRV-NOM.
           MOVE 'DEU' TO SCR-KEY-IDBC.
           MOVE FRM-GLS-NOMC IN FIA-FLD TO DBC-GLS-NOMC IN DBC.
           IF FRM-GLS-NOMF IN FIA-FLD > SPACES
               MOVE 'FIA' TO SCR-KEY-IDBC 
               MOVE FRM-GLS-NOMF IN FIA-FLD TO DBC-GLS-NOMC IN DBC.
           IF FRM-GLS-NOMC IN FIA-FLD > SPACES
               MOVE 'DEU' TO SCR-KEY-IDBC
               MOVE FRM-GLS-NOMC IN FIA-FLD TO DBC-GLS-NOMC IN DBC.
           IF DBC-GLS-NOMC IN DBC > SPACES
               MOVE FIO-GET-KEY    TO FIO-CMND
               MOVE 'DBC-GLS-NOMC' TO FIO-AKEY
               PERFORM SGC-FIO-DBC
               IF FIO-STAT-OKS
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-PRV TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NXT TO FIO-CMND
               ELSE
                   IF FRM-FFLD = FRM-FFLD-PF7
                       MOVE FIO-GET-LEQ TO FIO-CMND
                   ELSE
                       MOVE FIO-GET-NLS TO FIO-CMND
           ELSE
               IF FRM-FFLD = FRM-FFLD-PF7
                   MOVE FIO-GET-LEQ TO FIO-CMND
               ELSE
                   MOVE FIO-GET-NLS TO FIO-CMND.
           MOVE 'DBC-GLS-NOMC' TO FIO-AKEY.
           PERFORM SGC-FIO-DBC.
           IF FIO-STAT-OKS
               MOVE ADR-DBC-REQA TO SCR-DBC-REQA.
       FIN-LEE-NXT-PRV-NOM.
           EXIT.

       NXT-PRV-ESC SECTION.
       INI-NXT-PRV-ESC.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           IF FRM-FFLD = FRM-FFLD-PF7
               MOVE FIO-GET-PRV TO FIO-CMND
           ELSE
               MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-ESC.
           MOVE FIO-STAT TO PGM-STAT-ESC.
       FIN-NXT-PRV-ESC.
           EXIT.

       COPY DEUBFESC.
       COPY DEUBFFIA.
       COPY GNSBBMSC.
       COPY GNSBEGLS.
       COPY GNSBGCPT.
       COPY GNSBGSTR.
       COPY GNSBGCIC.
       COPY GNSBFCIC.
       COPY SGCBFDBC.
      *>>>>
      *<<<< EOF_PQ
       RET-FIA-FIA SECTION.
       INI-RET-FIA-FIA.
           MOVE FIA-MSC-TVLF IN FIA-FLD TO FIA-MSC-TVLF IN FIA.
           MOVE FIA-COD-TOFS IN FIA-FLD TO FIA-COD-TOFS IN FIA.
      *MHM-INI 07-ENE-2015                                              
      *    MOVE FIA-COD-AOFS IN FIA-FLD TO FIA-COD-AOFS IN FIA.
      *MHM-FIN 07-ENE-2015                                              
           MOVE FIA-VAL-LIMF IN FIA-FLD TO FIA-VAL-LIMF IN FIA.
      *    MOVE FIA-VAL-LIMI IN FIA-FLD TO FIA-VAL-LIMI IN FIA. 
           MOVE FIA-COD-VCLF IN FIA-FLD TO FIA-COD-VCLF IN FIA.
           MOVE FIA-NUM-DVEN IN FIA-FLD TO FIA-NUM-DVEN IN FIA.
           MOVE FIA-NUM-MVEN IN FIA-FLD TO FIA-NUM-MVEN IN FIA.
           MOVE FIA-NUM-SVEN IN FIA-FLD TO FIA-NUM-SVEN IN FIA.
           MOVE FIA-NUM-AVEN IN FIA-FLD TO FIA-NUM-AVEN IN FIA.
           MOVE FIA-MSC-STAT IN FIA-FLD TO FIA-MSC-STAT IN FIA.
           MOVE FIA-CAI-ICLI IN FIA-FLD TO FIA-CAI-ICLI IN FIA.
           MOVE FIA-IIC-ICLI IN FIA-FLD TO FIA-IIC-ICLI IN FIA.
           MOVE FIA-CAI-ICFS IN FIA-FLD TO FIA-CAI-ICFS IN FIA.
           MOVE FIA-IIC-ICFS IN FIA-FLD TO FIA-IIC-ICFS IN FIA.
      *<<<< FIN_RET_FIA_FIA OR FIN_KEY_FIA_FIA
           MOVE ESC-CAI-IESC IN FIA-FLD TO FIA-CAI-IESC IN FIA.
           MOVE ESC-IIC-IESC IN FIA-FLD TO FIA-IIC-IESC IN FIA.
      *>>>>
       FIN-RET-FIA-FIA.
           EXIT.
       
       RET-ESC-FIA SECTION.
       INI-RET-ESC-FIA.
           MOVE ESC-COD-OFEF IN FIA-FLD TO ESC-COD-OFEF IN ESC.
           MOVE ESC-NUM-DCTT IN FIA-FLD TO ESC-NUM-DCTT IN ESC.
           MOVE ESC-NUM-MCTT IN FIA-FLD TO ESC-NUM-MCTT IN ESC.
           MOVE ESC-NUM-SCTT IN FIA-FLD TO ESC-NUM-SCTT IN ESC.
           MOVE ESC-NUM-ACTT IN FIA-FLD TO ESC-NUM-ACTT IN ESC.
           MOVE ESC-COD-NOTC IN FIA-FLD TO ESC-COD-NOTC IN ESC.
           MOVE ESC-COD-RCTT IN FIA-FLD TO ESC-COD-RCTT IN ESC.
           MOVE ESC-COD-ABOC IN FIA-FLD TO ESC-COD-ABOC IN ESC.
       FIN-RET-ESC-FIA.
           EXIT.
       
       PRO-FLD-FIA SECTION.
       INI-PRO-FLD-FIA.
           PERFORM PRO-FIA-FIA.
           PERFORM PRO-ESC-FIA.
           PERFORM PRO-AMF-FIA.
       FIN-PRO-FLD-FIA.
           EXIT.
       
       PRO-FIA-FIA SECTION.
       INI-PRO-FIA-FIA.
           MOVE FRM-CPIM-AEY TO FIA-COD-TOFS-ATR IN FIA-FLD.
      *MHM-INI 07-ENE-2015                                              
      *    MOVE FRM-CPIM-AEY TO FIA-COD-AOFS-ATR IN FIA-FLD.
      *MHM-FIN 07-ENE-2015                                              
           MOVE FRM-CPIM-AEY TO FIA-VAL-LIMF-ATR IN FIA-FLD.
      *    MOVE FRM-CPIM-AEY TO FIA-VAL-LIMI-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FIA-COD-VCLF-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FIA-FEC-FVEN-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO FIA-MSC-STAT-ATR IN FIA-FLD.
       FIN-PRO-FIA-FIA.
           EXIT.
       
       PRO-ESC-FIA SECTION.
       INI-PRO-ESC-FIA.
           MOVE FRM-CPIM-AEY TO ESC-COD-OFEF-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO ESC-FEC-FCTT-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO ESC-COD-NOTC-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO ESC-COD-RCTT-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO ESC-COD-ABOC-ATR IN FIA-FLD.
       FIN-PRO-ESC-FIA.
           EXIT.
       
       PRO-AMF-FIA SECTION.
       INI-PRO-AMF-FIA.
           MOVE FRM-CPIM-AEY TO AMF-MSC-TVOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-TOOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-OFOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-CAI-IOCA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-IIC-IOCA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-VCOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-AOOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-CDOA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-VAL-LIMA-ATR IN FIA-FLD.           
      *    MOVE FRM-CPIM-AEY TO AMF-VAL-LIMI-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-COD-VCLA-ATR IN FIA-FLD.
           MOVE FRM-CPIM-AEY TO AMF-IND-TDEU-ATR IN FIA-FLD.
      *    MOVE FRM-CPIM-AEY TO AMF-FEC-FIAM-ATR IN FIA-FLD.
      *    MOVE FRM-CPIM-AEY TO AMF-FEC-FFAM-ATR IN FIA-FLD.
       FIN-PRO-AMF-FIA.
           EXIT.
      *OGB-INI 25-FEB-2016 FIANZAS FASE I
      *----------------------------------------------------------
      * REVISA FECHA DE VENCIMIENTO VS FHOY Y DESPLIEGA MENSAJE
      *----------------------------------------------------------
       CHK-FEC-FVEN SECTION.
       INI-CHK-FEC-FVEN.
       
            IF (SCR-CMND = WSS-CT-ING OR WSS-CT-INC) AND
                FIA-MSC-STAT IN FIA NOT = WSS-CT-S
                GO TO FIN-CHK-FEC-FVEN.
              
      *FIA ACTIVADA Y SIN FECHA DE VENCIMIENTO
           IF FIA-MSC-STAT IN FIA = WSS-CT-S
              IF FIA-NUM-SVEN IN FIA NOT > ZEROES
                 MOVE WSS-CT-DEU       TO MSG-COD-SIST
                 MOVE WSS-CT-VIGNFVCTO TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-MENS
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-CHK-FEC-FVEN.

      *FIA NO ACTIVADA Y SIN FECHA DE VENCIMIENTO
           IF FIA-MSC-STAT IN FIA NOT = WSS-CT-S
              IF FIA-NUM-SVEN IN FIA NOT > ZEROES
                 MOVE WSS-CT-DEU       TO MSG-COD-SIST
                 MOVE WSS-CT-NOACTINF  TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-MENS
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-CHK-FEC-FVEN.

      *FIA ACTIVADA Y FEC VEN < FHOY (VENCIDA)
           IF FIA-MSC-STAT IN FIA = WSS-CT-S 
              PERFORM GET-FHOY
              IF HOY-FHOY > FIA-FEC-FVEN IN FIA
                 MOVE WSS-CT-DEU     TO MSG-COD-SIST
                 MOVE WSS-CT-FIAVCDA TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-MENS
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-CHK-FEC-FVEN
      *FIA ACTIVADA Y FEC VEN = FHOY (CON FEC VCTO)
              ELSE
              IF HOY-FHOY = FIA-FEC-FVEN IN FIA
                 MOVE WSS-CT-DEU         TO MSG-COD-SIST
                 MOVE WSS-CT-AFVCTOHOY   TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-MENS
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-CHK-FEC-FVEN
      *FIA ACTIVADA Y FEC VEN > FHOY (CON FEC VCTO)
              ELSE
                 MOVE WSS-CT-DEU        TO MSG-COD-SIST
                 MOVE WSS-CT-AFVCTOFUT  TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-MENS
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-CHK-FEC-FVEN
           ELSE
      *FIA NO ACTIVADA Y FEC VEN < FHOY (VENCIDA)
              PERFORM GET-FHOY
              IF HOY-FHOY > FIA-FEC-FVEN IN FIA
                 MOVE WSS-CT-DEU       TO MSG-COD-SIST
                 MOVE WSS-CT-NOACTVCDA TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-MENS
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-CHK-FEC-FVEN
      *FIA NO ACTIVADA Y FEC VEN = FHOY (VENCE HOY)
              ELSE
              IF HOY-FHOY = FIA-FEC-FVEN IN FIA
                 MOVE WSS-CT-DEU        TO MSG-COD-SIST
                 MOVE WSS-CT-NOACTFECH  TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-MENS
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-CHK-FEC-FVEN
      *FIA NO ACTIVADA Y FEC VEN > FHOY (VENCE FUTURO)
              ELSE
              IF HOY-FHOY < FIA-FEC-FVEN IN FIA
                 MOVE WSS-CT-DEU        TO MSG-COD-SIST
                 MOVE WSS-CT-NOACTFECF  TO MSG-COD-MENS
                 PERFORM GET-MSG
                 MOVE MSG-GLS-DESC TO WSS-GLS-MENS
                 MOVE WSS-CT-C00   TO FIO-STAT
                 GO TO FIN-CHK-FEC-FVEN.     
       FIN-CHK-FEC-FVEN.
           EXIT.
      *OGB-FIN 25-FEB-2016 FIANZAS FASE I
      *>>>>
