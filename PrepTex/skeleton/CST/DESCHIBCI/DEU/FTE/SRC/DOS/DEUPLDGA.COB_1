       IDENTIFICATION DIVISION.
      *=======================
       PROGRAM-ID.      DEUPLDGA.
       AUTHOR.          GUZMAN Y CIA..
      * Programa Listador sin Sort
       ENVIRONMENT DIVISION.
      *====================
       CONFIGURATION SECTION.
      *---------------------
       SPECIAL-NAMES.
            DECIMAL-POINT IS COMMA.
       INPUT-OUTPUT SECTION.
      *--------------------
       FILE-CONTROL.
           SELECT RPTDGA       ASSIGN TO SYS011-UR-1403-S.
       DATA DIVISION.
      *=============
       FILE SECTION.
      *------------
       FD  RPTDGA LABEL RECORD OMITTED
           REPORT IS RPT-DGA.
       WORKING-STORAGE SECTION.
      *-----------------------
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==GAR-REQA==.
       COPY DEUBRGAR.
       COPY DEURRDGA.
      *<<<<
      *>>>>
       COPY GNSWGRQA.
       COPY GNSWGDIO.
       COPY GNSWGRPT.
       COPY GNSWGIFD.
       COPY DEURWDGA.
      *<<<<
       COPY SGCBRDBC.
       COPY DEUBRAMG.
       COPY DEUBRRGD.
       COPY TABBRUSR.
       COPY TABBROFI.
       COPY GNSBRMSG.
       COPY GNSBRTAB.
       COPY GNSBRMSC.
       COPY GNSWGFEC.
       COPY GARWGTOG.
       01  WSS-VARI.
           03 WSS-FEC-FFOT.
              05 WSS-NUM-DFOT                   PIC 9(02).
              05 WSS-NUM-MFOT                   PIC 9(02).
              05 WSS-NUM-SFOT                   PIC 9(02).
              05 WSS-NUM-AFOT                   PIC 9(02).
           03 WSS-FEC-CMPR.
              05 WSS-NUM-SMPR                   PIC 9(02).
              05 WSS-NUM-AMPR                   PIC 9(02).
              05 WSS-NUM-MMPR                   PIC 9(02).
              05 WSS-NUM-DMPR                   PIC 9(02).
           03 WSS-FEC-FFEC.
              05 WSS-NUM-SFEC                   PIC 9(02).
              05 WSS-NUM-AFEC                   PIC 9(02).
              05 WSS-NUM-MFEC                   PIC 9(02).
              05 WSS-NUM-DFEC                   PIC 9(02).
           03 WSS-IND-TFEC         VALUE SPACES PIC X(01).
           03 WSS-IDC-IDEN.
               05 WSS-NUM-IDEN                  PIC X(08).
               05 WSS-IND-IDEN                  PIC X(01).
               05 WSS-GLS-IDEN                  PIC X(03).
      * Variables para llamada a 'GARPBGAR'
           03 WSS-IND-TIDE                      PIC X(01).
      *>>>>
      *<<<<
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==DBC-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==AMG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==RGD-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==USR-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==OFI-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==MSG-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==TAB-REQA==.
       COPY GNSWGRQA REPLACING ==ADR-REQA== BY ==MSC-REQA==.
      *>>>>
       REPORT SECTION.
      *--------------
       COPY DEURFDGA.
      *<<<<
      *>>>>
           .
       COPY DEURTDGA.
      *<<<<
      *>>>>
       PROCEDURE DIVISION.
      *==================
       DECLARATIVES.
       DEC-PH-DGA SECTION.
           USE BEFORE REPORTING PH-DGA.
       INI-PH-DGA.
       FIN-PH-DGA.
           EXIT.
       END DECLARATIVES.
       MAIN SECTION.
      *------------
       INI-MAIN.
           ENTRY 'DBMSCBL'.
           PERFORM BUS-FSIS.
           MOVE 'DEUPLDGA' TO IFD-PROG.
       INI-INP-SRT.
      *<<<<
      *----ACEPTAR FECHA DEL INFORME------------------------
           DISPLAY 'INGRESE A QUE FECHA DESEA INFORME :'.
           ACCEPT WSS-FEC-FFOT IN WSS-VARI.
           MOVE WSS-FEC-FFOT IN WSS-VARI TO FEC-FECH.
           MOVE FEC-FORM-FEC TO FEC-FORM.
           MOVE FEC-VAL-FEC  TO FEC-CMND.
           PERFORM PRO-FEC.
           IF NOT FEC-STAT-OKS
               DISPLAY 'FECHA INVALIDA : ' WSS-FEC-FFOT IN WSS-VARI
               STOP RUN.
           MOVE WSS-NUM-DFOT IN WSS-VARI TO WSS-NUM-DFOT IN WSS-DGA.
           MOVE WSS-NUM-MFOT IN WSS-VARI TO WSS-NUM-MFOT IN WSS-DGA.
           MOVE WSS-NUM-SFOT IN WSS-VARI TO WSS-NUM-SFOT IN WSS-DGA.
           MOVE WSS-NUM-AFOT IN WSS-VARI TO WSS-NUM-AFOT IN WSS-DGA.
      *----ACEPTAR I.D.C. DEL DEUDOR------------------------
           DISPLAY 'INGRESE I.D.C DEL DEUDOR'.
           ACCEPT WSS-IDC-IDEN IN WSS-VARI.
      *----VALIDACION PENDIENTE-----------------------------
      *
      *----TIPO DE FECHA POR DEFAULT
           MOVE 'R' TO WSS-IND-TFEC IN WSS-VARI.
           MOVE 'D' TO WSS-IND-TIDE IN WSS-VARI.
      *------------------------------------------------------
           CALL 'GARPBGAR' USING WSS-IND-TIDE IN WSS-VARI ,
                                 WSS-IDC-IDEN IN WSS-VARI ,
                                 WSS-IND-TFEC IN WSS-VARI ,
                                 GAR-FEC-FCTT IN GAR.
      *>>>>
           CALL 'GNSPLHDR' USING RPT-VARI.
           MOVE FIO-GET-FST TO FIO-CMND.
           PERFORM DEU-FIO-GAR.
       INI-OUT-SRT.
      *<<<<
      *>>>>
           OPEN OUTPUT RPTDGA.
           INITIATE RPT-DGA.
       LUP-MAIN.
       LUP-INP-SRT.
           IF NOT FIO-STAT-OKS
                GO TO FIN-MAIN.
      *<<<<
      *>>>>
       MOV-INP-SRT.
       COPY DEURMDGA.
      *<<<<
      *>>>>
       LUP-OUT-SRT.
      *<<<<
      *-----------------------------------------------------*
      *        BUSCAR GLOSAS FIANZA                         *
      *
      * BUSCAR GLOSAS DE LA INTERFACE ( T.GTIA,R/NR,G/E )
      *  FALTA AGREGAR TIPO DE OPERACION AL REG GAR. YA QUE HOY SE ESTA
      *  PISANDO   (SEGUN L.J.)
      *
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB
           MOVE GAR-COD-VCGA IN GAR TO TAB-COD-CTAB IN TAB
           PERFORM BUS-TAB
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCGA IN WSS-DGA
      *BUS-OFI busca oficina en tablas
           MOVE GAR-COD-OFIC IN GAR TO OFI-COD-OFIC IN OFI
           PERFORM BUS-OFI
           MOVE OFI-GLS-DESC IN OFI TO WSS-GLS-OFIC IN WSS-DGA
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'IVB' TO TAB-COD-TTAB IN TAB.
           MOVE GAR-COD-SEGU IN GAR TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-SEGU IN WSS-DGA.
      *BUS-TAB busca glosa de codigo en tabla
           MOVE 'TAB' TO TAB-COD-SIST.
           MOVE 'VLR' TO TAB-COD-TTAB IN TAB.
           MOVE GAR-COD-VCSE IN GAR TO TAB-COD-CTAB IN TAB.
           PERFORM BUS-TAB.
           MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCSE IN WSS-DGA.
      *>>>>
           GENERATE DL-DGA.
      *<<<<
           MOVE GAR-IND-TVAL IN SRT TO AMG-IND-TVAL IN AMG.
           MOVE GAR-COD-TIOP IN SRT TO AMG-COD-TIOP IN AMG.
           MOVE GAR-COD-OFIC IN SRT TO AMG-COD-OFIC IN AMG.
           MOVE GAR-NUM-IGAR IN SRT TO AMG-NUM-IGAR IN AMG.
           MOVE 0                   TO AMG-NUM-IGAR IN AMG.
           MOVE FIO-GET-NLS TO FIO-CMND.
       GET-NXT-AMG.
           PERFORM DEU-FIO-AMG.
           IF NOT FIO-STAT-OKS OR
              AMG-IND-TVAL IN AMG NOT = GAR-IND-TVAL IN SRT OR
              AMG-COD-TIOP IN AMG NOT = GAR-COD-TIOP IN SRT OR
              AMG-COD-OFIC IN AMG NOT = GAR-COD-OFIC IN SRT OR
              AMG-NUM-IGAR IN AMG NOT = GAR-NUM-IGAR IN SRT
               GO TO NXT-OUT-SRT.
      *-----------------------------------------------------*
      *        BUSCAR GLOSAS AMBITO                         *
      *BUS-MSC busca glosa de miscelaneo en tabla
           IF AMG-IND-TVOG IN AMG NOT = SPACES
               MOVE 'TAB' TO MSC-COD-SIST
               MOVE 'TVAL' TO MSC-COD-TMSC IN MSC
               MOVE AMG-IND-TVOG IN AMG TO MSC-COD-CMSC IN MSC
               PERFORM BUS-MSC
               MOVE MSC-GLS-DESC IN MSC TO WSS-GLS-TVOG IN WSS-DGA
           ELSE
               MOVE SPACES TO WSS-GLS-TVOG IN WSS-DGA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMG-COD-TOOG IN AMG NOT = SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE AMG-COD-TOOG IN AMG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-TOOG IN WSS-DGA
           ELSE
               MOVE SPACES TO WSS-GLS-TOOG IN WSS-DGA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMG-COD-OFOG IN AMG NOT = SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'TIO' TO TAB-COD-TTAB IN TAB
               MOVE AMG-COD-OFOG IN AMG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-OFOG IN WSS-DGA
           ELSE
               MOVE SPACES TO WSS-GLS-OFOG IN WSS-DGA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMG-COD-VCCR IN AMG NOT = SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE AMG-COD-VCCR IN AMG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCCR IN WSS-DGA
           ELSE
               MOVE SPACES TO WSS-GLS-VCCR IN WSS-DGA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMG-COD-AUXI IN AMG NOT = SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'AUX' TO TAB-COD-TTAB IN TAB
               MOVE AMG-COD-AUXI IN AMG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-AUXI IN WSS-DGA
           ELSE
               MOVE SPACES TO WSS-GLS-AUXI IN WSS-DGA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMG-COD-DEST IN AMG NOT = SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'DES' TO TAB-COD-TTAB IN TAB
               MOVE AMG-COD-DEST IN AMG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-DEST IN WSS-DGA
           ELSE
               MOVE SPACES TO WSS-GLS-DEST IN WSS-DGA.
      *BUS-TAB busca glosa de codigo en tabla
           IF AMG-COD-VCLC IN AMG NOT = SPACES
               MOVE 'TAB' TO TAB-COD-SIST
               MOVE 'VLR' TO TAB-COD-TTAB IN TAB
               MOVE AMG-COD-VCLC IN AMG TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO WSS-GLS-VCLC IN WSS-DGA
           ELSE
               MOVE SPACES TO WSS-GLS-VCLC IN WSS-DGA.
      *                                                     *
      *        FIN  DE  GLOSAS                              *
      *-----------------------------------------------------*
           GENERATE DL-AMG.
           MOVE FIO-GET-NXT TO FIO-CMND.
           GO TO GET-NXT-AMG.
      *>>>>
       NXT-INP-SRT.
       NXT-OUT-SRT.
           MOVE FIO-GET-NXT TO FIO-CMND.
           PERFORM DEU-FIO-GAR.
           GO TO LUP-MAIN.
       FIN-MAIN.
       FIN-INP-SRT.
      *<<<<
      *>>>>
       FIN-OUT-SRT.
      *<<<<
      *>>>>
           TERMINATE RPT-DGA.
           CLOSE RPTDGA.
           STOP RUN.
       COPY DEUBFGAR.
       COPY GNSBGIFD.
       COPY GNSBTABT.
      *<<<<
       COPY GNSBGFEC.
       COPY GARBGTOG.
       COPY DEUBFAMG.
       COPY DEUBFRGD.
       COPY GNSBFTAB.
       COPY GNSBSTAB.
       COPY GNSBVTAB.
       COPY GNSBFMSC.
       COPY GNSBSMSC.
       COPY GNSBVMSC.
       COPY GNSBSMSG.
       COPY GNSBFMSG.
       COPY GNSIOMSL.
       COPY GNSIOPRM.
       COPY TABBBUSR.
       COPY TABBFUSR.
       COPY TABBBOFI.
       COPY TABBFOFI.
       COPY SGCBFDBC.
      *>>>>
