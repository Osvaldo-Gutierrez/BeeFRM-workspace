      *
      * DEUBQIC2
      * Version 3.0.1 Nov-2005
      * 07-Dec-18 12:00 PM
      *
       SET-TAG-DEUBQIC2 SECTION.
       INI-SET-TAG-DEUBQIC2.
           MOVE
           '<IDNMOD NOM=$DEUBQIC2$ VSN=${VSNBQ}$ VGM=$3.0.1$
      -    'GEN=$07-Dec-18 12:00 PM$ FNC=${FNCBQ}$/>'
               TO WSS-CVT-ITEM.
       FIN-SET-TAG-DEUBQIC2.
           EXIT.
           
       PUT-ALL-IC2 SECTION.
       INI-PUT-ALL-IC2.
           PERFORM PUT-CIP-IC2.
       FIN-PUT-ALL-IC2.
           EXIT.
       
       PUT-CIP-IC2 SECTION.
       INI-PUT-CIP-IC2.
           IF PGM-STAT-CIP-NUL
               GO TO FIN-PUT-CIP-IC2.
           IF NOT PGM-STAT-CIP-OKS
               PERFORM CLR-CIP-IC2
               GO TO FIN-PUT-CIP-IC2.
           MOVE CIP-CAI-ICER IN CIP TO CIP-CAI-ICER IN IC2-FLD.
           MOVE CIP-IIC-ICER IN CIP TO CIP-IIC-ICER IN IC2-FLD.
           MOVE CIP-NUM-ICIP IN CIP TO CIP-NUM-ICIP IN IC2-FLD.
           MOVE CIP-COD-CPTO IN CIP TO CIP-COD-CPTO IN IC2-FLD.
           MOVE CIP-COD-TIPO IN CIP TO CIP-COD-TIPO IN IC2-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CIP-NUM-DCOL IN CIP TO CIP-NUM-DCOL IN IC2-FLD.
           MOVE CIP-NUM-MCOL IN CIP TO CIP-NUM-MCOL IN IC2-FLD.
           MOVE CIP-NUM-SCOL IN CIP TO CIP-NUM-SCOL IN IC2-FLD.
           MOVE CIP-NUM-ACOL IN CIP TO CIP-NUM-ACOL IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CIP-NUM-DMAV IN CIP TO CIP-NUM-DMAV IN IC2-FLD.
           MOVE CIP-NUM-MMAV IN CIP TO CIP-NUM-MMAV IN IC2-FLD.
           MOVE CIP-NUM-SMAV IN CIP TO CIP-NUM-SMAV IN IC2-FLD.
           MOVE CIP-NUM-AMAV IN CIP TO CIP-NUM-AMAV IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE CIP-SGV-MNTO IN CIP TO CIP-SGV-MNTO IN IC2-FLD.
           MOVE CIP-VAL-SIMO IN CIP TO CIP-VAL-SIMO IN IC2-FLD.
           MOVE CIP-SGV-TOPE IN CIP TO CIP-SGV-TOPE IN IC2-FLD.
           MOVE CIP-SGV-TINT IN CIP TO CIP-SGV-TINT IN IC2-FLD.
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CIP-NUM-DINI IN CIP TO CIP-NUM-DINI IN IC2-FLD.
           MOVE CIP-NUM-MINI IN CIP TO CIP-NUM-MINI IN IC2-FLD.
           MOVE CIP-NUM-SINI IN CIP TO CIP-NUM-SINI IN IC2-FLD.
           MOVE CIP-NUM-AINI IN CIP TO CIP-NUM-AINI IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
      * FEC-INI --> BMCHIBCI001210.SRCAIU 
           MOVE CIP-NUM-DTER IN CIP TO CIP-NUM-DTER IN IC2-FLD.
           MOVE CIP-NUM-MTER IN CIP TO CIP-NUM-MTER IN IC2-FLD.
           MOVE CIP-NUM-STER IN CIP TO CIP-NUM-STER IN IC2-FLD.
           MOVE CIP-NUM-ATER IN CIP TO CIP-NUM-ATER IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI001210.SRCAIU 
           MOVE CIP-NUM-PTRM IN CIP TO CIP-NUM-PTRM IN IC2-FLD.
           MOVE CIP-SGV-CUOT IN CIP TO CIP-SGV-CUOT IN IC2-FLD.
           MOVE CIP-NUM-FOLI IN CIP TO CIP-NUM-FOLI IN IC2-FLD.
           MOVE CIP-GLS-NORM IN CIP TO CIP-GLS-NORM IN IC2-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CIP-COD-CPTO IN IC2-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'CNP ' TO TAB-COD-TTAB IN TAB
               MOVE CIP-COD-CPTO IN IC2-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-CPTO IN IC2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-CPTO IN IC2-FLD.
      *BUS-TAB busca glosa de codigo en tabla
           IF CIP-COD-TIPO IN IC2-FLD > SPACES
               MOVE 'COL' TO TAB-COD-SIST
               MOVE 'TEA ' TO TAB-COD-TTAB IN TAB
               MOVE CIP-COD-TIPO IN IC2-FLD TO TAB-COD-CTAB IN TAB
               PERFORM BUS-TAB
               MOVE TAB-GLS-DESC IN TAB TO
                    FRM-GLS-TIPO IN IC2-FLD
           ELSE
               MOVE SPACES TO FRM-GLS-TIPO IN IC2-FLD.
       FIN-PUT-CIP-IC2.
           EXIT.
       
       KEY-ALL-IC2 SECTION.
       INI-KEY-ALL-IC2.
           PERFORM KEY-CIP-IC2.
       FIN-KEY-ALL-IC2.
           EXIT.
       
       KEY-CIP-IC2 SECTION.
       INI-KEY-CIP-IC2.
           MOVE CIP-CAI-ICER IN IC2-FLD TO CIP-CAI-ICER IN CIP.
           MOVE CIP-IIC-ICER IN IC2-FLD TO CIP-IIC-ICER IN CIP.
           MOVE CIP-NUM-ICIP IN IC2-FLD TO CIP-NUM-ICIP IN CIP.
       FIN-KEY-CIP-IC2.
           EXIT.
       
       SCR-CLRA-IC2 SECTION.
       INI-SCR-CLRA-IC2.
           PERFORM CLR-KEY-IC2.
           PERFORM CLR-FLD-IC2.
       FIN-SCR-CLRA-IC2.
           EXIT.
       
       CLR-KEY-IC2 SECTION.
       INI-CLR-KEY-IC2.
           MOVE SPACES TO CIP-CAI-ICER IN IC2-FLD.
           MOVE ZEROES TO CIP-IIC-ICER IN IC2-FLD.
           MOVE ZEROES TO CIP-NUM-ICIP IN IC2-FLD.
       FIN-CLR-KEY-IC2.
           EXIT.
       
       CLR-FLD-IC2 SECTION.
       INI-CLR-FLD-IC2.
           MOVE SPACES TO FRM-GLS-CPTO IN IC2-FLD.
           MOVE SPACES TO FRM-GLS-TIPO IN IC2-FLD.
           PERFORM CLR-CIP-IC2.
       FIN-CLR-FLD-IC2.
           EXIT.
       
       CLR-CIP-IC2 SECTION.
       INI-CLR-CIP-IC2.
           MOVE SPACES TO CIP-COD-CPTO IN IC2-FLD.
           MOVE SPACES TO CIP-COD-TIPO IN IC2-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-FEC-FCOL IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-FEC-FMAV IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-SGV-MNTO IN IC2-FLD.
           MOVE ZEROES TO CIP-VAL-SIMO IN IC2-FLD.
           MOVE ZEROES TO CIP-SGV-TOPE IN IC2-FLD.
           MOVE ZEROES TO CIP-SGV-TINT IN IC2-FLD.
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-FEC-FINI IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
      * FEC-INI --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-FEC-FTER IN IC2-FLD.
      * FEC-FIN --> BMCHIBCI003.SRCAIU CLR ( KEY Y FLD )
           MOVE ZEROES TO CIP-NUM-PTRM IN IC2-FLD.
           MOVE ZEROES TO CIP-SGV-CUOT IN IC2-FLD.
           MOVE ZEROES TO CIP-NUM-FOLI IN IC2-FLD.
           MOVE SPACES TO CIP-GLS-NORM IN IC2-FLD.
       FIN-CLR-CIP-IC2.
           EXIT.
       
       FST-KEY-IC2 SECTION.
       INI-FST-KEY-IC2.
           MOVE -1 TO CIP-CAI-ICER-LEN IN IC2-FLD.
       FIN-FST-KEY-IC2.
           EXIT.
       
       FST-FLD-IC2 SECTION.
       INI-FST-FLD-IC2.
           MOVE -1 TO CIP-COD-CPTO-LEN IN IC2-FLD.
       FIN-FST-FLD-IC2.
           EXIT.
       
       PRO-KEY-IC2 SECTION.
       INI-PRO-KEY-IC2.
           PERFORM PRO-IKY-IC2.
           PERFORM PRO-AKY-IC2.
           PERFORM PRO-MKY-IC2.
       FIN-PRO-KEY-IC2.
           EXIT.
       
       PRO-IKY-IC2 SECTION.
       INI-PRO-IKY-IC2.
           MOVE FRM-CPIM-AEY TO CIP-CAI-ICER-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-IIC-ICER-ATR IN IC2-FLD.
           MOVE FRM-CPIM-AEY TO CIP-NUM-ICIP-ATR IN IC2-FLD.
       FIN-PRO-IKY-IC2.
           EXIT.
       
       PRO-MKY-IC2 SECTION.
       INI-PRO-MKY-IC2.
       FIN-PRO-MKY-IC2.
           EXIT.
       
       PRO-AKY-IC2 SECTION.
       INI-PRO-AKY-IC2.
       FIN-PRO-AKY-IC2.
           EXIT.
       
       UNP-KEY-IC2 SECTION.
       INI-UNP-KEY-IC2.
           PERFORM UNP-IKY-IC2.
           PERFORM UNP-AKY-IC2.
           PERFORM UNP-MKY-IC2.
       FIN-UNP-KEY-IC2.
           EXIT.
       
       UNP-IKY-IC2 SECTION.
       INI-UNP-IKY-IC2.
      *<<<< INI_UNP_IKY_IC2
           IF SCR-CCPP = WCC-ING
               MOVE FRM-CPIM-UBY TO CIP-CAI-ICER-ATR
               MOVE FRM-CPIM-UBY TO CIP-IIC-ICER-ATR
               MOVE FRM-CPIM-AEY TO CIP-NUM-ICIP-ATR
               GO TO FIN-UNP-IKY-IC2.
      *>>>>
           MOVE FRM-CPIM-UBY TO CIP-CAI-ICER-ATR.
           MOVE FRM-CPIM-UBY TO CIP-IIC-ICER-ATR.
           MOVE FRM-CPIM-UBY TO CIP-NUM-ICIP-ATR.
       FIN-UNP-IKY-IC2.
           EXIT.
       
       UNP-MKY-IC2 SECTION.
       INI-UNP-MKY-IC2.
       FIN-UNP-MKY-IC2.
           EXIT.
       
       UNP-AKY-IC2 SECTION.
       INI-UNP-AKY-IC2.
       FIN-UNP-AKY-IC2.
           EXIT.
       
       UNP-FLD-IC2 SECTION.
       INI-UNP-FLD-IC2.
           PERFORM UNP-CIP-IC2.
       FIN-UNP-FLD-IC2.
           EXIT.
       
       UNP-CIP-IC2 SECTION.
       INI-UNP-CIP-IC2.
           MOVE FRM-CPIM-UBY TO CIP-COD-CPTO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-COD-TIPO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-FEC-FCOL-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-FEC-FMAV-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-SGV-MNTO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-VAL-SIMO-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-SGV-TOPE-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-SGV-TINT-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-FEC-FINI-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-FEC-FTER-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-NUM-PTRM-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-SGV-CUOT-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-NUM-FOLI-ATR IN IC2-FLD.
           MOVE FRM-CPIM-UBY TO CIP-GLS-NORM-ATR IN IC2-FLD.
       FIN-UNP-CIP-IC2.
           EXIT.
       
       VAL-KEY-IC2 SECTION.
       INI-VAL-KEY-IC2.
           PERFORM VAL-IKY-IC2.
           PERFORM VAL-MKY-IC2.
           PERFORM VAL-AKY-IC2.
       FIN-VAL-KEY-IC2.
           EXIT.
       
       VAL-IKY-IC2 SECTION.
       INI-VAL-IKY-IC2.
           PERFORM VAL-CIP-CAI-ICER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-CAI-ICER-LEN IN IC2-FLD
                GO TO FIN-VAL-IKY-IC2.
           PERFORM VAL-CIP-IIC-ICER.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-IIC-ICER-LEN IN IC2-FLD
                GO TO FIN-VAL-IKY-IC2.
           PERFORM VAL-CIP-NUM-ICIP.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                MOVE FRM-IND-ERRO TO CIP-NUM-ICIP-LEN IN IC2-FLD
                GO TO FIN-VAL-IKY-IC2.
       FIN-VAL-IKY-IC2.
           EXIT.
       
       VAL-MKY-IC2 SECTION.
       INI-VAL-MKY-IC2.
       FIN-VAL-MKY-IC2.
           EXIT.
       
       VAL-AKY-IC2 SECTION.
       INI-VAL-AKY-IC2.
       FIN-VAL-AKY-IC2.
           EXIT.
       
       VAL-CIP-CAI-ICER SECTION.
       INI-VAL-CIP-CAI-ICER.
           IF CIP-CAI-ICER IN IC2-FLD NOT > SPACES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-CAI-ICER.
       FIN-VAL-CIP-CAI-ICER.
           EXIT.
       
       VAL-CIP-IIC-ICER SECTION.
       INI-VAL-CIP-IIC-ICER.
           IF CIP-IIC-ICER IN IC2-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-IIC-ICER.
       FIN-VAL-CIP-IIC-ICER.
           EXIT.
       
       VAL-CIP-NUM-ICIP SECTION.
       INI-VAL-CIP-NUM-ICIP.
      *<<<< INI_CIP_NUM_ICIP
           IF SCR-CCPP = WCC-ING
               GO TO FIN-VAL-CIP-NUM-ICIP.
      *>>>>
           IF CIP-NUM-ICIP IN IC2-FLD = ZEROES
                PERFORM ERR-GLS
                GO TO FIN-VAL-CIP-NUM-ICIP.
       FIN-VAL-CIP-NUM-ICIP.
           EXIT.
       
       VAL-CON-KEY-IC2 SECTION.
       INI-VAL-CON-KEY-IC2.
      *<<<< INI_VAL_CON_KEY_IC2
           IF SCR-CCPP = WCC-ING
              IF CIP-CAI-ICER IN IC2-FLD NOT > SPACES
                 AND CIP-IIC-ICER IN IC2-FLD NOT > ZEROES
                  PERFORM ERR-KEY
                  PERFORM FST-KEY-IC2
                  GO TO FIN-VAL-CON-KEY-IC2.
      *>>>>
           IF     CIP-CAI-ICER IN IC2-FLD NOT > SPACES 
              AND CIP-IIC-ICER IN IC2-FLD NOT > ZEROES 
              AND CIP-NUM-ICIP IN IC2-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-IC2.
       FIN-VAL-CON-KEY-IC2.
           EXIT.
       
       VAL-CON-IKY-IC2 SECTION.
       INI-VAL-CON-IKY-IC2.
      *<<<< INI_VAL_CON_IKY_IC2
           IF SCR-CCPP = WCC-ING
              IF CIP-CAI-ICER IN IC2-FLD NOT > SPACES
                 AND CIP-IIC-ICER IN IC2-FLD NOT > ZEROES
                  PERFORM ERR-KEY
                  PERFORM FST-KEY-IC2
                  GO TO FIN-VAL-CON-IKY-IC2.
      *>>>>
           IF     CIP-CAI-ICER IN IC2-FLD NOT > SPACES 
              AND CIP-IIC-ICER IN IC2-FLD NOT > ZEROES 
              AND CIP-NUM-ICIP IN IC2-FLD NOT > ZEROES 
                PERFORM ERR-KEY
                PERFORM FST-KEY-IC2.
       FIN-VAL-CON-IKY-IC2.
           EXIT.
       
       VAL-NUM-KEY-IC2 SECTION.
       INI-VAL-NUM-KEY-IC2.
           PERFORM VAL-NUM-IKY-IC2.
           PERFORM VAL-NUM-MKY-IC2.
           PERFORM VAL-NUM-AKY-IC2.
       FIN-VAL-NUM-KEY-IC2.
           EXIT.
       
       VAL-NUM-IKY-IC2 SECTION.
       INI-VAL-NUM-IKY-IC2.
       VAL-NUM-CIP-IIC-ICER.
           MOVE CIP-IIC-ICER-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 8 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CIP-IIC-ICER IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-IIC-ICER-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-IKY-IC2.
       VAL-NUM-CIP-NUM-ICIP.
           MOVE CIP-NUM-ICIP-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CIP-NUM-ICIP IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-NUM-ICIP-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-IKY-IC2.
       FIN-VAL-NUM-IKY-IC2.
           EXIT.
       
       VAL-NUM-MKY-IC2 SECTION.
       INI-VAL-NUM-MKY-IC2.
       FIN-VAL-NUM-MKY-IC2.
           EXIT.
       
       VAL-NUM-AKY-IC2 SECTION.
       INI-VAL-NUM-AKY-IC2.
       FIN-VAL-NUM-AKY-IC2.
           EXIT.
       
       VAL-NUM-FLD-IC2 SECTION.
       INI-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-SGV-MNTO.
           MOVE CIP-SGV-MNTO-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-SGV-MNTO IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-SGV-MNTO-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-VAL-SIMO.
           MOVE CIP-VAL-SIMO-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-VAL-SIMO IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-VAL-SIMO-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-SGV-TOPE.
           MOVE CIP-SGV-TOPE-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 12 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-SGV-TOPE IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-SGV-TOPE-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-SGV-TINT.
           MOVE CIP-SGV-TINT-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 3 TO NUM-NENT.
           MOVE 12 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-SGV-TINT IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-SGV-TINT-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-NUM-PTRM.
           MOVE CIP-NUM-PTRM-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 2 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CIP-NUM-PTRM IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-NUM-PTRM-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-SGV-CUOT.
           MOVE CIP-SGV-CUOT-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 11 TO NUM-NENT.
           MOVE 4 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9V TO CIP-SGV-CUOT IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-SGV-CUOT-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       VAL-NUM-CIP-NUM-FOLI.
           MOVE CIP-NUM-FOLI-ALF IN IC2-FLD TO NUM-NUME.
           MOVE NUM-ZERO-S TO NUM-ZERO.
           MOVE NUM-SGNO-N TO NUM-SGNO.
           MOVE 10 TO NUM-NENT.
           MOVE 0 TO NUM-NDCM.
           PERFORM VAL-NUM.
           IF NUM-STAT-OKS
                MOVE NUM-NN9N TO CIP-NUM-FOLI IN IC2-FLD
           ELSE
                MOVE NUM-MENS     TO FRM-MENS
                MOVE FRM-SUAR-MAL TO FRM-SUAR
                MOVE -9 TO CIP-NUM-FOLI-LEN IN IC2-FLD
                GO TO FIN-VAL-NUM-FLD-IC2.
       FIN-VAL-NUM-FLD-IC2.
           EXIT.
       
       EDT-KEY-IC2 SECTION.
       INI-EDT-KEY-IC2.
           PERFORM EDT-IKY-IC2.
           PERFORM EDT-MKY-IC2.
           PERFORM EDT-AKY-IC2.
       FIN-EDT-KEY-IC2.
           EXIT.
       
       EDT-IKY-IC2 SECTION.
       INI-EDT-IKY-IC2.
           IF CIP-IIC-ICER-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-IIC-ICER-LEN IN IC2-FLD
                GO TO FIN-EDT-IKY-IC2.
           MOVE CIP-IIC-ICER IN IC2-FLD TO CIP-IIC-ICER-EDT IN IC2-EDT.
           MOVE CIP-IIC-ICER-EDT IN IC2-EDT TO 
                CIP-IIC-ICER-ALF IN IC2-FLD.
           IF CIP-NUM-ICIP-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-NUM-ICIP-LEN IN IC2-FLD
                GO TO FIN-EDT-IKY-IC2.
           MOVE CIP-NUM-ICIP IN IC2-FLD TO CIP-NUM-ICIP-EDT IN IC2-EDT.
           MOVE CIP-NUM-ICIP-EDT IN IC2-EDT TO 
                CIP-NUM-ICIP-ALF IN IC2-FLD.
       FIN-EDT-IKY-IC2.
           EXIT.
       
       EDT-MKY-IC2 SECTION.
       INI-EDT-MKY-IC2.
       FIN-EDT-MKY-IC2.
           EXIT.
       
       EDT-AKY-IC2 SECTION.
       INI-EDT-AKY-IC2.
       FIN-EDT-AKY-IC2.
           EXIT.
       
       EDT-FLD-IC2 SECTION.
       INI-EDT-FLD-IC2.
           IF CIP-SGV-MNTO-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-SGV-MNTO-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-SGV-MNTO IN IC2-FLD TO CIP-SGV-MNTO-EDT IN IC2-EDT.
           MOVE CIP-SGV-MNTO-EDT IN IC2-EDT TO 
                CIP-SGV-MNTO-ALF IN IC2-FLD.
           IF CIP-VAL-SIMO-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-VAL-SIMO-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-VAL-SIMO IN IC2-FLD TO CIP-VAL-SIMO-EDT IN IC2-EDT.
           MOVE CIP-VAL-SIMO-EDT IN IC2-EDT TO 
                CIP-VAL-SIMO-ALF IN IC2-FLD.
           IF CIP-SGV-TOPE-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-SGV-TOPE-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-SGV-TOPE IN IC2-FLD TO CIP-SGV-TOPE-EDT IN IC2-EDT.
           MOVE CIP-SGV-TOPE-EDT IN IC2-EDT TO 
                CIP-SGV-TOPE-ALF IN IC2-FLD.
           IF CIP-SGV-TINT-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-SGV-TINT-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-SGV-TINT IN IC2-FLD TO CIP-SGV-TINT-EDT IN IC2-EDT.
           MOVE CIP-SGV-TINT-EDT IN IC2-EDT TO 
                CIP-SGV-TINT-ALF IN IC2-FLD.
           IF CIP-NUM-PTRM-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-NUM-PTRM-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-NUM-PTRM IN IC2-FLD TO CIP-NUM-PTRM-EDT IN IC2-EDT.
           MOVE CIP-NUM-PTRM-EDT IN IC2-EDT TO 
                CIP-NUM-PTRM-ALF IN IC2-FLD.
           IF CIP-SGV-CUOT-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-SGV-CUOT-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-SGV-CUOT IN IC2-FLD TO CIP-SGV-CUOT-EDT IN IC2-EDT.
           MOVE CIP-SGV-CUOT-EDT IN IC2-EDT TO 
                CIP-SGV-CUOT-ALF IN IC2-FLD.
           IF CIP-NUM-FOLI-LEN IN IC2-FLD = FRM-ERR-NUME
                MOVE FRM-IND-ERRO TO CIP-NUM-FOLI-LEN IN IC2-FLD
                GO TO FIN-EDT-FLD-IC2.
           MOVE CIP-NUM-FOLI IN IC2-FLD TO CIP-NUM-FOLI-EDT IN IC2-EDT.
           MOVE CIP-NUM-FOLI-EDT IN IC2-EDT TO 
                CIP-NUM-FOLI-ALF IN IC2-FLD.
       FIN-EDT-FLD-IC2.
           EXIT.
