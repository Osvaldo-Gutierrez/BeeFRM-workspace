*%! Codigo adicional para archivo
*% IF MNU_COD_NEMO
      *<<<< MNU_COD_NEMO
      *>>>>
*% END
*% IF MNU_COD_OPCI
      *<<<< MNU_COD_OPCI
           IF SCR-INST = SCR-INST-GFL AND SCR-CMND = 'COP'
               MOVE 'MNU-COD-OPCI' TO FIO-AKEY
               MOVE MNU-COD-OPCI IN MNM-FLD TO MNU-COD-OPCI IN MNU
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CHK-DUPL.
      *>>>>
*% END
*% IF MNU_COD_IMEN
      *<<<< MNU_COD_IMEN
           IF SCR-INST = SCR-INST-GFL AND SCR-CMND = 'COP'
               MOVE 'MNU-COD-IMEN' TO FIO-AKEY
               MOVE MNU-COD-IMEN IN MNM-FLD TO MNU-COD-IMEN IN MNU
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CHK-DUPL.
      *>>>>
*% END
*% IF MNU_COD_SIST
      *<<<< MNU_COD_SIST
      *>>>>
*% END
*% IF MNU_COD_FRET
      *<<<< MNU_COD_FRET
           IF MNU-COD-FRET IN MNM-FLD NOT > SPACES
               MOVE 'SIS' TO MNU-COD-FRET IN MNM-FLD.
      *>>>>
*% END
*% IF MNU_COD_FANT
      *<<<< MNU_COD_FANT
      *>>>>
*% END
*% IF MNU_GLS_FMEN
      *<<<< MNU_GLS_FMEN
      *>>>>
*% END
*% IF MNU_GLS_FPRO
      *<<<< MNU_GLS_FPRO
*% IF PGM_D20 OR PGM_GRD OR PGM_MCP
           IF MNU-GLS-FPRO IN MNM-FLD = """"
*% ELSE
           IF MNU-GLS-FPRO IN MNM-FLD = '"'
*% END
               MOVE MNU-GLS-FMEN IN MNM-FLD TO MNU-GLS-FPRO IN MNM-FLD.
      *>>>>
*% END
*% IF MNU_GLS_NFRM
      *<<<< MNU_GLS_NFRM
           IF MNU-GLS-NFRM IN MNM-FLD NOT > SPACES AND
              MNU-GLS-LFRM IN MNM-FLD     > SPACES
               MOVE MNU-GLS-LFRM IN MNM-FLD TO WSS-GLS-FORM
               MOVE 'F' TO WSS-COD-FORM
               MOVE WSS-GLS-FORM TO MNU-GLS-NFRM IN MNM-FLD.
      *>>>>
*% END
*% IF MNU_GLS_LFRM
      *<<<< MNU_GLS_LFRM
           IF MNU-GLS-LFRM IN MNM-FLD NOT > SPACES AND
              MNU-GLS-NFRM IN MNM-FLD     > SPACES
               MOVE MNU-GLS-NFRM IN MNM-FLD TO WSS-GLS-FORM
               MOVE 'A' TO WSS-COD-FORM
               MOVE WSS-GLS-FORM TO MNU-GLS-LFRM IN MNM-FLD.
      *>>>>
*% END
*% IF MNU_GLS_LDOC
      *<<<< MNU_GLS_LDOC
      *>>>>
*% END
*% IF MNU_GLS_NDOC
      *<<<< MNU_GLS_NDOC
      *>>>>
*% END
*% IF MNU_COD_TFUN
      *<<<< MNU_COD_TFUN
           IF MNU-COD-TFUN IN MNM-FLD NOT > SPACES
               MOVE 'PGI' TO MNU-COD-TFUN IN MNM-FLD.
      *>>>>
*% END
*% IF MNU_COD_MENU
      *<<<< MNU_COD_MENU
      *>>>>
*% END
*% IF MNU_GLS_PROG
      *<<<< MNU_GLS_PROG
      *>>>>
*% END
*% IF MNU_GLS_TRAN
      *<<<< MNU_GLS_TRAN
      *>>>>
*% END
*% IF MNU_COD_INST
      *<<<< MNU_COD_INST
      *>>>>
*% END
*% IF MNU_COD_CMND
      *<<<< MNU_COD_CMND
      *>>>>
*% END
*% IF MNU_IND_CONF
      *<<<< MNU_IND_CONF
      *>>>>
*% END
*% IF MNU_IND_IPRV
      *<<<< MNU_IND_IPRV
      *>>>>
*% END
*% IF MNU_IND_SEQU
      *<<<< MNU_IND_SEQU
      *>>>>
*% END
*% IF MNU_IND_EXGL
      *<<<< MNU_IND_EXGL
           IF MNU-IND-EXGL IN MNM-FLD NOT > SPACES
               MOVE 'N' TO MNU-IND-EXGL IN MNM-FLD.
      *>>>>
*% END
*% IF MNU_NUM_FILA
      *<<<< MNU_NUM_FILA
           IF MNU-NUM-FILA IN MNM-FLD NOT > ZEROES
               GO TO FIN-VAL-MNU-NUM-FILA.
           IF MNU-NUM-FILA IN MNM-FLD < 3 OR
              MNU-NUM-FILA IN MNM-FLD > 21
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'MNUFILAINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF MNU_NUM_COLU
      *<<<< MNU_NUM_COLU
           IF MNU-NUM-COLU IN MNM-FLD NOT > ZEROES
               GO TO FIN-VAL-MNU-NUM-COLU.
           IF NOT ( MNU-NUM-COLU IN MNM-FLD = 1  OR
                    MNU-NUM-COLU IN MNM-FLD = 24 OR
                    MNU-NUM-COLU IN MNM-FLD = 41 )
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'MNUCOLUINV' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF VAL_CON_FLD_MNU
      *<<<< VAL_CON_FLD_MNU
           IF SCR-CMND = 'COP'
               MOVE MNU-COD-NEMO IN MNM-FLD TO MNU-COD-NEMO IN MNU
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM CHK-DUPL.

           IF MNU-COD-OPCI IN MNM-FLD NOT > SPACES
               PERFORM ERR-GLS
               GO TO FIN-VAL-CON-FLD-MNU.

           IF MNU-COD-SIST IN MNM-FLD     > SPACES   AND
              MNU-COD-SIST IN MNM-FLD NOT = SCR-SISG AND
              MNU-COD-TFUN IN MNM-FLD NOT = 'MEN'
               MOVE 'GNS'   TO MSG-COD-SIST
               MOVE 'MNUSISTTFUNI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-MNU.

           IF MNU-COD-CMND IN MNM-FLD     > SPACES AND
              MNU-COD-SIST IN MNM-FLD     > SPACES AND
              MNU-COD-SIST IN MNM-FLD NOT = SCR-SISG  
               MOVE 'GNS'   TO MSG-COD-SIST
               MOVE 'MNUCMNDSISTI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-MNU.

           IF MNU-COD-CMND IN MNM-FLD     > SPACES AND
              MNU-COD-TFUN IN MNM-FLD     = 'MEN' 
               MOVE 'GNS'   TO MSG-COD-SIST
               MOVE 'MNUCMNDTFUNI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-CON-FLD-MNU.

           PERFORM VAL-CON-GLS-PROG.
      *>>>>
*% END
*% IF EOF
      *<<<< EOF
       CHK-DUPL SECTION.
       INI-CHK-DUPL.
           MOVE SCR-SISG TO FIO-SIST.
           PERFORM GNS-FIO-MNU.
           IF FIO-STAT-OKS
               MOVE 'GNS' TO MSG-COD-SIST
               MOVE 'KEY    DUPLI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-CHK-DUPL.
           EXIT.
      *>>>>
*% END
*% IF EOF_VAX
      *<<<< EOF_VAX
       VAL-CON-GLS-PROG SECTION.
       INI-VAL-CON-GLS-PROG.
       FIN-VAL-CON-GLS-PROG.
           EXIT.
      *>>>>
*% END
*% IF EOF_IBM
      *<<<< EOF_IBM
       VAL-CON-GLS-PROG SECTION.
       INI-VAL-CON-GLS-PROG.
           IF NOT ( ( MNU-GLS-PROG IN MNM-FLD     > SPACES AND
                      MNU-GLS-TRAN IN MNM-FLD     > SPACES ) OR
                    ( MNU-GLS-PROG IN MNM-FLD NOT > SPACES AND
                      MNU-GLS-TRAN IN MNM-FLD NOT > SPACES ) )
               MOVE 'GNS'   TO MSG-COD-SIST
               MOVE 'MNUPROGTRANI' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
       FIN-VAL-CON-GLS-PROG.
           EXIT.
      *>>>>
*% END
*% IF INI_VAL_MNU_COD_UIDD
    *<<<<<
           IF MNU-COD-UIDD IN MNM-FLD NOT > SPACES                      
              MOVE SPACES TO MNU-COD-UIDD IN MNM-FLD.                   
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'GNS' TO TAB-COD-SIST.                                  
           MOVE 'UIM ' TO TAB-COD-TTAB IN TAB.                          
           MOVE MNU-COD-UIDD IN MNM-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
     *>>>> 
*% END
*% IF FIN_VAL_FLD_MNM
    *<<<<FIN_VAL_FLD_MNM
           PERFORM VAL-MNU-COD-UIDD.                                    
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR        
                MOVE FRM-IND-ERRO TO MNU-COD-UIDD-LEN IN MNM-FLD        
                GO TO FIN-VAL-FLD-MNM.                                  
    *>>>>
*% END
*% IF VAL_CON_FLD_MNM AND PGM_BU
   *<<<<
            IF MNU-COD-UIDD IN MNM-FLD > SPACES AND                     
               MNU-COD-CIFD IN MNM-FLD NOT > SPACES                     
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               MOVE 'GNS' TO MSG-COD-SIST                               
               MOVE 'ERRUIDD01' TO MSG-COD-MENS                         
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-CON-FLD-MNM.                               
   *>>>>
*% END 
