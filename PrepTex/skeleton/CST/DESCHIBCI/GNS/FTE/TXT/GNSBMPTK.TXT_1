*%! Codigo adicional para archivo
*% IF SETTAG
*% VSNBQ = "10.07.12"
*% FNCBQ = "GNS"
*% END
*% IF FIN_CLR_KEY_PTK
      *<<<< FIN_CLR_KEY_PTK                                             
           MOVE ZEROES TO ITK-HRA-HRPR IN PTK-FLD.                      
           PERFORM GET-FHOY.                                            
           MOVE HOY-DHOY TO ITK-NUM-DPRO IN PTK-FLD.                    
           MOVE HOY-MHOY TO ITK-NUM-MPRO IN PTK-FLD.                    
           MOVE HOY-SHOY TO ITK-NUM-SPRO IN PTK-FLD.                    
           MOVE HOY-AHOY TO ITK-NUM-APRO IN PTK-FLD.                    
      *>>>>                                         
*% END
*% IF INI_VAL_CON_KEY_PTK
      *<<<< INI_VAL_CON_KEY_PTK
           IF     PTK-CAI-IITK IN PTK-FLD NOT > SPACES
              AND PTK-IIC-IITK IN PTK-FLD NOT > SPACES
              AND PTK-NUM-SECU IN PTK-FLD NOT > ZEROES
              AND PTK-NUM-CORP IN PTK-FLD NOT > ZEROES
              AND ITK-COD-SIST IN PTK-FLD NOT > SPACES
              AND ITK-COD-TPRO IN PTK-FLD NOT > SPACES
              AND ITK-COD-ENTI IN PTK-FLD NOT > SPACES
              AND ITK-FEC-FPRO IN PTK-FLD NOT > ZEROES
              AND ITK-HRA-HRPR IN PTK-FLD NOT > ZEROES
              AND ITK-NUM-UNIC IN PTK-FLD NOT > SPACES
                PERFORM ERR-KEY
                PERFORM FST-KEY-PTK.
           GO TO FIN-VAL-CON-KEY-PTK.
      *>>>>                                         
*% END
*% IF ITK_COD_SIST
      *<<<< ITK_COD_SIST                                                
      *VAL-COD Valida codigo de tabla                                   
           MOVE 'GNS'                   TO TAB-COD-SIST.                
           MOVE 'SIS'                   TO TAB-COD-TTAB IN TAB.         
           MOVE ITK-COD-SIST IN PTK-FLD TO TAB-COD-CTAB IN TAB.         
           PERFORM VAL-COD.                                             
           IF (MSG-COD-MENS = 'COD    NEX' OR 'COD    NVG')             
              MOVE SPACES       TO FRM-GLS-SIST IN PTK-FLD              
              MOVE MSG-GLS-DESC TO FRM-MENS                             
              MOVE FRM-SUAR-MAL TO FRM-SUAR                             
           ELSE                                                         
              MOVE TAB-GLS-DESC IN TAB TO FRM-GLS-SIST IN PTK-FLD.      
      *>>>>                                                             
*% END
*% IF INI_ITK_FEC_FPRO
      *<<<< INI_ITK_FEC_FPRO                                            
           MOVE FEC-CHOY-N TO FEC-CHOY.                                 
      *     IF (SCR-CMND = 'ING' OR 'MOD' OR 'VRF' OR 'ACA')            
      *        MOVE FEC-CHOY-GE TO FEC-CHOY.                            
           MOVE FEC-VHBL-N TO FEC-VHBL.                                 
            IF ITK-FEC-FPRO IN PTK-FLD NOT > ZEROES                     
               PERFORM GET-FHOY                                         
               MOVE HOY-DHOY IN HOY-VARI TO ITK-NUM-DPRO IN PTK-FLD     
               MOVE HOY-MHOY IN HOY-VARI TO ITK-NUM-MPRO IN PTK-FLD     
               MOVE HOY-SHOY IN HOY-VARI TO ITK-NUM-SPRO IN PTK-FLD     
               MOVE HOY-AHOY IN HOY-VARI TO ITK-NUM-APRO IN PTK-FLD     
               IF ITK-HRA-HRPR IN PTK-FLD NOT > ZEROES                  
                  MOVE HOY-HHOY IN HOY-VARI TO ITK-HRA-HRPR IN PTK-FLD  
                  GO TO FIN-VAL-ITK-FEC-FPRO                            
               ELSE                                                     
                  GO TO FIN-VAL-ITK-FEC-FPRO.                           
      *>>>>                                                             
*% END
*% IF FIN_ITK_HRA_HRPR
      *<<<< FIN_ITK_HRA_HRPR
           IF ITK-HRA-HRPR IN PTK-FLD NOT > ZEROES                      
              MOVE ZEROES TO ITK-HRA-HRPR IN PTK-FLD.                   
            IF ITK-HRA-HRPR IN PTK-FLD NOT > ZEROES                     
               PERFORM GET-FHOY                                         
               MOVE HOY-HHOY IN HOY-VARI TO ITK-HRA-HRPR IN PTK-FLD     
               GO TO FIN-VAL-ITK-HRA-HRPR.                              
           MOVE ITK-HRA-HRPR IN PTK-FLD TO ITK-HRA-HRPR IN ITK.         
           IF ITK-NUM-HHPR IN ITK < ZEROES OR                           
              ITK-NUM-HHPR IN ITK > 23                                  
               MOVE 'TAB'         TO MSG-COD-SIST                       
               MOVE 'NUMHHTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-ITK-HRA-HRPR.                              
           IF ITK-NUM-MMPR IN ITK < ZEROES OR                           
              ITK-NUM-MMPR IN ITK > 59                                  
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'NUMMMTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-ITK-HRA-HRPR.                              
           IF ITK-NUM-SSPR IN ITK < ZEROES OR                           
              ITK-NUM-SSPR IN ITK > 59                                  
               MOVE 'TAB' TO MSG-COD-SIST                               
               MOVE 'NUMSSTRNOVA' TO MSG-COD-MENS                       
               PERFORM GET-MSG                                          
               MOVE MSG-GLS-DESC TO FRM-MENS                            
               MOVE FRM-SUAR-MAL TO FRM-SUAR                            
               GO TO FIN-VAL-ITK-HRA-HRPR.                              
      *>>>>                                         
*% END
*% IF FIN
      *<<<< FIN                                         

      *>>>>                                         
*% END
*% IF FIN
      *<<<< FIN                                           

      *>>>>                                         
*% END
