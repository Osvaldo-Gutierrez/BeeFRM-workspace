      ************************* I N I C I O *************************
      * SE DEBEN INCORPORAR COPYS COLWGBAR Y COLBGBAR
      * SE DEBEN LLENAR CAMPOS : 
      *      BAR-CAI-OPER (EJ: OPC-CAI-IOPC)
      *      BAR-IIC-OPER (EJ: OPC-IIC-IOPC)
      *      BAR-COD-SIST (EJ: CCT : CUENTAS CORRIENTES
      *                        COL : COLOCACIONES
      *                        DAP : DEPOSITOS A PLAZOS
      *                        CBZ : COBRANZA
      *                        AHP : AHORRO A PLAZO
      *                        AHV : AHORRO PARA LA VIVIENDA
      *
      * LLENAR CAMPOS : 
      *               BAR-CAI-OPER IN BAR-VARI
      *               BAR-IIC-OPER IN BAR-VARI
      *               BAR-COD-SIST IN BAR-VARI
      *               BAR-NUM-LRGO IN BAR-VARI
      *
      *
      * LLAMADA A RUTINA, PARA CALCULAR DIGITOS DE CODIGO DE BARRAS
       CAL-BAR SECTION.
       INI-CAL-BAR.

           MOVE BAR-NUM-LRGO IN BAR-VARI TO BAR-LNK-LRGO    IN BAR-LNK.
           MOVE BAR-CODIGO   IN BAR-VARI TO BAR-GLS-LNK     IN BAR-LNK.

           CALL 'RTNUBARR' USING BAR-LNK.
         
           MOVE '*'                  TO BAR-COD-ASTER1  IN BAR-VARI.
           MOVE '*'                  TO BAR-COD-ASTER2  IN BAR-VARI.
           MOVE BAR-LNK-C IN BAR-LNK TO BAR-COD-DIG-C   IN BAR-VARI.
           MOVE BAR-LNK-K IN BAR-LNK TO BAR-COD-DIG-K   IN BAR-VARI.
           MOVE 127                  TO AREA-DECIMAL.
           MOVE AREA-BINARIO         TO BAR-COD-COMILLA IN BAR-VARI.

           MOVE BAR-CODIGO IN BAR-VARI TO BAR-CODIG-A.
           MOVE 1                      TO BAR-IND-2 IN BAR-VARI.
           PERFORM BLK-GLS-BAR VARYING BAR-IND-1 IN BAR-VARI
               FROM 1 BY 1 UNTIL BAR-IND-1 IN BAR-VARI > 15.
           MOVE BAR-CODIG-B IN BAR-VARI TO BAR-GLS-BARRA IN BAR-VARI.
       FIN-CAL-BAR.
           EXIT.

       BLK-GLS-BAR SECTION.
       INI-BLK-GLS-BAR.
           MOVE BAR-CODIG-AA  IN BAR-VARI(BAR-IND-1 IN BAR-VARI) TO
                BAR-CODIG-BB  IN BAR-VARI(BAR-IND-2 IN BAR-VARI).
           ADD 2 TO BAR-IND-2 IN BAR-VARI.
       FIN-BLK-GLS-BAR.
           EXIT.
      ***************************** F I N ***************************
