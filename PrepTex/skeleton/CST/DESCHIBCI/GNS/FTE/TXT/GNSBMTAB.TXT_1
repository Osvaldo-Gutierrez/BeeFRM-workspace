*%! Codigo adicional
*% IF TAB_COD_TTAB
      *<<<< TAB_COD_TTAB
      *VAL-COD Valida codigo de tabla
           IF TAB-COD-TTAB IN TAB-FLD NOT > SPACES AND
              NOT ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 )
                PERFORM ERR-GLS
                GO TO FIN-VAL-TAB-COD-TTAB.

*% IF PGM_BCA
           IF SCR-CMND = 'CON'
               GO TO NO-VAL-RESP.
           MOVE SCR-SISG TO FIO-SIST.
           MOVE TAB-COD-TTAB IN TAB-FLD TO TAB-COD-TTAB IN TAB.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               IF TAB-COD-CTAB IN TAB-FLD > SPACES
                   MOVE 'GNS'        TO MSG-COD-SIST
                   MOVE 'TAB    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
                   GO TO FIN-VAL-TAB-COD-TTAB
                ELSE
                   NEXT SENTENCE
           ELSE
           IF TAB-COD-ATRN IN TAB NOT > SPACES
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'RESTAB NAS' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TAB-COD-TTAB
           ELSE
           IF TAB-COD-ATRN IN TAB NOT = SCR-USER
               MOVE 'GNS'        TO MSG-COD-SIST
               MOVE 'USRTAB S/P' TO MSG-COD-MENS
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR
               GO TO FIN-VAL-TAB-COD-TTAB.

       NO-VAL-RESP.
*% END
           IF TAB-COD-TTAB IN TAB-FLD NOT = 'TBL' AND
              NOT ( FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8 )
               MOVE 'TBL' TO TAB-COD-TTAB IN TAB
               MOVE TAB-COD-TTAB IN TAB-FLD TO TAB-COD-CTAB IN TAB
               MOVE SCR-SISG TO FIO-SIST
               MOVE FIO-GET-KEY TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF NOT FIO-STAT-OKS
                   MOVE 'GNS'        TO MSG-COD-SIST
                   MOVE 'TBL    NEX' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR
               ELSE
               IF TAB-MSC-STAT IN TAB = 'N'
                   MOVE 'GNS'        TO MSG-COD-SIST
                   MOVE 'TBL    NVG' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC TO FRM-MENS
                   MOVE FRM-SUAR-MAL TO FRM-SUAR.
                  
      *>>>>
*% END
*% IF TAB_COD_CTAB
      *<<<< TAB_COD_CTAB
           IF TAB-COD-CTAB IN TAB-FLD NOT > SPACES
               MOVE SPACES TO TAB-COD-CTAB IN TAB-FLD
               GO TO FIN-VAL-TAB-COD-CTAB.
           MOVE TAB-COD-TTAB IN TAB-FLD TO TAB-COD-TTAB IN TAB.
           MOVE SCR-SISG TO FIO-SIST.
           MOVE SPACES TO TAB-COD-CTAB IN TAB.
           MOVE FIO-GET-KEY TO FIO-CMND.
           PERFORM GNS-FIO-TAB.
           IF NOT FIO-STAT-OKS
               MOVE 'TAB    NEX' TO MSG-COD-MENS
               MOVE 'GNS' TO MSG-COD-SIST
               PERFORM GET-MSG
               MOVE MSG-GLS-DESC TO FRM-MENS
               MOVE FRM-SUAR-MAL TO FRM-SUAR.
      *>>>>
*% END
*% IF TAB_CIC_CTAB
      *<<<< TAB_CIC_CTAB
           IF TAB-CIC-CTAB IN TAB-FLD NOT > SPACES
               MOVE TAB-COD-CTAB IN TAB-FLD TO TAB-CIC-CTAB IN TAB-FLD.
      *>>>>
*% END
*% IF INI_TAB_IND_VIGE
      *<<<< INI_TAB_IND_VIGE
      *    IF ( SCR-CCPP = 'ING' OR
      *       ( SCR-CCPP = 'ACT' AND SCR-ACTU = SCR-ACTU-ING )) AND
      *         TAB-COD-TTAB IN TAB-FLD = 'MSC' AND
      *       ( TAB-COD-CTAB IN TAB-FLD = 'VIGE' OR
      *         TAB-COD-CTAB IN TAB-FLD NOT > SPACES )
      *             GO TO FIN-VAL-TAB-IND-VIGE.
      *>>>>
*% END
*% IF INI_VAL_CON_KEY_TAB
      *<<<< INI_VAL_CON_KEY_TAB
           IF FRM-FFLD = FRM-FFLD-PF7 OR FRM-FFLD-PF8
               GO TO FIN-VAL-CON-KEY-TAB.
      *>>>>
*% END
*% IF VAL_CON_FLD_TAB
      *<<<< VAL_CON_FLD_TAB
           PERFORM VAL-IKY-TAB.
           IF FRM-SUAR = FRM-SUAR-MAL OR FRM-SUAR = FRM-SUAR-CLR
                GO TO FIN-VAL-CON-FLD-TAB.
           IF SCR-CMND = 'COP'
               PERFORM KEY-TAB-TAB
               MOVE SCR-SISG                TO FIO-SIST
               MOVE FIO-GET-KEY             TO FIO-CMND
               PERFORM GNS-FIO-TAB
               IF FIO-STAT-OKS
                   MOVE 'GNS'          TO MSG-COD-SIST
                   MOVE 'KEYPRIMDUPLI' TO MSG-COD-MENS
                   PERFORM GET-MSG
                   MOVE MSG-GLS-DESC   TO FRM-MENS
                   MOVE FRM-SUAR-MAL   TO FRM-SUAR.
      *>>>>
*% END
